/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 4
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 1
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 7
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 3
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 6
single-machine distributed training is initialized.
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 5
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 2
single-machine distributed training is initialized.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 0
single-machine distributed training is initialized.
2024-11-06 13:40:43 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512', 'restore_file': '../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-06 13:40:43 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-06 13:40:43 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 13:40:56 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-06 13:40:56 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-06 13:40:56 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-06 13:40:56 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-06 13:40:56 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-06 13:40:56 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 row count 6839 total row count 54715
Downloading tokenizer_config.json:   0%|          | 0.00/25.0 [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|██████████| 25.0/25.0 [00:00<00:00, 5.00kB/s]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 row count 6839 total row count 54715
Downloading (…)tencepiece.bpe.model:   0%|          | 0.00/5.07M [00:00<?, ?B/s]Downloading (…)tencepiece.bpe.model: 100%|██████████| 5.07M/5.07M [00:00<00:00, 21.1MB/s]Downloading (…)tencepiece.bpe.model: 100%|██████████| 5.07M/5.07M [00:00<00:00, 20.8MB/s]
Downloading tokenizer.json:   0%|          | 0.00/9.10M [00:00<?, ?B/s]local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 row count 6840 total row count 54715
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 row count 6840 total row count 54715
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 row count 6839 total row count 54715
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 row count 6839 total row count 54715
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 row count 6839 total row count 54715
Downloading tokenizer.json: 100%|██████████| 9.10M/9.10M [00:00<00:00, 19.5MB/s]Downloading tokenizer.json: 100%|██████████| 9.10M/9.10M [00:00<00:00, 19.2MB/s]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 row count 6840 total row count 54715
2024-11-06 13:41:19 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-06 13:41:19 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-06 13:41:21 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 13:41:21 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-06 13:41:21 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-06 13:41:21 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 13:41:32 - trainer.py[line:619] - INFO: Loaded checkpoint ../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt (epoch 74 @ 0 updates)
2024-11-06 13:41:32 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 1 seek offset 50000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping






file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 5 seek offset 250000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 0 seek offset 0
slice_id 4 seek offset 200000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
2024-11-06 13:44:25 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-06 13:44:25 - train.py[line:297] - INFO: Start iterating over samples
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 2 seek offset 100000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.02297143856220666 loss_cls: 0.0032473441679030657
loss_reg: 0.01135831071139285 loss_cls: 0.0030096080154180527
loss_reg: 0.015267837781967726 loss_cls: 0.00426668394356966
loss_reg: 0.016800305808969386 loss_cls: 0.002847817027941346
loss_reg: 0.0046933634395530605 loss_cls: 0.0027561127208173275
loss_reg: 0.01810007709464248 loss_cls: 0.0036316849291324615
loss_reg: 0.016607880958196312 loss_cls: 0.003142159665003419
loss_reg: 0.0200729431093098 loss_cls: 0.0034592438023537397
loss_reg: 0.008691143454579133 loss_cls: 0.004253067076206207
loss_reg: 0.010352737209302448 loss_cls: 0.0032175793312489986
loss_reg: 0.017078402007872723 loss_cls: 0.0031507546082139015
loss_reg: 0.012029270207420104 loss_cls: 0.0034205110277980566
loss_reg: 0.0046958169723910845 loss_cls: 0.0027743675746023655
loss_reg: 0.012815560433010457 loss_cls: 0.003555023344233632
loss_reg: 0.013148609837097477 loss_cls: 0.003827559994533658
loss_reg: 0.01955852016509199 loss_cls: 0.0028929756954312325
loss_reg: 0.017421121488708457 loss_cls: 0.0031427741050720215
loss_reg: 0.01814756441935296 loss_cls: 0.004545845091342926
loss_reg: 0.009650886750427932 loss_cls: 0.0045293159782886505
loss_reg: 0.01207214689012066 loss_cls: 0.0027653828728944063
loss_reg: 0.004453710429665267 loss_cls: 0.0027635330334305763
loss_reg: 0.02025564252110163 loss_cls: 0.0036491109058260918
loss_reg: 0.013934677254264814 loss_cls: 0.0024831329938024282
loss_reg: 0.009546260798303136 loss_cls: 0.004379210062325001
loss_reg: 0.012900140583534506 loss_cls: 0.003889333223924041
loss_reg: 0.018291824205732696 loss_cls: 0.0032235169783234596
loss_reg: 0.013833876751743617 loss_cls: 0.0027637926395982504
loss_reg: 0.019095095230619627 loss_cls: 0.003779342398047447
loss_reg: 0.01652060399816062 loss_cls: 0.0038687698543071747
loss_reg: 0.00502547242863737 loss_cls: 0.0035307134967297316
loss_reg: 0.01893817901238808 loss_cls: 0.0028468933887779713
loss_reg: 0.012948630414719161 loss_cls: 0.00463188998401165
loss_reg: 0.014358982297745824 loss_cls: 0.00331475050188601
loss_reg: 0.0149840942823279 loss_cls: 0.0035055342596024275
loss_reg: 0.013464229872063013 loss_cls: 0.003587101586163044
loss_reg: 0.018096910413256784 loss_cls: 0.004202715121209621
loss_reg: 0.010608566167937494 loss_cls: 0.006255564279854298
loss_reg: 0.005809843509050404 loss_cls: 0.002468743361532688
loss_reg: 0.016533973110168874 loss_cls: 0.0052381278946995735
loss_reg: 0.01759285274776229 loss_cls: 0.0034208165016025305
loss_reg: 0.010690071515280663 loss_cls: 0.0036722554359585047
loss_reg: 0.010076800564421555 loss_cls: 0.003900547744706273
loss_reg: 0.010574025011432932 loss_cls: 0.004665974993258715
loss_reg: 0.018186121256652418 loss_cls: 0.0032005419488996267
loss_reg: 0.012680793502672996 loss_cls: 0.0031559907365590334
loss_reg: 0.007933183296575342 loss_cls: 0.0026460494846105576
loss_reg: 0.02226356007328792 loss_cls: 0.0029250120278447866
loss_reg: 0.016781901812098116 loss_cls: 0.005312762223184109
loss_reg: 0.009590464384801323 loss_cls: 0.0035091645549982786
loss_reg: 0.013568339989412884 loss_cls: 0.0024786086287349463
loss_reg: 0.015775202380151062 loss_cls: 0.002998781856149435
loss_reg: 0.012094462922784273 loss_cls: 0.0035288543440401554
loss_reg: 0.013174907943231555 loss_cls: 0.003168631112203002
loss_reg: 0.007991684268505158 loss_cls: 0.002687267493456602
loss_reg: 0.011028426779056844 loss_cls: 0.0038372662384063005
loss_reg: 0.012713617603672796 loss_cls: 0.004056405276060104
loss_reg: 0.018438797454097287 loss_cls: 0.0030762795358896255
loss_reg: 0.016204074614914292 loss_cls: 0.00368868769146502
loss_reg: 0.01650741563730948 loss_cls: 0.002504548756405711
loss_reg: 0.017962555503810658 loss_cls: 0.004098428413271904
loss_reg: 0.004590075030426458 loss_cls: 0.0033059155102819204
loss_reg: 0.009751376406582364 loss_cls: 0.0038041556254029274
loss_reg: 0.016853120120576364 loss_cls: 0.004635250195860863
loss_reg: 0.013542388517793921 loss_cls: 0.0032604229636490345
2024-11-06 13:45:24 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17535.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3313.9, ups=0.19, wpb=17535.3, bsz=1024, num_updates=10, lr=2.13129e-07, gnorm=0.008, clip=0, loss_scale=128, train_wall=41, gb_free=13.5, wall=243
2024-11-06 13:46:16 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17733.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3394.1, ups=0.19, wpb=17733.4, bsz=1024, num_updates=20, lr=4.26257e-07, gnorm=0.007, clip=0, loss_scale=128, train_wall=33, gb_free=13.5, wall=295
2024-11-06 13:47:11 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17420.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3192.4, ups=0.18, wpb=17420.7, bsz=1024, num_updates=30, lr=6.39386e-07, gnorm=0.004, clip=0, loss_scale=128, train_wall=33, gb_free=13.5, wall=350
2024-11-06 13:48:04 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17831.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3344.8, ups=0.19, wpb=17831.8, bsz=1024, num_updates=40, lr=8.52515e-07, gnorm=0.003, clip=0, loss_scale=128, train_wall=48, gb_free=13.5, wall=403
2024-11-06 13:48:56 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17628.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3375.2, ups=0.19, wpb=17628.1, bsz=1024, num_updates=50, lr=1.06564e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=50, gb_free=13.5, wall=455
2024-11-06 13:49:48 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17924.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3434.1, ups=0.19, wpb=17924.3, bsz=1024, num_updates=60, lr=1.27877e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=45, gb_free=13.5, wall=507
2024-11-06 13:50:41 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17717.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3351.4, ups=0.19, wpb=17717.1, bsz=1024, num_updates=70, lr=1.4919e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=560
2024-11-06 13:51:34 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17601.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3345.9, ups=0.19, wpb=17601.8, bsz=1024, num_updates=80, lr=1.70503e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=613
2024-11-06 13:52:27 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17624.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3343.7, ups=0.19, wpb=17624.4, bsz=1024, num_updates=90, lr=1.91816e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=35, gb_free=13.5, wall=666
2024-11-06 13:53:20 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17657, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3312.4, ups=0.19, wpb=17657, bsz=1024, num_updates=100, lr=2.13129e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=40, gb_free=13.5, wall=719
2024-11-06 13:54:13 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17488, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3316.5, ups=0.19, wpb=17488, bsz=1024, num_updates=110, lr=2.34442e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=39, gb_free=13.6, wall=772
2024-11-06 13:55:06 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17657, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3313.7, ups=0.19, wpb=17657, bsz=1024, num_updates=120, lr=2.55754e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=36, gb_free=13.6, wall=825
2024-11-06 13:55:59 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17663.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3300.2, ups=0.19, wpb=17663.1, bsz=1024, num_updates=130, lr=2.77067e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=44, gb_free=13.5, wall=878
2024-11-06 13:56:52 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17542.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3342.6, ups=0.19, wpb=17542.9, bsz=1024, num_updates=140, lr=2.9838e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=51, gb_free=13.6, wall=931
2024-11-06 13:57:45 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17394.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3307.3, ups=0.19, wpb=17394.6, bsz=1024, num_updates=150, lr=3.19693e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=50, gb_free=13.4, wall=983
2024-11-06 13:58:37 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17608.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3352.6, ups=0.19, wpb=17608.3, bsz=1024, num_updates=160, lr=3.41006e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=1036
2024-11-06 13:59:30 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=18153.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3415.5, ups=0.19, wpb=18153.7, bsz=1024, num_updates=170, lr=3.62319e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1089
2024-11-06 14:00:23 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17369.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3310.2, ups=0.19, wpb=17369.1, bsz=1024, num_updates=180, lr=3.83632e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1142
2024-11-06 14:01:16 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17980.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3392.1, ups=0.19, wpb=17980.9, bsz=1024, num_updates=190, lr=4.04945e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1195
2024-11-06 14:02:08 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17957.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3413, ups=0.19, wpb=17957.7, bsz=1024, num_updates=200, lr=4.26257e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1247
2024-11-06 14:03:01 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17907.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3398.6, ups=0.19, wpb=17907.3, bsz=1024, num_updates=210, lr=4.4757e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1300
2024-11-06 14:03:54 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17882.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3369.4, ups=0.19, wpb=17882.3, bsz=1024, num_updates=220, lr=4.68883e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1353
2024-11-06 14:04:47 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17841, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3389.1, ups=0.19, wpb=17841, bsz=1024, num_updates=230, lr=4.90196e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1406
2024-11-06 14:05:40 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=18014.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3380.9, ups=0.19, wpb=18014.1, bsz=1024, num_updates=240, lr=5.11509e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1459
2024-11-06 14:06:34 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17552.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3258.9, ups=0.19, wpb=17552.9, bsz=1024, num_updates=250, lr=5.32822e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=33, gb_free=13.6, wall=1513
2024-11-06 14:07:28 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17776.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3301, ups=0.19, wpb=17776.1, bsz=1024, num_updates=260, lr=5.54135e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.6, wall=1567
2024-11-06 14:08:20 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17647.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3365.8, ups=0.19, wpb=17647.3, bsz=1024, num_updates=270, lr=5.75448e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.6, wall=1619
2024-11-06 14:09:13 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17675.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3352.7, ups=0.19, wpb=17675.8, bsz=1024, num_updates=280, lr=5.9676e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=53, gb_free=13.5, wall=1672
2024-11-06 14:10:05 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17688.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3373.2, ups=0.19, wpb=17688.6, bsz=1024, num_updates=290, lr=6.18073e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=47, gb_free=13.6, wall=1724
2024-11-06 14:10:59 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17589.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3305.7, ups=0.19, wpb=17589.2, bsz=1024, num_updates=300, lr=6.39386e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=43, gb_free=13.4, wall=1777
2024-11-06 14:11:51 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=18811.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3556.4, ups=0.19, wpb=18811.6, bsz=1024, num_updates=310, lr=6.60699e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=48, gb_free=13.4, wall=1830
2024-11-06 14:12:44 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=18484.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3515.4, ups=0.19, wpb=18484.5, bsz=1024, num_updates=320, lr=6.82012e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=46, gb_free=13.4, wall=1883
2024-11-06 14:13:36 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=18256.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3499.1, ups=0.19, wpb=18256.4, bsz=1024, num_updates=330, lr=7.03325e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=46, gb_free=13.4, wall=1935
2024-11-06 14:14:29 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=18254.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3484, ups=0.19, wpb=18254.4, bsz=1024, num_updates=340, lr=7.24638e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=50, gb_free=13.3, wall=1987
2024-11-06 14:15:21 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=18619.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3548.2, ups=0.19, wpb=18619.8, bsz=1024, num_updates=350, lr=7.45951e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=52, gb_free=13.3, wall=2040
2024-11-06 14:16:14 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=18682, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3546.4, ups=0.19, wpb=18682, bsz=1024, num_updates=360, lr=7.67263e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=53, gb_free=13.3, wall=2093
2024-11-06 14:17:06 - progress_bar.py[line:274] - INFO: epoch 001:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=18394.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3494.2, ups=0.19, wpb=18394.6, bsz=1024, num_updates=370, lr=7.88576e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=53, gb_free=13.3, wall=2145
2024-11-06 14:17:59 - progress_bar.py[line:274] - INFO: epoch 001:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17954.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3423.4, ups=0.19, wpb=17954.2, bsz=1024, num_updates=380, lr=8.09889e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=52, gb_free=13.4, wall=2198
reach the end of datafile, start a new reader
2024-11-06 14:18:51 - progress_bar.py[line:274] - INFO: epoch 001:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17998.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3424.5, ups=0.19, wpb=17998.3, bsz=1024, num_updates=390, lr=8.31202e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.5, wall=2250
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:18:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 391 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:18:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory

: No such file or directory: No such file or directory

cp: cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory

cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 14:19:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-06 14:19:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 391 updates, score 0) (writing took 21.988907869003015 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:19:20 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-06 14:19:20 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.621 | ntokens 17842.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.15 | wps 3340.1 | ups 0.19 | wpb 17842.9 | bsz 1023 | num_updates 391 | lr 8.33333e-06 | gnorm 0.003 | clip 0 | loss_scale 128 | train_wall 1640 | gb_free 13.4 | wall 2279
2024-11-06 14:19:20 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000



local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 14:21:58 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-06 14:21:58 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 14:22:47 - progress_bar.py[line:274] - INFO: epoch 002:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=16920.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=718.3, ups=0.04, wpb=16920.7, bsz=985.6, num_updates=400, lr=8.52515e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=29, gb_free=13.5, wall=2486
2024-11-06 14:23:39 - progress_bar.py[line:274] - INFO: epoch 002:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17781.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3409, ups=0.19, wpb=17781.7, bsz=1024, num_updates=410, lr=8.73828e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=2538
2024-11-06 14:24:31 - progress_bar.py[line:274] - INFO: epoch 002:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17664.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3398.3, ups=0.19, wpb=17664.5, bsz=1024, num_updates=420, lr=8.95141e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2590
2024-11-06 14:25:23 - progress_bar.py[line:274] - INFO: epoch 002:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17781.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3399.1, ups=0.19, wpb=17781.4, bsz=1024, num_updates=430, lr=9.16454e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2642
2024-11-06 14:26:16 - progress_bar.py[line:274] - INFO: epoch 002:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17766.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3384.9, ups=0.19, wpb=17766.1, bsz=1024, num_updates=440, lr=9.37766e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2695
2024-11-06 14:27:08 - progress_bar.py[line:274] - INFO: epoch 002:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17745.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3422.6, ups=0.19, wpb=17745.1, bsz=1024, num_updates=450, lr=9.59079e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2747
2024-11-06 14:28:00 - progress_bar.py[line:274] - INFO: epoch 002:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17994.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3428.4, ups=0.19, wpb=17994.6, bsz=1024, num_updates=460, lr=9.80392e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2799
2024-11-06 14:28:52 - progress_bar.py[line:274] - INFO: epoch 002:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17623, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3381.6, ups=0.19, wpb=17623, bsz=1024, num_updates=470, lr=1.00171e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2851
2024-11-06 14:29:44 - progress_bar.py[line:274] - INFO: epoch 002:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17736, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3411.6, ups=0.19, wpb=17736, bsz=1024, num_updates=480, lr=1.02302e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2903
2024-11-06 14:30:37 - progress_bar.py[line:274] - INFO: epoch 002:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17772.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3405.1, ups=0.19, wpb=17772.9, bsz=1024, num_updates=490, lr=1.04433e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2955
2024-11-06 14:31:29 - progress_bar.py[line:274] - INFO: epoch 002:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17619.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3343.4, ups=0.19, wpb=17619.3, bsz=1024, num_updates=500, lr=1.06564e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=3008
2024-11-06 14:32:22 - progress_bar.py[line:274] - INFO: epoch 002:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17921.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3376.6, ups=0.19, wpb=17921.9, bsz=1024, num_updates=510, lr=1.08696e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=3061
2024-11-06 14:33:14 - progress_bar.py[line:274] - INFO: epoch 002:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17451.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3354, ups=0.19, wpb=17451.5, bsz=1024, num_updates=520, lr=1.10827e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3113
2024-11-06 14:34:06 - progress_bar.py[line:274] - INFO: epoch 002:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17567.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3400, ups=0.19, wpb=17567.8, bsz=1024, num_updates=530, lr=1.12958e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3165
2024-11-06 14:35:02 - progress_bar.py[line:274] - INFO: epoch 002:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17618.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3136, ups=0.18, wpb=17618.6, bsz=1024, num_updates=540, lr=1.1509e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3221
2024-11-06 14:35:58 - progress_bar.py[line:274] - INFO: epoch 002:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17768.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3165.9, ups=0.18, wpb=17768.3, bsz=1024, num_updates=550, lr=1.17221e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3277
2024-11-06 14:36:51 - progress_bar.py[line:274] - INFO: epoch 002:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17867.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3370.3, ups=0.19, wpb=17867.5, bsz=1024, num_updates=560, lr=1.19352e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3330
2024-11-06 14:37:44 - progress_bar.py[line:274] - INFO: epoch 002:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17460.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3300.3, ups=0.19, wpb=17460.5, bsz=1024, num_updates=570, lr=1.21483e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3383
2024-11-06 14:38:36 - progress_bar.py[line:274] - INFO: epoch 002:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17606.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3391.3, ups=0.19, wpb=17606.1, bsz=1024, num_updates=580, lr=1.23615e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3435
2024-11-06 14:39:28 - progress_bar.py[line:274] - INFO: epoch 002:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=18257.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3522.3, ups=0.19, wpb=18257.9, bsz=1024, num_updates=590, lr=1.25746e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3487
2024-11-06 14:40:20 - progress_bar.py[line:274] - INFO: epoch 002:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17891.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3414.9, ups=0.19, wpb=17891.7, bsz=1024, num_updates=600, lr=1.27877e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=32, gb_free=13.4, wall=3539
2024-11-06 14:41:14 - progress_bar.py[line:274] - INFO: epoch 002:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17928.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3360.8, ups=0.19, wpb=17928.4, bsz=1024, num_updates=610, lr=1.30009e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=42, gb_free=13.4, wall=3593
2024-11-06 14:42:05 - progress_bar.py[line:274] - INFO: epoch 002:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17493.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3381.4, ups=0.19, wpb=17493.7, bsz=1024, num_updates=620, lr=1.3214e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=47, gb_free=13.5, wall=3644
2024-11-06 14:42:57 - progress_bar.py[line:274] - INFO: epoch 002:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17502.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3393.4, ups=0.19, wpb=17502.6, bsz=1024, num_updates=630, lr=1.34271e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=13.4, wall=3696
2024-11-06 14:43:50 - progress_bar.py[line:274] - INFO: epoch 002:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17517.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3323.3, ups=0.19, wpb=17517.1, bsz=1024, num_updates=640, lr=1.36402e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=34, gb_free=13.5, wall=3749
2024-11-06 14:44:45 - progress_bar.py[line:274] - INFO: epoch 002:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17444, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3155.7, ups=0.18, wpb=17444, bsz=1024, num_updates=650, lr=1.38534e-05, gnorm=0.007, clip=0, loss_scale=256, train_wall=50, gb_free=13.5, wall=3804
2024-11-06 14:45:39 - progress_bar.py[line:274] - INFO: epoch 002:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17774.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3288.6, ups=0.19, wpb=17774.7, bsz=1024, num_updates=660, lr=1.40665e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=54, gb_free=13.2, wall=3858
2024-11-06 14:46:32 - progress_bar.py[line:274] - INFO: epoch 002:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17653.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3352.5, ups=0.19, wpb=17653.5, bsz=1024, num_updates=670, lr=1.42796e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=53, gb_free=13.4, wall=3911
2024-11-06 14:47:24 - progress_bar.py[line:274] - INFO: epoch 002:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17454.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3340.2, ups=0.19, wpb=17454.1, bsz=1024, num_updates=680, lr=1.44928e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=3963
2024-11-06 14:48:16 - progress_bar.py[line:274] - INFO: epoch 002:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17843.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3411.2, ups=0.19, wpb=17843.2, bsz=1024, num_updates=690, lr=1.47059e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4015
2024-11-06 14:49:08 - progress_bar.py[line:274] - INFO: epoch 002:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=18559.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3574.3, ups=0.19, wpb=18559.6, bsz=1024, num_updates=700, lr=1.4919e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.2, wall=4067
2024-11-06 14:50:00 - progress_bar.py[line:274] - INFO: epoch 002:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=18438.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3570.9, ups=0.19, wpb=18438.7, bsz=1024, num_updates=710, lr=1.51321e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4119
2024-11-06 14:50:52 - progress_bar.py[line:274] - INFO: epoch 002:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=18044.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3482.1, ups=0.19, wpb=18044.4, bsz=1024, num_updates=720, lr=1.53453e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4171
2024-11-06 14:51:44 - progress_bar.py[line:274] - INFO: epoch 002:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=18149.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3473.4, ups=0.19, wpb=18149.8, bsz=1024, num_updates=730, lr=1.55584e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4223
2024-11-06 14:52:37 - progress_bar.py[line:274] - INFO: epoch 002:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=18508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3502.2, ups=0.19, wpb=18508.1, bsz=1024, num_updates=740, lr=1.57715e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=53, gb_free=13.3, wall=4276
2024-11-06 14:53:29 - progress_bar.py[line:274] - INFO: epoch 002:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=18280.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3503.5, ups=0.19, wpb=18280.9, bsz=1024, num_updates=750, lr=1.59847e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4328
2024-11-06 14:54:21 - progress_bar.py[line:274] - INFO: epoch 002:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18018.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3483.5, ups=0.19, wpb=18018.9, bsz=1024, num_updates=760, lr=1.61978e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4380
2024-11-06 14:55:12 - progress_bar.py[line:274] - INFO: epoch 002:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17930.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3469.3, ups=0.19, wpb=17930.3, bsz=1024, num_updates=770, lr=1.64109e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4431
2024-11-06 14:56:04 - progress_bar.py[line:274] - INFO: epoch 002:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17700.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3420.7, ups=0.19, wpb=17700.9, bsz=1024, num_updates=780, lr=1.6624e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4483
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-06 14:56:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 782 updates
2024-11-06 14:56:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 14:58:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-06 14:59:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 782 updates, score 0) (writing took 221.05887915899802 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 15:00:47 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-06 15:00:47 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.615 | ntokens 17795.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.13 | wps 2798.1 | ups 0.16 | wpb 17795.9 | bsz 1023 | num_updates 782 | lr 1.66667e-05 | gnorm 0.005 | clip 0 | loss_scale 256 | train_wall 1529 | gb_free 13.4 | wall 4765
2024-11-06 15:00:47 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 15:03:25 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-06 15:03:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 15:04:09 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=16694.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=344.3, ups=0.02, wpb=16694.7, bsz=985.6, num_updates=790, lr=1.68372e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=4968
2024-11-06 15:05:01 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17901.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3414.2, ups=0.19, wpb=17901.5, bsz=1024, num_updates=800, lr=1.70503e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5020
2024-11-06 15:05:53 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17881.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3463.3, ups=0.19, wpb=17881.7, bsz=1024, num_updates=810, lr=1.72634e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5072
2024-11-06 15:06:46 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17912.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3386.3, ups=0.19, wpb=17912.9, bsz=1024, num_updates=820, lr=1.74766e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5125
2024-11-06 15:07:38 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17721, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3407.6, ups=0.19, wpb=17721, bsz=1024, num_updates=830, lr=1.76897e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5177
2024-11-06 15:08:30 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17823.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3417, ups=0.19, wpb=17823.4, bsz=1024, num_updates=840, lr=1.79028e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5229
2024-11-06 15:09:23 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17643.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3361.1, ups=0.19, wpb=17643.4, bsz=1024, num_updates=850, lr=1.81159e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5281
2024-11-06 15:10:15 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17884.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3418, ups=0.19, wpb=17884.5, bsz=1024, num_updates=860, lr=1.83291e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5334
2024-11-06 15:11:08 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17202.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3252.9, ups=0.19, wpb=17202.1, bsz=1024, num_updates=870, lr=1.85422e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5387
2024-11-06 15:12:00 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17716, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3371.5, ups=0.19, wpb=17716, bsz=1024, num_updates=880, lr=1.87553e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5439
2024-11-06 15:12:53 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17544.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3354.7, ups=0.19, wpb=17544.8, bsz=1024, num_updates=890, lr=1.89685e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5492
2024-11-06 15:13:45 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17929.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3410.5, ups=0.19, wpb=17929.2, bsz=1024, num_updates=900, lr=1.91816e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5544
2024-11-06 15:14:38 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17466, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3307.3, ups=0.19, wpb=17466, bsz=1024, num_updates=910, lr=1.93947e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5597
2024-11-06 15:15:30 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17273.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3306.4, ups=0.19, wpb=17273.5, bsz=1024, num_updates=920, lr=1.96078e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5649
2024-11-06 15:16:22 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17656.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3424.5, ups=0.19, wpb=17656.9, bsz=1024, num_updates=930, lr=1.9821e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5701
2024-11-06 15:17:13 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17831.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3455, ups=0.19, wpb=17831.6, bsz=1024, num_updates=940, lr=2.00341e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5752
2024-11-06 15:18:06 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17982.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3452.8, ups=0.19, wpb=17982.9, bsz=1024, num_updates=950, lr=2.02472e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5804
2024-11-06 15:18:59 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17181.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3241, ups=0.19, wpb=17181.7, bsz=1024, num_updates=960, lr=2.04604e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5857
2024-11-06 15:19:51 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3420.2, ups=0.19, wpb=17835.7, bsz=1024, num_updates=970, lr=2.06735e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5910
2024-11-06 15:20:43 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17554.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3333.9, ups=0.19, wpb=17554.7, bsz=1024, num_updates=980, lr=2.08866e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=5962
2024-11-06 15:21:36 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17918.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3413.8, ups=0.19, wpb=17918.2, bsz=1024, num_updates=990, lr=2.10997e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6015
2024-11-06 15:22:28 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17536.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3354.8, ups=0.19, wpb=17536.7, bsz=1024, num_updates=1000, lr=2.13129e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6067
2024-11-06 15:23:21 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17771.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3364.2, ups=0.19, wpb=17771.9, bsz=1024, num_updates=1010, lr=2.1526e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=6120
2024-11-06 15:24:14 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17462.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3318, ups=0.19, wpb=17462.8, bsz=1024, num_updates=1020, lr=2.17391e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=6172
2024-11-06 15:25:06 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17702.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3399.1, ups=0.19, wpb=17702.6, bsz=1024, num_updates=1030, lr=2.19523e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6225
2024-11-06 15:25:58 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17357.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3303.3, ups=0.19, wpb=17357.6, bsz=1024, num_updates=1040, lr=2.21654e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=6277
2024-11-06 15:26:50 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=18249.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3506.3, ups=0.19, wpb=18249.6, bsz=1024, num_updates=1050, lr=2.23785e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6329
2024-11-06 15:27:43 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17764.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3395.4, ups=0.19, wpb=17764.1, bsz=1024, num_updates=1060, lr=2.25916e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6381
2024-11-06 15:28:34 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17227.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3326.3, ups=0.19, wpb=17227.8, bsz=1024, num_updates=1070, lr=2.28048e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=6433
2024-11-06 15:29:26 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17898.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3458.8, ups=0.19, wpb=17898.3, bsz=1024, num_updates=1080, lr=2.30179e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6485
2024-11-06 15:30:18 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=18402.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3531.2, ups=0.19, wpb=18402.7, bsz=1024, num_updates=1090, lr=2.3231e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=6537
2024-11-06 15:31:10 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=18312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3513.3, ups=0.19, wpb=18312.9, bsz=1024, num_updates=1100, lr=2.34442e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6589
2024-11-06 15:32:03 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=18118.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3472.9, ups=0.19, wpb=18118.6, bsz=1024, num_updates=1110, lr=2.36573e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6641
2024-11-06 15:32:54 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=18372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3546, ups=0.19, wpb=18372.7, bsz=1024, num_updates=1120, lr=2.38704e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6693
2024-11-06 15:33:46 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=18510.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3549.8, ups=0.19, wpb=18510.1, bsz=1024, num_updates=1130, lr=2.40835e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=34, gb_free=13.2, wall=6745
2024-11-06 15:34:39 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=18306.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3488, ups=0.19, wpb=18306.6, bsz=1024, num_updates=1140, lr=2.42967e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=45, gb_free=13.2, wall=6798
2024-11-06 15:35:31 - progress_bar.py[line:274] - INFO: epoch 003:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18037.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3442, ups=0.19, wpb=18037.1, bsz=1024, num_updates=1150, lr=2.45098e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=52, gb_free=13.4, wall=6850
2024-11-06 15:36:26 - progress_bar.py[line:274] - INFO: epoch 003:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17982.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3319.6, ups=0.18, wpb=17982.3, bsz=1024, num_updates=1160, lr=2.47229e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=6904
2024-11-06 15:37:19 - progress_bar.py[line:274] - INFO: epoch 003:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17965.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3349.7, ups=0.19, wpb=17965.8, bsz=1024, num_updates=1170, lr=2.49361e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=6958
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-06 15:37:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1173 updates


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-06 15:37:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 15:39:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 15:41:11 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1173 updates, score 0) (writing took 220.05015903500316 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 15:42:06 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-06 15:42:06 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.618 | ntokens 17784.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.14 | wps 2804.8 | ups 0.16 | wpb 17784.7 | bsz 1023 | num_updates 1173 | lr 2.5e-05 | gnorm 0.005 | clip 0 | loss_scale 512 | train_wall 1278 | gb_free 13.4 | wall 7245
2024-11-06 15:42:06 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 15:44:44 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-06 15:44:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 15:45:23 - progress_bar.py[line:274] - INFO: epoch 004:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=16998.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=351.1, ups=0.02, wpb=16998.2, bsz=985.6, num_updates=1180, lr=2.51492e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=33, gb_free=13.6, wall=7442
2024-11-06 15:46:15 - progress_bar.py[line:274] - INFO: epoch 004:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17917.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3430.4, ups=0.19, wpb=17917.9, bsz=1024, num_updates=1190, lr=2.53623e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7494
2024-11-06 15:47:08 - progress_bar.py[line:274] - INFO: epoch 004:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17656.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3370.5, ups=0.19, wpb=17656.8, bsz=1024, num_updates=1200, lr=2.55754e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7547
2024-11-06 15:48:01 - progress_bar.py[line:274] - INFO: epoch 004:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=18080.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3392.7, ups=0.19, wpb=18080.6, bsz=1024, num_updates=1210, lr=2.57886e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7600
2024-11-06 15:48:54 - progress_bar.py[line:274] - INFO: epoch 004:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17609.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3359.2, ups=0.19, wpb=17609.3, bsz=1024, num_updates=1220, lr=2.60017e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7652
2024-11-06 15:49:46 - progress_bar.py[line:274] - INFO: epoch 004:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17636.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3349.4, ups=0.19, wpb=17636.2, bsz=1024, num_updates=1230, lr=2.62148e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7705
2024-11-06 15:50:39 - progress_bar.py[line:274] - INFO: epoch 004:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17847.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3401.2, ups=0.19, wpb=17847.3, bsz=1024, num_updates=1240, lr=2.6428e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7758
2024-11-06 15:51:31 - progress_bar.py[line:274] - INFO: epoch 004:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17303.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3303.4, ups=0.19, wpb=17303.2, bsz=1024, num_updates=1250, lr=2.66411e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7810
2024-11-06 15:52:23 - progress_bar.py[line:274] - INFO: epoch 004:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17653.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3369.9, ups=0.19, wpb=17653.4, bsz=1024, num_updates=1260, lr=2.68542e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7862
2024-11-06 15:53:16 - progress_bar.py[line:274] - INFO: epoch 004:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17707, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3364.7, ups=0.19, wpb=17707, bsz=1024, num_updates=1270, lr=2.70673e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7915
2024-11-06 15:54:09 - progress_bar.py[line:274] - INFO: epoch 004:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17543.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3337.5, ups=0.19, wpb=17543.2, bsz=1024, num_updates=1280, lr=2.72805e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7968
2024-11-06 15:55:01 - progress_bar.py[line:274] - INFO: epoch 004:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17831.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3419.6, ups=0.19, wpb=17831.1, bsz=1024, num_updates=1290, lr=2.74936e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8020
2024-11-06 15:55:53 - progress_bar.py[line:274] - INFO: epoch 004:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17544.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3353.3, ups=0.19, wpb=17544.4, bsz=1024, num_updates=1300, lr=2.77067e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8072
2024-11-06 15:56:46 - progress_bar.py[line:274] - INFO: epoch 004:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17554.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3326.4, ups=0.19, wpb=17554.4, bsz=1024, num_updates=1310, lr=2.79199e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8125
2024-11-06 15:57:41 - progress_bar.py[line:274] - INFO: epoch 004:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17976, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3274.5, ups=0.18, wpb=17976, bsz=1024, num_updates=1320, lr=2.8133e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=44, gb_free=13.5, wall=8180
2024-11-06 15:58:36 - progress_bar.py[line:274] - INFO: epoch 004:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17645.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3175.7, ups=0.18, wpb=17645.7, bsz=1024, num_updates=1330, lr=2.83461e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=55, gb_free=13.6, wall=8235
2024-11-06 15:59:32 - progress_bar.py[line:274] - INFO: epoch 004:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=18192.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3267.3, ups=0.18, wpb=18192.6, bsz=1024, num_updates=1340, lr=2.85592e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=56, gb_free=13.5, wall=8291
2024-11-06 16:00:28 - progress_bar.py[line:274] - INFO: epoch 004:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17242.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3092.6, ups=0.18, wpb=17242.9, bsz=1024, num_updates=1350, lr=2.87724e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=56, gb_free=13.3, wall=8347
2024-11-06 16:01:21 - progress_bar.py[line:274] - INFO: epoch 004:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=18062.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3403, ups=0.19, wpb=18062.6, bsz=1024, num_updates=1360, lr=2.89855e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=53, gb_free=13.5, wall=8400
2024-11-06 16:02:13 - progress_bar.py[line:274] - INFO: epoch 004:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3414.7, ups=0.19, wpb=17833.4, bsz=1024, num_updates=1370, lr=2.91986e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=52, gb_free=13.4, wall=8452
2024-11-06 16:03:05 - progress_bar.py[line:274] - INFO: epoch 004:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17976.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3443.9, ups=0.19, wpb=17976.4, bsz=1024, num_updates=1380, lr=2.94118e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=52, gb_free=13.5, wall=8504
2024-11-06 16:03:57 - progress_bar.py[line:274] - INFO: epoch 004:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17835.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3460.6, ups=0.19, wpb=17835.3, bsz=1024, num_updates=1390, lr=2.96249e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=51, gb_free=13.5, wall=8556
2024-11-06 16:04:49 - progress_bar.py[line:274] - INFO: epoch 004:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17476.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3377.5, ups=0.19, wpb=17476.3, bsz=1024, num_updates=1400, lr=2.9838e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=51, gb_free=13.6, wall=8607
2024-11-06 16:05:40 - progress_bar.py[line:274] - INFO: epoch 004:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17513.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3387.5, ups=0.19, wpb=17513.1, bsz=1024, num_updates=1410, lr=3.00512e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=40, gb_free=13.6, wall=8659
2024-11-06 16:06:33 - progress_bar.py[line:274] - INFO: epoch 004:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3323.6, ups=0.19, wpb=17357.9, bsz=1024, num_updates=1420, lr=3.02643e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=40, gb_free=13.5, wall=8711
2024-11-06 16:07:25 - progress_bar.py[line:274] - INFO: epoch 004:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17406.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3342.2, ups=0.19, wpb=17406.1, bsz=1024, num_updates=1430, lr=3.04774e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=36, gb_free=13.4, wall=8763
2024-11-06 16:08:17 - progress_bar.py[line:274] - INFO: epoch 004:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17638.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3385.2, ups=0.19, wpb=17638.7, bsz=1024, num_updates=1440, lr=3.06905e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=33, gb_free=13.4, wall=8816
2024-11-06 16:09:09 - progress_bar.py[line:274] - INFO: epoch 004:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17655, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3357.9, ups=0.19, wpb=17655, bsz=1024, num_updates=1450, lr=3.09037e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8868
2024-11-06 16:10:02 - progress_bar.py[line:274] - INFO: epoch 004:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3353.7, ups=0.19, wpb=17540.6, bsz=1024, num_updates=1460, lr=3.11168e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8920
2024-11-06 16:10:54 - progress_bar.py[line:274] - INFO: epoch 004:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17814.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3369.9, ups=0.19, wpb=17814.3, bsz=1024, num_updates=1470, lr=3.13299e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=33, gb_free=13.4, wall=8973
2024-11-06 16:11:46 - progress_bar.py[line:274] - INFO: epoch 004:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=18544.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3571.2, ups=0.19, wpb=18544.4, bsz=1024, num_updates=1480, lr=3.15431e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=45, gb_free=13.4, wall=9025
2024-11-06 16:12:41 - progress_bar.py[line:274] - INFO: epoch 004:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18211.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3353.8, ups=0.18, wpb=18211.8, bsz=1024, num_updates=1490, lr=3.17562e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=50, gb_free=13.4, wall=9080
2024-11-06 16:13:37 - progress_bar.py[line:274] - INFO: epoch 004:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=18072.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3199.3, ups=0.18, wpb=18072.1, bsz=1024, num_updates=1500, lr=3.19693e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=56, gb_free=13.4, wall=9136
2024-11-06 16:14:34 - progress_bar.py[line:274] - INFO: epoch 004:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=18249.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3225.3, ups=0.18, wpb=18249.8, bsz=1024, num_updates=1510, lr=3.21824e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=56, gb_free=13.5, wall=9193
2024-11-06 16:15:29 - progress_bar.py[line:274] - INFO: epoch 004:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18504.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3332.5, ups=0.18, wpb=18504.8, bsz=1024, num_updates=1520, lr=3.23956e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=55, gb_free=13.4, wall=9248
2024-11-06 16:16:23 - progress_bar.py[line:274] - INFO: epoch 004:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=18409.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3428.1, ups=0.19, wpb=18409.7, bsz=1024, num_updates=1530, lr=3.26087e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=9302
2024-11-06 16:17:15 - progress_bar.py[line:274] - INFO: epoch 004:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=18013.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3489, ups=0.19, wpb=18013.3, bsz=1024, num_updates=1540, lr=3.28218e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=9354
2024-11-06 16:18:07 - progress_bar.py[line:274] - INFO: epoch 004:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=18417.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3526.6, ups=0.19, wpb=18417.8, bsz=1024, num_updates=1550, lr=3.3035e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=9406
2024-11-06 16:18:59 - progress_bar.py[line:274] - INFO: epoch 004:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17982.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3459.6, ups=0.19, wpb=17982.8, bsz=1024, num_updates=1560, lr=3.32481e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=9458
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt2024-11-06 16:19:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1564 updates


2024-11-06 16:19:16 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 16:21:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 16:22:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1564 updates, score 0) (writing took 221.1307931959891 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 16:23:52 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-06 16:23:52 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.627 | ntokens 17804.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.18 | wps 2778.1 | ups 0.16 | wpb 17804.6 | bsz 1023 | num_updates 1564 | lr 3.33333e-05 | gnorm 0.007 | clip 0 | loss_scale 1024 | train_wall 1618 | gb_free 13.4 | wall 9751
2024-11-06 16:23:52 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 16:26:31 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-06 16:26:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 16:27:05 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=16950.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=348.5, ups=0.02, wpb=16950.1, bsz=985.6, num_updates=1570, lr=3.34612e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=13.5, wall=9944
2024-11-06 16:27:59 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=18019.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3344.4, ups=0.19, wpb=18019.7, bsz=1024, num_updates=1580, lr=3.36743e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=35, gb_free=13.4, wall=9998
2024-11-06 16:28:55 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17669.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3148.8, ups=0.18, wpb=17669.1, bsz=1024, num_updates=1590, lr=3.38875e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=56, gb_free=13.5, wall=10054
2024-11-06 16:29:50 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18047.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3290.5, ups=0.18, wpb=18047.6, bsz=1024, num_updates=1600, lr=3.41006e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=55, gb_free=13.6, wall=10109
2024-11-06 16:30:44 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17636.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3248.7, ups=0.18, wpb=17636.6, bsz=1024, num_updates=1610, lr=3.43137e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=54, gb_free=13.5, wall=10163
2024-11-06 16:31:37 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17429.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3321.2, ups=0.19, wpb=17429.8, bsz=1024, num_updates=1620, lr=3.45269e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=10216
2024-11-06 16:32:32 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17821, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3209.1, ups=0.18, wpb=17821, bsz=1024, num_updates=1630, lr=3.474e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=55, gb_free=13.3, wall=10271
2024-11-06 16:33:27 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17513, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3201.7, ups=0.18, wpb=17513, bsz=1024, num_updates=1640, lr=3.49531e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=55, gb_free=13.5, wall=10326
2024-11-06 16:34:19 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17536.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3345.3, ups=0.19, wpb=17536.2, bsz=1024, num_updates=1650, lr=3.51662e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=52, gb_free=13.5, wall=10378
2024-11-06 16:35:11 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17748.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3417.4, ups=0.19, wpb=17748.1, bsz=1024, num_updates=1660, lr=3.53794e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=52, gb_free=13.6, wall=10430
2024-11-06 16:36:03 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17450.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3399.2, ups=0.19, wpb=17450.6, bsz=1024, num_updates=1670, lr=3.55925e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=51, gb_free=13.4, wall=10482
2024-11-06 16:36:55 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17766.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3404.9, ups=0.19, wpb=17766.7, bsz=1024, num_updates=1680, lr=3.58056e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=46, gb_free=13.5, wall=10534
2024-11-06 16:37:47 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17573.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3400.2, ups=0.19, wpb=17573.9, bsz=1024, num_updates=1690, lr=3.60188e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=38, gb_free=13.6, wall=10585
2024-11-06 16:38:39 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17717.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3390.5, ups=0.19, wpb=17717.7, bsz=1024, num_updates=1700, lr=3.62319e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=34, gb_free=13.5, wall=10638
2024-11-06 16:39:32 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17535.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3328.6, ups=0.19, wpb=17535.7, bsz=1024, num_updates=1710, lr=3.6445e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=38, gb_free=13.5, wall=10690
2024-11-06 16:40:23 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17543.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3379.6, ups=0.19, wpb=17543.9, bsz=1024, num_updates=1720, lr=3.66581e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=39, gb_free=13.5, wall=10742
2024-11-06 16:41:15 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17868.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3447.4, ups=0.19, wpb=17868.5, bsz=1024, num_updates=1730, lr=3.68713e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=34, gb_free=13.4, wall=10794
2024-11-06 16:42:08 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17478.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3295.5, ups=0.19, wpb=17478.3, bsz=1024, num_updates=1740, lr=3.70844e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10847
2024-11-06 16:43:00 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17764.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3414.2, ups=0.19, wpb=17764.2, bsz=1024, num_updates=1750, lr=3.72975e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10899
2024-11-06 16:43:53 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17853.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3388.3, ups=0.19, wpb=17853.7, bsz=1024, num_updates=1760, lr=3.75107e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10952
2024-11-06 16:44:45 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=18052.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3459.5, ups=0.19, wpb=18052.6, bsz=1024, num_updates=1770, lr=3.77238e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11004
2024-11-06 16:45:38 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17732.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3386.7, ups=0.19, wpb=17732.1, bsz=1024, num_updates=1780, lr=3.79369e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=34, gb_free=13.5, wall=11056
2024-11-06 16:46:30 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17857.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3413.4, ups=0.19, wpb=17857.3, bsz=1024, num_updates=1790, lr=3.815e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=33, gb_free=13.5, wall=11109
2024-11-06 16:47:23 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17412.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3289.9, ups=0.19, wpb=17412.3, bsz=1024, num_updates=1800, lr=3.83632e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.6, wall=11162
2024-11-06 16:48:16 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17639, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3309, ups=0.19, wpb=17639, bsz=1024, num_updates=1810, lr=3.85763e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=41, gb_free=13.6, wall=11215
2024-11-06 16:49:09 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17767.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3360.2, ups=0.19, wpb=17767.7, bsz=1024, num_updates=1820, lr=3.87894e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=41, gb_free=13.4, wall=11268
2024-11-06 16:50:02 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17693.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3347.5, ups=0.19, wpb=17693.7, bsz=1024, num_updates=1830, lr=3.90026e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=43, gb_free=13.5, wall=11321
2024-11-06 16:50:54 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17650.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3361.1, ups=0.19, wpb=17650.6, bsz=1024, num_updates=1840, lr=3.92157e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=47, gb_free=13.5, wall=11373
2024-11-06 16:51:47 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17649.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3366.7, ups=0.19, wpb=17649.4, bsz=1024, num_updates=1850, lr=3.94288e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=46, gb_free=13.5, wall=11426
2024-11-06 16:52:39 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17541.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3373.2, ups=0.19, wpb=17541.8, bsz=1024, num_updates=1860, lr=3.96419e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=45, gb_free=13.4, wall=11478
2024-11-06 16:53:31 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=18415.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3511, ups=0.19, wpb=18415.1, bsz=1024, num_updates=1870, lr=3.98551e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=48, gb_free=13.4, wall=11530
2024-11-06 16:54:23 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=18160, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3498.5, ups=0.19, wpb=18160, bsz=1024, num_updates=1880, lr=4.00682e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=52, gb_free=13.5, wall=11582
2024-11-06 16:55:16 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17951.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3406.4, ups=0.19, wpb=17951.5, bsz=1024, num_updates=1890, lr=4.02813e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=53, gb_free=13.4, wall=11635
2024-11-06 16:56:09 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=18088.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3420.3, ups=0.19, wpb=18088.2, bsz=1024, num_updates=1900, lr=4.04945e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=53, gb_free=13.5, wall=11688
2024-11-06 16:57:01 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=18104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3441.7, ups=0.19, wpb=18104.2, bsz=1024, num_updates=1910, lr=4.07076e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=53, gb_free=13.5, wall=11740
2024-11-06 16:57:53 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=18218.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3494.5, ups=0.19, wpb=18218.3, bsz=1024, num_updates=1920, lr=4.09207e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=11792
2024-11-06 16:58:46 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17962.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3398.4, ups=0.19, wpb=17962.1, bsz=1024, num_updates=1930, lr=4.11338e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=53, gb_free=13.4, wall=11845
2024-11-06 16:59:38 - progress_bar.py[line:274] - INFO: epoch 005:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=18236.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3525.5, ups=0.19, wpb=18236.2, bsz=1024, num_updates=1940, lr=4.1347e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=11897
2024-11-06 17:00:30 - progress_bar.py[line:274] - INFO: epoch 005:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17753.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3400, ups=0.19, wpb=17753.8, bsz=1024, num_updates=1950, lr=4.15601e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=11949
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt2024-11-06 17:00:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1955 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt

2024-11-06 17:00:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 17:02:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 17:04:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1955 updates, score 0) (writing took 221.5284793380124 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 17:05:29 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-06 17:05:29 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.63 | ntokens 17766 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.19 | wps 2781.8 | ups 0.16 | wpb 17766 | bsz 1023 | num_updates 1955 | lr 4.16667e-05 | gnorm 0.008 | clip 0 | loss_scale 1024 | train_wall 1738 | gb_free 13.3 | wall 12248
2024-11-06 17:05:29 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 17:08:08 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-06 17:08:08 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 17:08:36 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=16956.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=348.9, ups=0.02, wpb=16956.5, bsz=985.6, num_updates=1960, lr=4.17732e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=38, gb_free=13.6, wall=12435
2024-11-06 17:09:29 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17600.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3366.8, ups=0.19, wpb=17600.6, bsz=1024, num_updates=1970, lr=4.19864e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12487
2024-11-06 17:10:20 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17796.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3424.6, ups=0.19, wpb=17796.8, bsz=1024, num_updates=1980, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12539
2024-11-06 17:11:13 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17729.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3373, ups=0.19, wpb=17729.1, bsz=1024, num_updates=1990, lr=4.24126e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12592
2024-11-06 17:12:05 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17528.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3354.9, ups=0.19, wpb=17528.1, bsz=1024, num_updates=2000, lr=4.26257e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=12644
2024-11-06 17:12:57 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17694, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3400.5, ups=0.19, wpb=17694, bsz=1024, num_updates=2010, lr=4.28389e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12696
2024-11-06 17:13:49 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17532.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3392.1, ups=0.19, wpb=17532.2, bsz=1024, num_updates=2020, lr=4.3052e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.6, wall=12748
2024-11-06 17:14:41 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18014.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3449.4, ups=0.19, wpb=18014.1, bsz=1024, num_updates=2030, lr=4.32651e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12800
2024-11-06 17:15:33 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17453, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3355.1, ups=0.19, wpb=17453, bsz=1024, num_updates=2040, lr=4.34783e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12852
2024-11-06 17:16:25 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3424.8, ups=0.19, wpb=17828, bsz=1024, num_updates=2050, lr=4.36914e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=12904
2024-11-06 17:17:17 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17386.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3333, ups=0.19, wpb=17386.2, bsz=1024, num_updates=2060, lr=4.39045e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=12956
2024-11-06 17:18:09 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17505, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3378.6, ups=0.19, wpb=17505, bsz=1024, num_updates=2070, lr=4.41176e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13008
2024-11-06 17:19:01 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17815.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3415.9, ups=0.19, wpb=17815.9, bsz=1024, num_updates=2080, lr=4.43308e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13060
2024-11-06 17:19:54 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17692.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3377.3, ups=0.19, wpb=17692.8, bsz=1024, num_updates=2090, lr=4.45439e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13113
2024-11-06 17:20:46 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17534.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3343.6, ups=0.19, wpb=17534.2, bsz=1024, num_updates=2100, lr=4.4757e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=13165
2024-11-06 17:21:39 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17791.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3389.5, ups=0.19, wpb=17791.4, bsz=1024, num_updates=2110, lr=4.49702e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13218
2024-11-06 17:22:32 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17780.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3312.9, ups=0.19, wpb=17780.2, bsz=1024, num_updates=2120, lr=4.51833e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=33, gb_free=13.6, wall=13271
2024-11-06 17:23:27 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17622.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3257.1, ups=0.18, wpb=17622.4, bsz=1024, num_updates=2130, lr=4.53964e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=49, gb_free=13.5, wall=13325
2024-11-06 17:24:22 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17660.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3175.1, ups=0.18, wpb=17660.9, bsz=1024, num_updates=2140, lr=4.56095e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=56, gb_free=13.5, wall=13381
2024-11-06 17:25:15 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17894.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3413.9, ups=0.19, wpb=17894.8, bsz=1024, num_updates=2150, lr=4.58227e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13433
2024-11-06 17:26:07 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17892.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3383.9, ups=0.19, wpb=17892.5, bsz=1024, num_updates=2160, lr=4.60358e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13486
2024-11-06 17:27:02 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17744.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3269.5, ups=0.18, wpb=17744.5, bsz=1024, num_updates=2170, lr=4.62489e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=54, gb_free=13.6, wall=13541
2024-11-06 17:27:54 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17851.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3446.4, ups=0.19, wpb=17851.1, bsz=1024, num_updates=2180, lr=4.64621e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13592
2024-11-06 17:28:45 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17608.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3404.7, ups=0.19, wpb=17608.7, bsz=1024, num_updates=2190, lr=4.66752e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13644
2024-11-06 17:29:37 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17412.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3343.5, ups=0.19, wpb=17412.8, bsz=1024, num_updates=2200, lr=4.68883e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13696
2024-11-06 17:30:32 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17651.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3223.4, ups=0.18, wpb=17651.2, bsz=1024, num_updates=2210, lr=4.71014e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=13751
2024-11-06 17:31:25 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17978.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3418.8, ups=0.19, wpb=17978.2, bsz=1024, num_updates=2220, lr=4.73146e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13804
2024-11-06 17:32:17 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17633.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3368.6, ups=0.19, wpb=17633.2, bsz=1024, num_updates=2230, lr=4.75277e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13856
2024-11-06 17:33:09 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17538.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3364.2, ups=0.19, wpb=17538.6, bsz=1024, num_updates=2240, lr=4.77408e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13908
2024-11-06 17:34:02 - progress_bar.py[line:274] - INFO: epoch 006:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17736.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3370.1, ups=0.19, wpb=17736.7, bsz=1024, num_updates=2250, lr=4.7954e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13961
2024-11-06 17:34:54 - progress_bar.py[line:274] - INFO: epoch 006:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=18116.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3472, ups=0.19, wpb=18116.1, bsz=1024, num_updates=2260, lr=4.81671e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=14013
2024-11-06 17:35:46 - progress_bar.py[line:274] - INFO: epoch 006:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=18532.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3548.6, ups=0.19, wpb=18532.7, bsz=1024, num_updates=2270, lr=4.83802e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14065
2024-11-06 17:36:38 - progress_bar.py[line:274] - INFO: epoch 006:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=18034.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3470.6, ups=0.19, wpb=18034.4, bsz=1024, num_updates=2280, lr=4.85934e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14117
2024-11-06 17:37:30 - progress_bar.py[line:274] - INFO: epoch 006:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=18357.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3534.1, ups=0.19, wpb=18357.4, bsz=1024, num_updates=2290, lr=4.88065e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14169
2024-11-06 17:38:25 - progress_bar.py[line:274] - INFO: epoch 006:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=18123.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3307.9, ups=0.18, wpb=18123.6, bsz=1024, num_updates=2300, lr=4.90196e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=14224
2024-11-06 17:39:17 - progress_bar.py[line:274] - INFO: epoch 006:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=18383.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3508.4, ups=0.19, wpb=18383.4, bsz=1024, num_updates=2310, lr=4.92327e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14276
2024-11-06 17:40:09 - progress_bar.py[line:274] - INFO: epoch 006:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=18150.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3482.3, ups=0.19, wpb=18150.1, bsz=1024, num_updates=2320, lr=4.94459e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=14328
2024-11-06 17:41:02 - progress_bar.py[line:274] - INFO: epoch 006:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=18110.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3477.1, ups=0.19, wpb=18110.2, bsz=1024, num_updates=2330, lr=4.9659e-05, gnorm=0.014, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=14380
2024-11-06 17:41:53 - progress_bar.py[line:274] - INFO: epoch 006:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17669.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3402.8, ups=0.19, wpb=17669.9, bsz=1024, num_updates=2340, lr=4.98721e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14432
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-06 17:42:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2346 updates

2024-11-06 17:42:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt': File exists
: File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 17:44:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-06 17:46:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2346 updates, score 0) (writing took 221.55774336399918 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 17:46:57 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-06 17:46:57 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.656 | ntokens 17784.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.3 | wps 2794.5 | ups 0.16 | wpb 17784.1 | bsz 1023 | num_updates 2346 | lr 5e-05 | gnorm 0.008 | clip 0 | loss_scale 2048 | train_wall 1686 | gb_free 13.3 | wall 14736
2024-11-06 17:46:57 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 17:49:36 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-06 17:49:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 17:50:00 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17194.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=353.7, ups=0.02, wpb=17194.7, bsz=985.6, num_updates=2350, lr=4.99946e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=40, gb_free=13.6, wall=14918
2024-11-06 17:50:52 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17776.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3385.9, ups=0.19, wpb=17776.3, bsz=1024, num_updates=2360, lr=4.9981e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=14971
2024-11-06 17:51:45 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17561.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3329.1, ups=0.19, wpb=17561.7, bsz=1024, num_updates=2370, lr=4.99674e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15024
2024-11-06 17:52:38 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18089.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3423, ups=0.19, wpb=18089.7, bsz=1024, num_updates=2380, lr=4.99537e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15077
2024-11-06 17:53:31 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17575, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3316.8, ups=0.19, wpb=17575, bsz=1024, num_updates=2390, lr=4.99401e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15130
2024-11-06 17:54:24 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17857.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3350.3, ups=0.19, wpb=17857.9, bsz=1024, num_updates=2400, lr=4.99265e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15183
2024-11-06 17:55:17 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17915.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3402.1, ups=0.19, wpb=17915.1, bsz=1024, num_updates=2410, lr=4.99129e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15235
2024-11-06 17:56:10 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17736.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3320, ups=0.19, wpb=17736.8, bsz=1024, num_updates=2420, lr=4.98993e-05, gnorm=0.014, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=15289
2024-11-06 17:57:04 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17626.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3254.3, ups=0.18, wpb=17626.6, bsz=1024, num_updates=2430, lr=4.98857e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15343
2024-11-06 17:57:58 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17901.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3317.7, ups=0.19, wpb=17901.8, bsz=1024, num_updates=2440, lr=4.98721e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15397
2024-11-06 17:58:52 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17759.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3329.2, ups=0.19, wpb=17759.9, bsz=1024, num_updates=2450, lr=4.98585e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15450
2024-11-06 17:59:45 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17760.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3350.8, ups=0.19, wpb=17760.6, bsz=1024, num_updates=2460, lr=4.98449e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15503
2024-11-06 18:00:37 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17529.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3355, ups=0.19, wpb=17529.9, bsz=1024, num_updates=2470, lr=4.98313e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15556
2024-11-06 18:01:29 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17282.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3336.2, ups=0.19, wpb=17282.4, bsz=1024, num_updates=2480, lr=4.98177e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15607
2024-11-06 18:02:21 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17853.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3419.8, ups=0.19, wpb=17853.9, bsz=1024, num_updates=2490, lr=4.98041e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15660
2024-11-06 18:03:13 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17790.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3419.2, ups=0.19, wpb=17790.8, bsz=1024, num_updates=2500, lr=4.97905e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15712
2024-11-06 18:04:05 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17768.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3377.6, ups=0.19, wpb=17768.3, bsz=1024, num_updates=2510, lr=4.97769e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15764
2024-11-06 18:04:57 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17920.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3447, ups=0.19, wpb=17920.7, bsz=1024, num_updates=2520, lr=4.97633e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=15816
2024-11-06 18:05:49 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17346.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3338.8, ups=0.19, wpb=17346.3, bsz=1024, num_updates=2530, lr=4.97497e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15868
2024-11-06 18:06:42 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17869.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3426.7, ups=0.19, wpb=17869.5, bsz=1024, num_updates=2540, lr=4.97361e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15920
2024-11-06 18:07:34 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17821.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3414.7, ups=0.19, wpb=17821.4, bsz=1024, num_updates=2550, lr=4.97225e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15973
2024-11-06 18:08:26 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=18120.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3434.4, ups=0.19, wpb=18120.2, bsz=1024, num_updates=2560, lr=4.97089e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=16025
2024-11-06 18:09:19 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17745.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3388.9, ups=0.19, wpb=17745.7, bsz=1024, num_updates=2570, lr=4.96953e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16078
2024-11-06 18:10:11 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17390.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3319.3, ups=0.19, wpb=17390.6, bsz=1024, num_updates=2580, lr=4.96817e-05, gnorm=0.015, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16130
2024-11-06 18:11:03 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17671.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3383.1, ups=0.19, wpb=17671.1, bsz=1024, num_updates=2590, lr=4.96681e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16182
2024-11-06 18:11:56 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17862, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3422.6, ups=0.19, wpb=17862, bsz=1024, num_updates=2600, lr=4.96545e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16235
2024-11-06 18:12:47 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17673.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3419, ups=0.19, wpb=17673.5, bsz=1024, num_updates=2610, lr=4.96409e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16286
2024-11-06 18:13:40 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17901.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3420.6, ups=0.19, wpb=17901.4, bsz=1024, num_updates=2620, lr=4.96273e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16339
2024-11-06 18:14:32 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17429.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3362.3, ups=0.19, wpb=17429.2, bsz=1024, num_updates=2630, lr=4.96136e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16390
2024-11-06 18:15:24 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17591.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3361.5, ups=0.19, wpb=17591.7, bsz=1024, num_updates=2640, lr=4.96e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16443
2024-11-06 18:16:16 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=18256.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3525, ups=0.19, wpb=18256.5, bsz=1024, num_updates=2650, lr=4.95864e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=32, gb_free=13.3, wall=16495
2024-11-06 18:17:09 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=18767.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3514.4, ups=0.19, wpb=18767.4, bsz=1024, num_updates=2660, lr=4.95728e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=48, gb_free=13.2, wall=16548
2024-11-06 18:18:02 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=18130.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3429.3, ups=0.19, wpb=18130.8, bsz=1024, num_updates=2670, lr=4.95592e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=53, gb_free=13.4, wall=16601
2024-11-06 18:18:55 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=18209.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3400.8, ups=0.19, wpb=18209.3, bsz=1024, num_updates=2680, lr=4.95456e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=53, gb_free=13.5, wall=16654
2024-11-06 18:19:48 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17916.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3418.8, ups=0.19, wpb=17916.4, bsz=1024, num_updates=2690, lr=4.9532e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=16707
2024-11-06 18:20:40 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=18730.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3619.4, ups=0.19, wpb=18730.4, bsz=1024, num_updates=2700, lr=4.95184e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=52, gb_free=13.1, wall=16758
2024-11-06 18:21:34 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=18436.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3417.3, ups=0.19, wpb=18436.4, bsz=1024, num_updates=2710, lr=4.95048e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=54, gb_free=13.4, wall=16812
2024-11-06 18:22:26 - progress_bar.py[line:274] - INFO: epoch 007:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17946, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3453.8, ups=0.19, wpb=17946, bsz=1024, num_updates=2720, lr=4.94912e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=52, gb_free=13.3, wall=16864
2024-11-06 18:23:17 - progress_bar.py[line:274] - INFO: epoch 007:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=18220.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3525.6, ups=0.19, wpb=18220.8, bsz=1024, num_updates=2730, lr=4.94776e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=16916
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt2024-11-06 18:23:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2737 updates


2024-11-06 18:23:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 18:25:41 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-06 18:27:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2737 updates, score 0) (writing took 222.42839722700592 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 18:28:27 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-06 18:28:27 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.658 | ntokens 17839.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.31 | wps 2801.4 | ups 0.16 | wpb 17839.9 | bsz 1023 | num_updates 2737 | lr 4.94681e-05 | gnorm 0.009 | clip 0 | loss_scale 4096 | train_wall 1375 | gb_free 13.4 | wall 17226
2024-11-06 18:28:27 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 18:31:06 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-06 18:31:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 18:31:24 - progress_bar.py[line:274] - INFO: epoch 008:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17100.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=351.1, ups=0.02, wpb=17100.5, bsz=985.6, num_updates=2740, lr=4.9464e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=42, gb_free=13.5, wall=17403
2024-11-06 18:32:16 - progress_bar.py[line:274] - INFO: epoch 008:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17414.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3354, ups=0.19, wpb=17414.2, bsz=1024, num_updates=2750, lr=4.94504e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17455
2024-11-06 18:33:10 - progress_bar.py[line:274] - INFO: epoch 008:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17912, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3321.6, ups=0.19, wpb=17912, bsz=1024, num_updates=2760, lr=4.94368e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=37, gb_free=13.6, wall=17509
2024-11-06 18:34:02 - progress_bar.py[line:274] - INFO: epoch 008:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17865.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3433.4, ups=0.19, wpb=17865.8, bsz=1024, num_updates=2770, lr=4.94232e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17561
2024-11-06 18:34:54 - progress_bar.py[line:274] - INFO: epoch 008:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17511.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3386.9, ups=0.19, wpb=17511.3, bsz=1024, num_updates=2780, lr=4.94096e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=50, gb_free=13.4, wall=17613
2024-11-06 18:35:46 - progress_bar.py[line:274] - INFO: epoch 008:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17472.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3334.6, ups=0.19, wpb=17472.5, bsz=1024, num_updates=2790, lr=4.9396e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=50, gb_free=13.5, wall=17665
2024-11-06 18:36:38 - progress_bar.py[line:274] - INFO: epoch 008:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18033.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3471.1, ups=0.19, wpb=18033.8, bsz=1024, num_updates=2800, lr=4.93824e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=50, gb_free=13.4, wall=17717
2024-11-06 18:37:31 - progress_bar.py[line:274] - INFO: epoch 008:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17705.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3374.4, ups=0.19, wpb=17705.5, bsz=1024, num_updates=2810, lr=4.93688e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17770
2024-11-06 18:38:23 - progress_bar.py[line:274] - INFO: epoch 008:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17328.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3316.8, ups=0.19, wpb=17328.2, bsz=1024, num_updates=2820, lr=4.93552e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17822
2024-11-06 18:39:15 - progress_bar.py[line:274] - INFO: epoch 008:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17708, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3415.6, ups=0.19, wpb=17708, bsz=1024, num_updates=2830, lr=4.93416e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=49, gb_free=13.4, wall=17874
2024-11-06 18:40:07 - progress_bar.py[line:274] - INFO: epoch 008:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17518.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3366.4, ups=0.19, wpb=17518.6, bsz=1024, num_updates=2840, lr=4.9328e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=46, gb_free=13.6, wall=17926
2024-11-06 18:41:02 - progress_bar.py[line:274] - INFO: epoch 008:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17769.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3240.9, ups=0.18, wpb=17769.1, bsz=1024, num_updates=2850, lr=4.93144e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=53, gb_free=13.5, wall=17981
2024-11-06 18:41:53 - progress_bar.py[line:274] - INFO: epoch 008:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3459.6, ups=0.19, wpb=17828, bsz=1024, num_updates=2860, lr=4.93008e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=51, gb_free=13.6, wall=18032
2024-11-06 18:42:45 - progress_bar.py[line:274] - INFO: epoch 008:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17679.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3401.1, ups=0.19, wpb=17679.5, bsz=1024, num_updates=2870, lr=4.92872e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=40, gb_free=13.5, wall=18084
2024-11-06 18:43:40 - progress_bar.py[line:274] - INFO: epoch 008:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17740.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3244.9, ups=0.18, wpb=17740.8, bsz=1024, num_updates=2880, lr=4.92735e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=36, gb_free=13.3, wall=18139
2024-11-06 18:44:33 - progress_bar.py[line:274] - INFO: epoch 008:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17721.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3348.6, ups=0.19, wpb=17721.6, bsz=1024, num_updates=2890, lr=4.92599e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=42, gb_free=13.6, wall=18192
2024-11-06 18:45:26 - progress_bar.py[line:274] - INFO: epoch 008:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17699.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3330.8, ups=0.19, wpb=17699.2, bsz=1024, num_updates=2900, lr=4.92463e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=32, gb_free=13.5, wall=18245
2024-11-06 18:46:19 - progress_bar.py[line:274] - INFO: epoch 008:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17743.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3343.1, ups=0.19, wpb=17743.7, bsz=1024, num_updates=2910, lr=4.92327e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18298
2024-11-06 18:47:12 - progress_bar.py[line:274] - INFO: epoch 008:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17318.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3278.5, ups=0.19, wpb=17318.7, bsz=1024, num_updates=2920, lr=4.92191e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18351
2024-11-06 18:48:04 - progress_bar.py[line:274] - INFO: epoch 008:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17854, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3402.4, ups=0.19, wpb=17854, bsz=1024, num_updates=2930, lr=4.92055e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18403
2024-11-06 18:48:57 - progress_bar.py[line:274] - INFO: epoch 008:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=18015.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3440.2, ups=0.19, wpb=18015.2, bsz=1024, num_updates=2940, lr=4.91919e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18456
2024-11-06 18:49:49 - progress_bar.py[line:274] - INFO: epoch 008:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18036.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3443.7, ups=0.19, wpb=18036.2, bsz=1024, num_updates=2950, lr=4.91783e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18508
2024-11-06 18:50:42 - progress_bar.py[line:274] - INFO: epoch 008:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17810.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3384.8, ups=0.19, wpb=17810.8, bsz=1024, num_updates=2960, lr=4.91647e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18561
2024-11-06 18:51:34 - progress_bar.py[line:274] - INFO: epoch 008:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17937.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3418.2, ups=0.19, wpb=17937.7, bsz=1024, num_updates=2970, lr=4.91511e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18613
2024-11-06 18:52:26 - progress_bar.py[line:274] - INFO: epoch 008:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17626.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3382.7, ups=0.19, wpb=17626.8, bsz=1024, num_updates=2980, lr=4.91375e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18665
2024-11-06 18:53:18 - progress_bar.py[line:274] - INFO: epoch 008:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17410.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3336.7, ups=0.19, wpb=17410.1, bsz=1024, num_updates=2990, lr=4.91239e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18717
2024-11-06 18:54:11 - progress_bar.py[line:274] - INFO: epoch 008:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17756.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3396.7, ups=0.19, wpb=17756.9, bsz=1024, num_updates=3000, lr=4.91103e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18770
2024-11-06 18:55:03 - progress_bar.py[line:274] - INFO: epoch 008:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17970.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3452.6, ups=0.19, wpb=17970.2, bsz=1024, num_updates=3010, lr=4.90967e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18822
2024-11-06 18:55:55 - progress_bar.py[line:274] - INFO: epoch 008:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17699.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3376.5, ups=0.19, wpb=17699.8, bsz=1024, num_updates=3020, lr=4.90831e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.6, wall=18874
2024-11-06 18:56:49 - progress_bar.py[line:274] - INFO: epoch 008:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17659.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3251.4, ups=0.18, wpb=17659.2, bsz=1024, num_updates=3030, lr=4.90695e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=47, gb_free=13.5, wall=18928
2024-11-06 18:57:42 - progress_bar.py[line:274] - INFO: epoch 008:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=18053, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3446, ups=0.19, wpb=18053, bsz=1024, num_updates=3040, lr=4.90559e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=18981
2024-11-06 18:58:35 - progress_bar.py[line:274] - INFO: epoch 008:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=18369.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3474.8, ups=0.19, wpb=18369.3, bsz=1024, num_updates=3050, lr=4.90423e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=53, gb_free=13.4, wall=19034
2024-11-06 18:59:26 - progress_bar.py[line:274] - INFO: epoch 008:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17966.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3481.2, ups=0.19, wpb=17966.4, bsz=1024, num_updates=3060, lr=4.90287e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=19085
2024-11-06 19:00:19 - progress_bar.py[line:274] - INFO: epoch 008:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=18654.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3575.1, ups=0.19, wpb=18654.4, bsz=1024, num_updates=3070, lr=4.90151e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=52, gb_free=13.1, wall=19137
2024-11-06 19:01:11 - progress_bar.py[line:274] - INFO: epoch 008:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=18152.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3489.7, ups=0.19, wpb=18152.6, bsz=1024, num_updates=3080, lr=4.90015e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=19189
2024-11-06 19:02:02 - progress_bar.py[line:274] - INFO: epoch 008:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=18466.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3580.5, ups=0.19, wpb=18466.4, bsz=1024, num_updates=3090, lr=4.89879e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=51, gb_free=13.4, wall=19241
2024-11-06 19:02:55 - progress_bar.py[line:274] - INFO: epoch 008:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=18319.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3488.3, ups=0.19, wpb=18319.5, bsz=1024, num_updates=3100, lr=4.89743e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=19294
2024-11-06 19:03:47 - progress_bar.py[line:274] - INFO: epoch 008:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18187.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3483, ups=0.19, wpb=18187.8, bsz=1024, num_updates=3110, lr=4.89607e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=19346
2024-11-06 19:04:40 - progress_bar.py[line:274] - INFO: epoch 008:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17865.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3366.4, ups=0.19, wpb=17865.5, bsz=1024, num_updates=3120, lr=4.89471e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=19399
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt2024-11-06 19:05:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 3128 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-06 19:05:18 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 19:07:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-06 19:09:01 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 3128 updates, score 0) (writing took 222.50548460400023 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 19:09:55 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-06 19:09:55 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.638 | ntokens 17819.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.22 | wps 2800.2 | ups 0.16 | wpb 17819.1 | bsz 1023 | num_updates 3128 | lr 4.89362e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 1652 | gb_free 13.3 | wall 19714
2024-11-06 19:09:55 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 19:12:34 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-06 19:12:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 19:12:47 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17141.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=351.7, ups=0.02, wpb=17141.2, bsz=985.6, num_updates=3130, lr=4.89334e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=44, gb_free=13.6, wall=19886
2024-11-06 19:13:39 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17444.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3346.4, ups=0.19, wpb=17444.1, bsz=1024, num_updates=3140, lr=4.89198e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=19938
2024-11-06 19:14:32 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17755.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3399.3, ups=0.19, wpb=17755.6, bsz=1024, num_updates=3150, lr=4.89062e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19990
2024-11-06 19:15:24 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17875.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3419.8, ups=0.19, wpb=17875.9, bsz=1024, num_updates=3160, lr=4.88926e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20043
2024-11-06 19:16:16 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17766.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3378.7, ups=0.19, wpb=17766.8, bsz=1024, num_updates=3170, lr=4.8879e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20095
2024-11-06 19:17:08 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17315.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3344.9, ups=0.19, wpb=17315.9, bsz=1024, num_updates=3180, lr=4.88654e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20147
2024-11-06 19:18:01 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18011.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3438.9, ups=0.19, wpb=18011.3, bsz=1024, num_updates=3190, lr=4.88518e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20200
2024-11-06 19:18:53 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17506.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3345.2, ups=0.19, wpb=17506.1, bsz=1024, num_updates=3200, lr=4.88382e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20252
2024-11-06 19:19:45 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17833.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3401.3, ups=0.19, wpb=17833.5, bsz=1024, num_updates=3210, lr=4.88246e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20304
2024-11-06 19:20:38 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17695.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3388.3, ups=0.19, wpb=17695.7, bsz=1024, num_updates=3220, lr=4.8811e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20356
2024-11-06 19:21:30 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17789.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3394.1, ups=0.19, wpb=17789.9, bsz=1024, num_updates=3230, lr=4.87974e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=20409
2024-11-06 19:22:22 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3321.7, ups=0.19, wpb=17357.9, bsz=1024, num_updates=3240, lr=4.87838e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20461
2024-11-06 19:23:15 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17711.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3386.7, ups=0.19, wpb=17711.1, bsz=1024, num_updates=3250, lr=4.87702e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=20513
2024-11-06 19:24:07 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17570, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3364.8, ups=0.19, wpb=17570, bsz=1024, num_updates=3260, lr=4.87566e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20566
2024-11-06 19:24:59 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17685.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3383.5, ups=0.19, wpb=17685.9, bsz=1024, num_updates=3270, lr=4.8743e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20618
2024-11-06 19:25:51 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17679.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3372.2, ups=0.19, wpb=17679.9, bsz=1024, num_updates=3280, lr=4.87294e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20670
2024-11-06 19:26:44 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17683.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3359, ups=0.19, wpb=17683.1, bsz=1024, num_updates=3290, lr=4.87158e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=34, gb_free=13.5, wall=20723
2024-11-06 19:27:36 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17846, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3422.7, ups=0.19, wpb=17846, bsz=1024, num_updates=3300, lr=4.87022e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=43, gb_free=13.6, wall=20775
2024-11-06 19:28:29 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17672.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3336.5, ups=0.19, wpb=17672.3, bsz=1024, num_updates=3310, lr=4.86886e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=45, gb_free=13.6, wall=20828
2024-11-06 19:29:22 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17843.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3394.7, ups=0.19, wpb=17843.8, bsz=1024, num_updates=3320, lr=4.8675e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=49, gb_free=13.6, wall=20881
2024-11-06 19:30:14 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17942.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3450, ups=0.19, wpb=17942.9, bsz=1024, num_updates=3330, lr=4.86614e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=49, gb_free=13.5, wall=20933
2024-11-06 19:31:07 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17887.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3383, ups=0.19, wpb=17887.5, bsz=1024, num_updates=3340, lr=4.86478e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=53, gb_free=13.4, wall=20986
2024-11-06 19:31:59 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17811.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3425.6, ups=0.19, wpb=17811.8, bsz=1024, num_updates=3350, lr=4.86342e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21038
2024-11-06 19:32:52 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17888.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3378.2, ups=0.19, wpb=17888.1, bsz=1024, num_updates=3360, lr=4.86206e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21091
2024-11-06 19:33:44 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17238.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3271.9, ups=0.19, wpb=17238.4, bsz=1024, num_updates=3370, lr=4.8607e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21143
2024-11-06 19:34:37 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17685.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3328.7, ups=0.19, wpb=17685.6, bsz=1024, num_updates=3380, lr=4.85934e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21196
2024-11-06 19:35:31 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17868.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3362, ups=0.19, wpb=17868.6, bsz=1024, num_updates=3390, lr=4.85797e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21249
2024-11-06 19:36:23 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17859.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3435.9, ups=0.19, wpb=17859.5, bsz=1024, num_updates=3400, lr=4.85661e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21301
2024-11-06 19:37:14 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17557, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3408, ups=0.19, wpb=17557, bsz=1024, num_updates=3410, lr=4.85525e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=51, gb_free=13.6, wall=21353
2024-11-06 19:38:06 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17677.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3377.4, ups=0.19, wpb=17677.9, bsz=1024, num_updates=3420, lr=4.85389e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21405
2024-11-06 19:38:59 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17791.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3380.1, ups=0.19, wpb=17791.6, bsz=1024, num_updates=3430, lr=4.85253e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=53, gb_free=13.4, wall=21458
2024-11-06 19:39:51 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=18392.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3537.3, ups=0.19, wpb=18392.2, bsz=1024, num_updates=3440, lr=4.85117e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21510
2024-11-06 19:40:43 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=18254.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3535.6, ups=0.19, wpb=18254.3, bsz=1024, num_updates=3450, lr=4.84981e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21562
2024-11-06 19:41:36 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=18282.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3424.9, ups=0.19, wpb=18282.3, bsz=1024, num_updates=3460, lr=4.84845e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21615
2024-11-06 19:42:28 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17979.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3445.6, ups=0.19, wpb=17979.4, bsz=1024, num_updates=3470, lr=4.84709e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21667
2024-11-06 19:43:21 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=18383.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3516.1, ups=0.19, wpb=18383.8, bsz=1024, num_updates=3480, lr=4.84573e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21719
2024-11-06 19:44:13 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18115.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3475.5, ups=0.19, wpb=18115.8, bsz=1024, num_updates=3490, lr=4.84437e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21772
2024-11-06 19:45:05 - progress_bar.py[line:274] - INFO: epoch 009:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=18733.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3575.5, ups=0.19, wpb=18733.8, bsz=1024, num_updates=3500, lr=4.84301e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21824
2024-11-06 19:45:57 - progress_bar.py[line:274] - INFO: epoch 009:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17772.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3409.1, ups=0.19, wpb=17772.4, bsz=1024, num_updates=3510, lr=4.84165e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21876
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-06 19:46:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3519 updates
2024-11-06 19:46:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 19:48:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-06 19:50:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3519 updates, score 0) (writing took 222.20814892199996 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 19:51:18 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-06 19:51:18 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.625 | ntokens 17807.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.17 | wps 2804.8 | ups 0.16 | wpb 17807.6 | bsz 1023 | num_updates 3519 | lr 4.84043e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 1668 | gb_free 13.3 | wall 22197
2024-11-06 19:51:18 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 19:53:57 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-06 19:53:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 19:54:05 - progress_bar.py[line:274] - INFO: epoch 010:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17453.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=358.1, ups=0.02, wpb=17453.4, bsz=985.6, num_updates=3520, lr=4.84029e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=47, gb_free=13.4, wall=22363
2024-11-06 19:54:57 - progress_bar.py[line:274] - INFO: epoch 010:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17511.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3366.1, ups=0.19, wpb=17511.6, bsz=1024, num_updates=3530, lr=4.83893e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22416
2024-11-06 19:55:49 - progress_bar.py[line:274] - INFO: epoch 010:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17794.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3383.3, ups=0.19, wpb=17794.2, bsz=1024, num_updates=3540, lr=4.83757e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=22468
2024-11-06 19:56:42 - progress_bar.py[line:274] - INFO: epoch 010:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17737.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3361.6, ups=0.19, wpb=17737.9, bsz=1024, num_updates=3550, lr=4.83621e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22521
2024-11-06 19:57:34 - progress_bar.py[line:274] - INFO: epoch 010:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17723.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3414.6, ups=0.19, wpb=17723.7, bsz=1024, num_updates=3560, lr=4.83485e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22573
2024-11-06 19:58:26 - progress_bar.py[line:274] - INFO: epoch 010:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17516.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3369.9, ups=0.19, wpb=17516.5, bsz=1024, num_updates=3570, lr=4.83349e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22625
2024-11-06 19:59:18 - progress_bar.py[line:274] - INFO: epoch 010:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17826.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3432.6, ups=0.19, wpb=17826.6, bsz=1024, num_updates=3580, lr=4.83213e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22677
2024-11-06 20:00:10 - progress_bar.py[line:274] - INFO: epoch 010:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17606.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3350.2, ups=0.19, wpb=17606.6, bsz=1024, num_updates=3590, lr=4.83077e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=22729
2024-11-06 20:01:03 - progress_bar.py[line:274] - INFO: epoch 010:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17723.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3387.3, ups=0.19, wpb=17723.1, bsz=1024, num_updates=3600, lr=4.82941e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=22782
2024-11-06 20:01:55 - progress_bar.py[line:274] - INFO: epoch 010:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17804.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3406.1, ups=0.19, wpb=17804.9, bsz=1024, num_updates=3610, lr=4.82805e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=22834
2024-11-06 20:02:48 - progress_bar.py[line:274] - INFO: epoch 010:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17542.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3293.3, ups=0.19, wpb=17542.5, bsz=1024, num_updates=3620, lr=4.82669e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=39, gb_free=13.5, wall=22887
2024-11-06 20:03:40 - progress_bar.py[line:274] - INFO: epoch 010:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17597.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3382.8, ups=0.19, wpb=17597.9, bsz=1024, num_updates=3630, lr=4.82533e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=40, gb_free=13.4, wall=22939
2024-11-06 20:04:32 - progress_bar.py[line:274] - INFO: epoch 010:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17656, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3385.8, ups=0.19, wpb=17656, bsz=1024, num_updates=3640, lr=4.82396e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=22991
2024-11-06 20:05:25 - progress_bar.py[line:274] - INFO: epoch 010:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17395.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3310.3, ups=0.19, wpb=17395.8, bsz=1024, num_updates=3650, lr=4.8226e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=23044
2024-11-06 20:06:17 - progress_bar.py[line:274] - INFO: epoch 010:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17768.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3398.7, ups=0.19, wpb=17768.9, bsz=1024, num_updates=3660, lr=4.82124e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23096
2024-11-06 20:07:10 - progress_bar.py[line:274] - INFO: epoch 010:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17862, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3395.2, ups=0.19, wpb=17862, bsz=1024, num_updates=3670, lr=4.81988e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23149
2024-11-06 20:08:03 - progress_bar.py[line:274] - INFO: epoch 010:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17723, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3337.1, ups=0.19, wpb=17723, bsz=1024, num_updates=3680, lr=4.81852e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=32, gb_free=13.5, wall=23202
2024-11-06 20:08:58 - progress_bar.py[line:274] - INFO: epoch 010:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=18031, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3258.9, ups=0.18, wpb=18031, bsz=1024, num_updates=3690, lr=4.81716e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=44, gb_free=13.5, wall=23257
2024-11-06 20:09:55 - progress_bar.py[line:274] - INFO: epoch 010:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17524.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3087.2, ups=0.18, wpb=17524.8, bsz=1024, num_updates=3700, lr=4.8158e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=48, gb_free=13.6, wall=23314
2024-11-06 20:10:52 - progress_bar.py[line:274] - INFO: epoch 010:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17937.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3169.3, ups=0.18, wpb=17937.8, bsz=1024, num_updates=3710, lr=4.81444e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=23371
2024-11-06 20:11:49 - progress_bar.py[line:274] - INFO: epoch 010:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17760.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3098.3, ups=0.17, wpb=17760.5, bsz=1024, num_updates=3720, lr=4.81308e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=23428
2024-11-06 20:12:45 - progress_bar.py[line:274] - INFO: epoch 010:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=18022.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3227.1, ups=0.18, wpb=18022.8, bsz=1024, num_updates=3730, lr=4.81172e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=23484
2024-11-06 20:13:37 - progress_bar.py[line:274] - INFO: epoch 010:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17742.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3388.4, ups=0.19, wpb=17742.3, bsz=1024, num_updates=3740, lr=4.81036e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23536
2024-11-06 20:14:30 - progress_bar.py[line:274] - INFO: epoch 010:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=18208.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3464.8, ups=0.19, wpb=18208.9, bsz=1024, num_updates=3750, lr=4.809e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23589
2024-11-06 20:15:22 - progress_bar.py[line:274] - INFO: epoch 010:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3341.2, ups=0.19, wpb=17420.4, bsz=1024, num_updates=3760, lr=4.80764e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=23641
2024-11-06 20:16:14 - progress_bar.py[line:274] - INFO: epoch 010:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17454.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3356, ups=0.19, wpb=17454.9, bsz=1024, num_updates=3770, lr=4.80628e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23693
2024-11-06 20:17:05 - progress_bar.py[line:274] - INFO: epoch 010:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17489.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3403.9, ups=0.19, wpb=17489.7, bsz=1024, num_updates=3780, lr=4.80492e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=50, gb_free=13.5, wall=23744
2024-11-06 20:17:57 - progress_bar.py[line:274] - INFO: epoch 010:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17692.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3422.1, ups=0.19, wpb=17692.3, bsz=1024, num_updates=3790, lr=4.80356e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=39, gb_free=13.5, wall=23796
2024-11-06 20:18:50 - progress_bar.py[line:274] - INFO: epoch 010:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17650.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3338.8, ups=0.19, wpb=17650.2, bsz=1024, num_updates=3800, lr=4.8022e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=23849
2024-11-06 20:19:43 - progress_bar.py[line:274] - INFO: epoch 010:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17732.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3354.9, ups=0.19, wpb=17732.6, bsz=1024, num_updates=3810, lr=4.80084e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23902
2024-11-06 20:20:35 - progress_bar.py[line:274] - INFO: epoch 010:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=18175.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3472.5, ups=0.19, wpb=18175.7, bsz=1024, num_updates=3820, lr=4.79948e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=23954
2024-11-06 20:21:29 - progress_bar.py[line:274] - INFO: epoch 010:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=18509.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3459.5, ups=0.19, wpb=18509.4, bsz=1024, num_updates=3830, lr=4.79812e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=50, gb_free=13.4, wall=24007
2024-11-06 20:22:20 - progress_bar.py[line:274] - INFO: epoch 010:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=18219.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3523.2, ups=0.19, wpb=18219.5, bsz=1024, num_updates=3840, lr=4.79676e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=24059
2024-11-06 20:23:13 - progress_bar.py[line:274] - INFO: epoch 010:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=18186.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3461.8, ups=0.19, wpb=18186.7, bsz=1024, num_updates=3850, lr=4.7954e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=24112
2024-11-06 20:24:04 - progress_bar.py[line:274] - INFO: epoch 010:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=18129.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3514.5, ups=0.19, wpb=18129.2, bsz=1024, num_updates=3860, lr=4.79404e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=24163
2024-11-06 20:24:56 - progress_bar.py[line:274] - INFO: epoch 010:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=18677.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3597.7, ups=0.19, wpb=18677.2, bsz=1024, num_updates=3870, lr=4.79268e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=24215
2024-11-06 20:25:48 - progress_bar.py[line:274] - INFO: epoch 010:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=18294.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3558.3, ups=0.19, wpb=18294.1, bsz=1024, num_updates=3880, lr=4.79132e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=24267
2024-11-06 20:26:40 - progress_bar.py[line:274] - INFO: epoch 010:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=18055.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3422.7, ups=0.19, wpb=18055.6, bsz=1024, num_updates=3890, lr=4.78995e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=24319
2024-11-06 20:27:33 - progress_bar.py[line:274] - INFO: epoch 010:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=18334.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3502.8, ups=0.19, wpb=18334.2, bsz=1024, num_updates=3900, lr=4.78859e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=24372
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 20:28:22 - progress_bar.py[line:274] - INFO: epoch 010:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17446.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3537.4, ups=0.2, wpb=17446.6, bsz=985.6, num_updates=3910, lr=4.78723e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=49, gb_free=13.3, wall=24421
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

2024-11-06 20:28:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3910 updates
2024-11-06 20:28:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 20:30:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-06 20:32:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3910 updates, score 0) (writing took 220.60931834900111 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 20:32:57 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-06 20:32:57 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.627 | ntokens 17831.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.18 | wps 2789.5 | ups 0.16 | wpb 17831.9 | bsz 1023 | num_updates 3910 | lr 4.78723e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1626 | gb_free 13.3 | wall 24696
2024-11-06 20:32:57 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 20:35:36 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-06 20:35:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 20:36:30 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17420.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=356.7, ups=0.02, wpb=17420.1, bsz=1024, num_updates=3920, lr=4.78587e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24909
2024-11-06 20:37:23 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17675.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3383.7, ups=0.19, wpb=17675.8, bsz=1024, num_updates=3930, lr=4.78451e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24962
2024-11-06 20:38:15 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17745.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3398, ups=0.19, wpb=17745.3, bsz=1024, num_updates=3940, lr=4.78315e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=25014
2024-11-06 20:39:07 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17891, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3442, ups=0.19, wpb=17891, bsz=1024, num_updates=3950, lr=4.78179e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25066
2024-11-06 20:39:59 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17564, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3372.9, ups=0.19, wpb=17564, bsz=1024, num_updates=3960, lr=4.78043e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25118
2024-11-06 20:40:51 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17881.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3428.9, ups=0.19, wpb=17881.1, bsz=1024, num_updates=3970, lr=4.77907e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25170
2024-11-06 20:41:43 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17633.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3372.7, ups=0.19, wpb=17633.7, bsz=1024, num_updates=3980, lr=4.77771e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25222
2024-11-06 20:42:36 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17886.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3415.3, ups=0.19, wpb=17886.6, bsz=1024, num_updates=3990, lr=4.77635e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25275
2024-11-06 20:43:30 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17440.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3236.6, ups=0.19, wpb=17440.4, bsz=1024, num_updates=4000, lr=4.77499e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25329
2024-11-06 20:44:22 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17900.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3427.5, ups=0.19, wpb=17900.2, bsz=1024, num_updates=4010, lr=4.77363e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25381
2024-11-06 20:45:14 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17790.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3423.1, ups=0.19, wpb=17790.2, bsz=1024, num_updates=4020, lr=4.77227e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25433
2024-11-06 20:46:06 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17724.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3374.6, ups=0.19, wpb=17724.2, bsz=1024, num_updates=4030, lr=4.77091e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25485
2024-11-06 20:46:59 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17222, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3268.7, ups=0.19, wpb=17222, bsz=1024, num_updates=4040, lr=4.76955e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25538
2024-11-06 20:47:51 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17347.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3320, ups=0.19, wpb=17347.5, bsz=1024, num_updates=4050, lr=4.76819e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25590
2024-11-06 20:48:44 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17626.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3361.3, ups=0.19, wpb=17626.7, bsz=1024, num_updates=4060, lr=4.76683e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25643
2024-11-06 20:49:36 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17634.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3381.1, ups=0.19, wpb=17634.8, bsz=1024, num_updates=4070, lr=4.76547e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25695
2024-11-06 20:50:28 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=18081.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3481.4, ups=0.19, wpb=18081.6, bsz=1024, num_updates=4080, lr=4.76411e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25747
2024-11-06 20:51:20 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17767.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3395.7, ups=0.19, wpb=17767.2, bsz=1024, num_updates=4090, lr=4.76275e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25799
2024-11-06 20:52:12 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17950.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3439.2, ups=0.19, wpb=17950.3, bsz=1024, num_updates=4100, lr=4.76139e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=25851
2024-11-06 20:53:05 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17939.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3442.9, ups=0.19, wpb=17939.3, bsz=1024, num_updates=4110, lr=4.76003e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=25903
2024-11-06 20:53:57 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17644.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3358.8, ups=0.19, wpb=17644.2, bsz=1024, num_updates=4120, lr=4.75867e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=25956
2024-11-06 20:54:50 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17997.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3411.8, ups=0.19, wpb=17997.2, bsz=1024, num_updates=4130, lr=4.75731e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26009
2024-11-06 20:55:42 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17635.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3349.6, ups=0.19, wpb=17635.3, bsz=1024, num_updates=4140, lr=4.75594e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=26061
2024-11-06 20:56:34 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17489.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3370.9, ups=0.19, wpb=17489.8, bsz=1024, num_updates=4150, lr=4.75458e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=26113
2024-11-06 20:57:27 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17612.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3358.4, ups=0.19, wpb=17612.8, bsz=1024, num_updates=4160, lr=4.75322e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26166
2024-11-06 20:58:19 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17726.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3409.2, ups=0.19, wpb=17726.1, bsz=1024, num_updates=4170, lr=4.75186e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26218
2024-11-06 20:59:11 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18057.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3472.4, ups=0.19, wpb=18057.4, bsz=1024, num_updates=4180, lr=4.7505e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26270
2024-11-06 21:00:03 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17572.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3342, ups=0.19, wpb=17572.2, bsz=1024, num_updates=4190, lr=4.74914e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26322
2024-11-06 21:00:56 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3334.9, ups=0.19, wpb=17455, bsz=1024, num_updates=4200, lr=4.74778e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26375
2024-11-06 21:01:47 - progress_bar.py[line:274] - INFO: epoch 011:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17839.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3446.9, ups=0.19, wpb=17839.5, bsz=1024, num_updates=4210, lr=4.74642e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=26426
2024-11-06 21:02:39 - progress_bar.py[line:274] - INFO: epoch 011:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=18562.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3620.5, ups=0.2, wpb=18562.4, bsz=1024, num_updates=4220, lr=4.74506e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=26478
2024-11-06 21:03:31 - progress_bar.py[line:274] - INFO: epoch 011:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=18050.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3451, ups=0.19, wpb=18050.7, bsz=1024, num_updates=4230, lr=4.7437e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26530
2024-11-06 21:04:23 - progress_bar.py[line:274] - INFO: epoch 011:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=18245.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3506.5, ups=0.19, wpb=18245.5, bsz=1024, num_updates=4240, lr=4.74234e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26582
2024-11-06 21:05:15 - progress_bar.py[line:274] - INFO: epoch 011:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=18322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3502.3, ups=0.19, wpb=18322.9, bsz=1024, num_updates=4250, lr=4.74098e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=26634
2024-11-06 21:06:07 - progress_bar.py[line:274] - INFO: epoch 011:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=18309.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3538.3, ups=0.19, wpb=18309.9, bsz=1024, num_updates=4260, lr=4.73962e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26686
2024-11-06 21:06:59 - progress_bar.py[line:274] - INFO: epoch 011:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=18400, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3540, ups=0.19, wpb=18400, bsz=1024, num_updates=4270, lr=4.73826e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=26738
2024-11-06 21:07:51 - progress_bar.py[line:274] - INFO: epoch 011:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=18262.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3521.1, ups=0.19, wpb=18262.4, bsz=1024, num_updates=4280, lr=4.7369e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=26790
2024-11-06 21:08:43 - progress_bar.py[line:274] - INFO: epoch 011:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18451.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3517.8, ups=0.19, wpb=18451.1, bsz=1024, num_updates=4290, lr=4.73554e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=26842
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 21:09:35 - progress_bar.py[line:274] - INFO: epoch 011:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17753.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3416.7, ups=0.19, wpb=17753.6, bsz=1024, num_updates=4300, lr=4.73418e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13.3, wall=26894
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt2024-11-06 21:09:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4301 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-06 21:09:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 21:11:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 21:13:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4301 updates, score 0) (writing took 220.4491288470017 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 21:14:12 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-06 21:14:12 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.62 | ntokens 17815.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.15 | wps 2814.5 | ups 0.16 | wpb 17815.1 | bsz 1023 | num_updates 4301 | lr 4.73404e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1205 | gb_free 13.4 | wall 27171
2024-11-06 21:14:12 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 21:16:52 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-06 21:16:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 21:17:42 - progress_bar.py[line:274] - INFO: epoch 012:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=16806.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=345, ups=0.02, wpb=16806.3, bsz=985.6, num_updates=4310, lr=4.73282e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=29, gb_free=13.6, wall=27381
2024-11-06 21:18:35 - progress_bar.py[line:274] - INFO: epoch 012:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17724.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3400.6, ups=0.19, wpb=17724.7, bsz=1024, num_updates=4320, lr=4.73146e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27433
2024-11-06 21:19:27 - progress_bar.py[line:274] - INFO: epoch 012:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17678, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3396.2, ups=0.19, wpb=17678, bsz=1024, num_updates=4330, lr=4.7301e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27486
2024-11-06 21:20:19 - progress_bar.py[line:274] - INFO: epoch 012:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17727.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3387.6, ups=0.19, wpb=17727.6, bsz=1024, num_updates=4340, lr=4.72874e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27538
2024-11-06 21:21:11 - progress_bar.py[line:274] - INFO: epoch 012:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17686, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3402.6, ups=0.19, wpb=17686, bsz=1024, num_updates=4350, lr=4.72738e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=27590
2024-11-06 21:22:04 - progress_bar.py[line:274] - INFO: epoch 012:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17735.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3372.5, ups=0.19, wpb=17735.7, bsz=1024, num_updates=4360, lr=4.72602e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27642
2024-11-06 21:22:35 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-06 21:23:02 - progress_bar.py[line:274] - INFO: epoch 012:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17545.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3012.8, ups=0.17, wpb=17545.6, bsz=1024, num_updates=4370, lr=4.72466e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=27701
2024-11-06 21:23:56 - progress_bar.py[line:274] - INFO: epoch 012:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17855.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3316, ups=0.19, wpb=17855.9, bsz=1024, num_updates=4380, lr=4.7233e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=27755
2024-11-06 21:24:48 - progress_bar.py[line:274] - INFO: epoch 012:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17694.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3353.6, ups=0.19, wpb=17694.3, bsz=1024, num_updates=4390, lr=4.72194e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=43, gb_free=13.5, wall=27807
2024-11-06 21:25:41 - progress_bar.py[line:274] - INFO: epoch 012:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3346, ups=0.19, wpb=17525.8, bsz=1024, num_updates=4400, lr=4.72057e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=41, gb_free=13.4, wall=27860
2024-11-06 21:26:33 - progress_bar.py[line:274] - INFO: epoch 012:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17467.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3336.3, ups=0.19, wpb=17467.5, bsz=1024, num_updates=4410, lr=4.71921e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=44, gb_free=13.5, wall=27912
2024-11-06 21:27:27 - progress_bar.py[line:274] - INFO: epoch 012:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17515, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3260.1, ups=0.19, wpb=17515, bsz=1024, num_updates=4420, lr=4.71785e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=48, gb_free=13.5, wall=27966
2024-11-06 21:28:22 - progress_bar.py[line:274] - INFO: epoch 012:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17453.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3182.2, ups=0.18, wpb=17453.1, bsz=1024, num_updates=4430, lr=4.71649e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.6, wall=28021
2024-11-06 21:29:17 - progress_bar.py[line:274] - INFO: epoch 012:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17630, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3214, ups=0.18, wpb=17630, bsz=1024, num_updates=4440, lr=4.71513e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28075
2024-11-06 21:30:12 - progress_bar.py[line:274] - INFO: epoch 012:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17515.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3173.6, ups=0.18, wpb=17515.3, bsz=1024, num_updates=4450, lr=4.71377e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=28131
2024-11-06 21:31:06 - progress_bar.py[line:274] - INFO: epoch 012:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17873.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3265.3, ups=0.18, wpb=17873.8, bsz=1024, num_updates=4460, lr=4.71241e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28185
2024-11-06 21:32:02 - progress_bar.py[line:274] - INFO: epoch 012:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17938.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3249.7, ups=0.18, wpb=17938.3, bsz=1024, num_updates=4470, lr=4.71105e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28241
2024-11-06 21:32:56 - progress_bar.py[line:274] - INFO: epoch 012:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17298.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3197.4, ups=0.18, wpb=17298.8, bsz=1024, num_updates=4480, lr=4.70969e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=28295
2024-11-06 21:33:50 - progress_bar.py[line:274] - INFO: epoch 012:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17632.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3278.7, ups=0.19, wpb=17632.9, bsz=1024, num_updates=4490, lr=4.70833e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28348
2024-11-06 21:34:44 - progress_bar.py[line:274] - INFO: epoch 012:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17490.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3243.1, ups=0.19, wpb=17490.1, bsz=1024, num_updates=4500, lr=4.70697e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28402
2024-11-06 21:35:37 - progress_bar.py[line:274] - INFO: epoch 012:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17881.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3331.9, ups=0.19, wpb=17881.5, bsz=1024, num_updates=4510, lr=4.70561e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28456
2024-11-06 21:36:29 - progress_bar.py[line:274] - INFO: epoch 012:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17657.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3379.1, ups=0.19, wpb=17657.2, bsz=1024, num_updates=4520, lr=4.70425e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=28508
2024-11-06 21:37:21 - progress_bar.py[line:274] - INFO: epoch 012:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17865.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3456.1, ups=0.19, wpb=17865.9, bsz=1024, num_updates=4530, lr=4.70289e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28560
2024-11-06 21:38:13 - progress_bar.py[line:274] - INFO: epoch 012:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17866.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3419.6, ups=0.19, wpb=17866.9, bsz=1024, num_updates=4540, lr=4.70153e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=28612
2024-11-06 21:39:05 - progress_bar.py[line:274] - INFO: epoch 012:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17373.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3347.1, ups=0.19, wpb=17373.8, bsz=1024, num_updates=4550, lr=4.70017e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28664
2024-11-06 21:39:58 - progress_bar.py[line:274] - INFO: epoch 012:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17749.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3382.2, ups=0.19, wpb=17749.4, bsz=1024, num_updates=4560, lr=4.69881e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28717
2024-11-06 21:40:51 - progress_bar.py[line:274] - INFO: epoch 012:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17713.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3300.8, ups=0.19, wpb=17713.2, bsz=1024, num_updates=4570, lr=4.69745e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=48, gb_free=13.6, wall=28770
2024-11-06 21:41:43 - progress_bar.py[line:274] - INFO: epoch 012:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17484.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3360, ups=0.19, wpb=17484.7, bsz=1024, num_updates=4580, lr=4.69609e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=28822
2024-11-06 21:42:35 - progress_bar.py[line:274] - INFO: epoch 012:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17708.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3419.8, ups=0.19, wpb=17708.5, bsz=1024, num_updates=4590, lr=4.69473e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=28874
2024-11-06 21:43:27 - progress_bar.py[line:274] - INFO: epoch 012:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18008.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3470.3, ups=0.19, wpb=18008.3, bsz=1024, num_updates=4600, lr=4.69337e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.2, wall=28926
2024-11-06 21:44:19 - progress_bar.py[line:274] - INFO: epoch 012:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=18623.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3582.6, ups=0.19, wpb=18623.4, bsz=1024, num_updates=4610, lr=4.69201e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=39, gb_free=13.4, wall=28978
2024-11-06 21:45:12 - progress_bar.py[line:274] - INFO: epoch 012:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=18040, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3409.9, ups=0.19, wpb=18040, bsz=1024, num_updates=4620, lr=4.69065e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=48, gb_free=13.4, wall=29031
2024-11-06 21:46:05 - progress_bar.py[line:274] - INFO: epoch 012:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=18312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3458.7, ups=0.19, wpb=18312.9, bsz=1024, num_updates=4630, lr=4.68929e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=29084
2024-11-06 21:46:58 - progress_bar.py[line:274] - INFO: epoch 012:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17978.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3421.2, ups=0.19, wpb=17978.5, bsz=1024, num_updates=4640, lr=4.68793e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=29136
2024-11-06 21:47:50 - progress_bar.py[line:274] - INFO: epoch 012:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=18880.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3617.1, ups=0.19, wpb=18880.2, bsz=1024, num_updates=4650, lr=4.68656e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=29189
2024-11-06 21:48:42 - progress_bar.py[line:274] - INFO: epoch 012:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=18306.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3483.8, ups=0.19, wpb=18306.2, bsz=1024, num_updates=4660, lr=4.6852e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=29241
2024-11-06 21:49:35 - progress_bar.py[line:274] - INFO: epoch 012:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=18129.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3458.2, ups=0.19, wpb=18129.6, bsz=1024, num_updates=4670, lr=4.68384e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=29294
2024-11-06 21:50:26 - progress_bar.py[line:274] - INFO: epoch 012:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=18046.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3491.5, ups=0.19, wpb=18046.4, bsz=1024, num_updates=4680, lr=4.68248e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=29345
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 21:51:22 - progress_bar.py[line:274] - INFO: epoch 012:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=18230.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3291.8, ups=0.18, wpb=18230.1, bsz=1024, num_updates=4690, lr=4.68112e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=29401
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt2024-11-06 21:51:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4691 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-06 21:51:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 21:53:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-06 21:55:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4691 updates, score 0) (writing took 220.51554317999398 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
2024-11-06 21:55:59 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-06 21:55:59 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.602 | ntokens 17789.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.07 | wps 2767.9 | ups 0.16 | wpb 17789.3 | bsz 1023 | num_updates 4691 | lr 4.68099e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1770 | gb_free 13.4 | wall 29677
2024-11-06 21:55:59 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 21:58:38 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-06 21:58:38 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 21:59:27 - progress_bar.py[line:274] - INFO: epoch 013:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=16762.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=345.4, ups=0.02, wpb=16762.1, bsz=985.6, num_updates=4700, lr=4.67976e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=29, gb_free=13.6, wall=29886
2024-11-06 22:00:19 - progress_bar.py[line:274] - INFO: epoch 013:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17627.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3390.9, ups=0.19, wpb=17627.8, bsz=1024, num_updates=4710, lr=4.6784e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=29938
2024-11-06 22:01:12 - progress_bar.py[line:274] - INFO: epoch 013:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17631.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3359.5, ups=0.19, wpb=17631.1, bsz=1024, num_updates=4720, lr=4.67704e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=29990
2024-11-06 22:02:04 - progress_bar.py[line:274] - INFO: epoch 013:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17890.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3410.2, ups=0.19, wpb=17890.4, bsz=1024, num_updates=4730, lr=4.67568e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=30043
2024-11-06 22:02:56 - progress_bar.py[line:274] - INFO: epoch 013:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17869.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3442.5, ups=0.19, wpb=17869.3, bsz=1024, num_updates=4740, lr=4.67432e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=30095
2024-11-06 22:03:48 - progress_bar.py[line:274] - INFO: epoch 013:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17834.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3434.7, ups=0.19, wpb=17834.3, bsz=1024, num_updates=4750, lr=4.67296e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30147
2024-11-06 22:04:40 - progress_bar.py[line:274] - INFO: epoch 013:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17611.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3406.7, ups=0.19, wpb=17611.5, bsz=1024, num_updates=4760, lr=4.6716e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30198
2024-11-06 22:05:32 - progress_bar.py[line:274] - INFO: epoch 013:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17503.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3323.5, ups=0.19, wpb=17503.1, bsz=1024, num_updates=4770, lr=4.67024e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=30251
2024-11-06 22:06:25 - progress_bar.py[line:274] - INFO: epoch 013:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17538.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3337.7, ups=0.19, wpb=17538.4, bsz=1024, num_updates=4780, lr=4.66888e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30304
2024-11-06 22:07:17 - progress_bar.py[line:274] - INFO: epoch 013:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17648.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3388.1, ups=0.19, wpb=17648.9, bsz=1024, num_updates=4790, lr=4.66752e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30356
2024-11-06 22:08:09 - progress_bar.py[line:274] - INFO: epoch 013:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17403.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3337.8, ups=0.19, wpb=17403.4, bsz=1024, num_updates=4800, lr=4.66616e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=30408
2024-11-06 22:09:01 - progress_bar.py[line:274] - INFO: epoch 013:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17582.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3357.1, ups=0.19, wpb=17582.1, bsz=1024, num_updates=4810, lr=4.6648e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30460
2024-11-06 22:09:55 - progress_bar.py[line:274] - INFO: epoch 013:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17477.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3241.6, ups=0.19, wpb=17477.6, bsz=1024, num_updates=4820, lr=4.66344e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=40, gb_free=13.5, wall=30514
2024-11-06 22:10:49 - progress_bar.py[line:274] - INFO: epoch 013:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=18064.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3357.1, ups=0.19, wpb=18064.7, bsz=1024, num_updates=4830, lr=4.66208e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=30568
2024-11-06 22:11:44 - progress_bar.py[line:274] - INFO: epoch 013:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17781.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3248.8, ups=0.18, wpb=17781.5, bsz=1024, num_updates=4840, lr=4.66072e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=30623
2024-11-06 22:12:37 - progress_bar.py[line:274] - INFO: epoch 013:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17786.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3322.7, ups=0.19, wpb=17786.3, bsz=1024, num_updates=4850, lr=4.65936e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=30676
2024-11-06 22:13:31 - progress_bar.py[line:274] - INFO: epoch 013:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17698.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3304.3, ups=0.19, wpb=17698.8, bsz=1024, num_updates=4860, lr=4.658e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=30730
2024-11-06 22:14:24 - progress_bar.py[line:274] - INFO: epoch 013:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17337.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3276.4, ups=0.19, wpb=17337.2, bsz=1024, num_updates=4870, lr=4.65664e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=30783
2024-11-06 22:15:16 - progress_bar.py[line:274] - INFO: epoch 013:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=17583.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3358.6, ups=0.19, wpb=17583.3, bsz=1024, num_updates=4880, lr=4.65528e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=30835
2024-11-06 22:16:09 - progress_bar.py[line:274] - INFO: epoch 013:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17646.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3318.3, ups=0.19, wpb=17646.6, bsz=1024, num_updates=4890, lr=4.65392e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=50, gb_free=13.5, wall=30888
2024-11-06 22:17:01 - progress_bar.py[line:274] - INFO: epoch 013:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17933.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3450.3, ups=0.19, wpb=17933.3, bsz=1024, num_updates=4900, lr=4.65255e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=30940
2024-11-06 22:17:53 - progress_bar.py[line:274] - INFO: epoch 013:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=18020.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3462.7, ups=0.19, wpb=18020.9, bsz=1024, num_updates=4910, lr=4.65119e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=45, gb_free=13.5, wall=30992
2024-11-06 22:18:46 - progress_bar.py[line:274] - INFO: epoch 013:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17638.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3385.4, ups=0.19, wpb=17638.6, bsz=1024, num_updates=4920, lr=4.64983e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=31044
2024-11-06 22:19:38 - progress_bar.py[line:274] - INFO: epoch 013:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17440.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3354.5, ups=0.19, wpb=17440.2, bsz=1024, num_updates=4930, lr=4.64847e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=31096
2024-11-06 22:20:30 - progress_bar.py[line:274] - INFO: epoch 013:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3332.1, ups=0.19, wpb=17378.7, bsz=1024, num_updates=4940, lr=4.64711e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.5, wall=31149
2024-11-06 22:21:21 - progress_bar.py[line:274] - INFO: epoch 013:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17687.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3427.2, ups=0.19, wpb=17687.1, bsz=1024, num_updates=4950, lr=4.64575e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.6, wall=31200
2024-11-06 22:22:13 - progress_bar.py[line:274] - INFO: epoch 013:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17911.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3480.8, ups=0.19, wpb=17911.8, bsz=1024, num_updates=4960, lr=4.64439e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=39, gb_free=13.3, wall=31252
2024-11-06 22:23:05 - progress_bar.py[line:274] - INFO: epoch 013:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17922, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3447.3, ups=0.19, wpb=17922, bsz=1024, num_updates=4970, lr=4.64303e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=31304
2024-11-06 22:23:58 - progress_bar.py[line:274] - INFO: epoch 013:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17584.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3312.5, ups=0.19, wpb=17584.8, bsz=1024, num_updates=4980, lr=4.64167e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=31357
2024-11-06 22:24:51 - progress_bar.py[line:274] - INFO: epoch 013:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17508, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3308, ups=0.19, wpb=17508, bsz=1024, num_updates=4990, lr=4.64031e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=31410
2024-11-06 22:25:44 - progress_bar.py[line:274] - INFO: epoch 013:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=18523, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3498.2, ups=0.19, wpb=18523, bsz=1024, num_updates=5000, lr=4.63895e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=31463
loss_reg: 0.01371661686701624 loss_cls: 0.0031999179627746344
loss_reg: 0.01546810929731631 loss_cls: 0.004155462142080069
loss_reg: 0.020677162917150323 loss_cls: 0.003050205297768116
loss_reg: 0.009692380419354309 loss_cls: 0.0036115599796175957
loss_reg: 0.011814246689947393 loss_cls: 0.0035622422583401203
loss_reg: 0.012816680010544427 loss_cls: 0.0035774887073785067
loss_reg: 0.012699140482210398 loss_cls: 0.003415712621062994
loss_reg: 0.012842890728452957 loss_cls: 0.003977042157202959
loss_reg: 0.0182060165197422 loss_cls: 0.0025799269787967205
loss_reg: 0.0149602597222693 loss_cls: 0.0031678760424256325
loss_reg: 0.02265295157481819 loss_cls: 0.004339650273323059
loss_reg: 0.016193055329361168 loss_cls: 0.003202456282451749
loss_reg: 0.02425943885639123 loss_cls: 0.004520528484135866
loss_reg: 0.014691715793301764 loss_cls: 0.002744094468653202
loss_reg: 0.014839134290115403 loss_cls: 0.004534281324595213
loss_reg: 0.014397479441294823 loss_cls: 0.0039008944295346737
loss_reg: 0.024003220302664524 loss_cls: 0.004171252250671387
loss_reg: 0.016202961998968472 loss_cls: 0.003729133866727352
loss_reg: 0.016514621988894782 loss_cls: 0.0038731195963919163
loss_reg: 0.012425913383087201 loss_cls: 0.003739406121894717
loss_reg: 0.01913431730954543 loss_cls: 0.00446197297424078
loss_reg: 0.012278234403096045 loss_cls: 0.003851885674521327
loss_reg: 0.017069840575418327 loss_cls: 0.0038591863121837378
loss_reg: 0.014867098275800513 loss_cls: 0.00444171205163002
loss_reg: 0.018319569260746495 loss_cls: 0.0037218001671135426
loss_reg: 0.01390489326559432 loss_cls: 0.00301563274115324
loss_reg: 0.014288889372070637 loss_cls: 0.0037061315961182117
loss_reg: 0.00941902919552759 loss_cls: 0.0029771558474749327
loss_reg: 0.01560203965808278 loss_cls: 0.003866473911330104
loss_reg: 0.01811548980177785 loss_cls: 0.004769590683281422
loss_reg: 0.01814551325208829 loss_cls: 0.00421040877699852
loss_reg: 0.01337034987423303 loss_cls: 0.004224575124680996
loss_reg: 0.015303118928802463 loss_cls: 0.005169191397726536
loss_reg: 0.015984099075731548 loss_cls: 0.003952597733587027
loss_reg: 0.016464827773476846 loss_cls: 0.003819927340373397
loss_reg: 0.01766032845952449 loss_cls: 0.004267076961696148
loss_reg: 0.01794988277137548 loss_cls: 0.0029481658712029457
loss_reg: 0.014030041303698854 loss_cls: 0.003557977033779025
loss_reg: 0.00883847879334395 loss_cls: 0.002649585483595729
loss_reg: 0.020115630722730454 loss_cls: 0.0027355721686035395
loss_reg: 0.011637083879534866 loss_cls: 0.0030943697784096003
loss_reg: 0.019710911406632173 loss_cls: 0.004125168547034264
loss_reg: 0.018772240230705284 loss_cls: 0.0032720433082431555
loss_reg: 0.016644670502957964 loss_cls: 0.0029676370322704315
loss_reg: 0.023679372410256652 loss_cls: 0.003705955110490322
loss_reg: 0.025670070675991506 loss_cls: 0.00211633974686265
loss_reg: 0.012875137965582806 loss_cls: 0.00318109430372715
loss_reg: 0.01486882100166004 loss_cls: 0.0033472126815468073
loss_reg: 0.008406330430459014 loss_cls: 0.003070804290473461
loss_reg: 0.012394431657941619 loss_cls: 0.003620947478339076
loss_reg: 0.01598960518499753 loss_cls: 0.0028950769919902086
loss_reg: 0.01821989213492124 loss_cls: 0.0037469964008778334
loss_reg: 0.015139598003539412 loss_cls: 0.0037321513518691063
loss_reg: 0.013331770637969111 loss_cls: 0.0030536146368831396
loss_reg: 0.017013799969210843 loss_cls: 0.0037234555929899216
loss_reg: 0.020058742467869765 loss_cls: 0.0038905469700694084
loss_reg: 0.022646155970886428 loss_cls: 0.0035183350555598736
loss_reg: 0.02724376864553613 loss_cls: 0.003199436003342271
loss_reg: 0.02045431692524385 loss_cls: 0.004243470262736082
loss_reg: 0.012087560845532155 loss_cls: 0.003464183770120144
loss_reg: 0.015068138371516182 loss_cls: 0.0034942361526191235
loss_reg: 0.017364603166321615 loss_cls: 0.0033361439127475023
loss_reg: 0.02212407362240475 loss_cls: 0.002972640795633197
loss_reg: 0.0157434702954352 loss_cls: 0.0034931327681988478
2024-11-06 22:26:37 - progress_bar.py[line:274] - INFO: epoch 013:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18160.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3390.7, ups=0.19, wpb=18160.5, bsz=1024, num_updates=5010, lr=4.63759e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=31516
2024-11-06 22:27:29 - progress_bar.py[line:274] - INFO: epoch 013:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18232, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3493, ups=0.19, wpb=18232, bsz=1024, num_updates=5020, lr=4.63623e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=31568
2024-11-06 22:28:22 - progress_bar.py[line:274] - INFO: epoch 013:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=18118.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3439.3, ups=0.19, wpb=18118.4, bsz=1024, num_updates=5030, lr=4.63487e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=31621
2024-11-06 22:29:14 - progress_bar.py[line:274] - INFO: epoch 013:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18506.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3539, ups=0.19, wpb=18506.3, bsz=1024, num_updates=5040, lr=4.63351e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=31673
2024-11-06 22:30:06 - progress_bar.py[line:274] - INFO: epoch 013:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=18133.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3525.4, ups=0.19, wpb=18133.1, bsz=1024, num_updates=5050, lr=4.63215e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=31725
2024-11-06 22:30:58 - progress_bar.py[line:274] - INFO: epoch 013:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17843.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3426.8, ups=0.19, wpb=17843.6, bsz=1024, num_updates=5060, lr=4.63079e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=31777
2024-11-06 22:31:49 - progress_bar.py[line:274] - INFO: epoch 013:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=18273.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3554.5, ups=0.19, wpb=18273.6, bsz=1024, num_updates=5070, lr=4.62943e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=31828
2024-11-06 22:32:41 - progress_bar.py[line:274] - INFO: epoch 013:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=18208.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3513.6, ups=0.19, wpb=18208.6, bsz=1024, num_updates=5080, lr=4.62807e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=31880
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

2024-11-06 22:32:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 5082 updates
2024-11-06 22:32:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 22:34:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-06 22:36:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 5082 updates, score 0) (writing took 220.6883977020043 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 22:37:23 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-06 22:37:23 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.586 | ntokens 17777.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6 | wps 2797.3 | ups 0.16 | wpb 17777.3 | bsz 1023 | num_updates 5082 | lr 4.6278e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1666 | gb_free 13.3 | wall 32162
2024-11-06 22:37:23 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 22:40:02 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-06 22:40:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 22:40:46 - progress_bar.py[line:274] - INFO: epoch 014:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=16881.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=347.9, ups=0.02, wpb=16881.7, bsz=985.6, num_updates=5090, lr=4.62671e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=32365
2024-11-06 22:41:38 - progress_bar.py[line:274] - INFO: epoch 014:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17891.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3464.1, ups=0.19, wpb=17891.7, bsz=1024, num_updates=5100, lr=4.62535e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32417
2024-11-06 22:42:30 - progress_bar.py[line:274] - INFO: epoch 014:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17637.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3400.9, ups=0.19, wpb=17637.7, bsz=1024, num_updates=5110, lr=4.62399e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32469
2024-11-06 22:43:22 - progress_bar.py[line:274] - INFO: epoch 014:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17771.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3396.7, ups=0.19, wpb=17771.1, bsz=1024, num_updates=5120, lr=4.62263e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32521
2024-11-06 22:44:14 - progress_bar.py[line:274] - INFO: epoch 014:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17644.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3397.2, ups=0.19, wpb=17644.5, bsz=1024, num_updates=5130, lr=4.62127e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=32573
2024-11-06 22:45:06 - progress_bar.py[line:274] - INFO: epoch 014:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17894.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3447.7, ups=0.19, wpb=17894.5, bsz=1024, num_updates=5140, lr=4.61991e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32625
2024-11-06 22:45:58 - progress_bar.py[line:274] - INFO: epoch 014:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17797.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3393.4, ups=0.19, wpb=17797.9, bsz=1024, num_updates=5150, lr=4.61854e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32677
2024-11-06 22:46:51 - progress_bar.py[line:274] - INFO: epoch 014:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17727.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3382.9, ups=0.19, wpb=17727.2, bsz=1024, num_updates=5160, lr=4.61718e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32730
2024-11-06 22:47:44 - progress_bar.py[line:274] - INFO: epoch 014:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17433.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3273.6, ups=0.19, wpb=17433.2, bsz=1024, num_updates=5170, lr=4.61582e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=32783
2024-11-06 22:48:39 - progress_bar.py[line:274] - INFO: epoch 014:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17823.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3219.3, ups=0.18, wpb=17823.7, bsz=1024, num_updates=5180, lr=4.61446e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=32838
2024-11-06 22:49:36 - progress_bar.py[line:274] - INFO: epoch 014:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17535.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3128.4, ups=0.18, wpb=17535.8, bsz=1024, num_updates=5190, lr=4.6131e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=32894
2024-11-06 22:50:31 - progress_bar.py[line:274] - INFO: epoch 014:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17782.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3223.9, ups=0.18, wpb=17782.3, bsz=1024, num_updates=5200, lr=4.61174e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=32950
2024-11-06 22:51:26 - progress_bar.py[line:274] - INFO: epoch 014:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17358, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3123.9, ups=0.18, wpb=17358, bsz=1024, num_updates=5210, lr=4.61038e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=33005
2024-11-06 22:52:21 - progress_bar.py[line:274] - INFO: epoch 014:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17799.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3224.3, ups=0.18, wpb=17799.4, bsz=1024, num_updates=5220, lr=4.60902e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=33060
2024-11-06 22:53:18 - progress_bar.py[line:274] - INFO: epoch 014:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17639.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3134.1, ups=0.18, wpb=17639.9, bsz=1024, num_updates=5230, lr=4.60766e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=33117
2024-11-06 22:54:14 - progress_bar.py[line:274] - INFO: epoch 014:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17806.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3182.8, ups=0.18, wpb=17806.9, bsz=1024, num_updates=5240, lr=4.6063e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=33173
2024-11-06 22:55:10 - progress_bar.py[line:274] - INFO: epoch 014:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17874.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3202.3, ups=0.18, wpb=17874.2, bsz=1024, num_updates=5250, lr=4.60494e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=33228
2024-11-06 22:56:06 - progress_bar.py[line:274] - INFO: epoch 014:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17524.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3125.1, ups=0.18, wpb=17524.6, bsz=1024, num_updates=5260, lr=4.60358e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=33284
2024-11-06 22:56:28 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-06 22:57:07 - progress_bar.py[line:274] - INFO: epoch 014:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=2880, ups=0.16, wpb=17660.5, bsz=1024, num_updates=5270, lr=4.60222e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=61, gb_free=13.5, wall=33346
2024-11-06 22:58:00 - progress_bar.py[line:274] - INFO: epoch 014:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17692.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3341.4, ups=0.19, wpb=17692.3, bsz=1024, num_updates=5280, lr=4.60086e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=33399
2024-11-06 22:58:52 - progress_bar.py[line:274] - INFO: epoch 014:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18134.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3447.4, ups=0.19, wpb=18134.5, bsz=1024, num_updates=5290, lr=4.5995e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33451
2024-11-06 22:59:45 - progress_bar.py[line:274] - INFO: epoch 014:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17906.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3421.8, ups=0.19, wpb=17906.9, bsz=1024, num_updates=5300, lr=4.59814e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33504
2024-11-06 23:00:38 - progress_bar.py[line:274] - INFO: epoch 014:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17631.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3335.5, ups=0.19, wpb=17631.3, bsz=1024, num_updates=5310, lr=4.59678e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33557
2024-11-06 23:01:30 - progress_bar.py[line:274] - INFO: epoch 014:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17507.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3313.6, ups=0.19, wpb=17507.4, bsz=1024, num_updates=5320, lr=4.59542e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33609
2024-11-06 23:02:23 - progress_bar.py[line:274] - INFO: epoch 014:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17680.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3369.5, ups=0.19, wpb=17680.6, bsz=1024, num_updates=5330, lr=4.59406e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33662
2024-11-06 23:03:15 - progress_bar.py[line:274] - INFO: epoch 014:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17605.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3401.4, ups=0.19, wpb=17605.6, bsz=1024, num_updates=5340, lr=4.5927e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33714
2024-11-06 23:04:07 - progress_bar.py[line:274] - INFO: epoch 014:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=18079.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3444.3, ups=0.19, wpb=18079.7, bsz=1024, num_updates=5350, lr=4.59134e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=33766
2024-11-06 23:05:01 - progress_bar.py[line:274] - INFO: epoch 014:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17696.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3298.2, ups=0.19, wpb=17696.4, bsz=1024, num_updates=5360, lr=4.58998e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=33820
2024-11-06 23:05:57 - progress_bar.py[line:274] - INFO: epoch 014:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17741.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3182.9, ups=0.18, wpb=17741.1, bsz=1024, num_updates=5370, lr=4.58862e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=33875
2024-11-06 23:06:50 - progress_bar.py[line:274] - INFO: epoch 014:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17807.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3345.3, ups=0.19, wpb=17807.3, bsz=1024, num_updates=5380, lr=4.58726e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33929
2024-11-06 23:07:43 - progress_bar.py[line:274] - INFO: epoch 014:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=18286, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3449.3, ups=0.19, wpb=18286, bsz=1024, num_updates=5390, lr=4.5859e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33982
2024-11-06 23:08:36 - progress_bar.py[line:274] - INFO: epoch 014:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=18027.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3397.9, ups=0.19, wpb=18027.4, bsz=1024, num_updates=5400, lr=4.58454e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=34035
2024-11-06 23:09:30 - progress_bar.py[line:274] - INFO: epoch 014:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17945.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3320.7, ups=0.19, wpb=17945.9, bsz=1024, num_updates=5410, lr=4.58317e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34089
2024-11-06 23:10:24 - progress_bar.py[line:274] - INFO: epoch 014:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18111.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3373, ups=0.19, wpb=18111.7, bsz=1024, num_updates=5420, lr=4.58181e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34143
2024-11-06 23:11:17 - progress_bar.py[line:274] - INFO: epoch 014:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=18439.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3425.8, ups=0.19, wpb=18439.7, bsz=1024, num_updates=5430, lr=4.58045e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34196
2024-11-06 23:12:11 - progress_bar.py[line:274] - INFO: epoch 014:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18353.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3412.9, ups=0.19, wpb=18353.3, bsz=1024, num_updates=5440, lr=4.57909e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=34250
2024-11-06 23:13:05 - progress_bar.py[line:274] - INFO: epoch 014:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=18123.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3374.1, ups=0.19, wpb=18123.2, bsz=1024, num_updates=5450, lr=4.57773e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=34304
2024-11-06 23:13:58 - progress_bar.py[line:274] - INFO: epoch 014:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=18086.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3425, ups=0.19, wpb=18086.3, bsz=1024, num_updates=5460, lr=4.57637e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=34357
2024-11-06 23:14:50 - progress_bar.py[line:274] - INFO: epoch 014:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3381.8, ups=0.19, wpb=17540.6, bsz=1024, num_updates=5470, lr=4.57501e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=34409
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-06 23:14:57 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5472 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

2024-11-06 23:14:57 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists: File exists: File exists
: File exists
: File exists
: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 23:16:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-06 23:18:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5472 updates, score 0) (writing took 211.57376466400456 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-06 23:19:23 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-06 23:19:23 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.578 | ntokens 17790.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.97 | wps 2754.1 | ups 0.15 | wpb 17790.2 | bsz 1023 | num_updates 5472 | lr 4.57474e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1882 | gb_free 13.3 | wall 34682
2024-11-06 23:19:23 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 23:22:06 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-06 23:22:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 23:22:50 - progress_bar.py[line:274] - INFO: epoch 015:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=16888.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=351.4, ups=0.02, wpb=16888.4, bsz=985.6, num_updates=5480, lr=4.57365e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=34889
2024-11-06 23:23:43 - progress_bar.py[line:274] - INFO: epoch 015:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17788, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3357.1, ups=0.19, wpb=17788, bsz=1024, num_updates=5490, lr=4.57229e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=34942
2024-11-06 23:24:36 - progress_bar.py[line:274] - INFO: epoch 015:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17398.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3297.7, ups=0.19, wpb=17398.6, bsz=1024, num_updates=5500, lr=4.57093e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=34995
2024-11-06 23:25:28 - progress_bar.py[line:274] - INFO: epoch 015:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17952.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3449.7, ups=0.19, wpb=17952.9, bsz=1024, num_updates=5510, lr=4.56957e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35047
2024-11-06 23:26:20 - progress_bar.py[line:274] - INFO: epoch 015:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17658.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3396.4, ups=0.19, wpb=17658.1, bsz=1024, num_updates=5520, lr=4.56821e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35099
2024-11-06 23:27:12 - progress_bar.py[line:274] - INFO: epoch 015:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17716.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3409, ups=0.19, wpb=17716.8, bsz=1024, num_updates=5530, lr=4.56685e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35151
2024-11-06 23:28:05 - progress_bar.py[line:274] - INFO: epoch 015:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17849.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3391.8, ups=0.19, wpb=17849.3, bsz=1024, num_updates=5540, lr=4.56549e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=35203
2024-11-06 23:28:57 - progress_bar.py[line:274] - INFO: epoch 015:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17716.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3371.1, ups=0.19, wpb=17716.6, bsz=1024, num_updates=5550, lr=4.56413e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35256
2024-11-06 23:29:49 - progress_bar.py[line:274] - INFO: epoch 015:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17641.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3393.7, ups=0.19, wpb=17641.6, bsz=1024, num_updates=5560, lr=4.56277e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35308
2024-11-06 23:30:41 - progress_bar.py[line:274] - INFO: epoch 015:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17892.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3452.6, ups=0.19, wpb=17892.3, bsz=1024, num_updates=5570, lr=4.56141e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35360
2024-11-06 23:31:33 - progress_bar.py[line:274] - INFO: epoch 015:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17209.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3296.3, ups=0.19, wpb=17209.8, bsz=1024, num_updates=5580, lr=4.56005e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35412
2024-11-06 23:32:26 - progress_bar.py[line:274] - INFO: epoch 015:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17748.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3377.3, ups=0.19, wpb=17748.6, bsz=1024, num_updates=5590, lr=4.55869e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35465
2024-11-06 23:33:18 - progress_bar.py[line:274] - INFO: epoch 015:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17337.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3332.9, ups=0.19, wpb=17337.9, bsz=1024, num_updates=5600, lr=4.55733e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35517
2024-11-06 23:34:10 - progress_bar.py[line:274] - INFO: epoch 015:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17750.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3400, ups=0.19, wpb=17750.4, bsz=1024, num_updates=5610, lr=4.55597e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=35569
2024-11-06 23:35:03 - progress_bar.py[line:274] - INFO: epoch 015:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17636.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3311, ups=0.19, wpb=17636.3, bsz=1024, num_updates=5620, lr=4.55461e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=35622
2024-11-06 23:35:57 - progress_bar.py[line:274] - INFO: epoch 015:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17748.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3298.8, ups=0.19, wpb=17748.3, bsz=1024, num_updates=5630, lr=4.55325e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=37, gb_free=13.5, wall=35676
2024-11-06 23:36:51 - progress_bar.py[line:274] - INFO: epoch 015:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=18143.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3380.4, ups=0.19, wpb=18143.1, bsz=1024, num_updates=5640, lr=4.55189e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=35730
2024-11-06 23:37:44 - progress_bar.py[line:274] - INFO: epoch 015:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17474.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3270.4, ups=0.19, wpb=17474.8, bsz=1024, num_updates=5650, lr=4.55053e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=35783
2024-11-06 23:38:38 - progress_bar.py[line:274] - INFO: epoch 015:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17724.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3285, ups=0.19, wpb=17724.8, bsz=1024, num_updates=5660, lr=4.54916e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=35837
2024-11-06 23:39:31 - progress_bar.py[line:274] - INFO: epoch 015:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17671.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3319.9, ups=0.19, wpb=17671.2, bsz=1024, num_updates=5670, lr=4.5478e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=35890
2024-11-06 23:40:24 - progress_bar.py[line:274] - INFO: epoch 015:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=18129.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3469.8, ups=0.19, wpb=18129.3, bsz=1024, num_updates=5680, lr=4.54644e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=35942
2024-11-06 23:41:16 - progress_bar.py[line:274] - INFO: epoch 015:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17835.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3409.1, ups=0.19, wpb=17835.3, bsz=1024, num_updates=5690, lr=4.54508e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=35995
2024-11-06 23:42:08 - progress_bar.py[line:274] - INFO: epoch 015:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17940.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3436.3, ups=0.19, wpb=17940.6, bsz=1024, num_updates=5700, lr=4.54372e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=36047
2024-11-06 23:42:59 - progress_bar.py[line:274] - INFO: epoch 015:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17362.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3409.9, ups=0.2, wpb=17362.1, bsz=1024, num_updates=5710, lr=4.54236e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.5, wall=36098
2024-11-06 23:43:51 - progress_bar.py[line:274] - INFO: epoch 015:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17673.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3398.4, ups=0.19, wpb=17673.1, bsz=1024, num_updates=5720, lr=4.541e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=36150
2024-11-06 23:44:43 - progress_bar.py[line:274] - INFO: epoch 015:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17425.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3326.5, ups=0.19, wpb=17425.4, bsz=1024, num_updates=5730, lr=4.53964e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=47, gb_free=13.5, wall=36202
2024-11-06 23:45:35 - progress_bar.py[line:274] - INFO: epoch 015:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18134.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3487.3, ups=0.19, wpb=18134.9, bsz=1024, num_updates=5740, lr=4.53828e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=48, gb_free=13.5, wall=36254
2024-11-06 23:46:28 - progress_bar.py[line:274] - INFO: epoch 015:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17620.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3373.5, ups=0.19, wpb=17620.5, bsz=1024, num_updates=5750, lr=4.53692e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=42, gb_free=13.4, wall=36306
2024-11-06 23:47:20 - progress_bar.py[line:274] - INFO: epoch 015:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17771.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3413.4, ups=0.19, wpb=17771.4, bsz=1024, num_updates=5760, lr=4.53556e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=39, gb_free=13.6, wall=36359
2024-11-06 23:48:12 - progress_bar.py[line:274] - INFO: epoch 015:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17657.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3377.9, ups=0.19, wpb=17657.5, bsz=1024, num_updates=5770, lr=4.5342e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=36411
2024-11-06 23:49:04 - progress_bar.py[line:274] - INFO: epoch 015:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=18611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3607.9, ups=0.19, wpb=18611.1, bsz=1024, num_updates=5780, lr=4.53284e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=44, gb_free=13.2, wall=36462
2024-11-06 23:49:55 - progress_bar.py[line:274] - INFO: epoch 015:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=18197.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3513.9, ups=0.19, wpb=18197.7, bsz=1024, num_updates=5790, lr=4.53148e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=44, gb_free=13.3, wall=36514
2024-11-06 23:50:49 - progress_bar.py[line:274] - INFO: epoch 015:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=18193.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3372.4, ups=0.19, wpb=18193.1, bsz=1024, num_updates=5800, lr=4.53012e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=36568
2024-11-06 23:51:43 - progress_bar.py[line:274] - INFO: epoch 015:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=18373.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3395.1, ups=0.18, wpb=18373.1, bsz=1024, num_updates=5810, lr=4.52876e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36622
2024-11-06 23:52:37 - progress_bar.py[line:274] - INFO: epoch 015:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=18694.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3466.6, ups=0.19, wpb=18694.8, bsz=1024, num_updates=5820, lr=4.5274e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=36676
2024-11-06 23:53:31 - progress_bar.py[line:274] - INFO: epoch 015:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18297.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3380.5, ups=0.18, wpb=18297.4, bsz=1024, num_updates=5830, lr=4.52604e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=36730
2024-11-06 23:54:25 - progress_bar.py[line:274] - INFO: epoch 015:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=18049.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3357, ups=0.19, wpb=18049.9, bsz=1024, num_updates=5840, lr=4.52468e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36784
2024-11-06 23:55:19 - progress_bar.py[line:274] - INFO: epoch 015:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18343.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3398, ups=0.19, wpb=18343.5, bsz=1024, num_updates=5850, lr=4.52332e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36838
2024-11-06 23:56:11 - progress_bar.py[line:274] - INFO: epoch 015:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17862.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3463.2, ups=0.19, wpb=17862.8, bsz=1024, num_updates=5860, lr=4.52196e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=36890
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

2024-11-06 23:56:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5863 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-06 23:56:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 23:58:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 00:00:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5863 updates, score 0) (writing took 222.57859106099932 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000slice_id 4 seek offset 200000

2024-11-07 00:01:00 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-07 00:01:00 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.576 | ntokens 17824.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.96 | wps 2790.5 | ups 0.16 | wpb 17824.1 | bsz 1023 | num_updates 5863 | lr 4.52155e-05 | gnorm 0.009 | clip 0 | loss_scale 32768 | train_wall 1632 | gb_free 13.3 | wall 37179
2024-11-07 00:01:00 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 00:03:40 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-07 00:03:40 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 00:04:18 - progress_bar.py[line:274] - INFO: epoch 016:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=16874.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=346, ups=0.02, wpb=16874.7, bsz=985.6, num_updates=5870, lr=4.5206e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=37377
2024-11-07 00:05:11 - progress_bar.py[line:274] - INFO: epoch 016:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17724.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3389.5, ups=0.19, wpb=17724.1, bsz=1024, num_updates=5880, lr=4.51924e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=37430
2024-11-07 00:06:03 - progress_bar.py[line:274] - INFO: epoch 016:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17606.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3336.8, ups=0.19, wpb=17606.8, bsz=1024, num_updates=5890, lr=4.51788e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37482
2024-11-07 00:06:56 - progress_bar.py[line:274] - INFO: epoch 016:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18099.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3456.6, ups=0.19, wpb=18099.8, bsz=1024, num_updates=5900, lr=4.51652e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37535
2024-11-07 00:07:48 - progress_bar.py[line:274] - INFO: epoch 016:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17565.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3401.5, ups=0.19, wpb=17565.9, bsz=1024, num_updates=5910, lr=4.51515e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37586
2024-11-07 00:08:40 - progress_bar.py[line:274] - INFO: epoch 016:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17510.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3330.1, ups=0.19, wpb=17510.9, bsz=1024, num_updates=5920, lr=4.51379e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37639
2024-11-07 00:09:33 - progress_bar.py[line:274] - INFO: epoch 016:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17756.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3341.9, ups=0.19, wpb=17756.7, bsz=1024, num_updates=5930, lr=4.51243e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37692
2024-11-07 00:10:25 - progress_bar.py[line:274] - INFO: epoch 016:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17649.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3392.1, ups=0.19, wpb=17649.9, bsz=1024, num_updates=5940, lr=4.51107e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37744
2024-11-07 00:11:17 - progress_bar.py[line:274] - INFO: epoch 016:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17583.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3400.2, ups=0.19, wpb=17583.4, bsz=1024, num_updates=5950, lr=4.50971e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37796
2024-11-07 00:12:10 - progress_bar.py[line:274] - INFO: epoch 016:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17481.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3317, ups=0.19, wpb=17481.7, bsz=1024, num_updates=5960, lr=4.50835e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37849
2024-11-07 00:13:02 - progress_bar.py[line:274] - INFO: epoch 016:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17497.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3347.4, ups=0.19, wpb=17497.8, bsz=1024, num_updates=5970, lr=4.50699e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37901
2024-11-07 00:13:55 - progress_bar.py[line:274] - INFO: epoch 016:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17805.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3384.1, ups=0.19, wpb=17805.2, bsz=1024, num_updates=5980, lr=4.50563e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=37953
2024-11-07 00:14:47 - progress_bar.py[line:274] - INFO: epoch 016:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17482.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3350.8, ups=0.19, wpb=17482.3, bsz=1024, num_updates=5990, lr=4.50427e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38006
2024-11-07 00:15:39 - progress_bar.py[line:274] - INFO: epoch 016:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17593.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3340, ups=0.19, wpb=17593.5, bsz=1024, num_updates=6000, lr=4.50291e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=38058
2024-11-07 00:16:32 - progress_bar.py[line:274] - INFO: epoch 016:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17763.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3375, ups=0.19, wpb=17763.6, bsz=1024, num_updates=6010, lr=4.50155e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38111
2024-11-07 00:17:24 - progress_bar.py[line:274] - INFO: epoch 016:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17809.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3418.1, ups=0.19, wpb=17809.5, bsz=1024, num_updates=6020, lr=4.50019e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=38163
2024-11-07 00:18:18 - progress_bar.py[line:274] - INFO: epoch 016:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18219.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3361.7, ups=0.18, wpb=18219.5, bsz=1024, num_updates=6030, lr=4.49883e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=38217
2024-11-07 00:19:10 - progress_bar.py[line:274] - INFO: epoch 016:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17357.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3338.4, ups=0.19, wpb=17357.7, bsz=1024, num_updates=6040, lr=4.49747e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38269
2024-11-07 00:20:03 - progress_bar.py[line:274] - INFO: epoch 016:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17900.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3398.2, ups=0.19, wpb=17900.6, bsz=1024, num_updates=6050, lr=4.49611e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38322
2024-11-07 00:20:55 - progress_bar.py[line:274] - INFO: epoch 016:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17719.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3399.9, ups=0.19, wpb=17719.7, bsz=1024, num_updates=6060, lr=4.49475e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38374
2024-11-07 00:21:48 - progress_bar.py[line:274] - INFO: epoch 016:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17867.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3384.6, ups=0.19, wpb=17867.5, bsz=1024, num_updates=6070, lr=4.49339e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38427
2024-11-07 00:22:40 - progress_bar.py[line:274] - INFO: epoch 016:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=18008.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3454.4, ups=0.19, wpb=18008.3, bsz=1024, num_updates=6080, lr=4.49203e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=38479
2024-11-07 00:23:33 - progress_bar.py[line:274] - INFO: epoch 016:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17647.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3349.3, ups=0.19, wpb=17647.5, bsz=1024, num_updates=6090, lr=4.49067e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38532
2024-11-07 00:24:26 - progress_bar.py[line:274] - INFO: epoch 016:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17179.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3240.9, ups=0.19, wpb=17179.2, bsz=1024, num_updates=6100, lr=4.48931e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=38585
2024-11-07 00:25:18 - progress_bar.py[line:274] - INFO: epoch 016:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3393.5, ups=0.19, wpb=17611.1, bsz=1024, num_updates=6110, lr=4.48795e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38637
2024-11-07 00:26:10 - progress_bar.py[line:274] - INFO: epoch 016:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17585.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3352, ups=0.19, wpb=17585.6, bsz=1024, num_updates=6120, lr=4.48659e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38689
2024-11-07 00:27:02 - progress_bar.py[line:274] - INFO: epoch 016:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=18103.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3468.6, ups=0.19, wpb=18103.3, bsz=1024, num_updates=6130, lr=4.48523e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38741
2024-11-07 00:27:54 - progress_bar.py[line:274] - INFO: epoch 016:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17710.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3395.4, ups=0.19, wpb=17710.9, bsz=1024, num_updates=6140, lr=4.48387e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38793
2024-11-07 00:28:48 - progress_bar.py[line:274] - INFO: epoch 016:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17454.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3290.1, ups=0.19, wpb=17454.1, bsz=1024, num_updates=6150, lr=4.48251e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38846
2024-11-07 00:29:40 - progress_bar.py[line:274] - INFO: epoch 016:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17716.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3403.4, ups=0.19, wpb=17716.7, bsz=1024, num_updates=6160, lr=4.48114e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38898
2024-11-07 00:30:32 - progress_bar.py[line:274] - INFO: epoch 016:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=18525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3557, ups=0.19, wpb=18525.8, bsz=1024, num_updates=6170, lr=4.47978e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=38951
2024-11-07 00:31:23 - progress_bar.py[line:274] - INFO: epoch 016:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18116.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3495.6, ups=0.19, wpb=18116.6, bsz=1024, num_updates=6180, lr=4.47842e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=39002
2024-11-07 00:32:15 - progress_bar.py[line:274] - INFO: epoch 016:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17904.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3445.7, ups=0.19, wpb=17904.2, bsz=1024, num_updates=6190, lr=4.47706e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=39054
2024-11-07 00:33:08 - progress_bar.py[line:274] - INFO: epoch 016:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18129.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3473.1, ups=0.19, wpb=18129.8, bsz=1024, num_updates=6200, lr=4.4757e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=39107
2024-11-07 00:34:02 - progress_bar.py[line:274] - INFO: epoch 016:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=18613.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3405.1, ups=0.18, wpb=18613.2, bsz=1024, num_updates=6210, lr=4.47434e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=39161
2024-11-07 00:34:57 - progress_bar.py[line:274] - INFO: epoch 016:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=18229.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3307.9, ups=0.18, wpb=18229.4, bsz=1024, num_updates=6220, lr=4.47298e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=39216
2024-11-07 00:35:53 - progress_bar.py[line:274] - INFO: epoch 016:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18483.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3349.8, ups=0.18, wpb=18483.7, bsz=1024, num_updates=6230, lr=4.47162e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=39271
2024-11-07 00:36:48 - progress_bar.py[line:274] - INFO: epoch 016:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17855.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3223.9, ups=0.18, wpb=17855.2, bsz=1024, num_updates=6240, lr=4.47026e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=39327
2024-11-07 00:37:44 - progress_bar.py[line:274] - INFO: epoch 016:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3236.8, ups=0.18, wpb=18040.3, bsz=1024, num_updates=6250, lr=4.4689e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=39383
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 00:38:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 6254 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 00:38:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 00:39:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-07 00:41:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 6254 updates, score 0) (writing took 222.36170212901197 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 00:42:38 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-07 00:42:38 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.563 | ntokens 17786.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.91 | wps 2783.8 | ups 0.16 | wpb 17786.6 | bsz 1023 | num_updates 6254 | lr 4.46836e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1309 | gb_free 13.4 | wall 39677
2024-11-07 00:42:38 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 00:45:18 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-07 00:45:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 00:45:51 - progress_bar.py[line:274] - INFO: epoch 017:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=16807, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=344.8, ups=0.02, wpb=16807, bsz=985.6, num_updates=6260, lr=4.46754e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=39870
2024-11-07 00:46:44 - progress_bar.py[line:274] - INFO: epoch 017:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17664.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3342.7, ups=0.19, wpb=17664.7, bsz=1024, num_updates=6270, lr=4.46618e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=39923
2024-11-07 00:47:37 - progress_bar.py[line:274] - INFO: epoch 017:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17441.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3312.9, ups=0.19, wpb=17441.1, bsz=1024, num_updates=6280, lr=4.46482e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=39975
2024-11-07 00:48:29 - progress_bar.py[line:274] - INFO: epoch 017:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17889.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3409.5, ups=0.19, wpb=17889.3, bsz=1024, num_updates=6290, lr=4.46346e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40028
2024-11-07 00:49:21 - progress_bar.py[line:274] - INFO: epoch 017:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17516, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3369.5, ups=0.19, wpb=17516, bsz=1024, num_updates=6300, lr=4.4621e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40080
2024-11-07 00:50:14 - progress_bar.py[line:274] - INFO: epoch 017:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17646.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3362.6, ups=0.19, wpb=17646.8, bsz=1024, num_updates=6310, lr=4.46074e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=40132
2024-11-07 00:51:06 - progress_bar.py[line:274] - INFO: epoch 017:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17989.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3456.5, ups=0.19, wpb=17989.1, bsz=1024, num_updates=6320, lr=4.45938e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=40184
2024-11-07 00:51:57 - progress_bar.py[line:274] - INFO: epoch 017:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17409.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3365.1, ups=0.19, wpb=17409.8, bsz=1024, num_updates=6330, lr=4.45802e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40236
2024-11-07 00:52:49 - progress_bar.py[line:274] - INFO: epoch 017:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17724.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3402.3, ups=0.19, wpb=17724.2, bsz=1024, num_updates=6340, lr=4.45666e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=40288
2024-11-07 00:53:42 - progress_bar.py[line:274] - INFO: epoch 017:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17665.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3355.9, ups=0.19, wpb=17665.6, bsz=1024, num_updates=6350, lr=4.4553e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40341
2024-11-07 00:54:34 - progress_bar.py[line:274] - INFO: epoch 017:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17642.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3387.4, ups=0.19, wpb=17642.3, bsz=1024, num_updates=6360, lr=4.45394e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=40393
2024-11-07 00:55:26 - progress_bar.py[line:274] - INFO: epoch 017:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17817.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3423.6, ups=0.19, wpb=17817.6, bsz=1024, num_updates=6370, lr=4.45258e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40445
2024-11-07 00:56:20 - progress_bar.py[line:274] - INFO: epoch 017:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3253.1, ups=0.18, wpb=17590.9, bsz=1024, num_updates=6380, lr=4.45122e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=40499
2024-11-07 00:57:14 - progress_bar.py[line:274] - INFO: epoch 017:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17663.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3300.8, ups=0.19, wpb=17663.8, bsz=1024, num_updates=6390, lr=4.44986e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=40553
2024-11-07 00:58:07 - progress_bar.py[line:274] - INFO: epoch 017:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17698.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3296.5, ups=0.19, wpb=17698.3, bsz=1024, num_updates=6400, lr=4.4485e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=40606
2024-11-07 00:59:01 - progress_bar.py[line:274] - INFO: epoch 017:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=17502.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3284.2, ups=0.19, wpb=17502.9, bsz=1024, num_updates=6410, lr=4.44714e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=40660
2024-11-07 00:59:53 - progress_bar.py[line:274] - INFO: epoch 017:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17786.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3399.4, ups=0.19, wpb=17786.7, bsz=1024, num_updates=6420, lr=4.44577e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=40712
2024-11-07 01:00:45 - progress_bar.py[line:274] - INFO: epoch 017:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17432.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3364.4, ups=0.19, wpb=17432.7, bsz=1024, num_updates=6430, lr=4.44441e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=40764
2024-11-07 01:01:37 - progress_bar.py[line:274] - INFO: epoch 017:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17821.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3414, ups=0.19, wpb=17821.6, bsz=1024, num_updates=6440, lr=4.44305e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=40816
2024-11-07 01:02:29 - progress_bar.py[line:274] - INFO: epoch 017:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18043, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3459.1, ups=0.19, wpb=18043, bsz=1024, num_updates=6450, lr=4.44169e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=40868
2024-11-07 01:03:21 - progress_bar.py[line:274] - INFO: epoch 017:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17859.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3430.4, ups=0.19, wpb=17859.1, bsz=1024, num_updates=6460, lr=4.44033e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=40920
2024-11-07 01:04:14 - progress_bar.py[line:274] - INFO: epoch 017:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17918.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3430.8, ups=0.19, wpb=17918.5, bsz=1024, num_updates=6470, lr=4.43897e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=40972
2024-11-07 01:05:05 - progress_bar.py[line:274] - INFO: epoch 017:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17941.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3461.5, ups=0.19, wpb=17941.3, bsz=1024, num_updates=6480, lr=4.43761e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=41024
2024-11-07 01:05:57 - progress_bar.py[line:274] - INFO: epoch 017:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17611.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3394.8, ups=0.19, wpb=17611.9, bsz=1024, num_updates=6490, lr=4.43625e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=41076
2024-11-07 01:06:49 - progress_bar.py[line:274] - INFO: epoch 017:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17354.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3326.9, ups=0.19, wpb=17354.7, bsz=1024, num_updates=6500, lr=4.43489e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=41128
2024-11-07 01:07:42 - progress_bar.py[line:274] - INFO: epoch 017:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17608, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3350, ups=0.19, wpb=17608, bsz=1024, num_updates=6510, lr=4.43353e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=41181
2024-11-07 01:08:24 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 01:08:40 - progress_bar.py[line:274] - INFO: epoch 017:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17858.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3097.6, ups=0.17, wpb=17858.3, bsz=1024, num_updates=6520, lr=4.43217e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=41239
2024-11-07 01:09:32 - progress_bar.py[line:274] - INFO: epoch 017:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3335.9, ups=0.19, wpb=17611.1, bsz=1024, num_updates=6530, lr=4.43081e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41291
2024-11-07 01:10:25 - progress_bar.py[line:274] - INFO: epoch 017:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17626, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3352.4, ups=0.19, wpb=17626, bsz=1024, num_updates=6540, lr=4.42945e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=41344
2024-11-07 01:11:18 - progress_bar.py[line:274] - INFO: epoch 017:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17679.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3307.9, ups=0.19, wpb=17679.5, bsz=1024, num_updates=6550, lr=4.42809e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41397
2024-11-07 01:12:12 - progress_bar.py[line:274] - INFO: epoch 017:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=18479.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3422.2, ups=0.19, wpb=18479.6, bsz=1024, num_updates=6560, lr=4.42673e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=41451
2024-11-07 01:13:06 - progress_bar.py[line:274] - INFO: epoch 017:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18188.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3398.9, ups=0.19, wpb=18188.5, bsz=1024, num_updates=6570, lr=4.42537e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41505
2024-11-07 01:13:59 - progress_bar.py[line:274] - INFO: epoch 017:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=18555.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3474.5, ups=0.19, wpb=18555.9, bsz=1024, num_updates=6580, lr=4.42401e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=41558
2024-11-07 01:14:53 - progress_bar.py[line:274] - INFO: epoch 017:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=18213.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3414.3, ups=0.19, wpb=18213.6, bsz=1024, num_updates=6590, lr=4.42265e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41612
2024-11-07 01:15:46 - progress_bar.py[line:274] - INFO: epoch 017:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18627.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3467.8, ups=0.19, wpb=18627.4, bsz=1024, num_updates=6600, lr=4.42129e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=41665
2024-11-07 01:16:39 - progress_bar.py[line:274] - INFO: epoch 017:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=18216.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3443.6, ups=0.19, wpb=18216.5, bsz=1024, num_updates=6610, lr=4.41993e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41718
2024-11-07 01:17:33 - progress_bar.py[line:274] - INFO: epoch 017:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=18217.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3413.3, ups=0.19, wpb=18217.5, bsz=1024, num_updates=6620, lr=4.41857e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=41772
2024-11-07 01:18:25 - progress_bar.py[line:274] - INFO: epoch 017:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17754.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3384.1, ups=0.19, wpb=17754.9, bsz=1024, num_updates=6630, lr=4.41721e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=41824
2024-11-07 01:19:19 - progress_bar.py[line:274] - INFO: epoch 017:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=18047.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3364.7, ups=0.19, wpb=18047.6, bsz=1024, num_updates=6640, lr=4.41585e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=41878
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt2024-11-07 01:19:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6644 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-07 01:19:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 01:21:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 01:23:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6644 updates, score 0) (writing took 222.2265964919934 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 01:24:13 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-07 01:24:13 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.554 | ntokens 17800.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.87 | wps 2782.7 | ups 0.16 | wpb 17800.4 | bsz 1023 | num_updates 6644 | lr 4.4153e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1774 | gb_free 13.4 | wall 42172
2024-11-07 01:24:13 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 01:26:52 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-07 01:26:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 01:27:25 - progress_bar.py[line:274] - INFO: epoch 018:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=16905.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=347.5, ups=0.02, wpb=16905.2, bsz=985.6, num_updates=6650, lr=4.41449e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=42364
2024-11-07 01:28:18 - progress_bar.py[line:274] - INFO: epoch 018:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17690.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3365.8, ups=0.19, wpb=17690.4, bsz=1024, num_updates=6660, lr=4.41313e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=42417
2024-11-07 01:29:10 - progress_bar.py[line:274] - INFO: epoch 018:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17411.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3306.9, ups=0.19, wpb=17411.3, bsz=1024, num_updates=6670, lr=4.41176e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42469
2024-11-07 01:30:02 - progress_bar.py[line:274] - INFO: epoch 018:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17778.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3424.7, ups=0.19, wpb=17778.9, bsz=1024, num_updates=6680, lr=4.4104e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=42521
2024-11-07 01:30:54 - progress_bar.py[line:274] - INFO: epoch 018:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17597.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3393.4, ups=0.19, wpb=17597.8, bsz=1024, num_updates=6690, lr=4.40904e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42573
2024-11-07 01:31:46 - progress_bar.py[line:274] - INFO: epoch 018:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17756.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3423.5, ups=0.19, wpb=17756.2, bsz=1024, num_updates=6700, lr=4.40768e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42625
2024-11-07 01:32:39 - progress_bar.py[line:274] - INFO: epoch 018:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17912, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3407.9, ups=0.19, wpb=17912, bsz=1024, num_updates=6710, lr=4.40632e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42678
2024-11-07 01:33:31 - progress_bar.py[line:274] - INFO: epoch 018:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17547.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3364.5, ups=0.19, wpb=17547.1, bsz=1024, num_updates=6720, lr=4.40496e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42730
2024-11-07 01:34:24 - progress_bar.py[line:274] - INFO: epoch 018:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17763.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3347.6, ups=0.19, wpb=17763.4, bsz=1024, num_updates=6730, lr=4.4036e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42783
2024-11-07 01:35:16 - progress_bar.py[line:274] - INFO: epoch 018:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17948.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3441.1, ups=0.19, wpb=17948.6, bsz=1024, num_updates=6740, lr=4.40224e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42835
2024-11-07 01:36:08 - progress_bar.py[line:274] - INFO: epoch 018:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17604.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3391.2, ups=0.19, wpb=17604.8, bsz=1024, num_updates=6750, lr=4.40088e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42887
2024-11-07 01:37:00 - progress_bar.py[line:274] - INFO: epoch 018:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17684.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3375.3, ups=0.19, wpb=17684.2, bsz=1024, num_updates=6760, lr=4.39952e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42939
2024-11-07 01:37:54 - progress_bar.py[line:274] - INFO: epoch 018:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3226.5, ups=0.19, wpb=17398.1, bsz=1024, num_updates=6770, lr=4.39816e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=42993
2024-11-07 01:38:50 - progress_bar.py[line:274] - INFO: epoch 018:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17447.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3120.1, ups=0.18, wpb=17447.3, bsz=1024, num_updates=6780, lr=4.3968e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=43049
2024-11-07 01:39:43 - progress_bar.py[line:274] - INFO: epoch 018:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=18061.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3435.2, ups=0.19, wpb=18061.2, bsz=1024, num_updates=6790, lr=4.39544e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=43102
2024-11-07 01:40:35 - progress_bar.py[line:274] - INFO: epoch 018:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17689.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3370.2, ups=0.19, wpb=17689.6, bsz=1024, num_updates=6800, lr=4.39408e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=43154
2024-11-07 01:41:28 - progress_bar.py[line:274] - INFO: epoch 018:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=18074.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3429, ups=0.19, wpb=18074.8, bsz=1024, num_updates=6810, lr=4.39272e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=43207
2024-11-07 01:42:24 - progress_bar.py[line:274] - INFO: epoch 018:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17661, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3135.8, ups=0.18, wpb=17661, bsz=1024, num_updates=6820, lr=4.39136e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=43263
2024-11-07 01:43:20 - progress_bar.py[line:274] - INFO: epoch 018:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17578.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3138.4, ups=0.18, wpb=17578.5, bsz=1024, num_updates=6830, lr=4.39e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=43319
2024-11-07 01:44:13 - progress_bar.py[line:274] - INFO: epoch 018:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17651.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3321.9, ups=0.19, wpb=17651.4, bsz=1024, num_updates=6840, lr=4.38864e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43372
2024-11-07 01:45:06 - progress_bar.py[line:274] - INFO: epoch 018:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=18082.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3433.7, ups=0.19, wpb=18082.2, bsz=1024, num_updates=6850, lr=4.38728e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=43425
2024-11-07 01:45:59 - progress_bar.py[line:274] - INFO: epoch 018:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17840.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3393.1, ups=0.19, wpb=17840.8, bsz=1024, num_updates=6860, lr=4.38592e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43478
2024-11-07 01:46:51 - progress_bar.py[line:274] - INFO: epoch 018:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17811.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3408.4, ups=0.19, wpb=17811.4, bsz=1024, num_updates=6870, lr=4.38456e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=43530
2024-11-07 01:47:43 - progress_bar.py[line:274] - INFO: epoch 018:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17427.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3330.4, ups=0.19, wpb=17427.3, bsz=1024, num_updates=6880, lr=4.3832e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=43582
2024-11-07 01:48:36 - progress_bar.py[line:274] - INFO: epoch 018:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17351.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3307.8, ups=0.19, wpb=17351.4, bsz=1024, num_updates=6890, lr=4.38184e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=43635
2024-11-07 01:49:28 - progress_bar.py[line:274] - INFO: epoch 018:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17591.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3338.2, ups=0.19, wpb=17591.6, bsz=1024, num_updates=6900, lr=4.38048e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=43687
2024-11-07 01:50:21 - progress_bar.py[line:274] - INFO: epoch 018:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=18000.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3440.8, ups=0.19, wpb=18000.2, bsz=1024, num_updates=6910, lr=4.37912e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43740
2024-11-07 01:51:13 - progress_bar.py[line:274] - INFO: epoch 018:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17755.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3375.6, ups=0.19, wpb=17755.5, bsz=1024, num_updates=6920, lr=4.37775e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43792
2024-11-07 01:52:06 - progress_bar.py[line:274] - INFO: epoch 018:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3349.6, ups=0.19, wpb=17508.1, bsz=1024, num_updates=6930, lr=4.37639e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43845
2024-11-07 01:52:58 - progress_bar.py[line:274] - INFO: epoch 018:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17919.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3446.6, ups=0.19, wpb=17919.1, bsz=1024, num_updates=6940, lr=4.37503e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43896
2024-11-07 01:53:50 - progress_bar.py[line:274] - INFO: epoch 018:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=18323.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3465.1, ups=0.19, wpb=18323.3, bsz=1024, num_updates=6950, lr=4.37367e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=43949
2024-11-07 01:54:42 - progress_bar.py[line:274] - INFO: epoch 018:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18077.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3502.1, ups=0.19, wpb=18077.7, bsz=1024, num_updates=6960, lr=4.37231e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=44001
2024-11-07 01:55:35 - progress_bar.py[line:274] - INFO: epoch 018:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17846, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3401.2, ups=0.19, wpb=17846, bsz=1024, num_updates=6970, lr=4.37095e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=44053
2024-11-07 01:56:26 - progress_bar.py[line:274] - INFO: epoch 018:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18218.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3546.1, ups=0.19, wpb=18218.2, bsz=1024, num_updates=6980, lr=4.36959e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=44105
2024-11-07 01:57:18 - progress_bar.py[line:274] - INFO: epoch 018:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=18517.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3545, ups=0.19, wpb=18517.8, bsz=1024, num_updates=6990, lr=4.36823e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=44157
2024-11-07 01:58:10 - progress_bar.py[line:274] - INFO: epoch 018:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18404.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3544.9, ups=0.19, wpb=18404.7, bsz=1024, num_updates=7000, lr=4.36687e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=37, gb_free=13.4, wall=44209
2024-11-07 01:59:02 - progress_bar.py[line:274] - INFO: epoch 018:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=18572, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3548.9, ups=0.19, wpb=18572, bsz=1024, num_updates=7010, lr=4.36551e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=44261
2024-11-07 01:59:55 - progress_bar.py[line:274] - INFO: epoch 018:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18409.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3505.9, ups=0.19, wpb=18409.7, bsz=1024, num_updates=7020, lr=4.36415e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=45, gb_free=13.4, wall=44314
2024-11-07 02:00:47 - progress_bar.py[line:274] - INFO: epoch 018:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=18058.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3468, ups=0.19, wpb=18058.9, bsz=1024, num_updates=7030, lr=4.36279e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=48, gb_free=13.4, wall=44366
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt


2024-11-07 02:01:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 7035 updates
2024-11-07 02:01:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 02:03:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 02:04:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 18 @ 7035 updates, score 0) (writing took 222.36915990599664 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
2024-11-07 02:05:47 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-07 02:05:47 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.557 | ntokens 17820 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.89 | wps 2794 | ups 0.16 | wpb 17820 | bsz 1023 | num_updates 7035 | lr 4.36211e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1372 | gb_free 13.4 | wall 44666
2024-11-07 02:05:47 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 02:08:27 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-07 02:08:27 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 02:08:55 - progress_bar.py[line:274] - INFO: epoch 019:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16966.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=347.7, ups=0.02, wpb=16966.3, bsz=985.6, num_updates=7040, lr=4.36143e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=44854
2024-11-07 02:09:48 - progress_bar.py[line:274] - INFO: epoch 019:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17702.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3355.6, ups=0.19, wpb=17702.5, bsz=1024, num_updates=7050, lr=4.36007e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=44907
2024-11-07 02:10:40 - progress_bar.py[line:274] - INFO: epoch 019:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17532, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3341, ups=0.19, wpb=17532, bsz=1024, num_updates=7060, lr=4.35871e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=44959
2024-11-07 02:11:32 - progress_bar.py[line:274] - INFO: epoch 019:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17750, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3412.9, ups=0.19, wpb=17750, bsz=1024, num_updates=7070, lr=4.35735e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=45011
2024-11-07 02:12:27 - progress_bar.py[line:274] - INFO: epoch 019:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17622.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3210.9, ups=0.18, wpb=17622.6, bsz=1024, num_updates=7080, lr=4.35599e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=45066
2024-11-07 02:13:23 - progress_bar.py[line:274] - INFO: epoch 019:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17785.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3197.6, ups=0.18, wpb=17785.6, bsz=1024, num_updates=7090, lr=4.35463e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=45122
2024-11-07 02:14:16 - progress_bar.py[line:274] - INFO: epoch 019:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17919.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3364, ups=0.19, wpb=17919.3, bsz=1024, num_updates=7100, lr=4.35327e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=45175
2024-11-07 02:15:11 - progress_bar.py[line:274] - INFO: epoch 019:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3213.3, ups=0.18, wpb=17685.5, bsz=1024, num_updates=7110, lr=4.35191e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=45230
2024-11-07 02:16:07 - progress_bar.py[line:274] - INFO: epoch 019:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17855.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3208.8, ups=0.18, wpb=17855.3, bsz=1024, num_updates=7120, lr=4.35055e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=45286
2024-11-07 02:17:03 - progress_bar.py[line:274] - INFO: epoch 019:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17514.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3135.2, ups=0.18, wpb=17514.6, bsz=1024, num_updates=7130, lr=4.34919e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=45341
2024-11-07 02:17:57 - progress_bar.py[line:274] - INFO: epoch 019:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17907.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3262.8, ups=0.18, wpb=17907.8, bsz=1024, num_updates=7140, lr=4.34783e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=45396
2024-11-07 02:18:49 - progress_bar.py[line:274] - INFO: epoch 019:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17342.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3337.6, ups=0.19, wpb=17342.1, bsz=1024, num_updates=7150, lr=4.34647e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=45448
2024-11-07 02:19:41 - progress_bar.py[line:274] - INFO: epoch 019:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17863, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3469, ups=0.19, wpb=17863, bsz=1024, num_updates=7160, lr=4.34511e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=45500
2024-11-07 02:20:33 - progress_bar.py[line:274] - INFO: epoch 019:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17514.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3354.3, ups=0.19, wpb=17514.4, bsz=1024, num_updates=7170, lr=4.34374e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=45552
2024-11-07 02:21:25 - progress_bar.py[line:274] - INFO: epoch 019:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17813.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3452.9, ups=0.19, wpb=17813.2, bsz=1024, num_updates=7180, lr=4.34238e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.6, wall=45604
2024-11-07 02:22:17 - progress_bar.py[line:274] - INFO: epoch 019:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17706.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3400.7, ups=0.19, wpb=17706.6, bsz=1024, num_updates=7190, lr=4.34102e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=45656
2024-11-07 02:23:10 - progress_bar.py[line:274] - INFO: epoch 019:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=18027.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3418.3, ups=0.19, wpb=18027.7, bsz=1024, num_updates=7200, lr=4.33966e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=45708
2024-11-07 02:24:02 - progress_bar.py[line:274] - INFO: epoch 019:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.498, ntokens=17610.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3339.2, ups=0.19, wpb=17610.1, bsz=1024, num_updates=7210, lr=4.3383e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=45761
2024-11-07 02:24:55 - progress_bar.py[line:274] - INFO: epoch 019:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17586.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3355.5, ups=0.19, wpb=17586.1, bsz=1024, num_updates=7220, lr=4.33694e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=45814
2024-11-07 02:25:48 - progress_bar.py[line:274] - INFO: epoch 019:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=18088.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3382.1, ups=0.19, wpb=18088.7, bsz=1024, num_updates=7230, lr=4.33558e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=45867
2024-11-07 02:26:41 - progress_bar.py[line:274] - INFO: epoch 019:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=18086.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3391.3, ups=0.19, wpb=18086.4, bsz=1024, num_updates=7240, lr=4.33422e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=47, gb_free=13.5, wall=45920
2024-11-07 02:27:35 - progress_bar.py[line:274] - INFO: epoch 019:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17929.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3371.4, ups=0.19, wpb=17929.7, bsz=1024, num_updates=7250, lr=4.33286e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=45974
2024-11-07 02:28:28 - progress_bar.py[line:274] - INFO: epoch 019:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17805.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3341.5, ups=0.19, wpb=17805.8, bsz=1024, num_updates=7260, lr=4.3315e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=46027
2024-11-07 02:29:20 - progress_bar.py[line:274] - INFO: epoch 019:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17691.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3373.8, ups=0.19, wpb=17691.3, bsz=1024, num_updates=7270, lr=4.33014e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=46079
2024-11-07 02:30:13 - progress_bar.py[line:274] - INFO: epoch 019:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17732, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3357.7, ups=0.19, wpb=17732, bsz=1024, num_updates=7280, lr=4.32878e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=46132
2024-11-07 02:31:06 - progress_bar.py[line:274] - INFO: epoch 019:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17446.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3296.4, ups=0.19, wpb=17446.4, bsz=1024, num_updates=7290, lr=4.32742e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=46185
2024-11-07 02:31:58 - progress_bar.py[line:274] - INFO: epoch 019:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17797.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3435.8, ups=0.19, wpb=17797.7, bsz=1024, num_updates=7300, lr=4.32606e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=43, gb_free=13.5, wall=46237
2024-11-07 02:32:50 - progress_bar.py[line:274] - INFO: epoch 019:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17889.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3459.5, ups=0.19, wpb=17889.1, bsz=1024, num_updates=7310, lr=4.3247e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=46289
2024-11-07 02:33:42 - progress_bar.py[line:274] - INFO: epoch 019:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17466.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3328.1, ups=0.19, wpb=17466.2, bsz=1024, num_updates=7320, lr=4.32334e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=46341
2024-11-07 02:34:34 - progress_bar.py[line:274] - INFO: epoch 019:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17861.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3435.4, ups=0.19, wpb=17861.7, bsz=1024, num_updates=7330, lr=4.32198e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=46393
2024-11-07 02:35:26 - progress_bar.py[line:274] - INFO: epoch 019:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=18372.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3565.3, ups=0.19, wpb=18372.3, bsz=1024, num_updates=7340, lr=4.32062e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=46445
2024-11-07 02:36:18 - progress_bar.py[line:274] - INFO: epoch 019:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=18596.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3585.6, ups=0.19, wpb=18596.5, bsz=1024, num_updates=7350, lr=4.31926e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=46496
2024-11-07 02:37:10 - progress_bar.py[line:274] - INFO: epoch 019:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18042.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3470.1, ups=0.19, wpb=18042.2, bsz=1024, num_updates=7360, lr=4.3179e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=36, gb_free=13.4, wall=46548
2024-11-07 02:38:01 - progress_bar.py[line:274] - INFO: epoch 019:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=18295.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3560, ups=0.19, wpb=18295.6, bsz=1024, num_updates=7370, lr=4.31654e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=40, gb_free=13.3, wall=46600
2024-11-07 02:38:53 - progress_bar.py[line:274] - INFO: epoch 019:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18163.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3505.3, ups=0.19, wpb=18163.3, bsz=1024, num_updates=7380, lr=4.31518e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=38, gb_free=13.3, wall=46652
2024-11-07 02:39:45 - progress_bar.py[line:274] - INFO: epoch 019:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18614.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3571.7, ups=0.19, wpb=18614.8, bsz=1024, num_updates=7390, lr=4.31382e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=46704
2024-11-07 02:40:37 - progress_bar.py[line:274] - INFO: epoch 019:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17982.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3434.7, ups=0.19, wpb=17982.7, bsz=1024, num_updates=7400, lr=4.31246e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.3, wall=46756
2024-11-07 02:41:30 - progress_bar.py[line:274] - INFO: epoch 019:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18113.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3448.6, ups=0.19, wpb=18113.1, bsz=1024, num_updates=7410, lr=4.3111e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=44, gb_free=13.4, wall=46809
2024-11-07 02:42:22 - progress_bar.py[line:274] - INFO: epoch 019:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17905.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3443.6, ups=0.19, wpb=17905.6, bsz=1024, num_updates=7420, lr=4.30973e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=46861
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt2024-11-07 02:42:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 7426 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-07 02:42:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 02:44:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000slice_id 6 seek offset 300000

slice_id 7 seek offset 350000
2024-11-07 02:46:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 19 @ 7426 updates, score 0) (writing took 220.57849960200838 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 02:47:24 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-07 02:47:24 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.543 | ntokens 17834.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.83 | wps 2791.9 | ups 0.16 | wpb 17834.4 | bsz 1023 | num_updates 7426 | lr 4.30892e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1541 | gb_free 13.3 | wall 47163
2024-11-07 02:47:24 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 02:50:04 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-07 02:50:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 02:50:27 - progress_bar.py[line:274] - INFO: epoch 020:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17192.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=354.3, ups=0.02, wpb=17192.9, bsz=985.6, num_updates=7430, lr=4.30837e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=47346
2024-11-07 02:51:20 - progress_bar.py[line:274] - INFO: epoch 020:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17757.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3359.4, ups=0.19, wpb=17757.2, bsz=1024, num_updates=7440, lr=4.30701e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47399
2024-11-07 02:52:12 - progress_bar.py[line:274] - INFO: epoch 020:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17396.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3339.3, ups=0.19, wpb=17396.6, bsz=1024, num_updates=7450, lr=4.30565e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47451
2024-11-07 02:53:05 - progress_bar.py[line:274] - INFO: epoch 020:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17766.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3372.4, ups=0.19, wpb=17766.5, bsz=1024, num_updates=7460, lr=4.30429e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47504
2024-11-07 02:53:57 - progress_bar.py[line:274] - INFO: epoch 020:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17741, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3363, ups=0.19, wpb=17741, bsz=1024, num_updates=7470, lr=4.30293e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=47556
2024-11-07 02:54:50 - progress_bar.py[line:274] - INFO: epoch 020:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17645.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3330.8, ups=0.19, wpb=17645.5, bsz=1024, num_updates=7480, lr=4.30157e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=47609
2024-11-07 02:55:43 - progress_bar.py[line:274] - INFO: epoch 020:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17994.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3421.2, ups=0.19, wpb=17994.5, bsz=1024, num_updates=7490, lr=4.30021e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47662
2024-11-07 02:56:35 - progress_bar.py[line:274] - INFO: epoch 020:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17682.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3374.9, ups=0.19, wpb=17682.7, bsz=1024, num_updates=7500, lr=4.29885e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47714
2024-11-07 02:57:28 - progress_bar.py[line:274] - INFO: epoch 020:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17556.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3353.8, ups=0.19, wpb=17556.8, bsz=1024, num_updates=7510, lr=4.29749e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47767
2024-11-07 02:58:20 - progress_bar.py[line:274] - INFO: epoch 020:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17654.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3350.3, ups=0.19, wpb=17654.1, bsz=1024, num_updates=7520, lr=4.29613e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47819
2024-11-07 02:59:13 - progress_bar.py[line:274] - INFO: epoch 020:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.505, ntokens=17676.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3357.8, ups=0.19, wpb=17676.8, bsz=1024, num_updates=7530, lr=4.29477e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47872
2024-11-07 03:00:06 - progress_bar.py[line:274] - INFO: epoch 020:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17431.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3295, ups=0.19, wpb=17431.4, bsz=1024, num_updates=7540, lr=4.29341e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47925
2024-11-07 03:00:33 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 03:01:05 - progress_bar.py[line:274] - INFO: epoch 020:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17729.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3022.1, ups=0.17, wpb=17729.2, bsz=1024, num_updates=7550, lr=4.29205e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=47983
2024-11-07 03:01:56 - progress_bar.py[line:274] - INFO: epoch 020:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3328.2, ups=0.19, wpb=17258.7, bsz=1024, num_updates=7560, lr=4.29069e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48035
2024-11-07 03:02:49 - progress_bar.py[line:274] - INFO: epoch 020:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17628.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3338.3, ups=0.19, wpb=17628.9, bsz=1024, num_updates=7570, lr=4.28933e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48088
2024-11-07 03:03:42 - progress_bar.py[line:274] - INFO: epoch 020:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17754.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3353, ups=0.19, wpb=17754.2, bsz=1024, num_updates=7580, lr=4.28797e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48141
2024-11-07 03:04:35 - progress_bar.py[line:274] - INFO: epoch 020:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17845.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3365.1, ups=0.19, wpb=17845.6, bsz=1024, num_updates=7590, lr=4.28661e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48194
2024-11-07 03:05:27 - progress_bar.py[line:274] - INFO: epoch 020:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17604.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3378.6, ups=0.19, wpb=17604.2, bsz=1024, num_updates=7600, lr=4.28525e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48246
2024-11-07 03:06:20 - progress_bar.py[line:274] - INFO: epoch 020:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17799.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3413, ups=0.19, wpb=17799.8, bsz=1024, num_updates=7610, lr=4.28389e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48298
2024-11-07 03:07:12 - progress_bar.py[line:274] - INFO: epoch 020:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3358.3, ups=0.19, wpb=17513.9, bsz=1024, num_updates=7620, lr=4.28253e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48351
2024-11-07 03:08:05 - progress_bar.py[line:274] - INFO: epoch 020:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17929.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3392.4, ups=0.19, wpb=17929.4, bsz=1024, num_updates=7630, lr=4.28117e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48403
2024-11-07 03:08:57 - progress_bar.py[line:274] - INFO: epoch 020:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17787.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3385.8, ups=0.19, wpb=17787.4, bsz=1024, num_updates=7640, lr=4.27981e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=48456
2024-11-07 03:09:50 - progress_bar.py[line:274] - INFO: epoch 020:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17715.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3360.5, ups=0.19, wpb=17715.5, bsz=1024, num_updates=7650, lr=4.27845e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48509
2024-11-07 03:10:42 - progress_bar.py[line:274] - INFO: epoch 020:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=17534.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3351, ups=0.19, wpb=17534.3, bsz=1024, num_updates=7660, lr=4.27709e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48561
2024-11-07 03:11:35 - progress_bar.py[line:274] - INFO: epoch 020:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17514.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3317.5, ups=0.19, wpb=17514.9, bsz=1024, num_updates=7670, lr=4.27573e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=48614
2024-11-07 03:12:28 - progress_bar.py[line:274] - INFO: epoch 020:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17731, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3339.4, ups=0.19, wpb=17731, bsz=1024, num_updates=7680, lr=4.27436e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48667
2024-11-07 03:13:20 - progress_bar.py[line:274] - INFO: epoch 020:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17856.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3412.6, ups=0.19, wpb=17856.2, bsz=1024, num_updates=7690, lr=4.273e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48719
2024-11-07 03:14:13 - progress_bar.py[line:274] - INFO: epoch 020:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=17547.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3319.1, ups=0.19, wpb=17547.8, bsz=1024, num_updates=7700, lr=4.27164e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48772
2024-11-07 03:15:06 - progress_bar.py[line:274] - INFO: epoch 020:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17758.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3379, ups=0.19, wpb=17758.7, bsz=1024, num_updates=7710, lr=4.27028e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48825
2024-11-07 03:15:58 - progress_bar.py[line:274] - INFO: epoch 020:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17727.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3418.8, ups=0.19, wpb=17727.3, bsz=1024, num_updates=7720, lr=4.26892e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48876
2024-11-07 03:16:51 - progress_bar.py[line:274] - INFO: epoch 020:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18039.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3387.8, ups=0.19, wpb=18039.3, bsz=1024, num_updates=7730, lr=4.26756e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=41, gb_free=13.4, wall=48930
2024-11-07 03:17:45 - progress_bar.py[line:274] - INFO: epoch 020:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18462.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3437.2, ups=0.19, wpb=18462.5, bsz=1024, num_updates=7740, lr=4.2662e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=48983
2024-11-07 03:18:38 - progress_bar.py[line:274] - INFO: epoch 020:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=18349, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3450, ups=0.19, wpb=18349, bsz=1024, num_updates=7750, lr=4.26484e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=49037
2024-11-07 03:19:30 - progress_bar.py[line:274] - INFO: epoch 020:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=18494.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3517, ups=0.19, wpb=18494.7, bsz=1024, num_updates=7760, lr=4.26348e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=49089
2024-11-07 03:20:23 - progress_bar.py[line:274] - INFO: epoch 020:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=18378.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3507.7, ups=0.19, wpb=18378.6, bsz=1024, num_updates=7770, lr=4.26212e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=49142
2024-11-07 03:21:14 - progress_bar.py[line:274] - INFO: epoch 020:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=18349, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3557.9, ups=0.19, wpb=18349, bsz=1024, num_updates=7780, lr=4.26076e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=49193
2024-11-07 03:22:07 - progress_bar.py[line:274] - INFO: epoch 020:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=18115.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3455.7, ups=0.19, wpb=18115.1, bsz=1024, num_updates=7790, lr=4.2594e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=49246
2024-11-07 03:22:59 - progress_bar.py[line:274] - INFO: epoch 020:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3381.8, ups=0.19, wpb=17835.7, bsz=1024, num_updates=7800, lr=4.25804e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=49298
2024-11-07 03:23:51 - progress_bar.py[line:274] - INFO: epoch 020:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18203.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3498.5, ups=0.19, wpb=18203.4, bsz=1024, num_updates=7810, lr=4.25668e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=49350
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

2024-11-07 03:24:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 7816 updates


2024-11-07 03:24:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 03:26:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 03:28:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 20 @ 7816 updates, score 0) (writing took 220.5842493160162 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 03:28:54 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-07 03:28:54 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.53 | ntokens 17797.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.78 | wps 2787.5 | ups 0.16 | wpb 17797.1 | bsz 1023 | num_updates 7816 | lr 4.25586e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1384 | gb_free 13.3 | wall 49653
2024-11-07 03:28:54 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 03:31:33 - trainer.py[line:703] - INFO: begin training epoch 21
2024-11-07 03:31:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 03:31:56 - progress_bar.py[line:274] - INFO: epoch 021:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17231.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=355.5, ups=0.02, wpb=17231.8, bsz=985.6, num_updates=7820, lr=4.25532e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=49835
2024-11-07 03:32:49 - progress_bar.py[line:274] - INFO: epoch 021:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17722.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3372, ups=0.19, wpb=17722.3, bsz=1024, num_updates=7830, lr=4.25396e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=49888
2024-11-07 03:33:42 - progress_bar.py[line:274] - INFO: epoch 021:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17796.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3349.4, ups=0.19, wpb=17796.3, bsz=1024, num_updates=7840, lr=4.2526e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=49941
2024-11-07 03:34:38 - progress_bar.py[line:274] - INFO: epoch 021:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=18193.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3257.7, ups=0.18, wpb=18193.1, bsz=1024, num_updates=7850, lr=4.25124e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=49997
2024-11-07 03:35:33 - progress_bar.py[line:274] - INFO: epoch 021:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17621.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3165, ups=0.18, wpb=17621.8, bsz=1024, num_updates=7860, lr=4.24988e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=50052
2024-11-07 03:36:29 - progress_bar.py[line:274] - INFO: epoch 021:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.487, ntokens=17431.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3132.1, ups=0.18, wpb=17431.5, bsz=1024, num_updates=7870, lr=4.24852e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=50108
2024-11-07 03:37:24 - progress_bar.py[line:274] - INFO: epoch 021:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=18104.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3280.7, ups=0.18, wpb=18104.3, bsz=1024, num_updates=7880, lr=4.24716e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=50163
2024-11-07 03:38:20 - progress_bar.py[line:274] - INFO: epoch 021:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17667.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3182.6, ups=0.18, wpb=17667.7, bsz=1024, num_updates=7890, lr=4.2458e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=50219
2024-11-07 03:39:15 - progress_bar.py[line:274] - INFO: epoch 021:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17587.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3201.4, ups=0.18, wpb=17587.7, bsz=1024, num_updates=7900, lr=4.24444e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=50274
2024-11-07 03:40:07 - progress_bar.py[line:274] - INFO: epoch 021:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17788.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3406.4, ups=0.19, wpb=17788.8, bsz=1024, num_updates=7910, lr=4.24308e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=50326
2024-11-07 03:40:59 - progress_bar.py[line:274] - INFO: epoch 021:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17705.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3403.5, ups=0.19, wpb=17705.7, bsz=1024, num_updates=7920, lr=4.24172e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=50378
2024-11-07 03:41:51 - progress_bar.py[line:274] - INFO: epoch 021:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17748.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3431.4, ups=0.19, wpb=17748.9, bsz=1024, num_updates=7930, lr=4.24035e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=50430
2024-11-07 03:42:43 - progress_bar.py[line:274] - INFO: epoch 021:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17675.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3396.2, ups=0.19, wpb=17675.6, bsz=1024, num_updates=7940, lr=4.23899e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=50482
2024-11-07 03:43:35 - progress_bar.py[line:274] - INFO: epoch 021:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=17377.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3333.6, ups=0.19, wpb=17377.8, bsz=1024, num_updates=7950, lr=4.23763e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=50534
2024-11-07 03:44:27 - progress_bar.py[line:274] - INFO: epoch 021:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17478.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3358.5, ups=0.19, wpb=17478.3, bsz=1024, num_updates=7960, lr=4.23627e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=50586
2024-11-07 03:45:19 - progress_bar.py[line:274] - INFO: epoch 021:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17516.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3386, ups=0.19, wpb=17516.1, bsz=1024, num_updates=7970, lr=4.23491e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.3, wall=50637
2024-11-07 03:46:11 - progress_bar.py[line:274] - INFO: epoch 021:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=18064.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3436.3, ups=0.19, wpb=18064.3, bsz=1024, num_updates=7980, lr=4.23355e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=50690
2024-11-07 03:47:03 - progress_bar.py[line:274] - INFO: epoch 021:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17810.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3405.6, ups=0.19, wpb=17810.5, bsz=1024, num_updates=7990, lr=4.23219e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=50742
2024-11-07 03:47:56 - progress_bar.py[line:274] - INFO: epoch 021:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.507, ntokens=17513.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3357.9, ups=0.19, wpb=17513.2, bsz=1024, num_updates=8000, lr=4.23083e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50795
2024-11-07 03:48:48 - progress_bar.py[line:274] - INFO: epoch 021:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17642.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3356.3, ups=0.19, wpb=17642.6, bsz=1024, num_updates=8010, lr=4.22947e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50847
2024-11-07 03:49:41 - progress_bar.py[line:274] - INFO: epoch 021:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17899, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3420.6, ups=0.19, wpb=17899, bsz=1024, num_updates=8020, lr=4.22811e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=50899
2024-11-07 03:50:33 - progress_bar.py[line:274] - INFO: epoch 021:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17795.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3411.4, ups=0.19, wpb=17795.4, bsz=1024, num_updates=8030, lr=4.22675e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=50952
2024-11-07 03:51:25 - progress_bar.py[line:274] - INFO: epoch 021:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17831.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3391.9, ups=0.19, wpb=17831.6, bsz=1024, num_updates=8040, lr=4.22539e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=51004
2024-11-07 03:52:18 - progress_bar.py[line:274] - INFO: epoch 021:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17935.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3428.2, ups=0.19, wpb=17935.1, bsz=1024, num_updates=8050, lr=4.22403e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=51056
2024-11-07 03:53:10 - progress_bar.py[line:274] - INFO: epoch 021:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17758.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3361.7, ups=0.19, wpb=17758.6, bsz=1024, num_updates=8060, lr=4.22267e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=51109
2024-11-07 03:53:58 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 03:54:08 - progress_bar.py[line:274] - INFO: epoch 021:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17733.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3055.6, ups=0.17, wpb=17733.8, bsz=1024, num_updates=8070, lr=4.22131e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=33, gb_free=13.3, wall=51167
2024-11-07 03:55:02 - progress_bar.py[line:274] - INFO: epoch 021:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=18087.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3402.8, ups=0.19, wpb=18087.9, bsz=1024, num_updates=8080, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=51220
2024-11-07 03:55:57 - progress_bar.py[line:274] - INFO: epoch 021:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17919, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3258.4, ups=0.18, wpb=17919, bsz=1024, num_updates=8090, lr=4.21859e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=51275
2024-11-07 03:56:52 - progress_bar.py[line:274] - INFO: epoch 021:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17539.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3190.4, ups=0.18, wpb=17539.5, bsz=1024, num_updates=8100, lr=4.21723e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=51330
2024-11-07 03:57:44 - progress_bar.py[line:274] - INFO: epoch 021:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17770.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3408.5, ups=0.19, wpb=17770.4, bsz=1024, num_updates=8110, lr=4.21587e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=51383
2024-11-07 03:58:36 - progress_bar.py[line:274] - INFO: epoch 021:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=18401.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3502.4, ups=0.19, wpb=18401.5, bsz=1024, num_updates=8120, lr=4.21451e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51435
2024-11-07 03:59:29 - progress_bar.py[line:274] - INFO: epoch 021:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=18292.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3466.9, ups=0.19, wpb=18292.9, bsz=1024, num_updates=8130, lr=4.21315e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=51488
2024-11-07 04:00:21 - progress_bar.py[line:274] - INFO: epoch 021:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17986.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3445.7, ups=0.19, wpb=17986.6, bsz=1024, num_updates=8140, lr=4.21179e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51540
2024-11-07 04:01:14 - progress_bar.py[line:274] - INFO: epoch 021:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18082.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3441.3, ups=0.19, wpb=18082.3, bsz=1024, num_updates=8150, lr=4.21043e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51593
2024-11-07 04:02:06 - progress_bar.py[line:274] - INFO: epoch 021:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=18036.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3459, ups=0.19, wpb=18036.5, bsz=1024, num_updates=8160, lr=4.20907e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=51645
2024-11-07 04:02:58 - progress_bar.py[line:274] - INFO: epoch 021:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18647.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3569.4, ups=0.19, wpb=18647.4, bsz=1024, num_updates=8170, lr=4.20771e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51697
2024-11-07 04:03:50 - progress_bar.py[line:274] - INFO: epoch 021:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18084.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3469.2, ups=0.19, wpb=18084.3, bsz=1024, num_updates=8180, lr=4.20634e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51749
2024-11-07 04:04:42 - progress_bar.py[line:274] - INFO: epoch 021:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=18269.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3516.1, ups=0.19, wpb=18269.1, bsz=1024, num_updates=8190, lr=4.20498e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51801
2024-11-07 04:05:35 - progress_bar.py[line:274] - INFO: epoch 021:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18061.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3398.9, ups=0.19, wpb=18061.3, bsz=1024, num_updates=8200, lr=4.20362e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=51854
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt


2024-11-07 04:06:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 21 @ 8206 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
2024-11-07 04:06:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 04:07:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 04:09:46 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 21 @ 8206 updates, score 0) (writing took 222.484497611993 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-07 04:10:40 - train.py[line:336] - INFO: end of epoch 21 (average epoch stats below)
2024-11-07 04:10:40 - progress_bar.py[line:282] - INFO: epoch 021 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.544 | ntokens 17834.7 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.83 | wps 2776.2 | ups 0.16 | wpb 17834.7 | bsz 1023 | num_updates 8206 | lr 4.20281e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1728 | gb_free 13.3 | wall 52159
2024-11-07 04:10:40 - trainer.py[line:639] - INFO: loading train data for epoch 22
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 04:13:19 - trainer.py[line:703] - INFO: begin training epoch 22
2024-11-07 04:13:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 04:13:42 - progress_bar.py[line:274] - INFO: epoch 022:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=16992.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=349.1, ups=0.02, wpb=16992.6, bsz=985.6, num_updates=8210, lr=4.20226e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=52341
2024-11-07 04:14:34 - progress_bar.py[line:274] - INFO: epoch 022:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17556, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3388.5, ups=0.19, wpb=17556, bsz=1024, num_updates=8220, lr=4.2009e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=52393
2024-11-07 04:15:26 - progress_bar.py[line:274] - INFO: epoch 022:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17691.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3389.7, ups=0.19, wpb=17691.6, bsz=1024, num_updates=8230, lr=4.19954e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=52445
2024-11-07 04:16:18 - progress_bar.py[line:274] - INFO: epoch 022:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=18134, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3499.2, ups=0.19, wpb=18134, bsz=1024, num_updates=8240, lr=4.19818e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=52497
2024-11-07 04:17:11 - progress_bar.py[line:274] - INFO: epoch 022:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3298.3, ups=0.19, wpb=17393.3, bsz=1024, num_updates=8250, lr=4.19682e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=52550
2024-11-07 04:17:47 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 04:18:08 - progress_bar.py[line:274] - INFO: epoch 022:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17768.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3090.5, ups=0.17, wpb=17768.8, bsz=1024, num_updates=8260, lr=4.19546e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=52607
2024-11-07 04:19:00 - progress_bar.py[line:274] - INFO: epoch 022:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17524.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3401.7, ups=0.19, wpb=17524.3, bsz=1024, num_updates=8270, lr=4.1941e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=52659
2024-11-07 04:19:52 - progress_bar.py[line:274] - INFO: epoch 022:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17798.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3389.6, ups=0.19, wpb=17798.3, bsz=1024, num_updates=8280, lr=4.19274e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=52711
2024-11-07 04:20:45 - progress_bar.py[line:274] - INFO: epoch 022:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17672.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3353.1, ups=0.19, wpb=17672.6, bsz=1024, num_updates=8290, lr=4.19138e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=52764
2024-11-07 04:21:38 - progress_bar.py[line:274] - INFO: epoch 022:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17805, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3366.3, ups=0.19, wpb=17805, bsz=1024, num_updates=8300, lr=4.19002e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=52817
2024-11-07 04:22:30 - progress_bar.py[line:274] - INFO: epoch 022:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17598.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3381.8, ups=0.19, wpb=17598.8, bsz=1024, num_updates=8310, lr=4.18866e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=52869
2024-11-07 04:23:22 - progress_bar.py[line:274] - INFO: epoch 022:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=17426.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3305.8, ups=0.19, wpb=17426.2, bsz=1024, num_updates=8320, lr=4.1873e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=52921
2024-11-07 04:24:17 - progress_bar.py[line:274] - INFO: epoch 022:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.501, ntokens=17847.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3252.9, ups=0.18, wpb=17847.9, bsz=1024, num_updates=8330, lr=4.18594e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=37, gb_free=13.5, wall=52976
2024-11-07 04:25:13 - progress_bar.py[line:274] - INFO: epoch 022:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=17650.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3180.7, ups=0.18, wpb=17650.2, bsz=1024, num_updates=8340, lr=4.18458e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=53032
2024-11-07 04:26:09 - progress_bar.py[line:274] - INFO: epoch 022:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=18026, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3228.7, ups=0.18, wpb=18026, bsz=1024, num_updates=8350, lr=4.18322e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=53088
2024-11-07 04:27:04 - progress_bar.py[line:274] - INFO: epoch 022:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17386.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3165.2, ups=0.18, wpb=17386.6, bsz=1024, num_updates=8360, lr=4.18186e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=53143
2024-11-07 04:28:00 - progress_bar.py[line:274] - INFO: epoch 022:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17676.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3157.9, ups=0.18, wpb=17676.5, bsz=1024, num_updates=8370, lr=4.1805e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.6, wall=53198
2024-11-07 04:28:55 - progress_bar.py[line:274] - INFO: epoch 022:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17877.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3212.7, ups=0.18, wpb=17877.9, bsz=1024, num_updates=8380, lr=4.17914e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=53254
2024-11-07 04:29:51 - progress_bar.py[line:274] - INFO: epoch 022:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17543.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3150.2, ups=0.18, wpb=17543.7, bsz=1024, num_updates=8390, lr=4.17778e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=44, gb_free=13.6, wall=53310
2024-11-07 04:30:47 - progress_bar.py[line:274] - INFO: epoch 022:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3074.8, ups=0.18, wpb=17333.1, bsz=1024, num_updates=8400, lr=4.17642e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.6, wall=53366
2024-11-07 04:31:43 - progress_bar.py[line:274] - INFO: epoch 022:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=18074.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3266.7, ups=0.18, wpb=18074.9, bsz=1024, num_updates=8410, lr=4.17506e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=42, gb_free=13.5, wall=53422
2024-11-07 04:32:45 - progress_bar.py[line:274] - INFO: epoch 022:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17863.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=2845.1, ups=0.16, wpb=17863.2, bsz=1024, num_updates=8420, lr=4.1737e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.6, wall=53484
2024-11-07 04:33:52 - progress_bar.py[line:274] - INFO: epoch 022:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17708.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=2676.7, ups=0.15, wpb=17708.1, bsz=1024, num_updates=8430, lr=4.17233e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=66, gb_free=13.5, wall=53550
2024-11-07 04:34:58 - progress_bar.py[line:274] - INFO: epoch 022:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=2697.8, ups=0.15, wpb=17835.7, bsz=1024, num_updates=8440, lr=4.17097e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=66, gb_free=13.4, wall=53617
2024-11-07 04:36:04 - progress_bar.py[line:274] - INFO: epoch 022:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17332.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=2613.6, ups=0.15, wpb=17332.5, bsz=1024, num_updates=8450, lr=4.16961e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=66, gb_free=13.6, wall=53683
2024-11-07 04:36:55 - progress_bar.py[line:274] - INFO: epoch 022:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17796.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3469.6, ups=0.19, wpb=17796.6, bsz=1024, num_updates=8460, lr=4.16825e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=53734
2024-11-07 04:37:48 - progress_bar.py[line:274] - INFO: epoch 022:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17883.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3403.8, ups=0.19, wpb=17883.6, bsz=1024, num_updates=8470, lr=4.16689e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=53787
2024-11-07 04:38:41 - progress_bar.py[line:274] - INFO: epoch 022:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17876.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3359.8, ups=0.19, wpb=17876.5, bsz=1024, num_updates=8480, lr=4.16553e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53840
2024-11-07 04:39:34 - progress_bar.py[line:274] - INFO: epoch 022:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17737.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3355.6, ups=0.19, wpb=17737.5, bsz=1024, num_updates=8490, lr=4.16417e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53893
2024-11-07 04:40:26 - progress_bar.py[line:274] - INFO: epoch 022:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17731.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3405.2, ups=0.19, wpb=17731.4, bsz=1024, num_updates=8500, lr=4.16281e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=53945
2024-11-07 04:41:22 - progress_bar.py[line:274] - INFO: epoch 022:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18356.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3287, ups=0.18, wpb=18356.2, bsz=1024, num_updates=8510, lr=4.16145e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=54001
2024-11-07 04:42:15 - progress_bar.py[line:274] - INFO: epoch 022:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=18555.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3490.7, ups=0.19, wpb=18555.4, bsz=1024, num_updates=8520, lr=4.16009e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54054
2024-11-07 04:43:08 - progress_bar.py[line:274] - INFO: epoch 022:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=18175.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3445.2, ups=0.19, wpb=18175.4, bsz=1024, num_updates=8530, lr=4.15873e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54107
2024-11-07 04:44:01 - progress_bar.py[line:274] - INFO: epoch 022:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17985.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3374.3, ups=0.19, wpb=17985.8, bsz=1024, num_updates=8540, lr=4.15737e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=54160
2024-11-07 04:44:54 - progress_bar.py[line:274] - INFO: epoch 022:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=18040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3383.9, ups=0.19, wpb=18040.3, bsz=1024, num_updates=8550, lr=4.15601e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54213
2024-11-07 04:45:47 - progress_bar.py[line:274] - INFO: epoch 022:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=18614.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3519.1, ups=0.19, wpb=18614.7, bsz=1024, num_updates=8560, lr=4.15465e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54266
2024-11-07 04:46:41 - progress_bar.py[line:274] - INFO: epoch 022:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=18154, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3402.2, ups=0.19, wpb=18154, bsz=1024, num_updates=8570, lr=4.15329e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=54320
2024-11-07 04:47:34 - progress_bar.py[line:274] - INFO: epoch 022:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=18234.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3436.1, ups=0.19, wpb=18234.4, bsz=1024, num_updates=8580, lr=4.15193e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=54373
2024-11-07 04:48:27 - progress_bar.py[line:274] - INFO: epoch 022:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18153.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3434.1, ups=0.19, wpb=18153.1, bsz=1024, num_updates=8590, lr=4.15057e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=54425
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 04:48:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 22 @ 8596 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
2024-11-07 04:48:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 04:50:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 04:52:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 22 @ 8596 updates, score 0) (writing took 223.02192327100784 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 04:53:32 - train.py[line:336] - INFO: end of epoch 22 (average epoch stats below)
2024-11-07 04:53:32 - progress_bar.py[line:282] - INFO: epoch 022 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.523 | ntokens 17823.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.75 | wps 2702.5 | ups 0.15 | wpb 17823.5 | bsz 1023 | num_updates 8596 | lr 4.14975e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1653 | gb_free 13.4 | wall 54731
2024-11-07 04:53:32 - trainer.py[line:639] - INFO: loading train data for epoch 23
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 04:56:15 - trainer.py[line:703] - INFO: begin training epoch 23
2024-11-07 04:56:15 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 04:56:39 - progress_bar.py[line:274] - INFO: epoch 023:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=17311.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=351.8, ups=0.02, wpb=17311.7, bsz=985.6, num_updates=8600, lr=4.14921e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=54918
2024-11-07 04:57:31 - progress_bar.py[line:274] - INFO: epoch 023:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17606.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3344.3, ups=0.19, wpb=17606.5, bsz=1024, num_updates=8610, lr=4.14785e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=54970
2024-11-07 04:58:23 - progress_bar.py[line:274] - INFO: epoch 023:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17645.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.3, ups=0.19, wpb=17645.9, bsz=1024, num_updates=8620, lr=4.14649e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=55022
2024-11-07 04:59:17 - progress_bar.py[line:274] - INFO: epoch 023:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17783.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3294.8, ups=0.19, wpb=17783.2, bsz=1024, num_updates=8630, lr=4.14513e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=39, gb_free=13.4, wall=55076
2024-11-07 05:00:12 - progress_bar.py[line:274] - INFO: epoch 023:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=17734.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3255.6, ups=0.18, wpb=17734.8, bsz=1024, num_updates=8640, lr=4.14377e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=55131
2024-11-07 05:01:06 - progress_bar.py[line:274] - INFO: epoch 023:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3261.2, ups=0.18, wpb=17833.4, bsz=1024, num_updates=8650, lr=4.14241e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=55185
2024-11-07 05:02:01 - progress_bar.py[line:274] - INFO: epoch 023:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17736, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3223.6, ups=0.18, wpb=17736, bsz=1024, num_updates=8660, lr=4.14105e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=55240
2024-11-07 05:02:56 - progress_bar.py[line:274] - INFO: epoch 023:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=17766.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3244, ups=0.18, wpb=17766.2, bsz=1024, num_updates=8670, lr=4.13969e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=55295
2024-11-07 05:03:49 - progress_bar.py[line:274] - INFO: epoch 023:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17804, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3383.1, ups=0.19, wpb=17804, bsz=1024, num_updates=8680, lr=4.13833e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=55348
2024-11-07 05:04:41 - progress_bar.py[line:274] - INFO: epoch 023:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17586.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.7, ups=0.19, wpb=17586.2, bsz=1024, num_updates=8690, lr=4.13696e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=55400
2024-11-07 05:05:35 - progress_bar.py[line:274] - INFO: epoch 023:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17701.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3271.3, ups=0.18, wpb=17701.1, bsz=1024, num_updates=8700, lr=4.1356e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55454
2024-11-07 05:06:29 - progress_bar.py[line:274] - INFO: epoch 023:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.505, ntokens=17579.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3247.4, ups=0.18, wpb=17579.7, bsz=1024, num_updates=8710, lr=4.13424e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=55508
2024-11-07 05:07:23 - progress_bar.py[line:274] - INFO: epoch 023:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17962.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3339.9, ups=0.19, wpb=17962.2, bsz=1024, num_updates=8720, lr=4.13288e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55562
2024-11-07 05:08:17 - progress_bar.py[line:274] - INFO: epoch 023:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17532.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3225.2, ups=0.18, wpb=17532.8, bsz=1024, num_updates=8730, lr=4.13152e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=55616
2024-11-07 05:09:11 - progress_bar.py[line:274] - INFO: epoch 023:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17612.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3283.5, ups=0.19, wpb=17612.1, bsz=1024, num_updates=8740, lr=4.13016e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55670
2024-11-07 05:10:04 - progress_bar.py[line:274] - INFO: epoch 023:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17721.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3309.8, ups=0.19, wpb=17721.7, bsz=1024, num_updates=8750, lr=4.1288e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=55723
2024-11-07 05:10:56 - progress_bar.py[line:274] - INFO: epoch 023:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3437.9, ups=0.19, wpb=17833.4, bsz=1024, num_updates=8760, lr=4.12744e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=55775
2024-11-07 05:11:48 - progress_bar.py[line:274] - INFO: epoch 023:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17770.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3433.9, ups=0.19, wpb=17770.4, bsz=1024, num_updates=8770, lr=4.12608e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=55827
2024-11-07 05:12:39 - progress_bar.py[line:274] - INFO: epoch 023:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17604.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3424.8, ups=0.19, wpb=17604.9, bsz=1024, num_updates=8780, lr=4.12472e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=55878
2024-11-07 05:13:32 - progress_bar.py[line:274] - INFO: epoch 023:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17626.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3343.6, ups=0.19, wpb=17626.3, bsz=1024, num_updates=8790, lr=4.12336e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=55931
2024-11-07 05:14:23 - progress_bar.py[line:274] - INFO: epoch 023:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17997.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3499.3, ups=0.19, wpb=17997.2, bsz=1024, num_updates=8800, lr=4.122e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.6, wall=55982
2024-11-07 05:15:15 - progress_bar.py[line:274] - INFO: epoch 023:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17825.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3438.2, ups=0.19, wpb=17825.3, bsz=1024, num_updates=8810, lr=4.12064e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=56034
2024-11-07 05:16:07 - progress_bar.py[line:274] - INFO: epoch 023:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17427.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3345.9, ups=0.19, wpb=17427.6, bsz=1024, num_updates=8820, lr=4.11928e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=56086
2024-11-07 05:16:59 - progress_bar.py[line:274] - INFO: epoch 023:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17942.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3489.3, ups=0.19, wpb=17942.7, bsz=1024, num_updates=8830, lr=4.11792e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=56138
2024-11-07 05:17:51 - progress_bar.py[line:274] - INFO: epoch 023:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=17166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3282.3, ups=0.19, wpb=17166.3, bsz=1024, num_updates=8840, lr=4.11656e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=56190
2024-11-07 05:18:12 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 05:18:49 - progress_bar.py[line:274] - INFO: epoch 023:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17789.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3059.2, ups=0.17, wpb=17789.9, bsz=1024, num_updates=8850, lr=4.1152e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.3, wall=56248
2024-11-07 05:19:43 - progress_bar.py[line:274] - INFO: epoch 023:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17787.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3332, ups=0.19, wpb=17787.6, bsz=1024, num_updates=8860, lr=4.11384e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=56302
2024-11-07 05:20:35 - progress_bar.py[line:274] - INFO: epoch 023:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17935.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3417.2, ups=0.19, wpb=17935.7, bsz=1024, num_updates=8870, lr=4.11248e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=47, gb_free=13.5, wall=56354
2024-11-07 05:21:28 - progress_bar.py[line:274] - INFO: epoch 023:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17516.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3323.4, ups=0.19, wpb=17516.7, bsz=1024, num_updates=8880, lr=4.11112e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=56407
2024-11-07 05:22:20 - progress_bar.py[line:274] - INFO: epoch 023:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17710.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3411.5, ups=0.19, wpb=17710.8, bsz=1024, num_updates=8890, lr=4.10976e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=56459
2024-11-07 05:23:12 - progress_bar.py[line:274] - INFO: epoch 023:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18292.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3525.1, ups=0.19, wpb=18292.8, bsz=1024, num_updates=8900, lr=4.1084e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=56511
2024-11-07 05:24:04 - progress_bar.py[line:274] - INFO: epoch 023:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=18495.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3513.3, ups=0.19, wpb=18495.3, bsz=1024, num_updates=8910, lr=4.10704e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56563
2024-11-07 05:24:56 - progress_bar.py[line:274] - INFO: epoch 023:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=18161.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3481.6, ups=0.19, wpb=18161.8, bsz=1024, num_updates=8920, lr=4.10568e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56615
2024-11-07 05:25:48 - progress_bar.py[line:274] - INFO: epoch 023:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18349.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3566, ups=0.19, wpb=18349.6, bsz=1024, num_updates=8930, lr=4.10432e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=56667
2024-11-07 05:26:40 - progress_bar.py[line:274] - INFO: epoch 023:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=18223.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3503.8, ups=0.19, wpb=18223.2, bsz=1024, num_updates=8940, lr=4.10295e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56719
2024-11-07 05:27:32 - progress_bar.py[line:274] - INFO: epoch 023:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=18800.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3575.1, ups=0.19, wpb=18800.1, bsz=1024, num_updates=8950, lr=4.10159e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=56771
2024-11-07 05:28:25 - progress_bar.py[line:274] - INFO: epoch 023:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3518.2, ups=0.19, wpb=18393.3, bsz=1024, num_updates=8960, lr=4.10023e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56824
2024-11-07 05:29:17 - progress_bar.py[line:274] - INFO: epoch 023:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17908.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3431.3, ups=0.19, wpb=17908.8, bsz=1024, num_updates=8970, lr=4.09887e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56876
2024-11-07 05:30:09 - progress_bar.py[line:274] - INFO: epoch 023:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18107.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3469.9, ups=0.19, wpb=18107.4, bsz=1024, num_updates=8980, lr=4.09751e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56928
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 05:30:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 23 @ 8986 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 05:30:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 05:32:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
2024-11-07 05:34:20 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 23 @ 8986 updates, score 0) (writing took 222.71613502601394 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 05:35:22 - train.py[line:336] - INFO: end of epoch 23 (average epoch stats below)
2024-11-07 05:35:22 - progress_bar.py[line:282] - INFO: epoch 023 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.511 | ntokens 17830.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.7 | wps 2770.9 | ups 0.16 | wpb 17830.2 | bsz 1023 | num_updates 8986 | lr 4.0967e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1874 | gb_free 13.3 | wall 57241
2024-11-07 05:35:22 - trainer.py[line:639] - INFO: loading train data for epoch 24
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 05:38:04 - trainer.py[line:703] - INFO: begin training epoch 24
2024-11-07 05:38:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 05:38:29 - progress_bar.py[line:274] - INFO: epoch 024:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17100.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=342.2, ups=0.02, wpb=17100.6, bsz=985.6, num_updates=8990, lr=4.09615e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=41, gb_free=13.6, wall=57428
2024-11-07 05:39:22 - progress_bar.py[line:274] - INFO: epoch 024:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17684.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3327, ups=0.19, wpb=17684.8, bsz=1024, num_updates=9000, lr=4.09479e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=57481
2024-11-07 05:40:16 - progress_bar.py[line:274] - INFO: epoch 024:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17837.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3322.6, ups=0.19, wpb=17837.6, bsz=1024, num_updates=9010, lr=4.09343e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=57535
2024-11-07 05:41:09 - progress_bar.py[line:274] - INFO: epoch 024:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17921.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3391.1, ups=0.19, wpb=17921.9, bsz=1024, num_updates=9020, lr=4.09207e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=57587
2024-11-07 05:42:03 - progress_bar.py[line:274] - INFO: epoch 024:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=17808.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3270.4, ups=0.18, wpb=17808.8, bsz=1024, num_updates=9030, lr=4.09071e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=37, gb_free=13.6, wall=57642
2024-11-07 05:43:00 - progress_bar.py[line:274] - INFO: epoch 024:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17455.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3082.3, ups=0.18, wpb=17455.2, bsz=1024, num_updates=9040, lr=4.08935e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=57699
2024-11-07 05:43:54 - progress_bar.py[line:274] - INFO: epoch 024:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17838.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3298.3, ups=0.18, wpb=17838.2, bsz=1024, num_updates=9050, lr=4.08799e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=57753
2024-11-07 05:44:49 - progress_bar.py[line:274] - INFO: epoch 024:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17871.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3213, ups=0.18, wpb=17871.4, bsz=1024, num_updates=9060, lr=4.08663e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=57808
2024-11-07 05:45:44 - progress_bar.py[line:274] - INFO: epoch 024:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17824.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3251.5, ups=0.18, wpb=17824.7, bsz=1024, num_updates=9070, lr=4.08527e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=57863
2024-11-07 05:46:39 - progress_bar.py[line:274] - INFO: epoch 024:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17649.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3223.9, ups=0.18, wpb=17649.2, bsz=1024, num_updates=9080, lr=4.08391e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=57918
2024-11-07 05:47:32 - progress_bar.py[line:274] - INFO: epoch 024:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17786.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3348.7, ups=0.19, wpb=17786.2, bsz=1024, num_updates=9090, lr=4.08255e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=57971
2024-11-07 05:48:24 - progress_bar.py[line:274] - INFO: epoch 024:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17381.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3314.2, ups=0.19, wpb=17381.3, bsz=1024, num_updates=9100, lr=4.08119e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58023
2024-11-07 05:49:17 - progress_bar.py[line:274] - INFO: epoch 024:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17658.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3384.7, ups=0.19, wpb=17658.3, bsz=1024, num_updates=9110, lr=4.07983e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58076
2024-11-07 05:50:10 - progress_bar.py[line:274] - INFO: epoch 024:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17456.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3286.8, ups=0.19, wpb=17456.3, bsz=1024, num_updates=9120, lr=4.07847e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=58129
2024-11-07 05:51:02 - progress_bar.py[line:274] - INFO: epoch 024:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17872, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3445.7, ups=0.19, wpb=17872, bsz=1024, num_updates=9130, lr=4.07711e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58181
2024-11-07 05:51:54 - progress_bar.py[line:274] - INFO: epoch 024:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17487.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3313.3, ups=0.19, wpb=17487.6, bsz=1024, num_updates=9140, lr=4.07575e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=58233
2024-11-07 05:52:47 - progress_bar.py[line:274] - INFO: epoch 024:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17893.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3411.8, ups=0.19, wpb=17893.4, bsz=1024, num_updates=9150, lr=4.07439e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58286
2024-11-07 05:53:39 - progress_bar.py[line:274] - INFO: epoch 024:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=17663.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3361.2, ups=0.19, wpb=17663.8, bsz=1024, num_updates=9160, lr=4.07303e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=58338
2024-11-07 05:54:32 - progress_bar.py[line:274] - INFO: epoch 024:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17506.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3309.5, ups=0.19, wpb=17506.5, bsz=1024, num_updates=9170, lr=4.07167e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.4, wall=58391
2024-11-07 05:55:25 - progress_bar.py[line:274] - INFO: epoch 024:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17482.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3325.7, ups=0.19, wpb=17482.1, bsz=1024, num_updates=9180, lr=4.07031e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=58444
2024-11-07 05:56:18 - progress_bar.py[line:274] - INFO: epoch 024:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=18053.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3418.2, ups=0.19, wpb=18053.6, bsz=1024, num_updates=9190, lr=4.06894e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=48, gb_free=13.6, wall=58497
2024-11-07 05:57:11 - progress_bar.py[line:274] - INFO: epoch 024:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=18087, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3392.3, ups=0.19, wpb=18087, bsz=1024, num_updates=9200, lr=4.06758e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58550
2024-11-07 05:58:03 - progress_bar.py[line:274] - INFO: epoch 024:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18017.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3443.2, ups=0.19, wpb=18017.8, bsz=1024, num_updates=9210, lr=4.06622e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58602
2024-11-07 05:58:55 - progress_bar.py[line:274] - INFO: epoch 024:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17766.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3437.1, ups=0.19, wpb=17766.6, bsz=1024, num_updates=9220, lr=4.06486e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58654
2024-11-07 05:59:48 - progress_bar.py[line:274] - INFO: epoch 024:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17552.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3338, ups=0.19, wpb=17552.1, bsz=1024, num_updates=9230, lr=4.0635e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58707
2024-11-07 06:00:40 - progress_bar.py[line:274] - INFO: epoch 024:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3342.1, ups=0.19, wpb=17570.6, bsz=1024, num_updates=9240, lr=4.06214e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58759
2024-11-07 06:01:33 - progress_bar.py[line:274] - INFO: epoch 024:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=18045.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3449.2, ups=0.19, wpb=18045.8, bsz=1024, num_updates=9250, lr=4.06078e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58811
2024-11-07 06:02:24 - progress_bar.py[line:274] - INFO: epoch 024:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17679.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3405.1, ups=0.19, wpb=17679.3, bsz=1024, num_updates=9260, lr=4.05942e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58863
2024-11-07 06:03:17 - progress_bar.py[line:274] - INFO: epoch 024:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17651.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3342.3, ups=0.19, wpb=17651.9, bsz=1024, num_updates=9270, lr=4.05806e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=45, gb_free=13.6, wall=58916
2024-11-07 06:04:10 - progress_bar.py[line:274] - INFO: epoch 024:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3327.7, ups=0.19, wpb=17685.5, bsz=1024, num_updates=9280, lr=4.0567e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=58969
2024-11-07 06:05:02 - progress_bar.py[line:274] - INFO: epoch 024:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=18315.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3534.6, ups=0.19, wpb=18315.8, bsz=1024, num_updates=9290, lr=4.05534e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=59021
2024-11-07 06:05:55 - progress_bar.py[line:274] - INFO: epoch 024:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18095.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3441.6, ups=0.19, wpb=18095.4, bsz=1024, num_updates=9300, lr=4.05398e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=59074
2024-11-07 06:06:47 - progress_bar.py[line:274] - INFO: epoch 024:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18242.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3521.2, ups=0.19, wpb=18242.8, bsz=1024, num_updates=9310, lr=4.05262e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=59125
2024-11-07 06:07:39 - progress_bar.py[line:274] - INFO: epoch 024:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18663.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3538.1, ups=0.19, wpb=18663.3, bsz=1024, num_updates=9320, lr=4.05126e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=59178
2024-11-07 06:08:32 - progress_bar.py[line:274] - INFO: epoch 024:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=18129.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3457.3, ups=0.19, wpb=18129.8, bsz=1024, num_updates=9330, lr=4.0499e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=59231
2024-11-07 06:09:24 - progress_bar.py[line:274] - INFO: epoch 024:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=18563.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3578.5, ups=0.19, wpb=18563.8, bsz=1024, num_updates=9340, lr=4.04854e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.2, wall=59283
2024-11-07 06:10:16 - progress_bar.py[line:274] - INFO: epoch 024:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=18122.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3436.8, ups=0.19, wpb=18122.9, bsz=1024, num_updates=9350, lr=4.04718e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=59335
2024-11-07 06:11:09 - progress_bar.py[line:274] - INFO: epoch 024:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=18056.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3406.8, ups=0.19, wpb=18056.8, bsz=1024, num_updates=9360, lr=4.04582e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=59388
2024-11-07 06:12:02 - progress_bar.py[line:274] - INFO: epoch 024:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17907.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3433.1, ups=0.19, wpb=17907.9, bsz=1024, num_updates=9370, lr=4.04446e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=59440
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt2024-11-07 06:12:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 24 @ 9377 updates


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-07 06:12:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 06:14:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 06:16:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 24 @ 9377 updates, score 0) (writing took 217.80983646999812 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 06:17:07 - train.py[line:336] - INFO: end of epoch 24 (average epoch stats below)
2024-11-07 06:17:07 - progress_bar.py[line:282] - INFO: epoch 024 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.505 | ntokens 17837.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.68 | wps 2784.1 | ups 0.16 | wpb 17837.7 | bsz 1023 | num_updates 9377 | lr 4.04351e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1918 | gb_free 13.4 | wall 59746
2024-11-07 06:17:07 - trainer.py[line:639] - INFO: loading train data for epoch 25
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 06:19:46 - trainer.py[line:703] - INFO: begin training epoch 25
2024-11-07 06:19:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 06:20:04 - progress_bar.py[line:274] - INFO: epoch 025:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17337.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=359.4, ups=0.02, wpb=17337.4, bsz=985.6, num_updates=9380, lr=4.0431e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=42, gb_free=13.6, wall=59923
2024-11-07 06:20:56 - progress_bar.py[line:274] - INFO: epoch 025:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17519.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3357.4, ups=0.19, wpb=17519.7, bsz=1024, num_updates=9390, lr=4.04174e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=59975
2024-11-07 06:21:50 - progress_bar.py[line:274] - INFO: epoch 025:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17852.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3344.3, ups=0.19, wpb=17852.8, bsz=1024, num_updates=9400, lr=4.04038e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60028
2024-11-07 06:22:42 - progress_bar.py[line:274] - INFO: epoch 025:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17961.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3439.1, ups=0.19, wpb=17961.6, bsz=1024, num_updates=9410, lr=4.03902e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60081
2024-11-07 06:23:34 - progress_bar.py[line:274] - INFO: epoch 025:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17522.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3347, ups=0.19, wpb=17522.3, bsz=1024, num_updates=9420, lr=4.03766e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60133
2024-11-07 06:24:26 - progress_bar.py[line:274] - INFO: epoch 025:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17646, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3393.5, ups=0.19, wpb=17646, bsz=1024, num_updates=9430, lr=4.0363e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60185
2024-11-07 06:25:18 - progress_bar.py[line:274] - INFO: epoch 025:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=18090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3462.3, ups=0.19, wpb=18090.1, bsz=1024, num_updates=9440, lr=4.03493e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60237
2024-11-07 06:26:11 - progress_bar.py[line:274] - INFO: epoch 025:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.453, ntokens=17496.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3314.3, ups=0.19, wpb=17496.1, bsz=1024, num_updates=9450, lr=4.03357e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60290
2024-11-07 06:27:05 - progress_bar.py[line:274] - INFO: epoch 025:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17600.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3291.6, ups=0.19, wpb=17600.9, bsz=1024, num_updates=9460, lr=4.03221e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60343
2024-11-07 06:27:57 - progress_bar.py[line:274] - INFO: epoch 025:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17612.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3361.7, ups=0.19, wpb=17612.7, bsz=1024, num_updates=9470, lr=4.03085e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60396
2024-11-07 06:28:50 - progress_bar.py[line:274] - INFO: epoch 025:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17585.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3341.7, ups=0.19, wpb=17585.5, bsz=1024, num_updates=9480, lr=4.02949e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60449
2024-11-07 06:29:42 - progress_bar.py[line:274] - INFO: epoch 025:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17500.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3315.6, ups=0.19, wpb=17500.3, bsz=1024, num_updates=9490, lr=4.02813e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60501
2024-11-07 06:30:37 - progress_bar.py[line:274] - INFO: epoch 025:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17844.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3267.2, ups=0.18, wpb=17844.5, bsz=1024, num_updates=9500, lr=4.02677e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60556
2024-11-07 06:31:35 - progress_bar.py[line:274] - INFO: epoch 025:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17742.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3083.9, ups=0.17, wpb=17742.7, bsz=1024, num_updates=9510, lr=4.02541e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60613
2024-11-07 06:32:29 - progress_bar.py[line:274] - INFO: epoch 025:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17698.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3236.4, ups=0.18, wpb=17698.8, bsz=1024, num_updates=9520, lr=4.02405e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=60668
2024-11-07 06:33:21 - progress_bar.py[line:274] - INFO: epoch 025:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17569.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3381.2, ups=0.19, wpb=17569.1, bsz=1024, num_updates=9530, lr=4.02269e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60720
2024-11-07 06:34:14 - progress_bar.py[line:274] - INFO: epoch 025:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17429.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3282.5, ups=0.19, wpb=17429.7, bsz=1024, num_updates=9540, lr=4.02133e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=60773
2024-11-07 06:35:10 - progress_bar.py[line:274] - INFO: epoch 025:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17728.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3185.3, ups=0.18, wpb=17728.7, bsz=1024, num_updates=9550, lr=4.01997e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=60829
2024-11-07 06:36:05 - progress_bar.py[line:274] - INFO: epoch 025:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17519.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3172.9, ups=0.18, wpb=17519.8, bsz=1024, num_updates=9560, lr=4.01861e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=60884
2024-11-07 06:36:57 - progress_bar.py[line:274] - INFO: epoch 025:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17907.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3442.9, ups=0.19, wpb=17907.1, bsz=1024, num_updates=9570, lr=4.01725e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=60936
2024-11-07 06:37:49 - progress_bar.py[line:274] - INFO: epoch 025:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.471, ntokens=17720.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3436.3, ups=0.19, wpb=17720.5, bsz=1024, num_updates=9580, lr=4.01589e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=42, gb_free=13.5, wall=60988
2024-11-07 06:38:41 - progress_bar.py[line:274] - INFO: epoch 025:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.483, ntokens=17981.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3459, ups=0.19, wpb=17981.7, bsz=1024, num_updates=9590, lr=4.01453e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.6, wall=61040
2024-11-07 06:39:34 - progress_bar.py[line:274] - INFO: epoch 025:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3272.9, ups=0.19, wpb=17513.9, bsz=1024, num_updates=9600, lr=4.01317e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61093
2024-11-07 06:40:26 - progress_bar.py[line:274] - INFO: epoch 025:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17692.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3405.4, ups=0.19, wpb=17692.8, bsz=1024, num_updates=9610, lr=4.01181e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=61145
2024-11-07 06:41:19 - progress_bar.py[line:274] - INFO: epoch 025:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17537, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3340.1, ups=0.19, wpb=17537, bsz=1024, num_updates=9620, lr=4.01045e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=61198
2024-11-07 06:42:12 - progress_bar.py[line:274] - INFO: epoch 025:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=17396.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3247.4, ups=0.19, wpb=17396.5, bsz=1024, num_updates=9630, lr=4.00909e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=61251
2024-11-07 06:43:04 - progress_bar.py[line:274] - INFO: epoch 025:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17555.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3385.2, ups=0.19, wpb=17555.8, bsz=1024, num_updates=9640, lr=4.00773e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61303
2024-11-07 06:43:57 - progress_bar.py[line:274] - INFO: epoch 025:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17808.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3392.6, ups=0.19, wpb=17808.3, bsz=1024, num_updates=9650, lr=4.00637e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61356
2024-11-07 06:44:49 - progress_bar.py[line:274] - INFO: epoch 025:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=17301.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3283.2, ups=0.19, wpb=17301.5, bsz=1024, num_updates=9660, lr=4.00501e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=61408
2024-11-07 06:45:41 - progress_bar.py[line:274] - INFO: epoch 025:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17540.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3380.7, ups=0.19, wpb=17540.3, bsz=1024, num_updates=9670, lr=4.00365e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=61460
2024-11-07 06:46:32 - progress_bar.py[line:274] - INFO: epoch 025:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18161.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3555.5, ups=0.2, wpb=18161.7, bsz=1024, num_updates=9680, lr=4.00229e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=61511
2024-11-07 06:47:25 - progress_bar.py[line:274] - INFO: epoch 025:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18148.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3451.9, ups=0.19, wpb=18148.4, bsz=1024, num_updates=9690, lr=4.00093e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=61564
2024-11-07 06:48:17 - progress_bar.py[line:274] - INFO: epoch 025:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18133.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3477, ups=0.19, wpb=18133.7, bsz=1024, num_updates=9700, lr=3.99956e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.4, wall=61616
2024-11-07 06:49:09 - progress_bar.py[line:274] - INFO: epoch 025:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=18519.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3556.1, ups=0.19, wpb=18519.8, bsz=1024, num_updates=9710, lr=3.9982e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=45, gb_free=13.1, wall=61668
2024-11-07 06:50:02 - progress_bar.py[line:274] - INFO: epoch 025:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=18058.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3438.2, ups=0.19, wpb=18058.3, bsz=1024, num_updates=9720, lr=3.99684e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=61721
2024-11-07 06:50:54 - progress_bar.py[line:274] - INFO: epoch 025:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18580.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3539.1, ups=0.19, wpb=18580.1, bsz=1024, num_updates=9730, lr=3.99548e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=61773
2024-11-07 06:50:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 06:51:51 - progress_bar.py[line:274] - INFO: epoch 025:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.51, ntokens=17803.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3112, ups=0.17, wpb=17803.6, bsz=1024, num_updates=9740, lr=3.99412e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=61830
2024-11-07 06:52:44 - progress_bar.py[line:274] - INFO: epoch 025:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17919.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3411.5, ups=0.19, wpb=17919.6, bsz=1024, num_updates=9750, lr=3.99276e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=61883
2024-11-07 06:53:36 - progress_bar.py[line:274] - INFO: epoch 025:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=18243.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3481.9, ups=0.19, wpb=18243.9, bsz=1024, num_updates=9760, lr=3.9914e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=61935
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
2024-11-07 06:54:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 25 @ 9767 updates
2024-11-07 06:54:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 06:55:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 06:57:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 25 @ 9767 updates, score 0) (writing took 221.21820808498887 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 06:58:45 - train.py[line:336] - INFO: end of epoch 25 (average epoch stats below)
2024-11-07 06:58:45 - progress_bar.py[line:282] - INFO: epoch 025 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.49 | ntokens 17758.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.62 | wps 2772.4 | ups 0.16 | wpb 17758.8 | bsz 1023 | num_updates 9767 | lr 3.99045e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1419 | gb_free 13.4 | wall 62244
2024-11-07 06:58:45 - trainer.py[line:639] - INFO: loading train data for epoch 26
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 07:01:25 - trainer.py[line:703] - INFO: begin training epoch 26
2024-11-07 07:01:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 07:01:42 - progress_bar.py[line:274] - INFO: epoch 026:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17355.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=357, ups=0.02, wpb=17355.6, bsz=985.6, num_updates=9770, lr=3.99004e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=62421
2024-11-07 07:02:35 - progress_bar.py[line:274] - INFO: epoch 026:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17687.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3349.8, ups=0.19, wpb=17687.4, bsz=1024, num_updates=9780, lr=3.98868e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62474
2024-11-07 07:03:28 - progress_bar.py[line:274] - INFO: epoch 026:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17679.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3369.5, ups=0.19, wpb=17679.3, bsz=1024, num_updates=9790, lr=3.98732e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=62527
2024-11-07 07:04:20 - progress_bar.py[line:274] - INFO: epoch 026:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3389.8, ups=0.19, wpb=17685.5, bsz=1024, num_updates=9800, lr=3.98596e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62579
2024-11-07 07:05:12 - progress_bar.py[line:274] - INFO: epoch 026:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.489, ntokens=17888.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3432, ups=0.19, wpb=17888.7, bsz=1024, num_updates=9810, lr=3.9846e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62631
2024-11-07 07:06:05 - progress_bar.py[line:274] - INFO: epoch 026:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17617.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3356, ups=0.19, wpb=17617.3, bsz=1024, num_updates=9820, lr=3.98324e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62683
2024-11-07 07:06:57 - progress_bar.py[line:274] - INFO: epoch 026:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17884.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3410.6, ups=0.19, wpb=17884.5, bsz=1024, num_updates=9830, lr=3.98188e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62736
2024-11-07 07:07:50 - progress_bar.py[line:274] - INFO: epoch 026:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17813.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3372, ups=0.19, wpb=17813.7, bsz=1024, num_updates=9840, lr=3.98052e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62789
2024-11-07 07:08:43 - progress_bar.py[line:274] - INFO: epoch 026:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17806.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3315.3, ups=0.19, wpb=17806.8, bsz=1024, num_updates=9850, lr=3.97916e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62842
2024-11-07 07:09:39 - progress_bar.py[line:274] - INFO: epoch 026:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17563.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3137.3, ups=0.18, wpb=17563.4, bsz=1024, num_updates=9860, lr=3.9778e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=62898
2024-11-07 07:10:32 - progress_bar.py[line:274] - INFO: epoch 026:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17612.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3384.9, ups=0.19, wpb=17612.2, bsz=1024, num_updates=9870, lr=3.97644e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=62950
2024-11-07 07:11:23 - progress_bar.py[line:274] - INFO: epoch 026:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17468.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3361.4, ups=0.19, wpb=17468.5, bsz=1024, num_updates=9880, lr=3.97508e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63002
2024-11-07 07:12:18 - progress_bar.py[line:274] - INFO: epoch 026:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17679, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3229.8, ups=0.18, wpb=17679, bsz=1024, num_updates=9890, lr=3.97372e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=63057
2024-11-07 07:13:14 - progress_bar.py[line:274] - INFO: epoch 026:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17636.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3163.7, ups=0.18, wpb=17636.7, bsz=1024, num_updates=9900, lr=3.97236e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=63113
2024-11-07 07:14:06 - progress_bar.py[line:274] - INFO: epoch 026:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17510.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3336.3, ups=0.19, wpb=17510.7, bsz=1024, num_updates=9910, lr=3.971e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63165
2024-11-07 07:14:59 - progress_bar.py[line:274] - INFO: epoch 026:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17683.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3334.4, ups=0.19, wpb=17683.3, bsz=1024, num_updates=9920, lr=3.96964e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=63218
2024-11-07 07:15:52 - progress_bar.py[line:274] - INFO: epoch 026:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17434.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3350.7, ups=0.19, wpb=17434.3, bsz=1024, num_updates=9930, lr=3.96828e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63270
2024-11-07 07:16:44 - progress_bar.py[line:274] - INFO: epoch 026:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17981.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3445.7, ups=0.19, wpb=17981.3, bsz=1024, num_updates=9940, lr=3.96692e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63323
2024-11-07 07:17:38 - progress_bar.py[line:274] - INFO: epoch 026:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17613, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3225.4, ups=0.18, wpb=17613, bsz=1024, num_updates=9950, lr=3.96555e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=63377
2024-11-07 07:18:32 - progress_bar.py[line:274] - INFO: epoch 026:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=17806.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3330.5, ups=0.19, wpb=17806.2, bsz=1024, num_updates=9960, lr=3.96419e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=63431
2024-11-07 07:19:24 - progress_bar.py[line:274] - INFO: epoch 026:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17994.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3458.7, ups=0.19, wpb=17994.9, bsz=1024, num_updates=9970, lr=3.96283e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63483
2024-11-07 07:20:16 - progress_bar.py[line:274] - INFO: epoch 026:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17957.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3428.7, ups=0.19, wpb=17957.3, bsz=1024, num_updates=9980, lr=3.96147e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=63535
2024-11-07 07:21:11 - progress_bar.py[line:274] - INFO: epoch 026:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3278.7, ups=0.18, wpb=17828, bsz=1024, num_updates=9990, lr=3.96011e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=63589
2024-11-07 07:22:03 - progress_bar.py[line:274] - INFO: epoch 026:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17835, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3410, ups=0.19, wpb=17835, bsz=1024, num_updates=10000, lr=3.95875e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63642
loss_reg: 0.005072457349734271 loss_cls: 0.0029850576538592577
loss_reg: 0.011574835184792593 loss_cls: 0.003301245393231511
loss_reg: 0.01806650845530307 loss_cls: 0.0028240042738616467
loss_reg: 0.012605174076533759 loss_cls: 0.003352748230099678
loss_reg: 0.018765818374008952 loss_cls: 0.003354056039825082
loss_reg: 0.006726486582906949 loss_cls: 0.0026976405642926693
loss_reg: 0.023671384557910072 loss_cls: 0.003688663709908724
loss_reg: 0.017193558134857616 loss_cls: 0.004349737428128719
loss_reg: 0.020649800006708817 loss_cls: 0.004239168483763933
loss_reg: 0.017635722727165994 loss_cls: 0.004073155578225851
loss_reg: 0.015941459556420307 loss_cls: 0.00382440909743309
loss_reg: 0.003092497793174779 loss_cls: 0.0025461153127253056
loss_reg: 0.010132632506271406 loss_cls: 0.0031686476431787014
loss_reg: 0.013024612628201763 loss_cls: 0.003592904657125473
loss_reg: 0.018866784788445022 loss_cls: 0.002823794260621071
loss_reg: 0.01610965090049986 loss_cls: 0.003522136015817523
loss_reg: 0.020264873564619153 loss_cls: 0.0030317187774926424
loss_reg: 0.012803599459763733 loss_cls: 0.0025839530862867832
loss_reg: 0.016515906738524475 loss_cls: 0.0024925819598138332
loss_reg: 0.0048059882839326246 loss_cls: 0.003466129070147872
loss_reg: 0.009767073852577052 loss_cls: 0.0030016815289855003
loss_reg: 0.015327750020412412 loss_cls: 0.004330474883317947
loss_reg: 0.022377223969332238 loss_cls: 0.004033925477415323
loss_reg: 0.019587593694097315 loss_cls: 0.002701906720176339
loss_reg: 0.020255689766306834 loss_cls: 0.003601281438022852
loss_reg: 0.014188317141174078 loss_cls: 0.004078863188624382
loss_reg: 0.00400660483965813 loss_cls: 0.002314819023013115
loss_reg: 0.01518792842477173 loss_cls: 0.0034420606680214405
loss_reg: 0.02101943739668691 loss_cls: 0.004031266551464796
loss_reg: 0.018474877659499324 loss_cls: 0.003058665432035923
loss_reg: 0.010148546074884055 loss_cls: 0.0028529323171824217
loss_reg: 0.014291745239295453 loss_cls: 0.0028770584613084793
loss_reg: 0.012876515068350015 loss_cls: 0.0031052157282829285
loss_reg: 0.002574398349857977 loss_cls: 0.0026204001624137163
loss_reg: 0.010619121191212381 loss_cls: 0.0031315633095800877
loss_reg: 0.011285099152285321 loss_cls: 0.003931376151740551
loss_reg: 0.013464573752272928 loss_cls: 0.0040021175518631935
loss_reg: 0.007731428875924249 loss_cls: 0.0033343788236379623
loss_reg: 0.011449482697426768 loss_cls: 0.003489007242023945
loss_reg: 0.014254637760358862 loss_cls: 0.0030181719921529293
loss_reg: 0.005651881569730247 loss_cls: 0.002793073421344161
loss_reg: 0.02171674839962207 loss_cls: 0.003650813363492489
loss_reg: 0.012549379904845216 loss_cls: 0.003618222661316395
loss_reg: 0.012603569846935652 loss_cls: 0.005365218501538038
loss_reg: 0.009510106913334242 loss_cls: 0.003541261423379183
loss_reg: 0.01579545287692194 loss_cls: 0.004597025457769632
loss_reg: 0.014157939663628766 loss_cls: 0.0025651913601905107
loss_reg: 0.011169865904173102 loss_cls: 0.002962418831884861
loss_reg: 0.0037872292290399108 loss_cls: 0.0028251672629266977
loss_reg: 0.019161269465257803 loss_cls: 0.004639727063477039
loss_reg: 0.01323476787555892 loss_cls: 0.004171007312834263
loss_reg: 0.024624168119753237 loss_cls: 0.003858195850625634
loss_reg: 0.011137786480519232 loss_cls: 0.004299917723983526
loss_reg: 0.009535568253668027 loss_cls: 0.0034535862505435944
loss_reg: 0.021431152143581832 loss_cls: 0.0034742269199341536
loss_reg: 0.011526694225963242 loss_cls: 0.004021471366286278
loss_reg: 0.005006155194671892 loss_cls: 0.003943929448723793
loss_reg: 0.018863963371590194 loss_cls: 0.003208993235602975
loss_reg: 0.020406717043124866 loss_cls: 0.0031902615446597338
loss_reg: 0.008540935542405419 loss_cls: 0.003262000158429146
loss_reg: 0.016971099352354958 loss_cls: 0.0033526422921568155
loss_reg: 0.012924091531637084 loss_cls: 0.0029463334940373898
loss_reg: 0.013714326172997206 loss_cls: 0.004171769600361586
loss_reg: 0.014725998202935991 loss_cls: 0.003666035132482648
2024-11-07 07:22:56 - progress_bar.py[line:274] - INFO: epoch 026:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.443, ntokens=17575.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3330.6, ups=0.19, wpb=17575.2, bsz=1024, num_updates=10010, lr=3.95739e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=63695
2024-11-07 07:23:47 - progress_bar.py[line:274] - INFO: epoch 026:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17897.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3497.3, ups=0.2, wpb=17897.5, bsz=1024, num_updates=10020, lr=3.95603e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=63746
2024-11-07 07:24:38 - progress_bar.py[line:274] - INFO: epoch 026:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17882.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3494.6, ups=0.2, wpb=17882.1, bsz=1024, num_updates=10030, lr=3.95467e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=63797
2024-11-07 07:25:30 - progress_bar.py[line:274] - INFO: epoch 026:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=18033.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3468.1, ups=0.19, wpb=18033.8, bsz=1024, num_updates=10040, lr=3.95331e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=44, gb_free=13.5, wall=63849
2024-11-07 07:26:22 - progress_bar.py[line:274] - INFO: epoch 026:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17667.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3386.7, ups=0.19, wpb=17667.5, bsz=1024, num_updates=10050, lr=3.95195e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=63901
2024-11-07 07:27:15 - progress_bar.py[line:274] - INFO: epoch 026:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17816.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3374.4, ups=0.19, wpb=17816.2, bsz=1024, num_updates=10060, lr=3.95059e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=63954
2024-11-07 07:28:07 - progress_bar.py[line:274] - INFO: epoch 026:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=18317.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3492.7, ups=0.19, wpb=18317.7, bsz=1024, num_updates=10070, lr=3.94923e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=64006
2024-11-07 07:29:00 - progress_bar.py[line:274] - INFO: epoch 026:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=18384.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3508.5, ups=0.19, wpb=18384.9, bsz=1024, num_updates=10080, lr=3.94787e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=64059
2024-11-07 07:29:52 - progress_bar.py[line:274] - INFO: epoch 026:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17889.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3410, ups=0.19, wpb=17889.5, bsz=1024, num_updates=10090, lr=3.94651e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=64111
2024-11-07 07:30:44 - progress_bar.py[line:274] - INFO: epoch 026:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=18294.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3523.3, ups=0.19, wpb=18294.1, bsz=1024, num_updates=10100, lr=3.94515e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.2, wall=64163
2024-11-07 07:31:37 - progress_bar.py[line:274] - INFO: epoch 026:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17845.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3371.2, ups=0.19, wpb=17845.6, bsz=1024, num_updates=10110, lr=3.94379e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=64216
2024-11-07 07:32:30 - progress_bar.py[line:274] - INFO: epoch 026:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18658.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3528.9, ups=0.19, wpb=18658.6, bsz=1024, num_updates=10120, lr=3.94243e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=64269
2024-11-07 07:33:26 - progress_bar.py[line:274] - INFO: epoch 026:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18331, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3287.1, ups=0.18, wpb=18331, bsz=1024, num_updates=10130, lr=3.94107e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=64325
2024-11-07 07:34:20 - progress_bar.py[line:274] - INFO: epoch 026:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.501, ntokens=17887.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3313, ups=0.19, wpb=17887.5, bsz=1024, num_updates=10140, lr=3.93971e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=64379
2024-11-07 07:35:12 - progress_bar.py[line:274] - INFO: epoch 026:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17957.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3429.9, ups=0.19, wpb=17957.5, bsz=1024, num_updates=10150, lr=3.93835e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=64431
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt2024-11-07 07:35:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 26 @ 10158 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-07 07:35:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 07:37:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-07 07:39:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 26 @ 10158 updates, score 0) (writing took 218.71483593300218 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 07:40:24 - train.py[line:336] - INFO: end of epoch 26 (average epoch stats below)
2024-11-07 07:40:24 - progress_bar.py[line:282] - INFO: epoch 026 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.482 | ntokens 17826.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.59 | wps 2788.8 | ups 0.16 | wpb 17826.4 | bsz 1023 | num_updates 10158 | lr 3.93726e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1799 | gb_free 13.4 | wall 64743
2024-11-07 07:40:24 - trainer.py[line:639] - INFO: loading train data for epoch 27
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 07:43:05 - trainer.py[line:703] - INFO: begin training epoch 27
2024-11-07 07:43:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 07:43:17 - progress_bar.py[line:274] - INFO: epoch 027:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17074.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=351.8, ups=0.02, wpb=17074.3, bsz=985.6, num_updates=10160, lr=3.93699e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.5, wall=64916
2024-11-07 07:44:10 - progress_bar.py[line:274] - INFO: epoch 027:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17256.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3257.3, ups=0.19, wpb=17256.5, bsz=1024, num_updates=10170, lr=3.93563e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64969
2024-11-07 07:44:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 07:45:08 - progress_bar.py[line:274] - INFO: epoch 027:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=18026.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3140.9, ups=0.17, wpb=18026.2, bsz=1024, num_updates=10180, lr=3.93427e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=33, gb_free=13.6, wall=65027
2024-11-07 07:46:00 - progress_bar.py[line:274] - INFO: epoch 027:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17900, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3437.9, ups=0.19, wpb=17900, bsz=1024, num_updates=10190, lr=3.93291e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65079
2024-11-07 07:46:52 - progress_bar.py[line:274] - INFO: epoch 027:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17914.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3420, ups=0.19, wpb=17914.7, bsz=1024, num_updates=10200, lr=3.93154e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65131
2024-11-07 07:47:45 - progress_bar.py[line:274] - INFO: epoch 027:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17459.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3342.4, ups=0.19, wpb=17459.7, bsz=1024, num_updates=10210, lr=3.93018e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65183
2024-11-07 07:48:36 - progress_bar.py[line:274] - INFO: epoch 027:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=18087.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3483, ups=0.19, wpb=18087.4, bsz=1024, num_updates=10220, lr=3.92882e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65235
2024-11-07 07:49:29 - progress_bar.py[line:274] - INFO: epoch 027:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17419.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3314.9, ups=0.19, wpb=17419.5, bsz=1024, num_updates=10230, lr=3.92746e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65288
2024-11-07 07:50:22 - progress_bar.py[line:274] - INFO: epoch 027:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17564.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3328.2, ups=0.19, wpb=17564.5, bsz=1024, num_updates=10240, lr=3.9261e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65341
2024-11-07 07:51:15 - progress_bar.py[line:274] - INFO: epoch 027:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17657.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3324.2, ups=0.19, wpb=17657.3, bsz=1024, num_updates=10250, lr=3.92474e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65394
2024-11-07 07:52:08 - progress_bar.py[line:274] - INFO: epoch 027:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.455, ntokens=17711.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3360.9, ups=0.19, wpb=17711.6, bsz=1024, num_updates=10260, lr=3.92338e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65446
2024-11-07 07:53:00 - progress_bar.py[line:274] - INFO: epoch 027:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17576.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3348.4, ups=0.19, wpb=17576.1, bsz=1024, num_updates=10270, lr=3.92202e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65499
2024-11-07 07:53:53 - progress_bar.py[line:274] - INFO: epoch 027:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.459, ntokens=17802.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3366.6, ups=0.19, wpb=17802.5, bsz=1024, num_updates=10280, lr=3.92066e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=65552
2024-11-07 07:54:46 - progress_bar.py[line:274] - INFO: epoch 027:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17535.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3307.8, ups=0.19, wpb=17535.4, bsz=1024, num_updates=10290, lr=3.9193e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65605
2024-11-07 07:55:39 - progress_bar.py[line:274] - INFO: epoch 027:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17737.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3348.2, ups=0.19, wpb=17737.9, bsz=1024, num_updates=10300, lr=3.91794e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65658
2024-11-07 07:56:31 - progress_bar.py[line:274] - INFO: epoch 027:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17932.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3422.3, ups=0.19, wpb=17932.7, bsz=1024, num_updates=10310, lr=3.91658e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65710
2024-11-07 07:57:23 - progress_bar.py[line:274] - INFO: epoch 027:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17756.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3409.5, ups=0.19, wpb=17756.9, bsz=1024, num_updates=10320, lr=3.91522e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=65762
2024-11-07 07:58:16 - progress_bar.py[line:274] - INFO: epoch 027:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17557.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3329.9, ups=0.19, wpb=17557.6, bsz=1024, num_updates=10330, lr=3.91386e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65815
2024-11-07 07:59:09 - progress_bar.py[line:274] - INFO: epoch 027:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17668.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3331, ups=0.19, wpb=17668.1, bsz=1024, num_updates=10340, lr=3.9125e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65868
2024-11-07 08:00:02 - progress_bar.py[line:274] - INFO: epoch 027:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17543.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3335.6, ups=0.19, wpb=17543.2, bsz=1024, num_updates=10350, lr=3.91114e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65921
2024-11-07 08:00:56 - progress_bar.py[line:274] - INFO: epoch 027:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17995.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3349.1, ups=0.19, wpb=17995.7, bsz=1024, num_updates=10360, lr=3.90978e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=65974
2024-11-07 08:01:48 - progress_bar.py[line:274] - INFO: epoch 027:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17953.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3418.4, ups=0.19, wpb=17953.5, bsz=1024, num_updates=10370, lr=3.90842e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=66027
2024-11-07 08:02:40 - progress_bar.py[line:274] - INFO: epoch 027:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17539.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3352.2, ups=0.19, wpb=17539.3, bsz=1024, num_updates=10380, lr=3.90706e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66079
2024-11-07 08:03:34 - progress_bar.py[line:274] - INFO: epoch 027:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17737.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3330.1, ups=0.19, wpb=17737.5, bsz=1024, num_updates=10390, lr=3.9057e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66133
2024-11-07 08:04:26 - progress_bar.py[line:274] - INFO: epoch 027:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.438, ntokens=17444.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3330.9, ups=0.19, wpb=17444.1, bsz=1024, num_updates=10400, lr=3.90434e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=66185
2024-11-07 08:05:19 - progress_bar.py[line:274] - INFO: epoch 027:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17704.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3371.3, ups=0.19, wpb=17704.8, bsz=1024, num_updates=10410, lr=3.90298e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66237
2024-11-07 08:06:11 - progress_bar.py[line:274] - INFO: epoch 027:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17815, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3379.9, ups=0.19, wpb=17815, bsz=1024, num_updates=10420, lr=3.90162e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66290
2024-11-07 08:07:04 - progress_bar.py[line:274] - INFO: epoch 027:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17890.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3383.3, ups=0.19, wpb=17890.8, bsz=1024, num_updates=10430, lr=3.90026e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66343
2024-11-07 08:07:57 - progress_bar.py[line:274] - INFO: epoch 027:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17740.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3333.4, ups=0.19, wpb=17740.1, bsz=1024, num_updates=10440, lr=3.8989e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=66396
2024-11-07 08:08:50 - progress_bar.py[line:274] - INFO: epoch 027:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17689.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3365.7, ups=0.19, wpb=17689.6, bsz=1024, num_updates=10450, lr=3.89753e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=66449
2024-11-07 08:09:42 - progress_bar.py[line:274] - INFO: epoch 027:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17971.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3466.1, ups=0.19, wpb=17971.5, bsz=1024, num_updates=10460, lr=3.89617e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66501
2024-11-07 08:10:33 - progress_bar.py[line:274] - INFO: epoch 027:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18229.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3523.5, ups=0.19, wpb=18229.9, bsz=1024, num_updates=10470, lr=3.89481e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66552
2024-11-07 08:11:25 - progress_bar.py[line:274] - INFO: epoch 027:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18031.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3471.8, ups=0.19, wpb=18031.1, bsz=1024, num_updates=10480, lr=3.89345e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66604
2024-11-07 08:12:18 - progress_bar.py[line:274] - INFO: epoch 027:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=18435.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3520.8, ups=0.19, wpb=18435.1, bsz=1024, num_updates=10490, lr=3.89209e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=66657
2024-11-07 08:13:10 - progress_bar.py[line:274] - INFO: epoch 027:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17985.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3438.8, ups=0.19, wpb=17985.5, bsz=1024, num_updates=10500, lr=3.89073e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66709
2024-11-07 08:14:02 - progress_bar.py[line:274] - INFO: epoch 027:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18472.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3562.8, ups=0.19, wpb=18472.1, bsz=1024, num_updates=10510, lr=3.88937e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=66761
2024-11-07 08:14:54 - progress_bar.py[line:274] - INFO: epoch 027:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=18119.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3451.7, ups=0.19, wpb=18119.3, bsz=1024, num_updates=10520, lr=3.88801e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=66813
2024-11-07 08:15:47 - progress_bar.py[line:274] - INFO: epoch 027:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=18171.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3479.5, ups=0.19, wpb=18171.5, bsz=1024, num_updates=10530, lr=3.88665e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66866
2024-11-07 08:16:40 - progress_bar.py[line:274] - INFO: epoch 027:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18057, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3381.6, ups=0.19, wpb=18057, bsz=1024, num_updates=10540, lr=3.88529e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=35, gb_free=13.5, wall=66919
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 08:17:20 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 27 @ 10548 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
2024-11-07 08:17:20 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt': File exists
: File exists: File exists: File exists

: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 08:19:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-07 08:20:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 27 @ 10548 updates, score 0) (writing took 217.7570783739793 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
2024-11-07 08:21:52 - train.py[line:336] - INFO: end of epoch 27 (average epoch stats below)
2024-11-07 08:21:52 - progress_bar.py[line:282] - INFO: epoch 027 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.477 | ntokens 17809.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.57 | wps 2792.2 | ups 0.16 | wpb 17809.3 | bsz 1023 | num_updates 10548 | lr 3.8842e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1216 | gb_free 13.3 | wall 67231
2024-11-07 08:21:52 - trainer.py[line:639] - INFO: loading train data for epoch 28
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 08:24:34 - trainer.py[line:703] - INFO: begin training epoch 28
2024-11-07 08:24:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 08:24:47 - progress_bar.py[line:274] - INFO: epoch 028:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17396.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=357.4, ups=0.02, wpb=17396.6, bsz=985.6, num_updates=10550, lr=3.88393e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=41, gb_free=13.6, wall=67406
2024-11-07 08:25:39 - progress_bar.py[line:274] - INFO: epoch 028:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17404.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3307.4, ups=0.19, wpb=17404.9, bsz=1024, num_updates=10560, lr=3.88257e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67458
2024-11-07 08:26:32 - progress_bar.py[line:274] - INFO: epoch 028:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=18166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3448.1, ups=0.19, wpb=18166.3, bsz=1024, num_updates=10570, lr=3.88121e-05, gnorm=0.015, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=67511
2024-11-07 08:27:24 - progress_bar.py[line:274] - INFO: epoch 028:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=17575.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3360.3, ups=0.19, wpb=17575.4, bsz=1024, num_updates=10580, lr=3.87985e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67563
2024-11-07 08:28:17 - progress_bar.py[line:274] - INFO: epoch 028:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17742.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3389.9, ups=0.19, wpb=17742.7, bsz=1024, num_updates=10590, lr=3.87849e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=67616
2024-11-07 08:29:09 - progress_bar.py[line:274] - INFO: epoch 028:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17453.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3321.3, ups=0.19, wpb=17453.4, bsz=1024, num_updates=10600, lr=3.87713e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67668
2024-11-07 08:30:02 - progress_bar.py[line:274] - INFO: epoch 028:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18149, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3462.3, ups=0.19, wpb=18149, bsz=1024, num_updates=10610, lr=3.87577e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67721
2024-11-07 08:30:58 - progress_bar.py[line:274] - INFO: epoch 028:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17813.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3186, ups=0.18, wpb=17813.9, bsz=1024, num_updates=10620, lr=3.87441e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=43, gb_free=13.5, wall=67777
2024-11-07 08:31:51 - progress_bar.py[line:274] - INFO: epoch 028:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3276.8, ups=0.19, wpb=17543.5, bsz=1024, num_updates=10630, lr=3.87305e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=67830
2024-11-07 08:32:43 - progress_bar.py[line:274] - INFO: epoch 028:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17686.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3396.9, ups=0.19, wpb=17686.1, bsz=1024, num_updates=10640, lr=3.87169e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=67882
2024-11-07 08:33:36 - progress_bar.py[line:274] - INFO: epoch 028:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17570.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3358.6, ups=0.19, wpb=17570.1, bsz=1024, num_updates=10650, lr=3.87033e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=67934
2024-11-07 08:34:28 - progress_bar.py[line:274] - INFO: epoch 028:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=17301.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3312.2, ups=0.19, wpb=17301.4, bsz=1024, num_updates=10660, lr=3.86897e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=46, gb_free=13.6, wall=67987
2024-11-07 08:35:20 - progress_bar.py[line:274] - INFO: epoch 028:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17626.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3391.3, ups=0.19, wpb=17626.6, bsz=1024, num_updates=10670, lr=3.86761e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=68039
2024-11-07 08:36:12 - progress_bar.py[line:274] - INFO: epoch 028:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17526.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3359.5, ups=0.19, wpb=17526.5, bsz=1024, num_updates=10680, lr=3.86625e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=68091
2024-11-07 08:37:04 - progress_bar.py[line:274] - INFO: epoch 028:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17776.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3409.9, ups=0.19, wpb=17776.2, bsz=1024, num_updates=10690, lr=3.86489e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68143
2024-11-07 08:37:57 - progress_bar.py[line:274] - INFO: epoch 028:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17754.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3355.9, ups=0.19, wpb=17754.5, bsz=1024, num_updates=10700, lr=3.86353e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68196
2024-11-07 08:38:49 - progress_bar.py[line:274] - INFO: epoch 028:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17457.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3333.5, ups=0.19, wpb=17457.6, bsz=1024, num_updates=10710, lr=3.86216e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=68248
2024-11-07 08:39:42 - progress_bar.py[line:274] - INFO: epoch 028:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17778.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3388.1, ups=0.19, wpb=17778.6, bsz=1024, num_updates=10720, lr=3.8608e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68301
2024-11-07 08:40:35 - progress_bar.py[line:274] - INFO: epoch 028:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3325.3, ups=0.19, wpb=17660.5, bsz=1024, num_updates=10730, lr=3.85944e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68354
2024-11-07 08:41:27 - progress_bar.py[line:274] - INFO: epoch 028:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17879.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3433.9, ups=0.19, wpb=17879.5, bsz=1024, num_updates=10740, lr=3.85808e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=68406
2024-11-07 08:42:22 - progress_bar.py[line:274] - INFO: epoch 028:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=18124, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3296.5, ups=0.18, wpb=18124, bsz=1024, num_updates=10750, lr=3.85672e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=38, gb_free=13.5, wall=68461
2024-11-07 08:43:15 - progress_bar.py[line:274] - INFO: epoch 028:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18060.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3394.5, ups=0.19, wpb=18060.9, bsz=1024, num_updates=10760, lr=3.85536e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=68514
2024-11-07 08:44:08 - progress_bar.py[line:274] - INFO: epoch 028:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17866.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3403.2, ups=0.19, wpb=17866.3, bsz=1024, num_updates=10770, lr=3.854e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=68567
2024-11-07 08:44:59 - progress_bar.py[line:274] - INFO: epoch 028:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=18005, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3489.6, ups=0.19, wpb=18005, bsz=1024, num_updates=10780, lr=3.85264e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=50, gb_free=13.5, wall=68618
2024-11-07 08:45:51 - progress_bar.py[line:274] - INFO: epoch 028:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17661, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3395, ups=0.19, wpb=17661, bsz=1024, num_updates=10790, lr=3.85128e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=39, gb_free=13.5, wall=68670
2024-11-07 08:46:45 - progress_bar.py[line:274] - INFO: epoch 028:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17537.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3298, ups=0.19, wpb=17537.4, bsz=1024, num_updates=10800, lr=3.84992e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=68723
2024-11-07 08:47:38 - progress_bar.py[line:274] - INFO: epoch 028:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17623.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3313.9, ups=0.19, wpb=17623.5, bsz=1024, num_updates=10810, lr=3.84856e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=68777
2024-11-07 08:48:31 - progress_bar.py[line:274] - INFO: epoch 028:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17943.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3384.3, ups=0.19, wpb=17943.7, bsz=1024, num_updates=10820, lr=3.8472e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68830
2024-11-07 08:49:25 - progress_bar.py[line:274] - INFO: epoch 028:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.438, ntokens=17571.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3260.4, ups=0.19, wpb=17571.4, bsz=1024, num_updates=10830, lr=3.84584e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=68884
2024-11-07 08:50:18 - progress_bar.py[line:274] - INFO: epoch 028:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17632.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3298.2, ups=0.19, wpb=17632.5, bsz=1024, num_updates=10840, lr=3.84448e-05, gnorm=0.015, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68937
2024-11-07 08:51:12 - progress_bar.py[line:274] - INFO: epoch 028:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17665.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3303.2, ups=0.19, wpb=17665.8, bsz=1024, num_updates=10850, lr=3.84312e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=68990
2024-11-07 08:52:05 - progress_bar.py[line:274] - INFO: epoch 028:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=18662.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3523.1, ups=0.19, wpb=18662.2, bsz=1024, num_updates=10860, lr=3.84176e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=69043
2024-11-07 08:52:58 - progress_bar.py[line:274] - INFO: epoch 028:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=18034.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3363.3, ups=0.19, wpb=18034.8, bsz=1024, num_updates=10870, lr=3.8404e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=69097
2024-11-07 08:53:51 - progress_bar.py[line:274] - INFO: epoch 028:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=18251.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3482.7, ups=0.19, wpb=18251.7, bsz=1024, num_updates=10880, lr=3.83904e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=69149
2024-11-07 08:54:43 - progress_bar.py[line:274] - INFO: epoch 028:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.491, ntokens=17884.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3413.3, ups=0.19, wpb=17884.3, bsz=1024, num_updates=10890, lr=3.83768e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=69202
2024-11-07 08:55:37 - progress_bar.py[line:274] - INFO: epoch 028:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3496.3, ups=0.19, wpb=18828, bsz=1024, num_updates=10900, lr=3.83632e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=37, gb_free=13.5, wall=69256
2024-11-07 08:56:30 - progress_bar.py[line:274] - INFO: epoch 028:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=18233, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3408.7, ups=0.19, wpb=18233, bsz=1024, num_updates=10910, lr=3.83496e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=69309
2024-11-07 08:57:24 - progress_bar.py[line:274] - INFO: epoch 028:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17918.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3365.7, ups=0.19, wpb=17918.7, bsz=1024, num_updates=10920, lr=3.8336e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=69362
2024-11-07 08:58:18 - progress_bar.py[line:274] - INFO: epoch 028:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=18099.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3338, ups=0.18, wpb=18099.7, bsz=1024, num_updates=10930, lr=3.83224e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=69417
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt

2024-11-07 08:59:04 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 28 @ 10939 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-07 08:59:04 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:00:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 09:02:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 28 @ 10939 updates, score 0) (writing took 223.62149764501373 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 09:03:42 - train.py[line:336] - INFO: end of epoch 28 (average epoch stats below)
2024-11-07 09:03:42 - progress_bar.py[line:282] - INFO: epoch 028 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.471 | ntokens 17809.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.54 | wps 2774.5 | ups 0.16 | wpb 17809.2 | bsz 1023 | num_updates 10939 | lr 3.83101e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 1475 | gb_free 13.4 | wall 69740
2024-11-07 09:03:42 - trainer.py[line:639] - INFO: loading train data for epoch 29
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 09:06:21 - trainer.py[line:703] - INFO: begin training epoch 29
2024-11-07 09:06:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 09:06:28 - progress_bar.py[line:274] - INFO: epoch 029:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17202.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=350.8, ups=0.02, wpb=17202.1, bsz=985.6, num_updates=10940, lr=3.83088e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=69907
2024-11-07 09:07:21 - progress_bar.py[line:274] - INFO: epoch 029:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17516.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3342.8, ups=0.19, wpb=17516.4, bsz=1024, num_updates=10950, lr=3.82952e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69959
2024-11-07 09:08:13 - progress_bar.py[line:274] - INFO: epoch 029:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17804.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3399.9, ups=0.19, wpb=17804.2, bsz=1024, num_updates=10960, lr=3.82815e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70012
2024-11-07 09:09:05 - progress_bar.py[line:274] - INFO: epoch 029:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.443, ntokens=17740.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3391.3, ups=0.19, wpb=17740.2, bsz=1024, num_updates=10970, lr=3.82679e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=70064
2024-11-07 09:09:58 - progress_bar.py[line:274] - INFO: epoch 029:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=17555, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3317.8, ups=0.19, wpb=17555, bsz=1024, num_updates=10980, lr=3.82543e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70117
2024-11-07 09:10:50 - progress_bar.py[line:274] - INFO: epoch 029:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17549.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3357, ups=0.19, wpb=17549.4, bsz=1024, num_updates=10990, lr=3.82407e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70169
2024-11-07 09:11:43 - progress_bar.py[line:274] - INFO: epoch 029:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18057.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3470.2, ups=0.19, wpb=18057.1, bsz=1024, num_updates=11000, lr=3.82271e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70221
2024-11-07 09:12:35 - progress_bar.py[line:274] - INFO: epoch 029:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=17383, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3308, ups=0.19, wpb=17383, bsz=1024, num_updates=11010, lr=3.82135e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70274
2024-11-07 09:13:28 - progress_bar.py[line:274] - INFO: epoch 029:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17884.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3395.7, ups=0.19, wpb=17884.6, bsz=1024, num_updates=11020, lr=3.81999e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70327
2024-11-07 09:14:21 - progress_bar.py[line:274] - INFO: epoch 029:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17673.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3340.9, ups=0.19, wpb=17673.3, bsz=1024, num_updates=11030, lr=3.81863e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70380
2024-11-07 09:15:14 - progress_bar.py[line:274] - INFO: epoch 029:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17616.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3325.1, ups=0.19, wpb=17616.7, bsz=1024, num_updates=11040, lr=3.81727e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70432
2024-11-07 09:16:06 - progress_bar.py[line:274] - INFO: epoch 029:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17463.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3345, ups=0.19, wpb=17463.3, bsz=1024, num_updates=11050, lr=3.81591e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70485
2024-11-07 09:16:59 - progress_bar.py[line:274] - INFO: epoch 029:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17894.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3386.3, ups=0.19, wpb=17894.6, bsz=1024, num_updates=11060, lr=3.81455e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70538
2024-11-07 09:17:51 - progress_bar.py[line:274] - INFO: epoch 029:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17375.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3324.1, ups=0.19, wpb=17375.8, bsz=1024, num_updates=11070, lr=3.81319e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70590
2024-11-07 09:18:43 - progress_bar.py[line:274] - INFO: epoch 029:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17884.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3423.2, ups=0.19, wpb=17884.9, bsz=1024, num_updates=11080, lr=3.81183e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70642
2024-11-07 09:19:36 - progress_bar.py[line:274] - INFO: epoch 029:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17572.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3348.8, ups=0.19, wpb=17572.4, bsz=1024, num_updates=11090, lr=3.81047e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70695
2024-11-07 09:20:28 - progress_bar.py[line:274] - INFO: epoch 029:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17607.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3365.4, ups=0.19, wpb=17607.5, bsz=1024, num_updates=11100, lr=3.80911e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=70747
2024-11-07 09:21:20 - progress_bar.py[line:274] - INFO: epoch 029:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17920.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3442.3, ups=0.19, wpb=17920.8, bsz=1024, num_updates=11110, lr=3.80775e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=70799
2024-11-07 09:22:13 - progress_bar.py[line:274] - INFO: epoch 029:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17297.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3261.1, ups=0.19, wpb=17297.5, bsz=1024, num_updates=11120, lr=3.80639e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70852
2024-11-07 09:23:06 - progress_bar.py[line:274] - INFO: epoch 029:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17852.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3353.5, ups=0.19, wpb=17852.9, bsz=1024, num_updates=11130, lr=3.80503e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70905
2024-11-07 09:23:58 - progress_bar.py[line:274] - INFO: epoch 029:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=18025.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3466.1, ups=0.19, wpb=18025.6, bsz=1024, num_updates=11140, lr=3.80367e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70957
2024-11-07 09:24:52 - progress_bar.py[line:274] - INFO: epoch 029:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=17768.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3333.3, ups=0.19, wpb=17768.8, bsz=1024, num_updates=11150, lr=3.80231e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71011
2024-11-07 09:25:44 - progress_bar.py[line:274] - INFO: epoch 029:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17514.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3343.8, ups=0.19, wpb=17514.4, bsz=1024, num_updates=11160, lr=3.80095e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71063
2024-11-07 09:26:37 - progress_bar.py[line:274] - INFO: epoch 029:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17518.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3305.9, ups=0.19, wpb=17518.4, bsz=1024, num_updates=11170, lr=3.79959e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71116
2024-11-07 09:27:32 - progress_bar.py[line:274] - INFO: epoch 029:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17797.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3214.7, ups=0.18, wpb=17797.2, bsz=1024, num_updates=11180, lr=3.79823e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=71171
2024-11-07 09:28:28 - progress_bar.py[line:274] - INFO: epoch 029:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18007.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3246.4, ups=0.18, wpb=18007.7, bsz=1024, num_updates=11190, lr=3.79687e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=71227
2024-11-07 09:29:23 - progress_bar.py[line:274] - INFO: epoch 029:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17879.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3243.2, ups=0.18, wpb=17879.9, bsz=1024, num_updates=11200, lr=3.79551e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=71282
2024-11-07 09:30:18 - progress_bar.py[line:274] - INFO: epoch 029:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17990.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3279.6, ups=0.18, wpb=17990.5, bsz=1024, num_updates=11210, lr=3.79414e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71337
2024-11-07 09:31:13 - progress_bar.py[line:274] - INFO: epoch 029:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17629.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3199.5, ups=0.18, wpb=17629.6, bsz=1024, num_updates=11220, lr=3.79278e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71392
2024-11-07 09:32:08 - progress_bar.py[line:274] - INFO: epoch 029:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17577.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3185, ups=0.18, wpb=17577.3, bsz=1024, num_updates=11230, lr=3.79142e-05, gnorm=0.014, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=71447
2024-11-07 09:33:03 - progress_bar.py[line:274] - INFO: epoch 029:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17999.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3252.3, ups=0.18, wpb=17999.2, bsz=1024, num_updates=11240, lr=3.79006e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71502
2024-11-07 09:33:59 - progress_bar.py[line:274] - INFO: epoch 029:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=18407.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3334.8, ups=0.18, wpb=18407.9, bsz=1024, num_updates=11250, lr=3.7887e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=71558
2024-11-07 09:34:52 - progress_bar.py[line:274] - INFO: epoch 029:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=18311.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3440.5, ups=0.19, wpb=18311.4, bsz=1024, num_updates=11260, lr=3.78734e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=71611
2024-11-07 09:35:44 - progress_bar.py[line:274] - INFO: epoch 029:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=18325.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3497.9, ups=0.19, wpb=18325.2, bsz=1024, num_updates=11270, lr=3.78598e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=71663
2024-11-07 09:36:37 - progress_bar.py[line:274] - INFO: epoch 029:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.498, ntokens=17980.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3418.5, ups=0.19, wpb=17980.4, bsz=1024, num_updates=11280, lr=3.78462e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.2, wall=71716
2024-11-07 09:37:30 - progress_bar.py[line:274] - INFO: epoch 029:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18772.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3552.5, ups=0.19, wpb=18772.3, bsz=1024, num_updates=11290, lr=3.78326e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=71769
2024-11-07 09:38:22 - progress_bar.py[line:274] - INFO: epoch 029:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17920.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3444.6, ups=0.19, wpb=17920.2, bsz=1024, num_updates=11300, lr=3.7819e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=71821
2024-11-07 09:39:14 - progress_bar.py[line:274] - INFO: epoch 029:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=18299.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3522.1, ups=0.19, wpb=18299.1, bsz=1024, num_updates=11310, lr=3.78054e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=71873
2024-11-07 09:40:06 - progress_bar.py[line:274] - INFO: epoch 029:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=18111.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3472.7, ups=0.19, wpb=18111.4, bsz=1024, num_updates=11320, lr=3.77918e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=71925
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 09:40:55 - progress_bar.py[line:274] - INFO: epoch 029:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17626.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3575.7, ups=0.2, wpb=17626.1, bsz=985.6, num_updates=11330, lr=3.77782e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=49, gb_free=13.3, wall=71974
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt

2024-11-07 09:40:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 29 @ 11330 updates
2024-11-07 09:40:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:42:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 09:44:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 29 @ 11330 updates, score 0) (writing took 221.3782702370081 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 09:45:31 - train.py[line:336] - INFO: end of epoch 29 (average epoch stats below)
2024-11-07 09:45:31 - progress_bar.py[line:282] - INFO: epoch 029 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.46 | ntokens 17824.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.5 | wps 2777.4 | ups 0.16 | wpb 17824.9 | bsz 1023 | num_updates 11330 | lr 3.77782e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1543 | gb_free 13.3 | wall 72250
2024-11-07 09:45:31 - trainer.py[line:639] - INFO: loading train data for epoch 30
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 09:48:10 - trainer.py[line:703] - INFO: begin training epoch 30
2024-11-07 09:48:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 09:49:04 - progress_bar.py[line:274] - INFO: epoch 030:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17508.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=358, ups=0.02, wpb=17508.9, bsz=1024, num_updates=11340, lr=3.77646e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72463
2024-11-07 09:49:56 - progress_bar.py[line:274] - INFO: epoch 030:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17975, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3452.2, ups=0.19, wpb=17975, bsz=1024, num_updates=11350, lr=3.7751e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72515
2024-11-07 09:50:48 - progress_bar.py[line:274] - INFO: epoch 030:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17817.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3416.6, ups=0.19, wpb=17817.1, bsz=1024, num_updates=11360, lr=3.77374e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72567
2024-11-07 09:51:41 - progress_bar.py[line:274] - INFO: epoch 030:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17907.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3391.1, ups=0.19, wpb=17907.7, bsz=1024, num_updates=11370, lr=3.77238e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72620
2024-11-07 09:52:33 - progress_bar.py[line:274] - INFO: epoch 030:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17546.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3369, ups=0.19, wpb=17546.3, bsz=1024, num_updates=11380, lr=3.77102e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72672
2024-11-07 09:53:26 - progress_bar.py[line:274] - INFO: epoch 030:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17750.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3399.5, ups=0.19, wpb=17750.5, bsz=1024, num_updates=11390, lr=3.76966e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72724
2024-11-07 09:54:19 - progress_bar.py[line:274] - INFO: epoch 030:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17664.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3315.7, ups=0.19, wpb=17664.4, bsz=1024, num_updates=11400, lr=3.7683e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=72778
2024-11-07 09:55:11 - progress_bar.py[line:274] - INFO: epoch 030:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.457, ntokens=17858.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3395.6, ups=0.19, wpb=17858.1, bsz=1024, num_updates=11410, lr=3.76694e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72830
2024-11-07 09:56:04 - progress_bar.py[line:274] - INFO: epoch 030:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17927.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3420.6, ups=0.19, wpb=17927.8, bsz=1024, num_updates=11420, lr=3.76558e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=72883
2024-11-07 09:56:56 - progress_bar.py[line:274] - INFO: epoch 030:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17741.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3404, ups=0.19, wpb=17741.7, bsz=1024, num_updates=11430, lr=3.76422e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=72935
2024-11-07 09:57:49 - progress_bar.py[line:274] - INFO: epoch 030:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17461.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3285.2, ups=0.19, wpb=17461.5, bsz=1024, num_updates=11440, lr=3.76286e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=72988
2024-11-07 09:58:41 - progress_bar.py[line:274] - INFO: epoch 030:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17672, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3411, ups=0.19, wpb=17672, bsz=1024, num_updates=11450, lr=3.7615e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=73040
2024-11-07 09:59:33 - progress_bar.py[line:274] - INFO: epoch 030:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17322.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3292.8, ups=0.19, wpb=17322.1, bsz=1024, num_updates=11460, lr=3.76013e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=73092
2024-11-07 10:00:26 - progress_bar.py[line:274] - INFO: epoch 030:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17827.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3394.2, ups=0.19, wpb=17827.5, bsz=1024, num_updates=11470, lr=3.75877e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=73145
2024-11-07 10:01:18 - progress_bar.py[line:274] - INFO: epoch 030:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17529.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3361.2, ups=0.19, wpb=17529.5, bsz=1024, num_updates=11480, lr=3.75741e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=73197
2024-11-07 10:02:11 - progress_bar.py[line:274] - INFO: epoch 030:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.411, ntokens=17633.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3318, ups=0.19, wpb=17633.3, bsz=1024, num_updates=11490, lr=3.75605e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=35, gb_free=13.5, wall=73250
2024-11-07 10:03:04 - progress_bar.py[line:274] - INFO: epoch 030:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17604.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3315.4, ups=0.19, wpb=17604.3, bsz=1024, num_updates=11500, lr=3.75469e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=73303
2024-11-07 10:03:57 - progress_bar.py[line:274] - INFO: epoch 030:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17389.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3283.4, ups=0.19, wpb=17389.1, bsz=1024, num_updates=11510, lr=3.75333e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=42, gb_free=13.5, wall=73356
2024-11-07 10:04:51 - progress_bar.py[line:274] - INFO: epoch 030:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17807.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3346.5, ups=0.19, wpb=17807.9, bsz=1024, num_updates=11520, lr=3.75197e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=73409
2024-11-07 10:05:43 - progress_bar.py[line:274] - INFO: epoch 030:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17864.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3410.6, ups=0.19, wpb=17864.4, bsz=1024, num_updates=11530, lr=3.75061e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=73462
2024-11-07 10:06:36 - progress_bar.py[line:274] - INFO: epoch 030:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=18128.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3449, ups=0.19, wpb=18128.8, bsz=1024, num_updates=11540, lr=3.74925e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=73514
2024-11-07 10:07:30 - progress_bar.py[line:274] - INFO: epoch 030:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17542.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3250.3, ups=0.19, wpb=17542.9, bsz=1024, num_updates=11550, lr=3.74789e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=73568
2024-11-07 10:08:22 - progress_bar.py[line:274] - INFO: epoch 030:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17802.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3391.3, ups=0.19, wpb=17802.4, bsz=1024, num_updates=11560, lr=3.74653e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=73621
2024-11-07 10:09:15 - progress_bar.py[line:274] - INFO: epoch 030:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17979.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.4, ups=0.19, wpb=17979.3, bsz=1024, num_updates=11570, lr=3.74517e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=73674
2024-11-07 10:10:07 - progress_bar.py[line:274] - INFO: epoch 030:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17716.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3388.1, ups=0.19, wpb=17716.2, bsz=1024, num_updates=11580, lr=3.74381e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=73726
2024-11-07 10:10:59 - progress_bar.py[line:274] - INFO: epoch 030:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17883, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3428.1, ups=0.19, wpb=17883, bsz=1024, num_updates=11590, lr=3.74245e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=73778
2024-11-07 10:11:52 - progress_bar.py[line:274] - INFO: epoch 030:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=18066.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3442.3, ups=0.19, wpb=18066.2, bsz=1024, num_updates=11600, lr=3.74109e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=46, gb_free=13.6, wall=73831
2024-11-07 10:12:44 - progress_bar.py[line:274] - INFO: epoch 030:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17778.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3394.6, ups=0.19, wpb=17778.7, bsz=1024, num_updates=11610, lr=3.73973e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=73883
2024-11-07 10:13:37 - progress_bar.py[line:274] - INFO: epoch 030:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17760, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3395.4, ups=0.19, wpb=17760, bsz=1024, num_updates=11620, lr=3.73837e-05, gnorm=0.015, clip=0, loss_scale=65536, train_wall=33, gb_free=13.6, wall=73936
2024-11-07 10:14:29 - progress_bar.py[line:274] - INFO: epoch 030:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17715.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3374.4, ups=0.19, wpb=17715.3, bsz=1024, num_updates=11630, lr=3.73701e-05, gnorm=0.016, clip=0, loss_scale=65536, train_wall=33, gb_free=13.2, wall=73988
2024-11-07 10:15:21 - progress_bar.py[line:274] - INFO: epoch 030:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=18595.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3562.8, ups=0.19, wpb=18595.4, bsz=1024, num_updates=11640, lr=3.73565e-05, gnorm=0.014, clip=0, loss_scale=65536, train_wall=45, gb_free=13.4, wall=74040
2024-11-07 10:16:14 - progress_bar.py[line:274] - INFO: epoch 030:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=18435.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3493.2, ups=0.19, wpb=18435.3, bsz=1024, num_updates=11650, lr=3.73429e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=74093
2024-11-07 10:17:06 - progress_bar.py[line:274] - INFO: epoch 030:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3487.2, ups=0.19, wpb=18251.2, bsz=1024, num_updates=11660, lr=3.73293e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=74145
2024-11-07 10:17:59 - progress_bar.py[line:274] - INFO: epoch 030:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17939.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3385.7, ups=0.19, wpb=17939.5, bsz=1024, num_updates=11670, lr=3.73157e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=74198
2024-11-07 10:18:53 - progress_bar.py[line:274] - INFO: epoch 030:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=18537.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3490.2, ups=0.19, wpb=18537.7, bsz=1024, num_updates=11680, lr=3.73021e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=74251
2024-11-07 10:19:45 - progress_bar.py[line:274] - INFO: epoch 030:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=18126.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3470.7, ups=0.19, wpb=18126.2, bsz=1024, num_updates=11690, lr=3.72885e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=74304
2024-11-07 10:20:37 - progress_bar.py[line:274] - INFO: epoch 030:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=18153, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3470, ups=0.19, wpb=18153, bsz=1024, num_updates=11700, lr=3.72749e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=74356
2024-11-07 10:21:30 - progress_bar.py[line:274] - INFO: epoch 030:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=18118.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3434.7, ups=0.19, wpb=18118.7, bsz=1024, num_updates=11710, lr=3.72613e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=74409
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 10:22:22 - progress_bar.py[line:274] - INFO: epoch 030:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=18092, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3494.9, ups=0.19, wpb=18092, bsz=1024, num_updates=11720, lr=3.72476e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=52, gb_free=13.3, wall=74460
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt2024-11-07 10:22:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 30 @ 11721 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-07 10:22:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 10:24:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-07 10:26:05 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 30 @ 11721 updates, score 0) (writing took 221.2052170060051 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 10:26:59 - train.py[line:336] - INFO: end of epoch 30 (average epoch stats below)
2024-11-07 10:26:59 - progress_bar.py[line:282] - INFO: epoch 030 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.461 | ntokens 17839.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.51 | wps 2803.2 | ups 0.16 | wpb 17839.4 | bsz 1023 | num_updates 11721 | lr 3.72463e-05 | gnorm 0.008 | clip 0 | loss_scale 131072 | train_wall 1601 | gb_free 13.4 | wall 74738
2024-11-07 10:26:59 - trainer.py[line:639] - INFO: loading train data for epoch 31
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 10:29:39 - trainer.py[line:703] - INFO: begin training epoch 31
2024-11-07 10:29:39 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 10:30:29 - progress_bar.py[line:274] - INFO: epoch 031:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=16963.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=348.3, ups=0.02, wpb=16963.7, bsz=985.6, num_updates=11730, lr=3.7234e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=29, gb_free=13.5, wall=74948
2024-11-07 10:31:22 - progress_bar.py[line:274] - INFO: epoch 031:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=17615.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3324.8, ups=0.19, wpb=17615.5, bsz=1024, num_updates=11740, lr=3.72204e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75000
2024-11-07 10:32:13 - progress_bar.py[line:274] - INFO: epoch 031:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17741.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3419.9, ups=0.19, wpb=17741.9, bsz=1024, num_updates=11750, lr=3.72068e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=75052
2024-11-07 10:33:06 - progress_bar.py[line:274] - INFO: epoch 031:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=18035.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3460.3, ups=0.19, wpb=18035.1, bsz=1024, num_updates=11760, lr=3.71932e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=75104
2024-11-07 10:33:58 - progress_bar.py[line:274] - INFO: epoch 031:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17580.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3373.4, ups=0.19, wpb=17580.7, bsz=1024, num_updates=11770, lr=3.71796e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75157
2024-11-07 10:34:50 - progress_bar.py[line:274] - INFO: epoch 031:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=17687.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3372.9, ups=0.19, wpb=17687.6, bsz=1024, num_updates=11780, lr=3.7166e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75209
2024-11-07 10:35:27 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 10:35:48 - progress_bar.py[line:274] - INFO: epoch 031:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17693, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3080.6, ups=0.17, wpb=17693, bsz=1024, num_updates=11790, lr=3.71524e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=75266
2024-11-07 10:36:40 - progress_bar.py[line:274] - INFO: epoch 031:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17903.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3413.9, ups=0.19, wpb=17903.6, bsz=1024, num_updates=11800, lr=3.71388e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75319
2024-11-07 10:37:33 - progress_bar.py[line:274] - INFO: epoch 031:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17483, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3331.7, ups=0.19, wpb=17483, bsz=1024, num_updates=11810, lr=3.71252e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75371
2024-11-07 10:38:25 - progress_bar.py[line:274] - INFO: epoch 031:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17808.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3392, ups=0.19, wpb=17808.8, bsz=1024, num_updates=11820, lr=3.71116e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75424
2024-11-07 10:39:17 - progress_bar.py[line:274] - INFO: epoch 031:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17559.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3346.4, ups=0.19, wpb=17559.9, bsz=1024, num_updates=11830, lr=3.7098e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75476
2024-11-07 10:40:10 - progress_bar.py[line:274] - INFO: epoch 031:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.483, ntokens=18054.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3436.3, ups=0.19, wpb=18054.3, bsz=1024, num_updates=11840, lr=3.70844e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75529
2024-11-07 10:41:02 - progress_bar.py[line:274] - INFO: epoch 031:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17210.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3280.4, ups=0.19, wpb=17210.9, bsz=1024, num_updates=11850, lr=3.70708e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=75581
2024-11-07 10:41:55 - progress_bar.py[line:274] - INFO: epoch 031:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17825.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3396.5, ups=0.19, wpb=17825.7, bsz=1024, num_updates=11860, lr=3.70572e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75634
2024-11-07 10:42:48 - progress_bar.py[line:274] - INFO: epoch 031:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17656.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3352.6, ups=0.19, wpb=17656.6, bsz=1024, num_updates=11870, lr=3.70436e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=75687
2024-11-07 10:43:40 - progress_bar.py[line:274] - INFO: epoch 031:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17654.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3390.8, ups=0.19, wpb=17654.4, bsz=1024, num_updates=11880, lr=3.703e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=75739
2024-11-07 10:44:33 - progress_bar.py[line:274] - INFO: epoch 031:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=18158.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3430.5, ups=0.19, wpb=18158.1, bsz=1024, num_updates=11890, lr=3.70164e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=75792
2024-11-07 10:45:25 - progress_bar.py[line:274] - INFO: epoch 031:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17633.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3372.9, ups=0.19, wpb=17633.8, bsz=1024, num_updates=11900, lr=3.70028e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75844
2024-11-07 10:46:18 - progress_bar.py[line:274] - INFO: epoch 031:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17907.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3395, ups=0.19, wpb=17907.3, bsz=1024, num_updates=11910, lr=3.69892e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=75897
2024-11-07 10:47:10 - progress_bar.py[line:274] - INFO: epoch 031:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17973.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3448.8, ups=0.19, wpb=17973.2, bsz=1024, num_updates=11920, lr=3.69756e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=75949
2024-11-07 10:48:02 - progress_bar.py[line:274] - INFO: epoch 031:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17877.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3404.6, ups=0.19, wpb=17877.2, bsz=1024, num_updates=11930, lr=3.6962e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=76001
2024-11-07 10:48:54 - progress_bar.py[line:274] - INFO: epoch 031:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17559.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3364.7, ups=0.19, wpb=17559.7, bsz=1024, num_updates=11940, lr=3.69484e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76053
2024-11-07 10:49:47 - progress_bar.py[line:274] - INFO: epoch 031:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17497.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3335.1, ups=0.19, wpb=17497.6, bsz=1024, num_updates=11950, lr=3.69348e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76106
2024-11-07 10:50:39 - progress_bar.py[line:274] - INFO: epoch 031:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17653.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3380.9, ups=0.19, wpb=17653.1, bsz=1024, num_updates=11960, lr=3.69212e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76158
2024-11-07 10:51:32 - progress_bar.py[line:274] - INFO: epoch 031:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=17593.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3324.4, ups=0.19, wpb=17593.4, bsz=1024, num_updates=11970, lr=3.69075e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76211
2024-11-07 10:52:25 - progress_bar.py[line:274] - INFO: epoch 031:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17668.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3361.6, ups=0.19, wpb=17668.8, bsz=1024, num_updates=11980, lr=3.68939e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76264
2024-11-07 10:53:17 - progress_bar.py[line:274] - INFO: epoch 031:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.41, ntokens=17689.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3355.8, ups=0.19, wpb=17689.1, bsz=1024, num_updates=11990, lr=3.68803e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76316
2024-11-07 10:54:10 - progress_bar.py[line:274] - INFO: epoch 031:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17771, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3373.7, ups=0.19, wpb=17771, bsz=1024, num_updates=12000, lr=3.68667e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76369
2024-11-07 10:55:02 - progress_bar.py[line:274] - INFO: epoch 031:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3402.8, ups=0.19, wpb=17589.3, bsz=1024, num_updates=12010, lr=3.68531e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76421
2024-11-07 10:55:54 - progress_bar.py[line:274] - INFO: epoch 031:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17762.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3425.7, ups=0.19, wpb=17762.1, bsz=1024, num_updates=12020, lr=3.68395e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=35, gb_free=13.1, wall=76472
2024-11-07 10:56:46 - progress_bar.py[line:274] - INFO: epoch 031:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=18367.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3512.9, ups=0.19, wpb=18367.6, bsz=1024, num_updates=12030, lr=3.68259e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.3, wall=76525
2024-11-07 10:57:39 - progress_bar.py[line:274] - INFO: epoch 031:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=18272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3454.8, ups=0.19, wpb=18272.4, bsz=1024, num_updates=12040, lr=3.68123e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76578
2024-11-07 10:58:31 - progress_bar.py[line:274] - INFO: epoch 031:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=18470.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3512.3, ups=0.19, wpb=18470.2, bsz=1024, num_updates=12050, lr=3.67987e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=76630
2024-11-07 10:59:24 - progress_bar.py[line:274] - INFO: epoch 031:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=18340.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3456.4, ups=0.19, wpb=18340.8, bsz=1024, num_updates=12060, lr=3.67851e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76683
2024-11-07 11:00:17 - progress_bar.py[line:274] - INFO: epoch 031:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=18917.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3564.5, ups=0.19, wpb=18917.2, bsz=1024, num_updates=12070, lr=3.67715e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76736
2024-11-07 11:01:10 - progress_bar.py[line:274] - INFO: epoch 031:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=18471.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3506.6, ups=0.19, wpb=18471.1, bsz=1024, num_updates=12080, lr=3.67579e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76789
2024-11-07 11:02:03 - progress_bar.py[line:274] - INFO: epoch 031:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17893.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3414.3, ups=0.19, wpb=17893.1, bsz=1024, num_updates=12090, lr=3.67443e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=76841
2024-11-07 11:02:55 - progress_bar.py[line:274] - INFO: epoch 031:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18096.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3448.7, ups=0.19, wpb=18096.5, bsz=1024, num_updates=12100, lr=3.67307e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76894
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 11:03:47 - progress_bar.py[line:274] - INFO: epoch 031:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=17942.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3424.9, ups=0.19, wpb=17942.9, bsz=1024, num_updates=12110, lr=3.67171e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76946
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-07 11:03:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 31 @ 12111 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-07 11:03:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 11:05:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 11:07:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 31 @ 12111 updates, score 0) (writing took 220.8156002679898 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 11:08:25 - train.py[line:336] - INFO: end of epoch 31 (average epoch stats below)
2024-11-07 11:08:25 - progress_bar.py[line:282] - INFO: epoch 031 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.448 | ntokens 17837.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.46 | wps 2799.2 | ups 0.16 | wpb 17837.8 | bsz 1023 | num_updates 12111 | lr 3.67157e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1383 | gb_free 13.3 | wall 77223
2024-11-07 11:08:25 - trainer.py[line:639] - INFO: loading train data for epoch 32
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 11:11:04 - trainer.py[line:703] - INFO: begin training epoch 32
2024-11-07 11:11:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 11:11:54 - progress_bar.py[line:274] - INFO: epoch 032:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=16796.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=345.5, ups=0.02, wpb=16796.3, bsz=985.6, num_updates=12120, lr=3.67035e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=77432
2024-11-07 11:12:47 - progress_bar.py[line:274] - INFO: epoch 032:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.388, ntokens=17547.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3288.6, ups=0.19, wpb=17547.6, bsz=1024, num_updates=12130, lr=3.66899e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77486
2024-11-07 11:13:39 - progress_bar.py[line:274] - INFO: epoch 032:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3397, ups=0.19, wpb=17660.5, bsz=1024, num_updates=12140, lr=3.66763e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77538
2024-11-07 11:14:32 - progress_bar.py[line:274] - INFO: epoch 032:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17861.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3383.9, ups=0.19, wpb=17861.8, bsz=1024, num_updates=12150, lr=3.66627e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77591
2024-11-07 11:15:24 - progress_bar.py[line:274] - INFO: epoch 032:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.385, ntokens=17492.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3336.5, ups=0.19, wpb=17492.3, bsz=1024, num_updates=12160, lr=3.66491e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77643
2024-11-07 11:16:17 - progress_bar.py[line:274] - INFO: epoch 032:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17610.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3335.4, ups=0.19, wpb=17610.8, bsz=1024, num_updates=12170, lr=3.66355e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77696
2024-11-07 11:17:10 - progress_bar.py[line:274] - INFO: epoch 032:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.394, ntokens=17588.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3309.1, ups=0.19, wpb=17588.2, bsz=1024, num_updates=12180, lr=3.66219e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77749
2024-11-07 11:18:03 - progress_bar.py[line:274] - INFO: epoch 032:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17700.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3371.8, ups=0.19, wpb=17700.3, bsz=1024, num_updates=12190, lr=3.66083e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77801
2024-11-07 11:18:55 - progress_bar.py[line:274] - INFO: epoch 032:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17824.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3389.6, ups=0.19, wpb=17824.1, bsz=1024, num_updates=12200, lr=3.65947e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77854
2024-11-07 11:19:49 - progress_bar.py[line:274] - INFO: epoch 032:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17383.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3251.6, ups=0.19, wpb=17383.3, bsz=1024, num_updates=12210, lr=3.65811e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77908
2024-11-07 11:20:41 - progress_bar.py[line:274] - INFO: epoch 032:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17444.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3327.5, ups=0.19, wpb=17444.9, bsz=1024, num_updates=12220, lr=3.65674e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77960
2024-11-07 11:21:34 - progress_bar.py[line:274] - INFO: epoch 032:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17682.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3338.2, ups=0.19, wpb=17682.8, bsz=1024, num_updates=12230, lr=3.65538e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78013
2024-11-07 11:22:27 - progress_bar.py[line:274] - INFO: epoch 032:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=17337.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3291.8, ups=0.19, wpb=17337.7, bsz=1024, num_updates=12240, lr=3.65402e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78066
2024-11-07 11:23:19 - progress_bar.py[line:274] - INFO: epoch 032:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17761.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3412.2, ups=0.19, wpb=17761.9, bsz=1024, num_updates=12250, lr=3.65266e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78118
2024-11-07 11:24:12 - progress_bar.py[line:274] - INFO: epoch 032:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=17839.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3378.2, ups=0.19, wpb=17839.5, bsz=1024, num_updates=12260, lr=3.6513e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78170
2024-11-07 11:25:04 - progress_bar.py[line:274] - INFO: epoch 032:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17540.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3315.5, ups=0.19, wpb=17540.7, bsz=1024, num_updates=12270, lr=3.64994e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78223
2024-11-07 11:25:57 - progress_bar.py[line:274] - INFO: epoch 032:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.431, ntokens=17937, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3400.7, ups=0.19, wpb=17937, bsz=1024, num_updates=12280, lr=3.64858e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=78276
2024-11-07 11:26:50 - progress_bar.py[line:274] - INFO: epoch 032:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17454.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3297.8, ups=0.19, wpb=17454.4, bsz=1024, num_updates=12290, lr=3.64722e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78329
2024-11-07 11:27:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 11:27:48 - progress_bar.py[line:274] - INFO: epoch 032:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17970, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3110.5, ups=0.17, wpb=17970, bsz=1024, num_updates=12300, lr=3.64586e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=78387
2024-11-07 11:28:41 - progress_bar.py[line:274] - INFO: epoch 032:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.446, ntokens=17964.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3413.2, ups=0.19, wpb=17964.3, bsz=1024, num_updates=12310, lr=3.6445e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78439
2024-11-07 11:29:33 - progress_bar.py[line:274] - INFO: epoch 032:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17876.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3407, ups=0.19, wpb=17876.3, bsz=1024, num_updates=12320, lr=3.64314e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78492
2024-11-07 11:30:25 - progress_bar.py[line:274] - INFO: epoch 032:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17902.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3445.6, ups=0.19, wpb=17902.1, bsz=1024, num_updates=12330, lr=3.64178e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78544
2024-11-07 11:31:18 - progress_bar.py[line:274] - INFO: epoch 032:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.419, ntokens=17641.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3326.2, ups=0.19, wpb=17641.2, bsz=1024, num_updates=12340, lr=3.64042e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=78597
2024-11-07 11:32:10 - progress_bar.py[line:274] - INFO: epoch 032:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17689.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3381, ups=0.19, wpb=17689.8, bsz=1024, num_updates=12350, lr=3.63906e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=78649
2024-11-07 11:33:03 - progress_bar.py[line:274] - INFO: epoch 032:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17330.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3296.5, ups=0.19, wpb=17330.9, bsz=1024, num_updates=12360, lr=3.6377e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=40, gb_free=13.6, wall=78702
2024-11-07 11:33:55 - progress_bar.py[line:274] - INFO: epoch 032:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17867.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3422.8, ups=0.19, wpb=17867.4, bsz=1024, num_updates=12370, lr=3.63634e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=78754
2024-11-07 11:34:47 - progress_bar.py[line:274] - INFO: epoch 032:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=18150.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3471.9, ups=0.19, wpb=18150.8, bsz=1024, num_updates=12380, lr=3.63498e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=78806
2024-11-07 11:35:40 - progress_bar.py[line:274] - INFO: epoch 032:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17897.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3420.6, ups=0.19, wpb=17897.8, bsz=1024, num_updates=12390, lr=3.63362e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.6, wall=78859
2024-11-07 11:36:32 - progress_bar.py[line:274] - INFO: epoch 032:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17552.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3342.1, ups=0.19, wpb=17552.6, bsz=1024, num_updates=12400, lr=3.63226e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=78911
2024-11-07 11:37:25 - progress_bar.py[line:274] - INFO: epoch 032:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17944.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3424.7, ups=0.19, wpb=17944.4, bsz=1024, num_updates=12410, lr=3.6309e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=38, gb_free=13.1, wall=78964
2024-11-07 11:38:17 - progress_bar.py[line:274] - INFO: epoch 032:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=18320.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3504.3, ups=0.19, wpb=18320.9, bsz=1024, num_updates=12420, lr=3.62954e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=79016
2024-11-07 11:39:09 - progress_bar.py[line:274] - INFO: epoch 032:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18238.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3476.2, ups=0.19, wpb=18238.7, bsz=1024, num_updates=12430, lr=3.62818e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=79068
2024-11-07 11:40:02 - progress_bar.py[line:274] - INFO: epoch 032:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=18102, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3447.6, ups=0.19, wpb=18102, bsz=1024, num_updates=12440, lr=3.62682e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=79121
2024-11-07 11:40:55 - progress_bar.py[line:274] - INFO: epoch 032:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18057.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3424.7, ups=0.19, wpb=18057.9, bsz=1024, num_updates=12450, lr=3.62546e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=79174
2024-11-07 11:41:47 - progress_bar.py[line:274] - INFO: epoch 032:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=18681.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3547, ups=0.19, wpb=18681.4, bsz=1024, num_updates=12460, lr=3.6241e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=79226
2024-11-07 11:42:42 - progress_bar.py[line:274] - INFO: epoch 032:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=18267.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3335.5, ups=0.18, wpb=18267.2, bsz=1024, num_updates=12470, lr=3.62273e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=79281
2024-11-07 11:43:37 - progress_bar.py[line:274] - INFO: epoch 032:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=18177.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3339, ups=0.18, wpb=18177.6, bsz=1024, num_updates=12480, lr=3.62137e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.1, wall=79335
2024-11-07 11:44:30 - progress_bar.py[line:274] - INFO: epoch 032:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=18084.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3352.2, ups=0.19, wpb=18084.9, bsz=1024, num_updates=12490, lr=3.62001e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=79389
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 11:45:25 - progress_bar.py[line:274] - INFO: epoch 032:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17953.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3308.9, ups=0.18, wpb=17953.9, bsz=1024, num_updates=12500, lr=3.61865e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=79444
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-07 11:45:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 32 @ 12501 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-07 11:45:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 11:47:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 11:49:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 32 @ 12501 updates, score 0) (writing took 221.09385545700206 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 11:50:03 - train.py[line:336] - INFO: end of epoch 32 (average epoch stats below)
2024-11-07 11:50:03 - progress_bar.py[line:282] - INFO: epoch 032 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.439 | ntokens 17795.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.42 | wps 2777.3 | ups 0.16 | wpb 17795.4 | bsz 1023 | num_updates 12501 | lr 3.61852e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1445 | gb_free 13.4 | wall 79722
2024-11-07 11:50:03 - trainer.py[line:639] - INFO: loading train data for epoch 33
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 11:52:44 - trainer.py[line:703] - INFO: begin training epoch 33
2024-11-07 11:52:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 11:53:33 - progress_bar.py[line:274] - INFO: epoch 033:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=16817.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=344.1, ups=0.02, wpb=16817.7, bsz=985.6, num_updates=12510, lr=3.61729e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=29, gb_free=13.6, wall=79932
2024-11-07 11:54:27 - progress_bar.py[line:274] - INFO: epoch 033:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17924.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3331.2, ups=0.19, wpb=17924.5, bsz=1024, num_updates=12520, lr=3.61593e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=79986
2024-11-07 11:54:50 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 11:55:29 - progress_bar.py[line:274] - INFO: epoch 033:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.405, ntokens=17758.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=2871.3, ups=0.16, wpb=17758.2, bsz=1024, num_updates=12530, lr=3.61457e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=60, gb_free=13.5, wall=80048
2024-11-07 11:56:22 - progress_bar.py[line:274] - INFO: epoch 033:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=18046.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3433.4, ups=0.19, wpb=18046.9, bsz=1024, num_updates=12540, lr=3.61321e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=80101
2024-11-07 11:57:15 - progress_bar.py[line:274] - INFO: epoch 033:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.429, ntokens=17702.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3309.2, ups=0.19, wpb=17702.9, bsz=1024, num_updates=12550, lr=3.61185e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80154
2024-11-07 11:58:07 - progress_bar.py[line:274] - INFO: epoch 033:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=18242.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3488.7, ups=0.19, wpb=18242.5, bsz=1024, num_updates=12560, lr=3.61049e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=80206
2024-11-07 11:59:00 - progress_bar.py[line:274] - INFO: epoch 033:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17737.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3401.2, ups=0.19, wpb=17737.5, bsz=1024, num_updates=12570, lr=3.60913e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=80259
2024-11-07 11:59:52 - progress_bar.py[line:274] - INFO: epoch 033:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17700.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3371, ups=0.19, wpb=17700.6, bsz=1024, num_updates=12580, lr=3.60777e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=80311
2024-11-07 12:00:45 - progress_bar.py[line:274] - INFO: epoch 033:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17847.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3379, ups=0.19, wpb=17847.1, bsz=1024, num_updates=12590, lr=3.60641e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80364
2024-11-07 12:01:37 - progress_bar.py[line:274] - INFO: epoch 033:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17881.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3414.7, ups=0.19, wpb=17881.6, bsz=1024, num_updates=12600, lr=3.60505e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=80416
2024-11-07 12:02:30 - progress_bar.py[line:274] - INFO: epoch 033:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17490.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3329.6, ups=0.19, wpb=17490.3, bsz=1024, num_updates=12610, lr=3.60369e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=80469
2024-11-07 12:03:23 - progress_bar.py[line:274] - INFO: epoch 033:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17797.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3362.4, ups=0.19, wpb=17797.4, bsz=1024, num_updates=12620, lr=3.60233e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80522
2024-11-07 12:04:15 - progress_bar.py[line:274] - INFO: epoch 033:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.387, ntokens=17470.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3351.4, ups=0.19, wpb=17470.8, bsz=1024, num_updates=12630, lr=3.60097e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=80574
2024-11-07 12:05:08 - progress_bar.py[line:274] - INFO: epoch 033:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=18089.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3439.6, ups=0.19, wpb=18089.8, bsz=1024, num_updates=12640, lr=3.59961e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=80626
2024-11-07 12:06:00 - progress_bar.py[line:274] - INFO: epoch 033:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.386, ntokens=17504.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3327.1, ups=0.19, wpb=17504.7, bsz=1024, num_updates=12650, lr=3.59825e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80679
2024-11-07 12:06:53 - progress_bar.py[line:274] - INFO: epoch 033:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.427, ntokens=17852.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3371.1, ups=0.19, wpb=17852.4, bsz=1024, num_updates=12660, lr=3.59689e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80732
2024-11-07 12:07:49 - progress_bar.py[line:274] - INFO: epoch 033:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=17919.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3212.5, ups=0.18, wpb=17919.3, bsz=1024, num_updates=12670, lr=3.59553e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=80788
2024-11-07 12:08:42 - progress_bar.py[line:274] - INFO: epoch 033:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.412, ntokens=17658, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3296.1, ups=0.19, wpb=17658, bsz=1024, num_updates=12680, lr=3.59417e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80841
2024-11-07 12:09:35 - progress_bar.py[line:274] - INFO: epoch 033:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17719.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3345.3, ups=0.19, wpb=17719.9, bsz=1024, num_updates=12690, lr=3.59281e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=80894
2024-11-07 12:10:28 - progress_bar.py[line:274] - INFO: epoch 033:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=18060.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3412.5, ups=0.19, wpb=18060.4, bsz=1024, num_updates=12700, lr=3.59145e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=80947
2024-11-07 12:11:22 - progress_bar.py[line:274] - INFO: epoch 033:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=17881.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3362.4, ups=0.19, wpb=17881.3, bsz=1024, num_updates=12710, lr=3.59009e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=81000
2024-11-07 12:12:15 - progress_bar.py[line:274] - INFO: epoch 033:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.396, ntokens=17712.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3293.9, ups=0.19, wpb=17712.2, bsz=1024, num_updates=12720, lr=3.58873e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=81054
2024-11-07 12:13:09 - progress_bar.py[line:274] - INFO: epoch 033:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17690.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3280.9, ups=0.19, wpb=17690.4, bsz=1024, num_updates=12730, lr=3.58736e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=81108
2024-11-07 12:14:03 - progress_bar.py[line:274] - INFO: epoch 033:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17836.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3302.2, ups=0.19, wpb=17836.1, bsz=1024, num_updates=12740, lr=3.586e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=81162
2024-11-07 12:14:57 - progress_bar.py[line:274] - INFO: epoch 033:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=18040.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3345.7, ups=0.19, wpb=18040.9, bsz=1024, num_updates=12750, lr=3.58464e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=81216
2024-11-07 12:15:51 - progress_bar.py[line:274] - INFO: epoch 033:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.426, ntokens=17773.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3317.7, ups=0.19, wpb=17773.4, bsz=1024, num_updates=12760, lr=3.58328e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=81270
2024-11-07 12:16:44 - progress_bar.py[line:274] - INFO: epoch 033:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17701.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3310.4, ups=0.19, wpb=17701.5, bsz=1024, num_updates=12770, lr=3.58192e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=81323
2024-11-07 12:17:38 - progress_bar.py[line:274] - INFO: epoch 033:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.409, ntokens=17691.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3274.1, ups=0.19, wpb=17691.5, bsz=1024, num_updates=12780, lr=3.58056e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=81377
2024-11-07 12:18:32 - progress_bar.py[line:274] - INFO: epoch 033:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.354, ntokens=17418.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3241.8, ups=0.19, wpb=17418.5, bsz=1024, num_updates=12790, lr=3.5792e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=81431
2024-11-07 12:19:26 - progress_bar.py[line:274] - INFO: epoch 033:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17655.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3289.8, ups=0.19, wpb=17655.5, bsz=1024, num_updates=12800, lr=3.57784e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=81484
2024-11-07 12:20:18 - progress_bar.py[line:274] - INFO: epoch 033:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=18380.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3512.8, ups=0.19, wpb=18380.1, bsz=1024, num_updates=12810, lr=3.57648e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=81537
2024-11-07 12:21:10 - progress_bar.py[line:274] - INFO: epoch 033:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=18380.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3510.1, ups=0.19, wpb=18380.8, bsz=1024, num_updates=12820, lr=3.57512e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=81589
2024-11-07 12:22:03 - progress_bar.py[line:274] - INFO: epoch 033:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18071.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3422, ups=0.19, wpb=18071.2, bsz=1024, num_updates=12830, lr=3.57376e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=81642
2024-11-07 12:22:56 - progress_bar.py[line:274] - INFO: epoch 033:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=18067.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3427.6, ups=0.19, wpb=18067.8, bsz=1024, num_updates=12840, lr=3.5724e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=81695
2024-11-07 12:23:48 - progress_bar.py[line:274] - INFO: epoch 033:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=18678.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3554.6, ups=0.19, wpb=18678.6, bsz=1024, num_updates=12850, lr=3.57104e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=81747
2024-11-07 12:24:41 - progress_bar.py[line:274] - INFO: epoch 033:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17996.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3389.3, ups=0.19, wpb=17996.3, bsz=1024, num_updates=12860, lr=3.56968e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=81800
2024-11-07 12:25:34 - progress_bar.py[line:274] - INFO: epoch 033:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=18022.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3418.4, ups=0.19, wpb=18022.5, bsz=1024, num_updates=12870, lr=3.56832e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=81853
2024-11-07 12:26:27 - progress_bar.py[line:274] - INFO: epoch 033:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=18000.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3397.2, ups=0.19, wpb=18000.4, bsz=1024, num_updates=12880, lr=3.56696e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=81906
reach the end of datafile, start a new reader
2024-11-07 12:27:20 - progress_bar.py[line:274] - INFO: epoch 033:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=17974.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3388.2, ups=0.19, wpb=17974.9, bsz=1024, num_updates=12890, lr=3.5656e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=81959
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt2024-11-07 12:27:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 33 @ 12891 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
2024-11-07 12:27:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 12:29:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
2024-11-07 12:31:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 33 @ 12891 updates, score 0) (writing took 227.77017072497983 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000



slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 12:32:06 - train.py[line:336] - INFO: end of epoch 33 (average epoch stats below)
2024-11-07 12:32:06 - progress_bar.py[line:282] - INFO: epoch 033 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.437 | ntokens 17851.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.41 | wps 2760.2 | ups 0.15 | wpb 17851.6 | bsz 1023 | num_updates 12891 | lr 3.56546e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 2034 | gb_free 13.3 | wall 82245
2024-11-07 12:32:06 - trainer.py[line:639] - INFO: loading train data for epoch 34
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 12:34:49 - trainer.py[line:703] - INFO: begin training epoch 34
2024-11-07 12:34:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 12:35:39 - progress_bar.py[line:274] - INFO: epoch 034:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=16704.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=334.8, ups=0.02, wpb=16704.1, bsz=985.6, num_updates=12900, lr=3.56424e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=29, gb_free=13.5, wall=82458
2024-11-07 12:36:34 - progress_bar.py[line:274] - INFO: epoch 034:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17709.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3218.6, ups=0.18, wpb=17709.1, bsz=1024, num_updates=12910, lr=3.56288e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=38, gb_free=13.5, wall=82513
2024-11-07 12:37:27 - progress_bar.py[line:274] - INFO: epoch 034:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=17685.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3336, ups=0.19, wpb=17685.1, bsz=1024, num_updates=12920, lr=3.56152e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=82566
2024-11-07 12:38:20 - progress_bar.py[line:274] - INFO: epoch 034:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.453, ntokens=18141.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3450.7, ups=0.19, wpb=18141.2, bsz=1024, num_updates=12930, lr=3.56016e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=47, gb_free=13.3, wall=82619
2024-11-07 12:39:13 - progress_bar.py[line:274] - INFO: epoch 034:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=17554.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3269.2, ups=0.19, wpb=17554.9, bsz=1024, num_updates=12940, lr=3.5588e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=48, gb_free=13.6, wall=82672
2024-11-07 12:40:10 - progress_bar.py[line:274] - INFO: epoch 034:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17968.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3160.9, ups=0.18, wpb=17968.9, bsz=1024, num_updates=12950, lr=3.55744e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=82729
2024-11-07 12:41:03 - progress_bar.py[line:274] - INFO: epoch 034:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17933.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3412.3, ups=0.19, wpb=17933.5, bsz=1024, num_updates=12960, lr=3.55608e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=82782
2024-11-07 12:41:59 - progress_bar.py[line:274] - INFO: epoch 034:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17715.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3152.1, ups=0.18, wpb=17715.1, bsz=1024, num_updates=12970, lr=3.55472e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=82838
2024-11-07 12:42:56 - progress_bar.py[line:274] - INFO: epoch 034:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=17465.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3091.3, ups=0.18, wpb=17465.5, bsz=1024, num_updates=12980, lr=3.55335e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=82894
2024-11-07 12:43:52 - progress_bar.py[line:274] - INFO: epoch 034:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.369, ntokens=17546.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3130.7, ups=0.18, wpb=17546.7, bsz=1024, num_updates=12990, lr=3.55199e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=82950
2024-11-07 12:44:48 - progress_bar.py[line:274] - INFO: epoch 034:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17413.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3101, ups=0.18, wpb=17413.6, bsz=1024, num_updates=13000, lr=3.55063e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=83007
2024-11-07 12:45:43 - progress_bar.py[line:274] - INFO: epoch 034:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17632.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3185.3, ups=0.18, wpb=17632.7, bsz=1024, num_updates=13010, lr=3.54927e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=83062
2024-11-07 12:46:38 - progress_bar.py[line:274] - INFO: epoch 034:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17573.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3196.3, ups=0.18, wpb=17573.8, bsz=1024, num_updates=13020, lr=3.54791e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=46, gb_free=13.5, wall=83117
2024-11-07 12:47:32 - progress_bar.py[line:274] - INFO: epoch 034:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17975.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3310.3, ups=0.18, wpb=17975.5, bsz=1024, num_updates=13030, lr=3.54655e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=44, gb_free=13.5, wall=83171
2024-11-07 12:48:25 - progress_bar.py[line:274] - INFO: epoch 034:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.411, ntokens=17750.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3359.2, ups=0.19, wpb=17750.3, bsz=1024, num_updates=13040, lr=3.54519e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=45, gb_free=13.5, wall=83224
2024-11-07 12:49:18 - progress_bar.py[line:274] - INFO: epoch 034:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17720.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3371.1, ups=0.19, wpb=17720.6, bsz=1024, num_updates=13050, lr=3.54383e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=44, gb_free=13.4, wall=83277
2024-11-07 12:50:13 - progress_bar.py[line:274] - INFO: epoch 034:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.354, ntokens=17571.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3167.5, ups=0.18, wpb=17571.7, bsz=1024, num_updates=13060, lr=3.54247e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=83332
2024-11-07 12:51:08 - progress_bar.py[line:274] - INFO: epoch 034:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.332, ntokens=17226.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3123.1, ups=0.18, wpb=17226.8, bsz=1024, num_updates=13070, lr=3.54111e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=83387
2024-11-07 12:52:01 - progress_bar.py[line:274] - INFO: epoch 034:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=18117.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3455.4, ups=0.19, wpb=18117.2, bsz=1024, num_updates=13080, lr=3.53975e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=83440
2024-11-07 12:52:54 - progress_bar.py[line:274] - INFO: epoch 034:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17978.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3396.5, ups=0.19, wpb=17978.3, bsz=1024, num_updates=13090, lr=3.53839e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=83493
2024-11-07 12:53:46 - progress_bar.py[line:274] - INFO: epoch 034:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17892.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3460.8, ups=0.19, wpb=17892.5, bsz=1024, num_updates=13100, lr=3.53703e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=83544
2024-11-07 12:54:38 - progress_bar.py[line:274] - INFO: epoch 034:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17961.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3443.5, ups=0.19, wpb=17961.9, bsz=1024, num_updates=13110, lr=3.53567e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=83597
2024-11-07 12:55:32 - progress_bar.py[line:274] - INFO: epoch 034:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17758.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3245.6, ups=0.18, wpb=17758.9, bsz=1024, num_updates=13120, lr=3.53431e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=83651
2024-11-07 12:56:25 - progress_bar.py[line:274] - INFO: epoch 034:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.357, ntokens=17508.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3302.8, ups=0.19, wpb=17508.8, bsz=1024, num_updates=13130, lr=3.53295e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=50, gb_free=13.4, wall=83704
2024-11-07 12:57:18 - progress_bar.py[line:274] - INFO: epoch 034:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17406, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3298.8, ups=0.19, wpb=17406, bsz=1024, num_updates=13140, lr=3.53159e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=83757
2024-11-07 12:58:11 - progress_bar.py[line:274] - INFO: epoch 034:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.396, ntokens=17783.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3382.9, ups=0.19, wpb=17783.9, bsz=1024, num_updates=13150, lr=3.53023e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.6, wall=83810
2024-11-07 12:59:04 - progress_bar.py[line:274] - INFO: epoch 034:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17875.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3335.1, ups=0.19, wpb=17875.5, bsz=1024, num_updates=13160, lr=3.52887e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=83863
2024-11-07 12:59:57 - progress_bar.py[line:274] - INFO: epoch 034:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17716.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3332.3, ups=0.19, wpb=17716.1, bsz=1024, num_updates=13170, lr=3.52751e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=83916
2024-11-07 13:00:50 - progress_bar.py[line:274] - INFO: epoch 034:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17455.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3342.5, ups=0.19, wpb=17455.4, bsz=1024, num_updates=13180, lr=3.52615e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=83969
2024-11-07 13:01:42 - progress_bar.py[line:274] - INFO: epoch 034:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17881.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3403.2, ups=0.19, wpb=17881.5, bsz=1024, num_updates=13190, lr=3.52479e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=84021
2024-11-07 13:02:35 - progress_bar.py[line:274] - INFO: epoch 034:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=18779.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3592.6, ups=0.19, wpb=18779.2, bsz=1024, num_updates=13200, lr=3.52343e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=84073
2024-11-07 13:03:32 - progress_bar.py[line:274] - INFO: epoch 034:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18113.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3169.2, ups=0.17, wpb=18113.8, bsz=1024, num_updates=13210, lr=3.52207e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=84131
2024-11-07 13:04:24 - progress_bar.py[line:274] - INFO: epoch 034:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=18280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3498.1, ups=0.19, wpb=18280.7, bsz=1024, num_updates=13220, lr=3.52071e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=84183
2024-11-07 13:05:17 - progress_bar.py[line:274] - INFO: epoch 034:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18273.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3474.2, ups=0.19, wpb=18273.6, bsz=1024, num_updates=13230, lr=3.51934e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=84235
2024-11-07 13:06:09 - progress_bar.py[line:274] - INFO: epoch 034:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=18583.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3516.6, ups=0.19, wpb=18583.6, bsz=1024, num_updates=13240, lr=3.51798e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=84288
2024-11-07 13:07:02 - progress_bar.py[line:274] - INFO: epoch 034:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=18417.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3499.5, ups=0.19, wpb=18417.3, bsz=1024, num_updates=13250, lr=3.51662e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=84341
2024-11-07 13:07:55 - progress_bar.py[line:274] - INFO: epoch 034:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=18249, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3442, ups=0.19, wpb=18249, bsz=1024, num_updates=13260, lr=3.51526e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=84394
2024-11-07 13:08:48 - progress_bar.py[line:274] - INFO: epoch 034:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18119.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3420.2, ups=0.19, wpb=18119.4, bsz=1024, num_updates=13270, lr=3.5139e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=84447
2024-11-07 13:09:41 - progress_bar.py[line:274] - INFO: epoch 034:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=17709, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3344.5, ups=0.19, wpb=17709, bsz=1024, num_updates=13280, lr=3.51254e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=84500
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 13:09:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 34 @ 13282 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
2024-11-07 13:09:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

2024-11-07 13:11:41 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 13:13:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 34 @ 13282 updates, score 0) (writing took 226.20932071801508 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 13:14:30 - train.py[line:336] - INFO: end of epoch 34 (average epoch stats below)
2024-11-07 13:14:30 - progress_bar.py[line:282] - INFO: epoch 034 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.422 | ntokens 17829.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.36 | wps 2740.2 | ups 0.15 | wpb 17829.6 | bsz 1023 | num_updates 13282 | lr 3.51227e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1989 | gb_free 13.3 | wall 84789
2024-11-07 13:14:30 - trainer.py[line:639] - INFO: loading train data for epoch 35
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 13:17:14 - trainer.py[line:703] - INFO: begin training epoch 35
2024-11-07 13:17:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 13:17:58 - progress_bar.py[line:274] - INFO: epoch 035:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17172.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=345.4, ups=0.02, wpb=17172.5, bsz=985.6, num_updates=13290, lr=3.51118e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=84997
2024-11-07 13:18:51 - progress_bar.py[line:274] - INFO: epoch 035:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=17661.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3328.2, ups=0.19, wpb=17661.5, bsz=1024, num_updates=13300, lr=3.50982e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=85050
2024-11-07 13:19:44 - progress_bar.py[line:274] - INFO: epoch 035:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.354, ntokens=17361.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3312.9, ups=0.19, wpb=17361.2, bsz=1024, num_updates=13310, lr=3.50846e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=85102
2024-11-07 13:20:39 - progress_bar.py[line:274] - INFO: epoch 035:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17683.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3194, ups=0.18, wpb=17683.2, bsz=1024, num_updates=13320, lr=3.5071e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=85158
2024-11-07 13:21:34 - progress_bar.py[line:274] - INFO: epoch 035:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17821.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3232.5, ups=0.18, wpb=17821.2, bsz=1024, num_updates=13330, lr=3.50574e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=85213
2024-11-07 13:22:26 - progress_bar.py[line:274] - INFO: epoch 035:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.412, ntokens=17989.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3445.5, ups=0.19, wpb=17989.6, bsz=1024, num_updates=13340, lr=3.50438e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=85265
2024-11-07 13:23:18 - progress_bar.py[line:274] - INFO: epoch 035:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17701.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3407.4, ups=0.19, wpb=17701.9, bsz=1024, num_updates=13350, lr=3.50302e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=85317
2024-11-07 13:24:11 - progress_bar.py[line:274] - INFO: epoch 035:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=17882, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3413.4, ups=0.19, wpb=17882, bsz=1024, num_updates=13360, lr=3.50166e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=48, gb_free=13.5, wall=85369
2024-11-07 13:25:03 - progress_bar.py[line:274] - INFO: epoch 035:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17581.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3343.3, ups=0.19, wpb=17581.1, bsz=1024, num_updates=13370, lr=3.5003e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=46, gb_free=13.6, wall=85422
2024-11-07 13:25:56 - progress_bar.py[line:274] - INFO: epoch 035:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=17461.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3333.5, ups=0.19, wpb=17461.5, bsz=1024, num_updates=13380, lr=3.49894e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=85474
2024-11-07 13:26:48 - progress_bar.py[line:274] - INFO: epoch 035:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17567.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3356.8, ups=0.19, wpb=17567.2, bsz=1024, num_updates=13390, lr=3.49758e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=35, gb_free=13.5, wall=85527
2024-11-07 13:27:42 - progress_bar.py[line:274] - INFO: epoch 035:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17625, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3254.6, ups=0.18, wpb=17625, bsz=1024, num_updates=13400, lr=3.49622e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=85581
2024-11-07 13:28:34 - progress_bar.py[line:274] - INFO: epoch 035:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17541.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3346.3, ups=0.19, wpb=17541.7, bsz=1024, num_updates=13410, lr=3.49486e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=85633
2024-11-07 13:29:27 - progress_bar.py[line:274] - INFO: epoch 035:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=17456.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3328, ups=0.19, wpb=17456.1, bsz=1024, num_updates=13420, lr=3.4935e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=50, gb_free=13.5, wall=85686
2024-11-07 13:30:20 - progress_bar.py[line:274] - INFO: epoch 035:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.385, ntokens=17661.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3355.6, ups=0.19, wpb=17661.4, bsz=1024, num_updates=13430, lr=3.49214e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=85738
2024-11-07 13:31:12 - progress_bar.py[line:274] - INFO: epoch 035:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17637.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3361.1, ups=0.19, wpb=17637.8, bsz=1024, num_updates=13440, lr=3.49078e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=85791
2024-11-07 13:32:04 - progress_bar.py[line:274] - INFO: epoch 035:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17857.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3426, ups=0.19, wpb=17857.6, bsz=1024, num_updates=13450, lr=3.48942e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=85843
2024-11-07 13:33:01 - progress_bar.py[line:274] - INFO: epoch 035:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.374, ntokens=17601.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3084.1, ups=0.18, wpb=17601.1, bsz=1024, num_updates=13460, lr=3.48806e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=13.6, wall=85900
2024-11-07 13:33:58 - progress_bar.py[line:274] - INFO: epoch 035:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.405, ntokens=17777.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3144.5, ups=0.18, wpb=17777.2, bsz=1024, num_updates=13470, lr=3.4867e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=85957
2024-11-07 13:34:52 - progress_bar.py[line:274] - INFO: epoch 035:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=17637.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3279.3, ups=0.19, wpb=17637.9, bsz=1024, num_updates=13480, lr=3.48533e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=86010
2024-11-07 13:35:44 - progress_bar.py[line:274] - INFO: epoch 035:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17892.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3408.7, ups=0.19, wpb=17892.4, bsz=1024, num_updates=13490, lr=3.48397e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=86063
2024-11-07 13:36:37 - progress_bar.py[line:274] - INFO: epoch 035:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17476.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3328.1, ups=0.19, wpb=17476.4, bsz=1024, num_updates=13500, lr=3.48261e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=86115
2024-11-07 13:37:31 - progress_bar.py[line:274] - INFO: epoch 035:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17773.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3239.6, ups=0.18, wpb=17773.7, bsz=1024, num_updates=13510, lr=3.48125e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=86170
2024-11-07 13:38:25 - progress_bar.py[line:274] - INFO: epoch 035:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17591.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3289.4, ups=0.19, wpb=17591.3, bsz=1024, num_updates=13520, lr=3.47989e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=86224
2024-11-07 13:39:18 - progress_bar.py[line:274] - INFO: epoch 035:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17389.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3295.7, ups=0.19, wpb=17389.1, bsz=1024, num_updates=13530, lr=3.47853e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=86277
2024-11-07 13:40:10 - progress_bar.py[line:274] - INFO: epoch 035:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17607.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3359.4, ups=0.19, wpb=17607.9, bsz=1024, num_updates=13540, lr=3.47717e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=86329
2024-11-07 13:41:02 - progress_bar.py[line:274] - INFO: epoch 035:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17805, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3416.6, ups=0.19, wpb=17805, bsz=1024, num_updates=13550, lr=3.47581e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=86381
2024-11-07 13:41:57 - progress_bar.py[line:274] - INFO: epoch 035:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17774.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3263.6, ups=0.18, wpb=17774.9, bsz=1024, num_updates=13560, lr=3.47445e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=86436
2024-11-07 13:42:51 - progress_bar.py[line:274] - INFO: epoch 035:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17753.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3290.8, ups=0.19, wpb=17753.2, bsz=1024, num_updates=13570, lr=3.47309e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.6, wall=86490
2024-11-07 13:43:45 - progress_bar.py[line:274] - INFO: epoch 035:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17477.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3218.1, ups=0.18, wpb=17477.7, bsz=1024, num_updates=13580, lr=3.47173e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=86544
2024-11-07 13:44:39 - progress_bar.py[line:274] - INFO: epoch 035:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.489, ntokens=18235.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3382.3, ups=0.19, wpb=18235.8, bsz=1024, num_updates=13590, lr=3.47037e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=54, gb_free=13.2, wall=86598
2024-11-07 13:45:32 - progress_bar.py[line:274] - INFO: epoch 035:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=18628.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3504.1, ups=0.19, wpb=18628.9, bsz=1024, num_updates=13600, lr=3.46901e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86651
2024-11-07 13:46:26 - progress_bar.py[line:274] - INFO: epoch 035:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=18189.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3399.6, ups=0.19, wpb=18189.1, bsz=1024, num_updates=13610, lr=3.46765e-05, gnorm=0.012, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86704
2024-11-07 13:47:19 - progress_bar.py[line:274] - INFO: epoch 035:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=18195.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3384.7, ups=0.19, wpb=18195.8, bsz=1024, num_updates=13620, lr=3.46629e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=86758
2024-11-07 13:48:13 - progress_bar.py[line:274] - INFO: epoch 035:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.501, ntokens=18345.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3413.4, ups=0.19, wpb=18345.3, bsz=1024, num_updates=13630, lr=3.46493e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.2, wall=86812
2024-11-07 13:49:07 - progress_bar.py[line:274] - INFO: epoch 035:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18567, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3471.4, ups=0.19, wpb=18567, bsz=1024, num_updates=13640, lr=3.46357e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=53, gb_free=13.1, wall=86865
2024-11-07 13:50:01 - progress_bar.py[line:274] - INFO: epoch 035:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=18634.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3418.4, ups=0.18, wpb=18634.6, bsz=1024, num_updates=13650, lr=3.46221e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=86920
2024-11-07 13:50:54 - progress_bar.py[line:274] - INFO: epoch 035:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=18409.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3446.9, ups=0.19, wpb=18409.4, bsz=1024, num_updates=13660, lr=3.46085e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86973
2024-11-07 13:51:47 - progress_bar.py[line:274] - INFO: epoch 035:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17964.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3442.6, ups=0.19, wpb=17964.1, bsz=1024, num_updates=13670, lr=3.45949e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=87025
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 13:51:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 35 @ 13673 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
2024-11-07 13:51:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 13:53:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
2024-11-07 13:55:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 35 @ 13673 updates, score 0) (writing took 225.98956410199753 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 13:56:41 - train.py[line:336] - INFO: end of epoch 35 (average epoch stats below)
2024-11-07 13:56:41 - progress_bar.py[line:282] - INFO: epoch 035 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.415 | ntokens 17801.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.33 | wps 2750.4 | ups 0.15 | wpb 17801.8 | bsz 1023 | num_updates 13673 | lr 3.45908e-05 | gnorm 0.009 | clip 0 | loss_scale 131072 | train_wall 1928 | gb_free 13.4 | wall 87319
2024-11-07 13:56:41 - trainer.py[line:639] - INFO: loading train data for epoch 36
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 13:59:23 - trainer.py[line:703] - INFO: begin training epoch 36
2024-11-07 13:59:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 14:00:02 - progress_bar.py[line:274] - INFO: epoch 036:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17165.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=346.3, ups=0.02, wpb=17165.3, bsz=985.6, num_updates=13680, lr=3.45813e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=34, gb_free=13.6, wall=87521
2024-11-07 14:00:55 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 14:01:00 - progress_bar.py[line:274] - INFO: epoch 036:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=18132.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3145.8, ups=0.17, wpb=18132.8, bsz=1024, num_updates=13690, lr=3.45677e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=33, gb_free=13.6, wall=87579
2024-11-07 14:01:53 - progress_bar.py[line:274] - INFO: epoch 036:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.358, ntokens=17519, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3319.2, ups=0.19, wpb=17519, bsz=1024, num_updates=13700, lr=3.45541e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=87632
2024-11-07 14:02:46 - progress_bar.py[line:274] - INFO: epoch 036:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.427, ntokens=17997.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3406.1, ups=0.19, wpb=17997.8, bsz=1024, num_updates=13710, lr=3.45405e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=87685
2024-11-07 14:03:38 - progress_bar.py[line:274] - INFO: epoch 036:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3283.9, ups=0.19, wpb=17345, bsz=1024, num_updates=13720, lr=3.45269e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=87737
2024-11-07 14:04:34 - progress_bar.py[line:274] - INFO: epoch 036:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17776.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3175.1, ups=0.18, wpb=17776.3, bsz=1024, num_updates=13730, lr=3.45133e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=43, gb_free=13.5, wall=87793
2024-11-07 14:05:29 - progress_bar.py[line:274] - INFO: epoch 036:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.378, ntokens=17725.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3261.1, ups=0.18, wpb=17725.7, bsz=1024, num_updates=13740, lr=3.44996e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=87848
2024-11-07 14:06:23 - progress_bar.py[line:274] - INFO: epoch 036:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17647.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3251.7, ups=0.18, wpb=17647.3, bsz=1024, num_updates=13750, lr=3.4486e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=87902
2024-11-07 14:07:17 - progress_bar.py[line:274] - INFO: epoch 036:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=17577.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3282.7, ups=0.19, wpb=17577.4, bsz=1024, num_updates=13760, lr=3.44724e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.6, wall=87955
2024-11-07 14:08:10 - progress_bar.py[line:274] - INFO: epoch 036:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.396, ntokens=17812.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3312.1, ups=0.19, wpb=17812.4, bsz=1024, num_updates=13770, lr=3.44588e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=88009
2024-11-07 14:09:04 - progress_bar.py[line:274] - INFO: epoch 036:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17305.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3238.4, ups=0.19, wpb=17305.2, bsz=1024, num_updates=13780, lr=3.44452e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=88063
2024-11-07 14:09:57 - progress_bar.py[line:274] - INFO: epoch 036:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17619.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3286.8, ups=0.19, wpb=17619.2, bsz=1024, num_updates=13790, lr=3.44316e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=88116
2024-11-07 14:10:51 - progress_bar.py[line:274] - INFO: epoch 036:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.385, ntokens=17615.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3275.9, ups=0.19, wpb=17615.7, bsz=1024, num_updates=13800, lr=3.4418e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=88170
2024-11-07 14:11:45 - progress_bar.py[line:274] - INFO: epoch 036:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17557.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3260.4, ups=0.19, wpb=17557.6, bsz=1024, num_updates=13810, lr=3.44044e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=88224
2024-11-07 14:12:39 - progress_bar.py[line:274] - INFO: epoch 036:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.387, ntokens=17695.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3273, ups=0.18, wpb=17695.3, bsz=1024, num_updates=13820, lr=3.43908e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=88278
2024-11-07 14:13:35 - progress_bar.py[line:274] - INFO: epoch 036:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17413.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3122.5, ups=0.18, wpb=17413.1, bsz=1024, num_updates=13830, lr=3.43772e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=88334
2024-11-07 14:14:31 - progress_bar.py[line:274] - INFO: epoch 036:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17911, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3167.3, ups=0.18, wpb=17911, bsz=1024, num_updates=13840, lr=3.43636e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=88390
2024-11-07 14:15:28 - progress_bar.py[line:274] - INFO: epoch 036:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=17453.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3086.2, ups=0.18, wpb=17453.7, bsz=1024, num_updates=13850, lr=3.435e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=88447
2024-11-07 14:16:24 - progress_bar.py[line:274] - INFO: epoch 036:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17964.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3182.5, ups=0.18, wpb=17964.6, bsz=1024, num_updates=13860, lr=3.43364e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=88503
2024-11-07 14:17:21 - progress_bar.py[line:274] - INFO: epoch 036:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17889.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3178.3, ups=0.18, wpb=17889.4, bsz=1024, num_updates=13870, lr=3.43228e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=88560
2024-11-07 14:18:17 - progress_bar.py[line:274] - INFO: epoch 036:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17948.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3202, ups=0.18, wpb=17948.4, bsz=1024, num_updates=13880, lr=3.43092e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=88616
2024-11-07 14:19:13 - progress_bar.py[line:274] - INFO: epoch 036:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17743, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3169.5, ups=0.18, wpb=17743, bsz=1024, num_updates=13890, lr=3.42956e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=88672
2024-11-07 14:20:08 - progress_bar.py[line:274] - INFO: epoch 036:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.41, ntokens=17918.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3218.4, ups=0.18, wpb=17918.6, bsz=1024, num_updates=13900, lr=3.4282e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=88727
2024-11-07 14:21:04 - progress_bar.py[line:274] - INFO: epoch 036:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17710.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3174.1, ups=0.18, wpb=17710.2, bsz=1024, num_updates=13910, lr=3.42684e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=88783
2024-11-07 14:21:57 - progress_bar.py[line:274] - INFO: epoch 036:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17709.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3345.6, ups=0.19, wpb=17709.9, bsz=1024, num_updates=13920, lr=3.42548e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=88836
2024-11-07 14:22:50 - progress_bar.py[line:274] - INFO: epoch 036:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17898.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3398.8, ups=0.19, wpb=17898.5, bsz=1024, num_updates=13930, lr=3.42412e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=88889
2024-11-07 14:23:42 - progress_bar.py[line:274] - INFO: epoch 036:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=18246.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3497, ups=0.19, wpb=18246.7, bsz=1024, num_updates=13940, lr=3.42276e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=88941
2024-11-07 14:24:34 - progress_bar.py[line:274] - INFO: epoch 036:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.37, ntokens=17596.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3372, ups=0.19, wpb=17596.9, bsz=1024, num_updates=13950, lr=3.4214e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=88993
2024-11-07 14:25:27 - progress_bar.py[line:274] - INFO: epoch 036:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=17513.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3329.5, ups=0.19, wpb=17513.2, bsz=1024, num_updates=13960, lr=3.42004e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.6, wall=89046
2024-11-07 14:26:19 - progress_bar.py[line:274] - INFO: epoch 036:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=18031.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3435.1, ups=0.19, wpb=18031.7, bsz=1024, num_updates=13970, lr=3.41868e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=89098
2024-11-07 14:27:11 - progress_bar.py[line:274] - INFO: epoch 036:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=18160, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3479.8, ups=0.19, wpb=18160, bsz=1024, num_updates=13980, lr=3.41732e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.1, wall=89150
2024-11-07 14:28:04 - progress_bar.py[line:274] - INFO: epoch 036:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=18385.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3514.5, ups=0.19, wpb=18385.1, bsz=1024, num_updates=13990, lr=3.41595e-05, gnorm=0.014, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=89203
2024-11-07 14:28:57 - progress_bar.py[line:274] - INFO: epoch 036:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=18076.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3388.1, ups=0.19, wpb=18076.9, bsz=1024, num_updates=14000, lr=3.41459e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=89256
2024-11-07 14:29:51 - progress_bar.py[line:274] - INFO: epoch 036:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.446, ntokens=18034.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3357.1, ups=0.19, wpb=18034.2, bsz=1024, num_updates=14010, lr=3.41323e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=89310
2024-11-07 14:30:47 - progress_bar.py[line:274] - INFO: epoch 036:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.491, ntokens=18474.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3295, ups=0.18, wpb=18474.9, bsz=1024, num_updates=14020, lr=3.41187e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=89366
2024-11-07 14:31:40 - progress_bar.py[line:274] - INFO: epoch 036:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18227.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3420.5, ups=0.19, wpb=18227.2, bsz=1024, num_updates=14030, lr=3.41051e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.1, wall=89419
2024-11-07 14:32:33 - progress_bar.py[line:274] - INFO: epoch 036:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=18422.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3493.7, ups=0.19, wpb=18422.2, bsz=1024, num_updates=14040, lr=3.40915e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=89472
2024-11-07 14:33:26 - progress_bar.py[line:274] - INFO: epoch 036:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=18407.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3493.1, ups=0.19, wpb=18407.3, bsz=1024, num_updates=14050, lr=3.40779e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=89525
2024-11-07 14:34:18 - progress_bar.py[line:274] - INFO: epoch 036:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18179.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3466.8, ups=0.19, wpb=18179.6, bsz=1024, num_updates=14060, lr=3.40643e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=89577
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 14:34:30 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 36 @ 14063 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt



cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
2024-11-07 14:34:30 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 14:36:24 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 14:38:17 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 36 @ 14063 updates, score 0) (writing took 226.26613454101607 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 14:39:12 - train.py[line:336] - INFO: end of epoch 36 (average epoch stats below)
2024-11-07 14:39:12 - progress_bar.py[line:282] - INFO: epoch 036 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.41 | ntokens 17842.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.32 | wps 2727 | ups 0.15 | wpb 17842.4 | bsz 1023 | num_updates 14063 | lr 3.40602e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1982 | gb_free 13.3 | wall 89871
2024-11-07 14:39:12 - trainer.py[line:639] - INFO: loading train data for epoch 37
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 14:41:56 - trainer.py[line:703] - INFO: begin training epoch 37
2024-11-07 14:41:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 14:42:35 - progress_bar.py[line:274] - INFO: epoch 037:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=16845.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=339.2, ups=0.02, wpb=16845.1, bsz=985.6, num_updates=14070, lr=3.40507e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=34, gb_free=13.6, wall=90074
2024-11-07 14:43:28 - progress_bar.py[line:274] - INFO: epoch 037:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17952.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3398.4, ups=0.19, wpb=17952.1, bsz=1024, num_updates=14080, lr=3.40371e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=90126
2024-11-07 14:44:22 - progress_bar.py[line:274] - INFO: epoch 037:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17703.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3275.5, ups=0.19, wpb=17703.5, bsz=1024, num_updates=14090, lr=3.40235e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=32, gb_free=13.6, wall=90180
2024-11-07 14:45:15 - progress_bar.py[line:274] - INFO: epoch 037:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17895.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3354.1, ups=0.19, wpb=17895.8, bsz=1024, num_updates=14100, lr=3.40099e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=38, gb_free=13.5, wall=90234
2024-11-07 14:46:11 - progress_bar.py[line:274] - INFO: epoch 037:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17625.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3172, ups=0.18, wpb=17625.5, bsz=1024, num_updates=14110, lr=3.39963e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=90289
2024-11-07 14:47:05 - progress_bar.py[line:274] - INFO: epoch 037:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17818.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3243.9, ups=0.18, wpb=17818.7, bsz=1024, num_updates=14120, lr=3.39827e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=90344
2024-11-07 14:48:01 - progress_bar.py[line:274] - INFO: epoch 037:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17695.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3187.9, ups=0.18, wpb=17695.2, bsz=1024, num_updates=14130, lr=3.39691e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=90400
2024-11-07 14:48:56 - progress_bar.py[line:274] - INFO: epoch 037:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17623.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3197.8, ups=0.18, wpb=17623.3, bsz=1024, num_updates=14140, lr=3.39555e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=90455
2024-11-07 14:49:51 - progress_bar.py[line:274] - INFO: epoch 037:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17859.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3238.5, ups=0.18, wpb=17859.5, bsz=1024, num_updates=14150, lr=3.39419e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=90510
2024-11-07 14:50:46 - progress_bar.py[line:274] - INFO: epoch 037:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17590.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3191.6, ups=0.18, wpb=17590.2, bsz=1024, num_updates=14160, lr=3.39283e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=90565
2024-11-07 14:51:41 - progress_bar.py[line:274] - INFO: epoch 037:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=17800.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3271.3, ups=0.18, wpb=17800.9, bsz=1024, num_updates=14170, lr=3.39147e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=90620
2024-11-07 14:52:33 - progress_bar.py[line:274] - INFO: epoch 037:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=17678.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3398.3, ups=0.19, wpb=17678.1, bsz=1024, num_updates=14180, lr=3.39011e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=90672
2024-11-07 14:53:25 - progress_bar.py[line:274] - INFO: epoch 037:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17371.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3303.4, ups=0.19, wpb=17371.8, bsz=1024, num_updates=14190, lr=3.38875e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=90724
2024-11-07 14:54:19 - progress_bar.py[line:274] - INFO: epoch 037:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.36, ntokens=17439.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3254.6, ups=0.19, wpb=17439.7, bsz=1024, num_updates=14200, lr=3.38739e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=90778
2024-11-07 14:55:14 - progress_bar.py[line:274] - INFO: epoch 037:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17701.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3196.4, ups=0.18, wpb=17701.8, bsz=1024, num_updates=14210, lr=3.38603e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=90833
2024-11-07 14:55:20 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 14:56:15 - progress_bar.py[line:274] - INFO: epoch 037:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17476.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=2881.8, ups=0.16, wpb=17476.5, bsz=1024, num_updates=14220, lr=3.38467e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=61, gb_free=13.5, wall=90894
2024-11-07 14:57:11 - progress_bar.py[line:274] - INFO: epoch 037:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=18222.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3263.3, ups=0.18, wpb=18222.4, bsz=1024, num_updates=14230, lr=3.38331e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=90950
2024-11-07 14:58:06 - progress_bar.py[line:274] - INFO: epoch 037:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17506.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3166.4, ups=0.18, wpb=17506.8, bsz=1024, num_updates=14240, lr=3.38194e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=91005
2024-11-07 14:59:01 - progress_bar.py[line:274] - INFO: epoch 037:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17774.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3237.2, ups=0.18, wpb=17774.1, bsz=1024, num_updates=14250, lr=3.38058e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=91060
2024-11-07 14:59:55 - progress_bar.py[line:274] - INFO: epoch 037:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17795.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3291.7, ups=0.18, wpb=17795.2, bsz=1024, num_updates=14260, lr=3.37922e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=91114
2024-11-07 15:00:47 - progress_bar.py[line:274] - INFO: epoch 037:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=18077.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3449.5, ups=0.19, wpb=18077.9, bsz=1024, num_updates=14270, lr=3.37786e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=91166
2024-11-07 15:01:41 - progress_bar.py[line:274] - INFO: epoch 037:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.409, ntokens=17844.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3359.5, ups=0.19, wpb=17844.1, bsz=1024, num_updates=14280, lr=3.3765e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.6, wall=91219
2024-11-07 15:02:35 - progress_bar.py[line:274] - INFO: epoch 037:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17908.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3312, ups=0.18, wpb=17908.7, bsz=1024, num_updates=14290, lr=3.37514e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=91274
2024-11-07 15:03:27 - progress_bar.py[line:274] - INFO: epoch 037:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=17463.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3314.7, ups=0.19, wpb=17463.5, bsz=1024, num_updates=14300, lr=3.37378e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=91326
2024-11-07 15:04:20 - progress_bar.py[line:274] - INFO: epoch 037:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17467.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3335.6, ups=0.19, wpb=17467.4, bsz=1024, num_updates=14310, lr=3.37242e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=91379
2024-11-07 15:05:12 - progress_bar.py[line:274] - INFO: epoch 037:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.392, ntokens=17751, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3381.1, ups=0.19, wpb=17751, bsz=1024, num_updates=14320, lr=3.37106e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=91431
2024-11-07 15:06:05 - progress_bar.py[line:274] - INFO: epoch 037:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17994.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3386.8, ups=0.19, wpb=17994.4, bsz=1024, num_updates=14330, lr=3.3697e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=91484
2024-11-07 15:06:59 - progress_bar.py[line:274] - INFO: epoch 037:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17765.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3314, ups=0.19, wpb=17765.3, bsz=1024, num_updates=14340, lr=3.36834e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=91538
2024-11-07 15:07:53 - progress_bar.py[line:274] - INFO: epoch 037:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17865.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3285.9, ups=0.18, wpb=17865.7, bsz=1024, num_updates=14350, lr=3.36698e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=91592
2024-11-07 15:08:48 - progress_bar.py[line:274] - INFO: epoch 037:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17814.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3262.3, ups=0.18, wpb=17814.8, bsz=1024, num_updates=14360, lr=3.36562e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=91647
2024-11-07 15:09:42 - progress_bar.py[line:274] - INFO: epoch 037:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.489, ntokens=18343.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3400.9, ups=0.19, wpb=18343.6, bsz=1024, num_updates=14370, lr=3.36426e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=91701
2024-11-07 15:10:36 - progress_bar.py[line:274] - INFO: epoch 037:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=18318.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3369.8, ups=0.18, wpb=18318.5, bsz=1024, num_updates=14380, lr=3.3629e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=91755
2024-11-07 15:11:31 - progress_bar.py[line:274] - INFO: epoch 037:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.453, ntokens=17992.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3281.2, ups=0.18, wpb=17992.3, bsz=1024, num_updates=14390, lr=3.36154e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=91810
2024-11-07 15:12:26 - progress_bar.py[line:274] - INFO: epoch 037:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17917.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3280.2, ups=0.18, wpb=17917.6, bsz=1024, num_updates=14400, lr=3.36018e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=91865
2024-11-07 15:13:21 - progress_bar.py[line:274] - INFO: epoch 037:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.505, ntokens=18625.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3354.3, ups=0.18, wpb=18625.2, bsz=1024, num_updates=14410, lr=3.35882e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=91920
2024-11-07 15:14:15 - progress_bar.py[line:274] - INFO: epoch 037:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=18730.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3466.9, ups=0.19, wpb=18730.3, bsz=1024, num_updates=14420, lr=3.35746e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=91974
2024-11-07 15:15:09 - progress_bar.py[line:274] - INFO: epoch 037:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18288.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3421.3, ups=0.19, wpb=18288.2, bsz=1024, num_updates=14430, lr=3.3561e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=92028
2024-11-07 15:16:04 - progress_bar.py[line:274] - INFO: epoch 037:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=18066.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3252.3, ups=0.18, wpb=18066.4, bsz=1024, num_updates=14440, lr=3.35474e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=92083
2024-11-07 15:16:59 - progress_bar.py[line:274] - INFO: epoch 037:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17911, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3242.8, ups=0.18, wpb=17911, bsz=1024, num_updates=14450, lr=3.35338e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=92138
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 15:17:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 37 @ 14453 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
2024-11-07 15:17:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 15:19:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-07 15:21:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 37 @ 14453 updates, score 0) (writing took 227.07341592301964 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
2024-11-07 15:21:55 - train.py[line:336] - INFO: end of epoch 37 (average epoch stats below)
2024-11-07 15:21:55 - progress_bar.py[line:282] - INFO: epoch 037 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.414 | ntokens 17831.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.33 | wps 2713.5 | ups 0.15 | wpb 17831.4 | bsz 1023 | num_updates 14453 | lr 3.35297e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 2035 | gb_free 13.3 | wall 92434
2024-11-07 15:21:55 - trainer.py[line:639] - INFO: loading train data for epoch 38
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 15:24:39 - trainer.py[line:703] - INFO: begin training epoch 38
2024-11-07 15:24:39 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 15:25:18 - progress_bar.py[line:274] - INFO: epoch 038:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.388, ntokens=17034.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=341.8, ups=0.02, wpb=17034.1, bsz=985.6, num_updates=14460, lr=3.35202e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=92637
2024-11-07 15:26:11 - progress_bar.py[line:274] - INFO: epoch 038:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.371, ntokens=17586.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3304.3, ups=0.19, wpb=17586.1, bsz=1024, num_updates=14470, lr=3.35066e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=92690
2024-11-07 15:27:06 - progress_bar.py[line:274] - INFO: epoch 038:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17640.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3233, ups=0.18, wpb=17640.9, bsz=1024, num_updates=14480, lr=3.3493e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=92745
2024-11-07 15:27:50 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 15:28:06 - progress_bar.py[line:274] - INFO: epoch 038:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17930.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=2972.8, ups=0.17, wpb=17930.6, bsz=1024, num_updates=14490, lr=3.34793e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=60, gb_free=13.5, wall=92805
2024-11-07 15:28:59 - progress_bar.py[line:274] - INFO: epoch 038:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17647.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3330.7, ups=0.19, wpb=17647.4, bsz=1024, num_updates=14500, lr=3.34657e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=92858
2024-11-07 15:29:52 - progress_bar.py[line:274] - INFO: epoch 038:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17951.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3410.7, ups=0.19, wpb=17951.1, bsz=1024, num_updates=14510, lr=3.34521e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=92910
2024-11-07 15:30:44 - progress_bar.py[line:274] - INFO: epoch 038:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17813, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3406.1, ups=0.19, wpb=17813, bsz=1024, num_updates=14520, lr=3.34385e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=92963
2024-11-07 15:31:37 - progress_bar.py[line:274] - INFO: epoch 038:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17431.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3303.1, ups=0.19, wpb=17431.4, bsz=1024, num_updates=14530, lr=3.34249e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=93016
2024-11-07 15:32:29 - progress_bar.py[line:274] - INFO: epoch 038:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.367, ntokens=17672.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3373.3, ups=0.19, wpb=17672.4, bsz=1024, num_updates=14540, lr=3.34113e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=93068
2024-11-07 15:33:22 - progress_bar.py[line:274] - INFO: epoch 038:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17588.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3323.7, ups=0.19, wpb=17588.5, bsz=1024, num_updates=14550, lr=3.33977e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=93121
2024-11-07 15:34:14 - progress_bar.py[line:274] - INFO: epoch 038:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17620.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3356.1, ups=0.19, wpb=17620.9, bsz=1024, num_updates=14560, lr=3.33841e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=93173
2024-11-07 15:35:10 - progress_bar.py[line:274] - INFO: epoch 038:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17988.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3232.6, ups=0.18, wpb=17988.4, bsz=1024, num_updates=14570, lr=3.33705e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=93229
2024-11-07 15:36:02 - progress_bar.py[line:274] - INFO: epoch 038:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17458.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3334.1, ups=0.19, wpb=17458.2, bsz=1024, num_updates=14580, lr=3.33569e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=93281
2024-11-07 15:36:59 - progress_bar.py[line:274] - INFO: epoch 038:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.358, ntokens=17409.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3105.4, ups=0.18, wpb=17409.5, bsz=1024, num_updates=14590, lr=3.33433e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=93337
2024-11-07 15:37:51 - progress_bar.py[line:274] - INFO: epoch 038:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17854.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3382.9, ups=0.19, wpb=17854.4, bsz=1024, num_updates=14600, lr=3.33297e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=93390
2024-11-07 15:38:45 - progress_bar.py[line:274] - INFO: epoch 038:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.367, ntokens=17696.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3306.6, ups=0.19, wpb=17696.1, bsz=1024, num_updates=14610, lr=3.33161e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=93444
2024-11-07 15:39:37 - progress_bar.py[line:274] - INFO: epoch 038:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.334, ntokens=17509.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3342.7, ups=0.19, wpb=17509.5, bsz=1024, num_updates=14620, lr=3.33025e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=93496
2024-11-07 15:40:29 - progress_bar.py[line:274] - INFO: epoch 038:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.386, ntokens=17718, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3394.2, ups=0.19, wpb=17718, bsz=1024, num_updates=14630, lr=3.32889e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=93548
2024-11-07 15:41:22 - progress_bar.py[line:274] - INFO: epoch 038:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=17666.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3369.1, ups=0.19, wpb=17666.1, bsz=1024, num_updates=14640, lr=3.32753e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=93601
2024-11-07 15:42:14 - progress_bar.py[line:274] - INFO: epoch 038:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17675.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3401.5, ups=0.19, wpb=17675.1, bsz=1024, num_updates=14650, lr=3.32617e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=93653
2024-11-07 15:43:06 - progress_bar.py[line:274] - INFO: epoch 038:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.41, ntokens=18029.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3426.4, ups=0.19, wpb=18029.5, bsz=1024, num_updates=14660, lr=3.32481e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=93705
2024-11-07 15:43:58 - progress_bar.py[line:274] - INFO: epoch 038:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17934, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3446.3, ups=0.19, wpb=17934, bsz=1024, num_updates=14670, lr=3.32345e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=93757
2024-11-07 15:44:51 - progress_bar.py[line:274] - INFO: epoch 038:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.412, ntokens=17860.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3415.8, ups=0.19, wpb=17860.9, bsz=1024, num_updates=14680, lr=3.32209e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=93810
2024-11-07 15:45:43 - progress_bar.py[line:274] - INFO: epoch 038:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.335, ntokens=17480.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3342.5, ups=0.19, wpb=17480.7, bsz=1024, num_updates=14690, lr=3.32073e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=93862
2024-11-07 15:46:35 - progress_bar.py[line:274] - INFO: epoch 038:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17829, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3418.5, ups=0.19, wpb=17829, bsz=1024, num_updates=14700, lr=3.31937e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=93914
2024-11-07 15:47:28 - progress_bar.py[line:274] - INFO: epoch 038:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.357, ntokens=17528.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3335.8, ups=0.19, wpb=17528.7, bsz=1024, num_updates=14710, lr=3.31801e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.6, wall=93967
2024-11-07 15:48:21 - progress_bar.py[line:274] - INFO: epoch 038:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=18305.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3467.4, ups=0.19, wpb=18305.6, bsz=1024, num_updates=14720, lr=3.31665e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=47, gb_free=13.4, wall=94019
2024-11-07 15:49:13 - progress_bar.py[line:274] - INFO: epoch 038:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17638.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3360.4, ups=0.19, wpb=17638.9, bsz=1024, num_updates=14730, lr=3.31529e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=94072
2024-11-07 15:50:06 - progress_bar.py[line:274] - INFO: epoch 038:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.369, ntokens=17707.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3363.8, ups=0.19, wpb=17707.9, bsz=1024, num_updates=14740, lr=3.31393e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=39, gb_free=13.6, wall=94125
2024-11-07 15:51:01 - progress_bar.py[line:274] - INFO: epoch 038:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17788.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3241, ups=0.18, wpb=17788.8, bsz=1024, num_updates=14750, lr=3.31256e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=94179
2024-11-07 15:51:55 - progress_bar.py[line:274] - INFO: epoch 038:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18114.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3305.2, ups=0.18, wpb=18114.7, bsz=1024, num_updates=14760, lr=3.3112e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=51, gb_free=13.1, wall=94234
2024-11-07 15:52:50 - progress_bar.py[line:274] - INFO: epoch 038:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=18703.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3424.7, ups=0.18, wpb=18703.1, bsz=1024, num_updates=14770, lr=3.30984e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=94289
2024-11-07 15:53:44 - progress_bar.py[line:274] - INFO: epoch 038:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=18160.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3379.5, ups=0.19, wpb=18160.6, bsz=1024, num_updates=14780, lr=3.30848e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=94343
2024-11-07 15:54:37 - progress_bar.py[line:274] - INFO: epoch 038:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.507, ntokens=18230.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3403.7, ups=0.19, wpb=18230.7, bsz=1024, num_updates=14790, lr=3.30712e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=94396
2024-11-07 15:55:31 - progress_bar.py[line:274] - INFO: epoch 038:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.487, ntokens=18258.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3396.9, ups=0.19, wpb=18258.2, bsz=1024, num_updates=14800, lr=3.30576e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=94450
2024-11-07 15:56:25 - progress_bar.py[line:274] - INFO: epoch 038:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18153.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3348.4, ups=0.18, wpb=18153.5, bsz=1024, num_updates=14810, lr=3.3044e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=94504
2024-11-07 15:57:18 - progress_bar.py[line:274] - INFO: epoch 038:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18007.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3399.9, ups=0.19, wpb=18007.9, bsz=1024, num_updates=14820, lr=3.30304e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=94557
2024-11-07 15:58:11 - progress_bar.py[line:274] - INFO: epoch 038:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=18469.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3490.3, ups=0.19, wpb=18469.6, bsz=1024, num_updates=14830, lr=3.30168e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=94610
2024-11-07 15:59:04 - progress_bar.py[line:274] - INFO: epoch 038:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18012.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3411.2, ups=0.19, wpb=18012.9, bsz=1024, num_updates=14840, lr=3.30032e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=94663
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 15:59:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 38 @ 14843 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt2024-11-07 15:59:16 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt

cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 16:01:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-07 16:03:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 38 @ 14843 updates, score 0) (writing took 226.8207363320107 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-07 16:03:59 - train.py[line:336] - INFO: end of epoch 38 (average epoch stats below)
2024-11-07 16:03:59 - progress_bar.py[line:282] - INFO: epoch 038 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.411 | ntokens 17822.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.32 | wps 2754 | ups 0.15 | wpb 17822.3 | bsz 1023 | num_updates 14843 | lr 3.29991e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1972 | gb_free 13.4 | wall 94958
2024-11-07 16:03:59 - trainer.py[line:639] - INFO: loading train data for epoch 39
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 16:06:42 - trainer.py[line:703] - INFO: begin training epoch 39
2024-11-07 16:06:42 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 16:07:21 - progress_bar.py[line:274] - INFO: epoch 039:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.372, ntokens=16841.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=338.8, ups=0.02, wpb=16841.4, bsz=985.6, num_updates=14850, lr=3.29896e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.6, wall=95160
2024-11-07 16:08:14 - progress_bar.py[line:274] - INFO: epoch 039:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17862.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3384.1, ups=0.19, wpb=17862.7, bsz=1024, num_updates=14860, lr=3.2976e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=95213
2024-11-07 16:09:10 - progress_bar.py[line:274] - INFO: epoch 039:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17693.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3167.5, ups=0.18, wpb=17693.6, bsz=1024, num_updates=14870, lr=3.29624e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=41, gb_free=13.6, wall=95269
2024-11-07 16:10:07 - progress_bar.py[line:274] - INFO: epoch 039:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17718.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3109.9, ups=0.18, wpb=17718.1, bsz=1024, num_updates=14880, lr=3.29488e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=95326
2024-11-07 16:11:01 - progress_bar.py[line:274] - INFO: epoch 039:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.396, ntokens=17789.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3284.2, ups=0.18, wpb=17789.6, bsz=1024, num_updates=14890, lr=3.29352e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=95380
2024-11-07 16:11:53 - progress_bar.py[line:274] - INFO: epoch 039:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17808.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3398.8, ups=0.19, wpb=17808.8, bsz=1024, num_updates=14900, lr=3.29216e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=95432
2024-11-07 16:12:48 - progress_bar.py[line:274] - INFO: epoch 039:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17758, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3217.8, ups=0.18, wpb=17758, bsz=1024, num_updates=14910, lr=3.2908e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=95487
2024-11-07 16:13:41 - progress_bar.py[line:274] - INFO: epoch 039:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.372, ntokens=17545.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3350.4, ups=0.19, wpb=17545.2, bsz=1024, num_updates=14920, lr=3.28944e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=95540
2024-11-07 16:14:33 - progress_bar.py[line:274] - INFO: epoch 039:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=18097.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3439.9, ups=0.19, wpb=18097.7, bsz=1024, num_updates=14930, lr=3.28808e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=95592
2024-11-07 16:15:28 - progress_bar.py[line:274] - INFO: epoch 039:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17655.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3203.3, ups=0.18, wpb=17655.7, bsz=1024, num_updates=14940, lr=3.28672e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=95647
2024-11-07 16:16:26 - progress_bar.py[line:274] - INFO: epoch 039:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=17563.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3070.5, ups=0.17, wpb=17563.1, bsz=1024, num_updates=14950, lr=3.28536e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=95705
2024-11-07 16:17:18 - progress_bar.py[line:274] - INFO: epoch 039:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17578.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3333.2, ups=0.19, wpb=17578.7, bsz=1024, num_updates=14960, lr=3.284e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=95757
2024-11-07 16:18:12 - progress_bar.py[line:274] - INFO: epoch 039:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=17581.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3277.3, ups=0.19, wpb=17581.2, bsz=1024, num_updates=14970, lr=3.28264e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=95811
2024-11-07 16:19:06 - progress_bar.py[line:274] - INFO: epoch 039:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17325, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3223.9, ups=0.19, wpb=17325, bsz=1024, num_updates=14980, lr=3.28128e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=95865
2024-11-07 16:20:00 - progress_bar.py[line:274] - INFO: epoch 039:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17533.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3206.4, ups=0.18, wpb=17533.3, bsz=1024, num_updates=14990, lr=3.27992e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=95919
2024-11-07 16:20:57 - progress_bar.py[line:274] - INFO: epoch 039:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.372, ntokens=17621.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3132.5, ups=0.18, wpb=17621.6, bsz=1024, num_updates=15000, lr=3.27855e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=95976
loss_reg: 0.01507788311751073 loss_cls: 0.004176454618573189
loss_reg: 0.014246807131426786 loss_cls: 0.003913513384759426
loss_reg: 0.016687370201535455 loss_cls: 0.0033487342298030853
loss_reg: 0.01772418116476067 loss_cls: 0.003073811298236251
loss_reg: 0.011345361735425196 loss_cls: 0.003295126836746931
loss_reg: 0.01892782630052511 loss_cls: 0.003607316641137004
loss_reg: 0.005826757245484926 loss_cls: 0.0029110093601047993
loss_reg: 0.010349666623818646 loss_cls: 0.0037099227774888277
loss_reg: 0.010927847076198741 loss_cls: 0.004093587398529053
loss_reg: 0.011346103175323773 loss_cls: 0.00345211592502892
loss_reg: 0.015567799892778804 loss_cls: 0.00309220002964139
loss_reg: 0.016275087637453226 loss_cls: 0.003924389835447073
loss_reg: 0.02012592003614956 loss_cls: 0.0041727712377905846
loss_reg: 0.003059962028507627 loss_cls: 0.002892343560233712
loss_reg: 0.010212108586844317 loss_cls: 0.004062409047037363
loss_reg: 0.013413949095016035 loss_cls: 0.0031279949471354485
loss_reg: 0.016184275352782652 loss_cls: 0.004290913697332144
loss_reg: 0.014935034907493662 loss_cls: 0.005751121789216995
loss_reg: 0.014088475830345316 loss_cls: 0.00419300002977252
loss_reg: 0.0160237292179306 loss_cls: 0.00430971197783947
loss_reg: 0.0069413751236936955 loss_cls: 0.002194585744291544
loss_reg: 0.013376500336687188 loss_cls: 0.003955880180001259
loss_reg: 0.012084312400256631 loss_cls: 0.0034131519496440887
loss_reg: 0.016272322090906673 loss_cls: 0.003959736321121454
loss_reg: 0.013024011014118824 loss_cls: 0.003035469213500619
loss_reg: 0.019788675150273462 loss_cls: 0.003865007311105728
loss_reg: 0.025791693152634455 loss_cls: 0.00404301006346941
loss_reg: 0.0031750657906735045 loss_cls: 0.0025183544494211674
loss_reg: 0.020561633556713258 loss_cls: 0.004118986427783966
loss_reg: 0.022488306389563107 loss_cls: 0.005318303592503071
loss_reg: 0.007608446756316694 loss_cls: 0.004258285276591778
loss_reg: 0.013955294639949479 loss_cls: 0.004562116228044033
loss_reg: 0.010657466732439764 loss_cls: 0.004067626781761646
loss_reg: 0.013533236419899054 loss_cls: 0.0030067346524447203
loss_reg: 0.0047006808575245935 loss_cls: 0.0035496545024216175
loss_reg: 0.01676805467374551 loss_cls: 0.0033059357665479183
loss_reg: 0.018529971925242077 loss_cls: 0.0028797914274036884
loss_reg: 0.01988309293536468 loss_cls: 0.0034690117463469505
loss_reg: 0.016957213072956594 loss_cls: 0.003086608834564686
loss_reg: 0.021554448966158837 loss_cls: 0.003441809443756938
loss_reg: 0.0025330536602249216 loss_cls: 0.0025764729361981153
loss_reg: 0.01291959695142113 loss_cls: 0.0030147871002554893
loss_reg: 0.01622530846214027 loss_cls: 0.004235557746142149
loss_reg: 0.014214300372667545 loss_cls: 0.002484310884028673
loss_reg: 0.01641337017256181 loss_cls: 0.003498821286484599
loss_reg: 0.012067367676739115 loss_cls: 0.0032041335944086313
loss_reg: 0.013533526960109819 loss_cls: 0.003339215414598584
loss_reg: 0.000929648172269437 loss_cls: 0.0023343111388385296
loss_reg: 0.012823205808798189 loss_cls: 0.003349579405039549
loss_reg: 0.018038927838877027 loss_cls: 0.003807229222729802
loss_reg: 0.017664189387193673 loss_cls: 0.003754377132281661
loss_reg: 0.01760378327640076 loss_cls: 0.004871798679232597
loss_reg: 0.010350865421572868 loss_cls: 0.00396283995360136
loss_reg: 0.019922235419441336 loss_cls: 0.00428563728928566
loss_reg: 0.018147650989589804 loss_cls: 0.006674137432128191
loss_reg: 0.002566074345748878 loss_cls: 0.003101466689258814
loss_reg: 0.021328483133204405 loss_cls: 0.002646398264914751
loss_reg: 0.01066116491960331 loss_cls: 0.0034269297029823065
loss_reg: 0.019323498310898794 loss_cls: 0.005349812563508749
loss_reg: 0.018537766313136896 loss_cls: 0.0030984655022621155
loss_reg: 0.02105146884798912 loss_cls: 0.003174996003508568
loss_reg: 0.015180837078787496 loss_cls: 0.0027768295258283615
loss_reg: 0.017796319149496982 loss_cls: 0.004366948269307613
loss_reg: 0.0172311229091199 loss_cls: 0.004784496035426855
2024-11-07 16:21:54 - progress_bar.py[line:274] - INFO: epoch 039:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.369, ntokens=17796.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3133.7, ups=0.18, wpb=17796.2, bsz=1024, num_updates=15010, lr=3.27719e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=96032
2024-11-07 16:22:50 - progress_bar.py[line:274] - INFO: epoch 039:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.311, ntokens=17267.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3072.3, ups=0.18, wpb=17267.7, bsz=1024, num_updates=15020, lr=3.27583e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=96089
2024-11-07 16:23:45 - progress_bar.py[line:274] - INFO: epoch 039:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17661.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3175.9, ups=0.18, wpb=17661.7, bsz=1024, num_updates=15030, lr=3.27447e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=96144
2024-11-07 16:24:42 - progress_bar.py[line:274] - INFO: epoch 039:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17764, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3161, ups=0.18, wpb=17764, bsz=1024, num_updates=15040, lr=3.27311e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=96200
2024-11-07 16:25:37 - progress_bar.py[line:274] - INFO: epoch 039:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=18128.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3243.7, ups=0.18, wpb=18128.1, bsz=1024, num_updates=15050, lr=3.27175e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=96256
2024-11-07 16:26:34 - progress_bar.py[line:274] - INFO: epoch 039:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17759.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3163.5, ups=0.18, wpb=17759.2, bsz=1024, num_updates=15060, lr=3.27039e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=96312
2024-11-07 16:27:28 - progress_bar.py[line:274] - INFO: epoch 039:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.419, ntokens=18029.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3293.6, ups=0.18, wpb=18029.3, bsz=1024, num_updates=15070, lr=3.26903e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=96367
2024-11-07 16:28:21 - progress_bar.py[line:274] - INFO: epoch 039:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17546.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3308, ups=0.19, wpb=17546.6, bsz=1024, num_updates=15080, lr=3.26767e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.6, wall=96420
2024-11-07 16:29:16 - progress_bar.py[line:274] - INFO: epoch 039:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17787.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3273.5, ups=0.18, wpb=17787.1, bsz=1024, num_updates=15090, lr=3.26631e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=96475
2024-11-07 16:30:10 - progress_bar.py[line:274] - INFO: epoch 039:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17987.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3337.5, ups=0.19, wpb=17987.7, bsz=1024, num_updates=15100, lr=3.26495e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=96528
2024-11-07 16:31:05 - progress_bar.py[line:274] - INFO: epoch 039:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.392, ntokens=18063.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3238.9, ups=0.18, wpb=18063.9, bsz=1024, num_updates=15110, lr=3.26359e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=96584
2024-11-07 16:32:01 - progress_bar.py[line:274] - INFO: epoch 039:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.357, ntokens=17670.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3167.2, ups=0.18, wpb=17670.2, bsz=1024, num_updates=15120, lr=3.26223e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=96640
2024-11-07 16:32:56 - progress_bar.py[line:274] - INFO: epoch 039:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.368, ntokens=17714.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3246.4, ups=0.18, wpb=17714.8, bsz=1024, num_updates=15130, lr=3.26087e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=96695
2024-11-07 16:33:51 - progress_bar.py[line:274] - INFO: epoch 039:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17807.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3215.5, ups=0.18, wpb=17807.9, bsz=1024, num_updates=15140, lr=3.25951e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=96750
2024-11-07 16:34:48 - progress_bar.py[line:274] - INFO: epoch 039:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=18550.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3257.7, ups=0.18, wpb=18550.6, bsz=1024, num_updates=15150, lr=3.25815e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=96807
2024-11-07 16:35:45 - progress_bar.py[line:274] - INFO: epoch 039:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=18762.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3314.8, ups=0.18, wpb=18762.2, bsz=1024, num_updates=15160, lr=3.25679e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=96864
2024-11-07 16:36:41 - progress_bar.py[line:274] - INFO: epoch 039:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18182.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3198.3, ups=0.18, wpb=18182.5, bsz=1024, num_updates=15170, lr=3.25543e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=96920
2024-11-07 16:37:38 - progress_bar.py[line:274] - INFO: epoch 039:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=18009, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3201.5, ups=0.18, wpb=18009, bsz=1024, num_updates=15180, lr=3.25407e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=96977
2024-11-07 16:38:33 - progress_bar.py[line:274] - INFO: epoch 039:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=18178.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3279.6, ups=0.18, wpb=18178.6, bsz=1024, num_updates=15190, lr=3.25271e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=97032
2024-11-07 16:39:17 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 16:39:33 - progress_bar.py[line:274] - INFO: epoch 039:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=18056.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3000.5, ups=0.17, wpb=18056.2, bsz=1024, num_updates=15200, lr=3.25135e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=60, gb_free=13.2, wall=97092
2024-11-07 16:40:26 - progress_bar.py[line:274] - INFO: epoch 039:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=18260.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3473.1, ups=0.19, wpb=18260.4, bsz=1024, num_updates=15210, lr=3.24999e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=97145
2024-11-07 16:41:18 - progress_bar.py[line:274] - INFO: epoch 039:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=18087.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3453.8, ups=0.19, wpb=18087.3, bsz=1024, num_updates=15220, lr=3.24863e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=97197
2024-11-07 16:42:13 - progress_bar.py[line:274] - INFO: epoch 039:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17738.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3238.5, ups=0.18, wpb=17738.9, bsz=1024, num_updates=15230, lr=3.24727e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=97252
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 16:42:26 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 39 @ 15233 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
2024-11-07 16:42:26 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 16:44:17 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-07 16:46:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 39 @ 15233 updates, score 0) (writing took 225.7772100440052 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 16:47:08 - train.py[line:336] - INFO: end of epoch 39 (average epoch stats below)
2024-11-07 16:47:08 - progress_bar.py[line:282] - INFO: epoch 039 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.401 | ntokens 17821 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.28 | wps 2684.9 | ups 0.15 | wpb 17821 | bsz 1023 | num_updates 15233 | lr 3.24686e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 2086 | gb_free 13.3 | wall 97547
2024-11-07 16:47:08 - trainer.py[line:639] - INFO: loading train data for epoch 40
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 16:49:51 - trainer.py[line:703] - INFO: begin training epoch 40
2024-11-07 16:49:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 16:50:30 - progress_bar.py[line:274] - INFO: epoch 040:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=17253.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=347.1, ups=0.02, wpb=17253.3, bsz=985.6, num_updates=15240, lr=3.24591e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=97749
2024-11-07 16:51:23 - progress_bar.py[line:274] - INFO: epoch 040:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.427, ntokens=18156.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3466.8, ups=0.19, wpb=18156.3, bsz=1024, num_updates=15250, lr=3.24454e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=97801
2024-11-07 16:52:15 - progress_bar.py[line:274] - INFO: epoch 040:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17576.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3346.1, ups=0.19, wpb=17576.4, bsz=1024, num_updates=15260, lr=3.24318e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=97854
2024-11-07 16:53:08 - progress_bar.py[line:274] - INFO: epoch 040:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17878.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3401.8, ups=0.19, wpb=17878.1, bsz=1024, num_updates=15270, lr=3.24182e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=97907
2024-11-07 16:54:02 - progress_bar.py[line:274] - INFO: epoch 040:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.345, ntokens=17613.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3235, ups=0.18, wpb=17613.4, bsz=1024, num_updates=15280, lr=3.24046e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=97961
2024-11-07 16:54:54 - progress_bar.py[line:274] - INFO: epoch 040:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.345, ntokens=17630.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3389.2, ups=0.19, wpb=17630.8, bsz=1024, num_updates=15290, lr=3.2391e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=35, gb_free=13.5, wall=98013
2024-11-07 16:55:47 - progress_bar.py[line:274] - INFO: epoch 040:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=17943.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3386.3, ups=0.19, wpb=17943.9, bsz=1024, num_updates=15300, lr=3.23774e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=98066
2024-11-07 16:56:42 - progress_bar.py[line:274] - INFO: epoch 040:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17784.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3252.6, ups=0.18, wpb=17784.7, bsz=1024, num_updates=15310, lr=3.23638e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=98121
2024-11-07 16:57:39 - progress_bar.py[line:274] - INFO: epoch 040:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=17688.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3095.4, ups=0.17, wpb=17688.8, bsz=1024, num_updates=15320, lr=3.23502e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=98178
2024-11-07 16:58:34 - progress_bar.py[line:274] - INFO: epoch 040:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17775.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3211, ups=0.18, wpb=17775.5, bsz=1024, num_updates=15330, lr=3.23366e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=98233
2024-11-07 16:59:27 - progress_bar.py[line:274] - INFO: epoch 040:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17817.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3398.6, ups=0.19, wpb=17817.7, bsz=1024, num_updates=15340, lr=3.2323e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=98286
2024-11-07 17:00:19 - progress_bar.py[line:274] - INFO: epoch 040:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=17956.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3425.5, ups=0.19, wpb=17956.2, bsz=1024, num_updates=15350, lr=3.23094e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=98338
2024-11-07 17:01:11 - progress_bar.py[line:274] - INFO: epoch 040:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17406.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3330.9, ups=0.19, wpb=17406.3, bsz=1024, num_updates=15360, lr=3.22958e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=98390
2024-11-07 17:02:03 - progress_bar.py[line:274] - INFO: epoch 040:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=17737.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3415.7, ups=0.19, wpb=17737.4, bsz=1024, num_updates=15370, lr=3.22822e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=98442
2024-11-07 17:02:55 - progress_bar.py[line:274] - INFO: epoch 040:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.369, ntokens=17608.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3391.1, ups=0.19, wpb=17608.9, bsz=1024, num_updates=15380, lr=3.22686e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=98494
2024-11-07 17:03:48 - progress_bar.py[line:274] - INFO: epoch 040:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.349, ntokens=17638.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3335, ups=0.19, wpb=17638.2, bsz=1024, num_updates=15390, lr=3.2255e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=98547
2024-11-07 17:04:45 - progress_bar.py[line:274] - INFO: epoch 040:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=18004.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3143.4, ups=0.17, wpb=18004.2, bsz=1024, num_updates=15400, lr=3.22414e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=98604
2024-11-07 17:05:42 - progress_bar.py[line:274] - INFO: epoch 040:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.348, ntokens=17596.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3117.2, ups=0.18, wpb=17596.1, bsz=1024, num_updates=15410, lr=3.22278e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=98661
2024-11-07 17:06:35 - progress_bar.py[line:274] - INFO: epoch 040:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=18079.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3429.7, ups=0.19, wpb=18079.8, bsz=1024, num_updates=15420, lr=3.22142e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=98713
2024-11-07 17:07:28 - progress_bar.py[line:274] - INFO: epoch 040:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17792.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3354.5, ups=0.19, wpb=17792.7, bsz=1024, num_updates=15430, lr=3.22006e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=98766
2024-11-07 17:08:20 - progress_bar.py[line:274] - INFO: epoch 040:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.378, ntokens=17834.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3405.2, ups=0.19, wpb=17834.5, bsz=1024, num_updates=15440, lr=3.2187e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=98819
2024-11-07 17:09:13 - progress_bar.py[line:274] - INFO: epoch 040:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=18011, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3398.4, ups=0.19, wpb=18011, bsz=1024, num_updates=15450, lr=3.21734e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=98872
2024-11-07 17:10:06 - progress_bar.py[line:274] - INFO: epoch 040:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17815.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3355.7, ups=0.19, wpb=17815.8, bsz=1024, num_updates=15460, lr=3.21598e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=98925
2024-11-07 17:10:58 - progress_bar.py[line:274] - INFO: epoch 040:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=17791.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3394.8, ups=0.19, wpb=17791.9, bsz=1024, num_updates=15470, lr=3.21462e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=98977
2024-11-07 17:11:51 - progress_bar.py[line:274] - INFO: epoch 040:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17366.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3326.2, ups=0.19, wpb=17366.4, bsz=1024, num_updates=15480, lr=3.21326e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=50, gb_free=13.5, wall=99030
2024-11-07 17:12:43 - progress_bar.py[line:274] - INFO: epoch 040:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.371, ntokens=17790, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3401.9, ups=0.19, wpb=17790, bsz=1024, num_updates=15490, lr=3.2119e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=99082
2024-11-07 17:13:36 - progress_bar.py[line:274] - INFO: epoch 040:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.398, ntokens=18041.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3425.9, ups=0.19, wpb=18041.2, bsz=1024, num_updates=15500, lr=3.21053e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=99135
2024-11-07 17:14:28 - progress_bar.py[line:274] - INFO: epoch 040:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=17692, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3364.7, ups=0.19, wpb=17692, bsz=1024, num_updates=15510, lr=3.20917e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=99187
2024-11-07 17:15:21 - progress_bar.py[line:274] - INFO: epoch 040:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.332, ntokens=17526.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3325.5, ups=0.19, wpb=17526.7, bsz=1024, num_updates=15520, lr=3.20781e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=99240
2024-11-07 17:16:15 - progress_bar.py[line:274] - INFO: epoch 040:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17675.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3269.6, ups=0.18, wpb=17675.1, bsz=1024, num_updates=15530, lr=3.20645e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=99294
2024-11-07 17:17:07 - progress_bar.py[line:274] - INFO: epoch 040:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18348.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3496.3, ups=0.19, wpb=18348.8, bsz=1024, num_updates=15540, lr=3.20509e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=99346
2024-11-07 17:18:01 - progress_bar.py[line:274] - INFO: epoch 040:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=18204, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3382.1, ups=0.19, wpb=18204, bsz=1024, num_updates=15550, lr=3.20373e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=99400
2024-11-07 17:18:55 - progress_bar.py[line:274] - INFO: epoch 040:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=18123.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3365.1, ups=0.19, wpb=18123.6, bsz=1024, num_updates=15560, lr=3.20237e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=99454
2024-11-07 17:19:49 - progress_bar.py[line:274] - INFO: epoch 040:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=18032.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3368.5, ups=0.19, wpb=18032.1, bsz=1024, num_updates=15570, lr=3.20101e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=99508
2024-11-07 17:20:43 - progress_bar.py[line:274] - INFO: epoch 040:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.459, ntokens=18297.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3374.5, ups=0.18, wpb=18297.7, bsz=1024, num_updates=15580, lr=3.19965e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=99562
2024-11-07 17:21:36 - progress_bar.py[line:274] - INFO: epoch 040:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=18394, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3442.4, ups=0.19, wpb=18394, bsz=1024, num_updates=15590, lr=3.19829e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=99615
2024-11-07 17:22:30 - progress_bar.py[line:274] - INFO: epoch 040:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=18233.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3423.3, ups=0.19, wpb=18233.4, bsz=1024, num_updates=15600, lr=3.19693e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.2, wall=99668
2024-11-07 17:23:24 - progress_bar.py[line:274] - INFO: epoch 040:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=18102.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3341.5, ups=0.18, wpb=18102.8, bsz=1024, num_updates=15610, lr=3.19557e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=99723
2024-11-07 17:24:17 - progress_bar.py[line:274] - INFO: epoch 040:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=18147.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3422.7, ups=0.19, wpb=18147.6, bsz=1024, num_updates=15620, lr=3.19421e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=99776
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 17:24:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 40 @ 15624 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
2024-11-07 17:24:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt': File exists: File exists: File exists: File exists



local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 17:26:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 17:28:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 40 @ 15624 updates, score 0) (writing took 224.43920247399365 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
2024-11-07 17:29:16 - train.py[line:336] - INFO: end of epoch 40 (average epoch stats below)
2024-11-07 17:29:16 - progress_bar.py[line:282] - INFO: epoch 040 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.392 | ntokens 17843.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.25 | wps 2759.9 | ups 0.15 | wpb 17843.9 | bsz 1023 | num_updates 15624 | lr 3.19367e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1655 | gb_free 13.3 | wall 100075
2024-11-07 17:29:16 - trainer.py[line:639] - INFO: loading train data for epoch 41
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 17:31:57 - trainer.py[line:703] - INFO: begin training epoch 41
2024-11-07 17:31:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 17:32:33 - progress_bar.py[line:274] - INFO: epoch 041:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.356, ntokens=16879.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=340.4, ups=0.02, wpb=16879.2, bsz=985.6, num_updates=15630, lr=3.19285e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=29, gb_free=13.5, wall=100272
2024-11-07 17:33:29 - progress_bar.py[line:274] - INFO: epoch 041:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17861.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3184.5, ups=0.18, wpb=17861.4, bsz=1024, num_updates=15640, lr=3.19149e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=100328
2024-11-07 17:34:23 - progress_bar.py[line:274] - INFO: epoch 041:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.309, ntokens=17357.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3175.5, ups=0.18, wpb=17357.6, bsz=1024, num_updates=15650, lr=3.19013e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=100382
2024-11-07 17:35:19 - progress_bar.py[line:274] - INFO: epoch 041:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.411, ntokens=18023.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3262.7, ups=0.18, wpb=18023.5, bsz=1024, num_updates=15660, lr=3.18877e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=100438
2024-11-07 17:36:14 - progress_bar.py[line:274] - INFO: epoch 041:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17590.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3155.8, ups=0.18, wpb=17590.3, bsz=1024, num_updates=15670, lr=3.18741e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=100493
2024-11-07 17:37:10 - progress_bar.py[line:274] - INFO: epoch 041:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.367, ntokens=17778.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3202.8, ups=0.18, wpb=17778.9, bsz=1024, num_updates=15680, lr=3.18605e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=100549
2024-11-07 17:38:05 - progress_bar.py[line:274] - INFO: epoch 041:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17698.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3216.5, ups=0.18, wpb=17698.9, bsz=1024, num_updates=15690, lr=3.18469e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=100604
2024-11-07 17:39:01 - progress_bar.py[line:274] - INFO: epoch 041:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.345, ntokens=17533.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3124.9, ups=0.18, wpb=17533.6, bsz=1024, num_updates=15700, lr=3.18333e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=100660
2024-11-07 17:39:57 - progress_bar.py[line:274] - INFO: epoch 041:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17738.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3161.3, ups=0.18, wpb=17738.8, bsz=1024, num_updates=15710, lr=3.18197e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=100716
2024-11-07 17:40:52 - progress_bar.py[line:274] - INFO: epoch 041:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=17743.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3250.5, ups=0.18, wpb=17743.3, bsz=1024, num_updates=15720, lr=3.18061e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=100771
2024-11-07 17:41:47 - progress_bar.py[line:274] - INFO: epoch 041:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.348, ntokens=17610, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3202.8, ups=0.18, wpb=17610, bsz=1024, num_updates=15730, lr=3.17925e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=100826
2024-11-07 17:42:42 - progress_bar.py[line:274] - INFO: epoch 041:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17589.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3183.9, ups=0.18, wpb=17589.5, bsz=1024, num_updates=15740, lr=3.17789e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=100881
2024-11-07 17:43:36 - progress_bar.py[line:274] - INFO: epoch 041:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17420.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3200.5, ups=0.18, wpb=17420.8, bsz=1024, num_updates=15750, lr=3.17653e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=100935
2024-11-07 17:44:31 - progress_bar.py[line:274] - INFO: epoch 041:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17487.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3193.6, ups=0.18, wpb=17487.3, bsz=1024, num_updates=15760, lr=3.17516e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=100990
2024-11-07 17:45:27 - progress_bar.py[line:274] - INFO: epoch 041:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=17873.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3221.9, ups=0.18, wpb=17873.9, bsz=1024, num_updates=15770, lr=3.1738e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=101046
2024-11-07 17:46:23 - progress_bar.py[line:274] - INFO: epoch 041:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17787.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3183.5, ups=0.18, wpb=17787.4, bsz=1024, num_updates=15780, lr=3.17244e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101101
2024-11-07 17:47:18 - progress_bar.py[line:274] - INFO: epoch 041:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.374, ntokens=18070.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3232.1, ups=0.18, wpb=18070.9, bsz=1024, num_updates=15790, lr=3.17108e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=101157
2024-11-07 17:48:14 - progress_bar.py[line:274] - INFO: epoch 041:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17372.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3141.6, ups=0.18, wpb=17372.9, bsz=1024, num_updates=15800, lr=3.16972e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=101213
2024-11-07 17:49:09 - progress_bar.py[line:274] - INFO: epoch 041:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17542.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3179.2, ups=0.18, wpb=17542.5, bsz=1024, num_updates=15810, lr=3.16836e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=101268
2024-11-07 17:50:04 - progress_bar.py[line:274] - INFO: epoch 041:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17482.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3160, ups=0.18, wpb=17482.3, bsz=1024, num_updates=15820, lr=3.167e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101323
2024-11-07 17:51:00 - progress_bar.py[line:274] - INFO: epoch 041:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.385, ntokens=18091.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3264, ups=0.18, wpb=18091.8, bsz=1024, num_updates=15830, lr=3.16564e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=101379
2024-11-07 17:51:55 - progress_bar.py[line:274] - INFO: epoch 041:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=17786.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3220.7, ups=0.18, wpb=17786.7, bsz=1024, num_updates=15840, lr=3.16428e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=101434
2024-11-07 17:52:50 - progress_bar.py[line:274] - INFO: epoch 041:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=17643.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3199, ups=0.18, wpb=17643.9, bsz=1024, num_updates=15850, lr=3.16292e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=101489
2024-11-07 17:53:46 - progress_bar.py[line:274] - INFO: epoch 041:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17592.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3152.1, ups=0.18, wpb=17592.6, bsz=1024, num_updates=15860, lr=3.16156e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=101545
2024-11-07 17:54:41 - progress_bar.py[line:274] - INFO: epoch 041:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.349, ntokens=17598.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3196.3, ups=0.18, wpb=17598.2, bsz=1024, num_updates=15870, lr=3.1602e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=101600
2024-11-07 17:55:36 - progress_bar.py[line:274] - INFO: epoch 041:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=18012.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3259.5, ups=0.18, wpb=18012.8, bsz=1024, num_updates=15880, lr=3.15884e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=101655
2024-11-07 17:56:32 - progress_bar.py[line:274] - INFO: epoch 041:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=18082.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3245.6, ups=0.18, wpb=18082.3, bsz=1024, num_updates=15890, lr=3.15748e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101711
2024-11-07 17:57:28 - progress_bar.py[line:274] - INFO: epoch 041:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=17673.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3171.1, ups=0.18, wpb=17673.6, bsz=1024, num_updates=15900, lr=3.15612e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101767
2024-11-07 17:58:23 - progress_bar.py[line:274] - INFO: epoch 041:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.36, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3176.8, ups=0.18, wpb=17589.3, bsz=1024, num_updates=15910, lr=3.15476e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=101822
2024-11-07 17:59:19 - progress_bar.py[line:274] - INFO: epoch 041:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=17780.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3195.5, ups=0.18, wpb=17780.5, bsz=1024, num_updates=15920, lr=3.1534e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=101878
2024-11-07 18:00:14 - progress_bar.py[line:274] - INFO: epoch 041:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18359.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3345.1, ups=0.18, wpb=18359.3, bsz=1024, num_updates=15930, lr=3.15204e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=101932
2024-11-07 18:01:09 - progress_bar.py[line:274] - INFO: epoch 041:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=18164.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3297.3, ups=0.18, wpb=18164.7, bsz=1024, num_updates=15940, lr=3.15068e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=101987
2024-11-07 18:02:06 - progress_bar.py[line:274] - INFO: epoch 041:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=18139.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3174.2, ups=0.17, wpb=18139.5, bsz=1024, num_updates=15950, lr=3.14932e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=43, gb_free=13.3, wall=102045
2024-11-07 18:03:03 - progress_bar.py[line:274] - INFO: epoch 041:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=18288.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3197.5, ups=0.17, wpb=18288.4, bsz=1024, num_updates=15960, lr=3.14796e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=102102
2024-11-07 18:03:57 - progress_bar.py[line:274] - INFO: epoch 041:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.455, ntokens=18425.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3378.1, ups=0.18, wpb=18425.8, bsz=1024, num_updates=15970, lr=3.1466e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=102156
2024-11-07 18:04:50 - progress_bar.py[line:274] - INFO: epoch 041:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=18297.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3461.6, ups=0.19, wpb=18297.8, bsz=1024, num_updates=15980, lr=3.14524e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=102209
2024-11-07 18:05:43 - progress_bar.py[line:274] - INFO: epoch 041:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=18309.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3501.7, ups=0.19, wpb=18309.8, bsz=1024, num_updates=15990, lr=3.14388e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=102262
2024-11-07 18:06:37 - progress_bar.py[line:274] - INFO: epoch 041:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.427, ntokens=18211.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3378.1, ups=0.19, wpb=18211.8, bsz=1024, num_updates=16000, lr=3.14252e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=36, gb_free=13.4, wall=102315
2024-11-07 18:07:30 - progress_bar.py[line:274] - INFO: epoch 041:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17635, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3275.3, ups=0.19, wpb=17635, bsz=1024, num_updates=16010, lr=3.14115e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.2, wall=102369
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 18:07:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 41 @ 16015 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt

2024-11-07 18:07:54 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 18:09:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
2024-11-07 18:11:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 41 @ 16015 updates, score 0) (writing took 219.838684405986 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
2024-11-07 18:12:30 - train.py[line:336] - INFO: end of epoch 41 (average epoch stats below)
2024-11-07 18:12:30 - progress_bar.py[line:282] - INFO: epoch 041 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.379 | ntokens 17803.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.2 | wps 2682.9 | ups 0.15 | wpb 17803.5 | bsz 1023 | num_updates 16015 | lr 3.14047e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1306 | gb_free 13.4 | wall 102669
2024-11-07 18:12:30 - trainer.py[line:639] - INFO: loading train data for epoch 42
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 18:15:13 - trainer.py[line:703] - INFO: begin training epoch 42
2024-11-07 18:15:13 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 18:15:43 - progress_bar.py[line:274] - INFO: epoch 042:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=16962.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=344.5, ups=0.02, wpb=16962.6, bsz=985.6, num_updates=16020, lr=3.13979e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=29, gb_free=13.6, wall=102862
2024-11-07 18:16:38 - progress_bar.py[line:274] - INFO: epoch 042:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17910, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3235.5, ups=0.18, wpb=17910, bsz=1024, num_updates=16030, lr=3.13843e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=102917
2024-11-07 18:17:33 - progress_bar.py[line:274] - INFO: epoch 042:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.323, ntokens=17431.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3159.9, ups=0.18, wpb=17431.4, bsz=1024, num_updates=16040, lr=3.13707e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=102972
2024-11-07 18:18:28 - progress_bar.py[line:274] - INFO: epoch 042:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.335, ntokens=17713.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3213.5, ups=0.18, wpb=17713.4, bsz=1024, num_updates=16050, lr=3.13571e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=103027
2024-11-07 18:19:23 - progress_bar.py[line:274] - INFO: epoch 042:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17540.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3196.5, ups=0.18, wpb=17540.5, bsz=1024, num_updates=16060, lr=3.13435e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=103082
2024-11-07 18:20:21 - progress_bar.py[line:274] - INFO: epoch 042:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17605.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3058.1, ups=0.17, wpb=17605.3, bsz=1024, num_updates=16070, lr=3.13299e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=103140
2024-11-07 18:21:18 - progress_bar.py[line:274] - INFO: epoch 042:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17978.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3126.9, ups=0.17, wpb=17978.9, bsz=1024, num_updates=16080, lr=3.13163e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=103197
2024-11-07 18:22:15 - progress_bar.py[line:274] - INFO: epoch 042:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.335, ntokens=17449.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3062.4, ups=0.18, wpb=17449.5, bsz=1024, num_updates=16090, lr=3.13027e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=103254
2024-11-07 18:23:13 - progress_bar.py[line:274] - INFO: epoch 042:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=17638.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3067.5, ups=0.17, wpb=17638.3, bsz=1024, num_updates=16100, lr=3.12891e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=103312
2024-11-07 18:24:11 - progress_bar.py[line:274] - INFO: epoch 042:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17739.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3058.6, ups=0.17, wpb=17739.1, bsz=1024, num_updates=16110, lr=3.12755e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=103370
2024-11-07 18:25:09 - progress_bar.py[line:274] - INFO: epoch 042:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17774.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3068.4, ups=0.17, wpb=17774.2, bsz=1024, num_updates=16120, lr=3.12619e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=103428
2024-11-07 18:26:07 - progress_bar.py[line:274] - INFO: epoch 042:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17509, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=2996, ups=0.17, wpb=17509, bsz=1024, num_updates=16130, lr=3.12483e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=103486
2024-11-07 18:26:47 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 18:27:10 - progress_bar.py[line:274] - INFO: epoch 042:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17708.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=2826.5, ups=0.16, wpb=17708.6, bsz=1024, num_updates=16140, lr=3.12347e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=103549
2024-11-07 18:28:07 - progress_bar.py[line:274] - INFO: epoch 042:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17598.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3105, ups=0.18, wpb=17598.8, bsz=1024, num_updates=16150, lr=3.12211e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=103605
2024-11-07 18:29:04 - progress_bar.py[line:274] - INFO: epoch 042:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17606.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3080.1, ups=0.17, wpb=17606.6, bsz=1024, num_updates=16160, lr=3.12075e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=103663
2024-11-07 18:30:01 - progress_bar.py[line:274] - INFO: epoch 042:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.36, ntokens=17784.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3104, ups=0.17, wpb=17784.5, bsz=1024, num_updates=16170, lr=3.11939e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=103720
2024-11-07 18:30:59 - progress_bar.py[line:274] - INFO: epoch 042:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.304, ntokens=17560.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3054.5, ups=0.17, wpb=17560.2, bsz=1024, num_updates=16180, lr=3.11803e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=103777
2024-11-07 18:31:55 - progress_bar.py[line:274] - INFO: epoch 042:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17450.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3064.7, ups=0.18, wpb=17450.9, bsz=1024, num_updates=16190, lr=3.11667e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=103834
2024-11-07 18:32:53 - progress_bar.py[line:274] - INFO: epoch 042:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.384, ntokens=17897.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3107.8, ups=0.17, wpb=17897.8, bsz=1024, num_updates=16200, lr=3.11531e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=103892
2024-11-07 18:33:51 - progress_bar.py[line:274] - INFO: epoch 042:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.388, ntokens=17913.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3105.1, ups=0.17, wpb=17913.4, bsz=1024, num_updates=16210, lr=3.11395e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=103950
2024-11-07 18:34:48 - progress_bar.py[line:274] - INFO: epoch 042:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=18070, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3149, ups=0.17, wpb=18070, bsz=1024, num_updates=16220, lr=3.11259e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104007
2024-11-07 18:35:42 - progress_bar.py[line:274] - INFO: epoch 042:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=17943, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3323.9, ups=0.19, wpb=17943, bsz=1024, num_updates=16230, lr=3.11123e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=104061
2024-11-07 18:36:41 - progress_bar.py[line:274] - INFO: epoch 042:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17525.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=2985.9, ups=0.17, wpb=17525.5, bsz=1024, num_updates=16240, lr=3.10987e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=104120
2024-11-07 18:37:39 - progress_bar.py[line:274] - INFO: epoch 042:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17691.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3037, ups=0.17, wpb=17691.7, bsz=1024, num_updates=16250, lr=3.10851e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=104178
2024-11-07 18:38:35 - progress_bar.py[line:274] - INFO: epoch 042:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.308, ntokens=17361.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3083, ups=0.18, wpb=17361.1, bsz=1024, num_updates=16260, lr=3.10714e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=104234
2024-11-07 18:39:33 - progress_bar.py[line:274] - INFO: epoch 042:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.37, ntokens=17858.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3091, ups=0.17, wpb=17858.4, bsz=1024, num_updates=16270, lr=3.10578e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104292
2024-11-07 18:40:31 - progress_bar.py[line:274] - INFO: epoch 042:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=18023.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3101.3, ups=0.17, wpb=18023.6, bsz=1024, num_updates=16280, lr=3.10442e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=104350
2024-11-07 18:41:30 - progress_bar.py[line:274] - INFO: epoch 042:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17529.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2992.8, ups=0.17, wpb=17529.4, bsz=1024, num_updates=16290, lr=3.10306e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=104409
2024-11-07 18:42:29 - progress_bar.py[line:274] - INFO: epoch 042:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17547.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=2973.6, ups=0.17, wpb=17547.5, bsz=1024, num_updates=16300, lr=3.1017e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=104468
2024-11-07 18:43:26 - progress_bar.py[line:274] - INFO: epoch 042:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.378, ntokens=17814.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3129.3, ups=0.18, wpb=17814.6, bsz=1024, num_updates=16310, lr=3.10034e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104525
2024-11-07 18:44:23 - progress_bar.py[line:274] - INFO: epoch 042:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=18597.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3272.4, ups=0.18, wpb=18597.8, bsz=1024, num_updates=16320, lr=3.09898e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104582
2024-11-07 18:45:21 - progress_bar.py[line:274] - INFO: epoch 042:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18456.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3167.8, ups=0.17, wpb=18456.5, bsz=1024, num_updates=16330, lr=3.09762e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104640
2024-11-07 18:46:18 - progress_bar.py[line:274] - INFO: epoch 042:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=18129, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3172.9, ups=0.18, wpb=18129, bsz=1024, num_updates=16340, lr=3.09626e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=104697
2024-11-07 18:47:16 - progress_bar.py[line:274] - INFO: epoch 042:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.429, ntokens=18044.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3130.4, ups=0.17, wpb=18044.2, bsz=1024, num_updates=16350, lr=3.0949e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104755
2024-11-07 18:48:13 - progress_bar.py[line:274] - INFO: epoch 042:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18460.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3238.8, ups=0.18, wpb=18460.1, bsz=1024, num_updates=16360, lr=3.09354e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104812
2024-11-07 18:49:10 - progress_bar.py[line:274] - INFO: epoch 042:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=18232, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3176.3, ups=0.17, wpb=18232, bsz=1024, num_updates=16370, lr=3.09218e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=104869
2024-11-07 18:50:08 - progress_bar.py[line:274] - INFO: epoch 042:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.453, ntokens=18323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3154.6, ups=0.17, wpb=18323.6, bsz=1024, num_updates=16380, lr=3.09082e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104927
2024-11-07 18:51:06 - progress_bar.py[line:274] - INFO: epoch 042:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=18448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3176.3, ups=0.17, wpb=18448.4, bsz=1024, num_updates=16390, lr=3.08946e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=104985
2024-11-07 18:52:04 - progress_bar.py[line:274] - INFO: epoch 042:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17844.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3111.2, ups=0.17, wpb=17844.9, bsz=1024, num_updates=16400, lr=3.0881e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=105042
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt2024-11-07 18:52:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 42 @ 16405 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
2024-11-07 18:52:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 18:54:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 18:56:16 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 42 @ 16405 updates, score 0) (writing took 227.8815998219943 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 18:57:12 - train.py[line:336] - INFO: end of epoch 42 (average epoch stats below)
2024-11-07 18:57:12 - progress_bar.py[line:282] - INFO: epoch 042 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.375 | ntokens 17815.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.19 | wps 2590.7 | ups 0.15 | wpb 17815.6 | bsz 1023 | num_updates 16405 | lr 3.08742e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1199 | gb_free 13.3 | wall 105351
2024-11-07 18:57:12 - trainer.py[line:639] - INFO: loading train data for epoch 43
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 18:59:56 - trainer.py[line:703] - INFO: begin training epoch 43
2024-11-07 18:59:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 19:00:28 - progress_bar.py[line:274] - INFO: epoch 043:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.387, ntokens=17251.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=342, ups=0.02, wpb=17251.1, bsz=985.6, num_updates=16410, lr=3.08674e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=29, gb_free=13.6, wall=105547
2024-11-07 19:01:27 - progress_bar.py[line:274] - INFO: epoch 043:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17708, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=2992.8, ups=0.17, wpb=17708, bsz=1024, num_updates=16420, lr=3.08538e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=105606
2024-11-07 19:02:26 - progress_bar.py[line:274] - INFO: epoch 043:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17598.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=2967, ups=0.17, wpb=17598.9, bsz=1024, num_updates=16430, lr=3.08402e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=105665
2024-11-07 19:03:25 - progress_bar.py[line:274] - INFO: epoch 043:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.372, ntokens=17935.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3080.7, ups=0.17, wpb=17935.1, bsz=1024, num_updates=16440, lr=3.08266e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=105724
2024-11-07 19:04:23 - progress_bar.py[line:274] - INFO: epoch 043:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17688, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3025.9, ups=0.17, wpb=17688, bsz=1024, num_updates=16450, lr=3.0813e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=105782
2024-11-07 19:05:22 - progress_bar.py[line:274] - INFO: epoch 043:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17877.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3042.1, ups=0.17, wpb=17877.5, bsz=1024, num_updates=16460, lr=3.07994e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=105841
2024-11-07 19:06:22 - progress_bar.py[line:274] - INFO: epoch 043:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17750.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=2949.9, ups=0.17, wpb=17750.9, bsz=1024, num_updates=16470, lr=3.07858e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=105901
2024-11-07 19:07:21 - progress_bar.py[line:274] - INFO: epoch 043:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=2948.7, ups=0.17, wpb=17448.2, bsz=1024, num_updates=16480, lr=3.07722e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=105960
2024-11-07 19:08:20 - progress_bar.py[line:274] - INFO: epoch 043:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17845.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3018.3, ups=0.17, wpb=17845.6, bsz=1024, num_updates=16490, lr=3.07586e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=106019
2024-11-07 19:09:19 - progress_bar.py[line:274] - INFO: epoch 043:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.367, ntokens=17838.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3029.8, ups=0.17, wpb=17838.8, bsz=1024, num_updates=16500, lr=3.0745e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=106078
2024-11-07 19:10:18 - progress_bar.py[line:274] - INFO: epoch 043:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.332, ntokens=17572.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=2982, ups=0.17, wpb=17572.3, bsz=1024, num_updates=16510, lr=3.07313e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=106137
2024-11-07 19:11:17 - progress_bar.py[line:274] - INFO: epoch 043:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17421.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=2960.8, ups=0.17, wpb=17421.5, bsz=1024, num_updates=16520, lr=3.07177e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=106196
2024-11-07 19:12:16 - progress_bar.py[line:274] - INFO: epoch 043:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17736.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3000.1, ups=0.17, wpb=17736.7, bsz=1024, num_updates=16530, lr=3.07041e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106255
2024-11-07 19:13:14 - progress_bar.py[line:274] - INFO: epoch 043:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.356, ntokens=17533.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3008.1, ups=0.17, wpb=17533.3, bsz=1024, num_updates=16540, lr=3.06905e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106313
2024-11-07 19:14:13 - progress_bar.py[line:274] - INFO: epoch 043:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.355, ntokens=17749.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3046.7, ups=0.17, wpb=17749.7, bsz=1024, num_updates=16550, lr=3.06769e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=106372
2024-11-07 19:15:11 - progress_bar.py[line:274] - INFO: epoch 043:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17494.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=2995.4, ups=0.17, wpb=17494.5, bsz=1024, num_updates=16560, lr=3.06633e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106430
2024-11-07 19:16:11 - progress_bar.py[line:274] - INFO: epoch 043:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17702.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=2972.3, ups=0.17, wpb=17702.8, bsz=1024, num_updates=16570, lr=3.06497e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106490
2024-11-07 19:17:10 - progress_bar.py[line:274] - INFO: epoch 043:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17691.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3002.6, ups=0.17, wpb=17691.1, bsz=1024, num_updates=16580, lr=3.06361e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106548
2024-11-07 19:18:08 - progress_bar.py[line:274] - INFO: epoch 043:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17602.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2995, ups=0.17, wpb=17602.6, bsz=1024, num_updates=16590, lr=3.06225e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106607
2024-11-07 19:19:06 - progress_bar.py[line:274] - INFO: epoch 043:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=18029.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3113, ups=0.17, wpb=18029.4, bsz=1024, num_updates=16600, lr=3.06089e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=106665
2024-11-07 19:20:05 - progress_bar.py[line:274] - INFO: epoch 043:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=18020.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3090.2, ups=0.17, wpb=18020.4, bsz=1024, num_updates=16610, lr=3.05953e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106723
2024-11-07 19:21:04 - progress_bar.py[line:274] - INFO: epoch 043:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17801.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3022.6, ups=0.17, wpb=17801.3, bsz=1024, num_updates=16620, lr=3.05817e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=106782
2024-11-07 19:22:01 - progress_bar.py[line:274] - INFO: epoch 043:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17676.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3054.7, ups=0.17, wpb=17676.3, bsz=1024, num_updates=16630, lr=3.05681e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=106840
2024-11-07 19:23:00 - progress_bar.py[line:274] - INFO: epoch 043:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17601.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3003.7, ups=0.17, wpb=17601.5, bsz=1024, num_updates=16640, lr=3.05545e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=106899
2024-11-07 19:23:59 - progress_bar.py[line:274] - INFO: epoch 043:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.311, ntokens=17381.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=2928.9, ups=0.17, wpb=17381.2, bsz=1024, num_updates=16650, lr=3.05409e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=106958
2024-11-07 19:24:57 - progress_bar.py[line:274] - INFO: epoch 043:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17688.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3068.2, ups=0.17, wpb=17688.3, bsz=1024, num_updates=16660, lr=3.05273e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=107016
2024-11-07 19:25:56 - progress_bar.py[line:274] - INFO: epoch 043:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=18002.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3064.3, ups=0.17, wpb=18002.9, bsz=1024, num_updates=16670, lr=3.05137e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=107075
2024-11-07 19:26:54 - progress_bar.py[line:274] - INFO: epoch 043:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17664.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3028.2, ups=0.17, wpb=17664.9, bsz=1024, num_updates=16680, lr=3.05001e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=107133
2024-11-07 19:27:53 - progress_bar.py[line:274] - INFO: epoch 043:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.259, ntokens=17133.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.79, wps=2926.3, ups=0.17, wpb=17133.7, bsz=1024, num_updates=16690, lr=3.04865e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=107191
2024-11-07 19:28:51 - progress_bar.py[line:274] - INFO: epoch 043:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17919.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3052.9, ups=0.17, wpb=17919.7, bsz=1024, num_updates=16700, lr=3.04729e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107250
2024-11-07 19:29:50 - progress_bar.py[line:274] - INFO: epoch 043:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.419, ntokens=18135.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3110.2, ups=0.17, wpb=18135.8, bsz=1024, num_updates=16710, lr=3.04593e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107308
2024-11-07 19:30:48 - progress_bar.py[line:274] - INFO: epoch 043:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=18496.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3164.1, ups=0.17, wpb=18496.7, bsz=1024, num_updates=16720, lr=3.04457e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107367
2024-11-07 19:31:46 - progress_bar.py[line:274] - INFO: epoch 043:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=18412.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3152.3, ups=0.17, wpb=18412.7, bsz=1024, num_updates=16730, lr=3.04321e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107425
2024-11-07 19:32:45 - progress_bar.py[line:274] - INFO: epoch 043:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=18380.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3164, ups=0.17, wpb=18380.7, bsz=1024, num_updates=16740, lr=3.04185e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=107483
2024-11-07 19:33:43 - progress_bar.py[line:274] - INFO: epoch 043:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.455, ntokens=18333.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3132.6, ups=0.17, wpb=18333.8, bsz=1024, num_updates=16750, lr=3.04049e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107542
2024-11-07 19:34:41 - progress_bar.py[line:274] - INFO: epoch 043:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=18221.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3160.4, ups=0.17, wpb=18221.9, bsz=1024, num_updates=16760, lr=3.03912e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107600
2024-11-07 19:35:38 - progress_bar.py[line:274] - INFO: epoch 043:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.411, ntokens=18049.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3128.4, ups=0.17, wpb=18049.2, bsz=1024, num_updates=16770, lr=3.03776e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=107657
2024-11-07 19:36:37 - progress_bar.py[line:274] - INFO: epoch 043:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=18273.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3145.1, ups=0.17, wpb=18273.6, bsz=1024, num_updates=16780, lr=3.0364e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=107715
2024-11-07 19:37:35 - progress_bar.py[line:274] - INFO: epoch 043:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=17806.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3042, ups=0.17, wpb=17806.7, bsz=1024, num_updates=16790, lr=3.03504e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=107774
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

2024-11-07 19:38:06 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 43 @ 16796 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
2024-11-07 19:38:06 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 19:39:58 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-07 19:41:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 43 @ 16796 updates, score 0) (writing took 226.4646839760244 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 19:42:48 - train.py[line:336] - INFO: end of epoch 43 (average epoch stats below)
2024-11-07 19:42:48 - progress_bar.py[line:282] - INFO: epoch 043 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.371 | ntokens 17806.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.17 | wps 2544.9 | ups 0.14 | wpb 17806.3 | bsz 1023 | num_updates 16796 | lr 3.03423e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1207 | gb_free 13.4 | wall 108087
2024-11-07 19:42:48 - trainer.py[line:639] - INFO: loading train data for epoch 44
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 19:45:31 - trainer.py[line:703] - INFO: begin training epoch 44
2024-11-07 19:45:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 19:45:56 - progress_bar.py[line:274] - INFO: epoch 044:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.358, ntokens=17111.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=341.6, ups=0.02, wpb=17111.8, bsz=985.6, num_updates=16800, lr=3.03368e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=108275
2024-11-07 19:46:54 - progress_bar.py[line:274] - INFO: epoch 044:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17540.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3013, ups=0.17, wpb=17540.2, bsz=1024, num_updates=16810, lr=3.03232e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=108333
2024-11-07 19:47:49 - progress_bar.py[line:274] - INFO: epoch 044:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17586.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3222.5, ups=0.18, wpb=17586.5, bsz=1024, num_updates=16820, lr=3.03096e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108388
2024-11-07 19:48:47 - progress_bar.py[line:274] - INFO: epoch 044:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.345, ntokens=17871.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3074.9, ups=0.17, wpb=17871.9, bsz=1024, num_updates=16830, lr=3.0296e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=108446
2024-11-07 19:49:46 - progress_bar.py[line:274] - INFO: epoch 044:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=18045.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3069.6, ups=0.17, wpb=18045.4, bsz=1024, num_updates=16840, lr=3.02824e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=108505
2024-11-07 19:50:45 - progress_bar.py[line:274] - INFO: epoch 044:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=17958.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3018.5, ups=0.17, wpb=17958.7, bsz=1024, num_updates=16850, lr=3.02688e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=108564
2024-11-07 19:51:44 - progress_bar.py[line:274] - INFO: epoch 044:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=18094, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3057, ups=0.17, wpb=18094, bsz=1024, num_updates=16860, lr=3.02552e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108623
2024-11-07 19:52:42 - progress_bar.py[line:274] - INFO: epoch 044:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=17531, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3050.8, ups=0.17, wpb=17531, bsz=1024, num_updates=16870, lr=3.02416e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=108681
2024-11-07 19:53:41 - progress_bar.py[line:274] - INFO: epoch 044:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17848.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3032.5, ups=0.17, wpb=17848.2, bsz=1024, num_updates=16880, lr=3.0228e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108740
2024-11-07 19:54:39 - progress_bar.py[line:274] - INFO: epoch 044:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.372, ntokens=17927, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3075.4, ups=0.17, wpb=17927, bsz=1024, num_updates=16890, lr=3.02144e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108798
2024-11-07 19:55:35 - progress_bar.py[line:274] - INFO: epoch 044:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.292, ntokens=17296.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3067.1, ups=0.18, wpb=17296.8, bsz=1024, num_updates=16900, lr=3.02008e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=108854
2024-11-07 19:56:34 - progress_bar.py[line:274] - INFO: epoch 044:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=17728.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3023.6, ups=0.17, wpb=17728.5, bsz=1024, num_updates=16910, lr=3.01872e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108913
2024-11-07 19:57:33 - progress_bar.py[line:274] - INFO: epoch 044:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17961.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3063.6, ups=0.17, wpb=17961.9, bsz=1024, num_updates=16920, lr=3.01736e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=108972
2024-11-07 19:58:31 - progress_bar.py[line:274] - INFO: epoch 044:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.32, ntokens=17327, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=2954.6, ups=0.17, wpb=17327, bsz=1024, num_updates=16930, lr=3.016e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109030
2024-11-07 19:59:30 - progress_bar.py[line:274] - INFO: epoch 044:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.335, ntokens=17665.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3026.6, ups=0.17, wpb=17665.4, bsz=1024, num_updates=16940, lr=3.01464e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=109089
2024-11-07 20:00:29 - progress_bar.py[line:274] - INFO: epoch 044:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.327, ntokens=17627.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2984.1, ups=0.17, wpb=17627.7, bsz=1024, num_updates=16950, lr=3.01328e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109148
2024-11-07 20:01:27 - progress_bar.py[line:274] - INFO: epoch 044:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=18033.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3086.4, ups=0.17, wpb=18033.6, bsz=1024, num_updates=16960, lr=3.01192e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109206
2024-11-07 20:02:25 - progress_bar.py[line:274] - INFO: epoch 044:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17512.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3024.7, ups=0.17, wpb=17512.6, bsz=1024, num_updates=16970, lr=3.01056e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=109264
2024-11-07 20:03:24 - progress_bar.py[line:274] - INFO: epoch 044:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17537.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=2987, ups=0.17, wpb=17537.4, bsz=1024, num_updates=16980, lr=3.0092e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109323
2024-11-07 20:04:23 - progress_bar.py[line:274] - INFO: epoch 044:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=17666.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3009.8, ups=0.17, wpb=17666.5, bsz=1024, num_updates=16990, lr=3.00784e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=109381
2024-11-07 20:05:21 - progress_bar.py[line:274] - INFO: epoch 044:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.346, ntokens=17843.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3033.2, ups=0.17, wpb=17843.7, bsz=1024, num_updates=17000, lr=3.00648e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=109440
2024-11-07 20:06:20 - progress_bar.py[line:274] - INFO: epoch 044:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=18046.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3066.2, ups=0.17, wpb=18046.1, bsz=1024, num_updates=17010, lr=3.00512e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109499
2024-11-07 20:07:15 - progress_bar.py[line:274] - INFO: epoch 044:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17794.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3261.1, ups=0.18, wpb=17794.4, bsz=1024, num_updates=17020, lr=3.00375e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=109554
2024-11-07 20:08:12 - progress_bar.py[line:274] - INFO: epoch 044:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.333, ntokens=17616.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3069.6, ups=0.17, wpb=17616.6, bsz=1024, num_updates=17030, lr=3.00239e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=109611
2024-11-07 20:09:09 - progress_bar.py[line:274] - INFO: epoch 044:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.316, ntokens=17437, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3088.2, ups=0.18, wpb=17437, bsz=1024, num_updates=17040, lr=3.00103e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=109668
2024-11-07 20:10:08 - progress_bar.py[line:274] - INFO: epoch 044:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=17828.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3025.4, ups=0.17, wpb=17828.8, bsz=1024, num_updates=17050, lr=2.99967e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109726
2024-11-07 20:11:06 - progress_bar.py[line:274] - INFO: epoch 044:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=18032.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3071.7, ups=0.17, wpb=18032.3, bsz=1024, num_updates=17060, lr=2.99831e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109785
2024-11-07 20:12:05 - progress_bar.py[line:274] - INFO: epoch 044:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=18061.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3051.2, ups=0.17, wpb=18061.6, bsz=1024, num_updates=17070, lr=2.99695e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=109844
2024-11-07 20:13:05 - progress_bar.py[line:274] - INFO: epoch 044:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=17436.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=2944.1, ups=0.17, wpb=17436.6, bsz=1024, num_updates=17080, lr=2.99559e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=109904
2024-11-07 20:14:02 - progress_bar.py[line:274] - INFO: epoch 044:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.285, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=3007.6, ups=0.17, wpb=17332.3, bsz=1024, num_updates=17090, lr=2.99423e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109961
2024-11-07 20:15:00 - progress_bar.py[line:274] - INFO: epoch 044:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.446, ntokens=18318.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3149.8, ups=0.17, wpb=18318.9, bsz=1024, num_updates=17100, lr=2.99287e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=110019
2024-11-07 20:15:59 - progress_bar.py[line:274] - INFO: epoch 044:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=18097.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3099.7, ups=0.17, wpb=18097.4, bsz=1024, num_updates=17110, lr=2.99151e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=110078
2024-11-07 20:16:58 - progress_bar.py[line:274] - INFO: epoch 044:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17932.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3033.4, ups=0.17, wpb=17932.4, bsz=1024, num_updates=17120, lr=2.99015e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=110137
2024-11-07 20:17:56 - progress_bar.py[line:274] - INFO: epoch 044:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18728.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3207.7, ups=0.17, wpb=18728.9, bsz=1024, num_updates=17130, lr=2.98879e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=110195
2024-11-07 20:18:55 - progress_bar.py[line:274] - INFO: epoch 044:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.357, ntokens=17719.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3034.9, ups=0.17, wpb=17719.5, bsz=1024, num_updates=17140, lr=2.98743e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=110254
2024-11-07 20:19:52 - progress_bar.py[line:274] - INFO: epoch 044:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=18721.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3268.1, ups=0.17, wpb=18721.4, bsz=1024, num_updates=17150, lr=2.98607e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=110311
2024-11-07 20:20:50 - progress_bar.py[line:274] - INFO: epoch 044:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17999.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3087.4, ups=0.17, wpb=17999.9, bsz=1024, num_updates=17160, lr=2.98471e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=110369
2024-11-07 20:21:48 - progress_bar.py[line:274] - INFO: epoch 044:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.392, ntokens=17915.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3098.1, ups=0.17, wpb=17915.1, bsz=1024, num_updates=17170, lr=2.98335e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=110427
2024-11-07 20:22:45 - progress_bar.py[line:274] - INFO: epoch 044:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=18187, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3194.4, ups=0.18, wpb=18187, bsz=1024, num_updates=17180, lr=2.98199e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=110484
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt2024-11-07 20:23:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 44 @ 17187 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
2024-11-07 20:23:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 20:25:12 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-07 20:27:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 44 @ 17187 updates, score 0) (writing took 226.52813410101226 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 20:28:04 - train.py[line:336] - INFO: end of epoch 44 (average epoch stats below)
2024-11-07 20:28:04 - progress_bar.py[line:282] - INFO: epoch 044 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.363 | ntokens 17814.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.14 | wps 2564.8 | ups 0.14 | wpb 17814.5 | bsz 1023 | num_updates 17187 | lr 2.98104e-05 | gnorm 0.009 | clip 0 | loss_scale 131072 | train_wall 1233 | gb_free 13.3 | wall 110803
2024-11-07 20:28:04 - trainer.py[line:639] - INFO: loading train data for epoch 45
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 20:30:47 - trainer.py[line:703] - INFO: begin training epoch 45
2024-11-07 20:30:47 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 20:31:07 - progress_bar.py[line:274] - INFO: epoch 045:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17085, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=340.7, ups=0.02, wpb=17085, bsz=985.6, num_updates=17190, lr=2.98063e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=29, gb_free=13.4, wall=110985
2024-11-07 20:32:01 - progress_bar.py[line:274] - INFO: epoch 045:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17680.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3221.1, ups=0.18, wpb=17680.6, bsz=1024, num_updates=17200, lr=2.97927e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=111040
2024-11-07 20:32:24 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 20:33:04 - progress_bar.py[line:274] - INFO: epoch 045:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.381, ntokens=17876.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=2843.1, ups=0.16, wpb=17876.9, bsz=1024, num_updates=17210, lr=2.97791e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=111103
2024-11-07 20:34:03 - progress_bar.py[line:274] - INFO: epoch 045:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.32, ntokens=17771.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3043.2, ups=0.17, wpb=17771.7, bsz=1024, num_updates=17220, lr=2.97655e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=111162
2024-11-07 20:34:57 - progress_bar.py[line:274] - INFO: epoch 045:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.324, ntokens=17597.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3218.9, ups=0.18, wpb=17597.2, bsz=1024, num_updates=17230, lr=2.97519e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=111216
2024-11-07 20:35:55 - progress_bar.py[line:274] - INFO: epoch 045:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17723.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3072.3, ups=0.17, wpb=17723.7, bsz=1024, num_updates=17240, lr=2.97383e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=111274
2024-11-07 20:36:52 - progress_bar.py[line:274] - INFO: epoch 045:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.357, ntokens=17858.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3132.2, ups=0.18, wpb=17858.5, bsz=1024, num_updates=17250, lr=2.97247e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=111331
2024-11-07 20:37:49 - progress_bar.py[line:274] - INFO: epoch 045:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.311, ntokens=17527.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3064.9, ups=0.17, wpb=17527.7, bsz=1024, num_updates=17260, lr=2.97111e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=38, gb_free=13.4, wall=111388
2024-11-07 20:38:47 - progress_bar.py[line:274] - INFO: epoch 045:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17856.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3072.9, ups=0.17, wpb=17856.1, bsz=1024, num_updates=17270, lr=2.96974e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=111446
2024-11-07 20:39:45 - progress_bar.py[line:274] - INFO: epoch 045:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17834.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3116.7, ups=0.17, wpb=17834.8, bsz=1024, num_updates=17280, lr=2.96838e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=111504
2024-11-07 20:40:43 - progress_bar.py[line:274] - INFO: epoch 045:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.304, ntokens=17456, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3015.6, ups=0.17, wpb=17456, bsz=1024, num_updates=17290, lr=2.96702e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=111561
2024-11-07 20:41:40 - progress_bar.py[line:274] - INFO: epoch 045:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17654.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3079, ups=0.17, wpb=17654.6, bsz=1024, num_updates=17300, lr=2.96566e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=111619
2024-11-07 20:42:37 - progress_bar.py[line:274] - INFO: epoch 045:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17748, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3095.8, ups=0.17, wpb=17748, bsz=1024, num_updates=17310, lr=2.9643e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=48, gb_free=13.5, wall=111676
2024-11-07 20:43:36 - progress_bar.py[line:274] - INFO: epoch 045:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.312, ntokens=17292.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=2956.6, ups=0.17, wpb=17292.9, bsz=1024, num_updates=17320, lr=2.96294e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=111735
2024-11-07 20:44:36 - progress_bar.py[line:274] - INFO: epoch 045:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=17708.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=2958.9, ups=0.17, wpb=17708.1, bsz=1024, num_updates=17330, lr=2.96158e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=111794
2024-11-07 20:45:35 - progress_bar.py[line:274] - INFO: epoch 045:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.309, ntokens=17678.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=2956.8, ups=0.17, wpb=17678.6, bsz=1024, num_updates=17340, lr=2.96022e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=111854
2024-11-07 20:46:34 - progress_bar.py[line:274] - INFO: epoch 045:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17898, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3034.7, ups=0.17, wpb=17898, bsz=1024, num_updates=17350, lr=2.95886e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=111913
2024-11-07 20:47:34 - progress_bar.py[line:274] - INFO: epoch 045:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.323, ntokens=17687.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=2978.6, ups=0.17, wpb=17687.9, bsz=1024, num_updates=17360, lr=2.9575e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=111973
2024-11-07 20:48:33 - progress_bar.py[line:274] - INFO: epoch 045:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.304, ntokens=17461, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=2963.1, ups=0.17, wpb=17461, bsz=1024, num_updates=17370, lr=2.95614e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112031
2024-11-07 20:49:31 - progress_bar.py[line:274] - INFO: epoch 045:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.333, ntokens=17585.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3001.8, ups=0.17, wpb=17585.8, bsz=1024, num_updates=17380, lr=2.95478e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=112090
2024-11-07 20:50:29 - progress_bar.py[line:274] - INFO: epoch 045:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=18090.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3125.7, ups=0.17, wpb=18090.5, bsz=1024, num_updates=17390, lr=2.95342e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=112148
2024-11-07 20:51:28 - progress_bar.py[line:274] - INFO: epoch 045:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.356, ntokens=17882.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3048.9, ups=0.17, wpb=17882.5, bsz=1024, num_updates=17400, lr=2.95206e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112207
2024-11-07 20:52:25 - progress_bar.py[line:274] - INFO: epoch 045:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.275, ntokens=17375.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.84, wps=3031.6, ups=0.17, wpb=17375.8, bsz=1024, num_updates=17410, lr=2.9507e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=112264
2024-11-07 20:53:24 - progress_bar.py[line:274] - INFO: epoch 045:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17953.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3064.5, ups=0.17, wpb=17953.7, bsz=1024, num_updates=17420, lr=2.94934e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=112323
2024-11-07 20:54:22 - progress_bar.py[line:274] - INFO: epoch 045:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.29, ntokens=17278.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.89, wps=2972.2, ups=0.17, wpb=17278.9, bsz=1024, num_updates=17430, lr=2.94798e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112381
2024-11-07 20:55:20 - progress_bar.py[line:274] - INFO: epoch 045:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17619.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3041.3, ups=0.17, wpb=17619.5, bsz=1024, num_updates=17440, lr=2.94662e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112439
2024-11-07 20:56:19 - progress_bar.py[line:274] - INFO: epoch 045:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.355, ntokens=17995.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3041, ups=0.17, wpb=17995.5, bsz=1024, num_updates=17450, lr=2.94526e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112498
2024-11-07 20:57:16 - progress_bar.py[line:274] - INFO: epoch 045:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.345, ntokens=17851.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3133.4, ups=0.18, wpb=17851.8, bsz=1024, num_updates=17460, lr=2.9439e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=112555
2024-11-07 20:58:13 - progress_bar.py[line:274] - INFO: epoch 045:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.322, ntokens=17612.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3071.7, ups=0.17, wpb=17612.4, bsz=1024, num_updates=17470, lr=2.94254e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=112612
2024-11-07 20:59:12 - progress_bar.py[line:274] - INFO: epoch 045:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17503.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2975.8, ups=0.17, wpb=17503.1, bsz=1024, num_updates=17480, lr=2.94118e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=112671
2024-11-07 20:59:29 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 21:00:15 - progress_bar.py[line:274] - INFO: epoch 045:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=18162.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=2872.8, ups=0.16, wpb=18162.5, bsz=1024, num_updates=17490, lr=2.93982e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=112734
2024-11-07 21:01:13 - progress_bar.py[line:274] - INFO: epoch 045:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.457, ntokens=18373.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3176, ups=0.17, wpb=18373.9, bsz=1024, num_updates=17500, lr=2.93846e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=112792
2024-11-07 21:02:11 - progress_bar.py[line:274] - INFO: epoch 045:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17967.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3106.3, ups=0.17, wpb=17967.8, bsz=1024, num_updates=17510, lr=2.9371e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=112850
2024-11-07 21:03:09 - progress_bar.py[line:274] - INFO: epoch 045:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.386, ntokens=17918.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3088.4, ups=0.17, wpb=17918.3, bsz=1024, num_updates=17520, lr=2.93573e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=112908
2024-11-07 21:04:07 - progress_bar.py[line:274] - INFO: epoch 045:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=18309.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3179.2, ups=0.17, wpb=18309.1, bsz=1024, num_updates=17530, lr=2.93437e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=112965
2024-11-07 21:05:04 - progress_bar.py[line:274] - INFO: epoch 045:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=18814.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3262.9, ups=0.17, wpb=18814.7, bsz=1024, num_updates=17540, lr=2.93301e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=113023
2024-11-07 21:06:02 - progress_bar.py[line:274] - INFO: epoch 045:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=18346.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3164.8, ups=0.17, wpb=18346.4, bsz=1024, num_updates=17550, lr=2.93165e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=113081
2024-11-07 21:07:00 - progress_bar.py[line:274] - INFO: epoch 045:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17769.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3095.1, ups=0.17, wpb=17769.5, bsz=1024, num_updates=17560, lr=2.93029e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=113138
2024-11-07 21:07:57 - progress_bar.py[line:274] - INFO: epoch 045:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=17867.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=3099.8, ups=0.17, wpb=17867.6, bsz=1024, num_updates=17570, lr=2.92893e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=113196
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt

2024-11-07 21:08:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 45 @ 17576 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
2024-11-07 21:08:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 21:10:24 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 21:12:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 45 @ 17576 updates, score 0) (writing took 230.20173437098856 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 21:13:15 - train.py[line:336] - INFO: end of epoch 45 (average epoch stats below)
2024-11-07 21:13:15 - progress_bar.py[line:282] - INFO: epoch 045 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.354 | ntokens 17799 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.11 | wps 2554 | ups 0.14 | wpb 17799 | bsz 1023 | num_updates 17576 | lr 2.92812e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1443 | gb_free 13.3 | wall 113514
2024-11-07 21:13:15 - trainer.py[line:639] - INFO: loading train data for epoch 46
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 21:15:58 - trainer.py[line:703] - INFO: begin training epoch 46
2024-11-07 21:15:58 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 21:16:24 - progress_bar.py[line:274] - INFO: epoch 046:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17615.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=347.9, ups=0.02, wpb=17615.9, bsz=985.6, num_updates=17580, lr=2.92757e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=113702
2024-11-07 21:17:23 - progress_bar.py[line:274] - INFO: epoch 046:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.319, ntokens=17652.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=2979.2, ups=0.17, wpb=17652.4, bsz=1024, num_updates=17590, lr=2.92621e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=113762
2024-11-07 21:18:22 - progress_bar.py[line:274] - INFO: epoch 046:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17491.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=2970.2, ups=0.17, wpb=17491.3, bsz=1024, num_updates=17600, lr=2.92485e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=113821
2024-11-07 21:19:21 - progress_bar.py[line:274] - INFO: epoch 046:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.29, ntokens=17667, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.89, wps=2999.3, ups=0.17, wpb=17667, bsz=1024, num_updates=17610, lr=2.92349e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=113880
2024-11-07 21:20:20 - progress_bar.py[line:274] - INFO: epoch 046:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.319, ntokens=17691.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=2969.4, ups=0.17, wpb=17691.7, bsz=1024, num_updates=17620, lr=2.92213e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=113939
2024-11-07 21:21:19 - progress_bar.py[line:274] - INFO: epoch 046:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17817.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3035.9, ups=0.17, wpb=17817.9, bsz=1024, num_updates=17630, lr=2.92077e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=113998
2024-11-07 21:22:14 - progress_bar.py[line:274] - INFO: epoch 046:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=18003.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3281.1, ups=0.18, wpb=18003.6, bsz=1024, num_updates=17640, lr=2.91941e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114053
2024-11-07 21:23:10 - progress_bar.py[line:274] - INFO: epoch 046:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=17571.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3112.7, ups=0.18, wpb=17571.6, bsz=1024, num_updates=17650, lr=2.91805e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114109
2024-11-07 21:24:09 - progress_bar.py[line:274] - INFO: epoch 046:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17943.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3049.2, ups=0.17, wpb=17943.1, bsz=1024, num_updates=17660, lr=2.91669e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114168
2024-11-07 21:25:08 - progress_bar.py[line:274] - INFO: epoch 046:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17752.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3003.6, ups=0.17, wpb=17752.2, bsz=1024, num_updates=17670, lr=2.91533e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=114227
2024-11-07 21:26:06 - progress_bar.py[line:274] - INFO: epoch 046:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.324, ntokens=17676.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3081.6, ups=0.17, wpb=17676.6, bsz=1024, num_updates=17680, lr=2.91397e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114284
2024-11-07 21:27:05 - progress_bar.py[line:274] - INFO: epoch 046:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17495.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=2967.8, ups=0.17, wpb=17495.6, bsz=1024, num_updates=17690, lr=2.91261e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114343
2024-11-07 21:28:03 - progress_bar.py[line:274] - INFO: epoch 046:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.374, ntokens=18079.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3103.8, ups=0.17, wpb=18079.7, bsz=1024, num_updates=17700, lr=2.91125e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114402
2024-11-07 21:29:01 - progress_bar.py[line:274] - INFO: epoch 046:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.268, ntokens=17095.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=2960.7, ups=0.17, wpb=17095.2, bsz=1024, num_updates=17710, lr=2.90989e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114459
2024-11-07 21:29:59 - progress_bar.py[line:274] - INFO: epoch 046:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17969.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3086.7, ups=0.17, wpb=17969.4, bsz=1024, num_updates=17720, lr=2.90853e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114518
2024-11-07 21:30:57 - progress_bar.py[line:274] - INFO: epoch 046:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.3, ntokens=17642.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3053, ups=0.17, wpb=17642.6, bsz=1024, num_updates=17730, lr=2.90717e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114575
2024-11-07 21:31:54 - progress_bar.py[line:274] - INFO: epoch 046:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17811, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3078.6, ups=0.17, wpb=17811, bsz=1024, num_updates=17740, lr=2.90581e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114633
2024-11-07 21:32:53 - progress_bar.py[line:274] - INFO: epoch 046:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=17730.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3040.1, ups=0.17, wpb=17730.9, bsz=1024, num_updates=17750, lr=2.90445e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114692
2024-11-07 21:33:51 - progress_bar.py[line:274] - INFO: epoch 046:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=17859.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3041.9, ups=0.17, wpb=17859.4, bsz=1024, num_updates=17760, lr=2.90309e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114750
2024-11-07 21:34:50 - progress_bar.py[line:274] - INFO: epoch 046:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17766.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3010.5, ups=0.17, wpb=17766.1, bsz=1024, num_updates=17770, lr=2.90172e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=114809
2024-11-07 21:35:49 - progress_bar.py[line:274] - INFO: epoch 046:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.37, ntokens=18038.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3099.5, ups=0.17, wpb=18038.2, bsz=1024, num_updates=17780, lr=2.90036e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=114867
2024-11-07 21:36:47 - progress_bar.py[line:274] - INFO: epoch 046:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17787.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3049, ups=0.17, wpb=17787.7, bsz=1024, num_updates=17790, lr=2.899e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114926
2024-11-07 21:37:46 - progress_bar.py[line:274] - INFO: epoch 046:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.352, ntokens=17929.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3028, ups=0.17, wpb=17929.5, bsz=1024, num_updates=17800, lr=2.89764e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=114985
2024-11-07 21:38:45 - progress_bar.py[line:274] - INFO: epoch 046:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17759, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3016.7, ups=0.17, wpb=17759, bsz=1024, num_updates=17810, lr=2.89628e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115044
2024-11-07 21:39:43 - progress_bar.py[line:274] - INFO: epoch 046:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.272, ntokens=17288.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.83, wps=2962.4, ups=0.17, wpb=17288.3, bsz=1024, num_updates=17820, lr=2.89492e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115102
2024-11-07 21:40:42 - progress_bar.py[line:274] - INFO: epoch 046:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.348, ntokens=17893.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3061.4, ups=0.17, wpb=17893.6, bsz=1024, num_updates=17830, lr=2.89356e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115161
2024-11-07 21:41:41 - progress_bar.py[line:274] - INFO: epoch 046:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=17919.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3046.7, ups=0.17, wpb=17919.9, bsz=1024, num_updates=17840, lr=2.8922e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=115220
2024-11-07 21:42:39 - progress_bar.py[line:274] - INFO: epoch 046:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17545, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3002.1, ups=0.17, wpb=17545, bsz=1024, num_updates=17850, lr=2.89084e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115278
2024-11-07 21:43:37 - progress_bar.py[line:274] - INFO: epoch 046:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17819.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3062.7, ups=0.17, wpb=17819.7, bsz=1024, num_updates=17860, lr=2.88948e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=115336
2024-11-07 21:44:36 - progress_bar.py[line:274] - INFO: epoch 046:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.334, ntokens=17602.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=2992.8, ups=0.17, wpb=17602.4, bsz=1024, num_updates=17870, lr=2.88812e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=115395
2024-11-07 21:45:34 - progress_bar.py[line:274] - INFO: epoch 046:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=18323.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3161.7, ups=0.17, wpb=18323.7, bsz=1024, num_updates=17880, lr=2.88676e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=115453
2024-11-07 21:46:32 - progress_bar.py[line:274] - INFO: epoch 046:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.503, ntokens=18660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3197, ups=0.17, wpb=18660.5, bsz=1024, num_updates=17890, lr=2.8854e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=115511
2024-11-07 21:47:30 - progress_bar.py[line:274] - INFO: epoch 046:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.412, ntokens=18103.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3119.7, ups=0.17, wpb=18103.5, bsz=1024, num_updates=17900, lr=2.88404e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115569
2024-11-07 21:48:29 - progress_bar.py[line:274] - INFO: epoch 046:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=18274.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3136.5, ups=0.17, wpb=18274.8, bsz=1024, num_updates=17910, lr=2.88268e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115628
2024-11-07 21:49:26 - progress_bar.py[line:274] - INFO: epoch 046:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17981, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3121.6, ups=0.17, wpb=17981, bsz=1024, num_updates=17920, lr=2.88132e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=115685
2024-11-07 21:50:24 - progress_bar.py[line:274] - INFO: epoch 046:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.429, ntokens=18433.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3186.5, ups=0.17, wpb=18433.2, bsz=1024, num_updates=17930, lr=2.87996e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=115743
2024-11-07 21:51:19 - progress_bar.py[line:274] - INFO: epoch 046:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=18200.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3350, ups=0.18, wpb=18200.1, bsz=1024, num_updates=17940, lr=2.8786e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=115797
2024-11-07 21:52:11 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 21:52:22 - progress_bar.py[line:274] - INFO: epoch 046:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=18280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=2858, ups=0.16, wpb=18280.7, bsz=1024, num_updates=17950, lr=2.87724e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=35, gb_free=13.4, wall=115861
2024-11-07 21:53:18 - progress_bar.py[line:274] - INFO: epoch 046:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17746.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3174.6, ups=0.18, wpb=17746.9, bsz=1024, num_updates=17960, lr=2.87588e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=35, gb_free=13.3, wall=115917
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt

2024-11-07 21:53:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 46 @ 17966 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
2024-11-07 21:53:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 21:55:37 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 21:57:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 46 @ 17966 updates, score 0) (writing took 222.86283666599775 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-07 21:58:28 - train.py[line:336] - INFO: end of epoch 46 (average epoch stats below)
2024-11-07 21:58:28 - progress_bar.py[line:282] - INFO: epoch 046 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.354 | ntokens 17839.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.11 | wps 2563.8 | ups 0.14 | wpb 17839.1 | bsz 1023 | num_updates 17966 | lr 2.87506e-05 | gnorm 0.009 | clip 0 | loss_scale 16384 | train_wall 1227 | gb_free 13.4 | wall 116227
2024-11-07 21:58:28 - trainer.py[line:639] - INFO: loading train data for epoch 47
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 22:01:11 - trainer.py[line:703] - INFO: begin training epoch 47
2024-11-07 22:01:11 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 22:01:37 - progress_bar.py[line:274] - INFO: epoch 047:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.382, ntokens=17314.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.21, wps=347.3, ups=0.02, wpb=17314.5, bsz=985.6, num_updates=17970, lr=2.87452e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=116416
2024-11-07 22:02:37 - progress_bar.py[line:274] - INFO: epoch 047:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.285, ntokens=17354, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=2909.9, ups=0.17, wpb=17354, bsz=1024, num_updates=17980, lr=2.87316e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=116475
2024-11-07 22:03:36 - progress_bar.py[line:274] - INFO: epoch 047:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.349, ntokens=17700.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=2974.6, ups=0.17, wpb=17700.2, bsz=1024, num_updates=17990, lr=2.8718e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=116535
2024-11-07 22:04:35 - progress_bar.py[line:274] - INFO: epoch 047:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.335, ntokens=17858.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3003.8, ups=0.17, wpb=17858.2, bsz=1024, num_updates=18000, lr=2.87044e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=116594
2024-11-07 22:05:34 - progress_bar.py[line:274] - INFO: epoch 047:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17839.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3047.5, ups=0.17, wpb=17839.7, bsz=1024, num_updates=18010, lr=2.86908e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=116653
2024-11-07 22:06:32 - progress_bar.py[line:274] - INFO: epoch 047:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.296, ntokens=17386.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=2996.6, ups=0.17, wpb=17386.9, bsz=1024, num_updates=18020, lr=2.86772e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=116711
2024-11-07 22:07:28 - progress_bar.py[line:274] - INFO: epoch 047:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=18023.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3236.4, ups=0.18, wpb=18023.2, bsz=1024, num_updates=18030, lr=2.86635e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=116767
2024-11-07 22:08:24 - progress_bar.py[line:274] - INFO: epoch 047:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17672.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3122.2, ups=0.18, wpb=17672.6, bsz=1024, num_updates=18040, lr=2.86499e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=116823
2024-11-07 22:09:23 - progress_bar.py[line:274] - INFO: epoch 047:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.292, ntokens=17521.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3005, ups=0.17, wpb=17521.4, bsz=1024, num_updates=18050, lr=2.86363e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=116882
2024-11-07 22:10:21 - progress_bar.py[line:274] - INFO: epoch 047:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17660.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3016.3, ups=0.17, wpb=17660.3, bsz=1024, num_updates=18060, lr=2.86227e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=49, gb_free=13.5, wall=116940
2024-11-07 22:11:17 - progress_bar.py[line:274] - INFO: epoch 047:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.322, ntokens=17672.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3156.4, ups=0.18, wpb=17672.7, bsz=1024, num_updates=18070, lr=2.86091e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=48, gb_free=13.5, wall=116996
2024-11-07 22:12:16 - progress_bar.py[line:274] - INFO: epoch 047:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.356, ntokens=17689.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=2986.6, ups=0.17, wpb=17689.1, bsz=1024, num_updates=18080, lr=2.85955e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117055
2024-11-07 22:13:16 - progress_bar.py[line:274] - INFO: epoch 047:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17681.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2969.5, ups=0.17, wpb=17681.6, bsz=1024, num_updates=18090, lr=2.85819e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117115
2024-11-07 22:14:15 - progress_bar.py[line:274] - INFO: epoch 047:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17464.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=2964.1, ups=0.17, wpb=17464.2, bsz=1024, num_updates=18100, lr=2.85683e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117174
2024-11-07 22:15:11 - progress_bar.py[line:274] - INFO: epoch 047:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17682.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3152.5, ups=0.18, wpb=17682.4, bsz=1024, num_updates=18110, lr=2.85547e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117230
2024-11-07 22:16:10 - progress_bar.py[line:274] - INFO: epoch 047:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.309, ntokens=17535.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=2991.8, ups=0.17, wpb=17535.9, bsz=1024, num_updates=18120, lr=2.85411e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117288
2024-11-07 22:17:09 - progress_bar.py[line:274] - INFO: epoch 047:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=17893.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3026.7, ups=0.17, wpb=17893.7, bsz=1024, num_updates=18130, lr=2.85275e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117348
2024-11-07 22:18:07 - progress_bar.py[line:274] - INFO: epoch 047:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.32, ntokens=17713.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3026.6, ups=0.17, wpb=17713.4, bsz=1024, num_updates=18140, lr=2.85139e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117406
2024-11-07 22:19:06 - progress_bar.py[line:274] - INFO: epoch 047:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17725.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=2991.8, ups=0.17, wpb=17725.9, bsz=1024, num_updates=18150, lr=2.85003e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117465
2024-11-07 22:20:04 - progress_bar.py[line:274] - INFO: epoch 047:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17539.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3041.3, ups=0.17, wpb=17539.5, bsz=1024, num_updates=18160, lr=2.84867e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117523
2024-11-07 22:21:03 - progress_bar.py[line:274] - INFO: epoch 047:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17914.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3030, ups=0.17, wpb=17914.8, bsz=1024, num_updates=18170, lr=2.84731e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=117582
2024-11-07 22:22:02 - progress_bar.py[line:274] - INFO: epoch 047:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.392, ntokens=18159.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3115.6, ups=0.17, wpb=18159.1, bsz=1024, num_updates=18180, lr=2.84595e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117640
2024-11-07 22:23:01 - progress_bar.py[line:274] - INFO: epoch 047:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.293, ntokens=17531.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=2935.5, ups=0.17, wpb=17531.6, bsz=1024, num_updates=18190, lr=2.84459e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117700
2024-11-07 22:24:01 - progress_bar.py[line:274] - INFO: epoch 047:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.294, ntokens=17491.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=2946.3, ups=0.17, wpb=17491.2, bsz=1024, num_updates=18200, lr=2.84323e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=117760
2024-11-07 22:24:59 - progress_bar.py[line:274] - INFO: epoch 047:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17724.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3028, ups=0.17, wpb=17724.3, bsz=1024, num_updates=18210, lr=2.84187e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117818
2024-11-07 22:25:53 - progress_bar.py[line:274] - INFO: epoch 047:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=17982.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3339.9, ups=0.19, wpb=17982.1, bsz=1024, num_updates=18220, lr=2.84051e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=117872
2024-11-07 22:26:51 - progress_bar.py[line:274] - INFO: epoch 047:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.346, ntokens=17987.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3086.1, ups=0.17, wpb=17987.8, bsz=1024, num_updates=18230, lr=2.83915e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=51, gb_free=13.5, wall=117930
2024-11-07 22:27:50 - progress_bar.py[line:274] - INFO: epoch 047:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17916, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3077.7, ups=0.17, wpb=17916, bsz=1024, num_updates=18240, lr=2.83779e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=117988
2024-11-07 22:28:45 - progress_bar.py[line:274] - INFO: epoch 047:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.309, ntokens=17575.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3147.7, ups=0.18, wpb=17575.8, bsz=1024, num_updates=18250, lr=2.83643e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=118044
2024-11-07 22:29:42 - progress_bar.py[line:274] - INFO: epoch 047:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17680.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3117.5, ups=0.18, wpb=17680.3, bsz=1024, num_updates=18260, lr=2.83507e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=37, gb_free=13.4, wall=118101
2024-11-07 22:30:41 - progress_bar.py[line:274] - INFO: epoch 047:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=18167, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3086.5, ups=0.17, wpb=18167, bsz=1024, num_updates=18270, lr=2.83371e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=40, gb_free=13.3, wall=118160
2024-11-07 22:31:38 - progress_bar.py[line:274] - INFO: epoch 047:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=18184, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3169.7, ups=0.17, wpb=18184, bsz=1024, num_updates=18280, lr=2.83234e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=118217
2024-11-07 22:32:36 - progress_bar.py[line:274] - INFO: epoch 047:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=18241.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3141.6, ups=0.17, wpb=18241.7, bsz=1024, num_updates=18290, lr=2.83098e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=118275
2024-11-07 22:33:35 - progress_bar.py[line:274] - INFO: epoch 047:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=18399.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3161.9, ups=0.17, wpb=18399.6, bsz=1024, num_updates=18300, lr=2.82962e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=118333
2024-11-07 22:34:32 - progress_bar.py[line:274] - INFO: epoch 047:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=18337.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3199, ups=0.17, wpb=18337.4, bsz=1024, num_updates=18310, lr=2.82826e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=118391
2024-11-07 22:35:29 - progress_bar.py[line:274] - INFO: epoch 047:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=18863.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3307.6, ups=0.18, wpb=18863.9, bsz=1024, num_updates=18320, lr=2.8269e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=118448
2024-11-07 22:36:25 - progress_bar.py[line:274] - INFO: epoch 047:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.459, ntokens=18656.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3300.9, ups=0.18, wpb=18656.6, bsz=1024, num_updates=18330, lr=2.82554e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=118504
2024-11-07 22:37:22 - progress_bar.py[line:274] - INFO: epoch 047:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=18283.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3205.8, ups=0.18, wpb=18283.6, bsz=1024, num_updates=18340, lr=2.82418e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=118561
2024-11-07 22:38:18 - progress_bar.py[line:274] - INFO: epoch 047:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17973.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3210, ups=0.18, wpb=17973.9, bsz=1024, num_updates=18350, lr=2.82282e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=118617
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt

2024-11-07 22:38:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 47 @ 18357 updates
2024-11-07 22:38:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 22:40:42 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-07 22:42:35 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 47 @ 18357 updates, score 0) (writing took 220.4792356659891 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 22:43:31 - train.py[line:336] - INFO: end of epoch 47 (average epoch stats below)
2024-11-07 22:43:31 - progress_bar.py[line:282] - INFO: epoch 047 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.356 | ntokens 17853.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.12 | wps 2583.4 | ups 0.14 | wpb 17853.2 | bsz 1023 | num_updates 18357 | lr 2.82187e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1366 | gb_free 13.3 | wall 118929
2024-11-07 22:43:31 - trainer.py[line:639] - INFO: loading train data for epoch 48
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 22:46:10 - trainer.py[line:703] - INFO: begin training epoch 48
2024-11-07 22:46:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 22:46:29 - progress_bar.py[line:274] - INFO: epoch 048:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17449, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=355.5, ups=0.02, wpb=17449, bsz=985.6, num_updates=18360, lr=2.82146e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=29, gb_free=13.4, wall=119108
2024-11-07 22:47:28 - progress_bar.py[line:274] - INFO: epoch 048:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.327, ntokens=17663.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3000.8, ups=0.17, wpb=17663.6, bsz=1024, num_updates=18370, lr=2.8201e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=119167
2024-11-07 22:48:27 - progress_bar.py[line:274] - INFO: epoch 048:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17584.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=2989.5, ups=0.17, wpb=17584.4, bsz=1024, num_updates=18380, lr=2.81874e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=119226
2024-11-07 22:49:23 - progress_bar.py[line:274] - INFO: epoch 048:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17877.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3179.2, ups=0.18, wpb=17877.7, bsz=1024, num_updates=18390, lr=2.81738e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=119282
2024-11-07 22:50:20 - progress_bar.py[line:274] - INFO: epoch 048:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17905.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3148.2, ups=0.18, wpb=17905.4, bsz=1024, num_updates=18400, lr=2.81602e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=47, gb_free=13.4, wall=119339
2024-11-07 22:51:17 - progress_bar.py[line:274] - INFO: epoch 048:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.308, ntokens=17588.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3084.7, ups=0.18, wpb=17588.2, bsz=1024, num_updates=18410, lr=2.81466e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=57, gb_free=13.6, wall=119396
2024-11-07 22:52:14 - progress_bar.py[line:274] - INFO: epoch 048:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=18012.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3164.3, ups=0.18, wpb=18012.4, bsz=1024, num_updates=18420, lr=2.8133e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=119453
2024-11-07 22:53:11 - progress_bar.py[line:274] - INFO: epoch 048:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17790.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3107.6, ups=0.17, wpb=17790.4, bsz=1024, num_updates=18430, lr=2.81194e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=57, gb_free=13.5, wall=119510
2024-11-07 22:54:09 - progress_bar.py[line:274] - INFO: epoch 048:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.309, ntokens=17627, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3075.4, ups=0.17, wpb=17627, bsz=1024, num_updates=18440, lr=2.81058e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13.5, wall=119567
2024-11-07 22:55:05 - progress_bar.py[line:274] - INFO: epoch 048:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.332, ntokens=17754.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3134.1, ups=0.18, wpb=17754.5, bsz=1024, num_updates=18450, lr=2.80922e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=47, gb_free=13.5, wall=119624
2024-11-07 22:56:03 - progress_bar.py[line:274] - INFO: epoch 048:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.279, ntokens=17325.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3019.1, ups=0.17, wpb=17325.8, bsz=1024, num_updates=18460, lr=2.80786e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=39, gb_free=13.6, wall=119681
2024-11-07 22:57:01 - progress_bar.py[line:274] - INFO: epoch 048:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.268, ntokens=17110.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=2917.5, ups=0.17, wpb=17110.4, bsz=1024, num_updates=18470, lr=2.8065e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=119740
2024-11-07 22:58:00 - progress_bar.py[line:274] - INFO: epoch 048:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=17997.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3043.7, ups=0.17, wpb=17997.5, bsz=1024, num_updates=18480, lr=2.80514e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=119799
2024-11-07 22:59:00 - progress_bar.py[line:274] - INFO: epoch 048:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=17524.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=2952.9, ups=0.17, wpb=17524.8, bsz=1024, num_updates=18490, lr=2.80378e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=119859
2024-11-07 22:59:58 - progress_bar.py[line:274] - INFO: epoch 048:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17992.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3104.8, ups=0.17, wpb=17992.6, bsz=1024, num_updates=18500, lr=2.80242e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=119917
2024-11-07 23:00:57 - progress_bar.py[line:274] - INFO: epoch 048:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=17759.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=2991.1, ups=0.17, wpb=17759.9, bsz=1024, num_updates=18510, lr=2.80106e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=119976
2024-11-07 23:01:56 - progress_bar.py[line:274] - INFO: epoch 048:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.307, ntokens=17636.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=2986.4, ups=0.17, wpb=17636.6, bsz=1024, num_updates=18520, lr=2.7997e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120035
2024-11-07 23:02:54 - progress_bar.py[line:274] - INFO: epoch 048:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17914.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3079.2, ups=0.17, wpb=17914.4, bsz=1024, num_updates=18530, lr=2.79833e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=120093
2024-11-07 23:03:53 - progress_bar.py[line:274] - INFO: epoch 048:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.314, ntokens=17667.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=2998.4, ups=0.17, wpb=17667.3, bsz=1024, num_updates=18540, lr=2.79697e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120152
2024-11-07 23:04:52 - progress_bar.py[line:274] - INFO: epoch 048:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.346, ntokens=17751.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3006.5, ups=0.17, wpb=17751.1, bsz=1024, num_updates=18550, lr=2.79561e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=120211
2024-11-07 23:05:48 - progress_bar.py[line:274] - INFO: epoch 048:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17913.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3217.4, ups=0.18, wpb=17913.3, bsz=1024, num_updates=18560, lr=2.79425e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120267
2024-11-07 23:06:45 - progress_bar.py[line:274] - INFO: epoch 048:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.323, ntokens=17841.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3119.4, ups=0.17, wpb=17841.1, bsz=1024, num_updates=18570, lr=2.79289e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120324
2024-11-07 23:07:43 - progress_bar.py[line:274] - INFO: epoch 048:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17872.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3097.1, ups=0.17, wpb=17872.3, bsz=1024, num_updates=18580, lr=2.79153e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=120382
2024-11-07 23:08:41 - progress_bar.py[line:274] - INFO: epoch 048:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.32, ntokens=17777, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3047.1, ups=0.17, wpb=17777, bsz=1024, num_updates=18590, lr=2.79017e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=120440
2024-11-07 23:09:40 - progress_bar.py[line:274] - INFO: epoch 048:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.324, ntokens=17643.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3019.4, ups=0.17, wpb=17643.7, bsz=1024, num_updates=18600, lr=2.78881e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=120499
2024-11-07 23:10:38 - progress_bar.py[line:274] - INFO: epoch 048:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17904.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3090.4, ups=0.17, wpb=17904.6, bsz=1024, num_updates=18610, lr=2.78745e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120556
2024-11-07 23:11:35 - progress_bar.py[line:274] - INFO: epoch 048:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17739.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3069.4, ups=0.17, wpb=17739.3, bsz=1024, num_updates=18620, lr=2.78609e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120614
2024-11-07 23:12:32 - progress_bar.py[line:274] - INFO: epoch 048:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=18226.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3202, ups=0.18, wpb=18226.8, bsz=1024, num_updates=18630, lr=2.78473e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=120671
2024-11-07 23:13:29 - progress_bar.py[line:274] - INFO: epoch 048:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.298, ntokens=17440.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.92, wps=3054.2, ups=0.18, wpb=17440.5, bsz=1024, num_updates=18640, lr=2.78337e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=120728
2024-11-07 23:14:23 - progress_bar.py[line:274] - INFO: epoch 048:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.312, ntokens=17725, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3287.3, ups=0.19, wpb=17725, bsz=1024, num_updates=18650, lr=2.78201e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=120782
2024-11-07 23:15:19 - progress_bar.py[line:274] - INFO: epoch 048:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=17934.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3223.7, ups=0.18, wpb=17934.2, bsz=1024, num_updates=18660, lr=2.78065e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=120838
2024-11-07 23:16:16 - progress_bar.py[line:274] - INFO: epoch 048:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=18468.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3244.1, ups=0.18, wpb=18468.6, bsz=1024, num_updates=18670, lr=2.77929e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=120895
2024-11-07 23:17:13 - progress_bar.py[line:274] - INFO: epoch 048:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=18080.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3175.4, ups=0.18, wpb=18080.1, bsz=1024, num_updates=18680, lr=2.77793e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=120952
2024-11-07 23:18:10 - progress_bar.py[line:274] - INFO: epoch 048:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=18234.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3192.7, ups=0.18, wpb=18234.8, bsz=1024, num_updates=18690, lr=2.77657e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=121009
2024-11-07 23:19:07 - progress_bar.py[line:274] - INFO: epoch 048:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=17946.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3150.2, ups=0.18, wpb=17946.1, bsz=1024, num_updates=18700, lr=2.77521e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=121066
2024-11-07 23:20:04 - progress_bar.py[line:274] - INFO: epoch 048:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=18357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3231.6, ups=0.18, wpb=18357.9, bsz=1024, num_updates=18710, lr=2.77385e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=121123
2024-11-07 23:21:00 - progress_bar.py[line:274] - INFO: epoch 048:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=18234.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3217, ups=0.18, wpb=18234.1, bsz=1024, num_updates=18720, lr=2.77249e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=121179
2024-11-07 23:21:57 - progress_bar.py[line:274] - INFO: epoch 048:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=18068.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3197.8, ups=0.18, wpb=18068.1, bsz=1024, num_updates=18730, lr=2.77113e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=121236
2024-11-07 23:22:54 - progress_bar.py[line:274] - INFO: epoch 048:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.366, ntokens=17953.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3155.4, ups=0.18, wpb=17953.8, bsz=1024, num_updates=18740, lr=2.76977e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=121293
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt

2024-11-07 23:23:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 48 @ 18748 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
2024-11-07 23:23:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 23:25:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 23:27:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 48 @ 18748 updates, score 0) (writing took 227.11475652598892 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 23:28:18 - train.py[line:336] - INFO: end of epoch 48 (average epoch stats below)
2024-11-07 23:28:18 - progress_bar.py[line:282] - INFO: epoch 048 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.342 | ntokens 17817.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.07 | wps 2592.1 | ups 0.15 | wpb 17817.2 | bsz 1023 | num_updates 18748 | lr 2.76868e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1577 | gb_free 13.3 | wall 121617
2024-11-07 23:28:18 - trainer.py[line:639] - INFO: loading train data for epoch 49
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 23:30:59 - trainer.py[line:703] - INFO: begin training epoch 49
2024-11-07 23:30:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 23:31:12 - progress_bar.py[line:274] - INFO: epoch 049:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.331, ntokens=17183.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=344.6, ups=0.02, wpb=17183.8, bsz=985.6, num_updates=18750, lr=2.76841e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.6, wall=121791
2024-11-07 23:32:09 - progress_bar.py[line:274] - INFO: epoch 049:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.272, ntokens=17312.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.83, wps=3083.6, ups=0.18, wpb=17312.4, bsz=1024, num_updates=18760, lr=2.76705e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=121847
2024-11-07 23:33:05 - progress_bar.py[line:274] - INFO: epoch 049:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.342, ntokens=17933.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3205.7, ups=0.18, wpb=17933.1, bsz=1024, num_updates=18770, lr=2.76569e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=41, gb_free=13.5, wall=121903
2024-11-07 23:34:01 - progress_bar.py[line:274] - INFO: epoch 049:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.253, ntokens=17389.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.77, wps=3066.4, ups=0.18, wpb=17389.5, bsz=1024, num_updates=18780, lr=2.76432e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.6, wall=121960
2024-11-07 23:34:55 - progress_bar.py[line:274] - INFO: epoch 049:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17629.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3264.4, ups=0.19, wpb=17629.4, bsz=1024, num_updates=18790, lr=2.76296e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=122014
2024-11-07 23:35:53 - progress_bar.py[line:274] - INFO: epoch 049:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17625.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3066.9, ups=0.17, wpb=17625.7, bsz=1024, num_updates=18800, lr=2.7616e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=122072
2024-11-07 23:36:50 - progress_bar.py[line:274] - INFO: epoch 049:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=18203.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3166.1, ups=0.17, wpb=18203.2, bsz=1024, num_updates=18810, lr=2.76024e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=122129
2024-11-07 23:37:47 - progress_bar.py[line:274] - INFO: epoch 049:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=18053.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3171.3, ups=0.18, wpb=18053.8, bsz=1024, num_updates=18820, lr=2.75888e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=122186
2024-11-07 23:38:45 - progress_bar.py[line:274] - INFO: epoch 049:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.299, ntokens=17631, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.92, wps=3075, ups=0.17, wpb=17631, bsz=1024, num_updates=18830, lr=2.75752e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=122243
2024-11-07 23:39:42 - progress_bar.py[line:274] - INFO: epoch 049:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.316, ntokens=17667.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3099, ups=0.18, wpb=17667.6, bsz=1024, num_updates=18840, lr=2.75616e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=122300
2024-11-07 23:40:40 - progress_bar.py[line:274] - INFO: epoch 049:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.316, ntokens=17745.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3015.2, ups=0.17, wpb=17745.2, bsz=1024, num_updates=18850, lr=2.7548e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122359
2024-11-07 23:41:39 - progress_bar.py[line:274] - INFO: epoch 049:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.301, ntokens=17446.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=2967.1, ups=0.17, wpb=17446.3, bsz=1024, num_updates=18860, lr=2.75344e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=122418
2024-11-07 23:42:39 - progress_bar.py[line:274] - INFO: epoch 049:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.343, ntokens=17843.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3005.2, ups=0.17, wpb=17843.9, bsz=1024, num_updates=18870, lr=2.75208e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122477
2024-11-07 23:43:38 - progress_bar.py[line:274] - INFO: epoch 049:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.292, ntokens=17350.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=2901.7, ups=0.17, wpb=17350.3, bsz=1024, num_updates=18880, lr=2.75072e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122537
2024-11-07 23:44:37 - progress_bar.py[line:274] - INFO: epoch 049:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17870.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3039.7, ups=0.17, wpb=17870.9, bsz=1024, num_updates=18890, lr=2.74936e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=122596
2024-11-07 23:45:34 - progress_bar.py[line:274] - INFO: epoch 049:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17753.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3138.8, ups=0.18, wpb=17753.5, bsz=1024, num_updates=18900, lr=2.748e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122653
2024-11-07 23:46:32 - progress_bar.py[line:274] - INFO: epoch 049:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.283, ntokens=17588.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=3029, ups=0.17, wpb=17588.3, bsz=1024, num_updates=18910, lr=2.74664e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=122711
2024-11-07 23:47:31 - progress_bar.py[line:274] - INFO: epoch 049:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.311, ntokens=17747.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3009.4, ups=0.17, wpb=17747.2, bsz=1024, num_updates=18920, lr=2.74528e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122770
2024-11-07 23:48:30 - progress_bar.py[line:274] - INFO: epoch 049:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.307, ntokens=17591.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=2963.3, ups=0.17, wpb=17591.8, bsz=1024, num_updates=18930, lr=2.74392e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122829
2024-11-07 23:49:29 - progress_bar.py[line:274] - INFO: epoch 049:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=17972, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3046.1, ups=0.17, wpb=17972, bsz=1024, num_updates=18940, lr=2.74256e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=122888
2024-11-07 23:50:29 - progress_bar.py[line:274] - INFO: epoch 049:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=17797.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=2978.2, ups=0.17, wpb=17797.2, bsz=1024, num_updates=18950, lr=2.7412e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=122948
2024-11-07 23:51:28 - progress_bar.py[line:274] - INFO: epoch 049:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.363, ntokens=18139, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3089.1, ups=0.17, wpb=18139, bsz=1024, num_updates=18960, lr=2.73984e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=123006
2024-11-07 23:52:26 - progress_bar.py[line:274] - INFO: epoch 049:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17820.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3032.5, ups=0.17, wpb=17820.3, bsz=1024, num_updates=18970, lr=2.73848e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=123065
2024-11-07 23:53:25 - progress_bar.py[line:274] - INFO: epoch 049:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.301, ntokens=17687.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3002.5, ups=0.17, wpb=17687.1, bsz=1024, num_updates=18980, lr=2.73712e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123124
2024-11-07 23:54:24 - progress_bar.py[line:274] - INFO: epoch 049:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.295, ntokens=17523.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3005.3, ups=0.17, wpb=17523.4, bsz=1024, num_updates=18990, lr=2.73576e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=123182
2024-11-07 23:55:22 - progress_bar.py[line:274] - INFO: epoch 049:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.296, ntokens=17593.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3006.1, ups=0.17, wpb=17593.8, bsz=1024, num_updates=19000, lr=2.7344e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=123241
2024-11-07 23:56:21 - progress_bar.py[line:274] - INFO: epoch 049:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17896.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3034.6, ups=0.17, wpb=17896.5, bsz=1024, num_updates=19010, lr=2.73304e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=123300
2024-11-07 23:57:21 - progress_bar.py[line:274] - INFO: epoch 049:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17981.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3018.5, ups=0.17, wpb=17981.8, bsz=1024, num_updates=19020, lr=2.73168e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=123360
2024-11-07 23:58:17 - progress_bar.py[line:274] - INFO: epoch 049:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.308, ntokens=17620, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3104, ups=0.18, wpb=17620, bsz=1024, num_updates=19030, lr=2.73032e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=123416
2024-11-07 23:59:16 - progress_bar.py[line:274] - INFO: epoch 049:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17971.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3077.5, ups=0.17, wpb=17971.7, bsz=1024, num_updates=19040, lr=2.72895e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=123475
2024-11-08 00:00:14 - progress_bar.py[line:274] - INFO: epoch 049:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.368, ntokens=17934.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.16, wps=3080.8, ups=0.17, wpb=17934.2, bsz=1024, num_updates=19050, lr=2.72759e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123533
2024-11-08 00:01:12 - progress_bar.py[line:274] - INFO: epoch 049:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=18200.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3127, ups=0.17, wpb=18200.7, bsz=1024, num_updates=19060, lr=2.72623e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123591
2024-11-08 00:02:10 - progress_bar.py[line:274] - INFO: epoch 049:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=18301, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3159.6, ups=0.17, wpb=18301, bsz=1024, num_updates=19070, lr=2.72487e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=123649
2024-11-08 00:03:08 - progress_bar.py[line:274] - INFO: epoch 049:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=18415.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3191.3, ups=0.17, wpb=18415.5, bsz=1024, num_updates=19080, lr=2.72351e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123707
2024-11-08 00:04:06 - progress_bar.py[line:274] - INFO: epoch 049:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.358, ntokens=17978, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3095, ups=0.17, wpb=17978, bsz=1024, num_updates=19090, lr=2.72215e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123765
2024-11-08 00:05:04 - progress_bar.py[line:274] - INFO: epoch 049:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=18268.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3152.9, ups=0.17, wpb=18268.2, bsz=1024, num_updates=19100, lr=2.72079e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123823
2024-11-08 00:06:02 - progress_bar.py[line:274] - INFO: epoch 049:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=18276.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3161.3, ups=0.17, wpb=18276.1, bsz=1024, num_updates=19110, lr=2.71943e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123881
2024-11-08 00:07:00 - progress_bar.py[line:274] - INFO: epoch 049:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=18426.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3175.2, ups=0.17, wpb=18426.7, bsz=1024, num_updates=19120, lr=2.71807e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=123939
2024-11-08 00:07:57 - progress_bar.py[line:274] - INFO: epoch 049:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=17853.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3101.2, ups=0.17, wpb=17853.3, bsz=1024, num_updates=19130, lr=2.71671e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=123996
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
2024-11-08 00:08:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 49 @ 19139 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
2024-11-08 00:08:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 00:10:36 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-08 00:12:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 49 @ 19139 updates, score 0) (writing took 223.84044642400113 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-08 00:13:23 - train.py[line:336] - INFO: end of epoch 49 (average epoch stats below)
2024-11-08 00:13:23 - progress_bar.py[line:282] - INFO: epoch 049 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.342 | ntokens 17834.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.07 | wps 2578 | ups 0.14 | wpb 17834.2 | bsz 1023 | num_updates 19139 | lr 2.71549e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1385 | gb_free 13.4 | wall 124322
2024-11-08 00:13:23 - trainer.py[line:639] - INFO: loading train data for epoch 50
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 00:16:05 - trainer.py[line:703] - INFO: begin training epoch 50
2024-11-08 00:16:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 00:16:13 - progress_bar.py[line:274] - INFO: epoch 050:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.388, ntokens=17469.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=352.2, ups=0.02, wpb=17469.9, bsz=985.6, num_updates=19140, lr=2.71535e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=124492
2024-11-08 00:17:11 - progress_bar.py[line:274] - INFO: epoch 050:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.229, ntokens=17068.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.69, wps=2953.1, ups=0.17, wpb=17068.5, bsz=1024, num_updates=19150, lr=2.71399e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124550
2024-11-08 00:18:10 - progress_bar.py[line:274] - INFO: epoch 050:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.346, ntokens=18017.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3062.7, ups=0.17, wpb=18017.9, bsz=1024, num_updates=19160, lr=2.71263e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=124609
2024-11-08 00:19:08 - progress_bar.py[line:274] - INFO: epoch 050:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.323, ntokens=17912.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3087.8, ups=0.17, wpb=17912.5, bsz=1024, num_updates=19170, lr=2.71127e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124667
2024-11-08 00:20:06 - progress_bar.py[line:274] - INFO: epoch 050:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17955.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3099.7, ups=0.17, wpb=17955.9, bsz=1024, num_updates=19180, lr=2.70991e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124725
2024-11-08 00:21:04 - progress_bar.py[line:274] - INFO: epoch 050:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.286, ntokens=17439.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3026.7, ups=0.17, wpb=17439.7, bsz=1024, num_updates=19190, lr=2.70855e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124782
2024-11-08 00:22:01 - progress_bar.py[line:274] - INFO: epoch 050:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17964.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3108.6, ups=0.17, wpb=17964.3, bsz=1024, num_updates=19200, lr=2.70719e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124840
2024-11-08 00:22:59 - progress_bar.py[line:274] - INFO: epoch 050:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.306, ntokens=17652.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3058.4, ups=0.17, wpb=17652.9, bsz=1024, num_updates=19210, lr=2.70583e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=124898
2024-11-08 00:23:56 - progress_bar.py[line:274] - INFO: epoch 050:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.288, ntokens=17642.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3081.1, ups=0.17, wpb=17642.4, bsz=1024, num_updates=19220, lr=2.70447e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=124955
2024-11-08 00:24:51 - progress_bar.py[line:274] - INFO: epoch 050:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.302, ntokens=17580.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3230.9, ups=0.18, wpb=17580.8, bsz=1024, num_updates=19230, lr=2.70311e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125010
2024-11-08 00:25:44 - progress_bar.py[line:274] - INFO: epoch 050:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17749, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3360.6, ups=0.19, wpb=17749, bsz=1024, num_updates=19240, lr=2.70175e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125062
2024-11-08 00:26:36 - progress_bar.py[line:274] - INFO: epoch 050:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=17693.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3356.5, ups=0.19, wpb=17693.2, bsz=1024, num_updates=19250, lr=2.70039e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=125115
2024-11-08 00:27:29 - progress_bar.py[line:274] - INFO: epoch 050:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.293, ntokens=17510.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3294.9, ups=0.19, wpb=17510.1, bsz=1024, num_updates=19260, lr=2.69903e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=125168
2024-11-08 00:28:23 - progress_bar.py[line:274] - INFO: epoch 050:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17616.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3306.6, ups=0.19, wpb=17616.1, bsz=1024, num_updates=19270, lr=2.69767e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=125222
2024-11-08 00:29:16 - progress_bar.py[line:274] - INFO: epoch 050:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.344, ntokens=17835.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3368.2, ups=0.19, wpb=17835.4, bsz=1024, num_updates=19280, lr=2.69631e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125275
2024-11-08 00:30:09 - progress_bar.py[line:274] - INFO: epoch 050:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17805.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3359.9, ups=0.19, wpb=17805.3, bsz=1024, num_updates=19290, lr=2.69494e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=125328
2024-11-08 00:31:02 - progress_bar.py[line:274] - INFO: epoch 050:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.246, ntokens=17295.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.74, wps=3257.1, ups=0.19, wpb=17295.8, bsz=1024, num_updates=19300, lr=2.69358e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=125381
2024-11-08 00:31:55 - progress_bar.py[line:274] - INFO: epoch 050:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.252, ntokens=17429.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.76, wps=3280.8, ups=0.19, wpb=17429.6, bsz=1024, num_updates=19310, lr=2.69222e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125434
2024-11-08 00:32:48 - progress_bar.py[line:274] - INFO: epoch 050:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.288, ntokens=17465.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3298.4, ups=0.19, wpb=17465.9, bsz=1024, num_updates=19320, lr=2.69086e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=125487
2024-11-08 00:33:41 - progress_bar.py[line:274] - INFO: epoch 050:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17984.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3396.2, ups=0.19, wpb=17984.7, bsz=1024, num_updates=19330, lr=2.6895e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=125540
2024-11-08 00:34:33 - progress_bar.py[line:274] - INFO: epoch 050:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17787.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3376.4, ups=0.19, wpb=17787.4, bsz=1024, num_updates=19340, lr=2.68814e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=125592
2024-11-08 00:35:26 - progress_bar.py[line:274] - INFO: epoch 050:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.347, ntokens=17975.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3415.6, ups=0.19, wpb=17975.3, bsz=1024, num_updates=19350, lr=2.68678e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=125645
2024-11-08 00:36:19 - progress_bar.py[line:274] - INFO: epoch 050:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.34, ntokens=17846.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3388.2, ups=0.19, wpb=17846.1, bsz=1024, num_updates=19360, lr=2.68542e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=125698
2024-11-08 00:37:11 - progress_bar.py[line:274] - INFO: epoch 050:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.299, ntokens=17622.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.92, wps=3391.8, ups=0.19, wpb=17622.5, bsz=1024, num_updates=19370, lr=2.68406e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=125750
2024-11-08 00:38:04 - progress_bar.py[line:274] - INFO: epoch 050:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.296, ntokens=17521.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3303.5, ups=0.19, wpb=17521.1, bsz=1024, num_updates=19380, lr=2.6827e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125803
2024-11-08 00:38:56 - progress_bar.py[line:274] - INFO: epoch 050:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17820, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3379.8, ups=0.19, wpb=17820, bsz=1024, num_updates=19390, lr=2.68134e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=125855
2024-11-08 00:39:49 - progress_bar.py[line:274] - INFO: epoch 050:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.351, ntokens=18028.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3427.2, ups=0.19, wpb=18028.3, bsz=1024, num_updates=19400, lr=2.67998e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=125908
2024-11-08 00:40:42 - progress_bar.py[line:274] - INFO: epoch 050:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.296, ntokens=17733.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3378.2, ups=0.19, wpb=17733.9, bsz=1024, num_updates=19410, lr=2.67862e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=125960
2024-11-08 00:41:34 - progress_bar.py[line:274] - INFO: epoch 050:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.298, ntokens=17682.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.92, wps=3366.8, ups=0.19, wpb=17682.3, bsz=1024, num_updates=19420, lr=2.67726e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=126013
2024-11-08 00:42:26 - progress_bar.py[line:274] - INFO: epoch 050:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.334, ntokens=17886.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3418.1, ups=0.19, wpb=17886.8, bsz=1024, num_updates=19430, lr=2.6759e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=126065
2024-11-08 00:43:18 - progress_bar.py[line:274] - INFO: epoch 050:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.333, ntokens=17851.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.04, wps=3451.4, ups=0.19, wpb=17851.1, bsz=1024, num_updates=19440, lr=2.67454e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=126117
2024-11-08 00:44:10 - progress_bar.py[line:274] - INFO: epoch 050:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=18509.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3540.1, ups=0.19, wpb=18509.7, bsz=1024, num_updates=19450, lr=2.67318e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=126169
2024-11-08 00:45:03 - progress_bar.py[line:274] - INFO: epoch 050:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.371, ntokens=18038.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3450.4, ups=0.19, wpb=18038.4, bsz=1024, num_updates=19460, lr=2.67182e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=126222
2024-11-08 00:45:55 - progress_bar.py[line:274] - INFO: epoch 050:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=18315, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3533.5, ups=0.19, wpb=18315, bsz=1024, num_updates=19470, lr=2.67046e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=126273
2024-11-08 00:46:47 - progress_bar.py[line:274] - INFO: epoch 050:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.361, ntokens=18026, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3451.8, ups=0.19, wpb=18026, bsz=1024, num_updates=19480, lr=2.6691e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=126326
2024-11-08 00:47:39 - progress_bar.py[line:274] - INFO: epoch 050:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=18465.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3550.9, ups=0.19, wpb=18465.6, bsz=1024, num_updates=19490, lr=2.66774e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=126378
2024-11-08 00:48:31 - progress_bar.py[line:274] - INFO: epoch 050:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.378, ntokens=18298.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3498.6, ups=0.19, wpb=18298.3, bsz=1024, num_updates=19500, lr=2.66638e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=126430
2024-11-08 00:49:24 - progress_bar.py[line:274] - INFO: epoch 050:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.371, ntokens=17955.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.17, wps=3415.7, ups=0.19, wpb=17955.7, bsz=1024, num_updates=19510, lr=2.66502e-05, gnorm=0.012, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=126483
2024-11-08 00:50:17 - progress_bar.py[line:274] - INFO: epoch 050:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.314, ntokens=17641.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3321.6, ups=0.19, wpb=17641.8, bsz=1024, num_updates=19520, lr=2.66366e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=47, gb_free=13.5, wall=126536
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-08 00:51:06 - progress_bar.py[line:274] - INFO: epoch 050:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=16946, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3476.2, ups=0.21, wpb=16946, bsz=985.6, num_updates=19530, lr=2.6623e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=38, gb_free=13.3, wall=126584
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt

2024-11-08 00:51:06 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 50 @ 19530 updates
2024-11-08 00:51:06 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 00:52:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-08 00:54:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 50 @ 19530 updates, score 0) (writing took 223.9896151649882 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-08 00:55:45 - train.py[line:336] - INFO: end of epoch 50 (average epoch stats below)
2024-11-08 00:55:45 - progress_bar.py[line:282] - INFO: epoch 050 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.328 | ntokens 17782.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.02 | wps 2735.3 | ups 0.15 | wpb 17782.9 | bsz 1023 | num_updates 19530 | lr 2.6623e-05 | gnorm 0.008 | clip 0 | loss_scale 131072 | train_wall 1221 | gb_free 13.3 | wall 126864
2024-11-08 00:55:45 - trainer.py[line:639] - INFO: loading train data for epoch 51
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 00:58:24 - trainer.py[line:703] - INFO: begin training epoch 51
2024-11-08 00:58:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 00:59:19 - progress_bar.py[line:274] - INFO: epoch 051:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.27, ntokens=17454.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=354, ups=0.02, wpb=17454.2, bsz=1024, num_updates=19540, lr=2.66093e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=127077
2024-11-08 00:59:56 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-08 01:00:17 - progress_bar.py[line:274] - INFO: epoch 051:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.295, ntokens=17729.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3048, ups=0.17, wpb=17729.8, bsz=1024, num_updates=19550, lr=2.65957e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=127136
2024-11-08 01:01:09 - progress_bar.py[line:274] - INFO: epoch 051:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.318, ntokens=17925.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3426.5, ups=0.19, wpb=17925.5, bsz=1024, num_updates=19560, lr=2.65821e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127188
2024-11-08 01:02:01 - progress_bar.py[line:274] - INFO: epoch 051:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17893.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3415.5, ups=0.19, wpb=17893.6, bsz=1024, num_updates=19570, lr=2.65685e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=127240
2024-11-08 01:02:54 - progress_bar.py[line:274] - INFO: epoch 051:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.28, ntokens=17427.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.86, wps=3344.5, ups=0.19, wpb=17427.1, bsz=1024, num_updates=19580, lr=2.65549e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=127292
2024-11-08 01:03:46 - progress_bar.py[line:274] - INFO: epoch 051:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.346, ntokens=18020.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.08, wps=3445.1, ups=0.19, wpb=18020.8, bsz=1024, num_updates=19590, lr=2.65413e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127345
2024-11-08 01:04:38 - progress_bar.py[line:274] - INFO: epoch 051:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.292, ntokens=17673.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3401.5, ups=0.19, wpb=17673.8, bsz=1024, num_updates=19600, lr=2.65277e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=127397
2024-11-08 01:05:30 - progress_bar.py[line:274] - INFO: epoch 051:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.279, ntokens=17598.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3354.6, ups=0.19, wpb=17598.8, bsz=1024, num_updates=19610, lr=2.65141e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=127449
2024-11-08 01:06:23 - progress_bar.py[line:274] - INFO: epoch 051:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.341, ntokens=17882.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.07, wps=3409.8, ups=0.19, wpb=17882.9, bsz=1024, num_updates=19620, lr=2.65005e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127502
2024-11-08 01:07:15 - progress_bar.py[line:274] - INFO: epoch 051:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.268, ntokens=17495.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=3363.9, ups=0.19, wpb=17495.3, bsz=1024, num_updates=19630, lr=2.64869e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127554
2024-11-08 01:08:09 - progress_bar.py[line:274] - INFO: epoch 051:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.295, ntokens=17569.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3227.7, ups=0.18, wpb=17569.3, bsz=1024, num_updates=19640, lr=2.64733e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=127608
2024-11-08 01:09:01 - progress_bar.py[line:274] - INFO: epoch 051:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17737.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3409.4, ups=0.19, wpb=17737.1, bsz=1024, num_updates=19650, lr=2.64597e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127660
2024-11-08 01:09:54 - progress_bar.py[line:274] - INFO: epoch 051:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.288, ntokens=17407.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3286.5, ups=0.19, wpb=17407.5, bsz=1024, num_updates=19660, lr=2.64461e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=127713
2024-11-08 01:10:47 - progress_bar.py[line:274] - INFO: epoch 051:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17752.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3386.2, ups=0.19, wpb=17752.9, bsz=1024, num_updates=19670, lr=2.64325e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127765
2024-11-08 01:11:39 - progress_bar.py[line:274] - INFO: epoch 051:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.278, ntokens=17439.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3324.4, ups=0.19, wpb=17439.2, bsz=1024, num_updates=19680, lr=2.64189e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127818
2024-11-08 01:12:32 - progress_bar.py[line:274] - INFO: epoch 051:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.305, ntokens=17841.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3380.4, ups=0.19, wpb=17841.8, bsz=1024, num_updates=19690, lr=2.64053e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127871
2024-11-08 01:13:25 - progress_bar.py[line:274] - INFO: epoch 051:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.291, ntokens=17699.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.89, wps=3339.8, ups=0.19, wpb=17699.2, bsz=1024, num_updates=19700, lr=2.63917e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127924
2024-11-08 01:14:17 - progress_bar.py[line:274] - INFO: epoch 051:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.269, ntokens=17422.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=3333.5, ups=0.19, wpb=17422.6, bsz=1024, num_updates=19710, lr=2.63781e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=127976
2024-11-08 01:15:09 - progress_bar.py[line:274] - INFO: epoch 051:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17805.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3411.7, ups=0.19, wpb=17805.6, bsz=1024, num_updates=19720, lr=2.63645e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=128028
2024-11-08 01:16:03 - progress_bar.py[line:274] - INFO: epoch 051:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.325, ntokens=17786.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3330.5, ups=0.19, wpb=17786.5, bsz=1024, num_updates=19730, lr=2.63509e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=128082
2024-11-08 01:16:56 - progress_bar.py[line:274] - INFO: epoch 051:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.324, ntokens=17906.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3335.4, ups=0.19, wpb=17906.8, bsz=1024, num_updates=19740, lr=2.63373e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=47, gb_free=13.5, wall=128135
2024-11-08 01:17:50 - progress_bar.py[line:274] - INFO: epoch 051:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.328, ntokens=17793.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3322.2, ups=0.19, wpb=17793.4, bsz=1024, num_updates=19750, lr=2.63237e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=128189
2024-11-08 01:18:44 - progress_bar.py[line:274] - INFO: epoch 051:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17834.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3286.8, ups=0.18, wpb=17834.9, bsz=1024, num_updates=19760, lr=2.63101e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=128243
2024-11-08 01:19:38 - progress_bar.py[line:274] - INFO: epoch 051:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.267, ntokens=17497, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.81, wps=3264.9, ups=0.19, wpb=17497, bsz=1024, num_updates=19770, lr=2.62965e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=128297
2024-11-08 01:20:31 - progress_bar.py[line:274] - INFO: epoch 051:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.302, ntokens=17707, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3329.3, ups=0.19, wpb=17707, bsz=1024, num_updates=19780, lr=2.62829e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=128350
2024-11-08 01:21:24 - progress_bar.py[line:274] - INFO: epoch 051:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.305, ntokens=17753.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3318.1, ups=0.19, wpb=17753.6, bsz=1024, num_updates=19790, lr=2.62692e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=50, gb_free=13.4, wall=128403
2024-11-08 01:22:19 - progress_bar.py[line:274] - INFO: epoch 051:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.275, ntokens=17629.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.84, wps=3233.4, ups=0.18, wpb=17629.7, bsz=1024, num_updates=19800, lr=2.62556e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=48, gb_free=13.4, wall=128458
2024-11-08 01:23:13 - progress_bar.py[line:274] - INFO: epoch 051:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17952.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3324, ups=0.19, wpb=17952.3, bsz=1024, num_updates=19810, lr=2.6242e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=128512
2024-11-08 01:24:06 - progress_bar.py[line:274] - INFO: epoch 051:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17809.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3329.6, ups=0.19, wpb=17809.5, bsz=1024, num_updates=19820, lr=2.62284e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=128565
2024-11-08 01:25:00 - progress_bar.py[line:274] - INFO: epoch 051:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=18347.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3415.4, ups=0.19, wpb=18347.5, bsz=1024, num_updates=19830, lr=2.62148e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=128619
2024-11-08 01:25:54 - progress_bar.py[line:274] - INFO: epoch 051:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.378, ntokens=18199.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3371.3, ups=0.19, wpb=18199.4, bsz=1024, num_updates=19840, lr=2.62012e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=128673
2024-11-08 01:26:48 - progress_bar.py[line:274] - INFO: epoch 051:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=18200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3369.2, ups=0.19, wpb=18200.2, bsz=1024, num_updates=19850, lr=2.61876e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=128727
2024-11-08 01:27:44 - progress_bar.py[line:274] - INFO: epoch 051:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=18060.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3257.6, ups=0.18, wpb=18060.5, bsz=1024, num_updates=19860, lr=2.6174e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=128783
2024-11-08 01:28:39 - progress_bar.py[line:274] - INFO: epoch 051:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.365, ntokens=18104.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3272.5, ups=0.18, wpb=18104.6, bsz=1024, num_updates=19870, lr=2.61604e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=128838
2024-11-08 01:29:32 - progress_bar.py[line:274] - INFO: epoch 051:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=18788.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3567.1, ups=0.19, wpb=18788.7, bsz=1024, num_updates=19880, lr=2.61468e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=128891
2024-11-08 01:30:23 - progress_bar.py[line:274] - INFO: epoch 051:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=18172.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3527.3, ups=0.19, wpb=18172.6, bsz=1024, num_updates=19890, lr=2.61332e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=49, gb_free=13.4, wall=128942
2024-11-08 01:31:16 - progress_bar.py[line:274] - INFO: epoch 051:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=18207.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3441.9, ups=0.19, wpb=18207.4, bsz=1024, num_updates=19900, lr=2.61196e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=128995
2024-11-08 01:32:09 - progress_bar.py[line:274] - INFO: epoch 051:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.364, ntokens=18110.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.15, wps=3392.5, ups=0.19, wpb=18110.9, bsz=1024, num_updates=19910, lr=2.6106e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=129048
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-08 01:33:00 - progress_bar.py[line:274] - INFO: epoch 051:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17345.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3448.6, ups=0.2, wpb=17345.9, bsz=985.6, num_updates=19920, lr=2.60924e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=50, gb_free=13.4, wall=129099
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
2024-11-08 01:33:00 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 51 @ 19920 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
2024-11-08 01:33:00 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 01:34:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-08 01:36:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 51 @ 19920 updates, score 0) (writing took 224.9926545819908 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
2024-11-08 01:37:40 - train.py[line:336] - INFO: end of epoch 51 (average epoch stats below)
2024-11-08 01:37:40 - progress_bar.py[line:282] - INFO: epoch 051 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.325 | ntokens 17820.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.01 | wps 2763.4 | ups 0.16 | wpb 17820.1 | bsz 1023 | num_updates 19920 | lr 2.60924e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1615 | gb_free 13.4 | wall 129379
2024-11-08 01:37:40 - trainer.py[line:639] - INFO: loading train data for epoch 52
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 01:40:21 - trainer.py[line:703] - INFO: begin training epoch 52
2024-11-08 01:40:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 01:41:16 - progress_bar.py[line:274] - INFO: epoch 052:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.285, ntokens=17579.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=354.3, ups=0.02, wpb=17579.4, bsz=1024, num_updates=19930, lr=2.60788e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=129595
2024-11-08 01:42:09 - progress_bar.py[line:274] - INFO: epoch 052:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=17849.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3387.8, ups=0.19, wpb=17849.8, bsz=1024, num_updates=19940, lr=2.60652e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=129647
2024-11-08 01:43:02 - progress_bar.py[line:274] - INFO: epoch 052:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.305, ntokens=17755.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3337.3, ups=0.19, wpb=17755.7, bsz=1024, num_updates=19950, lr=2.60516e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=129701
2024-11-08 01:43:56 - progress_bar.py[line:274] - INFO: epoch 052:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.355, ntokens=18169.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.12, wps=3350.8, ups=0.18, wpb=18169.6, bsz=1024, num_updates=19960, lr=2.6038e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=38, gb_free=13.5, wall=129755
2024-11-08 01:44:51 - progress_bar.py[line:274] - INFO: epoch 052:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.304, ntokens=17565.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3193.1, ups=0.18, wpb=17565.9, bsz=1024, num_updates=19970, lr=2.60244e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=51, gb_free=13.6, wall=129810
2024-11-08 01:45:47 - progress_bar.py[line:274] - INFO: epoch 052:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.287, ntokens=17654.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3157.1, ups=0.18, wpb=17654.3, bsz=1024, num_updates=19980, lr=2.60108e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=129866
2024-11-08 01:46:41 - progress_bar.py[line:274] - INFO: epoch 052:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.305, ntokens=17716.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3298, ups=0.19, wpb=17716.8, bsz=1024, num_updates=19990, lr=2.59972e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=129920
2024-11-08 01:47:34 - progress_bar.py[line:274] - INFO: epoch 052:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17863.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3326.5, ups=0.19, wpb=17863.4, bsz=1024, num_updates=20000, lr=2.59836e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=129973
loss_reg: 0.007231812394144941 loss_cls: 0.003542665159329772
loss_reg: 0.010688176032601629 loss_cls: 0.0037771183997392654
loss_reg: 0.01236334518019652 loss_cls: 0.0028392584063112736
loss_reg: 0.011103874174752212 loss_cls: 0.002668848028406501
loss_reg: 0.013513867623208286 loss_cls: 0.0026876439806073904
loss_reg: 0.006060167167509888 loss_cls: 0.004246077965945005
loss_reg: 0.017903653791200902 loss_cls: 0.00369584490545094
loss_reg: 0.01112045312218098 loss_cls: 0.0034785261377692223
loss_reg: 0.014217953391484408 loss_cls: 0.0021641936618834734
loss_reg: 0.014352278291632384 loss_cls: 0.0036985748447477818
loss_reg: 0.02428381429336212 loss_cls: 0.0037846839986741543
loss_reg: 0.009150188193104888 loss_cls: 0.003540519392117858
loss_reg: 0.006408491030859196 loss_cls: 0.0036260378547012806
loss_reg: 0.014619447194592116 loss_cls: 0.003248434280976653
loss_reg: 0.012830622654774956 loss_cls: 0.0028562562074512243
loss_reg: 0.019667100518403636 loss_cls: 0.0026020046789199114
loss_reg: 0.009851569391737737 loss_cls: 0.0024655635934323072
loss_reg: 0.017192556425821348 loss_cls: 0.0028426116332411766
loss_reg: 0.01810791536409935 loss_cls: 0.00539470324292779
loss_reg: 0.015745875827692185 loss_cls: 0.0040711709298193455
loss_reg: 0.010494588000519446 loss_cls: 0.0037776886019855738
loss_reg: 0.021922200700839466 loss_cls: 0.0040239254012703896
loss_reg: 0.006591586290856643 loss_cls: 0.0033628451637923717
loss_reg: 0.019111005162640256 loss_cls: 0.003231536131352186
loss_reg: 0.01917359325813268 loss_cls: 0.0033105851616710424
loss_reg: 0.012717338889434545 loss_cls: 0.0039072344079613686
loss_reg: 0.015770869642966052 loss_cls: 0.0054007600992918015
loss_reg: 0.015244042095291852 loss_cls: 0.00382313528098166
loss_reg: 0.01465987923856341 loss_cls: 0.0038155866786837578
loss_reg: 0.023295817864199615 loss_cls: 0.004735640715807676
loss_reg: 0.020228961386183776 loss_cls: 0.004110195208340883
loss_reg: 0.012694270027596903 loss_cls: 0.004027346149086952
loss_reg: 0.014932506591559518 loss_cls: 0.00317538995295763
loss_reg: 0.016924711781897046 loss_cls: 0.004365383181720972
loss_reg: 0.01511035535464059 loss_cls: 0.00310495775192976
loss_reg: 0.01139220601669657 loss_cls: 0.004506506957113743
loss_reg: 0.013892889511950533 loss_cls: 0.004630265291780233
loss_reg: 0.016759252777202218 loss_cls: 0.0030422417912632227
loss_reg: 0.01373658408868033 loss_cls: 0.004813347943127155
loss_reg: 0.016178894232047443 loss_cls: 0.0038998140953481197
loss_reg: 0.020765423029396463 loss_cls: 0.004010005388408899
loss_reg: 0.013195544227551391 loss_cls: 0.002593444427475333
loss_reg: 0.017909104936644528 loss_cls: 0.0031090599950402975
loss_reg: 0.006425109710703076 loss_cls: 0.0037535543087869883
loss_reg: 0.014369965513047847 loss_cls: 0.0035460663493722677
loss_reg: 0.012437858039283347 loss_cls: 0.003691346850246191
loss_reg: 0.007000562774969771 loss_cls: 0.004681427031755447
loss_reg: 0.015757637682094792 loss_cls: 0.003294419962912798
loss_reg: 0.010895174202976091 loss_cls: 0.003136303974315524
loss_reg: 0.01540449691748117 loss_cls: 0.0031632056925445795
loss_reg: 0.014094634792626657 loss_cls: 0.003927035257220268
loss_reg: 0.0027055290479803267 loss_cls: 0.002783230971544981
loss_reg: 0.02498455914136648 loss_cls: 0.004975540097802877
loss_reg: 0.005215767853868009 loss_cls: 0.002948678331449628
loss_reg: 0.013234143016468419 loss_cls: 0.003533594775944948
loss_reg: 0.0022262345783895647 loss_cls: 0.0018874986562877893
loss_reg: 0.02071573368342672 loss_cls: 0.0038819601759314537
loss_reg: 0.004182695968394089 loss_cls: 0.002322925953194499
loss_reg: 0.020901426844564013 loss_cls: 0.004764712881296873
loss_reg: 0.0021039099947064532 loss_cls: 0.002369479276239872
loss_reg: 0.014618456411187222 loss_cls: 0.0032512671314179897
loss_reg: 0.005906721505675404 loss_cls: 0.003293135901913047
loss_reg: 0.011024065177886889 loss_cls: 0.0029942195396870375
loss_reg: 0.0022885979438183714 loss_cls: 0.0028956150636076927
2024-11-08 01:48:28 - progress_bar.py[line:274] - INFO: epoch 052:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17655.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3311.4, ups=0.19, wpb=17655.7, bsz=1024, num_updates=20010, lr=2.597e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=130027
2024-11-08 01:49:22 - progress_bar.py[line:274] - INFO: epoch 052:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.289, ntokens=17732.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.89, wps=3279.1, ups=0.18, wpb=17732.2, bsz=1024, num_updates=20020, lr=2.59564e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=130081
2024-11-08 01:50:16 - progress_bar.py[line:274] - INFO: epoch 052:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.247, ntokens=17186.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.75, wps=3165.4, ups=0.18, wpb=17186.5, bsz=1024, num_updates=20030, lr=2.59428e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=48, gb_free=13.5, wall=130135
2024-11-08 01:51:11 - progress_bar.py[line:274] - INFO: epoch 052:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.305, ntokens=17638.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3203, ups=0.18, wpb=17638.7, bsz=1024, num_updates=20040, lr=2.59292e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=130190
2024-11-08 01:52:04 - progress_bar.py[line:274] - INFO: epoch 052:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.247, ntokens=17188.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.75, wps=3244.1, ups=0.19, wpb=17188.7, bsz=1024, num_updates=20050, lr=2.59155e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=130243
2024-11-08 01:52:52 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-08 01:53:02 - progress_bar.py[line:274] - INFO: epoch 052:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17872.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3073.5, ups=0.17, wpb=17872.9, bsz=1024, num_updates=20060, lr=2.59019e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=36, gb_free=13.4, wall=130301
2024-11-08 01:53:56 - progress_bar.py[line:274] - INFO: epoch 052:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.293, ntokens=17673.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3283.9, ups=0.19, wpb=17673.2, bsz=1024, num_updates=20070, lr=2.58883e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=130355
2024-11-08 01:54:50 - progress_bar.py[line:274] - INFO: epoch 052:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.269, ntokens=17588.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=3245.5, ups=0.18, wpb=17588.1, bsz=1024, num_updates=20080, lr=2.58747e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130409
2024-11-08 01:55:44 - progress_bar.py[line:274] - INFO: epoch 052:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.294, ntokens=17739.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3300.4, ups=0.19, wpb=17739.6, bsz=1024, num_updates=20090, lr=2.58611e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130463
2024-11-08 01:56:38 - progress_bar.py[line:274] - INFO: epoch 052:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.263, ntokens=17360.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.8, wps=3232.5, ups=0.19, wpb=17360.1, bsz=1024, num_updates=20100, lr=2.58475e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130517
2024-11-08 01:57:32 - progress_bar.py[line:274] - INFO: epoch 052:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17718.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3284.4, ups=0.19, wpb=17718.3, bsz=1024, num_updates=20110, lr=2.58339e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=130571
2024-11-08 01:58:26 - progress_bar.py[line:274] - INFO: epoch 052:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.35, ntokens=17917.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.1, wps=3300.6, ups=0.18, wpb=17917.1, bsz=1024, num_updates=20120, lr=2.58203e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130625
2024-11-08 01:59:20 - progress_bar.py[line:274] - INFO: epoch 052:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.312, ntokens=17887.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3317.9, ups=0.19, wpb=17887.1, bsz=1024, num_updates=20130, lr=2.58067e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130679
2024-11-08 02:00:14 - progress_bar.py[line:274] - INFO: epoch 052:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.312, ntokens=17726.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3294.4, ups=0.19, wpb=17726.3, bsz=1024, num_updates=20140, lr=2.57931e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=130733
2024-11-08 02:01:07 - progress_bar.py[line:274] - INFO: epoch 052:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17949.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3354.9, ups=0.19, wpb=17949.3, bsz=1024, num_updates=20150, lr=2.57795e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=130786
2024-11-08 02:02:01 - progress_bar.py[line:274] - INFO: epoch 052:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.263, ntokens=17383.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.8, wps=3226.5, ups=0.19, wpb=17383.5, bsz=1024, num_updates=20160, lr=2.57659e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130840
2024-11-08 02:02:55 - progress_bar.py[line:274] - INFO: epoch 052:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17921.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3325.8, ups=0.19, wpb=17921.4, bsz=1024, num_updates=20170, lr=2.57523e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=130894
2024-11-08 02:03:48 - progress_bar.py[line:274] - INFO: epoch 052:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17992.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3374.4, ups=0.19, wpb=17992.3, bsz=1024, num_updates=20180, lr=2.57387e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=130947
2024-11-08 02:04:42 - progress_bar.py[line:274] - INFO: epoch 052:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.329, ntokens=18012.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.03, wps=3338, ups=0.19, wpb=18012.1, bsz=1024, num_updates=20190, lr=2.57251e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131001
2024-11-08 02:05:37 - progress_bar.py[line:274] - INFO: epoch 052:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.247, ntokens=17277.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.75, wps=3156.9, ups=0.18, wpb=17277.3, bsz=1024, num_updates=20200, lr=2.57115e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=131056
2024-11-08 02:06:32 - progress_bar.py[line:274] - INFO: epoch 052:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.307, ntokens=17740.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3233.6, ups=0.18, wpb=17740.2, bsz=1024, num_updates=20210, lr=2.56979e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=131111
2024-11-08 02:07:26 - progress_bar.py[line:274] - INFO: epoch 052:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.348, ntokens=18046.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3330.8, ups=0.18, wpb=18046.1, bsz=1024, num_updates=20220, lr=2.56843e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131165
2024-11-08 02:08:20 - progress_bar.py[line:274] - INFO: epoch 052:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.404, ntokens=18384.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3413.1, ups=0.19, wpb=18384.4, bsz=1024, num_updates=20230, lr=2.56707e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131219
2024-11-08 02:09:13 - progress_bar.py[line:274] - INFO: epoch 052:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=18479.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3465.8, ups=0.19, wpb=18479.3, bsz=1024, num_updates=20240, lr=2.56571e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=131272
2024-11-08 02:10:06 - progress_bar.py[line:274] - INFO: epoch 052:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=18454.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3464.6, ups=0.19, wpb=18454.9, bsz=1024, num_updates=20250, lr=2.56435e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=131325
2024-11-08 02:11:00 - progress_bar.py[line:274] - INFO: epoch 052:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.375, ntokens=18205.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3383, ups=0.19, wpb=18205.1, bsz=1024, num_updates=20260, lr=2.56299e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=131379
2024-11-08 02:11:54 - progress_bar.py[line:274] - INFO: epoch 052:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.419, ntokens=18573, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3437.5, ups=0.19, wpb=18573, bsz=1024, num_updates=20270, lr=2.56163e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131433
2024-11-08 02:12:49 - progress_bar.py[line:274] - INFO: epoch 052:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.359, ntokens=18133.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.13, wps=3330.1, ups=0.18, wpb=18133.1, bsz=1024, num_updates=20280, lr=2.56027e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131488
2024-11-08 02:13:43 - progress_bar.py[line:274] - INFO: epoch 052:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.38, ntokens=18166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3332, ups=0.18, wpb=18166.3, bsz=1024, num_updates=20290, lr=2.55891e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=131542
2024-11-08 02:14:38 - progress_bar.py[line:274] - INFO: epoch 052:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.387, ntokens=18272.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3364.4, ups=0.18, wpb=18272.3, bsz=1024, num_updates=20300, lr=2.55754e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=131596
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-08 02:15:28 - progress_bar.py[line:274] - INFO: epoch 052:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.353, ntokens=17282.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.11, wps=3399.3, ups=0.2, wpb=17282.2, bsz=985.6, num_updates=20310, lr=2.55618e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=131647
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt2024-11-08 02:15:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 52 @ 20310 updates

2024-11-08 02:15:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 02:17:19 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-08 02:19:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 52 @ 20310 updates, score 0) (writing took 224.75652142200852 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
2024-11-08 02:20:08 - train.py[line:336] - INFO: end of epoch 52 (average epoch stats below)
2024-11-08 02:20:08 - progress_bar.py[line:282] - INFO: epoch 052 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.323 | ntokens 17828.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5 | wps 2728.3 | ups 0.15 | wpb 17828.5 | bsz 1023 | num_updates 20310 | lr 2.55618e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1833 | gb_free 13.4 | wall 131927
2024-11-08 02:20:08 - trainer.py[line:639] - INFO: loading train data for epoch 53
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 02:22:49 - trainer.py[line:703] - INFO: begin training epoch 53
2024-11-08 02:22:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 02:23:45 - progress_bar.py[line:274] - INFO: epoch 053:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.236, ntokens=17216.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.71, wps=346.6, ups=0.02, wpb=17216.6, bsz=1024, num_updates=20320, lr=2.55482e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=132144
2024-11-08 02:24:38 - progress_bar.py[line:274] - INFO: epoch 053:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.298, ntokens=17805.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.92, wps=3363.2, ups=0.19, wpb=17805.2, bsz=1024, num_updates=20330, lr=2.55346e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=132197
2024-11-08 02:25:33 - progress_bar.py[line:274] - INFO: epoch 053:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.273, ntokens=17513.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.83, wps=3176.2, ups=0.18, wpb=17513.6, bsz=1024, num_updates=20340, lr=2.5521e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=132252
2024-11-08 02:26:28 - progress_bar.py[line:274] - INFO: epoch 053:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17897.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3301.4, ups=0.18, wpb=17897.2, bsz=1024, num_updates=20350, lr=2.55074e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=132306
2024-11-08 02:27:20 - progress_bar.py[line:274] - INFO: epoch 053:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.312, ntokens=17727.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3386.4, ups=0.19, wpb=17727.1, bsz=1024, num_updates=20360, lr=2.54938e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=132359
2024-11-08 02:28:13 - progress_bar.py[line:274] - INFO: epoch 053:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17906, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3354.7, ups=0.19, wpb=17906, bsz=1024, num_updates=20370, lr=2.54802e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=132412
2024-11-08 02:29:06 - progress_bar.py[line:274] - INFO: epoch 053:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.256, ntokens=17486, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.78, wps=3293.9, ups=0.19, wpb=17486, bsz=1024, num_updates=20380, lr=2.54666e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=132465
2024-11-08 02:30:00 - progress_bar.py[line:274] - INFO: epoch 053:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.272, ntokens=17680.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.83, wps=3315.9, ups=0.19, wpb=17680.3, bsz=1024, num_updates=20390, lr=2.5453e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=132519
2024-11-08 02:30:54 - progress_bar.py[line:274] - INFO: epoch 053:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.26, ntokens=17421.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.79, wps=3232.1, ups=0.19, wpb=17421.1, bsz=1024, num_updates=20400, lr=2.54394e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=132572
2024-11-08 02:31:48 - progress_bar.py[line:274] - INFO: epoch 053:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.257, ntokens=17570, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.78, wps=3241.8, ups=0.18, wpb=17570, bsz=1024, num_updates=20410, lr=2.54258e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=132627
2024-11-08 02:32:42 - progress_bar.py[line:274] - INFO: epoch 053:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17699.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3279.7, ups=0.19, wpb=17699.9, bsz=1024, num_updates=20420, lr=2.54122e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=132681
2024-11-08 02:33:36 - progress_bar.py[line:274] - INFO: epoch 053:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.32, ntokens=17768.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.99, wps=3283.8, ups=0.18, wpb=17768.5, bsz=1024, num_updates=20430, lr=2.53986e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=132735
2024-11-08 02:34:33 - progress_bar.py[line:274] - INFO: epoch 053:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.296, ntokens=17588.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.91, wps=3077.2, ups=0.17, wpb=17588.1, bsz=1024, num_updates=20440, lr=2.5385e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=45, gb_free=13.5, wall=132792
2024-11-08 02:35:27 - progress_bar.py[line:274] - INFO: epoch 053:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.336, ntokens=17858.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3283.6, ups=0.18, wpb=17858.5, bsz=1024, num_updates=20450, lr=2.53714e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=132846
2024-11-08 02:36:25 - progress_bar.py[line:274] - INFO: epoch 053:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17740.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3072.1, ups=0.17, wpb=17740.8, bsz=1024, num_updates=20460, lr=2.53578e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=132904
2024-11-08 02:37:23 - progress_bar.py[line:274] - INFO: epoch 053:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.266, ntokens=17440.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.81, wps=3035.1, ups=0.17, wpb=17440.1, bsz=1024, num_updates=20470, lr=2.53442e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=132961
2024-11-08 02:38:20 - progress_bar.py[line:274] - INFO: epoch 053:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=18040.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3140.9, ups=0.17, wpb=18040.5, bsz=1024, num_updates=20480, lr=2.53306e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=133019
2024-11-08 02:39:13 - progress_bar.py[line:274] - INFO: epoch 053:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.262, ntokens=17424.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.8, wps=3268.7, ups=0.19, wpb=17424.1, bsz=1024, num_updates=20490, lr=2.5317e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=133072
2024-11-08 02:40:07 - progress_bar.py[line:274] - INFO: epoch 053:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.317, ntokens=17829.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3341.5, ups=0.19, wpb=17829.9, bsz=1024, num_updates=20500, lr=2.53034e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=133126
2024-11-08 02:40:59 - progress_bar.py[line:274] - INFO: epoch 053:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.293, ntokens=17568.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3338.4, ups=0.19, wpb=17568.7, bsz=1024, num_updates=20510, lr=2.52898e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=133178
2024-11-08 02:41:52 - progress_bar.py[line:274] - INFO: epoch 053:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17907.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3396.6, ups=0.19, wpb=17907.2, bsz=1024, num_updates=20520, lr=2.52762e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=133231
2024-11-08 02:42:45 - progress_bar.py[line:274] - INFO: epoch 053:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.327, ntokens=17882.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.02, wps=3350.4, ups=0.19, wpb=17882.5, bsz=1024, num_updates=20530, lr=2.52626e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=34, gb_free=13.6, wall=133284
2024-11-08 02:43:40 - progress_bar.py[line:274] - INFO: epoch 053:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.338, ntokens=17928.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3298.9, ups=0.18, wpb=17928.1, bsz=1024, num_updates=20540, lr=2.5249e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=43, gb_free=13.5, wall=133339
2024-11-08 02:44:34 - progress_bar.py[line:274] - INFO: epoch 053:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.279, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3239.8, ups=0.18, wpb=17570.6, bsz=1024, num_updates=20550, lr=2.52353e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=133393
2024-11-08 02:45:26 - progress_bar.py[line:274] - INFO: epoch 053:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.264, ntokens=17467.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.8, wps=3333, ups=0.19, wpb=17467.2, bsz=1024, num_updates=20560, lr=2.52217e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=133445
2024-11-08 02:46:20 - progress_bar.py[line:274] - INFO: epoch 053:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.275, ntokens=17568.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.84, wps=3267.9, ups=0.19, wpb=17568.1, bsz=1024, num_updates=20570, lr=2.52081e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.6, wall=133499
2024-11-08 02:47:14 - progress_bar.py[line:274] - INFO: epoch 053:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.283, ntokens=17646, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=3295, ups=0.19, wpb=17646, bsz=1024, num_updates=20580, lr=2.51945e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.6, wall=133553
2024-11-08 02:48:08 - progress_bar.py[line:274] - INFO: epoch 053:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.306, ntokens=17801.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3307.7, ups=0.19, wpb=17801.7, bsz=1024, num_updates=20590, lr=2.51809e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.6, wall=133606
2024-11-08 02:49:01 - progress_bar.py[line:274] - INFO: epoch 053:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.29, ntokens=17713.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.89, wps=3319.1, ups=0.19, wpb=17713.7, bsz=1024, num_updates=20600, lr=2.51673e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=53, gb_free=13.6, wall=133660
2024-11-08 02:49:06 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-08 02:50:00 - progress_bar.py[line:274] - INFO: epoch 053:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.348, ntokens=17986.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.09, wps=3054.8, ups=0.17, wpb=17986.5, bsz=1024, num_updates=20610, lr=2.51537e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=133719
2024-11-08 02:50:53 - progress_bar.py[line:274] - INFO: epoch 053:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=18454.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3444.2, ups=0.19, wpb=18454.5, bsz=1024, num_updates=20620, lr=2.51401e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=133772
2024-11-08 02:51:47 - progress_bar.py[line:274] - INFO: epoch 053:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=18246.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3405.6, ups=0.19, wpb=18246.6, bsz=1024, num_updates=20630, lr=2.51265e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=133826
2024-11-08 02:52:41 - progress_bar.py[line:274] - INFO: epoch 053:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=18393.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3430.8, ups=0.19, wpb=18393.7, bsz=1024, num_updates=20640, lr=2.51129e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=133879
2024-11-08 02:53:37 - progress_bar.py[line:274] - INFO: epoch 053:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.362, ntokens=18162.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.14, wps=3238.8, ups=0.18, wpb=18162.6, bsz=1024, num_updates=20650, lr=2.50993e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=133936
2024-11-08 02:54:31 - progress_bar.py[line:274] - INFO: epoch 053:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.41, ntokens=18548.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3393.5, ups=0.18, wpb=18548.7, bsz=1024, num_updates=20660, lr=2.50857e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=133990
2024-11-08 02:55:24 - progress_bar.py[line:274] - INFO: epoch 053:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.392, ntokens=18346.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3480.6, ups=0.19, wpb=18346.8, bsz=1024, num_updates=20670, lr=2.50721e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=134043
2024-11-08 02:56:18 - progress_bar.py[line:274] - INFO: epoch 053:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=18328.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3375, ups=0.18, wpb=18328.7, bsz=1024, num_updates=20680, lr=2.50585e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=134097
2024-11-08 02:57:12 - progress_bar.py[line:274] - INFO: epoch 053:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.31, ntokens=17691.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.96, wps=3310.8, ups=0.19, wpb=17691.3, bsz=1024, num_updates=20690, lr=2.50449e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=134151
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-08 02:58:02 - progress_bar.py[line:274] - INFO: epoch 053:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17460.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3459, ups=0.2, wpb=17460.9, bsz=985.6, num_updates=20700, lr=2.50313e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=50, gb_free=13.3, wall=134201
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
2024-11-08 02:58:02 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 53 @ 20700 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
2024-11-08 02:58:02 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 02:59:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-08 03:01:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 53 @ 20700 updates, score 0) (writing took 226.56793284599553 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-08 03:02:44 - train.py[line:336] - INFO: end of epoch 53 (average epoch stats below)
2024-11-08 03:02:44 - progress_bar.py[line:282] - INFO: epoch 053 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.317 | ntokens 17802.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 4.98 | wps 2716.8 | ups 0.15 | wpb 17802.2 | bsz 1023 | num_updates 20700 | lr 2.50313e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1681 | gb_free 13.3 | wall 134483
2024-11-08 03:02:44 - trainer.py[line:639] - INFO: loading train data for epoch 54
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 03:05:24 - trainer.py[line:703] - INFO: begin training epoch 54
2024-11-08 03:05:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 03:06:19 - progress_bar.py[line:274] - INFO: epoch 054:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.324, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=358.8, ups=0.02, wpb=17828, bsz=1024, num_updates=20710, lr=2.50177e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=134698
2024-11-08 03:07:12 - progress_bar.py[line:274] - INFO: epoch 054:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.301, ntokens=17902.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3368.2, ups=0.19, wpb=17902.5, bsz=1024, num_updates=20720, lr=2.50041e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.5, wall=134751
2024-11-08 03:08:08 - progress_bar.py[line:274] - INFO: epoch 054:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.288, ntokens=17639.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.88, wps=3168.8, ups=0.18, wpb=17639.1, bsz=1024, num_updates=20730, lr=2.49905e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=46, gb_free=13.5, wall=134807
2024-11-08 03:09:02 - progress_bar.py[line:274] - INFO: epoch 054:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.284, ntokens=17795.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.87, wps=3302.4, ups=0.19, wpb=17795.6, bsz=1024, num_updates=20740, lr=2.49769e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=134861
2024-11-08 03:09:56 - progress_bar.py[line:274] - INFO: epoch 054:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.278, ntokens=17450.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3238, ups=0.19, wpb=17450.5, bsz=1024, num_updates=20750, lr=2.49633e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=134915
2024-11-08 03:10:50 - progress_bar.py[line:274] - INFO: epoch 054:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.294, ntokens=17783.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3251.9, ups=0.18, wpb=17783.6, bsz=1024, num_updates=20760, lr=2.49497e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=134969
2024-11-08 03:11:43 - progress_bar.py[line:274] - INFO: epoch 054:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.326, ntokens=17992.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.01, wps=3405.9, ups=0.19, wpb=17992.2, bsz=1024, num_updates=20770, lr=2.49361e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=135022
2024-11-08 03:12:36 - progress_bar.py[line:274] - INFO: epoch 054:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.268, ntokens=17729.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.82, wps=3358.3, ups=0.19, wpb=17729.5, bsz=1024, num_updates=20780, lr=2.49225e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=135075
2024-11-08 03:13:29 - progress_bar.py[line:274] - INFO: epoch 054:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17752.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3318.2, ups=0.19, wpb=17752.1, bsz=1024, num_updates=20790, lr=2.49089e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=135128
2024-11-08 03:14:24 - progress_bar.py[line:274] - INFO: epoch 054:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17937.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3313.9, ups=0.18, wpb=17937.4, bsz=1024, num_updates=20800, lr=2.48952e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135182
2024-11-08 03:15:18 - progress_bar.py[line:274] - INFO: epoch 054:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.308, ntokens=17610, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.95, wps=3243.6, ups=0.18, wpb=17610, bsz=1024, num_updates=20810, lr=2.48816e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=135237
2024-11-08 03:16:12 - progress_bar.py[line:274] - INFO: epoch 054:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.339, ntokens=17804.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.06, wps=3301.6, ups=0.19, wpb=17804.5, bsz=1024, num_updates=20820, lr=2.4868e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135291
2024-11-08 03:17:06 - progress_bar.py[line:274] - INFO: epoch 054:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.261, ntokens=17330.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.79, wps=3222.7, ups=0.19, wpb=17330.1, bsz=1024, num_updates=20830, lr=2.48544e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135344
2024-11-08 03:18:00 - progress_bar.py[line:274] - INFO: epoch 054:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.313, ntokens=17869.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.97, wps=3289.8, ups=0.18, wpb=17869.2, bsz=1024, num_updates=20840, lr=2.48408e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135399
2024-11-08 03:18:54 - progress_bar.py[line:274] - INFO: epoch 054:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.278, ntokens=17606.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.85, wps=3233.1, ups=0.18, wpb=17606.8, bsz=1024, num_updates=20850, lr=2.48272e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135453
2024-11-08 03:19:48 - progress_bar.py[line:274] - INFO: epoch 054:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.294, ntokens=17747.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3279.7, ups=0.18, wpb=17747.6, bsz=1024, num_updates=20860, lr=2.48136e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135507
2024-11-08 03:20:43 - progress_bar.py[line:274] - INFO: epoch 054:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.321, ntokens=18122, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5, wps=3299.2, ups=0.18, wpb=18122, bsz=1024, num_updates=20870, lr=2.48e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=135562
2024-11-08 03:21:37 - progress_bar.py[line:274] - INFO: epoch 054:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.272, ntokens=17468.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.83, wps=3232.9, ups=0.19, wpb=17468.4, bsz=1024, num_updates=20880, lr=2.47864e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135616
2024-11-08 03:22:33 - progress_bar.py[line:274] - INFO: epoch 054:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.315, ntokens=17915.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.98, wps=3216.9, ups=0.18, wpb=17915.6, bsz=1024, num_updates=20890, lr=2.47728e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=135672
2024-11-08 03:23:27 - progress_bar.py[line:274] - INFO: epoch 054:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.292, ntokens=17682.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.9, wps=3261.9, ups=0.18, wpb=17682.9, bsz=1024, num_updates=20900, lr=2.47592e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=135726
2024-11-08 03:24:22 - progress_bar.py[line:274] - INFO: epoch 054:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.303, ntokens=17842.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3237.7, ups=0.18, wpb=17842.9, bsz=1024, num_updates=20910, lr=2.47456e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=135781
2024-11-08 03:25:17 - progress_bar.py[line:274] - INFO: epoch 054:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.337, ntokens=17943.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.05, wps=3276.1, ups=0.18, wpb=17943.7, bsz=1024, num_updates=20920, lr=2.4732e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=135836
2024-11-08 03:26:11 - progress_bar.py[line:274] - INFO: epoch 054:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.304, ntokens=17709.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.94, wps=3274.3, ups=0.18, wpb=17709.1, bsz=1024, num_updates=20930, lr=2.47184e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=135890
2024-11-08 03:27:06 - progress_bar.py[line:274] - INFO: epoch 054:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.301, ntokens=17769.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.93, wps=3247.6, ups=0.18, wpb=17769.7, bsz=1024, num_updates=20940, lr=2.47048e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=135945
2024-11-08 03:28:00 - progress_bar.py[line:274] - INFO: epoch 054:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.243, ntokens=17335.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.73, wps=3194.1, ups=0.18, wpb=17335.1, bsz=1024, num_updates=20950, lr=2.46912e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=135999
2024-11-08 03:28:54 - progress_bar.py[line:274] - INFO: epoch 054:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.274, ntokens=17621.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.84, wps=3269.6, ups=0.19, wpb=17621.2, bsz=1024, num_updates=20960, lr=2.46776e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=136053
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347045 closing signal SIGINT
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347046 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347047 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347048 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347049 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347050 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347051 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347052 closing signal SIGINT
  File "../../train.py", line 298, in train
    for i, samples in enumerate(progress):
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/logging/progress_bar.py", line 261, in __iter__
    for i, obj in enumerate(self.iterable, start=self.n):
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 509, in _chunk_iterator
    for x in itr:
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 635, in __next__
    item = self._queue.get(True)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/queue.py", line 170, in get
    self.not_empty.wait()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/threading.py", line 296, in wait
    waiter.acquire()
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    Traceback (most recent call last):
loss.backward()
  File "../../train.py", line 543, in <module>
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347045 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347046 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347047 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347048 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347049 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347050 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347051 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 347052 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 346945 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 716, in run
    self._shutdown(e.sigval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 346945 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/run.py", line 756, in run
    )(*cmd_args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 237, in launch_agent
    result = agent.run()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/metrics/api.py", line 129, in wrapper
    result = f(*args, **kwargs)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 721, in run
    self._shutdown()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 346945 got signal: 2
