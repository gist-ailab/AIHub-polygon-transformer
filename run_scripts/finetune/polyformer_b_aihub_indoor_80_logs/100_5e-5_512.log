/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:37 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-06 13:40:39 - utils.py[line:261] - INFO: Start init
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-06 13:40:39 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 4
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 1
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 7
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 3
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 6
single-machine distributed training is initialized.
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 5
single-machine distributed training is initialized.
2024-11-06 13:40:39 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 2
single-machine distributed training is initialized.
2024-11-06 13:40:39 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 0
single-machine distributed training is initialized.
2024-11-06 13:40:43 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512', 'restore_file': '../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-06 13:40:43 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-06 13:40:43 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 13:40:56 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-06 13:40:56 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-06 13:40:56 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-06 13:40:56 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-06 13:40:56 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-06 13:40:56 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 4 row count 6839 total row count 54715
Downloading tokenizer_config.json:   0%|          | 0.00/25.0 [00:00<?, ?B/s]Downloading tokenizer_config.json: 100%|| 25.0/25.0 [00:00<00:00, 5.00kB/s]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 5 row count 6839 total row count 54715
Downloading ()tencepiece.bpe.model:   0%|          | 0.00/5.07M [00:00<?, ?B/s]Downloading ()tencepiece.bpe.model: 100%|| 5.07M/5.07M [00:00<00:00, 21.1MB/s]Downloading ()tencepiece.bpe.model: 100%|| 5.07M/5.07M [00:00<00:00, 20.8MB/s]
Downloading tokenizer.json:   0%|          | 0.00/9.10M [00:00<?, ?B/s]local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 2 row count 6840 total row count 54715
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 1 row count 6840 total row count 54715
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 3 row count 6839 total row count 54715
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 7 row count 6839 total row count 54715
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 6 row count 6839 total row count 54715
Downloading tokenizer.json: 100%|| 9.10M/9.10M [00:00<00:00, 19.5MB/s]Downloading tokenizer.json: 100%|| 9.10M/9.10M [00:00<00:00, 19.2MB/s]
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_val.tsv slice_id 0 row count 6840 total row count 54715
2024-11-06 13:41:19 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-06 13:41:19 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-06 13:41:19 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-06 13:41:21 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 13:41:21 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 13:41:21 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-06 13:41:21 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-06 13:41:21 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 13:41:32 - trainer.py[line:619] - INFO: Loaded checkpoint ../finetune/polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt (epoch 74 @ 0 updates)
2024-11-06 13:41:32 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 1 seek offset 50000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping






file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 5 seek offset 250000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 0 seek offset 0
slice_id 4 seek offset 200000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
2024-11-06 13:44:25 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-06 13:44:25 - train.py[line:297] - INFO: Start iterating over samples
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 2 seek offset 100000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.02297143856220666 loss_cls: 0.0032473441679030657
loss_reg: 0.01135831071139285 loss_cls: 0.0030096080154180527
loss_reg: 0.015267837781967726 loss_cls: 0.00426668394356966
loss_reg: 0.016800305808969386 loss_cls: 0.002847817027941346
loss_reg: 0.0046933634395530605 loss_cls: 0.0027561127208173275
loss_reg: 0.01810007709464248 loss_cls: 0.0036316849291324615
loss_reg: 0.016607880958196312 loss_cls: 0.003142159665003419
loss_reg: 0.0200729431093098 loss_cls: 0.0034592438023537397
loss_reg: 0.008691143454579133 loss_cls: 0.004253067076206207
loss_reg: 0.010352737209302448 loss_cls: 0.0032175793312489986
loss_reg: 0.017078402007872723 loss_cls: 0.0031507546082139015
loss_reg: 0.012029270207420104 loss_cls: 0.0034205110277980566
loss_reg: 0.0046958169723910845 loss_cls: 0.0027743675746023655
loss_reg: 0.012815560433010457 loss_cls: 0.003555023344233632
loss_reg: 0.013148609837097477 loss_cls: 0.003827559994533658
loss_reg: 0.01955852016509199 loss_cls: 0.0028929756954312325
loss_reg: 0.017421121488708457 loss_cls: 0.0031427741050720215
loss_reg: 0.01814756441935296 loss_cls: 0.004545845091342926
loss_reg: 0.009650886750427932 loss_cls: 0.0045293159782886505
loss_reg: 0.01207214689012066 loss_cls: 0.0027653828728944063
loss_reg: 0.004453710429665267 loss_cls: 0.0027635330334305763
loss_reg: 0.02025564252110163 loss_cls: 0.0036491109058260918
loss_reg: 0.013934677254264814 loss_cls: 0.0024831329938024282
loss_reg: 0.009546260798303136 loss_cls: 0.004379210062325001
loss_reg: 0.012900140583534506 loss_cls: 0.003889333223924041
loss_reg: 0.018291824205732696 loss_cls: 0.0032235169783234596
loss_reg: 0.013833876751743617 loss_cls: 0.0027637926395982504
loss_reg: 0.019095095230619627 loss_cls: 0.003779342398047447
loss_reg: 0.01652060399816062 loss_cls: 0.0038687698543071747
loss_reg: 0.00502547242863737 loss_cls: 0.0035307134967297316
loss_reg: 0.01893817901238808 loss_cls: 0.0028468933887779713
loss_reg: 0.012948630414719161 loss_cls: 0.00463188998401165
loss_reg: 0.014358982297745824 loss_cls: 0.00331475050188601
loss_reg: 0.0149840942823279 loss_cls: 0.0035055342596024275
loss_reg: 0.013464229872063013 loss_cls: 0.003587101586163044
loss_reg: 0.018096910413256784 loss_cls: 0.004202715121209621
loss_reg: 0.010608566167937494 loss_cls: 0.006255564279854298
loss_reg: 0.005809843509050404 loss_cls: 0.002468743361532688
loss_reg: 0.016533973110168874 loss_cls: 0.0052381278946995735
loss_reg: 0.01759285274776229 loss_cls: 0.0034208165016025305
loss_reg: 0.010690071515280663 loss_cls: 0.0036722554359585047
loss_reg: 0.010076800564421555 loss_cls: 0.003900547744706273
loss_reg: 0.010574025011432932 loss_cls: 0.004665974993258715
loss_reg: 0.018186121256652418 loss_cls: 0.0032005419488996267
loss_reg: 0.012680793502672996 loss_cls: 0.0031559907365590334
loss_reg: 0.007933183296575342 loss_cls: 0.0026460494846105576
loss_reg: 0.02226356007328792 loss_cls: 0.0029250120278447866
loss_reg: 0.016781901812098116 loss_cls: 0.005312762223184109
loss_reg: 0.009590464384801323 loss_cls: 0.0035091645549982786
loss_reg: 0.013568339989412884 loss_cls: 0.0024786086287349463
loss_reg: 0.015775202380151062 loss_cls: 0.002998781856149435
loss_reg: 0.012094462922784273 loss_cls: 0.0035288543440401554
loss_reg: 0.013174907943231555 loss_cls: 0.003168631112203002
loss_reg: 0.007991684268505158 loss_cls: 0.002687267493456602
loss_reg: 0.011028426779056844 loss_cls: 0.0038372662384063005
loss_reg: 0.012713617603672796 loss_cls: 0.004056405276060104
loss_reg: 0.018438797454097287 loss_cls: 0.0030762795358896255
loss_reg: 0.016204074614914292 loss_cls: 0.00368868769146502
loss_reg: 0.01650741563730948 loss_cls: 0.002504548756405711
loss_reg: 0.017962555503810658 loss_cls: 0.004098428413271904
loss_reg: 0.004590075030426458 loss_cls: 0.0033059155102819204
loss_reg: 0.009751376406582364 loss_cls: 0.0038041556254029274
loss_reg: 0.016853120120576364 loss_cls: 0.004635250195860863
loss_reg: 0.013542388517793921 loss_cls: 0.0032604229636490345
2024-11-06 13:45:24 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17535.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3313.9, ups=0.19, wpb=17535.3, bsz=1024, num_updates=10, lr=2.13129e-07, gnorm=0.008, clip=0, loss_scale=128, train_wall=41, gb_free=13.5, wall=243
2024-11-06 13:46:16 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17733.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3394.1, ups=0.19, wpb=17733.4, bsz=1024, num_updates=20, lr=4.26257e-07, gnorm=0.007, clip=0, loss_scale=128, train_wall=33, gb_free=13.5, wall=295
2024-11-06 13:47:11 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17420.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3192.4, ups=0.18, wpb=17420.7, bsz=1024, num_updates=30, lr=6.39386e-07, gnorm=0.004, clip=0, loss_scale=128, train_wall=33, gb_free=13.5, wall=350
2024-11-06 13:48:04 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17831.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3344.8, ups=0.19, wpb=17831.8, bsz=1024, num_updates=40, lr=8.52515e-07, gnorm=0.003, clip=0, loss_scale=128, train_wall=48, gb_free=13.5, wall=403
2024-11-06 13:48:56 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17628.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3375.2, ups=0.19, wpb=17628.1, bsz=1024, num_updates=50, lr=1.06564e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=50, gb_free=13.5, wall=455
2024-11-06 13:49:48 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17924.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3434.1, ups=0.19, wpb=17924.3, bsz=1024, num_updates=60, lr=1.27877e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=45, gb_free=13.5, wall=507
2024-11-06 13:50:41 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17717.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3351.4, ups=0.19, wpb=17717.1, bsz=1024, num_updates=70, lr=1.4919e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=560
2024-11-06 13:51:34 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17601.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3345.9, ups=0.19, wpb=17601.8, bsz=1024, num_updates=80, lr=1.70503e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=613
2024-11-06 13:52:27 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17624.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3343.7, ups=0.19, wpb=17624.4, bsz=1024, num_updates=90, lr=1.91816e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=35, gb_free=13.5, wall=666
2024-11-06 13:53:20 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17657, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3312.4, ups=0.19, wpb=17657, bsz=1024, num_updates=100, lr=2.13129e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=40, gb_free=13.5, wall=719
2024-11-06 13:54:13 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17488, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3316.5, ups=0.19, wpb=17488, bsz=1024, num_updates=110, lr=2.34442e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=39, gb_free=13.6, wall=772
2024-11-06 13:55:06 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17657, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3313.7, ups=0.19, wpb=17657, bsz=1024, num_updates=120, lr=2.55754e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=36, gb_free=13.6, wall=825
2024-11-06 13:55:59 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17663.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3300.2, ups=0.19, wpb=17663.1, bsz=1024, num_updates=130, lr=2.77067e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=44, gb_free=13.5, wall=878
2024-11-06 13:56:52 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17542.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3342.6, ups=0.19, wpb=17542.9, bsz=1024, num_updates=140, lr=2.9838e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=51, gb_free=13.6, wall=931
2024-11-06 13:57:45 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17394.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3307.3, ups=0.19, wpb=17394.6, bsz=1024, num_updates=150, lr=3.19693e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=50, gb_free=13.4, wall=983
2024-11-06 13:58:37 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17608.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3352.6, ups=0.19, wpb=17608.3, bsz=1024, num_updates=160, lr=3.41006e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=39, gb_free=13.5, wall=1036
2024-11-06 13:59:30 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=18153.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3415.5, ups=0.19, wpb=18153.7, bsz=1024, num_updates=170, lr=3.62319e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1089
2024-11-06 14:00:23 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17369.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3310.2, ups=0.19, wpb=17369.1, bsz=1024, num_updates=180, lr=3.83632e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1142
2024-11-06 14:01:16 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17980.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3392.1, ups=0.19, wpb=17980.9, bsz=1024, num_updates=190, lr=4.04945e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1195
2024-11-06 14:02:08 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17957.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3413, ups=0.19, wpb=17957.7, bsz=1024, num_updates=200, lr=4.26257e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1247
2024-11-06 14:03:01 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17907.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3398.6, ups=0.19, wpb=17907.3, bsz=1024, num_updates=210, lr=4.4757e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1300
2024-11-06 14:03:54 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17882.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3369.4, ups=0.19, wpb=17882.3, bsz=1024, num_updates=220, lr=4.68883e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1353
2024-11-06 14:04:47 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17841, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3389.1, ups=0.19, wpb=17841, bsz=1024, num_updates=230, lr=4.90196e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1406
2024-11-06 14:05:40 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=18014.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3380.9, ups=0.19, wpb=18014.1, bsz=1024, num_updates=240, lr=5.11509e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1459
2024-11-06 14:06:34 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17552.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3258.9, ups=0.19, wpb=17552.9, bsz=1024, num_updates=250, lr=5.32822e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=33, gb_free=13.6, wall=1513
2024-11-06 14:07:28 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17776.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3301, ups=0.19, wpb=17776.1, bsz=1024, num_updates=260, lr=5.54135e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.6, wall=1567
2024-11-06 14:08:20 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17647.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3365.8, ups=0.19, wpb=17647.3, bsz=1024, num_updates=270, lr=5.75448e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.6, wall=1619
2024-11-06 14:09:13 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17675.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3352.7, ups=0.19, wpb=17675.8, bsz=1024, num_updates=280, lr=5.9676e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=53, gb_free=13.5, wall=1672
2024-11-06 14:10:05 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17688.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3373.2, ups=0.19, wpb=17688.6, bsz=1024, num_updates=290, lr=6.18073e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=47, gb_free=13.6, wall=1724
2024-11-06 14:10:59 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17589.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3305.7, ups=0.19, wpb=17589.2, bsz=1024, num_updates=300, lr=6.39386e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=43, gb_free=13.4, wall=1777
2024-11-06 14:11:51 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=18811.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3556.4, ups=0.19, wpb=18811.6, bsz=1024, num_updates=310, lr=6.60699e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=48, gb_free=13.4, wall=1830
2024-11-06 14:12:44 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=18484.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3515.4, ups=0.19, wpb=18484.5, bsz=1024, num_updates=320, lr=6.82012e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=46, gb_free=13.4, wall=1883
2024-11-06 14:13:36 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=18256.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3499.1, ups=0.19, wpb=18256.4, bsz=1024, num_updates=330, lr=7.03325e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=46, gb_free=13.4, wall=1935
2024-11-06 14:14:29 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=18254.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3484, ups=0.19, wpb=18254.4, bsz=1024, num_updates=340, lr=7.24638e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=50, gb_free=13.3, wall=1987
2024-11-06 14:15:21 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=18619.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3548.2, ups=0.19, wpb=18619.8, bsz=1024, num_updates=350, lr=7.45951e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=52, gb_free=13.3, wall=2040
2024-11-06 14:16:14 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=18682, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3546.4, ups=0.19, wpb=18682, bsz=1024, num_updates=360, lr=7.67263e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=53, gb_free=13.3, wall=2093
2024-11-06 14:17:06 - progress_bar.py[line:274] - INFO: epoch 001:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=18394.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3494.2, ups=0.19, wpb=18394.6, bsz=1024, num_updates=370, lr=7.88576e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=53, gb_free=13.3, wall=2145
2024-11-06 14:17:59 - progress_bar.py[line:274] - INFO: epoch 001:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17954.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3423.4, ups=0.19, wpb=17954.2, bsz=1024, num_updates=380, lr=8.09889e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=52, gb_free=13.4, wall=2198
reach the end of datafile, start a new reader
2024-11-06 14:18:51 - progress_bar.py[line:274] - INFO: epoch 001:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17998.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3424.5, ups=0.19, wpb=17998.3, bsz=1024, num_updates=390, lr=8.31202e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=52, gb_free=13.5, wall=2250
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:18:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 391 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:18:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory

: No such file or directory: No such file or directory

cp: cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory

cp: cannot stat './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 14:19:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-06 14:19:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 391 updates, score 0) (writing took 21.988907869003015 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-06 14:19:20 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-06 14:19:20 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.621 | ntokens 17842.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.15 | wps 3340.1 | ups 0.19 | wpb 17842.9 | bsz 1023 | num_updates 391 | lr 8.33333e-06 | gnorm 0.003 | clip 0 | loss_scale 128 | train_wall 1640 | gb_free 13.4 | wall 2279
2024-11-06 14:19:20 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000



local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 14:21:58 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-06 14:21:58 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 14:22:47 - progress_bar.py[line:274] - INFO: epoch 002:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=16920.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=718.3, ups=0.04, wpb=16920.7, bsz=985.6, num_updates=400, lr=8.52515e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=29, gb_free=13.5, wall=2486
2024-11-06 14:23:39 - progress_bar.py[line:274] - INFO: epoch 002:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17781.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3409, ups=0.19, wpb=17781.7, bsz=1024, num_updates=410, lr=8.73828e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=2538
2024-11-06 14:24:31 - progress_bar.py[line:274] - INFO: epoch 002:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17664.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3398.3, ups=0.19, wpb=17664.5, bsz=1024, num_updates=420, lr=8.95141e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2590
2024-11-06 14:25:23 - progress_bar.py[line:274] - INFO: epoch 002:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17781.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3399.1, ups=0.19, wpb=17781.4, bsz=1024, num_updates=430, lr=9.16454e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2642
2024-11-06 14:26:16 - progress_bar.py[line:274] - INFO: epoch 002:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17766.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3384.9, ups=0.19, wpb=17766.1, bsz=1024, num_updates=440, lr=9.37766e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2695
2024-11-06 14:27:08 - progress_bar.py[line:274] - INFO: epoch 002:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17745.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3422.6, ups=0.19, wpb=17745.1, bsz=1024, num_updates=450, lr=9.59079e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2747
2024-11-06 14:28:00 - progress_bar.py[line:274] - INFO: epoch 002:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17994.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3428.4, ups=0.19, wpb=17994.6, bsz=1024, num_updates=460, lr=9.80392e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2799
2024-11-06 14:28:52 - progress_bar.py[line:274] - INFO: epoch 002:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17623, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3381.6, ups=0.19, wpb=17623, bsz=1024, num_updates=470, lr=1.00171e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2851
2024-11-06 14:29:44 - progress_bar.py[line:274] - INFO: epoch 002:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17736, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3411.6, ups=0.19, wpb=17736, bsz=1024, num_updates=480, lr=1.02302e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2903
2024-11-06 14:30:37 - progress_bar.py[line:274] - INFO: epoch 002:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17772.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3405.1, ups=0.19, wpb=17772.9, bsz=1024, num_updates=490, lr=1.04433e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2955
2024-11-06 14:31:29 - progress_bar.py[line:274] - INFO: epoch 002:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17619.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3343.4, ups=0.19, wpb=17619.3, bsz=1024, num_updates=500, lr=1.06564e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=3008
2024-11-06 14:32:22 - progress_bar.py[line:274] - INFO: epoch 002:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17921.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3376.6, ups=0.19, wpb=17921.9, bsz=1024, num_updates=510, lr=1.08696e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=3061
2024-11-06 14:33:14 - progress_bar.py[line:274] - INFO: epoch 002:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17451.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3354, ups=0.19, wpb=17451.5, bsz=1024, num_updates=520, lr=1.10827e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3113
2024-11-06 14:34:06 - progress_bar.py[line:274] - INFO: epoch 002:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17567.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3400, ups=0.19, wpb=17567.8, bsz=1024, num_updates=530, lr=1.12958e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3165
2024-11-06 14:35:02 - progress_bar.py[line:274] - INFO: epoch 002:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17618.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3136, ups=0.18, wpb=17618.6, bsz=1024, num_updates=540, lr=1.1509e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3221
2024-11-06 14:35:58 - progress_bar.py[line:274] - INFO: epoch 002:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17768.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3165.9, ups=0.18, wpb=17768.3, bsz=1024, num_updates=550, lr=1.17221e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3277
2024-11-06 14:36:51 - progress_bar.py[line:274] - INFO: epoch 002:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17867.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3370.3, ups=0.19, wpb=17867.5, bsz=1024, num_updates=560, lr=1.19352e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3330
2024-11-06 14:37:44 - progress_bar.py[line:274] - INFO: epoch 002:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17460.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3300.3, ups=0.19, wpb=17460.5, bsz=1024, num_updates=570, lr=1.21483e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3383
2024-11-06 14:38:36 - progress_bar.py[line:274] - INFO: epoch 002:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17606.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3391.3, ups=0.19, wpb=17606.1, bsz=1024, num_updates=580, lr=1.23615e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3435
2024-11-06 14:39:28 - progress_bar.py[line:274] - INFO: epoch 002:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=18257.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3522.3, ups=0.19, wpb=18257.9, bsz=1024, num_updates=590, lr=1.25746e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3487
2024-11-06 14:40:20 - progress_bar.py[line:274] - INFO: epoch 002:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17891.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3414.9, ups=0.19, wpb=17891.7, bsz=1024, num_updates=600, lr=1.27877e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=32, gb_free=13.4, wall=3539
2024-11-06 14:41:14 - progress_bar.py[line:274] - INFO: epoch 002:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17928.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3360.8, ups=0.19, wpb=17928.4, bsz=1024, num_updates=610, lr=1.30009e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=42, gb_free=13.4, wall=3593
2024-11-06 14:42:05 - progress_bar.py[line:274] - INFO: epoch 002:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17493.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3381.4, ups=0.19, wpb=17493.7, bsz=1024, num_updates=620, lr=1.3214e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=47, gb_free=13.5, wall=3644
2024-11-06 14:42:57 - progress_bar.py[line:274] - INFO: epoch 002:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17502.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3393.4, ups=0.19, wpb=17502.6, bsz=1024, num_updates=630, lr=1.34271e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=13.4, wall=3696
2024-11-06 14:43:50 - progress_bar.py[line:274] - INFO: epoch 002:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17517.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3323.3, ups=0.19, wpb=17517.1, bsz=1024, num_updates=640, lr=1.36402e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=34, gb_free=13.5, wall=3749
2024-11-06 14:44:45 - progress_bar.py[line:274] - INFO: epoch 002:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17444, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3155.7, ups=0.18, wpb=17444, bsz=1024, num_updates=650, lr=1.38534e-05, gnorm=0.007, clip=0, loss_scale=256, train_wall=50, gb_free=13.5, wall=3804
2024-11-06 14:45:39 - progress_bar.py[line:274] - INFO: epoch 002:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17774.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3288.6, ups=0.19, wpb=17774.7, bsz=1024, num_updates=660, lr=1.40665e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=54, gb_free=13.2, wall=3858
2024-11-06 14:46:32 - progress_bar.py[line:274] - INFO: epoch 002:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17653.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3352.5, ups=0.19, wpb=17653.5, bsz=1024, num_updates=670, lr=1.42796e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=53, gb_free=13.4, wall=3911
2024-11-06 14:47:24 - progress_bar.py[line:274] - INFO: epoch 002:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17454.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3340.2, ups=0.19, wpb=17454.1, bsz=1024, num_updates=680, lr=1.44928e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=3963
2024-11-06 14:48:16 - progress_bar.py[line:274] - INFO: epoch 002:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17843.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3411.2, ups=0.19, wpb=17843.2, bsz=1024, num_updates=690, lr=1.47059e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4015
2024-11-06 14:49:08 - progress_bar.py[line:274] - INFO: epoch 002:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=18559.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3574.3, ups=0.19, wpb=18559.6, bsz=1024, num_updates=700, lr=1.4919e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.2, wall=4067
2024-11-06 14:50:00 - progress_bar.py[line:274] - INFO: epoch 002:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=18438.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3570.9, ups=0.19, wpb=18438.7, bsz=1024, num_updates=710, lr=1.51321e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4119
2024-11-06 14:50:52 - progress_bar.py[line:274] - INFO: epoch 002:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=18044.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3482.1, ups=0.19, wpb=18044.4, bsz=1024, num_updates=720, lr=1.53453e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4171
2024-11-06 14:51:44 - progress_bar.py[line:274] - INFO: epoch 002:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=18149.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3473.4, ups=0.19, wpb=18149.8, bsz=1024, num_updates=730, lr=1.55584e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4223
2024-11-06 14:52:37 - progress_bar.py[line:274] - INFO: epoch 002:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=18508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3502.2, ups=0.19, wpb=18508.1, bsz=1024, num_updates=740, lr=1.57715e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=53, gb_free=13.3, wall=4276
2024-11-06 14:53:29 - progress_bar.py[line:274] - INFO: epoch 002:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=18280.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3503.5, ups=0.19, wpb=18280.9, bsz=1024, num_updates=750, lr=1.59847e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.4, wall=4328
2024-11-06 14:54:21 - progress_bar.py[line:274] - INFO: epoch 002:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18018.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3483.5, ups=0.19, wpb=18018.9, bsz=1024, num_updates=760, lr=1.61978e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4380
2024-11-06 14:55:12 - progress_bar.py[line:274] - INFO: epoch 002:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17930.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3469.3, ups=0.19, wpb=17930.3, bsz=1024, num_updates=770, lr=1.64109e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4431
2024-11-06 14:56:04 - progress_bar.py[line:274] - INFO: epoch 002:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17700.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3420.7, ups=0.19, wpb=17700.9, bsz=1024, num_updates=780, lr=1.6624e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=52, gb_free=13.5, wall=4483
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-06 14:56:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 782 updates
2024-11-06 14:56:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 14:58:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-06 14:59:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 782 updates, score 0) (writing took 221.05887915899802 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 15:00:47 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-06 15:00:47 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.615 | ntokens 17795.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.13 | wps 2798.1 | ups 0.16 | wpb 17795.9 | bsz 1023 | num_updates 782 | lr 1.66667e-05 | gnorm 0.005 | clip 0 | loss_scale 256 | train_wall 1529 | gb_free 13.4 | wall 4765
2024-11-06 15:00:47 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 15:03:25 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-06 15:03:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 15:04:09 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=16694.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=344.3, ups=0.02, wpb=16694.7, bsz=985.6, num_updates=790, lr=1.68372e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=4968
2024-11-06 15:05:01 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17901.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3414.2, ups=0.19, wpb=17901.5, bsz=1024, num_updates=800, lr=1.70503e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5020
2024-11-06 15:05:53 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17881.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3463.3, ups=0.19, wpb=17881.7, bsz=1024, num_updates=810, lr=1.72634e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5072
2024-11-06 15:06:46 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17912.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3386.3, ups=0.19, wpb=17912.9, bsz=1024, num_updates=820, lr=1.74766e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5125
2024-11-06 15:07:38 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17721, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3407.6, ups=0.19, wpb=17721, bsz=1024, num_updates=830, lr=1.76897e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5177
2024-11-06 15:08:30 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17823.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3417, ups=0.19, wpb=17823.4, bsz=1024, num_updates=840, lr=1.79028e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5229
2024-11-06 15:09:23 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17643.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3361.1, ups=0.19, wpb=17643.4, bsz=1024, num_updates=850, lr=1.81159e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5281
2024-11-06 15:10:15 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17884.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3418, ups=0.19, wpb=17884.5, bsz=1024, num_updates=860, lr=1.83291e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5334
2024-11-06 15:11:08 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17202.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3252.9, ups=0.19, wpb=17202.1, bsz=1024, num_updates=870, lr=1.85422e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5387
2024-11-06 15:12:00 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17716, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3371.5, ups=0.19, wpb=17716, bsz=1024, num_updates=880, lr=1.87553e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5439
2024-11-06 15:12:53 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17544.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3354.7, ups=0.19, wpb=17544.8, bsz=1024, num_updates=890, lr=1.89685e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5492
2024-11-06 15:13:45 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17929.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3410.5, ups=0.19, wpb=17929.2, bsz=1024, num_updates=900, lr=1.91816e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5544
2024-11-06 15:14:38 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17466, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3307.3, ups=0.19, wpb=17466, bsz=1024, num_updates=910, lr=1.93947e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5597
2024-11-06 15:15:30 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17273.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3306.4, ups=0.19, wpb=17273.5, bsz=1024, num_updates=920, lr=1.96078e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5649
2024-11-06 15:16:22 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17656.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3424.5, ups=0.19, wpb=17656.9, bsz=1024, num_updates=930, lr=1.9821e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5701
2024-11-06 15:17:13 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17831.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3455, ups=0.19, wpb=17831.6, bsz=1024, num_updates=940, lr=2.00341e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5752
2024-11-06 15:18:06 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17982.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3452.8, ups=0.19, wpb=17982.9, bsz=1024, num_updates=950, lr=2.02472e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5804
2024-11-06 15:18:59 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17181.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3241, ups=0.19, wpb=17181.7, bsz=1024, num_updates=960, lr=2.04604e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5857
2024-11-06 15:19:51 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3420.2, ups=0.19, wpb=17835.7, bsz=1024, num_updates=970, lr=2.06735e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5910
2024-11-06 15:20:43 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17554.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3333.9, ups=0.19, wpb=17554.7, bsz=1024, num_updates=980, lr=2.08866e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=5962
2024-11-06 15:21:36 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17918.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3413.8, ups=0.19, wpb=17918.2, bsz=1024, num_updates=990, lr=2.10997e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6015
2024-11-06 15:22:28 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17536.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3354.8, ups=0.19, wpb=17536.7, bsz=1024, num_updates=1000, lr=2.13129e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6067
2024-11-06 15:23:21 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17771.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3364.2, ups=0.19, wpb=17771.9, bsz=1024, num_updates=1010, lr=2.1526e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=6120
2024-11-06 15:24:14 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17462.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3318, ups=0.19, wpb=17462.8, bsz=1024, num_updates=1020, lr=2.17391e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=6172
2024-11-06 15:25:06 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17702.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3399.1, ups=0.19, wpb=17702.6, bsz=1024, num_updates=1030, lr=2.19523e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6225
2024-11-06 15:25:58 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17357.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3303.3, ups=0.19, wpb=17357.6, bsz=1024, num_updates=1040, lr=2.21654e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=6277
2024-11-06 15:26:50 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=18249.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3506.3, ups=0.19, wpb=18249.6, bsz=1024, num_updates=1050, lr=2.23785e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6329
2024-11-06 15:27:43 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17764.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3395.4, ups=0.19, wpb=17764.1, bsz=1024, num_updates=1060, lr=2.25916e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6381
2024-11-06 15:28:34 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17227.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3326.3, ups=0.19, wpb=17227.8, bsz=1024, num_updates=1070, lr=2.28048e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=6433
2024-11-06 15:29:26 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17898.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3458.8, ups=0.19, wpb=17898.3, bsz=1024, num_updates=1080, lr=2.30179e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6485
2024-11-06 15:30:18 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=18402.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3531.2, ups=0.19, wpb=18402.7, bsz=1024, num_updates=1090, lr=2.3231e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=6537
2024-11-06 15:31:10 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=18312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3513.3, ups=0.19, wpb=18312.9, bsz=1024, num_updates=1100, lr=2.34442e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6589
2024-11-06 15:32:03 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=18118.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3472.9, ups=0.19, wpb=18118.6, bsz=1024, num_updates=1110, lr=2.36573e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6641
2024-11-06 15:32:54 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=18372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3546, ups=0.19, wpb=18372.7, bsz=1024, num_updates=1120, lr=2.38704e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6693
2024-11-06 15:33:46 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=18510.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3549.8, ups=0.19, wpb=18510.1, bsz=1024, num_updates=1130, lr=2.40835e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=34, gb_free=13.2, wall=6745
2024-11-06 15:34:39 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=18306.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3488, ups=0.19, wpb=18306.6, bsz=1024, num_updates=1140, lr=2.42967e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=45, gb_free=13.2, wall=6798
2024-11-06 15:35:31 - progress_bar.py[line:274] - INFO: epoch 003:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18037.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3442, ups=0.19, wpb=18037.1, bsz=1024, num_updates=1150, lr=2.45098e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=52, gb_free=13.4, wall=6850
2024-11-06 15:36:26 - progress_bar.py[line:274] - INFO: epoch 003:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17982.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3319.6, ups=0.18, wpb=17982.3, bsz=1024, num_updates=1160, lr=2.47229e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=6904
2024-11-06 15:37:19 - progress_bar.py[line:274] - INFO: epoch 003:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17965.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3349.7, ups=0.19, wpb=17965.8, bsz=1024, num_updates=1170, lr=2.49361e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=6958
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-06 15:37:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1173 updates


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-06 15:37:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 15:39:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 15:41:11 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1173 updates, score 0) (writing took 220.05015903500316 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 15:42:06 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-06 15:42:06 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.618 | ntokens 17784.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.14 | wps 2804.8 | ups 0.16 | wpb 17784.7 | bsz 1023 | num_updates 1173 | lr 2.5e-05 | gnorm 0.005 | clip 0 | loss_scale 512 | train_wall 1278 | gb_free 13.4 | wall 7245
2024-11-06 15:42:06 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 15:44:44 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-06 15:44:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 15:45:23 - progress_bar.py[line:274] - INFO: epoch 004:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=16998.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=351.1, ups=0.02, wpb=16998.2, bsz=985.6, num_updates=1180, lr=2.51492e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=33, gb_free=13.6, wall=7442
2024-11-06 15:46:15 - progress_bar.py[line:274] - INFO: epoch 004:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17917.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3430.4, ups=0.19, wpb=17917.9, bsz=1024, num_updates=1190, lr=2.53623e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7494
2024-11-06 15:47:08 - progress_bar.py[line:274] - INFO: epoch 004:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17656.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3370.5, ups=0.19, wpb=17656.8, bsz=1024, num_updates=1200, lr=2.55754e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7547
2024-11-06 15:48:01 - progress_bar.py[line:274] - INFO: epoch 004:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=18080.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3392.7, ups=0.19, wpb=18080.6, bsz=1024, num_updates=1210, lr=2.57886e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7600
2024-11-06 15:48:54 - progress_bar.py[line:274] - INFO: epoch 004:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17609.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3359.2, ups=0.19, wpb=17609.3, bsz=1024, num_updates=1220, lr=2.60017e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7652
2024-11-06 15:49:46 - progress_bar.py[line:274] - INFO: epoch 004:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17636.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3349.4, ups=0.19, wpb=17636.2, bsz=1024, num_updates=1230, lr=2.62148e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7705
2024-11-06 15:50:39 - progress_bar.py[line:274] - INFO: epoch 004:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17847.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3401.2, ups=0.19, wpb=17847.3, bsz=1024, num_updates=1240, lr=2.6428e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7758
2024-11-06 15:51:31 - progress_bar.py[line:274] - INFO: epoch 004:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17303.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3303.4, ups=0.19, wpb=17303.2, bsz=1024, num_updates=1250, lr=2.66411e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7810
2024-11-06 15:52:23 - progress_bar.py[line:274] - INFO: epoch 004:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17653.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3369.9, ups=0.19, wpb=17653.4, bsz=1024, num_updates=1260, lr=2.68542e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7862
2024-11-06 15:53:16 - progress_bar.py[line:274] - INFO: epoch 004:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17707, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3364.7, ups=0.19, wpb=17707, bsz=1024, num_updates=1270, lr=2.70673e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7915
2024-11-06 15:54:09 - progress_bar.py[line:274] - INFO: epoch 004:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17543.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3337.5, ups=0.19, wpb=17543.2, bsz=1024, num_updates=1280, lr=2.72805e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7968
2024-11-06 15:55:01 - progress_bar.py[line:274] - INFO: epoch 004:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17831.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3419.6, ups=0.19, wpb=17831.1, bsz=1024, num_updates=1290, lr=2.74936e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8020
2024-11-06 15:55:53 - progress_bar.py[line:274] - INFO: epoch 004:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17544.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3353.3, ups=0.19, wpb=17544.4, bsz=1024, num_updates=1300, lr=2.77067e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8072
2024-11-06 15:56:46 - progress_bar.py[line:274] - INFO: epoch 004:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17554.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3326.4, ups=0.19, wpb=17554.4, bsz=1024, num_updates=1310, lr=2.79199e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8125
2024-11-06 15:57:41 - progress_bar.py[line:274] - INFO: epoch 004:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17976, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3274.5, ups=0.18, wpb=17976, bsz=1024, num_updates=1320, lr=2.8133e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=44, gb_free=13.5, wall=8180
2024-11-06 15:58:36 - progress_bar.py[line:274] - INFO: epoch 004:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17645.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3175.7, ups=0.18, wpb=17645.7, bsz=1024, num_updates=1330, lr=2.83461e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=55, gb_free=13.6, wall=8235
2024-11-06 15:59:32 - progress_bar.py[line:274] - INFO: epoch 004:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=18192.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3267.3, ups=0.18, wpb=18192.6, bsz=1024, num_updates=1340, lr=2.85592e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=56, gb_free=13.5, wall=8291
2024-11-06 16:00:28 - progress_bar.py[line:274] - INFO: epoch 004:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17242.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3092.6, ups=0.18, wpb=17242.9, bsz=1024, num_updates=1350, lr=2.87724e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=56, gb_free=13.3, wall=8347
2024-11-06 16:01:21 - progress_bar.py[line:274] - INFO: epoch 004:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=18062.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3403, ups=0.19, wpb=18062.6, bsz=1024, num_updates=1360, lr=2.89855e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=53, gb_free=13.5, wall=8400
2024-11-06 16:02:13 - progress_bar.py[line:274] - INFO: epoch 004:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3414.7, ups=0.19, wpb=17833.4, bsz=1024, num_updates=1370, lr=2.91986e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=52, gb_free=13.4, wall=8452
2024-11-06 16:03:05 - progress_bar.py[line:274] - INFO: epoch 004:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17976.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3443.9, ups=0.19, wpb=17976.4, bsz=1024, num_updates=1380, lr=2.94118e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=52, gb_free=13.5, wall=8504
2024-11-06 16:03:57 - progress_bar.py[line:274] - INFO: epoch 004:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17835.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3460.6, ups=0.19, wpb=17835.3, bsz=1024, num_updates=1390, lr=2.96249e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=51, gb_free=13.5, wall=8556
2024-11-06 16:04:49 - progress_bar.py[line:274] - INFO: epoch 004:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17476.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3377.5, ups=0.19, wpb=17476.3, bsz=1024, num_updates=1400, lr=2.9838e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=51, gb_free=13.6, wall=8607
2024-11-06 16:05:40 - progress_bar.py[line:274] - INFO: epoch 004:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17513.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3387.5, ups=0.19, wpb=17513.1, bsz=1024, num_updates=1410, lr=3.00512e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=40, gb_free=13.6, wall=8659
2024-11-06 16:06:33 - progress_bar.py[line:274] - INFO: epoch 004:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3323.6, ups=0.19, wpb=17357.9, bsz=1024, num_updates=1420, lr=3.02643e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=40, gb_free=13.5, wall=8711
2024-11-06 16:07:25 - progress_bar.py[line:274] - INFO: epoch 004:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17406.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3342.2, ups=0.19, wpb=17406.1, bsz=1024, num_updates=1430, lr=3.04774e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=36, gb_free=13.4, wall=8763
2024-11-06 16:08:17 - progress_bar.py[line:274] - INFO: epoch 004:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17638.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3385.2, ups=0.19, wpb=17638.7, bsz=1024, num_updates=1440, lr=3.06905e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=33, gb_free=13.4, wall=8816
2024-11-06 16:09:09 - progress_bar.py[line:274] - INFO: epoch 004:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17655, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3357.9, ups=0.19, wpb=17655, bsz=1024, num_updates=1450, lr=3.09037e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8868
2024-11-06 16:10:02 - progress_bar.py[line:274] - INFO: epoch 004:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3353.7, ups=0.19, wpb=17540.6, bsz=1024, num_updates=1460, lr=3.11168e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8920
2024-11-06 16:10:54 - progress_bar.py[line:274] - INFO: epoch 004:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17814.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3369.9, ups=0.19, wpb=17814.3, bsz=1024, num_updates=1470, lr=3.13299e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=33, gb_free=13.4, wall=8973
2024-11-06 16:11:46 - progress_bar.py[line:274] - INFO: epoch 004:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=18544.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3571.2, ups=0.19, wpb=18544.4, bsz=1024, num_updates=1480, lr=3.15431e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=45, gb_free=13.4, wall=9025
2024-11-06 16:12:41 - progress_bar.py[line:274] - INFO: epoch 004:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18211.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3353.8, ups=0.18, wpb=18211.8, bsz=1024, num_updates=1490, lr=3.17562e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=50, gb_free=13.4, wall=9080
2024-11-06 16:13:37 - progress_bar.py[line:274] - INFO: epoch 004:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=18072.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3199.3, ups=0.18, wpb=18072.1, bsz=1024, num_updates=1500, lr=3.19693e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=56, gb_free=13.4, wall=9136
2024-11-06 16:14:34 - progress_bar.py[line:274] - INFO: epoch 004:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=18249.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3225.3, ups=0.18, wpb=18249.8, bsz=1024, num_updates=1510, lr=3.21824e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=56, gb_free=13.5, wall=9193
2024-11-06 16:15:29 - progress_bar.py[line:274] - INFO: epoch 004:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18504.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3332.5, ups=0.18, wpb=18504.8, bsz=1024, num_updates=1520, lr=3.23956e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=55, gb_free=13.4, wall=9248
2024-11-06 16:16:23 - progress_bar.py[line:274] - INFO: epoch 004:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=18409.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3428.1, ups=0.19, wpb=18409.7, bsz=1024, num_updates=1530, lr=3.26087e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=54, gb_free=13.4, wall=9302
2024-11-06 16:17:15 - progress_bar.py[line:274] - INFO: epoch 004:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=18013.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3489, ups=0.19, wpb=18013.3, bsz=1024, num_updates=1540, lr=3.28218e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=9354
2024-11-06 16:18:07 - progress_bar.py[line:274] - INFO: epoch 004:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=18417.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3526.6, ups=0.19, wpb=18417.8, bsz=1024, num_updates=1550, lr=3.3035e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=9406
2024-11-06 16:18:59 - progress_bar.py[line:274] - INFO: epoch 004:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17982.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3459.6, ups=0.19, wpb=17982.8, bsz=1024, num_updates=1560, lr=3.32481e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=9458
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt2024-11-06 16:19:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1564 updates


2024-11-06 16:19:16 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 16:21:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 16:22:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1564 updates, score 0) (writing took 221.1307931959891 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 16:23:52 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-06 16:23:52 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.627 | ntokens 17804.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.18 | wps 2778.1 | ups 0.16 | wpb 17804.6 | bsz 1023 | num_updates 1564 | lr 3.33333e-05 | gnorm 0.007 | clip 0 | loss_scale 1024 | train_wall 1618 | gb_free 13.4 | wall 9751
2024-11-06 16:23:52 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 16:26:31 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-06 16:26:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 16:27:05 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=16950.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=348.5, ups=0.02, wpb=16950.1, bsz=985.6, num_updates=1570, lr=3.34612e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=13.5, wall=9944
2024-11-06 16:27:59 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=18019.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3344.4, ups=0.19, wpb=18019.7, bsz=1024, num_updates=1580, lr=3.36743e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=35, gb_free=13.4, wall=9998
2024-11-06 16:28:55 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17669.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3148.8, ups=0.18, wpb=17669.1, bsz=1024, num_updates=1590, lr=3.38875e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=56, gb_free=13.5, wall=10054
2024-11-06 16:29:50 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18047.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3290.5, ups=0.18, wpb=18047.6, bsz=1024, num_updates=1600, lr=3.41006e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=55, gb_free=13.6, wall=10109
2024-11-06 16:30:44 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17636.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3248.7, ups=0.18, wpb=17636.6, bsz=1024, num_updates=1610, lr=3.43137e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=54, gb_free=13.5, wall=10163
2024-11-06 16:31:37 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17429.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3321.2, ups=0.19, wpb=17429.8, bsz=1024, num_updates=1620, lr=3.45269e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=10216
2024-11-06 16:32:32 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17821, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3209.1, ups=0.18, wpb=17821, bsz=1024, num_updates=1630, lr=3.474e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=55, gb_free=13.3, wall=10271
2024-11-06 16:33:27 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17513, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3201.7, ups=0.18, wpb=17513, bsz=1024, num_updates=1640, lr=3.49531e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=55, gb_free=13.5, wall=10326
2024-11-06 16:34:19 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17536.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3345.3, ups=0.19, wpb=17536.2, bsz=1024, num_updates=1650, lr=3.51662e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=52, gb_free=13.5, wall=10378
2024-11-06 16:35:11 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17748.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3417.4, ups=0.19, wpb=17748.1, bsz=1024, num_updates=1660, lr=3.53794e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=52, gb_free=13.6, wall=10430
2024-11-06 16:36:03 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17450.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3399.2, ups=0.19, wpb=17450.6, bsz=1024, num_updates=1670, lr=3.55925e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=51, gb_free=13.4, wall=10482
2024-11-06 16:36:55 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17766.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3404.9, ups=0.19, wpb=17766.7, bsz=1024, num_updates=1680, lr=3.58056e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=46, gb_free=13.5, wall=10534
2024-11-06 16:37:47 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17573.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3400.2, ups=0.19, wpb=17573.9, bsz=1024, num_updates=1690, lr=3.60188e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=38, gb_free=13.6, wall=10585
2024-11-06 16:38:39 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17717.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3390.5, ups=0.19, wpb=17717.7, bsz=1024, num_updates=1700, lr=3.62319e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=34, gb_free=13.5, wall=10638
2024-11-06 16:39:32 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17535.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3328.6, ups=0.19, wpb=17535.7, bsz=1024, num_updates=1710, lr=3.6445e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=38, gb_free=13.5, wall=10690
2024-11-06 16:40:23 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17543.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3379.6, ups=0.19, wpb=17543.9, bsz=1024, num_updates=1720, lr=3.66581e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=39, gb_free=13.5, wall=10742
2024-11-06 16:41:15 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17868.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3447.4, ups=0.19, wpb=17868.5, bsz=1024, num_updates=1730, lr=3.68713e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=34, gb_free=13.4, wall=10794
2024-11-06 16:42:08 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17478.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3295.5, ups=0.19, wpb=17478.3, bsz=1024, num_updates=1740, lr=3.70844e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10847
2024-11-06 16:43:00 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17764.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3414.2, ups=0.19, wpb=17764.2, bsz=1024, num_updates=1750, lr=3.72975e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10899
2024-11-06 16:43:53 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17853.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3388.3, ups=0.19, wpb=17853.7, bsz=1024, num_updates=1760, lr=3.75107e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10952
2024-11-06 16:44:45 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=18052.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3459.5, ups=0.19, wpb=18052.6, bsz=1024, num_updates=1770, lr=3.77238e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11004
2024-11-06 16:45:38 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17732.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3386.7, ups=0.19, wpb=17732.1, bsz=1024, num_updates=1780, lr=3.79369e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=34, gb_free=13.5, wall=11056
2024-11-06 16:46:30 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17857.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3413.4, ups=0.19, wpb=17857.3, bsz=1024, num_updates=1790, lr=3.815e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=33, gb_free=13.5, wall=11109
2024-11-06 16:47:23 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17412.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3289.9, ups=0.19, wpb=17412.3, bsz=1024, num_updates=1800, lr=3.83632e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.6, wall=11162
2024-11-06 16:48:16 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17639, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3309, ups=0.19, wpb=17639, bsz=1024, num_updates=1810, lr=3.85763e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=41, gb_free=13.6, wall=11215
2024-11-06 16:49:09 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17767.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3360.2, ups=0.19, wpb=17767.7, bsz=1024, num_updates=1820, lr=3.87894e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=41, gb_free=13.4, wall=11268
2024-11-06 16:50:02 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17693.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3347.5, ups=0.19, wpb=17693.7, bsz=1024, num_updates=1830, lr=3.90026e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=43, gb_free=13.5, wall=11321
2024-11-06 16:50:54 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17650.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3361.1, ups=0.19, wpb=17650.6, bsz=1024, num_updates=1840, lr=3.92157e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=47, gb_free=13.5, wall=11373
2024-11-06 16:51:47 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17649.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3366.7, ups=0.19, wpb=17649.4, bsz=1024, num_updates=1850, lr=3.94288e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=46, gb_free=13.5, wall=11426
2024-11-06 16:52:39 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17541.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3373.2, ups=0.19, wpb=17541.8, bsz=1024, num_updates=1860, lr=3.96419e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=45, gb_free=13.4, wall=11478
2024-11-06 16:53:31 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=18415.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3511, ups=0.19, wpb=18415.1, bsz=1024, num_updates=1870, lr=3.98551e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=48, gb_free=13.4, wall=11530
2024-11-06 16:54:23 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=18160, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3498.5, ups=0.19, wpb=18160, bsz=1024, num_updates=1880, lr=4.00682e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=52, gb_free=13.5, wall=11582
2024-11-06 16:55:16 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17951.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3406.4, ups=0.19, wpb=17951.5, bsz=1024, num_updates=1890, lr=4.02813e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=53, gb_free=13.4, wall=11635
2024-11-06 16:56:09 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=18088.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3420.3, ups=0.19, wpb=18088.2, bsz=1024, num_updates=1900, lr=4.04945e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=53, gb_free=13.5, wall=11688
2024-11-06 16:57:01 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=18104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3441.7, ups=0.19, wpb=18104.2, bsz=1024, num_updates=1910, lr=4.07076e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=53, gb_free=13.5, wall=11740
2024-11-06 16:57:53 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=18218.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3494.5, ups=0.19, wpb=18218.3, bsz=1024, num_updates=1920, lr=4.09207e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=11792
2024-11-06 16:58:46 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17962.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3398.4, ups=0.19, wpb=17962.1, bsz=1024, num_updates=1930, lr=4.11338e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=53, gb_free=13.4, wall=11845
2024-11-06 16:59:38 - progress_bar.py[line:274] - INFO: epoch 005:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=18236.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3525.5, ups=0.19, wpb=18236.2, bsz=1024, num_updates=1940, lr=4.1347e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=11897
2024-11-06 17:00:30 - progress_bar.py[line:274] - INFO: epoch 005:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17753.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3400, ups=0.19, wpb=17753.8, bsz=1024, num_updates=1950, lr=4.15601e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=52, gb_free=13.3, wall=11949
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt2024-11-06 17:00:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1955 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt

2024-11-06 17:00:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 17:02:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 17:04:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1955 updates, score 0) (writing took 221.5284793380124 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 17:05:29 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-06 17:05:29 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.63 | ntokens 17766 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.19 | wps 2781.8 | ups 0.16 | wpb 17766 | bsz 1023 | num_updates 1955 | lr 4.16667e-05 | gnorm 0.008 | clip 0 | loss_scale 1024 | train_wall 1738 | gb_free 13.3 | wall 12248
2024-11-06 17:05:29 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 17:08:08 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-06 17:08:08 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 17:08:36 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=16956.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=348.9, ups=0.02, wpb=16956.5, bsz=985.6, num_updates=1960, lr=4.17732e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=38, gb_free=13.6, wall=12435
2024-11-06 17:09:29 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17600.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3366.8, ups=0.19, wpb=17600.6, bsz=1024, num_updates=1970, lr=4.19864e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12487
2024-11-06 17:10:20 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17796.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3424.6, ups=0.19, wpb=17796.8, bsz=1024, num_updates=1980, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12539
2024-11-06 17:11:13 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17729.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3373, ups=0.19, wpb=17729.1, bsz=1024, num_updates=1990, lr=4.24126e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12592
2024-11-06 17:12:05 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17528.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3354.9, ups=0.19, wpb=17528.1, bsz=1024, num_updates=2000, lr=4.26257e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=12644
2024-11-06 17:12:57 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17694, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3400.5, ups=0.19, wpb=17694, bsz=1024, num_updates=2010, lr=4.28389e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12696
2024-11-06 17:13:49 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17532.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3392.1, ups=0.19, wpb=17532.2, bsz=1024, num_updates=2020, lr=4.3052e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.6, wall=12748
2024-11-06 17:14:41 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18014.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3449.4, ups=0.19, wpb=18014.1, bsz=1024, num_updates=2030, lr=4.32651e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12800
2024-11-06 17:15:33 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17453, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3355.1, ups=0.19, wpb=17453, bsz=1024, num_updates=2040, lr=4.34783e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12852
2024-11-06 17:16:25 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3424.8, ups=0.19, wpb=17828, bsz=1024, num_updates=2050, lr=4.36914e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=12904
2024-11-06 17:17:17 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17386.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3333, ups=0.19, wpb=17386.2, bsz=1024, num_updates=2060, lr=4.39045e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=12956
2024-11-06 17:18:09 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17505, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3378.6, ups=0.19, wpb=17505, bsz=1024, num_updates=2070, lr=4.41176e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13008
2024-11-06 17:19:01 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17815.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3415.9, ups=0.19, wpb=17815.9, bsz=1024, num_updates=2080, lr=4.43308e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13060
2024-11-06 17:19:54 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17692.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3377.3, ups=0.19, wpb=17692.8, bsz=1024, num_updates=2090, lr=4.45439e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13113
2024-11-06 17:20:46 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17534.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3343.6, ups=0.19, wpb=17534.2, bsz=1024, num_updates=2100, lr=4.4757e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=13165
2024-11-06 17:21:39 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17791.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3389.5, ups=0.19, wpb=17791.4, bsz=1024, num_updates=2110, lr=4.49702e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13218
2024-11-06 17:22:32 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17780.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3312.9, ups=0.19, wpb=17780.2, bsz=1024, num_updates=2120, lr=4.51833e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=33, gb_free=13.6, wall=13271
2024-11-06 17:23:27 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17622.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3257.1, ups=0.18, wpb=17622.4, bsz=1024, num_updates=2130, lr=4.53964e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=49, gb_free=13.5, wall=13325
2024-11-06 17:24:22 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17660.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3175.1, ups=0.18, wpb=17660.9, bsz=1024, num_updates=2140, lr=4.56095e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=56, gb_free=13.5, wall=13381
2024-11-06 17:25:15 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17894.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3413.9, ups=0.19, wpb=17894.8, bsz=1024, num_updates=2150, lr=4.58227e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13433
2024-11-06 17:26:07 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17892.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3383.9, ups=0.19, wpb=17892.5, bsz=1024, num_updates=2160, lr=4.60358e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13486
2024-11-06 17:27:02 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17744.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3269.5, ups=0.18, wpb=17744.5, bsz=1024, num_updates=2170, lr=4.62489e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=54, gb_free=13.6, wall=13541
2024-11-06 17:27:54 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17851.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3446.4, ups=0.19, wpb=17851.1, bsz=1024, num_updates=2180, lr=4.64621e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13592
2024-11-06 17:28:45 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17608.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3404.7, ups=0.19, wpb=17608.7, bsz=1024, num_updates=2190, lr=4.66752e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13644
2024-11-06 17:29:37 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17412.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3343.5, ups=0.19, wpb=17412.8, bsz=1024, num_updates=2200, lr=4.68883e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=52, gb_free=13.6, wall=13696
2024-11-06 17:30:32 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17651.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3223.4, ups=0.18, wpb=17651.2, bsz=1024, num_updates=2210, lr=4.71014e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=13751
2024-11-06 17:31:25 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17978.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3418.8, ups=0.19, wpb=17978.2, bsz=1024, num_updates=2220, lr=4.73146e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13804
2024-11-06 17:32:17 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17633.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3368.6, ups=0.19, wpb=17633.2, bsz=1024, num_updates=2230, lr=4.75277e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13856
2024-11-06 17:33:09 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17538.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3364.2, ups=0.19, wpb=17538.6, bsz=1024, num_updates=2240, lr=4.77408e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13908
2024-11-06 17:34:02 - progress_bar.py[line:274] - INFO: epoch 006:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17736.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3370.1, ups=0.19, wpb=17736.7, bsz=1024, num_updates=2250, lr=4.7954e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=53, gb_free=13.5, wall=13961
2024-11-06 17:34:54 - progress_bar.py[line:274] - INFO: epoch 006:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=18116.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3472, ups=0.19, wpb=18116.1, bsz=1024, num_updates=2260, lr=4.81671e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=14013
2024-11-06 17:35:46 - progress_bar.py[line:274] - INFO: epoch 006:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=18532.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3548.6, ups=0.19, wpb=18532.7, bsz=1024, num_updates=2270, lr=4.83802e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14065
2024-11-06 17:36:38 - progress_bar.py[line:274] - INFO: epoch 006:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=18034.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3470.6, ups=0.19, wpb=18034.4, bsz=1024, num_updates=2280, lr=4.85934e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14117
2024-11-06 17:37:30 - progress_bar.py[line:274] - INFO: epoch 006:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=18357.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3534.1, ups=0.19, wpb=18357.4, bsz=1024, num_updates=2290, lr=4.88065e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14169
2024-11-06 17:38:25 - progress_bar.py[line:274] - INFO: epoch 006:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=18123.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3307.9, ups=0.18, wpb=18123.6, bsz=1024, num_updates=2300, lr=4.90196e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=14224
2024-11-06 17:39:17 - progress_bar.py[line:274] - INFO: epoch 006:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=18383.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3508.4, ups=0.19, wpb=18383.4, bsz=1024, num_updates=2310, lr=4.92327e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14276
2024-11-06 17:40:09 - progress_bar.py[line:274] - INFO: epoch 006:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=18150.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3482.3, ups=0.19, wpb=18150.1, bsz=1024, num_updates=2320, lr=4.94459e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=14328
2024-11-06 17:41:02 - progress_bar.py[line:274] - INFO: epoch 006:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=18110.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3477.1, ups=0.19, wpb=18110.2, bsz=1024, num_updates=2330, lr=4.9659e-05, gnorm=0.014, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=14380
2024-11-06 17:41:53 - progress_bar.py[line:274] - INFO: epoch 006:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17669.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3402.8, ups=0.19, wpb=17669.9, bsz=1024, num_updates=2340, lr=4.98721e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=14432
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-06 17:42:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2346 updates

2024-11-06 17:42:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt': File exists
: File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 17:44:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-06 17:46:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2346 updates, score 0) (writing took 221.55774336399918 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 17:46:57 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-06 17:46:57 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.656 | ntokens 17784.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.3 | wps 2794.5 | ups 0.16 | wpb 17784.1 | bsz 1023 | num_updates 2346 | lr 5e-05 | gnorm 0.008 | clip 0 | loss_scale 2048 | train_wall 1686 | gb_free 13.3 | wall 14736
2024-11-06 17:46:57 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 17:49:36 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-06 17:49:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 17:50:00 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17194.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=353.7, ups=0.02, wpb=17194.7, bsz=985.6, num_updates=2350, lr=4.99946e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=40, gb_free=13.6, wall=14918
2024-11-06 17:50:52 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17776.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3385.9, ups=0.19, wpb=17776.3, bsz=1024, num_updates=2360, lr=4.9981e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=14971
2024-11-06 17:51:45 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17561.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3329.1, ups=0.19, wpb=17561.7, bsz=1024, num_updates=2370, lr=4.99674e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15024
2024-11-06 17:52:38 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18089.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3423, ups=0.19, wpb=18089.7, bsz=1024, num_updates=2380, lr=4.99537e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15077
2024-11-06 17:53:31 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17575, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3316.8, ups=0.19, wpb=17575, bsz=1024, num_updates=2390, lr=4.99401e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15130
2024-11-06 17:54:24 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17857.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3350.3, ups=0.19, wpb=17857.9, bsz=1024, num_updates=2400, lr=4.99265e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15183
2024-11-06 17:55:17 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17915.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3402.1, ups=0.19, wpb=17915.1, bsz=1024, num_updates=2410, lr=4.99129e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15235
2024-11-06 17:56:10 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17736.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3320, ups=0.19, wpb=17736.8, bsz=1024, num_updates=2420, lr=4.98993e-05, gnorm=0.014, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=15289
2024-11-06 17:57:04 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17626.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3254.3, ups=0.18, wpb=17626.6, bsz=1024, num_updates=2430, lr=4.98857e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15343
2024-11-06 17:57:58 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17901.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3317.7, ups=0.19, wpb=17901.8, bsz=1024, num_updates=2440, lr=4.98721e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15397
2024-11-06 17:58:52 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17759.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3329.2, ups=0.19, wpb=17759.9, bsz=1024, num_updates=2450, lr=4.98585e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15450
2024-11-06 17:59:45 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17760.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3350.8, ups=0.19, wpb=17760.6, bsz=1024, num_updates=2460, lr=4.98449e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15503
2024-11-06 18:00:37 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17529.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3355, ups=0.19, wpb=17529.9, bsz=1024, num_updates=2470, lr=4.98313e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15556
2024-11-06 18:01:29 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17282.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3336.2, ups=0.19, wpb=17282.4, bsz=1024, num_updates=2480, lr=4.98177e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15607
2024-11-06 18:02:21 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17853.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3419.8, ups=0.19, wpb=17853.9, bsz=1024, num_updates=2490, lr=4.98041e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15660
2024-11-06 18:03:13 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17790.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3419.2, ups=0.19, wpb=17790.8, bsz=1024, num_updates=2500, lr=4.97905e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15712
2024-11-06 18:04:05 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17768.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3377.6, ups=0.19, wpb=17768.3, bsz=1024, num_updates=2510, lr=4.97769e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15764
2024-11-06 18:04:57 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17920.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3447, ups=0.19, wpb=17920.7, bsz=1024, num_updates=2520, lr=4.97633e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=15816
2024-11-06 18:05:49 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17346.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3338.8, ups=0.19, wpb=17346.3, bsz=1024, num_updates=2530, lr=4.97497e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15868
2024-11-06 18:06:42 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17869.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3426.7, ups=0.19, wpb=17869.5, bsz=1024, num_updates=2540, lr=4.97361e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15920
2024-11-06 18:07:34 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17821.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3414.7, ups=0.19, wpb=17821.4, bsz=1024, num_updates=2550, lr=4.97225e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15973
2024-11-06 18:08:26 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=18120.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3434.4, ups=0.19, wpb=18120.2, bsz=1024, num_updates=2560, lr=4.97089e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=16025
2024-11-06 18:09:19 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17745.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3388.9, ups=0.19, wpb=17745.7, bsz=1024, num_updates=2570, lr=4.96953e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16078
2024-11-06 18:10:11 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17390.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3319.3, ups=0.19, wpb=17390.6, bsz=1024, num_updates=2580, lr=4.96817e-05, gnorm=0.015, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16130
2024-11-06 18:11:03 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17671.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3383.1, ups=0.19, wpb=17671.1, bsz=1024, num_updates=2590, lr=4.96681e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16182
2024-11-06 18:11:56 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17862, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3422.6, ups=0.19, wpb=17862, bsz=1024, num_updates=2600, lr=4.96545e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16235
2024-11-06 18:12:47 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17673.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3419, ups=0.19, wpb=17673.5, bsz=1024, num_updates=2610, lr=4.96409e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16286
2024-11-06 18:13:40 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17901.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3420.6, ups=0.19, wpb=17901.4, bsz=1024, num_updates=2620, lr=4.96273e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16339
2024-11-06 18:14:32 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17429.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3362.3, ups=0.19, wpb=17429.2, bsz=1024, num_updates=2630, lr=4.96136e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16390
2024-11-06 18:15:24 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17591.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3361.5, ups=0.19, wpb=17591.7, bsz=1024, num_updates=2640, lr=4.96e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16443
2024-11-06 18:16:16 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=18256.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3525, ups=0.19, wpb=18256.5, bsz=1024, num_updates=2650, lr=4.95864e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=32, gb_free=13.3, wall=16495
2024-11-06 18:17:09 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=18767.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3514.4, ups=0.19, wpb=18767.4, bsz=1024, num_updates=2660, lr=4.95728e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=48, gb_free=13.2, wall=16548
2024-11-06 18:18:02 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=18130.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3429.3, ups=0.19, wpb=18130.8, bsz=1024, num_updates=2670, lr=4.95592e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=53, gb_free=13.4, wall=16601
2024-11-06 18:18:55 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=18209.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3400.8, ups=0.19, wpb=18209.3, bsz=1024, num_updates=2680, lr=4.95456e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=53, gb_free=13.5, wall=16654
2024-11-06 18:19:48 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17916.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3418.8, ups=0.19, wpb=17916.4, bsz=1024, num_updates=2690, lr=4.9532e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=16707
2024-11-06 18:20:40 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=18730.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3619.4, ups=0.19, wpb=18730.4, bsz=1024, num_updates=2700, lr=4.95184e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=52, gb_free=13.1, wall=16758
2024-11-06 18:21:34 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=18436.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3417.3, ups=0.19, wpb=18436.4, bsz=1024, num_updates=2710, lr=4.95048e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=54, gb_free=13.4, wall=16812
2024-11-06 18:22:26 - progress_bar.py[line:274] - INFO: epoch 007:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17946, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3453.8, ups=0.19, wpb=17946, bsz=1024, num_updates=2720, lr=4.94912e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=52, gb_free=13.3, wall=16864
2024-11-06 18:23:17 - progress_bar.py[line:274] - INFO: epoch 007:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=18220.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3525.6, ups=0.19, wpb=18220.8, bsz=1024, num_updates=2730, lr=4.94776e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=16916
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt2024-11-06 18:23:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2737 updates


2024-11-06 18:23:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 18:25:41 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-06 18:27:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2737 updates, score 0) (writing took 222.42839722700592 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 18:28:27 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-06 18:28:27 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.658 | ntokens 17839.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.31 | wps 2801.4 | ups 0.16 | wpb 17839.9 | bsz 1023 | num_updates 2737 | lr 4.94681e-05 | gnorm 0.009 | clip 0 | loss_scale 4096 | train_wall 1375 | gb_free 13.4 | wall 17226
2024-11-06 18:28:27 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 18:31:06 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-06 18:31:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 18:31:24 - progress_bar.py[line:274] - INFO: epoch 008:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17100.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=351.1, ups=0.02, wpb=17100.5, bsz=985.6, num_updates=2740, lr=4.9464e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=42, gb_free=13.5, wall=17403
2024-11-06 18:32:16 - progress_bar.py[line:274] - INFO: epoch 008:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17414.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3354, ups=0.19, wpb=17414.2, bsz=1024, num_updates=2750, lr=4.94504e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17455
2024-11-06 18:33:10 - progress_bar.py[line:274] - INFO: epoch 008:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17912, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3321.6, ups=0.19, wpb=17912, bsz=1024, num_updates=2760, lr=4.94368e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=37, gb_free=13.6, wall=17509
2024-11-06 18:34:02 - progress_bar.py[line:274] - INFO: epoch 008:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17865.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3433.4, ups=0.19, wpb=17865.8, bsz=1024, num_updates=2770, lr=4.94232e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17561
2024-11-06 18:34:54 - progress_bar.py[line:274] - INFO: epoch 008:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17511.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3386.9, ups=0.19, wpb=17511.3, bsz=1024, num_updates=2780, lr=4.94096e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=50, gb_free=13.4, wall=17613
2024-11-06 18:35:46 - progress_bar.py[line:274] - INFO: epoch 008:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17472.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3334.6, ups=0.19, wpb=17472.5, bsz=1024, num_updates=2790, lr=4.9396e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=50, gb_free=13.5, wall=17665
2024-11-06 18:36:38 - progress_bar.py[line:274] - INFO: epoch 008:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18033.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3471.1, ups=0.19, wpb=18033.8, bsz=1024, num_updates=2800, lr=4.93824e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=50, gb_free=13.4, wall=17717
2024-11-06 18:37:31 - progress_bar.py[line:274] - INFO: epoch 008:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17705.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3374.4, ups=0.19, wpb=17705.5, bsz=1024, num_updates=2810, lr=4.93688e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17770
2024-11-06 18:38:23 - progress_bar.py[line:274] - INFO: epoch 008:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17328.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3316.8, ups=0.19, wpb=17328.2, bsz=1024, num_updates=2820, lr=4.93552e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=17822
2024-11-06 18:39:15 - progress_bar.py[line:274] - INFO: epoch 008:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17708, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3415.6, ups=0.19, wpb=17708, bsz=1024, num_updates=2830, lr=4.93416e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=49, gb_free=13.4, wall=17874
2024-11-06 18:40:07 - progress_bar.py[line:274] - INFO: epoch 008:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17518.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3366.4, ups=0.19, wpb=17518.6, bsz=1024, num_updates=2840, lr=4.9328e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=46, gb_free=13.6, wall=17926
2024-11-06 18:41:02 - progress_bar.py[line:274] - INFO: epoch 008:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17769.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3240.9, ups=0.18, wpb=17769.1, bsz=1024, num_updates=2850, lr=4.93144e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=53, gb_free=13.5, wall=17981
2024-11-06 18:41:53 - progress_bar.py[line:274] - INFO: epoch 008:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3459.6, ups=0.19, wpb=17828, bsz=1024, num_updates=2860, lr=4.93008e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=51, gb_free=13.6, wall=18032
2024-11-06 18:42:45 - progress_bar.py[line:274] - INFO: epoch 008:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17679.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3401.1, ups=0.19, wpb=17679.5, bsz=1024, num_updates=2870, lr=4.92872e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=40, gb_free=13.5, wall=18084
2024-11-06 18:43:40 - progress_bar.py[line:274] - INFO: epoch 008:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17740.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3244.9, ups=0.18, wpb=17740.8, bsz=1024, num_updates=2880, lr=4.92735e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=36, gb_free=13.3, wall=18139
2024-11-06 18:44:33 - progress_bar.py[line:274] - INFO: epoch 008:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17721.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3348.6, ups=0.19, wpb=17721.6, bsz=1024, num_updates=2890, lr=4.92599e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=42, gb_free=13.6, wall=18192
2024-11-06 18:45:26 - progress_bar.py[line:274] - INFO: epoch 008:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17699.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3330.8, ups=0.19, wpb=17699.2, bsz=1024, num_updates=2900, lr=4.92463e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=32, gb_free=13.5, wall=18245
2024-11-06 18:46:19 - progress_bar.py[line:274] - INFO: epoch 008:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17743.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3343.1, ups=0.19, wpb=17743.7, bsz=1024, num_updates=2910, lr=4.92327e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18298
2024-11-06 18:47:12 - progress_bar.py[line:274] - INFO: epoch 008:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17318.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3278.5, ups=0.19, wpb=17318.7, bsz=1024, num_updates=2920, lr=4.92191e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18351
2024-11-06 18:48:04 - progress_bar.py[line:274] - INFO: epoch 008:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17854, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3402.4, ups=0.19, wpb=17854, bsz=1024, num_updates=2930, lr=4.92055e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18403
2024-11-06 18:48:57 - progress_bar.py[line:274] - INFO: epoch 008:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=18015.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3440.2, ups=0.19, wpb=18015.2, bsz=1024, num_updates=2940, lr=4.91919e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18456
2024-11-06 18:49:49 - progress_bar.py[line:274] - INFO: epoch 008:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18036.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3443.7, ups=0.19, wpb=18036.2, bsz=1024, num_updates=2950, lr=4.91783e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18508
2024-11-06 18:50:42 - progress_bar.py[line:274] - INFO: epoch 008:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17810.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3384.8, ups=0.19, wpb=17810.8, bsz=1024, num_updates=2960, lr=4.91647e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18561
2024-11-06 18:51:34 - progress_bar.py[line:274] - INFO: epoch 008:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17937.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3418.2, ups=0.19, wpb=17937.7, bsz=1024, num_updates=2970, lr=4.91511e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18613
2024-11-06 18:52:26 - progress_bar.py[line:274] - INFO: epoch 008:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17626.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3382.7, ups=0.19, wpb=17626.8, bsz=1024, num_updates=2980, lr=4.91375e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18665
2024-11-06 18:53:18 - progress_bar.py[line:274] - INFO: epoch 008:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17410.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3336.7, ups=0.19, wpb=17410.1, bsz=1024, num_updates=2990, lr=4.91239e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18717
2024-11-06 18:54:11 - progress_bar.py[line:274] - INFO: epoch 008:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17756.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3396.7, ups=0.19, wpb=17756.9, bsz=1024, num_updates=3000, lr=4.91103e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18770
2024-11-06 18:55:03 - progress_bar.py[line:274] - INFO: epoch 008:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17970.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3452.6, ups=0.19, wpb=17970.2, bsz=1024, num_updates=3010, lr=4.90967e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18822
2024-11-06 18:55:55 - progress_bar.py[line:274] - INFO: epoch 008:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17699.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3376.5, ups=0.19, wpb=17699.8, bsz=1024, num_updates=3020, lr=4.90831e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.6, wall=18874
2024-11-06 18:56:49 - progress_bar.py[line:274] - INFO: epoch 008:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17659.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3251.4, ups=0.18, wpb=17659.2, bsz=1024, num_updates=3030, lr=4.90695e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=47, gb_free=13.5, wall=18928
2024-11-06 18:57:42 - progress_bar.py[line:274] - INFO: epoch 008:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=18053, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3446, ups=0.19, wpb=18053, bsz=1024, num_updates=3040, lr=4.90559e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=52, gb_free=13.5, wall=18981
2024-11-06 18:58:35 - progress_bar.py[line:274] - INFO: epoch 008:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=18369.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3474.8, ups=0.19, wpb=18369.3, bsz=1024, num_updates=3050, lr=4.90423e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=53, gb_free=13.4, wall=19034
2024-11-06 18:59:26 - progress_bar.py[line:274] - INFO: epoch 008:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17966.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3481.2, ups=0.19, wpb=17966.4, bsz=1024, num_updates=3060, lr=4.90287e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=52, gb_free=13.4, wall=19085
2024-11-06 19:00:19 - progress_bar.py[line:274] - INFO: epoch 008:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=18654.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3575.1, ups=0.19, wpb=18654.4, bsz=1024, num_updates=3070, lr=4.90151e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=52, gb_free=13.1, wall=19137
2024-11-06 19:01:11 - progress_bar.py[line:274] - INFO: epoch 008:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=18152.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3489.7, ups=0.19, wpb=18152.6, bsz=1024, num_updates=3080, lr=4.90015e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=19189
2024-11-06 19:02:02 - progress_bar.py[line:274] - INFO: epoch 008:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=18466.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3580.5, ups=0.19, wpb=18466.4, bsz=1024, num_updates=3090, lr=4.89879e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=51, gb_free=13.4, wall=19241
2024-11-06 19:02:55 - progress_bar.py[line:274] - INFO: epoch 008:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=18319.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3488.3, ups=0.19, wpb=18319.5, bsz=1024, num_updates=3100, lr=4.89743e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=19294
2024-11-06 19:03:47 - progress_bar.py[line:274] - INFO: epoch 008:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18187.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3483, ups=0.19, wpb=18187.8, bsz=1024, num_updates=3110, lr=4.89607e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=19346
2024-11-06 19:04:40 - progress_bar.py[line:274] - INFO: epoch 008:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17865.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3366.4, ups=0.19, wpb=17865.5, bsz=1024, num_updates=3120, lr=4.89471e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=19399
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt2024-11-06 19:05:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 3128 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-06 19:05:18 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 19:07:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-06 19:09:01 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 3128 updates, score 0) (writing took 222.50548460400023 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 19:09:55 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-06 19:09:55 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.638 | ntokens 17819.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.22 | wps 2800.2 | ups 0.16 | wpb 17819.1 | bsz 1023 | num_updates 3128 | lr 4.89362e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 1652 | gb_free 13.3 | wall 19714
2024-11-06 19:09:55 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 19:12:34 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-06 19:12:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 19:12:47 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17141.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=351.7, ups=0.02, wpb=17141.2, bsz=985.6, num_updates=3130, lr=4.89334e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=44, gb_free=13.6, wall=19886
2024-11-06 19:13:39 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17444.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3346.4, ups=0.19, wpb=17444.1, bsz=1024, num_updates=3140, lr=4.89198e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=19938
2024-11-06 19:14:32 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17755.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3399.3, ups=0.19, wpb=17755.6, bsz=1024, num_updates=3150, lr=4.89062e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19990
2024-11-06 19:15:24 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17875.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3419.8, ups=0.19, wpb=17875.9, bsz=1024, num_updates=3160, lr=4.88926e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20043
2024-11-06 19:16:16 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17766.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3378.7, ups=0.19, wpb=17766.8, bsz=1024, num_updates=3170, lr=4.8879e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20095
2024-11-06 19:17:08 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17315.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3344.9, ups=0.19, wpb=17315.9, bsz=1024, num_updates=3180, lr=4.88654e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20147
2024-11-06 19:18:01 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18011.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3438.9, ups=0.19, wpb=18011.3, bsz=1024, num_updates=3190, lr=4.88518e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20200
2024-11-06 19:18:53 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17506.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3345.2, ups=0.19, wpb=17506.1, bsz=1024, num_updates=3200, lr=4.88382e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20252
2024-11-06 19:19:45 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17833.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3401.3, ups=0.19, wpb=17833.5, bsz=1024, num_updates=3210, lr=4.88246e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20304
2024-11-06 19:20:38 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17695.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3388.3, ups=0.19, wpb=17695.7, bsz=1024, num_updates=3220, lr=4.8811e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20356
2024-11-06 19:21:30 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17789.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3394.1, ups=0.19, wpb=17789.9, bsz=1024, num_updates=3230, lr=4.87974e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=20409
2024-11-06 19:22:22 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3321.7, ups=0.19, wpb=17357.9, bsz=1024, num_updates=3240, lr=4.87838e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20461
2024-11-06 19:23:15 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17711.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3386.7, ups=0.19, wpb=17711.1, bsz=1024, num_updates=3250, lr=4.87702e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=20513
2024-11-06 19:24:07 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17570, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3364.8, ups=0.19, wpb=17570, bsz=1024, num_updates=3260, lr=4.87566e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20566
2024-11-06 19:24:59 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17685.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3383.5, ups=0.19, wpb=17685.9, bsz=1024, num_updates=3270, lr=4.8743e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20618
2024-11-06 19:25:51 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17679.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3372.2, ups=0.19, wpb=17679.9, bsz=1024, num_updates=3280, lr=4.87294e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20670
2024-11-06 19:26:44 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17683.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3359, ups=0.19, wpb=17683.1, bsz=1024, num_updates=3290, lr=4.87158e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=34, gb_free=13.5, wall=20723
2024-11-06 19:27:36 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17846, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3422.7, ups=0.19, wpb=17846, bsz=1024, num_updates=3300, lr=4.87022e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=43, gb_free=13.6, wall=20775
2024-11-06 19:28:29 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17672.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3336.5, ups=0.19, wpb=17672.3, bsz=1024, num_updates=3310, lr=4.86886e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=45, gb_free=13.6, wall=20828
2024-11-06 19:29:22 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17843.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3394.7, ups=0.19, wpb=17843.8, bsz=1024, num_updates=3320, lr=4.8675e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=49, gb_free=13.6, wall=20881
2024-11-06 19:30:14 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17942.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3450, ups=0.19, wpb=17942.9, bsz=1024, num_updates=3330, lr=4.86614e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=49, gb_free=13.5, wall=20933
2024-11-06 19:31:07 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17887.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3383, ups=0.19, wpb=17887.5, bsz=1024, num_updates=3340, lr=4.86478e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=53, gb_free=13.4, wall=20986
2024-11-06 19:31:59 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17811.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3425.6, ups=0.19, wpb=17811.8, bsz=1024, num_updates=3350, lr=4.86342e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21038
2024-11-06 19:32:52 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17888.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3378.2, ups=0.19, wpb=17888.1, bsz=1024, num_updates=3360, lr=4.86206e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21091
2024-11-06 19:33:44 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17238.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3271.9, ups=0.19, wpb=17238.4, bsz=1024, num_updates=3370, lr=4.8607e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21143
2024-11-06 19:34:37 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17685.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3328.7, ups=0.19, wpb=17685.6, bsz=1024, num_updates=3380, lr=4.85934e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21196
2024-11-06 19:35:31 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17868.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3362, ups=0.19, wpb=17868.6, bsz=1024, num_updates=3390, lr=4.85797e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21249
2024-11-06 19:36:23 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17859.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3435.9, ups=0.19, wpb=17859.5, bsz=1024, num_updates=3400, lr=4.85661e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21301
2024-11-06 19:37:14 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17557, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3408, ups=0.19, wpb=17557, bsz=1024, num_updates=3410, lr=4.85525e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=51, gb_free=13.6, wall=21353
2024-11-06 19:38:06 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17677.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3377.4, ups=0.19, wpb=17677.9, bsz=1024, num_updates=3420, lr=4.85389e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21405
2024-11-06 19:38:59 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17791.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3380.1, ups=0.19, wpb=17791.6, bsz=1024, num_updates=3430, lr=4.85253e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=53, gb_free=13.4, wall=21458
2024-11-06 19:39:51 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=18392.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3537.3, ups=0.19, wpb=18392.2, bsz=1024, num_updates=3440, lr=4.85117e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21510
2024-11-06 19:40:43 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=18254.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3535.6, ups=0.19, wpb=18254.3, bsz=1024, num_updates=3450, lr=4.84981e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21562
2024-11-06 19:41:36 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=18282.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3424.9, ups=0.19, wpb=18282.3, bsz=1024, num_updates=3460, lr=4.84845e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=21615
2024-11-06 19:42:28 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17979.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3445.6, ups=0.19, wpb=17979.4, bsz=1024, num_updates=3470, lr=4.84709e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21667
2024-11-06 19:43:21 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=18383.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3516.1, ups=0.19, wpb=18383.8, bsz=1024, num_updates=3480, lr=4.84573e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=21719
2024-11-06 19:44:13 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18115.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3475.5, ups=0.19, wpb=18115.8, bsz=1024, num_updates=3490, lr=4.84437e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21772
2024-11-06 19:45:05 - progress_bar.py[line:274] - INFO: epoch 009:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=18733.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3575.5, ups=0.19, wpb=18733.8, bsz=1024, num_updates=3500, lr=4.84301e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=52, gb_free=13.3, wall=21824
2024-11-06 19:45:57 - progress_bar.py[line:274] - INFO: epoch 009:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17772.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3409.1, ups=0.19, wpb=17772.4, bsz=1024, num_updates=3510, lr=4.84165e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=21876
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-06 19:46:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3519 updates
2024-11-06 19:46:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 19:48:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-06 19:50:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3519 updates, score 0) (writing took 222.20814892199996 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 19:51:18 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-06 19:51:18 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.625 | ntokens 17807.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.17 | wps 2804.8 | ups 0.16 | wpb 17807.6 | bsz 1023 | num_updates 3519 | lr 4.84043e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 1668 | gb_free 13.3 | wall 22197
2024-11-06 19:51:18 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 19:53:57 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-06 19:53:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 19:54:05 - progress_bar.py[line:274] - INFO: epoch 010:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17453.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=358.1, ups=0.02, wpb=17453.4, bsz=985.6, num_updates=3520, lr=4.84029e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=47, gb_free=13.4, wall=22363
2024-11-06 19:54:57 - progress_bar.py[line:274] - INFO: epoch 010:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17511.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3366.1, ups=0.19, wpb=17511.6, bsz=1024, num_updates=3530, lr=4.83893e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22416
2024-11-06 19:55:49 - progress_bar.py[line:274] - INFO: epoch 010:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17794.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3383.3, ups=0.19, wpb=17794.2, bsz=1024, num_updates=3540, lr=4.83757e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=22468
2024-11-06 19:56:42 - progress_bar.py[line:274] - INFO: epoch 010:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17737.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3361.6, ups=0.19, wpb=17737.9, bsz=1024, num_updates=3550, lr=4.83621e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22521
2024-11-06 19:57:34 - progress_bar.py[line:274] - INFO: epoch 010:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17723.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3414.6, ups=0.19, wpb=17723.7, bsz=1024, num_updates=3560, lr=4.83485e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22573
2024-11-06 19:58:26 - progress_bar.py[line:274] - INFO: epoch 010:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17516.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3369.9, ups=0.19, wpb=17516.5, bsz=1024, num_updates=3570, lr=4.83349e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22625
2024-11-06 19:59:18 - progress_bar.py[line:274] - INFO: epoch 010:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17826.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3432.6, ups=0.19, wpb=17826.6, bsz=1024, num_updates=3580, lr=4.83213e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22677
2024-11-06 20:00:10 - progress_bar.py[line:274] - INFO: epoch 010:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17606.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3350.2, ups=0.19, wpb=17606.6, bsz=1024, num_updates=3590, lr=4.83077e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=22729
2024-11-06 20:01:03 - progress_bar.py[line:274] - INFO: epoch 010:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17723.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3387.3, ups=0.19, wpb=17723.1, bsz=1024, num_updates=3600, lr=4.82941e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=22782
2024-11-06 20:01:55 - progress_bar.py[line:274] - INFO: epoch 010:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17804.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3406.1, ups=0.19, wpb=17804.9, bsz=1024, num_updates=3610, lr=4.82805e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=22834
2024-11-06 20:02:48 - progress_bar.py[line:274] - INFO: epoch 010:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17542.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3293.3, ups=0.19, wpb=17542.5, bsz=1024, num_updates=3620, lr=4.82669e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=39, gb_free=13.5, wall=22887
2024-11-06 20:03:40 - progress_bar.py[line:274] - INFO: epoch 010:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17597.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3382.8, ups=0.19, wpb=17597.9, bsz=1024, num_updates=3630, lr=4.82533e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=40, gb_free=13.4, wall=22939
2024-11-06 20:04:32 - progress_bar.py[line:274] - INFO: epoch 010:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17656, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3385.8, ups=0.19, wpb=17656, bsz=1024, num_updates=3640, lr=4.82396e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=22991
2024-11-06 20:05:25 - progress_bar.py[line:274] - INFO: epoch 010:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17395.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3310.3, ups=0.19, wpb=17395.8, bsz=1024, num_updates=3650, lr=4.8226e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=23044
2024-11-06 20:06:17 - progress_bar.py[line:274] - INFO: epoch 010:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17768.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3398.7, ups=0.19, wpb=17768.9, bsz=1024, num_updates=3660, lr=4.82124e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23096
2024-11-06 20:07:10 - progress_bar.py[line:274] - INFO: epoch 010:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17862, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3395.2, ups=0.19, wpb=17862, bsz=1024, num_updates=3670, lr=4.81988e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23149
2024-11-06 20:08:03 - progress_bar.py[line:274] - INFO: epoch 010:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17723, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3337.1, ups=0.19, wpb=17723, bsz=1024, num_updates=3680, lr=4.81852e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=32, gb_free=13.5, wall=23202
2024-11-06 20:08:58 - progress_bar.py[line:274] - INFO: epoch 010:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=18031, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3258.9, ups=0.18, wpb=18031, bsz=1024, num_updates=3690, lr=4.81716e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=44, gb_free=13.5, wall=23257
2024-11-06 20:09:55 - progress_bar.py[line:274] - INFO: epoch 010:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17524.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3087.2, ups=0.18, wpb=17524.8, bsz=1024, num_updates=3700, lr=4.8158e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=48, gb_free=13.6, wall=23314
2024-11-06 20:10:52 - progress_bar.py[line:274] - INFO: epoch 010:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17937.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3169.3, ups=0.18, wpb=17937.8, bsz=1024, num_updates=3710, lr=4.81444e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=23371
2024-11-06 20:11:49 - progress_bar.py[line:274] - INFO: epoch 010:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17760.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3098.3, ups=0.17, wpb=17760.5, bsz=1024, num_updates=3720, lr=4.81308e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=23428
2024-11-06 20:12:45 - progress_bar.py[line:274] - INFO: epoch 010:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=18022.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3227.1, ups=0.18, wpb=18022.8, bsz=1024, num_updates=3730, lr=4.81172e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=23484
2024-11-06 20:13:37 - progress_bar.py[line:274] - INFO: epoch 010:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17742.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3388.4, ups=0.19, wpb=17742.3, bsz=1024, num_updates=3740, lr=4.81036e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23536
2024-11-06 20:14:30 - progress_bar.py[line:274] - INFO: epoch 010:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=18208.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3464.8, ups=0.19, wpb=18208.9, bsz=1024, num_updates=3750, lr=4.809e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23589
2024-11-06 20:15:22 - progress_bar.py[line:274] - INFO: epoch 010:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3341.2, ups=0.19, wpb=17420.4, bsz=1024, num_updates=3760, lr=4.80764e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=23641
2024-11-06 20:16:14 - progress_bar.py[line:274] - INFO: epoch 010:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17454.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3356, ups=0.19, wpb=17454.9, bsz=1024, num_updates=3770, lr=4.80628e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=23693
2024-11-06 20:17:05 - progress_bar.py[line:274] - INFO: epoch 010:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17489.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3403.9, ups=0.19, wpb=17489.7, bsz=1024, num_updates=3780, lr=4.80492e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=50, gb_free=13.5, wall=23744
2024-11-06 20:17:57 - progress_bar.py[line:274] - INFO: epoch 010:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17692.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3422.1, ups=0.19, wpb=17692.3, bsz=1024, num_updates=3790, lr=4.80356e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=39, gb_free=13.5, wall=23796
2024-11-06 20:18:50 - progress_bar.py[line:274] - INFO: epoch 010:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17650.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3338.8, ups=0.19, wpb=17650.2, bsz=1024, num_updates=3800, lr=4.8022e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=23849
2024-11-06 20:19:43 - progress_bar.py[line:274] - INFO: epoch 010:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17732.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3354.9, ups=0.19, wpb=17732.6, bsz=1024, num_updates=3810, lr=4.80084e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23902
2024-11-06 20:20:35 - progress_bar.py[line:274] - INFO: epoch 010:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=18175.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3472.5, ups=0.19, wpb=18175.7, bsz=1024, num_updates=3820, lr=4.79948e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=23954
2024-11-06 20:21:29 - progress_bar.py[line:274] - INFO: epoch 010:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=18509.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3459.5, ups=0.19, wpb=18509.4, bsz=1024, num_updates=3830, lr=4.79812e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=50, gb_free=13.4, wall=24007
2024-11-06 20:22:20 - progress_bar.py[line:274] - INFO: epoch 010:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=18219.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3523.2, ups=0.19, wpb=18219.5, bsz=1024, num_updates=3840, lr=4.79676e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=24059
2024-11-06 20:23:13 - progress_bar.py[line:274] - INFO: epoch 010:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=18186.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3461.8, ups=0.19, wpb=18186.7, bsz=1024, num_updates=3850, lr=4.7954e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=24112
2024-11-06 20:24:04 - progress_bar.py[line:274] - INFO: epoch 010:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=18129.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3514.5, ups=0.19, wpb=18129.2, bsz=1024, num_updates=3860, lr=4.79404e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=24163
2024-11-06 20:24:56 - progress_bar.py[line:274] - INFO: epoch 010:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=18677.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3597.7, ups=0.19, wpb=18677.2, bsz=1024, num_updates=3870, lr=4.79268e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=24215
2024-11-06 20:25:48 - progress_bar.py[line:274] - INFO: epoch 010:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=18294.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3558.3, ups=0.19, wpb=18294.1, bsz=1024, num_updates=3880, lr=4.79132e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=24267
2024-11-06 20:26:40 - progress_bar.py[line:274] - INFO: epoch 010:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=18055.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3422.7, ups=0.19, wpb=18055.6, bsz=1024, num_updates=3890, lr=4.78995e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=24319
2024-11-06 20:27:33 - progress_bar.py[line:274] - INFO: epoch 010:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=18334.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3502.8, ups=0.19, wpb=18334.2, bsz=1024, num_updates=3900, lr=4.78859e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=24372
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 20:28:22 - progress_bar.py[line:274] - INFO: epoch 010:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17446.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3537.4, ups=0.2, wpb=17446.6, bsz=985.6, num_updates=3910, lr=4.78723e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=49, gb_free=13.3, wall=24421
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

2024-11-06 20:28:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3910 updates
2024-11-06 20:28:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 20:30:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-06 20:32:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3910 updates, score 0) (writing took 220.60931834900111 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 20:32:57 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-06 20:32:57 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.627 | ntokens 17831.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.18 | wps 2789.5 | ups 0.16 | wpb 17831.9 | bsz 1023 | num_updates 3910 | lr 4.78723e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1626 | gb_free 13.3 | wall 24696
2024-11-06 20:32:57 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 20:35:36 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-06 20:35:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 20:36:30 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17420.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=356.7, ups=0.02, wpb=17420.1, bsz=1024, num_updates=3920, lr=4.78587e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24909
2024-11-06 20:37:23 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17675.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3383.7, ups=0.19, wpb=17675.8, bsz=1024, num_updates=3930, lr=4.78451e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24962
2024-11-06 20:38:15 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17745.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3398, ups=0.19, wpb=17745.3, bsz=1024, num_updates=3940, lr=4.78315e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=25014
2024-11-06 20:39:07 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17891, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3442, ups=0.19, wpb=17891, bsz=1024, num_updates=3950, lr=4.78179e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25066
2024-11-06 20:39:59 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17564, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3372.9, ups=0.19, wpb=17564, bsz=1024, num_updates=3960, lr=4.78043e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25118
2024-11-06 20:40:51 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17881.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3428.9, ups=0.19, wpb=17881.1, bsz=1024, num_updates=3970, lr=4.77907e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25170
2024-11-06 20:41:43 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17633.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3372.7, ups=0.19, wpb=17633.7, bsz=1024, num_updates=3980, lr=4.77771e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25222
2024-11-06 20:42:36 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17886.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3415.3, ups=0.19, wpb=17886.6, bsz=1024, num_updates=3990, lr=4.77635e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25275
2024-11-06 20:43:30 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17440.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3236.6, ups=0.19, wpb=17440.4, bsz=1024, num_updates=4000, lr=4.77499e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25329
2024-11-06 20:44:22 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17900.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3427.5, ups=0.19, wpb=17900.2, bsz=1024, num_updates=4010, lr=4.77363e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25381
2024-11-06 20:45:14 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17790.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3423.1, ups=0.19, wpb=17790.2, bsz=1024, num_updates=4020, lr=4.77227e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25433
2024-11-06 20:46:06 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17724.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3374.6, ups=0.19, wpb=17724.2, bsz=1024, num_updates=4030, lr=4.77091e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25485
2024-11-06 20:46:59 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17222, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3268.7, ups=0.19, wpb=17222, bsz=1024, num_updates=4040, lr=4.76955e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25538
2024-11-06 20:47:51 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17347.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3320, ups=0.19, wpb=17347.5, bsz=1024, num_updates=4050, lr=4.76819e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25590
2024-11-06 20:48:44 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17626.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3361.3, ups=0.19, wpb=17626.7, bsz=1024, num_updates=4060, lr=4.76683e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25643
2024-11-06 20:49:36 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17634.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3381.1, ups=0.19, wpb=17634.8, bsz=1024, num_updates=4070, lr=4.76547e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25695
2024-11-06 20:50:28 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=18081.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3481.4, ups=0.19, wpb=18081.6, bsz=1024, num_updates=4080, lr=4.76411e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25747
2024-11-06 20:51:20 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17767.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3395.7, ups=0.19, wpb=17767.2, bsz=1024, num_updates=4090, lr=4.76275e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25799
2024-11-06 20:52:12 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17950.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3439.2, ups=0.19, wpb=17950.3, bsz=1024, num_updates=4100, lr=4.76139e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=25851
2024-11-06 20:53:05 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17939.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3442.9, ups=0.19, wpb=17939.3, bsz=1024, num_updates=4110, lr=4.76003e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=25903
2024-11-06 20:53:57 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17644.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3358.8, ups=0.19, wpb=17644.2, bsz=1024, num_updates=4120, lr=4.75867e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=25956
2024-11-06 20:54:50 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17997.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3411.8, ups=0.19, wpb=17997.2, bsz=1024, num_updates=4130, lr=4.75731e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26009
2024-11-06 20:55:42 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17635.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3349.6, ups=0.19, wpb=17635.3, bsz=1024, num_updates=4140, lr=4.75594e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=26061
2024-11-06 20:56:34 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17489.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3370.9, ups=0.19, wpb=17489.8, bsz=1024, num_updates=4150, lr=4.75458e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=26113
2024-11-06 20:57:27 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17612.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3358.4, ups=0.19, wpb=17612.8, bsz=1024, num_updates=4160, lr=4.75322e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26166
2024-11-06 20:58:19 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17726.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3409.2, ups=0.19, wpb=17726.1, bsz=1024, num_updates=4170, lr=4.75186e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26218
2024-11-06 20:59:11 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18057.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3472.4, ups=0.19, wpb=18057.4, bsz=1024, num_updates=4180, lr=4.7505e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=26270
2024-11-06 21:00:03 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17572.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3342, ups=0.19, wpb=17572.2, bsz=1024, num_updates=4190, lr=4.74914e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26322
2024-11-06 21:00:56 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3334.9, ups=0.19, wpb=17455, bsz=1024, num_updates=4200, lr=4.74778e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26375
2024-11-06 21:01:47 - progress_bar.py[line:274] - INFO: epoch 011:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17839.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3446.9, ups=0.19, wpb=17839.5, bsz=1024, num_updates=4210, lr=4.74642e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=26426
2024-11-06 21:02:39 - progress_bar.py[line:274] - INFO: epoch 011:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=18562.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3620.5, ups=0.2, wpb=18562.4, bsz=1024, num_updates=4220, lr=4.74506e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=26478
2024-11-06 21:03:31 - progress_bar.py[line:274] - INFO: epoch 011:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=18050.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3451, ups=0.19, wpb=18050.7, bsz=1024, num_updates=4230, lr=4.7437e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26530
2024-11-06 21:04:23 - progress_bar.py[line:274] - INFO: epoch 011:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=18245.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3506.5, ups=0.19, wpb=18245.5, bsz=1024, num_updates=4240, lr=4.74234e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26582
2024-11-06 21:05:15 - progress_bar.py[line:274] - INFO: epoch 011:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=18322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3502.3, ups=0.19, wpb=18322.9, bsz=1024, num_updates=4250, lr=4.74098e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=26634
2024-11-06 21:06:07 - progress_bar.py[line:274] - INFO: epoch 011:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=18309.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3538.3, ups=0.19, wpb=18309.9, bsz=1024, num_updates=4260, lr=4.73962e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26686
2024-11-06 21:06:59 - progress_bar.py[line:274] - INFO: epoch 011:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=18400, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3540, ups=0.19, wpb=18400, bsz=1024, num_updates=4270, lr=4.73826e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=26738
2024-11-06 21:07:51 - progress_bar.py[line:274] - INFO: epoch 011:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=18262.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3521.1, ups=0.19, wpb=18262.4, bsz=1024, num_updates=4280, lr=4.7369e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=26790
2024-11-06 21:08:43 - progress_bar.py[line:274] - INFO: epoch 011:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=18451.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3517.8, ups=0.19, wpb=18451.1, bsz=1024, num_updates=4290, lr=4.73554e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=26842
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 21:09:35 - progress_bar.py[line:274] - INFO: epoch 011:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17753.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3416.7, ups=0.19, wpb=17753.6, bsz=1024, num_updates=4300, lr=4.73418e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13.3, wall=26894
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt2024-11-06 21:09:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4301 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-06 21:09:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 21:11:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 21:13:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4301 updates, score 0) (writing took 220.4491288470017 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-06 21:14:12 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-06 21:14:12 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.62 | ntokens 17815.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.15 | wps 2814.5 | ups 0.16 | wpb 17815.1 | bsz 1023 | num_updates 4301 | lr 4.73404e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1205 | gb_free 13.4 | wall 27171
2024-11-06 21:14:12 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 21:16:52 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-06 21:16:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 21:17:42 - progress_bar.py[line:274] - INFO: epoch 012:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=16806.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=345, ups=0.02, wpb=16806.3, bsz=985.6, num_updates=4310, lr=4.73282e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=29, gb_free=13.6, wall=27381
2024-11-06 21:18:35 - progress_bar.py[line:274] - INFO: epoch 012:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17724.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3400.6, ups=0.19, wpb=17724.7, bsz=1024, num_updates=4320, lr=4.73146e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27433
2024-11-06 21:19:27 - progress_bar.py[line:274] - INFO: epoch 012:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17678, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3396.2, ups=0.19, wpb=17678, bsz=1024, num_updates=4330, lr=4.7301e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27486
2024-11-06 21:20:19 - progress_bar.py[line:274] - INFO: epoch 012:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17727.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3387.6, ups=0.19, wpb=17727.6, bsz=1024, num_updates=4340, lr=4.72874e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27538
2024-11-06 21:21:11 - progress_bar.py[line:274] - INFO: epoch 012:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17686, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3402.6, ups=0.19, wpb=17686, bsz=1024, num_updates=4350, lr=4.72738e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=27590
2024-11-06 21:22:04 - progress_bar.py[line:274] - INFO: epoch 012:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17735.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3372.5, ups=0.19, wpb=17735.7, bsz=1024, num_updates=4360, lr=4.72602e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27642
2024-11-06 21:22:35 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-06 21:23:02 - progress_bar.py[line:274] - INFO: epoch 012:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17545.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3012.8, ups=0.17, wpb=17545.6, bsz=1024, num_updates=4370, lr=4.72466e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=27701
2024-11-06 21:23:56 - progress_bar.py[line:274] - INFO: epoch 012:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17855.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3316, ups=0.19, wpb=17855.9, bsz=1024, num_updates=4380, lr=4.7233e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=27755
2024-11-06 21:24:48 - progress_bar.py[line:274] - INFO: epoch 012:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17694.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3353.6, ups=0.19, wpb=17694.3, bsz=1024, num_updates=4390, lr=4.72194e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=43, gb_free=13.5, wall=27807
2024-11-06 21:25:41 - progress_bar.py[line:274] - INFO: epoch 012:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3346, ups=0.19, wpb=17525.8, bsz=1024, num_updates=4400, lr=4.72057e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=41, gb_free=13.4, wall=27860
2024-11-06 21:26:33 - progress_bar.py[line:274] - INFO: epoch 012:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17467.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3336.3, ups=0.19, wpb=17467.5, bsz=1024, num_updates=4410, lr=4.71921e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=44, gb_free=13.5, wall=27912
2024-11-06 21:27:27 - progress_bar.py[line:274] - INFO: epoch 012:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17515, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3260.1, ups=0.19, wpb=17515, bsz=1024, num_updates=4420, lr=4.71785e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=48, gb_free=13.5, wall=27966
2024-11-06 21:28:22 - progress_bar.py[line:274] - INFO: epoch 012:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17453.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3182.2, ups=0.18, wpb=17453.1, bsz=1024, num_updates=4430, lr=4.71649e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.6, wall=28021
2024-11-06 21:29:17 - progress_bar.py[line:274] - INFO: epoch 012:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17630, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3214, ups=0.18, wpb=17630, bsz=1024, num_updates=4440, lr=4.71513e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28075
2024-11-06 21:30:12 - progress_bar.py[line:274] - INFO: epoch 012:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17515.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3173.6, ups=0.18, wpb=17515.3, bsz=1024, num_updates=4450, lr=4.71377e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=28131
2024-11-06 21:31:06 - progress_bar.py[line:274] - INFO: epoch 012:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17873.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3265.3, ups=0.18, wpb=17873.8, bsz=1024, num_updates=4460, lr=4.71241e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28185
2024-11-06 21:32:02 - progress_bar.py[line:274] - INFO: epoch 012:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17938.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3249.7, ups=0.18, wpb=17938.3, bsz=1024, num_updates=4470, lr=4.71105e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=28241
2024-11-06 21:32:56 - progress_bar.py[line:274] - INFO: epoch 012:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17298.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3197.4, ups=0.18, wpb=17298.8, bsz=1024, num_updates=4480, lr=4.70969e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=28295
2024-11-06 21:33:50 - progress_bar.py[line:274] - INFO: epoch 012:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17632.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3278.7, ups=0.19, wpb=17632.9, bsz=1024, num_updates=4490, lr=4.70833e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28348
2024-11-06 21:34:44 - progress_bar.py[line:274] - INFO: epoch 012:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17490.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3243.1, ups=0.19, wpb=17490.1, bsz=1024, num_updates=4500, lr=4.70697e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28402
2024-11-06 21:35:37 - progress_bar.py[line:274] - INFO: epoch 012:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17881.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3331.9, ups=0.19, wpb=17881.5, bsz=1024, num_updates=4510, lr=4.70561e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=28456
2024-11-06 21:36:29 - progress_bar.py[line:274] - INFO: epoch 012:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17657.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3379.1, ups=0.19, wpb=17657.2, bsz=1024, num_updates=4520, lr=4.70425e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=28508
2024-11-06 21:37:21 - progress_bar.py[line:274] - INFO: epoch 012:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17865.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3456.1, ups=0.19, wpb=17865.9, bsz=1024, num_updates=4530, lr=4.70289e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28560
2024-11-06 21:38:13 - progress_bar.py[line:274] - INFO: epoch 012:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17866.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3419.6, ups=0.19, wpb=17866.9, bsz=1024, num_updates=4540, lr=4.70153e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=28612
2024-11-06 21:39:05 - progress_bar.py[line:274] - INFO: epoch 012:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17373.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3347.1, ups=0.19, wpb=17373.8, bsz=1024, num_updates=4550, lr=4.70017e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28664
2024-11-06 21:39:58 - progress_bar.py[line:274] - INFO: epoch 012:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17749.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3382.2, ups=0.19, wpb=17749.4, bsz=1024, num_updates=4560, lr=4.69881e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=28717
2024-11-06 21:40:51 - progress_bar.py[line:274] - INFO: epoch 012:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17713.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3300.8, ups=0.19, wpb=17713.2, bsz=1024, num_updates=4570, lr=4.69745e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=48, gb_free=13.6, wall=28770
2024-11-06 21:41:43 - progress_bar.py[line:274] - INFO: epoch 012:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17484.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3360, ups=0.19, wpb=17484.7, bsz=1024, num_updates=4580, lr=4.69609e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=28822
2024-11-06 21:42:35 - progress_bar.py[line:274] - INFO: epoch 012:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17708.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3419.8, ups=0.19, wpb=17708.5, bsz=1024, num_updates=4590, lr=4.69473e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=28874
2024-11-06 21:43:27 - progress_bar.py[line:274] - INFO: epoch 012:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18008.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3470.3, ups=0.19, wpb=18008.3, bsz=1024, num_updates=4600, lr=4.69337e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.2, wall=28926
2024-11-06 21:44:19 - progress_bar.py[line:274] - INFO: epoch 012:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=18623.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3582.6, ups=0.19, wpb=18623.4, bsz=1024, num_updates=4610, lr=4.69201e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=39, gb_free=13.4, wall=28978
2024-11-06 21:45:12 - progress_bar.py[line:274] - INFO: epoch 012:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=18040, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3409.9, ups=0.19, wpb=18040, bsz=1024, num_updates=4620, lr=4.69065e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=48, gb_free=13.4, wall=29031
2024-11-06 21:46:05 - progress_bar.py[line:274] - INFO: epoch 012:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=18312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3458.7, ups=0.19, wpb=18312.9, bsz=1024, num_updates=4630, lr=4.68929e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=29084
2024-11-06 21:46:58 - progress_bar.py[line:274] - INFO: epoch 012:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17978.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3421.2, ups=0.19, wpb=17978.5, bsz=1024, num_updates=4640, lr=4.68793e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=29136
2024-11-06 21:47:50 - progress_bar.py[line:274] - INFO: epoch 012:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=18880.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3617.1, ups=0.19, wpb=18880.2, bsz=1024, num_updates=4650, lr=4.68656e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=29189
2024-11-06 21:48:42 - progress_bar.py[line:274] - INFO: epoch 012:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=18306.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3483.8, ups=0.19, wpb=18306.2, bsz=1024, num_updates=4660, lr=4.6852e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=29241
2024-11-06 21:49:35 - progress_bar.py[line:274] - INFO: epoch 012:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=18129.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3458.2, ups=0.19, wpb=18129.6, bsz=1024, num_updates=4670, lr=4.68384e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=29294
2024-11-06 21:50:26 - progress_bar.py[line:274] - INFO: epoch 012:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=18046.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3491.5, ups=0.19, wpb=18046.4, bsz=1024, num_updates=4680, lr=4.68248e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=29345
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-06 21:51:22 - progress_bar.py[line:274] - INFO: epoch 012:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=18230.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3291.8, ups=0.18, wpb=18230.1, bsz=1024, num_updates=4690, lr=4.68112e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=29401
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt2024-11-06 21:51:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4691 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-06 21:51:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 21:53:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-06 21:55:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4691 updates, score 0) (writing took 220.51554317999398 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
2024-11-06 21:55:59 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-06 21:55:59 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.602 | ntokens 17789.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.07 | wps 2767.9 | ups 0.16 | wpb 17789.3 | bsz 1023 | num_updates 4691 | lr 4.68099e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1770 | gb_free 13.4 | wall 29677
2024-11-06 21:55:59 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 21:58:38 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-06 21:58:38 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 21:59:27 - progress_bar.py[line:274] - INFO: epoch 013:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=16762.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=345.4, ups=0.02, wpb=16762.1, bsz=985.6, num_updates=4700, lr=4.67976e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=29, gb_free=13.6, wall=29886
2024-11-06 22:00:19 - progress_bar.py[line:274] - INFO: epoch 013:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17627.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3390.9, ups=0.19, wpb=17627.8, bsz=1024, num_updates=4710, lr=4.6784e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=29938
2024-11-06 22:01:12 - progress_bar.py[line:274] - INFO: epoch 013:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17631.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3359.5, ups=0.19, wpb=17631.1, bsz=1024, num_updates=4720, lr=4.67704e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=29990
2024-11-06 22:02:04 - progress_bar.py[line:274] - INFO: epoch 013:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17890.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3410.2, ups=0.19, wpb=17890.4, bsz=1024, num_updates=4730, lr=4.67568e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=30043
2024-11-06 22:02:56 - progress_bar.py[line:274] - INFO: epoch 013:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17869.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3442.5, ups=0.19, wpb=17869.3, bsz=1024, num_updates=4740, lr=4.67432e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=30095
2024-11-06 22:03:48 - progress_bar.py[line:274] - INFO: epoch 013:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17834.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3434.7, ups=0.19, wpb=17834.3, bsz=1024, num_updates=4750, lr=4.67296e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30147
2024-11-06 22:04:40 - progress_bar.py[line:274] - INFO: epoch 013:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17611.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3406.7, ups=0.19, wpb=17611.5, bsz=1024, num_updates=4760, lr=4.6716e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30198
2024-11-06 22:05:32 - progress_bar.py[line:274] - INFO: epoch 013:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17503.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3323.5, ups=0.19, wpb=17503.1, bsz=1024, num_updates=4770, lr=4.67024e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=30251
2024-11-06 22:06:25 - progress_bar.py[line:274] - INFO: epoch 013:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17538.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3337.7, ups=0.19, wpb=17538.4, bsz=1024, num_updates=4780, lr=4.66888e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30304
2024-11-06 22:07:17 - progress_bar.py[line:274] - INFO: epoch 013:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17648.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3388.1, ups=0.19, wpb=17648.9, bsz=1024, num_updates=4790, lr=4.66752e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30356
2024-11-06 22:08:09 - progress_bar.py[line:274] - INFO: epoch 013:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17403.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3337.8, ups=0.19, wpb=17403.4, bsz=1024, num_updates=4800, lr=4.66616e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=30408
2024-11-06 22:09:01 - progress_bar.py[line:274] - INFO: epoch 013:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17582.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3357.1, ups=0.19, wpb=17582.1, bsz=1024, num_updates=4810, lr=4.6648e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=30460
2024-11-06 22:09:55 - progress_bar.py[line:274] - INFO: epoch 013:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17477.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3241.6, ups=0.19, wpb=17477.6, bsz=1024, num_updates=4820, lr=4.66344e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=40, gb_free=13.5, wall=30514
2024-11-06 22:10:49 - progress_bar.py[line:274] - INFO: epoch 013:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=18064.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3357.1, ups=0.19, wpb=18064.7, bsz=1024, num_updates=4830, lr=4.66208e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=30568
2024-11-06 22:11:44 - progress_bar.py[line:274] - INFO: epoch 013:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17781.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3248.8, ups=0.18, wpb=17781.5, bsz=1024, num_updates=4840, lr=4.66072e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=30623
2024-11-06 22:12:37 - progress_bar.py[line:274] - INFO: epoch 013:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17786.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3322.7, ups=0.19, wpb=17786.3, bsz=1024, num_updates=4850, lr=4.65936e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=30676
2024-11-06 22:13:31 - progress_bar.py[line:274] - INFO: epoch 013:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17698.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3304.3, ups=0.19, wpb=17698.8, bsz=1024, num_updates=4860, lr=4.658e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=30730
2024-11-06 22:14:24 - progress_bar.py[line:274] - INFO: epoch 013:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17337.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3276.4, ups=0.19, wpb=17337.2, bsz=1024, num_updates=4870, lr=4.65664e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=30783
2024-11-06 22:15:16 - progress_bar.py[line:274] - INFO: epoch 013:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=17583.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3358.6, ups=0.19, wpb=17583.3, bsz=1024, num_updates=4880, lr=4.65528e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=30835
2024-11-06 22:16:09 - progress_bar.py[line:274] - INFO: epoch 013:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17646.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3318.3, ups=0.19, wpb=17646.6, bsz=1024, num_updates=4890, lr=4.65392e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=50, gb_free=13.5, wall=30888
2024-11-06 22:17:01 - progress_bar.py[line:274] - INFO: epoch 013:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17933.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3450.3, ups=0.19, wpb=17933.3, bsz=1024, num_updates=4900, lr=4.65255e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=30940
2024-11-06 22:17:53 - progress_bar.py[line:274] - INFO: epoch 013:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=18020.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3462.7, ups=0.19, wpb=18020.9, bsz=1024, num_updates=4910, lr=4.65119e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=45, gb_free=13.5, wall=30992
2024-11-06 22:18:46 - progress_bar.py[line:274] - INFO: epoch 013:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17638.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3385.4, ups=0.19, wpb=17638.6, bsz=1024, num_updates=4920, lr=4.64983e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=31044
2024-11-06 22:19:38 - progress_bar.py[line:274] - INFO: epoch 013:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17440.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3354.5, ups=0.19, wpb=17440.2, bsz=1024, num_updates=4930, lr=4.64847e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=31096
2024-11-06 22:20:30 - progress_bar.py[line:274] - INFO: epoch 013:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3332.1, ups=0.19, wpb=17378.7, bsz=1024, num_updates=4940, lr=4.64711e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.5, wall=31149
2024-11-06 22:21:21 - progress_bar.py[line:274] - INFO: epoch 013:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17687.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3427.2, ups=0.19, wpb=17687.1, bsz=1024, num_updates=4950, lr=4.64575e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.6, wall=31200
2024-11-06 22:22:13 - progress_bar.py[line:274] - INFO: epoch 013:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17911.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3480.8, ups=0.19, wpb=17911.8, bsz=1024, num_updates=4960, lr=4.64439e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=39, gb_free=13.3, wall=31252
2024-11-06 22:23:05 - progress_bar.py[line:274] - INFO: epoch 013:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17922, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3447.3, ups=0.19, wpb=17922, bsz=1024, num_updates=4970, lr=4.64303e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=31304
2024-11-06 22:23:58 - progress_bar.py[line:274] - INFO: epoch 013:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17584.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3312.5, ups=0.19, wpb=17584.8, bsz=1024, num_updates=4980, lr=4.64167e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=31357
2024-11-06 22:24:51 - progress_bar.py[line:274] - INFO: epoch 013:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17508, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3308, ups=0.19, wpb=17508, bsz=1024, num_updates=4990, lr=4.64031e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=31410
2024-11-06 22:25:44 - progress_bar.py[line:274] - INFO: epoch 013:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=18523, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3498.2, ups=0.19, wpb=18523, bsz=1024, num_updates=5000, lr=4.63895e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=31463
loss_reg: 0.01371661686701624 loss_cls: 0.0031999179627746344
loss_reg: 0.01546810929731631 loss_cls: 0.004155462142080069
loss_reg: 0.020677162917150323 loss_cls: 0.003050205297768116
loss_reg: 0.009692380419354309 loss_cls: 0.0036115599796175957
loss_reg: 0.011814246689947393 loss_cls: 0.0035622422583401203
loss_reg: 0.012816680010544427 loss_cls: 0.0035774887073785067
loss_reg: 0.012699140482210398 loss_cls: 0.003415712621062994
loss_reg: 0.012842890728452957 loss_cls: 0.003977042157202959
loss_reg: 0.0182060165197422 loss_cls: 0.0025799269787967205
loss_reg: 0.0149602597222693 loss_cls: 0.0031678760424256325
loss_reg: 0.02265295157481819 loss_cls: 0.004339650273323059
loss_reg: 0.016193055329361168 loss_cls: 0.003202456282451749
loss_reg: 0.02425943885639123 loss_cls: 0.004520528484135866
loss_reg: 0.014691715793301764 loss_cls: 0.002744094468653202
loss_reg: 0.014839134290115403 loss_cls: 0.004534281324595213
loss_reg: 0.014397479441294823 loss_cls: 0.0039008944295346737
loss_reg: 0.024003220302664524 loss_cls: 0.004171252250671387
loss_reg: 0.016202961998968472 loss_cls: 0.003729133866727352
loss_reg: 0.016514621988894782 loss_cls: 0.0038731195963919163
loss_reg: 0.012425913383087201 loss_cls: 0.003739406121894717
loss_reg: 0.01913431730954543 loss_cls: 0.00446197297424078
loss_reg: 0.012278234403096045 loss_cls: 0.003851885674521327
loss_reg: 0.017069840575418327 loss_cls: 0.0038591863121837378
loss_reg: 0.014867098275800513 loss_cls: 0.00444171205163002
loss_reg: 0.018319569260746495 loss_cls: 0.0037218001671135426
loss_reg: 0.01390489326559432 loss_cls: 0.00301563274115324
loss_reg: 0.014288889372070637 loss_cls: 0.0037061315961182117
loss_reg: 0.00941902919552759 loss_cls: 0.0029771558474749327
loss_reg: 0.01560203965808278 loss_cls: 0.003866473911330104
loss_reg: 0.01811548980177785 loss_cls: 0.004769590683281422
loss_reg: 0.01814551325208829 loss_cls: 0.00421040877699852
loss_reg: 0.01337034987423303 loss_cls: 0.004224575124680996
loss_reg: 0.015303118928802463 loss_cls: 0.005169191397726536
loss_reg: 0.015984099075731548 loss_cls: 0.003952597733587027
loss_reg: 0.016464827773476846 loss_cls: 0.003819927340373397
loss_reg: 0.01766032845952449 loss_cls: 0.004267076961696148
loss_reg: 0.01794988277137548 loss_cls: 0.0029481658712029457
loss_reg: 0.014030041303698854 loss_cls: 0.003557977033779025
loss_reg: 0.00883847879334395 loss_cls: 0.002649585483595729
loss_reg: 0.020115630722730454 loss_cls: 0.0027355721686035395
loss_reg: 0.011637083879534866 loss_cls: 0.0030943697784096003
loss_reg: 0.019710911406632173 loss_cls: 0.004125168547034264
loss_reg: 0.018772240230705284 loss_cls: 0.0032720433082431555
loss_reg: 0.016644670502957964 loss_cls: 0.0029676370322704315
loss_reg: 0.023679372410256652 loss_cls: 0.003705955110490322
loss_reg: 0.025670070675991506 loss_cls: 0.00211633974686265
loss_reg: 0.012875137965582806 loss_cls: 0.00318109430372715
loss_reg: 0.01486882100166004 loss_cls: 0.0033472126815468073
loss_reg: 0.008406330430459014 loss_cls: 0.003070804290473461
loss_reg: 0.012394431657941619 loss_cls: 0.003620947478339076
loss_reg: 0.01598960518499753 loss_cls: 0.0028950769919902086
loss_reg: 0.01821989213492124 loss_cls: 0.0037469964008778334
loss_reg: 0.015139598003539412 loss_cls: 0.0037321513518691063
loss_reg: 0.013331770637969111 loss_cls: 0.0030536146368831396
loss_reg: 0.017013799969210843 loss_cls: 0.0037234555929899216
loss_reg: 0.020058742467869765 loss_cls: 0.0038905469700694084
loss_reg: 0.022646155970886428 loss_cls: 0.0035183350555598736
loss_reg: 0.02724376864553613 loss_cls: 0.003199436003342271
loss_reg: 0.02045431692524385 loss_cls: 0.004243470262736082
loss_reg: 0.012087560845532155 loss_cls: 0.003464183770120144
loss_reg: 0.015068138371516182 loss_cls: 0.0034942361526191235
loss_reg: 0.017364603166321615 loss_cls: 0.0033361439127475023
loss_reg: 0.02212407362240475 loss_cls: 0.002972640795633197
loss_reg: 0.0157434702954352 loss_cls: 0.0034931327681988478
2024-11-06 22:26:37 - progress_bar.py[line:274] - INFO: epoch 013:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18160.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3390.7, ups=0.19, wpb=18160.5, bsz=1024, num_updates=5010, lr=4.63759e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=31516
2024-11-06 22:27:29 - progress_bar.py[line:274] - INFO: epoch 013:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18232, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3493, ups=0.19, wpb=18232, bsz=1024, num_updates=5020, lr=4.63623e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=31568
2024-11-06 22:28:22 - progress_bar.py[line:274] - INFO: epoch 013:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=18118.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3439.3, ups=0.19, wpb=18118.4, bsz=1024, num_updates=5030, lr=4.63487e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=31621
2024-11-06 22:29:14 - progress_bar.py[line:274] - INFO: epoch 013:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=18506.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3539, ups=0.19, wpb=18506.3, bsz=1024, num_updates=5040, lr=4.63351e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=31673
2024-11-06 22:30:06 - progress_bar.py[line:274] - INFO: epoch 013:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=18133.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3525.4, ups=0.19, wpb=18133.1, bsz=1024, num_updates=5050, lr=4.63215e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=31725
2024-11-06 22:30:58 - progress_bar.py[line:274] - INFO: epoch 013:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17843.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3426.8, ups=0.19, wpb=17843.6, bsz=1024, num_updates=5060, lr=4.63079e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=31777
2024-11-06 22:31:49 - progress_bar.py[line:274] - INFO: epoch 013:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=18273.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3554.5, ups=0.19, wpb=18273.6, bsz=1024, num_updates=5070, lr=4.62943e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=31828
2024-11-06 22:32:41 - progress_bar.py[line:274] - INFO: epoch 013:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=18208.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3513.6, ups=0.19, wpb=18208.6, bsz=1024, num_updates=5080, lr=4.62807e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=31880
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

2024-11-06 22:32:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 5082 updates
2024-11-06 22:32:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 22:34:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-06 22:36:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 5082 updates, score 0) (writing took 220.6883977020043 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-06 22:37:23 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-06 22:37:23 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.586 | ntokens 17777.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6 | wps 2797.3 | ups 0.16 | wpb 17777.3 | bsz 1023 | num_updates 5082 | lr 4.6278e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1666 | gb_free 13.3 | wall 32162
2024-11-06 22:37:23 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 22:40:02 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-06 22:40:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 22:40:46 - progress_bar.py[line:274] - INFO: epoch 014:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=16881.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=347.9, ups=0.02, wpb=16881.7, bsz=985.6, num_updates=5090, lr=4.62671e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=32365
2024-11-06 22:41:38 - progress_bar.py[line:274] - INFO: epoch 014:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17891.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3464.1, ups=0.19, wpb=17891.7, bsz=1024, num_updates=5100, lr=4.62535e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32417
2024-11-06 22:42:30 - progress_bar.py[line:274] - INFO: epoch 014:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17637.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3400.9, ups=0.19, wpb=17637.7, bsz=1024, num_updates=5110, lr=4.62399e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32469
2024-11-06 22:43:22 - progress_bar.py[line:274] - INFO: epoch 014:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17771.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3396.7, ups=0.19, wpb=17771.1, bsz=1024, num_updates=5120, lr=4.62263e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32521
2024-11-06 22:44:14 - progress_bar.py[line:274] - INFO: epoch 014:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17644.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3397.2, ups=0.19, wpb=17644.5, bsz=1024, num_updates=5130, lr=4.62127e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=32573
2024-11-06 22:45:06 - progress_bar.py[line:274] - INFO: epoch 014:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17894.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3447.7, ups=0.19, wpb=17894.5, bsz=1024, num_updates=5140, lr=4.61991e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32625
2024-11-06 22:45:58 - progress_bar.py[line:274] - INFO: epoch 014:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17797.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3393.4, ups=0.19, wpb=17797.9, bsz=1024, num_updates=5150, lr=4.61854e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32677
2024-11-06 22:46:51 - progress_bar.py[line:274] - INFO: epoch 014:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17727.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3382.9, ups=0.19, wpb=17727.2, bsz=1024, num_updates=5160, lr=4.61718e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=32730
2024-11-06 22:47:44 - progress_bar.py[line:274] - INFO: epoch 014:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17433.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3273.6, ups=0.19, wpb=17433.2, bsz=1024, num_updates=5170, lr=4.61582e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=32783
2024-11-06 22:48:39 - progress_bar.py[line:274] - INFO: epoch 014:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17823.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3219.3, ups=0.18, wpb=17823.7, bsz=1024, num_updates=5180, lr=4.61446e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=32838
2024-11-06 22:49:36 - progress_bar.py[line:274] - INFO: epoch 014:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17535.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3128.4, ups=0.18, wpb=17535.8, bsz=1024, num_updates=5190, lr=4.6131e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=32894
2024-11-06 22:50:31 - progress_bar.py[line:274] - INFO: epoch 014:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17782.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3223.9, ups=0.18, wpb=17782.3, bsz=1024, num_updates=5200, lr=4.61174e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=32950
2024-11-06 22:51:26 - progress_bar.py[line:274] - INFO: epoch 014:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17358, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3123.9, ups=0.18, wpb=17358, bsz=1024, num_updates=5210, lr=4.61038e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=33005
2024-11-06 22:52:21 - progress_bar.py[line:274] - INFO: epoch 014:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17799.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3224.3, ups=0.18, wpb=17799.4, bsz=1024, num_updates=5220, lr=4.60902e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=33060
2024-11-06 22:53:18 - progress_bar.py[line:274] - INFO: epoch 014:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17639.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3134.1, ups=0.18, wpb=17639.9, bsz=1024, num_updates=5230, lr=4.60766e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=33117
2024-11-06 22:54:14 - progress_bar.py[line:274] - INFO: epoch 014:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17806.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3182.8, ups=0.18, wpb=17806.9, bsz=1024, num_updates=5240, lr=4.6063e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=33173
2024-11-06 22:55:10 - progress_bar.py[line:274] - INFO: epoch 014:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17874.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3202.3, ups=0.18, wpb=17874.2, bsz=1024, num_updates=5250, lr=4.60494e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=33228
2024-11-06 22:56:06 - progress_bar.py[line:274] - INFO: epoch 014:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17524.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3125.1, ups=0.18, wpb=17524.6, bsz=1024, num_updates=5260, lr=4.60358e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=33284
2024-11-06 22:56:28 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-06 22:57:07 - progress_bar.py[line:274] - INFO: epoch 014:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=2880, ups=0.16, wpb=17660.5, bsz=1024, num_updates=5270, lr=4.60222e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=61, gb_free=13.5, wall=33346
2024-11-06 22:58:00 - progress_bar.py[line:274] - INFO: epoch 014:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17692.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3341.4, ups=0.19, wpb=17692.3, bsz=1024, num_updates=5280, lr=4.60086e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=33399
2024-11-06 22:58:52 - progress_bar.py[line:274] - INFO: epoch 014:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18134.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3447.4, ups=0.19, wpb=18134.5, bsz=1024, num_updates=5290, lr=4.5995e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33451
2024-11-06 22:59:45 - progress_bar.py[line:274] - INFO: epoch 014:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17906.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3421.8, ups=0.19, wpb=17906.9, bsz=1024, num_updates=5300, lr=4.59814e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33504
2024-11-06 23:00:38 - progress_bar.py[line:274] - INFO: epoch 014:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17631.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3335.5, ups=0.19, wpb=17631.3, bsz=1024, num_updates=5310, lr=4.59678e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33557
2024-11-06 23:01:30 - progress_bar.py[line:274] - INFO: epoch 014:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17507.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3313.6, ups=0.19, wpb=17507.4, bsz=1024, num_updates=5320, lr=4.59542e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33609
2024-11-06 23:02:23 - progress_bar.py[line:274] - INFO: epoch 014:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17680.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3369.5, ups=0.19, wpb=17680.6, bsz=1024, num_updates=5330, lr=4.59406e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33662
2024-11-06 23:03:15 - progress_bar.py[line:274] - INFO: epoch 014:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17605.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3401.4, ups=0.19, wpb=17605.6, bsz=1024, num_updates=5340, lr=4.5927e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=33714
2024-11-06 23:04:07 - progress_bar.py[line:274] - INFO: epoch 014:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=18079.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3444.3, ups=0.19, wpb=18079.7, bsz=1024, num_updates=5350, lr=4.59134e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=33766
2024-11-06 23:05:01 - progress_bar.py[line:274] - INFO: epoch 014:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17696.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3298.2, ups=0.19, wpb=17696.4, bsz=1024, num_updates=5360, lr=4.58998e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=33820
2024-11-06 23:05:57 - progress_bar.py[line:274] - INFO: epoch 014:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17741.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3182.9, ups=0.18, wpb=17741.1, bsz=1024, num_updates=5370, lr=4.58862e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=33875
2024-11-06 23:06:50 - progress_bar.py[line:274] - INFO: epoch 014:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17807.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3345.3, ups=0.19, wpb=17807.3, bsz=1024, num_updates=5380, lr=4.58726e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33929
2024-11-06 23:07:43 - progress_bar.py[line:274] - INFO: epoch 014:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=18286, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3449.3, ups=0.19, wpb=18286, bsz=1024, num_updates=5390, lr=4.5859e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=33982
2024-11-06 23:08:36 - progress_bar.py[line:274] - INFO: epoch 014:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=18027.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3397.9, ups=0.19, wpb=18027.4, bsz=1024, num_updates=5400, lr=4.58454e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=34035
2024-11-06 23:09:30 - progress_bar.py[line:274] - INFO: epoch 014:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17945.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3320.7, ups=0.19, wpb=17945.9, bsz=1024, num_updates=5410, lr=4.58317e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34089
2024-11-06 23:10:24 - progress_bar.py[line:274] - INFO: epoch 014:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18111.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3373, ups=0.19, wpb=18111.7, bsz=1024, num_updates=5420, lr=4.58181e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34143
2024-11-06 23:11:17 - progress_bar.py[line:274] - INFO: epoch 014:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=18439.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3425.8, ups=0.19, wpb=18439.7, bsz=1024, num_updates=5430, lr=4.58045e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=34196
2024-11-06 23:12:11 - progress_bar.py[line:274] - INFO: epoch 014:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18353.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3412.9, ups=0.19, wpb=18353.3, bsz=1024, num_updates=5440, lr=4.57909e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=34250
2024-11-06 23:13:05 - progress_bar.py[line:274] - INFO: epoch 014:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=18123.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3374.1, ups=0.19, wpb=18123.2, bsz=1024, num_updates=5450, lr=4.57773e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=34304
2024-11-06 23:13:58 - progress_bar.py[line:274] - INFO: epoch 014:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=18086.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3425, ups=0.19, wpb=18086.3, bsz=1024, num_updates=5460, lr=4.57637e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=34357
2024-11-06 23:14:50 - progress_bar.py[line:274] - INFO: epoch 014:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3381.8, ups=0.19, wpb=17540.6, bsz=1024, num_updates=5470, lr=4.57501e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=34409
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-06 23:14:57 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5472 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

2024-11-06 23:14:57 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists: File exists: File exists
: File exists
: File exists
: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 23:16:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-06 23:18:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5472 updates, score 0) (writing took 211.57376466400456 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-06 23:19:23 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-06 23:19:23 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.578 | ntokens 17790.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.97 | wps 2754.1 | ups 0.15 | wpb 17790.2 | bsz 1023 | num_updates 5472 | lr 4.57474e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1882 | gb_free 13.3 | wall 34682
2024-11-06 23:19:23 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 23:22:06 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-06 23:22:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 23:22:50 - progress_bar.py[line:274] - INFO: epoch 015:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=16888.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=351.4, ups=0.02, wpb=16888.4, bsz=985.6, num_updates=5480, lr=4.57365e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=34889
2024-11-06 23:23:43 - progress_bar.py[line:274] - INFO: epoch 015:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17788, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3357.1, ups=0.19, wpb=17788, bsz=1024, num_updates=5490, lr=4.57229e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=34942
2024-11-06 23:24:36 - progress_bar.py[line:274] - INFO: epoch 015:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17398.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3297.7, ups=0.19, wpb=17398.6, bsz=1024, num_updates=5500, lr=4.57093e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=34995
2024-11-06 23:25:28 - progress_bar.py[line:274] - INFO: epoch 015:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17952.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3449.7, ups=0.19, wpb=17952.9, bsz=1024, num_updates=5510, lr=4.56957e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35047
2024-11-06 23:26:20 - progress_bar.py[line:274] - INFO: epoch 015:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17658.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3396.4, ups=0.19, wpb=17658.1, bsz=1024, num_updates=5520, lr=4.56821e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35099
2024-11-06 23:27:12 - progress_bar.py[line:274] - INFO: epoch 015:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17716.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3409, ups=0.19, wpb=17716.8, bsz=1024, num_updates=5530, lr=4.56685e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35151
2024-11-06 23:28:05 - progress_bar.py[line:274] - INFO: epoch 015:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17849.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3391.8, ups=0.19, wpb=17849.3, bsz=1024, num_updates=5540, lr=4.56549e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=35203
2024-11-06 23:28:57 - progress_bar.py[line:274] - INFO: epoch 015:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17716.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3371.1, ups=0.19, wpb=17716.6, bsz=1024, num_updates=5550, lr=4.56413e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35256
2024-11-06 23:29:49 - progress_bar.py[line:274] - INFO: epoch 015:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17641.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3393.7, ups=0.19, wpb=17641.6, bsz=1024, num_updates=5560, lr=4.56277e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35308
2024-11-06 23:30:41 - progress_bar.py[line:274] - INFO: epoch 015:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17892.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3452.6, ups=0.19, wpb=17892.3, bsz=1024, num_updates=5570, lr=4.56141e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35360
2024-11-06 23:31:33 - progress_bar.py[line:274] - INFO: epoch 015:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17209.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3296.3, ups=0.19, wpb=17209.8, bsz=1024, num_updates=5580, lr=4.56005e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=35412
2024-11-06 23:32:26 - progress_bar.py[line:274] - INFO: epoch 015:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17748.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3377.3, ups=0.19, wpb=17748.6, bsz=1024, num_updates=5590, lr=4.55869e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=35465
2024-11-06 23:33:18 - progress_bar.py[line:274] - INFO: epoch 015:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17337.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3332.9, ups=0.19, wpb=17337.9, bsz=1024, num_updates=5600, lr=4.55733e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=35517
2024-11-06 23:34:10 - progress_bar.py[line:274] - INFO: epoch 015:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17750.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3400, ups=0.19, wpb=17750.4, bsz=1024, num_updates=5610, lr=4.55597e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=35569
2024-11-06 23:35:03 - progress_bar.py[line:274] - INFO: epoch 015:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17636.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3311, ups=0.19, wpb=17636.3, bsz=1024, num_updates=5620, lr=4.55461e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=35622
2024-11-06 23:35:57 - progress_bar.py[line:274] - INFO: epoch 015:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17748.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3298.8, ups=0.19, wpb=17748.3, bsz=1024, num_updates=5630, lr=4.55325e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=37, gb_free=13.5, wall=35676
2024-11-06 23:36:51 - progress_bar.py[line:274] - INFO: epoch 015:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=18143.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3380.4, ups=0.19, wpb=18143.1, bsz=1024, num_updates=5640, lr=4.55189e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=35730
2024-11-06 23:37:44 - progress_bar.py[line:274] - INFO: epoch 015:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17474.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3270.4, ups=0.19, wpb=17474.8, bsz=1024, num_updates=5650, lr=4.55053e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=13.6, wall=35783
2024-11-06 23:38:38 - progress_bar.py[line:274] - INFO: epoch 015:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17724.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3285, ups=0.19, wpb=17724.8, bsz=1024, num_updates=5660, lr=4.54916e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=35837
2024-11-06 23:39:31 - progress_bar.py[line:274] - INFO: epoch 015:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17671.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3319.9, ups=0.19, wpb=17671.2, bsz=1024, num_updates=5670, lr=4.5478e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=35890
2024-11-06 23:40:24 - progress_bar.py[line:274] - INFO: epoch 015:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=18129.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3469.8, ups=0.19, wpb=18129.3, bsz=1024, num_updates=5680, lr=4.54644e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=35942
2024-11-06 23:41:16 - progress_bar.py[line:274] - INFO: epoch 015:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17835.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3409.1, ups=0.19, wpb=17835.3, bsz=1024, num_updates=5690, lr=4.54508e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.6, wall=35995
2024-11-06 23:42:08 - progress_bar.py[line:274] - INFO: epoch 015:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17940.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3436.3, ups=0.19, wpb=17940.6, bsz=1024, num_updates=5700, lr=4.54372e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=36047
2024-11-06 23:42:59 - progress_bar.py[line:274] - INFO: epoch 015:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17362.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3409.9, ups=0.2, wpb=17362.1, bsz=1024, num_updates=5710, lr=4.54236e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.5, wall=36098
2024-11-06 23:43:51 - progress_bar.py[line:274] - INFO: epoch 015:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17673.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3398.4, ups=0.19, wpb=17673.1, bsz=1024, num_updates=5720, lr=4.541e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=36150
2024-11-06 23:44:43 - progress_bar.py[line:274] - INFO: epoch 015:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17425.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3326.5, ups=0.19, wpb=17425.4, bsz=1024, num_updates=5730, lr=4.53964e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=47, gb_free=13.5, wall=36202
2024-11-06 23:45:35 - progress_bar.py[line:274] - INFO: epoch 015:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18134.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3487.3, ups=0.19, wpb=18134.9, bsz=1024, num_updates=5740, lr=4.53828e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=48, gb_free=13.5, wall=36254
2024-11-06 23:46:28 - progress_bar.py[line:274] - INFO: epoch 015:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17620.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3373.5, ups=0.19, wpb=17620.5, bsz=1024, num_updates=5750, lr=4.53692e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=42, gb_free=13.4, wall=36306
2024-11-06 23:47:20 - progress_bar.py[line:274] - INFO: epoch 015:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17771.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3413.4, ups=0.19, wpb=17771.4, bsz=1024, num_updates=5760, lr=4.53556e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=39, gb_free=13.6, wall=36359
2024-11-06 23:48:12 - progress_bar.py[line:274] - INFO: epoch 015:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17657.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3377.9, ups=0.19, wpb=17657.5, bsz=1024, num_updates=5770, lr=4.5342e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=36411
2024-11-06 23:49:04 - progress_bar.py[line:274] - INFO: epoch 015:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=18611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3607.9, ups=0.19, wpb=18611.1, bsz=1024, num_updates=5780, lr=4.53284e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=44, gb_free=13.2, wall=36462
2024-11-06 23:49:55 - progress_bar.py[line:274] - INFO: epoch 015:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=18197.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3513.9, ups=0.19, wpb=18197.7, bsz=1024, num_updates=5790, lr=4.53148e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=44, gb_free=13.3, wall=36514
2024-11-06 23:50:49 - progress_bar.py[line:274] - INFO: epoch 015:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=18193.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3372.4, ups=0.19, wpb=18193.1, bsz=1024, num_updates=5800, lr=4.53012e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=36568
2024-11-06 23:51:43 - progress_bar.py[line:274] - INFO: epoch 015:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=18373.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3395.1, ups=0.18, wpb=18373.1, bsz=1024, num_updates=5810, lr=4.52876e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36622
2024-11-06 23:52:37 - progress_bar.py[line:274] - INFO: epoch 015:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=18694.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3466.6, ups=0.19, wpb=18694.8, bsz=1024, num_updates=5820, lr=4.5274e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=36676
2024-11-06 23:53:31 - progress_bar.py[line:274] - INFO: epoch 015:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18297.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3380.5, ups=0.18, wpb=18297.4, bsz=1024, num_updates=5830, lr=4.52604e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=36730
2024-11-06 23:54:25 - progress_bar.py[line:274] - INFO: epoch 015:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=18049.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3357, ups=0.19, wpb=18049.9, bsz=1024, num_updates=5840, lr=4.52468e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36784
2024-11-06 23:55:19 - progress_bar.py[line:274] - INFO: epoch 015:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18343.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3398, ups=0.19, wpb=18343.5, bsz=1024, num_updates=5850, lr=4.52332e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=36838
2024-11-06 23:56:11 - progress_bar.py[line:274] - INFO: epoch 015:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17862.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3463.2, ups=0.19, wpb=17862.8, bsz=1024, num_updates=5860, lr=4.52196e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=36890
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

2024-11-06 23:56:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5863 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-06 23:56:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 23:58:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 00:00:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5863 updates, score 0) (writing took 222.57859106099932 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000slice_id 4 seek offset 200000

2024-11-07 00:01:00 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-07 00:01:00 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.576 | ntokens 17824.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.96 | wps 2790.5 | ups 0.16 | wpb 17824.1 | bsz 1023 | num_updates 5863 | lr 4.52155e-05 | gnorm 0.009 | clip 0 | loss_scale 32768 | train_wall 1632 | gb_free 13.3 | wall 37179
2024-11-07 00:01:00 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 00:03:40 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-07 00:03:40 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 00:04:18 - progress_bar.py[line:274] - INFO: epoch 016:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=16874.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=346, ups=0.02, wpb=16874.7, bsz=985.6, num_updates=5870, lr=4.5206e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=37377
2024-11-07 00:05:11 - progress_bar.py[line:274] - INFO: epoch 016:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17724.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3389.5, ups=0.19, wpb=17724.1, bsz=1024, num_updates=5880, lr=4.51924e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=37430
2024-11-07 00:06:03 - progress_bar.py[line:274] - INFO: epoch 016:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17606.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3336.8, ups=0.19, wpb=17606.8, bsz=1024, num_updates=5890, lr=4.51788e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37482
2024-11-07 00:06:56 - progress_bar.py[line:274] - INFO: epoch 016:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18099.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3456.6, ups=0.19, wpb=18099.8, bsz=1024, num_updates=5900, lr=4.51652e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37535
2024-11-07 00:07:48 - progress_bar.py[line:274] - INFO: epoch 016:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17565.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3401.5, ups=0.19, wpb=17565.9, bsz=1024, num_updates=5910, lr=4.51515e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37586
2024-11-07 00:08:40 - progress_bar.py[line:274] - INFO: epoch 016:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17510.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3330.1, ups=0.19, wpb=17510.9, bsz=1024, num_updates=5920, lr=4.51379e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37639
2024-11-07 00:09:33 - progress_bar.py[line:274] - INFO: epoch 016:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17756.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3341.9, ups=0.19, wpb=17756.7, bsz=1024, num_updates=5930, lr=4.51243e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37692
2024-11-07 00:10:25 - progress_bar.py[line:274] - INFO: epoch 016:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17649.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3392.1, ups=0.19, wpb=17649.9, bsz=1024, num_updates=5940, lr=4.51107e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37744
2024-11-07 00:11:17 - progress_bar.py[line:274] - INFO: epoch 016:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17583.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3400.2, ups=0.19, wpb=17583.4, bsz=1024, num_updates=5950, lr=4.50971e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=37796
2024-11-07 00:12:10 - progress_bar.py[line:274] - INFO: epoch 016:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17481.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3317, ups=0.19, wpb=17481.7, bsz=1024, num_updates=5960, lr=4.50835e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37849
2024-11-07 00:13:02 - progress_bar.py[line:274] - INFO: epoch 016:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17497.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3347.4, ups=0.19, wpb=17497.8, bsz=1024, num_updates=5970, lr=4.50699e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=37901
2024-11-07 00:13:55 - progress_bar.py[line:274] - INFO: epoch 016:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17805.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3384.1, ups=0.19, wpb=17805.2, bsz=1024, num_updates=5980, lr=4.50563e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=37953
2024-11-07 00:14:47 - progress_bar.py[line:274] - INFO: epoch 016:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17482.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3350.8, ups=0.19, wpb=17482.3, bsz=1024, num_updates=5990, lr=4.50427e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38006
2024-11-07 00:15:39 - progress_bar.py[line:274] - INFO: epoch 016:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17593.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3340, ups=0.19, wpb=17593.5, bsz=1024, num_updates=6000, lr=4.50291e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=38058
2024-11-07 00:16:32 - progress_bar.py[line:274] - INFO: epoch 016:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17763.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3375, ups=0.19, wpb=17763.6, bsz=1024, num_updates=6010, lr=4.50155e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38111
2024-11-07 00:17:24 - progress_bar.py[line:274] - INFO: epoch 016:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17809.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3418.1, ups=0.19, wpb=17809.5, bsz=1024, num_updates=6020, lr=4.50019e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=38163
2024-11-07 00:18:18 - progress_bar.py[line:274] - INFO: epoch 016:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=18219.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3361.7, ups=0.18, wpb=18219.5, bsz=1024, num_updates=6030, lr=4.49883e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=38217
2024-11-07 00:19:10 - progress_bar.py[line:274] - INFO: epoch 016:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17357.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3338.4, ups=0.19, wpb=17357.7, bsz=1024, num_updates=6040, lr=4.49747e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38269
2024-11-07 00:20:03 - progress_bar.py[line:274] - INFO: epoch 016:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17900.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3398.2, ups=0.19, wpb=17900.6, bsz=1024, num_updates=6050, lr=4.49611e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38322
2024-11-07 00:20:55 - progress_bar.py[line:274] - INFO: epoch 016:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17719.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3399.9, ups=0.19, wpb=17719.7, bsz=1024, num_updates=6060, lr=4.49475e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38374
2024-11-07 00:21:48 - progress_bar.py[line:274] - INFO: epoch 016:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17867.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3384.6, ups=0.19, wpb=17867.5, bsz=1024, num_updates=6070, lr=4.49339e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38427
2024-11-07 00:22:40 - progress_bar.py[line:274] - INFO: epoch 016:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=18008.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3454.4, ups=0.19, wpb=18008.3, bsz=1024, num_updates=6080, lr=4.49203e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=38479
2024-11-07 00:23:33 - progress_bar.py[line:274] - INFO: epoch 016:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17647.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3349.3, ups=0.19, wpb=17647.5, bsz=1024, num_updates=6090, lr=4.49067e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38532
2024-11-07 00:24:26 - progress_bar.py[line:274] - INFO: epoch 016:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17179.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3240.9, ups=0.19, wpb=17179.2, bsz=1024, num_updates=6100, lr=4.48931e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=38585
2024-11-07 00:25:18 - progress_bar.py[line:274] - INFO: epoch 016:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3393.5, ups=0.19, wpb=17611.1, bsz=1024, num_updates=6110, lr=4.48795e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38637
2024-11-07 00:26:10 - progress_bar.py[line:274] - INFO: epoch 016:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17585.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3352, ups=0.19, wpb=17585.6, bsz=1024, num_updates=6120, lr=4.48659e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38689
2024-11-07 00:27:02 - progress_bar.py[line:274] - INFO: epoch 016:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=18103.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3468.6, ups=0.19, wpb=18103.3, bsz=1024, num_updates=6130, lr=4.48523e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38741
2024-11-07 00:27:54 - progress_bar.py[line:274] - INFO: epoch 016:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17710.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3395.4, ups=0.19, wpb=17710.9, bsz=1024, num_updates=6140, lr=4.48387e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38793
2024-11-07 00:28:48 - progress_bar.py[line:274] - INFO: epoch 016:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17454.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3290.1, ups=0.19, wpb=17454.1, bsz=1024, num_updates=6150, lr=4.48251e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38846
2024-11-07 00:29:40 - progress_bar.py[line:274] - INFO: epoch 016:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17716.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3403.4, ups=0.19, wpb=17716.7, bsz=1024, num_updates=6160, lr=4.48114e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=38898
2024-11-07 00:30:32 - progress_bar.py[line:274] - INFO: epoch 016:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=18525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3557, ups=0.19, wpb=18525.8, bsz=1024, num_updates=6170, lr=4.47978e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=38951
2024-11-07 00:31:23 - progress_bar.py[line:274] - INFO: epoch 016:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18116.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3495.6, ups=0.19, wpb=18116.6, bsz=1024, num_updates=6180, lr=4.47842e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=39002
2024-11-07 00:32:15 - progress_bar.py[line:274] - INFO: epoch 016:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17904.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3445.7, ups=0.19, wpb=17904.2, bsz=1024, num_updates=6190, lr=4.47706e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=39054
2024-11-07 00:33:08 - progress_bar.py[line:274] - INFO: epoch 016:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=18129.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3473.1, ups=0.19, wpb=18129.8, bsz=1024, num_updates=6200, lr=4.4757e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=39107
2024-11-07 00:34:02 - progress_bar.py[line:274] - INFO: epoch 016:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=18613.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3405.1, ups=0.18, wpb=18613.2, bsz=1024, num_updates=6210, lr=4.47434e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=39161
2024-11-07 00:34:57 - progress_bar.py[line:274] - INFO: epoch 016:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=18229.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3307.9, ups=0.18, wpb=18229.4, bsz=1024, num_updates=6220, lr=4.47298e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=39216
2024-11-07 00:35:53 - progress_bar.py[line:274] - INFO: epoch 016:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=18483.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3349.8, ups=0.18, wpb=18483.7, bsz=1024, num_updates=6230, lr=4.47162e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=39271
2024-11-07 00:36:48 - progress_bar.py[line:274] - INFO: epoch 016:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17855.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3223.9, ups=0.18, wpb=17855.2, bsz=1024, num_updates=6240, lr=4.47026e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=39327
2024-11-07 00:37:44 - progress_bar.py[line:274] - INFO: epoch 016:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3236.8, ups=0.18, wpb=18040.3, bsz=1024, num_updates=6250, lr=4.4689e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=39383
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 00:38:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 6254 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 00:38:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 00:39:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-07 00:41:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 6254 updates, score 0) (writing took 222.36170212901197 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 00:42:38 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-07 00:42:38 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.563 | ntokens 17786.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.91 | wps 2783.8 | ups 0.16 | wpb 17786.6 | bsz 1023 | num_updates 6254 | lr 4.46836e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1309 | gb_free 13.4 | wall 39677
2024-11-07 00:42:38 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 00:45:18 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-07 00:45:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 00:45:51 - progress_bar.py[line:274] - INFO: epoch 017:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=16807, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=344.8, ups=0.02, wpb=16807, bsz=985.6, num_updates=6260, lr=4.46754e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=39870
2024-11-07 00:46:44 - progress_bar.py[line:274] - INFO: epoch 017:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17664.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3342.7, ups=0.19, wpb=17664.7, bsz=1024, num_updates=6270, lr=4.46618e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=39923
2024-11-07 00:47:37 - progress_bar.py[line:274] - INFO: epoch 017:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17441.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3312.9, ups=0.19, wpb=17441.1, bsz=1024, num_updates=6280, lr=4.46482e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=39975
2024-11-07 00:48:29 - progress_bar.py[line:274] - INFO: epoch 017:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17889.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3409.5, ups=0.19, wpb=17889.3, bsz=1024, num_updates=6290, lr=4.46346e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40028
2024-11-07 00:49:21 - progress_bar.py[line:274] - INFO: epoch 017:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17516, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3369.5, ups=0.19, wpb=17516, bsz=1024, num_updates=6300, lr=4.4621e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40080
2024-11-07 00:50:14 - progress_bar.py[line:274] - INFO: epoch 017:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17646.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3362.6, ups=0.19, wpb=17646.8, bsz=1024, num_updates=6310, lr=4.46074e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=40132
2024-11-07 00:51:06 - progress_bar.py[line:274] - INFO: epoch 017:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17989.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3456.5, ups=0.19, wpb=17989.1, bsz=1024, num_updates=6320, lr=4.45938e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=40184
2024-11-07 00:51:57 - progress_bar.py[line:274] - INFO: epoch 017:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17409.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3365.1, ups=0.19, wpb=17409.8, bsz=1024, num_updates=6330, lr=4.45802e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40236
2024-11-07 00:52:49 - progress_bar.py[line:274] - INFO: epoch 017:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17724.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3402.3, ups=0.19, wpb=17724.2, bsz=1024, num_updates=6340, lr=4.45666e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=40288
2024-11-07 00:53:42 - progress_bar.py[line:274] - INFO: epoch 017:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17665.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3355.9, ups=0.19, wpb=17665.6, bsz=1024, num_updates=6350, lr=4.4553e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40341
2024-11-07 00:54:34 - progress_bar.py[line:274] - INFO: epoch 017:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17642.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3387.4, ups=0.19, wpb=17642.3, bsz=1024, num_updates=6360, lr=4.45394e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=40393
2024-11-07 00:55:26 - progress_bar.py[line:274] - INFO: epoch 017:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17817.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3423.6, ups=0.19, wpb=17817.6, bsz=1024, num_updates=6370, lr=4.45258e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=40445
2024-11-07 00:56:20 - progress_bar.py[line:274] - INFO: epoch 017:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3253.1, ups=0.18, wpb=17590.9, bsz=1024, num_updates=6380, lr=4.45122e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=40499
2024-11-07 00:57:14 - progress_bar.py[line:274] - INFO: epoch 017:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17663.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3300.8, ups=0.19, wpb=17663.8, bsz=1024, num_updates=6390, lr=4.44986e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=40553
2024-11-07 00:58:07 - progress_bar.py[line:274] - INFO: epoch 017:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17698.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3296.5, ups=0.19, wpb=17698.3, bsz=1024, num_updates=6400, lr=4.4485e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=40606
2024-11-07 00:59:01 - progress_bar.py[line:274] - INFO: epoch 017:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=17502.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3284.2, ups=0.19, wpb=17502.9, bsz=1024, num_updates=6410, lr=4.44714e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=40660
2024-11-07 00:59:53 - progress_bar.py[line:274] - INFO: epoch 017:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17786.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3399.4, ups=0.19, wpb=17786.7, bsz=1024, num_updates=6420, lr=4.44577e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=40712
2024-11-07 01:00:45 - progress_bar.py[line:274] - INFO: epoch 017:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17432.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3364.4, ups=0.19, wpb=17432.7, bsz=1024, num_updates=6430, lr=4.44441e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=40764
2024-11-07 01:01:37 - progress_bar.py[line:274] - INFO: epoch 017:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17821.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3414, ups=0.19, wpb=17821.6, bsz=1024, num_updates=6440, lr=4.44305e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=40816
2024-11-07 01:02:29 - progress_bar.py[line:274] - INFO: epoch 017:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18043, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3459.1, ups=0.19, wpb=18043, bsz=1024, num_updates=6450, lr=4.44169e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=40868
2024-11-07 01:03:21 - progress_bar.py[line:274] - INFO: epoch 017:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17859.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3430.4, ups=0.19, wpb=17859.1, bsz=1024, num_updates=6460, lr=4.44033e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=40920
2024-11-07 01:04:14 - progress_bar.py[line:274] - INFO: epoch 017:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17918.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3430.8, ups=0.19, wpb=17918.5, bsz=1024, num_updates=6470, lr=4.43897e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=40972
2024-11-07 01:05:05 - progress_bar.py[line:274] - INFO: epoch 017:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17941.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3461.5, ups=0.19, wpb=17941.3, bsz=1024, num_updates=6480, lr=4.43761e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=41024
2024-11-07 01:05:57 - progress_bar.py[line:274] - INFO: epoch 017:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17611.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3394.8, ups=0.19, wpb=17611.9, bsz=1024, num_updates=6490, lr=4.43625e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=41076
2024-11-07 01:06:49 - progress_bar.py[line:274] - INFO: epoch 017:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17354.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3326.9, ups=0.19, wpb=17354.7, bsz=1024, num_updates=6500, lr=4.43489e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=41128
2024-11-07 01:07:42 - progress_bar.py[line:274] - INFO: epoch 017:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17608, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3350, ups=0.19, wpb=17608, bsz=1024, num_updates=6510, lr=4.43353e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=41181
2024-11-07 01:08:24 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 01:08:40 - progress_bar.py[line:274] - INFO: epoch 017:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17858.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3097.6, ups=0.17, wpb=17858.3, bsz=1024, num_updates=6520, lr=4.43217e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=41239
2024-11-07 01:09:32 - progress_bar.py[line:274] - INFO: epoch 017:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17611.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3335.9, ups=0.19, wpb=17611.1, bsz=1024, num_updates=6530, lr=4.43081e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41291
2024-11-07 01:10:25 - progress_bar.py[line:274] - INFO: epoch 017:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17626, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3352.4, ups=0.19, wpb=17626, bsz=1024, num_updates=6540, lr=4.42945e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=41344
2024-11-07 01:11:18 - progress_bar.py[line:274] - INFO: epoch 017:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17679.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3307.9, ups=0.19, wpb=17679.5, bsz=1024, num_updates=6550, lr=4.42809e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41397
2024-11-07 01:12:12 - progress_bar.py[line:274] - INFO: epoch 017:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=18479.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3422.2, ups=0.19, wpb=18479.6, bsz=1024, num_updates=6560, lr=4.42673e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=41451
2024-11-07 01:13:06 - progress_bar.py[line:274] - INFO: epoch 017:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18188.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3398.9, ups=0.19, wpb=18188.5, bsz=1024, num_updates=6570, lr=4.42537e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41505
2024-11-07 01:13:59 - progress_bar.py[line:274] - INFO: epoch 017:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=18555.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3474.5, ups=0.19, wpb=18555.9, bsz=1024, num_updates=6580, lr=4.42401e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=41558
2024-11-07 01:14:53 - progress_bar.py[line:274] - INFO: epoch 017:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=18213.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3414.3, ups=0.19, wpb=18213.6, bsz=1024, num_updates=6590, lr=4.42265e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41612
2024-11-07 01:15:46 - progress_bar.py[line:274] - INFO: epoch 017:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=18627.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3467.8, ups=0.19, wpb=18627.4, bsz=1024, num_updates=6600, lr=4.42129e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=41665
2024-11-07 01:16:39 - progress_bar.py[line:274] - INFO: epoch 017:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=18216.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3443.6, ups=0.19, wpb=18216.5, bsz=1024, num_updates=6610, lr=4.41993e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=41718
2024-11-07 01:17:33 - progress_bar.py[line:274] - INFO: epoch 017:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=18217.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3413.3, ups=0.19, wpb=18217.5, bsz=1024, num_updates=6620, lr=4.41857e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=41772
2024-11-07 01:18:25 - progress_bar.py[line:274] - INFO: epoch 017:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17754.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3384.1, ups=0.19, wpb=17754.9, bsz=1024, num_updates=6630, lr=4.41721e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=41824
2024-11-07 01:19:19 - progress_bar.py[line:274] - INFO: epoch 017:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=18047.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3364.7, ups=0.19, wpb=18047.6, bsz=1024, num_updates=6640, lr=4.41585e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=41878
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt2024-11-07 01:19:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6644 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-07 01:19:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 01:21:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 01:23:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6644 updates, score 0) (writing took 222.2265964919934 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 01:24:13 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-07 01:24:13 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.554 | ntokens 17800.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.87 | wps 2782.7 | ups 0.16 | wpb 17800.4 | bsz 1023 | num_updates 6644 | lr 4.4153e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1774 | gb_free 13.4 | wall 42172
2024-11-07 01:24:13 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 01:26:52 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-07 01:26:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 01:27:25 - progress_bar.py[line:274] - INFO: epoch 018:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=16905.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=347.5, ups=0.02, wpb=16905.2, bsz=985.6, num_updates=6650, lr=4.41449e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=42364
2024-11-07 01:28:18 - progress_bar.py[line:274] - INFO: epoch 018:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17690.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3365.8, ups=0.19, wpb=17690.4, bsz=1024, num_updates=6660, lr=4.41313e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=42417
2024-11-07 01:29:10 - progress_bar.py[line:274] - INFO: epoch 018:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17411.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3306.9, ups=0.19, wpb=17411.3, bsz=1024, num_updates=6670, lr=4.41176e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42469
2024-11-07 01:30:02 - progress_bar.py[line:274] - INFO: epoch 018:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17778.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3424.7, ups=0.19, wpb=17778.9, bsz=1024, num_updates=6680, lr=4.4104e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=42521
2024-11-07 01:30:54 - progress_bar.py[line:274] - INFO: epoch 018:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17597.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3393.4, ups=0.19, wpb=17597.8, bsz=1024, num_updates=6690, lr=4.40904e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42573
2024-11-07 01:31:46 - progress_bar.py[line:274] - INFO: epoch 018:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17756.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3423.5, ups=0.19, wpb=17756.2, bsz=1024, num_updates=6700, lr=4.40768e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42625
2024-11-07 01:32:39 - progress_bar.py[line:274] - INFO: epoch 018:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17912, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3407.9, ups=0.19, wpb=17912, bsz=1024, num_updates=6710, lr=4.40632e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42678
2024-11-07 01:33:31 - progress_bar.py[line:274] - INFO: epoch 018:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17547.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3364.5, ups=0.19, wpb=17547.1, bsz=1024, num_updates=6720, lr=4.40496e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42730
2024-11-07 01:34:24 - progress_bar.py[line:274] - INFO: epoch 018:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17763.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3347.6, ups=0.19, wpb=17763.4, bsz=1024, num_updates=6730, lr=4.4036e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42783
2024-11-07 01:35:16 - progress_bar.py[line:274] - INFO: epoch 018:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17948.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3441.1, ups=0.19, wpb=17948.6, bsz=1024, num_updates=6740, lr=4.40224e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42835
2024-11-07 01:36:08 - progress_bar.py[line:274] - INFO: epoch 018:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17604.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3391.2, ups=0.19, wpb=17604.8, bsz=1024, num_updates=6750, lr=4.40088e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=42887
2024-11-07 01:37:00 - progress_bar.py[line:274] - INFO: epoch 018:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17684.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3375.3, ups=0.19, wpb=17684.2, bsz=1024, num_updates=6760, lr=4.39952e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=42939
2024-11-07 01:37:54 - progress_bar.py[line:274] - INFO: epoch 018:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3226.5, ups=0.19, wpb=17398.1, bsz=1024, num_updates=6770, lr=4.39816e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=42993
2024-11-07 01:38:50 - progress_bar.py[line:274] - INFO: epoch 018:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17447.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3120.1, ups=0.18, wpb=17447.3, bsz=1024, num_updates=6780, lr=4.3968e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=43049
2024-11-07 01:39:43 - progress_bar.py[line:274] - INFO: epoch 018:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=18061.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3435.2, ups=0.19, wpb=18061.2, bsz=1024, num_updates=6790, lr=4.39544e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=43102
2024-11-07 01:40:35 - progress_bar.py[line:274] - INFO: epoch 018:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17689.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3370.2, ups=0.19, wpb=17689.6, bsz=1024, num_updates=6800, lr=4.39408e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=43154
2024-11-07 01:41:28 - progress_bar.py[line:274] - INFO: epoch 018:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=18074.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3429, ups=0.19, wpb=18074.8, bsz=1024, num_updates=6810, lr=4.39272e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=43207
2024-11-07 01:42:24 - progress_bar.py[line:274] - INFO: epoch 018:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17661, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3135.8, ups=0.18, wpb=17661, bsz=1024, num_updates=6820, lr=4.39136e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=43263
2024-11-07 01:43:20 - progress_bar.py[line:274] - INFO: epoch 018:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17578.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3138.4, ups=0.18, wpb=17578.5, bsz=1024, num_updates=6830, lr=4.39e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=43319
2024-11-07 01:44:13 - progress_bar.py[line:274] - INFO: epoch 018:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17651.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3321.9, ups=0.19, wpb=17651.4, bsz=1024, num_updates=6840, lr=4.38864e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43372
2024-11-07 01:45:06 - progress_bar.py[line:274] - INFO: epoch 018:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=18082.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3433.7, ups=0.19, wpb=18082.2, bsz=1024, num_updates=6850, lr=4.38728e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=43425
2024-11-07 01:45:59 - progress_bar.py[line:274] - INFO: epoch 018:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17840.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3393.1, ups=0.19, wpb=17840.8, bsz=1024, num_updates=6860, lr=4.38592e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43478
2024-11-07 01:46:51 - progress_bar.py[line:274] - INFO: epoch 018:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17811.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3408.4, ups=0.19, wpb=17811.4, bsz=1024, num_updates=6870, lr=4.38456e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=43530
2024-11-07 01:47:43 - progress_bar.py[line:274] - INFO: epoch 018:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=17427.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3330.4, ups=0.19, wpb=17427.3, bsz=1024, num_updates=6880, lr=4.3832e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=43582
2024-11-07 01:48:36 - progress_bar.py[line:274] - INFO: epoch 018:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17351.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3307.8, ups=0.19, wpb=17351.4, bsz=1024, num_updates=6890, lr=4.38184e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=43635
2024-11-07 01:49:28 - progress_bar.py[line:274] - INFO: epoch 018:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17591.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3338.2, ups=0.19, wpb=17591.6, bsz=1024, num_updates=6900, lr=4.38048e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=43687
2024-11-07 01:50:21 - progress_bar.py[line:274] - INFO: epoch 018:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=18000.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3440.8, ups=0.19, wpb=18000.2, bsz=1024, num_updates=6910, lr=4.37912e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43740
2024-11-07 01:51:13 - progress_bar.py[line:274] - INFO: epoch 018:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17755.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3375.6, ups=0.19, wpb=17755.5, bsz=1024, num_updates=6920, lr=4.37775e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43792
2024-11-07 01:52:06 - progress_bar.py[line:274] - INFO: epoch 018:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3349.6, ups=0.19, wpb=17508.1, bsz=1024, num_updates=6930, lr=4.37639e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43845
2024-11-07 01:52:58 - progress_bar.py[line:274] - INFO: epoch 018:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17919.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3446.6, ups=0.19, wpb=17919.1, bsz=1024, num_updates=6940, lr=4.37503e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=43896
2024-11-07 01:53:50 - progress_bar.py[line:274] - INFO: epoch 018:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=18323.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3465.1, ups=0.19, wpb=18323.3, bsz=1024, num_updates=6950, lr=4.37367e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=43949
2024-11-07 01:54:42 - progress_bar.py[line:274] - INFO: epoch 018:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=18077.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3502.1, ups=0.19, wpb=18077.7, bsz=1024, num_updates=6960, lr=4.37231e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=44001
2024-11-07 01:55:35 - progress_bar.py[line:274] - INFO: epoch 018:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17846, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3401.2, ups=0.19, wpb=17846, bsz=1024, num_updates=6970, lr=4.37095e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=44053
2024-11-07 01:56:26 - progress_bar.py[line:274] - INFO: epoch 018:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18218.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3546.1, ups=0.19, wpb=18218.2, bsz=1024, num_updates=6980, lr=4.36959e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=44105
2024-11-07 01:57:18 - progress_bar.py[line:274] - INFO: epoch 018:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=18517.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3545, ups=0.19, wpb=18517.8, bsz=1024, num_updates=6990, lr=4.36823e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=44157
2024-11-07 01:58:10 - progress_bar.py[line:274] - INFO: epoch 018:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18404.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3544.9, ups=0.19, wpb=18404.7, bsz=1024, num_updates=7000, lr=4.36687e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=37, gb_free=13.4, wall=44209
2024-11-07 01:59:02 - progress_bar.py[line:274] - INFO: epoch 018:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=18572, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3548.9, ups=0.19, wpb=18572, bsz=1024, num_updates=7010, lr=4.36551e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=44261
2024-11-07 01:59:55 - progress_bar.py[line:274] - INFO: epoch 018:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=18409.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3505.9, ups=0.19, wpb=18409.7, bsz=1024, num_updates=7020, lr=4.36415e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=45, gb_free=13.4, wall=44314
2024-11-07 02:00:47 - progress_bar.py[line:274] - INFO: epoch 018:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=18058.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3468, ups=0.19, wpb=18058.9, bsz=1024, num_updates=7030, lr=4.36279e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=48, gb_free=13.4, wall=44366
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt


2024-11-07 02:01:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 7035 updates
2024-11-07 02:01:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 02:03:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 02:04:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 18 @ 7035 updates, score 0) (writing took 222.36915990599664 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
2024-11-07 02:05:47 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-07 02:05:47 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.557 | ntokens 17820 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.89 | wps 2794 | ups 0.16 | wpb 17820 | bsz 1023 | num_updates 7035 | lr 4.36211e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1372 | gb_free 13.4 | wall 44666
2024-11-07 02:05:47 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 02:08:27 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-07 02:08:27 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 02:08:55 - progress_bar.py[line:274] - INFO: epoch 019:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16966.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=347.7, ups=0.02, wpb=16966.3, bsz=985.6, num_updates=7040, lr=4.36143e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=44854
2024-11-07 02:09:48 - progress_bar.py[line:274] - INFO: epoch 019:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17702.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3355.6, ups=0.19, wpb=17702.5, bsz=1024, num_updates=7050, lr=4.36007e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=44907
2024-11-07 02:10:40 - progress_bar.py[line:274] - INFO: epoch 019:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17532, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3341, ups=0.19, wpb=17532, bsz=1024, num_updates=7060, lr=4.35871e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=44959
2024-11-07 02:11:32 - progress_bar.py[line:274] - INFO: epoch 019:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17750, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3412.9, ups=0.19, wpb=17750, bsz=1024, num_updates=7070, lr=4.35735e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=45011
2024-11-07 02:12:27 - progress_bar.py[line:274] - INFO: epoch 019:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17622.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3210.9, ups=0.18, wpb=17622.6, bsz=1024, num_updates=7080, lr=4.35599e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=45066
2024-11-07 02:13:23 - progress_bar.py[line:274] - INFO: epoch 019:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17785.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3197.6, ups=0.18, wpb=17785.6, bsz=1024, num_updates=7090, lr=4.35463e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=45122
2024-11-07 02:14:16 - progress_bar.py[line:274] - INFO: epoch 019:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17919.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3364, ups=0.19, wpb=17919.3, bsz=1024, num_updates=7100, lr=4.35327e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=45175
2024-11-07 02:15:11 - progress_bar.py[line:274] - INFO: epoch 019:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3213.3, ups=0.18, wpb=17685.5, bsz=1024, num_updates=7110, lr=4.35191e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=45230
2024-11-07 02:16:07 - progress_bar.py[line:274] - INFO: epoch 019:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17855.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3208.8, ups=0.18, wpb=17855.3, bsz=1024, num_updates=7120, lr=4.35055e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=45286
2024-11-07 02:17:03 - progress_bar.py[line:274] - INFO: epoch 019:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17514.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3135.2, ups=0.18, wpb=17514.6, bsz=1024, num_updates=7130, lr=4.34919e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=45341
2024-11-07 02:17:57 - progress_bar.py[line:274] - INFO: epoch 019:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17907.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3262.8, ups=0.18, wpb=17907.8, bsz=1024, num_updates=7140, lr=4.34783e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=45396
2024-11-07 02:18:49 - progress_bar.py[line:274] - INFO: epoch 019:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17342.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3337.6, ups=0.19, wpb=17342.1, bsz=1024, num_updates=7150, lr=4.34647e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=45448
2024-11-07 02:19:41 - progress_bar.py[line:274] - INFO: epoch 019:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17863, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3469, ups=0.19, wpb=17863, bsz=1024, num_updates=7160, lr=4.34511e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=45500
2024-11-07 02:20:33 - progress_bar.py[line:274] - INFO: epoch 019:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17514.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3354.3, ups=0.19, wpb=17514.4, bsz=1024, num_updates=7170, lr=4.34374e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=45552
2024-11-07 02:21:25 - progress_bar.py[line:274] - INFO: epoch 019:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17813.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3452.9, ups=0.19, wpb=17813.2, bsz=1024, num_updates=7180, lr=4.34238e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.6, wall=45604
2024-11-07 02:22:17 - progress_bar.py[line:274] - INFO: epoch 019:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17706.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3400.7, ups=0.19, wpb=17706.6, bsz=1024, num_updates=7190, lr=4.34102e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=45656
2024-11-07 02:23:10 - progress_bar.py[line:274] - INFO: epoch 019:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=18027.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3418.3, ups=0.19, wpb=18027.7, bsz=1024, num_updates=7200, lr=4.33966e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=45708
2024-11-07 02:24:02 - progress_bar.py[line:274] - INFO: epoch 019:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.498, ntokens=17610.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3339.2, ups=0.19, wpb=17610.1, bsz=1024, num_updates=7210, lr=4.3383e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=45761
2024-11-07 02:24:55 - progress_bar.py[line:274] - INFO: epoch 019:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17586.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3355.5, ups=0.19, wpb=17586.1, bsz=1024, num_updates=7220, lr=4.33694e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=45814
2024-11-07 02:25:48 - progress_bar.py[line:274] - INFO: epoch 019:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=18088.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3382.1, ups=0.19, wpb=18088.7, bsz=1024, num_updates=7230, lr=4.33558e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=45867
2024-11-07 02:26:41 - progress_bar.py[line:274] - INFO: epoch 019:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=18086.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3391.3, ups=0.19, wpb=18086.4, bsz=1024, num_updates=7240, lr=4.33422e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=47, gb_free=13.5, wall=45920
2024-11-07 02:27:35 - progress_bar.py[line:274] - INFO: epoch 019:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17929.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3371.4, ups=0.19, wpb=17929.7, bsz=1024, num_updates=7250, lr=4.33286e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=45974
2024-11-07 02:28:28 - progress_bar.py[line:274] - INFO: epoch 019:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17805.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3341.5, ups=0.19, wpb=17805.8, bsz=1024, num_updates=7260, lr=4.3315e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=46027
2024-11-07 02:29:20 - progress_bar.py[line:274] - INFO: epoch 019:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17691.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3373.8, ups=0.19, wpb=17691.3, bsz=1024, num_updates=7270, lr=4.33014e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=46079
2024-11-07 02:30:13 - progress_bar.py[line:274] - INFO: epoch 019:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17732, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3357.7, ups=0.19, wpb=17732, bsz=1024, num_updates=7280, lr=4.32878e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=46132
2024-11-07 02:31:06 - progress_bar.py[line:274] - INFO: epoch 019:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17446.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3296.4, ups=0.19, wpb=17446.4, bsz=1024, num_updates=7290, lr=4.32742e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=46185
2024-11-07 02:31:58 - progress_bar.py[line:274] - INFO: epoch 019:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17797.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3435.8, ups=0.19, wpb=17797.7, bsz=1024, num_updates=7300, lr=4.32606e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=43, gb_free=13.5, wall=46237
2024-11-07 02:32:50 - progress_bar.py[line:274] - INFO: epoch 019:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17889.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3459.5, ups=0.19, wpb=17889.1, bsz=1024, num_updates=7310, lr=4.3247e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=46289
2024-11-07 02:33:42 - progress_bar.py[line:274] - INFO: epoch 019:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17466.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3328.1, ups=0.19, wpb=17466.2, bsz=1024, num_updates=7320, lr=4.32334e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=46341
2024-11-07 02:34:34 - progress_bar.py[line:274] - INFO: epoch 019:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17861.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3435.4, ups=0.19, wpb=17861.7, bsz=1024, num_updates=7330, lr=4.32198e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=46393
2024-11-07 02:35:26 - progress_bar.py[line:274] - INFO: epoch 019:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=18372.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3565.3, ups=0.19, wpb=18372.3, bsz=1024, num_updates=7340, lr=4.32062e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=46445
2024-11-07 02:36:18 - progress_bar.py[line:274] - INFO: epoch 019:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=18596.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3585.6, ups=0.19, wpb=18596.5, bsz=1024, num_updates=7350, lr=4.31926e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=46496
2024-11-07 02:37:10 - progress_bar.py[line:274] - INFO: epoch 019:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18042.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3470.1, ups=0.19, wpb=18042.2, bsz=1024, num_updates=7360, lr=4.3179e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=36, gb_free=13.4, wall=46548
2024-11-07 02:38:01 - progress_bar.py[line:274] - INFO: epoch 019:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=18295.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3560, ups=0.19, wpb=18295.6, bsz=1024, num_updates=7370, lr=4.31654e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=40, gb_free=13.3, wall=46600
2024-11-07 02:38:53 - progress_bar.py[line:274] - INFO: epoch 019:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18163.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3505.3, ups=0.19, wpb=18163.3, bsz=1024, num_updates=7380, lr=4.31518e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=38, gb_free=13.3, wall=46652
2024-11-07 02:39:45 - progress_bar.py[line:274] - INFO: epoch 019:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=18614.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3571.7, ups=0.19, wpb=18614.8, bsz=1024, num_updates=7390, lr=4.31382e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=46704
2024-11-07 02:40:37 - progress_bar.py[line:274] - INFO: epoch 019:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17982.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3434.7, ups=0.19, wpb=17982.7, bsz=1024, num_updates=7400, lr=4.31246e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.3, wall=46756
2024-11-07 02:41:30 - progress_bar.py[line:274] - INFO: epoch 019:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18113.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3448.6, ups=0.19, wpb=18113.1, bsz=1024, num_updates=7410, lr=4.3111e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=44, gb_free=13.4, wall=46809
2024-11-07 02:42:22 - progress_bar.py[line:274] - INFO: epoch 019:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17905.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3443.6, ups=0.19, wpb=17905.6, bsz=1024, num_updates=7420, lr=4.30973e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=46861
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt2024-11-07 02:42:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 7426 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-07 02:42:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 02:44:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000slice_id 6 seek offset 300000

slice_id 7 seek offset 350000
2024-11-07 02:46:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 19 @ 7426 updates, score 0) (writing took 220.57849960200838 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 02:47:24 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-07 02:47:24 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.543 | ntokens 17834.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.83 | wps 2791.9 | ups 0.16 | wpb 17834.4 | bsz 1023 | num_updates 7426 | lr 4.30892e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1541 | gb_free 13.3 | wall 47163
2024-11-07 02:47:24 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 02:50:04 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-07 02:50:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 02:50:27 - progress_bar.py[line:274] - INFO: epoch 020:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17192.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=354.3, ups=0.02, wpb=17192.9, bsz=985.6, num_updates=7430, lr=4.30837e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=47346
2024-11-07 02:51:20 - progress_bar.py[line:274] - INFO: epoch 020:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17757.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3359.4, ups=0.19, wpb=17757.2, bsz=1024, num_updates=7440, lr=4.30701e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47399
2024-11-07 02:52:12 - progress_bar.py[line:274] - INFO: epoch 020:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17396.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3339.3, ups=0.19, wpb=17396.6, bsz=1024, num_updates=7450, lr=4.30565e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47451
2024-11-07 02:53:05 - progress_bar.py[line:274] - INFO: epoch 020:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17766.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3372.4, ups=0.19, wpb=17766.5, bsz=1024, num_updates=7460, lr=4.30429e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47504
2024-11-07 02:53:57 - progress_bar.py[line:274] - INFO: epoch 020:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17741, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3363, ups=0.19, wpb=17741, bsz=1024, num_updates=7470, lr=4.30293e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=47556
2024-11-07 02:54:50 - progress_bar.py[line:274] - INFO: epoch 020:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17645.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3330.8, ups=0.19, wpb=17645.5, bsz=1024, num_updates=7480, lr=4.30157e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=47609
2024-11-07 02:55:43 - progress_bar.py[line:274] - INFO: epoch 020:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17994.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3421.2, ups=0.19, wpb=17994.5, bsz=1024, num_updates=7490, lr=4.30021e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47662
2024-11-07 02:56:35 - progress_bar.py[line:274] - INFO: epoch 020:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17682.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3374.9, ups=0.19, wpb=17682.7, bsz=1024, num_updates=7500, lr=4.29885e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47714
2024-11-07 02:57:28 - progress_bar.py[line:274] - INFO: epoch 020:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17556.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3353.8, ups=0.19, wpb=17556.8, bsz=1024, num_updates=7510, lr=4.29749e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47767
2024-11-07 02:58:20 - progress_bar.py[line:274] - INFO: epoch 020:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.516, ntokens=17654.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3350.3, ups=0.19, wpb=17654.1, bsz=1024, num_updates=7520, lr=4.29613e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=47819
2024-11-07 02:59:13 - progress_bar.py[line:274] - INFO: epoch 020:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.505, ntokens=17676.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3357.8, ups=0.19, wpb=17676.8, bsz=1024, num_updates=7530, lr=4.29477e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47872
2024-11-07 03:00:06 - progress_bar.py[line:274] - INFO: epoch 020:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.513, ntokens=17431.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3295, ups=0.19, wpb=17431.4, bsz=1024, num_updates=7540, lr=4.29341e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=47925
2024-11-07 03:00:33 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 03:01:05 - progress_bar.py[line:274] - INFO: epoch 020:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17729.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3022.1, ups=0.17, wpb=17729.2, bsz=1024, num_updates=7550, lr=4.29205e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=47983
2024-11-07 03:01:56 - progress_bar.py[line:274] - INFO: epoch 020:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3328.2, ups=0.19, wpb=17258.7, bsz=1024, num_updates=7560, lr=4.29069e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48035
2024-11-07 03:02:49 - progress_bar.py[line:274] - INFO: epoch 020:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17628.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3338.3, ups=0.19, wpb=17628.9, bsz=1024, num_updates=7570, lr=4.28933e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48088
2024-11-07 03:03:42 - progress_bar.py[line:274] - INFO: epoch 020:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17754.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3353, ups=0.19, wpb=17754.2, bsz=1024, num_updates=7580, lr=4.28797e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48141
2024-11-07 03:04:35 - progress_bar.py[line:274] - INFO: epoch 020:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17845.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3365.1, ups=0.19, wpb=17845.6, bsz=1024, num_updates=7590, lr=4.28661e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48194
2024-11-07 03:05:27 - progress_bar.py[line:274] - INFO: epoch 020:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17604.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3378.6, ups=0.19, wpb=17604.2, bsz=1024, num_updates=7600, lr=4.28525e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48246
2024-11-07 03:06:20 - progress_bar.py[line:274] - INFO: epoch 020:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17799.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3413, ups=0.19, wpb=17799.8, bsz=1024, num_updates=7610, lr=4.28389e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48298
2024-11-07 03:07:12 - progress_bar.py[line:274] - INFO: epoch 020:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3358.3, ups=0.19, wpb=17513.9, bsz=1024, num_updates=7620, lr=4.28253e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48351
2024-11-07 03:08:05 - progress_bar.py[line:274] - INFO: epoch 020:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17929.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3392.4, ups=0.19, wpb=17929.4, bsz=1024, num_updates=7630, lr=4.28117e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48403
2024-11-07 03:08:57 - progress_bar.py[line:274] - INFO: epoch 020:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17787.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3385.8, ups=0.19, wpb=17787.4, bsz=1024, num_updates=7640, lr=4.27981e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=48456
2024-11-07 03:09:50 - progress_bar.py[line:274] - INFO: epoch 020:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17715.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3360.5, ups=0.19, wpb=17715.5, bsz=1024, num_updates=7650, lr=4.27845e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48509
2024-11-07 03:10:42 - progress_bar.py[line:274] - INFO: epoch 020:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=17534.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3351, ups=0.19, wpb=17534.3, bsz=1024, num_updates=7660, lr=4.27709e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48561
2024-11-07 03:11:35 - progress_bar.py[line:274] - INFO: epoch 020:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17514.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3317.5, ups=0.19, wpb=17514.9, bsz=1024, num_updates=7670, lr=4.27573e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=48614
2024-11-07 03:12:28 - progress_bar.py[line:274] - INFO: epoch 020:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17731, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3339.4, ups=0.19, wpb=17731, bsz=1024, num_updates=7680, lr=4.27436e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48667
2024-11-07 03:13:20 - progress_bar.py[line:274] - INFO: epoch 020:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17856.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3412.6, ups=0.19, wpb=17856.2, bsz=1024, num_updates=7690, lr=4.273e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=48719
2024-11-07 03:14:13 - progress_bar.py[line:274] - INFO: epoch 020:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=17547.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3319.1, ups=0.19, wpb=17547.8, bsz=1024, num_updates=7700, lr=4.27164e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48772
2024-11-07 03:15:06 - progress_bar.py[line:274] - INFO: epoch 020:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17758.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3379, ups=0.19, wpb=17758.7, bsz=1024, num_updates=7710, lr=4.27028e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=48825
2024-11-07 03:15:58 - progress_bar.py[line:274] - INFO: epoch 020:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17727.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3418.8, ups=0.19, wpb=17727.3, bsz=1024, num_updates=7720, lr=4.26892e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=48876
2024-11-07 03:16:51 - progress_bar.py[line:274] - INFO: epoch 020:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18039.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3387.8, ups=0.19, wpb=18039.3, bsz=1024, num_updates=7730, lr=4.26756e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=41, gb_free=13.4, wall=48930
2024-11-07 03:17:45 - progress_bar.py[line:274] - INFO: epoch 020:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=18462.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3437.2, ups=0.19, wpb=18462.5, bsz=1024, num_updates=7740, lr=4.2662e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=48983
2024-11-07 03:18:38 - progress_bar.py[line:274] - INFO: epoch 020:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=18349, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3450, ups=0.19, wpb=18349, bsz=1024, num_updates=7750, lr=4.26484e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=49037
2024-11-07 03:19:30 - progress_bar.py[line:274] - INFO: epoch 020:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=18494.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3517, ups=0.19, wpb=18494.7, bsz=1024, num_updates=7760, lr=4.26348e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=49089
2024-11-07 03:20:23 - progress_bar.py[line:274] - INFO: epoch 020:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=18378.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3507.7, ups=0.19, wpb=18378.6, bsz=1024, num_updates=7770, lr=4.26212e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=49142
2024-11-07 03:21:14 - progress_bar.py[line:274] - INFO: epoch 020:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=18349, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3557.9, ups=0.19, wpb=18349, bsz=1024, num_updates=7780, lr=4.26076e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=49193
2024-11-07 03:22:07 - progress_bar.py[line:274] - INFO: epoch 020:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=18115.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3455.7, ups=0.19, wpb=18115.1, bsz=1024, num_updates=7790, lr=4.2594e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=49246
2024-11-07 03:22:59 - progress_bar.py[line:274] - INFO: epoch 020:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3381.8, ups=0.19, wpb=17835.7, bsz=1024, num_updates=7800, lr=4.25804e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=49298
2024-11-07 03:23:51 - progress_bar.py[line:274] - INFO: epoch 020:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18203.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3498.5, ups=0.19, wpb=18203.4, bsz=1024, num_updates=7810, lr=4.25668e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=49350
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

2024-11-07 03:24:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 7816 updates


2024-11-07 03:24:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 03:26:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 03:28:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 20 @ 7816 updates, score 0) (writing took 220.5842493160162 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 03:28:54 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-07 03:28:54 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.53 | ntokens 17797.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.78 | wps 2787.5 | ups 0.16 | wpb 17797.1 | bsz 1023 | num_updates 7816 | lr 4.25586e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1384 | gb_free 13.3 | wall 49653
2024-11-07 03:28:54 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 03:31:33 - trainer.py[line:703] - INFO: begin training epoch 21
2024-11-07 03:31:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 03:31:56 - progress_bar.py[line:274] - INFO: epoch 021:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17231.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=355.5, ups=0.02, wpb=17231.8, bsz=985.6, num_updates=7820, lr=4.25532e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=49835
2024-11-07 03:32:49 - progress_bar.py[line:274] - INFO: epoch 021:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17722.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3372, ups=0.19, wpb=17722.3, bsz=1024, num_updates=7830, lr=4.25396e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=49888
2024-11-07 03:33:42 - progress_bar.py[line:274] - INFO: epoch 021:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17796.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3349.4, ups=0.19, wpb=17796.3, bsz=1024, num_updates=7840, lr=4.2526e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=49941
2024-11-07 03:34:38 - progress_bar.py[line:274] - INFO: epoch 021:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=18193.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3257.7, ups=0.18, wpb=18193.1, bsz=1024, num_updates=7850, lr=4.25124e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=49997
2024-11-07 03:35:33 - progress_bar.py[line:274] - INFO: epoch 021:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17621.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3165, ups=0.18, wpb=17621.8, bsz=1024, num_updates=7860, lr=4.24988e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=50052
2024-11-07 03:36:29 - progress_bar.py[line:274] - INFO: epoch 021:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.487, ntokens=17431.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3132.1, ups=0.18, wpb=17431.5, bsz=1024, num_updates=7870, lr=4.24852e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.6, wall=50108
2024-11-07 03:37:24 - progress_bar.py[line:274] - INFO: epoch 021:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=18104.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3280.7, ups=0.18, wpb=18104.3, bsz=1024, num_updates=7880, lr=4.24716e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=50163
2024-11-07 03:38:20 - progress_bar.py[line:274] - INFO: epoch 021:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17667.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3182.6, ups=0.18, wpb=17667.7, bsz=1024, num_updates=7890, lr=4.2458e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=50219
2024-11-07 03:39:15 - progress_bar.py[line:274] - INFO: epoch 021:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17587.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3201.4, ups=0.18, wpb=17587.7, bsz=1024, num_updates=7900, lr=4.24444e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=50274
2024-11-07 03:40:07 - progress_bar.py[line:274] - INFO: epoch 021:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17788.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3406.4, ups=0.19, wpb=17788.8, bsz=1024, num_updates=7910, lr=4.24308e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=50326
2024-11-07 03:40:59 - progress_bar.py[line:274] - INFO: epoch 021:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17705.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3403.5, ups=0.19, wpb=17705.7, bsz=1024, num_updates=7920, lr=4.24172e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=50378
2024-11-07 03:41:51 - progress_bar.py[line:274] - INFO: epoch 021:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17748.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3431.4, ups=0.19, wpb=17748.9, bsz=1024, num_updates=7930, lr=4.24035e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=50430
2024-11-07 03:42:43 - progress_bar.py[line:274] - INFO: epoch 021:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=17675.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3396.2, ups=0.19, wpb=17675.6, bsz=1024, num_updates=7940, lr=4.23899e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=50482
2024-11-07 03:43:35 - progress_bar.py[line:274] - INFO: epoch 021:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=17377.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3333.6, ups=0.19, wpb=17377.8, bsz=1024, num_updates=7950, lr=4.23763e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=50534
2024-11-07 03:44:27 - progress_bar.py[line:274] - INFO: epoch 021:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17478.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3358.5, ups=0.19, wpb=17478.3, bsz=1024, num_updates=7960, lr=4.23627e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=50586
2024-11-07 03:45:19 - progress_bar.py[line:274] - INFO: epoch 021:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17516.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3386, ups=0.19, wpb=17516.1, bsz=1024, num_updates=7970, lr=4.23491e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.3, wall=50637
2024-11-07 03:46:11 - progress_bar.py[line:274] - INFO: epoch 021:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=18064.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3436.3, ups=0.19, wpb=18064.3, bsz=1024, num_updates=7980, lr=4.23355e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=50690
2024-11-07 03:47:03 - progress_bar.py[line:274] - INFO: epoch 021:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17810.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3405.6, ups=0.19, wpb=17810.5, bsz=1024, num_updates=7990, lr=4.23219e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=50742
2024-11-07 03:47:56 - progress_bar.py[line:274] - INFO: epoch 021:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.507, ntokens=17513.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3357.9, ups=0.19, wpb=17513.2, bsz=1024, num_updates=8000, lr=4.23083e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50795
2024-11-07 03:48:48 - progress_bar.py[line:274] - INFO: epoch 021:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=17642.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3356.3, ups=0.19, wpb=17642.6, bsz=1024, num_updates=8010, lr=4.22947e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50847
2024-11-07 03:49:41 - progress_bar.py[line:274] - INFO: epoch 021:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17899, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3420.6, ups=0.19, wpb=17899, bsz=1024, num_updates=8020, lr=4.22811e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=50899
2024-11-07 03:50:33 - progress_bar.py[line:274] - INFO: epoch 021:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17795.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3411.4, ups=0.19, wpb=17795.4, bsz=1024, num_updates=8030, lr=4.22675e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=50952
2024-11-07 03:51:25 - progress_bar.py[line:274] - INFO: epoch 021:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17831.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3391.9, ups=0.19, wpb=17831.6, bsz=1024, num_updates=8040, lr=4.22539e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=51004
2024-11-07 03:52:18 - progress_bar.py[line:274] - INFO: epoch 021:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17935.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3428.2, ups=0.19, wpb=17935.1, bsz=1024, num_updates=8050, lr=4.22403e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=51056
2024-11-07 03:53:10 - progress_bar.py[line:274] - INFO: epoch 021:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17758.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3361.7, ups=0.19, wpb=17758.6, bsz=1024, num_updates=8060, lr=4.22267e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=51109
2024-11-07 03:53:58 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 03:54:08 - progress_bar.py[line:274] - INFO: epoch 021:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17733.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3055.6, ups=0.17, wpb=17733.8, bsz=1024, num_updates=8070, lr=4.22131e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=33, gb_free=13.3, wall=51167
2024-11-07 03:55:02 - progress_bar.py[line:274] - INFO: epoch 021:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=18087.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3402.8, ups=0.19, wpb=18087.9, bsz=1024, num_updates=8080, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=51220
2024-11-07 03:55:57 - progress_bar.py[line:274] - INFO: epoch 021:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17919, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3258.4, ups=0.18, wpb=17919, bsz=1024, num_updates=8090, lr=4.21859e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=51275
2024-11-07 03:56:52 - progress_bar.py[line:274] - INFO: epoch 021:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17539.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3190.4, ups=0.18, wpb=17539.5, bsz=1024, num_updates=8100, lr=4.21723e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=51330
2024-11-07 03:57:44 - progress_bar.py[line:274] - INFO: epoch 021:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17770.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3408.5, ups=0.19, wpb=17770.4, bsz=1024, num_updates=8110, lr=4.21587e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=51383
2024-11-07 03:58:36 - progress_bar.py[line:274] - INFO: epoch 021:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=18401.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3502.4, ups=0.19, wpb=18401.5, bsz=1024, num_updates=8120, lr=4.21451e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51435
2024-11-07 03:59:29 - progress_bar.py[line:274] - INFO: epoch 021:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=18292.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3466.9, ups=0.19, wpb=18292.9, bsz=1024, num_updates=8130, lr=4.21315e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=51488
2024-11-07 04:00:21 - progress_bar.py[line:274] - INFO: epoch 021:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17986.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3445.7, ups=0.19, wpb=17986.6, bsz=1024, num_updates=8140, lr=4.21179e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51540
2024-11-07 04:01:14 - progress_bar.py[line:274] - INFO: epoch 021:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18082.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3441.3, ups=0.19, wpb=18082.3, bsz=1024, num_updates=8150, lr=4.21043e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51593
2024-11-07 04:02:06 - progress_bar.py[line:274] - INFO: epoch 021:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=18036.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3459, ups=0.19, wpb=18036.5, bsz=1024, num_updates=8160, lr=4.20907e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=51645
2024-11-07 04:02:58 - progress_bar.py[line:274] - INFO: epoch 021:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=18647.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3569.4, ups=0.19, wpb=18647.4, bsz=1024, num_updates=8170, lr=4.20771e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51697
2024-11-07 04:03:50 - progress_bar.py[line:274] - INFO: epoch 021:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18084.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3469.2, ups=0.19, wpb=18084.3, bsz=1024, num_updates=8180, lr=4.20634e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51749
2024-11-07 04:04:42 - progress_bar.py[line:274] - INFO: epoch 021:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=18269.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3516.1, ups=0.19, wpb=18269.1, bsz=1024, num_updates=8190, lr=4.20498e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=51801
2024-11-07 04:05:35 - progress_bar.py[line:274] - INFO: epoch 021:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18061.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3398.9, ups=0.19, wpb=18061.3, bsz=1024, num_updates=8200, lr=4.20362e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=51854
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt


2024-11-07 04:06:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 21 @ 8206 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
2024-11-07 04:06:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 04:07:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 04:09:46 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 21 @ 8206 updates, score 0) (writing took 222.484497611993 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-07 04:10:40 - train.py[line:336] - INFO: end of epoch 21 (average epoch stats below)
2024-11-07 04:10:40 - progress_bar.py[line:282] - INFO: epoch 021 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.544 | ntokens 17834.7 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.83 | wps 2776.2 | ups 0.16 | wpb 17834.7 | bsz 1023 | num_updates 8206 | lr 4.20281e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1728 | gb_free 13.3 | wall 52159
2024-11-07 04:10:40 - trainer.py[line:639] - INFO: loading train data for epoch 22
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 04:13:19 - trainer.py[line:703] - INFO: begin training epoch 22
2024-11-07 04:13:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 04:13:42 - progress_bar.py[line:274] - INFO: epoch 022:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=16992.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=349.1, ups=0.02, wpb=16992.6, bsz=985.6, num_updates=8210, lr=4.20226e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=40, gb_free=13.5, wall=52341
2024-11-07 04:14:34 - progress_bar.py[line:274] - INFO: epoch 022:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17556, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3388.5, ups=0.19, wpb=17556, bsz=1024, num_updates=8220, lr=4.2009e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=52393
2024-11-07 04:15:26 - progress_bar.py[line:274] - INFO: epoch 022:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17691.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3389.7, ups=0.19, wpb=17691.6, bsz=1024, num_updates=8230, lr=4.19954e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=52445
2024-11-07 04:16:18 - progress_bar.py[line:274] - INFO: epoch 022:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=18134, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3499.2, ups=0.19, wpb=18134, bsz=1024, num_updates=8240, lr=4.19818e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=52497
2024-11-07 04:17:11 - progress_bar.py[line:274] - INFO: epoch 022:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3298.3, ups=0.19, wpb=17393.3, bsz=1024, num_updates=8250, lr=4.19682e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=52550
2024-11-07 04:17:47 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 04:18:08 - progress_bar.py[line:274] - INFO: epoch 022:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17768.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3090.5, ups=0.17, wpb=17768.8, bsz=1024, num_updates=8260, lr=4.19546e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=52607
2024-11-07 04:19:00 - progress_bar.py[line:274] - INFO: epoch 022:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17524.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3401.7, ups=0.19, wpb=17524.3, bsz=1024, num_updates=8270, lr=4.1941e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=52659
2024-11-07 04:19:52 - progress_bar.py[line:274] - INFO: epoch 022:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17798.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3389.6, ups=0.19, wpb=17798.3, bsz=1024, num_updates=8280, lr=4.19274e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=52711
2024-11-07 04:20:45 - progress_bar.py[line:274] - INFO: epoch 022:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17672.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3353.1, ups=0.19, wpb=17672.6, bsz=1024, num_updates=8290, lr=4.19138e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=52764
2024-11-07 04:21:38 - progress_bar.py[line:274] - INFO: epoch 022:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17805, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3366.3, ups=0.19, wpb=17805, bsz=1024, num_updates=8300, lr=4.19002e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=52817
2024-11-07 04:22:30 - progress_bar.py[line:274] - INFO: epoch 022:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17598.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3381.8, ups=0.19, wpb=17598.8, bsz=1024, num_updates=8310, lr=4.18866e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=52869
2024-11-07 04:23:22 - progress_bar.py[line:274] - INFO: epoch 022:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=17426.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3305.8, ups=0.19, wpb=17426.2, bsz=1024, num_updates=8320, lr=4.1873e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=52921
2024-11-07 04:24:17 - progress_bar.py[line:274] - INFO: epoch 022:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.501, ntokens=17847.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3252.9, ups=0.18, wpb=17847.9, bsz=1024, num_updates=8330, lr=4.18594e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=37, gb_free=13.5, wall=52976
2024-11-07 04:25:13 - progress_bar.py[line:274] - INFO: epoch 022:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=17650.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3180.7, ups=0.18, wpb=17650.2, bsz=1024, num_updates=8340, lr=4.18458e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=53032
2024-11-07 04:26:09 - progress_bar.py[line:274] - INFO: epoch 022:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=18026, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3228.7, ups=0.18, wpb=18026, bsz=1024, num_updates=8350, lr=4.18322e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=53088
2024-11-07 04:27:04 - progress_bar.py[line:274] - INFO: epoch 022:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17386.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3165.2, ups=0.18, wpb=17386.6, bsz=1024, num_updates=8360, lr=4.18186e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=53143
2024-11-07 04:28:00 - progress_bar.py[line:274] - INFO: epoch 022:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17676.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3157.9, ups=0.18, wpb=17676.5, bsz=1024, num_updates=8370, lr=4.1805e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.6, wall=53198
2024-11-07 04:28:55 - progress_bar.py[line:274] - INFO: epoch 022:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17877.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3212.7, ups=0.18, wpb=17877.9, bsz=1024, num_updates=8380, lr=4.17914e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=53254
2024-11-07 04:29:51 - progress_bar.py[line:274] - INFO: epoch 022:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17543.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3150.2, ups=0.18, wpb=17543.7, bsz=1024, num_updates=8390, lr=4.17778e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=44, gb_free=13.6, wall=53310
2024-11-07 04:30:47 - progress_bar.py[line:274] - INFO: epoch 022:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3074.8, ups=0.18, wpb=17333.1, bsz=1024, num_updates=8400, lr=4.17642e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.6, wall=53366
2024-11-07 04:31:43 - progress_bar.py[line:274] - INFO: epoch 022:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=18074.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3266.7, ups=0.18, wpb=18074.9, bsz=1024, num_updates=8410, lr=4.17506e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=42, gb_free=13.5, wall=53422
2024-11-07 04:32:45 - progress_bar.py[line:274] - INFO: epoch 022:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17863.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=2845.1, ups=0.16, wpb=17863.2, bsz=1024, num_updates=8420, lr=4.1737e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.6, wall=53484
2024-11-07 04:33:52 - progress_bar.py[line:274] - INFO: epoch 022:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17708.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=2676.7, ups=0.15, wpb=17708.1, bsz=1024, num_updates=8430, lr=4.17233e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=66, gb_free=13.5, wall=53550
2024-11-07 04:34:58 - progress_bar.py[line:274] - INFO: epoch 022:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=17835.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=2697.8, ups=0.15, wpb=17835.7, bsz=1024, num_updates=8440, lr=4.17097e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=66, gb_free=13.4, wall=53617
2024-11-07 04:36:04 - progress_bar.py[line:274] - INFO: epoch 022:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17332.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=2613.6, ups=0.15, wpb=17332.5, bsz=1024, num_updates=8450, lr=4.16961e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=66, gb_free=13.6, wall=53683
2024-11-07 04:36:55 - progress_bar.py[line:274] - INFO: epoch 022:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.509, ntokens=17796.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3469.6, ups=0.19, wpb=17796.6, bsz=1024, num_updates=8460, lr=4.16825e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=53734
2024-11-07 04:37:48 - progress_bar.py[line:274] - INFO: epoch 022:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17883.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3403.8, ups=0.19, wpb=17883.6, bsz=1024, num_updates=8470, lr=4.16689e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=53787
2024-11-07 04:38:41 - progress_bar.py[line:274] - INFO: epoch 022:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17876.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3359.8, ups=0.19, wpb=17876.5, bsz=1024, num_updates=8480, lr=4.16553e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53840
2024-11-07 04:39:34 - progress_bar.py[line:274] - INFO: epoch 022:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17737.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3355.6, ups=0.19, wpb=17737.5, bsz=1024, num_updates=8490, lr=4.16417e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53893
2024-11-07 04:40:26 - progress_bar.py[line:274] - INFO: epoch 022:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17731.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3405.2, ups=0.19, wpb=17731.4, bsz=1024, num_updates=8500, lr=4.16281e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=53945
2024-11-07 04:41:22 - progress_bar.py[line:274] - INFO: epoch 022:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18356.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3287, ups=0.18, wpb=18356.2, bsz=1024, num_updates=8510, lr=4.16145e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=54001
2024-11-07 04:42:15 - progress_bar.py[line:274] - INFO: epoch 022:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=18555.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3490.7, ups=0.19, wpb=18555.4, bsz=1024, num_updates=8520, lr=4.16009e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54054
2024-11-07 04:43:08 - progress_bar.py[line:274] - INFO: epoch 022:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=18175.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3445.2, ups=0.19, wpb=18175.4, bsz=1024, num_updates=8530, lr=4.15873e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54107
2024-11-07 04:44:01 - progress_bar.py[line:274] - INFO: epoch 022:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17985.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3374.3, ups=0.19, wpb=17985.8, bsz=1024, num_updates=8540, lr=4.15737e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=54160
2024-11-07 04:44:54 - progress_bar.py[line:274] - INFO: epoch 022:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=18040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3383.9, ups=0.19, wpb=18040.3, bsz=1024, num_updates=8550, lr=4.15601e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54213
2024-11-07 04:45:47 - progress_bar.py[line:274] - INFO: epoch 022:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=18614.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3519.1, ups=0.19, wpb=18614.7, bsz=1024, num_updates=8560, lr=4.15465e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54266
2024-11-07 04:46:41 - progress_bar.py[line:274] - INFO: epoch 022:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=18154, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3402.2, ups=0.19, wpb=18154, bsz=1024, num_updates=8570, lr=4.15329e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=54320
2024-11-07 04:47:34 - progress_bar.py[line:274] - INFO: epoch 022:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=18234.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3436.1, ups=0.19, wpb=18234.4, bsz=1024, num_updates=8580, lr=4.15193e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=54373
2024-11-07 04:48:27 - progress_bar.py[line:274] - INFO: epoch 022:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=18153.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3434.1, ups=0.19, wpb=18153.1, bsz=1024, num_updates=8590, lr=4.15057e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=54425
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 04:48:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 22 @ 8596 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
2024-11-07 04:48:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 04:50:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 04:52:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 22 @ 8596 updates, score 0) (writing took 223.02192327100784 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 04:53:32 - train.py[line:336] - INFO: end of epoch 22 (average epoch stats below)
2024-11-07 04:53:32 - progress_bar.py[line:282] - INFO: epoch 022 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.523 | ntokens 17823.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.75 | wps 2702.5 | ups 0.15 | wpb 17823.5 | bsz 1023 | num_updates 8596 | lr 4.14975e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1653 | gb_free 13.4 | wall 54731
2024-11-07 04:53:32 - trainer.py[line:639] - INFO: loading train data for epoch 23
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 04:56:15 - trainer.py[line:703] - INFO: begin training epoch 23
2024-11-07 04:56:15 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 04:56:39 - progress_bar.py[line:274] - INFO: epoch 023:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=17311.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=351.8, ups=0.02, wpb=17311.7, bsz=985.6, num_updates=8600, lr=4.14921e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=54918
2024-11-07 04:57:31 - progress_bar.py[line:274] - INFO: epoch 023:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17606.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3344.3, ups=0.19, wpb=17606.5, bsz=1024, num_updates=8610, lr=4.14785e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=54970
2024-11-07 04:58:23 - progress_bar.py[line:274] - INFO: epoch 023:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17645.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.3, ups=0.19, wpb=17645.9, bsz=1024, num_updates=8620, lr=4.14649e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=55022
2024-11-07 04:59:17 - progress_bar.py[line:274] - INFO: epoch 023:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17783.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3294.8, ups=0.19, wpb=17783.2, bsz=1024, num_updates=8630, lr=4.14513e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=39, gb_free=13.4, wall=55076
2024-11-07 05:00:12 - progress_bar.py[line:274] - INFO: epoch 023:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=17734.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3255.6, ups=0.18, wpb=17734.8, bsz=1024, num_updates=8640, lr=4.14377e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=55131
2024-11-07 05:01:06 - progress_bar.py[line:274] - INFO: epoch 023:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3261.2, ups=0.18, wpb=17833.4, bsz=1024, num_updates=8650, lr=4.14241e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=55185
2024-11-07 05:02:01 - progress_bar.py[line:274] - INFO: epoch 023:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17736, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3223.6, ups=0.18, wpb=17736, bsz=1024, num_updates=8660, lr=4.14105e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=55240
2024-11-07 05:02:56 - progress_bar.py[line:274] - INFO: epoch 023:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=17766.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3244, ups=0.18, wpb=17766.2, bsz=1024, num_updates=8670, lr=4.13969e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=55295
2024-11-07 05:03:49 - progress_bar.py[line:274] - INFO: epoch 023:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=17804, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3383.1, ups=0.19, wpb=17804, bsz=1024, num_updates=8680, lr=4.13833e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=55348
2024-11-07 05:04:41 - progress_bar.py[line:274] - INFO: epoch 023:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17586.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.7, ups=0.19, wpb=17586.2, bsz=1024, num_updates=8690, lr=4.13696e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=55400
2024-11-07 05:05:35 - progress_bar.py[line:274] - INFO: epoch 023:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17701.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3271.3, ups=0.18, wpb=17701.1, bsz=1024, num_updates=8700, lr=4.1356e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55454
2024-11-07 05:06:29 - progress_bar.py[line:274] - INFO: epoch 023:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.505, ntokens=17579.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3247.4, ups=0.18, wpb=17579.7, bsz=1024, num_updates=8710, lr=4.13424e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=55508
2024-11-07 05:07:23 - progress_bar.py[line:274] - INFO: epoch 023:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17962.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3339.9, ups=0.19, wpb=17962.2, bsz=1024, num_updates=8720, lr=4.13288e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55562
2024-11-07 05:08:17 - progress_bar.py[line:274] - INFO: epoch 023:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17532.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3225.2, ups=0.18, wpb=17532.8, bsz=1024, num_updates=8730, lr=4.13152e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=55616
2024-11-07 05:09:11 - progress_bar.py[line:274] - INFO: epoch 023:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17612.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3283.5, ups=0.19, wpb=17612.1, bsz=1024, num_updates=8740, lr=4.13016e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=55670
2024-11-07 05:10:04 - progress_bar.py[line:274] - INFO: epoch 023:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17721.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3309.8, ups=0.19, wpb=17721.7, bsz=1024, num_updates=8750, lr=4.1288e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=55723
2024-11-07 05:10:56 - progress_bar.py[line:274] - INFO: epoch 023:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17833.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3437.9, ups=0.19, wpb=17833.4, bsz=1024, num_updates=8760, lr=4.12744e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=55775
2024-11-07 05:11:48 - progress_bar.py[line:274] - INFO: epoch 023:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17770.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3433.9, ups=0.19, wpb=17770.4, bsz=1024, num_updates=8770, lr=4.12608e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=55827
2024-11-07 05:12:39 - progress_bar.py[line:274] - INFO: epoch 023:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17604.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3424.8, ups=0.19, wpb=17604.9, bsz=1024, num_updates=8780, lr=4.12472e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=55878
2024-11-07 05:13:32 - progress_bar.py[line:274] - INFO: epoch 023:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17626.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3343.6, ups=0.19, wpb=17626.3, bsz=1024, num_updates=8790, lr=4.12336e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=55931
2024-11-07 05:14:23 - progress_bar.py[line:274] - INFO: epoch 023:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17997.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3499.3, ups=0.19, wpb=17997.2, bsz=1024, num_updates=8800, lr=4.122e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.6, wall=55982
2024-11-07 05:15:15 - progress_bar.py[line:274] - INFO: epoch 023:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17825.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3438.2, ups=0.19, wpb=17825.3, bsz=1024, num_updates=8810, lr=4.12064e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=56034
2024-11-07 05:16:07 - progress_bar.py[line:274] - INFO: epoch 023:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17427.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3345.9, ups=0.19, wpb=17427.6, bsz=1024, num_updates=8820, lr=4.11928e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=56086
2024-11-07 05:16:59 - progress_bar.py[line:274] - INFO: epoch 023:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17942.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3489.3, ups=0.19, wpb=17942.7, bsz=1024, num_updates=8830, lr=4.11792e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=56138
2024-11-07 05:17:51 - progress_bar.py[line:274] - INFO: epoch 023:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=17166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3282.3, ups=0.19, wpb=17166.3, bsz=1024, num_updates=8840, lr=4.11656e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=56190
2024-11-07 05:18:12 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 05:18:49 - progress_bar.py[line:274] - INFO: epoch 023:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17789.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3059.2, ups=0.17, wpb=17789.9, bsz=1024, num_updates=8850, lr=4.1152e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.3, wall=56248
2024-11-07 05:19:43 - progress_bar.py[line:274] - INFO: epoch 023:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17787.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3332, ups=0.19, wpb=17787.6, bsz=1024, num_updates=8860, lr=4.11384e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=56302
2024-11-07 05:20:35 - progress_bar.py[line:274] - INFO: epoch 023:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17935.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3417.2, ups=0.19, wpb=17935.7, bsz=1024, num_updates=8870, lr=4.11248e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=47, gb_free=13.5, wall=56354
2024-11-07 05:21:28 - progress_bar.py[line:274] - INFO: epoch 023:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17516.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3323.4, ups=0.19, wpb=17516.7, bsz=1024, num_updates=8880, lr=4.11112e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=56407
2024-11-07 05:22:20 - progress_bar.py[line:274] - INFO: epoch 023:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17710.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3411.5, ups=0.19, wpb=17710.8, bsz=1024, num_updates=8890, lr=4.10976e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=56459
2024-11-07 05:23:12 - progress_bar.py[line:274] - INFO: epoch 023:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18292.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3525.1, ups=0.19, wpb=18292.8, bsz=1024, num_updates=8900, lr=4.1084e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=56511
2024-11-07 05:24:04 - progress_bar.py[line:274] - INFO: epoch 023:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=18495.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3513.3, ups=0.19, wpb=18495.3, bsz=1024, num_updates=8910, lr=4.10704e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56563
2024-11-07 05:24:56 - progress_bar.py[line:274] - INFO: epoch 023:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=18161.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3481.6, ups=0.19, wpb=18161.8, bsz=1024, num_updates=8920, lr=4.10568e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56615
2024-11-07 05:25:48 - progress_bar.py[line:274] - INFO: epoch 023:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=18349.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3566, ups=0.19, wpb=18349.6, bsz=1024, num_updates=8930, lr=4.10432e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=56667
2024-11-07 05:26:40 - progress_bar.py[line:274] - INFO: epoch 023:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=18223.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3503.8, ups=0.19, wpb=18223.2, bsz=1024, num_updates=8940, lr=4.10295e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56719
2024-11-07 05:27:32 - progress_bar.py[line:274] - INFO: epoch 023:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=18800.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3575.1, ups=0.19, wpb=18800.1, bsz=1024, num_updates=8950, lr=4.10159e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=56771
2024-11-07 05:28:25 - progress_bar.py[line:274] - INFO: epoch 023:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=18393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3518.2, ups=0.19, wpb=18393.3, bsz=1024, num_updates=8960, lr=4.10023e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56824
2024-11-07 05:29:17 - progress_bar.py[line:274] - INFO: epoch 023:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17908.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3431.3, ups=0.19, wpb=17908.8, bsz=1024, num_updates=8970, lr=4.09887e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=56876
2024-11-07 05:30:09 - progress_bar.py[line:274] - INFO: epoch 023:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18107.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3469.9, ups=0.19, wpb=18107.4, bsz=1024, num_updates=8980, lr=4.09751e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=56928
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 05:30:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 23 @ 8986 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 05:30:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 05:32:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
2024-11-07 05:34:20 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 23 @ 8986 updates, score 0) (writing took 222.71613502601394 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 05:35:22 - train.py[line:336] - INFO: end of epoch 23 (average epoch stats below)
2024-11-07 05:35:22 - progress_bar.py[line:282] - INFO: epoch 023 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.511 | ntokens 17830.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.7 | wps 2770.9 | ups 0.16 | wpb 17830.2 | bsz 1023 | num_updates 8986 | lr 4.0967e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1874 | gb_free 13.3 | wall 57241
2024-11-07 05:35:22 - trainer.py[line:639] - INFO: loading train data for epoch 24
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 05:38:04 - trainer.py[line:703] - INFO: begin training epoch 24
2024-11-07 05:38:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 05:38:29 - progress_bar.py[line:274] - INFO: epoch 024:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.512, ntokens=17100.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=342.2, ups=0.02, wpb=17100.6, bsz=985.6, num_updates=8990, lr=4.09615e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=41, gb_free=13.6, wall=57428
2024-11-07 05:39:22 - progress_bar.py[line:274] - INFO: epoch 024:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17684.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3327, ups=0.19, wpb=17684.8, bsz=1024, num_updates=9000, lr=4.09479e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=57481
2024-11-07 05:40:16 - progress_bar.py[line:274] - INFO: epoch 024:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17837.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3322.6, ups=0.19, wpb=17837.6, bsz=1024, num_updates=9010, lr=4.09343e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=57535
2024-11-07 05:41:09 - progress_bar.py[line:274] - INFO: epoch 024:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17921.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3391.1, ups=0.19, wpb=17921.9, bsz=1024, num_updates=9020, lr=4.09207e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=57587
2024-11-07 05:42:03 - progress_bar.py[line:274] - INFO: epoch 024:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=17808.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3270.4, ups=0.18, wpb=17808.8, bsz=1024, num_updates=9030, lr=4.09071e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=37, gb_free=13.6, wall=57642
2024-11-07 05:43:00 - progress_bar.py[line:274] - INFO: epoch 024:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17455.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3082.3, ups=0.18, wpb=17455.2, bsz=1024, num_updates=9040, lr=4.08935e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=57699
2024-11-07 05:43:54 - progress_bar.py[line:274] - INFO: epoch 024:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17838.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3298.3, ups=0.18, wpb=17838.2, bsz=1024, num_updates=9050, lr=4.08799e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=57753
2024-11-07 05:44:49 - progress_bar.py[line:274] - INFO: epoch 024:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17871.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3213, ups=0.18, wpb=17871.4, bsz=1024, num_updates=9060, lr=4.08663e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=57808
2024-11-07 05:45:44 - progress_bar.py[line:274] - INFO: epoch 024:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17824.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3251.5, ups=0.18, wpb=17824.7, bsz=1024, num_updates=9070, lr=4.08527e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=57863
2024-11-07 05:46:39 - progress_bar.py[line:274] - INFO: epoch 024:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17649.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3223.9, ups=0.18, wpb=17649.2, bsz=1024, num_updates=9080, lr=4.08391e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=57918
2024-11-07 05:47:32 - progress_bar.py[line:274] - INFO: epoch 024:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.481, ntokens=17786.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3348.7, ups=0.19, wpb=17786.2, bsz=1024, num_updates=9090, lr=4.08255e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=57971
2024-11-07 05:48:24 - progress_bar.py[line:274] - INFO: epoch 024:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17381.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3314.2, ups=0.19, wpb=17381.3, bsz=1024, num_updates=9100, lr=4.08119e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58023
2024-11-07 05:49:17 - progress_bar.py[line:274] - INFO: epoch 024:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17658.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3384.7, ups=0.19, wpb=17658.3, bsz=1024, num_updates=9110, lr=4.07983e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58076
2024-11-07 05:50:10 - progress_bar.py[line:274] - INFO: epoch 024:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17456.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3286.8, ups=0.19, wpb=17456.3, bsz=1024, num_updates=9120, lr=4.07847e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=58129
2024-11-07 05:51:02 - progress_bar.py[line:274] - INFO: epoch 024:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17872, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3445.7, ups=0.19, wpb=17872, bsz=1024, num_updates=9130, lr=4.07711e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58181
2024-11-07 05:51:54 - progress_bar.py[line:274] - INFO: epoch 024:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17487.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3313.3, ups=0.19, wpb=17487.6, bsz=1024, num_updates=9140, lr=4.07575e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=58233
2024-11-07 05:52:47 - progress_bar.py[line:274] - INFO: epoch 024:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.485, ntokens=17893.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3411.8, ups=0.19, wpb=17893.4, bsz=1024, num_updates=9150, lr=4.07439e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58286
2024-11-07 05:53:39 - progress_bar.py[line:274] - INFO: epoch 024:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=17663.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3361.2, ups=0.19, wpb=17663.8, bsz=1024, num_updates=9160, lr=4.07303e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=58338
2024-11-07 05:54:32 - progress_bar.py[line:274] - INFO: epoch 024:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17506.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3309.5, ups=0.19, wpb=17506.5, bsz=1024, num_updates=9170, lr=4.07167e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.4, wall=58391
2024-11-07 05:55:25 - progress_bar.py[line:274] - INFO: epoch 024:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17482.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3325.7, ups=0.19, wpb=17482.1, bsz=1024, num_updates=9180, lr=4.07031e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=58444
2024-11-07 05:56:18 - progress_bar.py[line:274] - INFO: epoch 024:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=18053.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3418.2, ups=0.19, wpb=18053.6, bsz=1024, num_updates=9190, lr=4.06894e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=48, gb_free=13.6, wall=58497
2024-11-07 05:57:11 - progress_bar.py[line:274] - INFO: epoch 024:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=18087, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3392.3, ups=0.19, wpb=18087, bsz=1024, num_updates=9200, lr=4.06758e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58550
2024-11-07 05:58:03 - progress_bar.py[line:274] - INFO: epoch 024:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18017.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3443.2, ups=0.19, wpb=18017.8, bsz=1024, num_updates=9210, lr=4.06622e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58602
2024-11-07 05:58:55 - progress_bar.py[line:274] - INFO: epoch 024:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17766.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3437.1, ups=0.19, wpb=17766.6, bsz=1024, num_updates=9220, lr=4.06486e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58654
2024-11-07 05:59:48 - progress_bar.py[line:274] - INFO: epoch 024:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17552.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3338, ups=0.19, wpb=17552.1, bsz=1024, num_updates=9230, lr=4.0635e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58707
2024-11-07 06:00:40 - progress_bar.py[line:274] - INFO: epoch 024:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3342.1, ups=0.19, wpb=17570.6, bsz=1024, num_updates=9240, lr=4.06214e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58759
2024-11-07 06:01:33 - progress_bar.py[line:274] - INFO: epoch 024:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=18045.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3449.2, ups=0.19, wpb=18045.8, bsz=1024, num_updates=9250, lr=4.06078e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=58811
2024-11-07 06:02:24 - progress_bar.py[line:274] - INFO: epoch 024:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17679.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3405.1, ups=0.19, wpb=17679.3, bsz=1024, num_updates=9260, lr=4.05942e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=58863
2024-11-07 06:03:17 - progress_bar.py[line:274] - INFO: epoch 024:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17651.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3342.3, ups=0.19, wpb=17651.9, bsz=1024, num_updates=9270, lr=4.05806e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=45, gb_free=13.6, wall=58916
2024-11-07 06:04:10 - progress_bar.py[line:274] - INFO: epoch 024:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.499, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3327.7, ups=0.19, wpb=17685.5, bsz=1024, num_updates=9280, lr=4.0567e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=58969
2024-11-07 06:05:02 - progress_bar.py[line:274] - INFO: epoch 024:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=18315.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3534.6, ups=0.19, wpb=18315.8, bsz=1024, num_updates=9290, lr=4.05534e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=59021
2024-11-07 06:05:55 - progress_bar.py[line:274] - INFO: epoch 024:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18095.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3441.6, ups=0.19, wpb=18095.4, bsz=1024, num_updates=9300, lr=4.05398e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=59074
2024-11-07 06:06:47 - progress_bar.py[line:274] - INFO: epoch 024:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18242.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3521.2, ups=0.19, wpb=18242.8, bsz=1024, num_updates=9310, lr=4.05262e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=59125
2024-11-07 06:07:39 - progress_bar.py[line:274] - INFO: epoch 024:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=18663.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3538.1, ups=0.19, wpb=18663.3, bsz=1024, num_updates=9320, lr=4.05126e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=59178
2024-11-07 06:08:32 - progress_bar.py[line:274] - INFO: epoch 024:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=18129.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3457.3, ups=0.19, wpb=18129.8, bsz=1024, num_updates=9330, lr=4.0499e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=59231
2024-11-07 06:09:24 - progress_bar.py[line:274] - INFO: epoch 024:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=18563.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3578.5, ups=0.19, wpb=18563.8, bsz=1024, num_updates=9340, lr=4.04854e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.2, wall=59283
2024-11-07 06:10:16 - progress_bar.py[line:274] - INFO: epoch 024:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=18122.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3436.8, ups=0.19, wpb=18122.9, bsz=1024, num_updates=9350, lr=4.04718e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=59335
2024-11-07 06:11:09 - progress_bar.py[line:274] - INFO: epoch 024:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=18056.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3406.8, ups=0.19, wpb=18056.8, bsz=1024, num_updates=9360, lr=4.04582e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=59388
2024-11-07 06:12:02 - progress_bar.py[line:274] - INFO: epoch 024:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17907.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3433.1, ups=0.19, wpb=17907.9, bsz=1024, num_updates=9370, lr=4.04446e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=59440
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt2024-11-07 06:12:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 24 @ 9377 updates


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-07 06:12:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 06:14:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 06:16:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 24 @ 9377 updates, score 0) (writing took 217.80983646999812 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 06:17:07 - train.py[line:336] - INFO: end of epoch 24 (average epoch stats below)
2024-11-07 06:17:07 - progress_bar.py[line:282] - INFO: epoch 024 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.505 | ntokens 17837.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.68 | wps 2784.1 | ups 0.16 | wpb 17837.7 | bsz 1023 | num_updates 9377 | lr 4.04351e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1918 | gb_free 13.4 | wall 59746
2024-11-07 06:17:07 - trainer.py[line:639] - INFO: loading train data for epoch 25
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 06:19:46 - trainer.py[line:703] - INFO: begin training epoch 25
2024-11-07 06:19:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 06:20:04 - progress_bar.py[line:274] - INFO: epoch 025:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17337.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=359.4, ups=0.02, wpb=17337.4, bsz=985.6, num_updates=9380, lr=4.0431e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=42, gb_free=13.6, wall=59923
2024-11-07 06:20:56 - progress_bar.py[line:274] - INFO: epoch 025:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17519.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3357.4, ups=0.19, wpb=17519.7, bsz=1024, num_updates=9390, lr=4.04174e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=59975
2024-11-07 06:21:50 - progress_bar.py[line:274] - INFO: epoch 025:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17852.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3344.3, ups=0.19, wpb=17852.8, bsz=1024, num_updates=9400, lr=4.04038e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60028
2024-11-07 06:22:42 - progress_bar.py[line:274] - INFO: epoch 025:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17961.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3439.1, ups=0.19, wpb=17961.6, bsz=1024, num_updates=9410, lr=4.03902e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60081
2024-11-07 06:23:34 - progress_bar.py[line:274] - INFO: epoch 025:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17522.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3347, ups=0.19, wpb=17522.3, bsz=1024, num_updates=9420, lr=4.03766e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60133
2024-11-07 06:24:26 - progress_bar.py[line:274] - INFO: epoch 025:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17646, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3393.5, ups=0.19, wpb=17646, bsz=1024, num_updates=9430, lr=4.0363e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60185
2024-11-07 06:25:18 - progress_bar.py[line:274] - INFO: epoch 025:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=18090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3462.3, ups=0.19, wpb=18090.1, bsz=1024, num_updates=9440, lr=4.03493e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60237
2024-11-07 06:26:11 - progress_bar.py[line:274] - INFO: epoch 025:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.453, ntokens=17496.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3314.3, ups=0.19, wpb=17496.1, bsz=1024, num_updates=9450, lr=4.03357e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60290
2024-11-07 06:27:05 - progress_bar.py[line:274] - INFO: epoch 025:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17600.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3291.6, ups=0.19, wpb=17600.9, bsz=1024, num_updates=9460, lr=4.03221e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60343
2024-11-07 06:27:57 - progress_bar.py[line:274] - INFO: epoch 025:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17612.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3361.7, ups=0.19, wpb=17612.7, bsz=1024, num_updates=9470, lr=4.03085e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60396
2024-11-07 06:28:50 - progress_bar.py[line:274] - INFO: epoch 025:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17585.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3341.7, ups=0.19, wpb=17585.5, bsz=1024, num_updates=9480, lr=4.02949e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60449
2024-11-07 06:29:42 - progress_bar.py[line:274] - INFO: epoch 025:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17500.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3315.6, ups=0.19, wpb=17500.3, bsz=1024, num_updates=9490, lr=4.02813e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60501
2024-11-07 06:30:37 - progress_bar.py[line:274] - INFO: epoch 025:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17844.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3267.2, ups=0.18, wpb=17844.5, bsz=1024, num_updates=9500, lr=4.02677e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=60556
2024-11-07 06:31:35 - progress_bar.py[line:274] - INFO: epoch 025:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.5, ntokens=17742.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3083.9, ups=0.17, wpb=17742.7, bsz=1024, num_updates=9510, lr=4.02541e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=60613
2024-11-07 06:32:29 - progress_bar.py[line:274] - INFO: epoch 025:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17698.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3236.4, ups=0.18, wpb=17698.8, bsz=1024, num_updates=9520, lr=4.02405e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=60668
2024-11-07 06:33:21 - progress_bar.py[line:274] - INFO: epoch 025:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17569.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3381.2, ups=0.19, wpb=17569.1, bsz=1024, num_updates=9530, lr=4.02269e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=60720
2024-11-07 06:34:14 - progress_bar.py[line:274] - INFO: epoch 025:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17429.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3282.5, ups=0.19, wpb=17429.7, bsz=1024, num_updates=9540, lr=4.02133e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=60773
2024-11-07 06:35:10 - progress_bar.py[line:274] - INFO: epoch 025:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17728.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3185.3, ups=0.18, wpb=17728.7, bsz=1024, num_updates=9550, lr=4.01997e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=60829
2024-11-07 06:36:05 - progress_bar.py[line:274] - INFO: epoch 025:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17519.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3172.9, ups=0.18, wpb=17519.8, bsz=1024, num_updates=9560, lr=4.01861e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=60884
2024-11-07 06:36:57 - progress_bar.py[line:274] - INFO: epoch 025:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.514, ntokens=17907.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3442.9, ups=0.19, wpb=17907.1, bsz=1024, num_updates=9570, lr=4.01725e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=60936
2024-11-07 06:37:49 - progress_bar.py[line:274] - INFO: epoch 025:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.471, ntokens=17720.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3436.3, ups=0.19, wpb=17720.5, bsz=1024, num_updates=9580, lr=4.01589e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=42, gb_free=13.5, wall=60988
2024-11-07 06:38:41 - progress_bar.py[line:274] - INFO: epoch 025:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.483, ntokens=17981.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3459, ups=0.19, wpb=17981.7, bsz=1024, num_updates=9590, lr=4.01453e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.6, wall=61040
2024-11-07 06:39:34 - progress_bar.py[line:274] - INFO: epoch 025:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3272.9, ups=0.19, wpb=17513.9, bsz=1024, num_updates=9600, lr=4.01317e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61093
2024-11-07 06:40:26 - progress_bar.py[line:274] - INFO: epoch 025:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17692.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3405.4, ups=0.19, wpb=17692.8, bsz=1024, num_updates=9610, lr=4.01181e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=61145
2024-11-07 06:41:19 - progress_bar.py[line:274] - INFO: epoch 025:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17537, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3340.1, ups=0.19, wpb=17537, bsz=1024, num_updates=9620, lr=4.01045e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=61198
2024-11-07 06:42:12 - progress_bar.py[line:274] - INFO: epoch 025:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=17396.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3247.4, ups=0.19, wpb=17396.5, bsz=1024, num_updates=9630, lr=4.00909e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=61251
2024-11-07 06:43:04 - progress_bar.py[line:274] - INFO: epoch 025:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17555.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3385.2, ups=0.19, wpb=17555.8, bsz=1024, num_updates=9640, lr=4.00773e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61303
2024-11-07 06:43:57 - progress_bar.py[line:274] - INFO: epoch 025:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=17808.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3392.6, ups=0.19, wpb=17808.3, bsz=1024, num_updates=9650, lr=4.00637e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=61356
2024-11-07 06:44:49 - progress_bar.py[line:274] - INFO: epoch 025:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.421, ntokens=17301.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3283.2, ups=0.19, wpb=17301.5, bsz=1024, num_updates=9660, lr=4.00501e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=61408
2024-11-07 06:45:41 - progress_bar.py[line:274] - INFO: epoch 025:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17540.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3380.7, ups=0.19, wpb=17540.3, bsz=1024, num_updates=9670, lr=4.00365e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=61460
2024-11-07 06:46:32 - progress_bar.py[line:274] - INFO: epoch 025:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18161.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3555.5, ups=0.2, wpb=18161.7, bsz=1024, num_updates=9680, lr=4.00229e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=61511
2024-11-07 06:47:25 - progress_bar.py[line:274] - INFO: epoch 025:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=18148.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3451.9, ups=0.19, wpb=18148.4, bsz=1024, num_updates=9690, lr=4.00093e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=61564
2024-11-07 06:48:17 - progress_bar.py[line:274] - INFO: epoch 025:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=18133.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3477, ups=0.19, wpb=18133.7, bsz=1024, num_updates=9700, lr=3.99956e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.4, wall=61616
2024-11-07 06:49:09 - progress_bar.py[line:274] - INFO: epoch 025:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=18519.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3556.1, ups=0.19, wpb=18519.8, bsz=1024, num_updates=9710, lr=3.9982e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=45, gb_free=13.1, wall=61668
2024-11-07 06:50:02 - progress_bar.py[line:274] - INFO: epoch 025:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=18058.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3438.2, ups=0.19, wpb=18058.3, bsz=1024, num_updates=9720, lr=3.99684e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=61721
2024-11-07 06:50:54 - progress_bar.py[line:274] - INFO: epoch 025:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18580.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3539.1, ups=0.19, wpb=18580.1, bsz=1024, num_updates=9730, lr=3.99548e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=61773
2024-11-07 06:50:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 06:51:51 - progress_bar.py[line:274] - INFO: epoch 025:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.51, ntokens=17803.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3112, ups=0.17, wpb=17803.6, bsz=1024, num_updates=9740, lr=3.99412e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=61830
2024-11-07 06:52:44 - progress_bar.py[line:274] - INFO: epoch 025:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=17919.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3411.5, ups=0.19, wpb=17919.6, bsz=1024, num_updates=9750, lr=3.99276e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=61883
2024-11-07 06:53:36 - progress_bar.py[line:274] - INFO: epoch 025:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=18243.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3481.9, ups=0.19, wpb=18243.9, bsz=1024, num_updates=9760, lr=3.9914e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=61935
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
2024-11-07 06:54:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 25 @ 9767 updates
2024-11-07 06:54:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 06:55:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 06:57:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 25 @ 9767 updates, score 0) (writing took 221.21820808498887 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 06:58:45 - train.py[line:336] - INFO: end of epoch 25 (average epoch stats below)
2024-11-07 06:58:45 - progress_bar.py[line:282] - INFO: epoch 025 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.49 | ntokens 17758.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.62 | wps 2772.4 | ups 0.16 | wpb 17758.8 | bsz 1023 | num_updates 9767 | lr 3.99045e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1419 | gb_free 13.4 | wall 62244
2024-11-07 06:58:45 - trainer.py[line:639] - INFO: loading train data for epoch 26
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 07:01:25 - trainer.py[line:703] - INFO: begin training epoch 26
2024-11-07 07:01:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 07:01:42 - progress_bar.py[line:274] - INFO: epoch 026:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=17355.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=357, ups=0.02, wpb=17355.6, bsz=985.6, num_updates=9770, lr=3.99004e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=62421
2024-11-07 07:02:35 - progress_bar.py[line:274] - INFO: epoch 026:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17687.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3349.8, ups=0.19, wpb=17687.4, bsz=1024, num_updates=9780, lr=3.98868e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62474
2024-11-07 07:03:28 - progress_bar.py[line:274] - INFO: epoch 026:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17679.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3369.5, ups=0.19, wpb=17679.3, bsz=1024, num_updates=9790, lr=3.98732e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=62527
2024-11-07 07:04:20 - progress_bar.py[line:274] - INFO: epoch 026:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3389.8, ups=0.19, wpb=17685.5, bsz=1024, num_updates=9800, lr=3.98596e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62579
2024-11-07 07:05:12 - progress_bar.py[line:274] - INFO: epoch 026:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.489, ntokens=17888.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3432, ups=0.19, wpb=17888.7, bsz=1024, num_updates=9810, lr=3.9846e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62631
2024-11-07 07:06:05 - progress_bar.py[line:274] - INFO: epoch 026:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17617.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3356, ups=0.19, wpb=17617.3, bsz=1024, num_updates=9820, lr=3.98324e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62683
2024-11-07 07:06:57 - progress_bar.py[line:274] - INFO: epoch 026:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17884.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3410.6, ups=0.19, wpb=17884.5, bsz=1024, num_updates=9830, lr=3.98188e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62736
2024-11-07 07:07:50 - progress_bar.py[line:274] - INFO: epoch 026:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17813.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3372, ups=0.19, wpb=17813.7, bsz=1024, num_updates=9840, lr=3.98052e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62789
2024-11-07 07:08:43 - progress_bar.py[line:274] - INFO: epoch 026:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17806.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3315.3, ups=0.19, wpb=17806.8, bsz=1024, num_updates=9850, lr=3.97916e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62842
2024-11-07 07:09:39 - progress_bar.py[line:274] - INFO: epoch 026:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17563.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3137.3, ups=0.18, wpb=17563.4, bsz=1024, num_updates=9860, lr=3.9778e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=62898
2024-11-07 07:10:32 - progress_bar.py[line:274] - INFO: epoch 026:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17612.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3384.9, ups=0.19, wpb=17612.2, bsz=1024, num_updates=9870, lr=3.97644e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=62950
2024-11-07 07:11:23 - progress_bar.py[line:274] - INFO: epoch 026:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17468.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3361.4, ups=0.19, wpb=17468.5, bsz=1024, num_updates=9880, lr=3.97508e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63002
2024-11-07 07:12:18 - progress_bar.py[line:274] - INFO: epoch 026:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17679, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3229.8, ups=0.18, wpb=17679, bsz=1024, num_updates=9890, lr=3.97372e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=63057
2024-11-07 07:13:14 - progress_bar.py[line:274] - INFO: epoch 026:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17636.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3163.7, ups=0.18, wpb=17636.7, bsz=1024, num_updates=9900, lr=3.97236e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=63113
2024-11-07 07:14:06 - progress_bar.py[line:274] - INFO: epoch 026:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17510.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3336.3, ups=0.19, wpb=17510.7, bsz=1024, num_updates=9910, lr=3.971e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63165
2024-11-07 07:14:59 - progress_bar.py[line:274] - INFO: epoch 026:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17683.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3334.4, ups=0.19, wpb=17683.3, bsz=1024, num_updates=9920, lr=3.96964e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=63218
2024-11-07 07:15:52 - progress_bar.py[line:274] - INFO: epoch 026:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17434.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3350.7, ups=0.19, wpb=17434.3, bsz=1024, num_updates=9930, lr=3.96828e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63270
2024-11-07 07:16:44 - progress_bar.py[line:274] - INFO: epoch 026:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17981.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3445.7, ups=0.19, wpb=17981.3, bsz=1024, num_updates=9940, lr=3.96692e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=63323
2024-11-07 07:17:38 - progress_bar.py[line:274] - INFO: epoch 026:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17613, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3225.4, ups=0.18, wpb=17613, bsz=1024, num_updates=9950, lr=3.96555e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=63377
2024-11-07 07:18:32 - progress_bar.py[line:274] - INFO: epoch 026:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=17806.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3330.5, ups=0.19, wpb=17806.2, bsz=1024, num_updates=9960, lr=3.96419e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=63431
2024-11-07 07:19:24 - progress_bar.py[line:274] - INFO: epoch 026:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.49, ntokens=17994.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3458.7, ups=0.19, wpb=17994.9, bsz=1024, num_updates=9970, lr=3.96283e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63483
2024-11-07 07:20:16 - progress_bar.py[line:274] - INFO: epoch 026:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17957.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3428.7, ups=0.19, wpb=17957.3, bsz=1024, num_updates=9980, lr=3.96147e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=63535
2024-11-07 07:21:11 - progress_bar.py[line:274] - INFO: epoch 026:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3278.7, ups=0.18, wpb=17828, bsz=1024, num_updates=9990, lr=3.96011e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=63589
2024-11-07 07:22:03 - progress_bar.py[line:274] - INFO: epoch 026:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17835, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3410, ups=0.19, wpb=17835, bsz=1024, num_updates=10000, lr=3.95875e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=63642
loss_reg: 0.005072457349734271 loss_cls: 0.0029850576538592577
loss_reg: 0.011574835184792593 loss_cls: 0.003301245393231511
loss_reg: 0.01806650845530307 loss_cls: 0.0028240042738616467
loss_reg: 0.012605174076533759 loss_cls: 0.003352748230099678
loss_reg: 0.018765818374008952 loss_cls: 0.003354056039825082
loss_reg: 0.006726486582906949 loss_cls: 0.0026976405642926693
loss_reg: 0.023671384557910072 loss_cls: 0.003688663709908724
loss_reg: 0.017193558134857616 loss_cls: 0.004349737428128719
loss_reg: 0.020649800006708817 loss_cls: 0.004239168483763933
loss_reg: 0.017635722727165994 loss_cls: 0.004073155578225851
loss_reg: 0.015941459556420307 loss_cls: 0.00382440909743309
loss_reg: 0.003092497793174779 loss_cls: 0.0025461153127253056
loss_reg: 0.010132632506271406 loss_cls: 0.0031686476431787014
loss_reg: 0.013024612628201763 loss_cls: 0.003592904657125473
loss_reg: 0.018866784788445022 loss_cls: 0.002823794260621071
loss_reg: 0.01610965090049986 loss_cls: 0.003522136015817523
loss_reg: 0.020264873564619153 loss_cls: 0.0030317187774926424
loss_reg: 0.012803599459763733 loss_cls: 0.0025839530862867832
loss_reg: 0.016515906738524475 loss_cls: 0.0024925819598138332
loss_reg: 0.0048059882839326246 loss_cls: 0.003466129070147872
loss_reg: 0.009767073852577052 loss_cls: 0.0030016815289855003
loss_reg: 0.015327750020412412 loss_cls: 0.004330474883317947
loss_reg: 0.022377223969332238 loss_cls: 0.004033925477415323
loss_reg: 0.019587593694097315 loss_cls: 0.002701906720176339
loss_reg: 0.020255689766306834 loss_cls: 0.003601281438022852
loss_reg: 0.014188317141174078 loss_cls: 0.004078863188624382
loss_reg: 0.00400660483965813 loss_cls: 0.002314819023013115
loss_reg: 0.01518792842477173 loss_cls: 0.0034420606680214405
loss_reg: 0.02101943739668691 loss_cls: 0.004031266551464796
loss_reg: 0.018474877659499324 loss_cls: 0.003058665432035923
loss_reg: 0.010148546074884055 loss_cls: 0.0028529323171824217
loss_reg: 0.014291745239295453 loss_cls: 0.0028770584613084793
loss_reg: 0.012876515068350015 loss_cls: 0.0031052157282829285
loss_reg: 0.002574398349857977 loss_cls: 0.0026204001624137163
loss_reg: 0.010619121191212381 loss_cls: 0.0031315633095800877
loss_reg: 0.011285099152285321 loss_cls: 0.003931376151740551
loss_reg: 0.013464573752272928 loss_cls: 0.0040021175518631935
loss_reg: 0.007731428875924249 loss_cls: 0.0033343788236379623
loss_reg: 0.011449482697426768 loss_cls: 0.003489007242023945
loss_reg: 0.014254637760358862 loss_cls: 0.0030181719921529293
loss_reg: 0.005651881569730247 loss_cls: 0.002793073421344161
loss_reg: 0.02171674839962207 loss_cls: 0.003650813363492489
loss_reg: 0.012549379904845216 loss_cls: 0.003618222661316395
loss_reg: 0.012603569846935652 loss_cls: 0.005365218501538038
loss_reg: 0.009510106913334242 loss_cls: 0.003541261423379183
loss_reg: 0.01579545287692194 loss_cls: 0.004597025457769632
loss_reg: 0.014157939663628766 loss_cls: 0.0025651913601905107
loss_reg: 0.011169865904173102 loss_cls: 0.002962418831884861
loss_reg: 0.0037872292290399108 loss_cls: 0.0028251672629266977
loss_reg: 0.019161269465257803 loss_cls: 0.004639727063477039
loss_reg: 0.01323476787555892 loss_cls: 0.004171007312834263
loss_reg: 0.024624168119753237 loss_cls: 0.003858195850625634
loss_reg: 0.011137786480519232 loss_cls: 0.004299917723983526
loss_reg: 0.009535568253668027 loss_cls: 0.0034535862505435944
loss_reg: 0.021431152143581832 loss_cls: 0.0034742269199341536
loss_reg: 0.011526694225963242 loss_cls: 0.004021471366286278
loss_reg: 0.005006155194671892 loss_cls: 0.003943929448723793
loss_reg: 0.018863963371590194 loss_cls: 0.003208993235602975
loss_reg: 0.020406717043124866 loss_cls: 0.0031902615446597338
loss_reg: 0.008540935542405419 loss_cls: 0.003262000158429146
loss_reg: 0.016971099352354958 loss_cls: 0.0033526422921568155
loss_reg: 0.012924091531637084 loss_cls: 0.0029463334940373898
loss_reg: 0.013714326172997206 loss_cls: 0.004171769600361586
loss_reg: 0.014725998202935991 loss_cls: 0.003666035132482648
2024-11-07 07:22:56 - progress_bar.py[line:274] - INFO: epoch 026:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.443, ntokens=17575.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3330.6, ups=0.19, wpb=17575.2, bsz=1024, num_updates=10010, lr=3.95739e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=63695
2024-11-07 07:23:47 - progress_bar.py[line:274] - INFO: epoch 026:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17897.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3497.3, ups=0.2, wpb=17897.5, bsz=1024, num_updates=10020, lr=3.95603e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=63746
2024-11-07 07:24:38 - progress_bar.py[line:274] - INFO: epoch 026:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17882.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3494.6, ups=0.2, wpb=17882.1, bsz=1024, num_updates=10030, lr=3.95467e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=48, gb_free=13.5, wall=63797
2024-11-07 07:25:30 - progress_bar.py[line:274] - INFO: epoch 026:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=18033.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3468.1, ups=0.19, wpb=18033.8, bsz=1024, num_updates=10040, lr=3.95331e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=44, gb_free=13.5, wall=63849
2024-11-07 07:26:22 - progress_bar.py[line:274] - INFO: epoch 026:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17667.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3386.7, ups=0.19, wpb=17667.5, bsz=1024, num_updates=10050, lr=3.95195e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=63901
2024-11-07 07:27:15 - progress_bar.py[line:274] - INFO: epoch 026:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17816.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3374.4, ups=0.19, wpb=17816.2, bsz=1024, num_updates=10060, lr=3.95059e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=63954
2024-11-07 07:28:07 - progress_bar.py[line:274] - INFO: epoch 026:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=18317.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3492.7, ups=0.19, wpb=18317.7, bsz=1024, num_updates=10070, lr=3.94923e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=64006
2024-11-07 07:29:00 - progress_bar.py[line:274] - INFO: epoch 026:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=18384.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3508.5, ups=0.19, wpb=18384.9, bsz=1024, num_updates=10080, lr=3.94787e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=64059
2024-11-07 07:29:52 - progress_bar.py[line:274] - INFO: epoch 026:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17889.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3410, ups=0.19, wpb=17889.5, bsz=1024, num_updates=10090, lr=3.94651e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=64111
2024-11-07 07:30:44 - progress_bar.py[line:274] - INFO: epoch 026:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=18294.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3523.3, ups=0.19, wpb=18294.1, bsz=1024, num_updates=10100, lr=3.94515e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.2, wall=64163
2024-11-07 07:31:37 - progress_bar.py[line:274] - INFO: epoch 026:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.497, ntokens=17845.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3371.2, ups=0.19, wpb=17845.6, bsz=1024, num_updates=10110, lr=3.94379e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=64216
2024-11-07 07:32:30 - progress_bar.py[line:274] - INFO: epoch 026:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=18658.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3528.9, ups=0.19, wpb=18658.6, bsz=1024, num_updates=10120, lr=3.94243e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=64269
2024-11-07 07:33:26 - progress_bar.py[line:274] - INFO: epoch 026:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=18331, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3287.1, ups=0.18, wpb=18331, bsz=1024, num_updates=10130, lr=3.94107e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=64325
2024-11-07 07:34:20 - progress_bar.py[line:274] - INFO: epoch 026:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.501, ntokens=17887.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.66, wps=3313, ups=0.19, wpb=17887.5, bsz=1024, num_updates=10140, lr=3.93971e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=64379
2024-11-07 07:35:12 - progress_bar.py[line:274] - INFO: epoch 026:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17957.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3429.9, ups=0.19, wpb=17957.5, bsz=1024, num_updates=10150, lr=3.93835e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=64431
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt2024-11-07 07:35:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 26 @ 10158 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-07 07:35:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 07:37:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-07 07:39:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 26 @ 10158 updates, score 0) (writing took 218.71483593300218 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 07:40:24 - train.py[line:336] - INFO: end of epoch 26 (average epoch stats below)
2024-11-07 07:40:24 - progress_bar.py[line:282] - INFO: epoch 026 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.482 | ntokens 17826.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.59 | wps 2788.8 | ups 0.16 | wpb 17826.4 | bsz 1023 | num_updates 10158 | lr 3.93726e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1799 | gb_free 13.4 | wall 64743
2024-11-07 07:40:24 - trainer.py[line:639] - INFO: loading train data for epoch 27
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 07:43:05 - trainer.py[line:703] - INFO: begin training epoch 27
2024-11-07 07:43:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 07:43:17 - progress_bar.py[line:274] - INFO: epoch 027:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.475, ntokens=17074.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=351.8, ups=0.02, wpb=17074.3, bsz=985.6, num_updates=10160, lr=3.93699e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.5, wall=64916
2024-11-07 07:44:10 - progress_bar.py[line:274] - INFO: epoch 027:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17256.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3257.3, ups=0.19, wpb=17256.5, bsz=1024, num_updates=10170, lr=3.93563e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64969
2024-11-07 07:44:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 07:45:08 - progress_bar.py[line:274] - INFO: epoch 027:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=18026.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3140.9, ups=0.17, wpb=18026.2, bsz=1024, num_updates=10180, lr=3.93427e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=33, gb_free=13.6, wall=65027
2024-11-07 07:46:00 - progress_bar.py[line:274] - INFO: epoch 027:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17900, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3437.9, ups=0.19, wpb=17900, bsz=1024, num_updates=10190, lr=3.93291e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65079
2024-11-07 07:46:52 - progress_bar.py[line:274] - INFO: epoch 027:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.494, ntokens=17914.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3420, ups=0.19, wpb=17914.7, bsz=1024, num_updates=10200, lr=3.93154e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65131
2024-11-07 07:47:45 - progress_bar.py[line:274] - INFO: epoch 027:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.402, ntokens=17459.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3342.4, ups=0.19, wpb=17459.7, bsz=1024, num_updates=10210, lr=3.93018e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65183
2024-11-07 07:48:36 - progress_bar.py[line:274] - INFO: epoch 027:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=18087.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3483, ups=0.19, wpb=18087.4, bsz=1024, num_updates=10220, lr=3.92882e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65235
2024-11-07 07:49:29 - progress_bar.py[line:274] - INFO: epoch 027:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17419.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3314.9, ups=0.19, wpb=17419.5, bsz=1024, num_updates=10230, lr=3.92746e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65288
2024-11-07 07:50:22 - progress_bar.py[line:274] - INFO: epoch 027:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.422, ntokens=17564.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3328.2, ups=0.19, wpb=17564.5, bsz=1024, num_updates=10240, lr=3.9261e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65341
2024-11-07 07:51:15 - progress_bar.py[line:274] - INFO: epoch 027:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17657.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3324.2, ups=0.19, wpb=17657.3, bsz=1024, num_updates=10250, lr=3.92474e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65394
2024-11-07 07:52:08 - progress_bar.py[line:274] - INFO: epoch 027:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.455, ntokens=17711.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3360.9, ups=0.19, wpb=17711.6, bsz=1024, num_updates=10260, lr=3.92338e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65446
2024-11-07 07:53:00 - progress_bar.py[line:274] - INFO: epoch 027:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17576.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3348.4, ups=0.19, wpb=17576.1, bsz=1024, num_updates=10270, lr=3.92202e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65499
2024-11-07 07:53:53 - progress_bar.py[line:274] - INFO: epoch 027:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.459, ntokens=17802.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3366.6, ups=0.19, wpb=17802.5, bsz=1024, num_updates=10280, lr=3.92066e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=65552
2024-11-07 07:54:46 - progress_bar.py[line:274] - INFO: epoch 027:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17535.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3307.8, ups=0.19, wpb=17535.4, bsz=1024, num_updates=10290, lr=3.9193e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65605
2024-11-07 07:55:39 - progress_bar.py[line:274] - INFO: epoch 027:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17737.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3348.2, ups=0.19, wpb=17737.9, bsz=1024, num_updates=10300, lr=3.91794e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65658
2024-11-07 07:56:31 - progress_bar.py[line:274] - INFO: epoch 027:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.484, ntokens=17932.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3422.3, ups=0.19, wpb=17932.7, bsz=1024, num_updates=10310, lr=3.91658e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=65710
2024-11-07 07:57:23 - progress_bar.py[line:274] - INFO: epoch 027:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.464, ntokens=17756.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3409.5, ups=0.19, wpb=17756.9, bsz=1024, num_updates=10320, lr=3.91522e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=65762
2024-11-07 07:58:16 - progress_bar.py[line:274] - INFO: epoch 027:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17557.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3329.9, ups=0.19, wpb=17557.6, bsz=1024, num_updates=10330, lr=3.91386e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65815
2024-11-07 07:59:09 - progress_bar.py[line:274] - INFO: epoch 027:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17668.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3331, ups=0.19, wpb=17668.1, bsz=1024, num_updates=10340, lr=3.9125e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65868
2024-11-07 08:00:02 - progress_bar.py[line:274] - INFO: epoch 027:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17543.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3335.6, ups=0.19, wpb=17543.2, bsz=1024, num_updates=10350, lr=3.91114e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=65921
2024-11-07 08:00:56 - progress_bar.py[line:274] - INFO: epoch 027:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17995.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3349.1, ups=0.19, wpb=17995.7, bsz=1024, num_updates=10360, lr=3.90978e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=65974
2024-11-07 08:01:48 - progress_bar.py[line:274] - INFO: epoch 027:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17953.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3418.4, ups=0.19, wpb=17953.5, bsz=1024, num_updates=10370, lr=3.90842e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=66027
2024-11-07 08:02:40 - progress_bar.py[line:274] - INFO: epoch 027:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17539.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3352.2, ups=0.19, wpb=17539.3, bsz=1024, num_updates=10380, lr=3.90706e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66079
2024-11-07 08:03:34 - progress_bar.py[line:274] - INFO: epoch 027:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17737.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3330.1, ups=0.19, wpb=17737.5, bsz=1024, num_updates=10390, lr=3.9057e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66133
2024-11-07 08:04:26 - progress_bar.py[line:274] - INFO: epoch 027:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.438, ntokens=17444.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3330.9, ups=0.19, wpb=17444.1, bsz=1024, num_updates=10400, lr=3.90434e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=66185
2024-11-07 08:05:19 - progress_bar.py[line:274] - INFO: epoch 027:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17704.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3371.3, ups=0.19, wpb=17704.8, bsz=1024, num_updates=10410, lr=3.90298e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66237
2024-11-07 08:06:11 - progress_bar.py[line:274] - INFO: epoch 027:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17815, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3379.9, ups=0.19, wpb=17815, bsz=1024, num_updates=10420, lr=3.90162e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66290
2024-11-07 08:07:04 - progress_bar.py[line:274] - INFO: epoch 027:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17890.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3383.3, ups=0.19, wpb=17890.8, bsz=1024, num_updates=10430, lr=3.90026e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66343
2024-11-07 08:07:57 - progress_bar.py[line:274] - INFO: epoch 027:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17740.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3333.4, ups=0.19, wpb=17740.1, bsz=1024, num_updates=10440, lr=3.8989e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=66396
2024-11-07 08:08:50 - progress_bar.py[line:274] - INFO: epoch 027:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17689.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3365.7, ups=0.19, wpb=17689.6, bsz=1024, num_updates=10450, lr=3.89753e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=66449
2024-11-07 08:09:42 - progress_bar.py[line:274] - INFO: epoch 027:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.511, ntokens=17971.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.7, wps=3466.1, ups=0.19, wpb=17971.5, bsz=1024, num_updates=10460, lr=3.89617e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66501
2024-11-07 08:10:33 - progress_bar.py[line:274] - INFO: epoch 027:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18229.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3523.5, ups=0.19, wpb=18229.9, bsz=1024, num_updates=10470, lr=3.89481e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66552
2024-11-07 08:11:25 - progress_bar.py[line:274] - INFO: epoch 027:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18031.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3471.8, ups=0.19, wpb=18031.1, bsz=1024, num_updates=10480, lr=3.89345e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66604
2024-11-07 08:12:18 - progress_bar.py[line:274] - INFO: epoch 027:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=18435.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3520.8, ups=0.19, wpb=18435.1, bsz=1024, num_updates=10490, lr=3.89209e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=66657
2024-11-07 08:13:10 - progress_bar.py[line:274] - INFO: epoch 027:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.504, ntokens=17985.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3438.8, ups=0.19, wpb=17985.5, bsz=1024, num_updates=10500, lr=3.89073e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66709
2024-11-07 08:14:02 - progress_bar.py[line:274] - INFO: epoch 027:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=18472.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3562.8, ups=0.19, wpb=18472.1, bsz=1024, num_updates=10510, lr=3.88937e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=66761
2024-11-07 08:14:54 - progress_bar.py[line:274] - INFO: epoch 027:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=18119.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3451.7, ups=0.19, wpb=18119.3, bsz=1024, num_updates=10520, lr=3.88801e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=66813
2024-11-07 08:15:47 - progress_bar.py[line:274] - INFO: epoch 027:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=18171.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3479.5, ups=0.19, wpb=18171.5, bsz=1024, num_updates=10530, lr=3.88665e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66866
2024-11-07 08:16:40 - progress_bar.py[line:274] - INFO: epoch 027:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=18057, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3381.6, ups=0.19, wpb=18057, bsz=1024, num_updates=10540, lr=3.88529e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=35, gb_free=13.5, wall=66919
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 08:17:20 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 27 @ 10548 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
2024-11-07 08:17:20 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt': File exists
: File exists: File exists: File exists

: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 08:19:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000


slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-07 08:20:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 27 @ 10548 updates, score 0) (writing took 217.7570783739793 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
2024-11-07 08:21:52 - train.py[line:336] - INFO: end of epoch 27 (average epoch stats below)
2024-11-07 08:21:52 - progress_bar.py[line:282] - INFO: epoch 027 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.477 | ntokens 17809.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.57 | wps 2792.2 | ups 0.16 | wpb 17809.3 | bsz 1023 | num_updates 10548 | lr 3.8842e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1216 | gb_free 13.3 | wall 67231
2024-11-07 08:21:52 - trainer.py[line:639] - INFO: loading train data for epoch 28
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 08:24:34 - trainer.py[line:703] - INFO: begin training epoch 28
2024-11-07 08:24:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 08:24:47 - progress_bar.py[line:274] - INFO: epoch 028:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=17396.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=357.4, ups=0.02, wpb=17396.6, bsz=985.6, num_updates=10550, lr=3.88393e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=41, gb_free=13.6, wall=67406
2024-11-07 08:25:39 - progress_bar.py[line:274] - INFO: epoch 028:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.44, ntokens=17404.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3307.4, ups=0.19, wpb=17404.9, bsz=1024, num_updates=10560, lr=3.88257e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67458
2024-11-07 08:26:32 - progress_bar.py[line:274] - INFO: epoch 028:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=18166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3448.1, ups=0.19, wpb=18166.3, bsz=1024, num_updates=10570, lr=3.88121e-05, gnorm=0.015, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=67511
2024-11-07 08:27:24 - progress_bar.py[line:274] - INFO: epoch 028:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.397, ntokens=17575.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3360.3, ups=0.19, wpb=17575.4, bsz=1024, num_updates=10580, lr=3.87985e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67563
2024-11-07 08:28:17 - progress_bar.py[line:274] - INFO: epoch 028:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.445, ntokens=17742.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3389.9, ups=0.19, wpb=17742.7, bsz=1024, num_updates=10590, lr=3.87849e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=67616
2024-11-07 08:29:09 - progress_bar.py[line:274] - INFO: epoch 028:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17453.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3321.3, ups=0.19, wpb=17453.4, bsz=1024, num_updates=10600, lr=3.87713e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67668
2024-11-07 08:30:02 - progress_bar.py[line:274] - INFO: epoch 028:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.488, ntokens=18149, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.61, wps=3462.3, ups=0.19, wpb=18149, bsz=1024, num_updates=10610, lr=3.87577e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67721
2024-11-07 08:30:58 - progress_bar.py[line:274] - INFO: epoch 028:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=17813.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3186, ups=0.18, wpb=17813.9, bsz=1024, num_updates=10620, lr=3.87441e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=43, gb_free=13.5, wall=67777
2024-11-07 08:31:51 - progress_bar.py[line:274] - INFO: epoch 028:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3276.8, ups=0.19, wpb=17543.5, bsz=1024, num_updates=10630, lr=3.87305e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=67830
2024-11-07 08:32:43 - progress_bar.py[line:274] - INFO: epoch 028:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17686.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3396.9, ups=0.19, wpb=17686.1, bsz=1024, num_updates=10640, lr=3.87169e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=67882
2024-11-07 08:33:36 - progress_bar.py[line:274] - INFO: epoch 028:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17570.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3358.6, ups=0.19, wpb=17570.1, bsz=1024, num_updates=10650, lr=3.87033e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=67934
2024-11-07 08:34:28 - progress_bar.py[line:274] - INFO: epoch 028:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=17301.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=3312.2, ups=0.19, wpb=17301.4, bsz=1024, num_updates=10660, lr=3.86897e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=46, gb_free=13.6, wall=67987
2024-11-07 08:35:20 - progress_bar.py[line:274] - INFO: epoch 028:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17626.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3391.3, ups=0.19, wpb=17626.6, bsz=1024, num_updates=10670, lr=3.86761e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=68039
2024-11-07 08:36:12 - progress_bar.py[line:274] - INFO: epoch 028:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17526.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3359.5, ups=0.19, wpb=17526.5, bsz=1024, num_updates=10680, lr=3.86625e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=68091
2024-11-07 08:37:04 - progress_bar.py[line:274] - INFO: epoch 028:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17776.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3409.9, ups=0.19, wpb=17776.2, bsz=1024, num_updates=10690, lr=3.86489e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68143
2024-11-07 08:37:57 - progress_bar.py[line:274] - INFO: epoch 028:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17754.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3355.9, ups=0.19, wpb=17754.5, bsz=1024, num_updates=10700, lr=3.86353e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68196
2024-11-07 08:38:49 - progress_bar.py[line:274] - INFO: epoch 028:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17457.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3333.5, ups=0.19, wpb=17457.6, bsz=1024, num_updates=10710, lr=3.86216e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=68248
2024-11-07 08:39:42 - progress_bar.py[line:274] - INFO: epoch 028:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17778.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3388.1, ups=0.19, wpb=17778.6, bsz=1024, num_updates=10720, lr=3.8608e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=68301
2024-11-07 08:40:35 - progress_bar.py[line:274] - INFO: epoch 028:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.451, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3325.3, ups=0.19, wpb=17660.5, bsz=1024, num_updates=10730, lr=3.85944e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68354
2024-11-07 08:41:27 - progress_bar.py[line:274] - INFO: epoch 028:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17879.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3433.9, ups=0.19, wpb=17879.5, bsz=1024, num_updates=10740, lr=3.85808e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=68406
2024-11-07 08:42:22 - progress_bar.py[line:274] - INFO: epoch 028:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=18124, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3296.5, ups=0.18, wpb=18124, bsz=1024, num_updates=10750, lr=3.85672e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=38, gb_free=13.5, wall=68461
2024-11-07 08:43:15 - progress_bar.py[line:274] - INFO: epoch 028:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=18060.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3394.5, ups=0.19, wpb=18060.9, bsz=1024, num_updates=10760, lr=3.85536e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=68514
2024-11-07 08:44:08 - progress_bar.py[line:274] - INFO: epoch 028:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17866.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3403.2, ups=0.19, wpb=17866.3, bsz=1024, num_updates=10770, lr=3.854e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=68567
2024-11-07 08:44:59 - progress_bar.py[line:274] - INFO: epoch 028:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=18005, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3489.6, ups=0.19, wpb=18005, bsz=1024, num_updates=10780, lr=3.85264e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=50, gb_free=13.5, wall=68618
2024-11-07 08:45:51 - progress_bar.py[line:274] - INFO: epoch 028:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17661, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3395, ups=0.19, wpb=17661, bsz=1024, num_updates=10790, lr=3.85128e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=39, gb_free=13.5, wall=68670
2024-11-07 08:46:45 - progress_bar.py[line:274] - INFO: epoch 028:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17537.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3298, ups=0.19, wpb=17537.4, bsz=1024, num_updates=10800, lr=3.84992e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=68723
2024-11-07 08:47:38 - progress_bar.py[line:274] - INFO: epoch 028:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17623.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3313.9, ups=0.19, wpb=17623.5, bsz=1024, num_updates=10810, lr=3.84856e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=68777
2024-11-07 08:48:31 - progress_bar.py[line:274] - INFO: epoch 028:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17943.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3384.3, ups=0.19, wpb=17943.7, bsz=1024, num_updates=10820, lr=3.8472e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68830
2024-11-07 08:49:25 - progress_bar.py[line:274] - INFO: epoch 028:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.438, ntokens=17571.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3260.4, ups=0.19, wpb=17571.4, bsz=1024, num_updates=10830, lr=3.84584e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=68884
2024-11-07 08:50:18 - progress_bar.py[line:274] - INFO: epoch 028:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17632.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3298.2, ups=0.19, wpb=17632.5, bsz=1024, num_updates=10840, lr=3.84448e-05, gnorm=0.015, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68937
2024-11-07 08:51:12 - progress_bar.py[line:274] - INFO: epoch 028:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.468, ntokens=17665.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3303.2, ups=0.19, wpb=17665.8, bsz=1024, num_updates=10850, lr=3.84312e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=68990
2024-11-07 08:52:05 - progress_bar.py[line:274] - INFO: epoch 028:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=18662.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3523.1, ups=0.19, wpb=18662.2, bsz=1024, num_updates=10860, lr=3.84176e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=69043
2024-11-07 08:52:58 - progress_bar.py[line:274] - INFO: epoch 028:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=18034.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3363.3, ups=0.19, wpb=18034.8, bsz=1024, num_updates=10870, lr=3.8404e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=69097
2024-11-07 08:53:51 - progress_bar.py[line:274] - INFO: epoch 028:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=18251.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3482.7, ups=0.19, wpb=18251.7, bsz=1024, num_updates=10880, lr=3.83904e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=69149
2024-11-07 08:54:43 - progress_bar.py[line:274] - INFO: epoch 028:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.491, ntokens=17884.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.62, wps=3413.3, ups=0.19, wpb=17884.3, bsz=1024, num_updates=10890, lr=3.83768e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=69202
2024-11-07 08:55:37 - progress_bar.py[line:274] - INFO: epoch 028:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18828, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3496.3, ups=0.19, wpb=18828, bsz=1024, num_updates=10900, lr=3.83632e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=37, gb_free=13.5, wall=69256
2024-11-07 08:56:30 - progress_bar.py[line:274] - INFO: epoch 028:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=18233, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3408.7, ups=0.19, wpb=18233, bsz=1024, num_updates=10910, lr=3.83496e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=69309
2024-11-07 08:57:24 - progress_bar.py[line:274] - INFO: epoch 028:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=17918.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3365.7, ups=0.19, wpb=17918.7, bsz=1024, num_updates=10920, lr=3.8336e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=69362
2024-11-07 08:58:18 - progress_bar.py[line:274] - INFO: epoch 028:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=18099.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3338, ups=0.18, wpb=18099.7, bsz=1024, num_updates=10930, lr=3.83224e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=69417
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt

2024-11-07 08:59:04 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 28 @ 10939 updates
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-07 08:59:04 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:00:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 09:02:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 28 @ 10939 updates, score 0) (writing took 223.62149764501373 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 09:03:42 - train.py[line:336] - INFO: end of epoch 28 (average epoch stats below)
2024-11-07 09:03:42 - progress_bar.py[line:282] - INFO: epoch 028 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.471 | ntokens 17809.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.54 | wps 2774.5 | ups 0.16 | wpb 17809.2 | bsz 1023 | num_updates 10939 | lr 3.83101e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 1475 | gb_free 13.4 | wall 69740
2024-11-07 09:03:42 - trainer.py[line:639] - INFO: loading train data for epoch 29
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 09:06:21 - trainer.py[line:703] - INFO: begin training epoch 29
2024-11-07 09:06:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 09:06:28 - progress_bar.py[line:274] - INFO: epoch 029:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.492, ntokens=17202.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=350.8, ups=0.02, wpb=17202.1, bsz=985.6, num_updates=10940, lr=3.83088e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=69907
2024-11-07 09:07:21 - progress_bar.py[line:274] - INFO: epoch 029:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17516.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3342.8, ups=0.19, wpb=17516.4, bsz=1024, num_updates=10950, lr=3.82952e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69959
2024-11-07 09:08:13 - progress_bar.py[line:274] - INFO: epoch 029:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=17804.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3399.9, ups=0.19, wpb=17804.2, bsz=1024, num_updates=10960, lr=3.82815e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70012
2024-11-07 09:09:05 - progress_bar.py[line:274] - INFO: epoch 029:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.443, ntokens=17740.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3391.3, ups=0.19, wpb=17740.2, bsz=1024, num_updates=10970, lr=3.82679e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=70064
2024-11-07 09:09:58 - progress_bar.py[line:274] - INFO: epoch 029:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=17555, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3317.8, ups=0.19, wpb=17555, bsz=1024, num_updates=10980, lr=3.82543e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70117
2024-11-07 09:10:50 - progress_bar.py[line:274] - INFO: epoch 029:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17549.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3357, ups=0.19, wpb=17549.4, bsz=1024, num_updates=10990, lr=3.82407e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70169
2024-11-07 09:11:43 - progress_bar.py[line:274] - INFO: epoch 029:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18057.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3470.2, ups=0.19, wpb=18057.1, bsz=1024, num_updates=11000, lr=3.82271e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70221
2024-11-07 09:12:35 - progress_bar.py[line:274] - INFO: epoch 029:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.389, ntokens=17383, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3308, ups=0.19, wpb=17383, bsz=1024, num_updates=11010, lr=3.82135e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70274
2024-11-07 09:13:28 - progress_bar.py[line:274] - INFO: epoch 029:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.435, ntokens=17884.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3395.7, ups=0.19, wpb=17884.6, bsz=1024, num_updates=11020, lr=3.81999e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70327
2024-11-07 09:14:21 - progress_bar.py[line:274] - INFO: epoch 029:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17673.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3340.9, ups=0.19, wpb=17673.3, bsz=1024, num_updates=11030, lr=3.81863e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70380
2024-11-07 09:15:14 - progress_bar.py[line:274] - INFO: epoch 029:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17616.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3325.1, ups=0.19, wpb=17616.7, bsz=1024, num_updates=11040, lr=3.81727e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70432
2024-11-07 09:16:06 - progress_bar.py[line:274] - INFO: epoch 029:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17463.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3345, ups=0.19, wpb=17463.3, bsz=1024, num_updates=11050, lr=3.81591e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70485
2024-11-07 09:16:59 - progress_bar.py[line:274] - INFO: epoch 029:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=17894.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3386.3, ups=0.19, wpb=17894.6, bsz=1024, num_updates=11060, lr=3.81455e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70538
2024-11-07 09:17:51 - progress_bar.py[line:274] - INFO: epoch 029:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17375.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3324.1, ups=0.19, wpb=17375.8, bsz=1024, num_updates=11070, lr=3.81319e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70590
2024-11-07 09:18:43 - progress_bar.py[line:274] - INFO: epoch 029:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.472, ntokens=17884.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3423.2, ups=0.19, wpb=17884.9, bsz=1024, num_updates=11080, lr=3.81183e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70642
2024-11-07 09:19:36 - progress_bar.py[line:274] - INFO: epoch 029:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17572.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3348.8, ups=0.19, wpb=17572.4, bsz=1024, num_updates=11090, lr=3.81047e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70695
2024-11-07 09:20:28 - progress_bar.py[line:274] - INFO: epoch 029:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17607.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3365.4, ups=0.19, wpb=17607.5, bsz=1024, num_updates=11100, lr=3.80911e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=70747
2024-11-07 09:21:20 - progress_bar.py[line:274] - INFO: epoch 029:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.444, ntokens=17920.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3442.3, ups=0.19, wpb=17920.8, bsz=1024, num_updates=11110, lr=3.80775e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=70799
2024-11-07 09:22:13 - progress_bar.py[line:274] - INFO: epoch 029:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.376, ntokens=17297.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3261.1, ups=0.19, wpb=17297.5, bsz=1024, num_updates=11120, lr=3.80639e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=70852
2024-11-07 09:23:06 - progress_bar.py[line:274] - INFO: epoch 029:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.45, ntokens=17852.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3353.5, ups=0.19, wpb=17852.9, bsz=1024, num_updates=11130, lr=3.80503e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70905
2024-11-07 09:23:58 - progress_bar.py[line:274] - INFO: epoch 029:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.474, ntokens=18025.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3466.1, ups=0.19, wpb=18025.6, bsz=1024, num_updates=11140, lr=3.80367e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=70957
2024-11-07 09:24:52 - progress_bar.py[line:274] - INFO: epoch 029:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.418, ntokens=17768.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3333.3, ups=0.19, wpb=17768.8, bsz=1024, num_updates=11150, lr=3.80231e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71011
2024-11-07 09:25:44 - progress_bar.py[line:274] - INFO: epoch 029:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17514.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3343.8, ups=0.19, wpb=17514.4, bsz=1024, num_updates=11160, lr=3.80095e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71063
2024-11-07 09:26:37 - progress_bar.py[line:274] - INFO: epoch 029:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17518.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3305.9, ups=0.19, wpb=17518.4, bsz=1024, num_updates=11170, lr=3.79959e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=71116
2024-11-07 09:27:32 - progress_bar.py[line:274] - INFO: epoch 029:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17797.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3214.7, ups=0.18, wpb=17797.2, bsz=1024, num_updates=11180, lr=3.79823e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=71171
2024-11-07 09:28:28 - progress_bar.py[line:274] - INFO: epoch 029:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.473, ntokens=18007.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.55, wps=3246.4, ups=0.18, wpb=18007.7, bsz=1024, num_updates=11190, lr=3.79687e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=71227
2024-11-07 09:29:23 - progress_bar.py[line:274] - INFO: epoch 029:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17879.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3243.2, ups=0.18, wpb=17879.9, bsz=1024, num_updates=11200, lr=3.79551e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=71282
2024-11-07 09:30:18 - progress_bar.py[line:274] - INFO: epoch 029:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17990.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3279.6, ups=0.18, wpb=17990.5, bsz=1024, num_updates=11210, lr=3.79414e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71337
2024-11-07 09:31:13 - progress_bar.py[line:274] - INFO: epoch 029:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17629.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3199.5, ups=0.18, wpb=17629.6, bsz=1024, num_updates=11220, lr=3.79278e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71392
2024-11-07 09:32:08 - progress_bar.py[line:274] - INFO: epoch 029:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17577.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3185, ups=0.18, wpb=17577.3, bsz=1024, num_updates=11230, lr=3.79142e-05, gnorm=0.014, clip=0, loss_scale=65536, train_wall=55, gb_free=13.6, wall=71447
2024-11-07 09:33:03 - progress_bar.py[line:274] - INFO: epoch 029:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.48, ntokens=17999.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.58, wps=3252.3, ups=0.18, wpb=17999.2, bsz=1024, num_updates=11240, lr=3.79006e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=71502
2024-11-07 09:33:59 - progress_bar.py[line:274] - INFO: epoch 029:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=18407.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3334.8, ups=0.18, wpb=18407.9, bsz=1024, num_updates=11250, lr=3.7887e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=71558
2024-11-07 09:34:52 - progress_bar.py[line:274] - INFO: epoch 029:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=18311.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3440.5, ups=0.19, wpb=18311.4, bsz=1024, num_updates=11260, lr=3.78734e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=71611
2024-11-07 09:35:44 - progress_bar.py[line:274] - INFO: epoch 029:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=18325.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3497.9, ups=0.19, wpb=18325.2, bsz=1024, num_updates=11270, lr=3.78598e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=71663
2024-11-07 09:36:37 - progress_bar.py[line:274] - INFO: epoch 029:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.498, ntokens=17980.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.65, wps=3418.5, ups=0.19, wpb=17980.4, bsz=1024, num_updates=11280, lr=3.78462e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.2, wall=71716
2024-11-07 09:37:30 - progress_bar.py[line:274] - INFO: epoch 029:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=18772.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3552.5, ups=0.19, wpb=18772.3, bsz=1024, num_updates=11290, lr=3.78326e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=71769
2024-11-07 09:38:22 - progress_bar.py[line:274] - INFO: epoch 029:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17920.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3444.6, ups=0.19, wpb=17920.2, bsz=1024, num_updates=11300, lr=3.7819e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=71821
2024-11-07 09:39:14 - progress_bar.py[line:274] - INFO: epoch 029:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=18299.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3522.1, ups=0.19, wpb=18299.1, bsz=1024, num_updates=11310, lr=3.78054e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=71873
2024-11-07 09:40:06 - progress_bar.py[line:274] - INFO: epoch 029:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.508, ntokens=18111.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.69, wps=3472.7, ups=0.19, wpb=18111.4, bsz=1024, num_updates=11320, lr=3.77918e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=71925
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 09:40:55 - progress_bar.py[line:274] - INFO: epoch 029:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.525, ntokens=17626.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3575.7, ups=0.2, wpb=17626.1, bsz=985.6, num_updates=11330, lr=3.77782e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=49, gb_free=13.3, wall=71974
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt


cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt

2024-11-07 09:40:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 29 @ 11330 updates
2024-11-07 09:40:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:42:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-07 09:44:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 29 @ 11330 updates, score 0) (writing took 221.3782702370081 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 09:45:31 - train.py[line:336] - INFO: end of epoch 29 (average epoch stats below)
2024-11-07 09:45:31 - progress_bar.py[line:282] - INFO: epoch 029 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.46 | ntokens 17824.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.5 | wps 2777.4 | ups 0.16 | wpb 17824.9 | bsz 1023 | num_updates 11330 | lr 3.77782e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1543 | gb_free 13.3 | wall 72250
2024-11-07 09:45:31 - trainer.py[line:639] - INFO: loading train data for epoch 30
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 09:48:10 - trainer.py[line:703] - INFO: begin training epoch 30
2024-11-07 09:48:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 09:49:04 - progress_bar.py[line:274] - INFO: epoch 030:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17508.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=358, ups=0.02, wpb=17508.9, bsz=1024, num_updates=11340, lr=3.77646e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72463
2024-11-07 09:49:56 - progress_bar.py[line:274] - INFO: epoch 030:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17975, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3452.2, ups=0.19, wpb=17975, bsz=1024, num_updates=11350, lr=3.7751e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72515
2024-11-07 09:50:48 - progress_bar.py[line:274] - INFO: epoch 030:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.479, ntokens=17817.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3416.6, ups=0.19, wpb=17817.1, bsz=1024, num_updates=11360, lr=3.77374e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72567
2024-11-07 09:51:41 - progress_bar.py[line:274] - INFO: epoch 030:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17907.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3391.1, ups=0.19, wpb=17907.7, bsz=1024, num_updates=11370, lr=3.77238e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72620
2024-11-07 09:52:33 - progress_bar.py[line:274] - INFO: epoch 030:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17546.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3369, ups=0.19, wpb=17546.3, bsz=1024, num_updates=11380, lr=3.77102e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72672
2024-11-07 09:53:26 - progress_bar.py[line:274] - INFO: epoch 030:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17750.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3399.5, ups=0.19, wpb=17750.5, bsz=1024, num_updates=11390, lr=3.76966e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72724
2024-11-07 09:54:19 - progress_bar.py[line:274] - INFO: epoch 030:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17664.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3315.7, ups=0.19, wpb=17664.4, bsz=1024, num_updates=11400, lr=3.7683e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=72778
2024-11-07 09:55:11 - progress_bar.py[line:274] - INFO: epoch 030:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.457, ntokens=17858.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3395.6, ups=0.19, wpb=17858.1, bsz=1024, num_updates=11410, lr=3.76694e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=72830
2024-11-07 09:56:04 - progress_bar.py[line:274] - INFO: epoch 030:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.476, ntokens=17927.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.56, wps=3420.6, ups=0.19, wpb=17927.8, bsz=1024, num_updates=11420, lr=3.76558e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=72883
2024-11-07 09:56:56 - progress_bar.py[line:274] - INFO: epoch 030:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17741.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3404, ups=0.19, wpb=17741.7, bsz=1024, num_updates=11430, lr=3.76422e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=72935
2024-11-07 09:57:49 - progress_bar.py[line:274] - INFO: epoch 030:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17461.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3285.2, ups=0.19, wpb=17461.5, bsz=1024, num_updates=11440, lr=3.76286e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=72988
2024-11-07 09:58:41 - progress_bar.py[line:274] - INFO: epoch 030:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17672, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3411, ups=0.19, wpb=17672, bsz=1024, num_updates=11450, lr=3.7615e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=73040
2024-11-07 09:59:33 - progress_bar.py[line:274] - INFO: epoch 030:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17322.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3292.8, ups=0.19, wpb=17322.1, bsz=1024, num_updates=11460, lr=3.76013e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=73092
2024-11-07 10:00:26 - progress_bar.py[line:274] - INFO: epoch 030:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.46, ntokens=17827.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3394.2, ups=0.19, wpb=17827.5, bsz=1024, num_updates=11470, lr=3.75877e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=73145
2024-11-07 10:01:18 - progress_bar.py[line:274] - INFO: epoch 030:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.424, ntokens=17529.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3361.2, ups=0.19, wpb=17529.5, bsz=1024, num_updates=11480, lr=3.75741e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=73197
2024-11-07 10:02:11 - progress_bar.py[line:274] - INFO: epoch 030:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.411, ntokens=17633.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3318, ups=0.19, wpb=17633.3, bsz=1024, num_updates=11490, lr=3.75605e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=35, gb_free=13.5, wall=73250
2024-11-07 10:03:04 - progress_bar.py[line:274] - INFO: epoch 030:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17604.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3315.4, ups=0.19, wpb=17604.3, bsz=1024, num_updates=11500, lr=3.75469e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=73303
2024-11-07 10:03:57 - progress_bar.py[line:274] - INFO: epoch 030:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17389.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3283.4, ups=0.19, wpb=17389.1, bsz=1024, num_updates=11510, lr=3.75333e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=42, gb_free=13.5, wall=73356
2024-11-07 10:04:51 - progress_bar.py[line:274] - INFO: epoch 030:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.449, ntokens=17807.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3346.5, ups=0.19, wpb=17807.9, bsz=1024, num_updates=11520, lr=3.75197e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=73409
2024-11-07 10:05:43 - progress_bar.py[line:274] - INFO: epoch 030:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.452, ntokens=17864.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.47, wps=3410.6, ups=0.19, wpb=17864.4, bsz=1024, num_updates=11530, lr=3.75061e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=73462
2024-11-07 10:06:36 - progress_bar.py[line:274] - INFO: epoch 030:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.465, ntokens=18128.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.52, wps=3449, ups=0.19, wpb=18128.8, bsz=1024, num_updates=11540, lr=3.74925e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=73514
2024-11-07 10:07:30 - progress_bar.py[line:274] - INFO: epoch 030:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.415, ntokens=17542.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3250.3, ups=0.19, wpb=17542.9, bsz=1024, num_updates=11550, lr=3.74789e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=73568
2024-11-07 10:08:22 - progress_bar.py[line:274] - INFO: epoch 030:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.448, ntokens=17802.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.46, wps=3391.3, ups=0.19, wpb=17802.4, bsz=1024, num_updates=11560, lr=3.74653e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=73621
2024-11-07 10:09:15 - progress_bar.py[line:274] - INFO: epoch 030:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.469, ntokens=17979.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3392.4, ups=0.19, wpb=17979.3, bsz=1024, num_updates=11570, lr=3.74517e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=73674
2024-11-07 10:10:07 - progress_bar.py[line:274] - INFO: epoch 030:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17716.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3388.1, ups=0.19, wpb=17716.2, bsz=1024, num_updates=11580, lr=3.74381e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.6, wall=73726
2024-11-07 10:10:59 - progress_bar.py[line:274] - INFO: epoch 030:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.454, ntokens=17883, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.48, wps=3428.1, ups=0.19, wpb=17883, bsz=1024, num_updates=11590, lr=3.74245e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=73778
2024-11-07 10:11:52 - progress_bar.py[line:274] - INFO: epoch 030:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.477, ntokens=18066.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3442.3, ups=0.19, wpb=18066.2, bsz=1024, num_updates=11600, lr=3.74109e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=46, gb_free=13.6, wall=73831
2024-11-07 10:12:44 - progress_bar.py[line:274] - INFO: epoch 030:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17778.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3394.6, ups=0.19, wpb=17778.7, bsz=1024, num_updates=11610, lr=3.73973e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=73883
2024-11-07 10:13:37 - progress_bar.py[line:274] - INFO: epoch 030:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17760, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.44, wps=3395.4, ups=0.19, wpb=17760, bsz=1024, num_updates=11620, lr=3.73837e-05, gnorm=0.015, clip=0, loss_scale=65536, train_wall=33, gb_free=13.6, wall=73936
2024-11-07 10:14:29 - progress_bar.py[line:274] - INFO: epoch 030:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17715.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3374.4, ups=0.19, wpb=17715.3, bsz=1024, num_updates=11630, lr=3.73701e-05, gnorm=0.016, clip=0, loss_scale=65536, train_wall=33, gb_free=13.2, wall=73988
2024-11-07 10:15:21 - progress_bar.py[line:274] - INFO: epoch 030:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=18595.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3562.8, ups=0.19, wpb=18595.4, bsz=1024, num_updates=11640, lr=3.73565e-05, gnorm=0.014, clip=0, loss_scale=65536, train_wall=45, gb_free=13.4, wall=74040
2024-11-07 10:16:14 - progress_bar.py[line:274] - INFO: epoch 030:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=18435.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3493.2, ups=0.19, wpb=18435.3, bsz=1024, num_updates=11650, lr=3.73429e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=74093
2024-11-07 10:17:06 - progress_bar.py[line:274] - INFO: epoch 030:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3487.2, ups=0.19, wpb=18251.2, bsz=1024, num_updates=11660, lr=3.73293e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=74145
2024-11-07 10:17:59 - progress_bar.py[line:274] - INFO: epoch 030:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.486, ntokens=17939.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.6, wps=3385.7, ups=0.19, wpb=17939.5, bsz=1024, num_updates=11670, lr=3.73157e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=74198
2024-11-07 10:18:53 - progress_bar.py[line:274] - INFO: epoch 030:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=18537.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3490.2, ups=0.19, wpb=18537.7, bsz=1024, num_updates=11680, lr=3.73021e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=74251
2024-11-07 10:19:45 - progress_bar.py[line:274] - INFO: epoch 030:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.522, ntokens=18126.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3470.7, ups=0.19, wpb=18126.2, bsz=1024, num_updates=11690, lr=3.72885e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=74304
2024-11-07 10:20:37 - progress_bar.py[line:274] - INFO: epoch 030:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=18153, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3470, ups=0.19, wpb=18153, bsz=1024, num_updates=11700, lr=3.72749e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=74356
2024-11-07 10:21:30 - progress_bar.py[line:274] - INFO: epoch 030:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.493, ntokens=18118.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.63, wps=3434.7, ups=0.19, wpb=18118.7, bsz=1024, num_updates=11710, lr=3.72613e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=74409
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 10:22:22 - progress_bar.py[line:274] - INFO: epoch 030:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.495, ntokens=18092, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3494.9, ups=0.19, wpb=18092, bsz=1024, num_updates=11720, lr=3.72476e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=52, gb_free=13.3, wall=74460
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt2024-11-07 10:22:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 30 @ 11721 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-07 10:22:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 10:24:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-07 10:26:05 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 30 @ 11721 updates, score 0) (writing took 221.2052170060051 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 10:26:59 - train.py[line:336] - INFO: end of epoch 30 (average epoch stats below)
2024-11-07 10:26:59 - progress_bar.py[line:282] - INFO: epoch 030 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.461 | ntokens 17839.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.51 | wps 2803.2 | ups 0.16 | wpb 17839.4 | bsz 1023 | num_updates 11721 | lr 3.72463e-05 | gnorm 0.008 | clip 0 | loss_scale 131072 | train_wall 1601 | gb_free 13.4 | wall 74738
2024-11-07 10:26:59 - trainer.py[line:639] - INFO: loading train data for epoch 31
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 10:29:39 - trainer.py[line:703] - INFO: begin training epoch 31
2024-11-07 10:29:39 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 10:30:29 - progress_bar.py[line:274] - INFO: epoch 031:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.428, ntokens=16963.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.38, wps=348.3, ups=0.02, wpb=16963.7, bsz=985.6, num_updates=11730, lr=3.7234e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=29, gb_free=13.5, wall=74948
2024-11-07 10:31:22 - progress_bar.py[line:274] - INFO: epoch 031:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=17615.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3324.8, ups=0.19, wpb=17615.5, bsz=1024, num_updates=11740, lr=3.72204e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75000
2024-11-07 10:32:13 - progress_bar.py[line:274] - INFO: epoch 031:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17741.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3419.9, ups=0.19, wpb=17741.9, bsz=1024, num_updates=11750, lr=3.72068e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=75052
2024-11-07 10:33:06 - progress_bar.py[line:274] - INFO: epoch 031:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.462, ntokens=18035.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3460.3, ups=0.19, wpb=18035.1, bsz=1024, num_updates=11760, lr=3.71932e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=75104
2024-11-07 10:33:58 - progress_bar.py[line:274] - INFO: epoch 031:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.423, ntokens=17580.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.36, wps=3373.4, ups=0.19, wpb=17580.7, bsz=1024, num_updates=11770, lr=3.71796e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75157
2024-11-07 10:34:50 - progress_bar.py[line:274] - INFO: epoch 031:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.407, ntokens=17687.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3372.9, ups=0.19, wpb=17687.6, bsz=1024, num_updates=11780, lr=3.7166e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=75209
2024-11-07 10:35:27 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 10:35:48 - progress_bar.py[line:274] - INFO: epoch 031:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.414, ntokens=17693, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3080.6, ups=0.17, wpb=17693, bsz=1024, num_updates=11790, lr=3.71524e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=75266
2024-11-07 10:36:40 - progress_bar.py[line:274] - INFO: epoch 031:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17903.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3413.9, ups=0.19, wpb=17903.6, bsz=1024, num_updates=11800, lr=3.71388e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75319
2024-11-07 10:37:33 - progress_bar.py[line:274] - INFO: epoch 031:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.401, ntokens=17483, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3331.7, ups=0.19, wpb=17483, bsz=1024, num_updates=11810, lr=3.71252e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75371
2024-11-07 10:38:25 - progress_bar.py[line:274] - INFO: epoch 031:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.434, ntokens=17808.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3392, ups=0.19, wpb=17808.8, bsz=1024, num_updates=11820, lr=3.71116e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75424
2024-11-07 10:39:17 - progress_bar.py[line:274] - INFO: epoch 031:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17559.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3346.4, ups=0.19, wpb=17559.9, bsz=1024, num_updates=11830, lr=3.7098e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75476
2024-11-07 10:40:10 - progress_bar.py[line:274] - INFO: epoch 031:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.483, ntokens=18054.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3436.3, ups=0.19, wpb=18054.3, bsz=1024, num_updates=11840, lr=3.70844e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75529
2024-11-07 10:41:02 - progress_bar.py[line:274] - INFO: epoch 031:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.373, ntokens=17210.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.18, wps=3280.4, ups=0.19, wpb=17210.9, bsz=1024, num_updates=11850, lr=3.70708e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=75581
2024-11-07 10:41:55 - progress_bar.py[line:274] - INFO: epoch 031:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.447, ntokens=17825.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3396.5, ups=0.19, wpb=17825.7, bsz=1024, num_updates=11860, lr=3.70572e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75634
2024-11-07 10:42:48 - progress_bar.py[line:274] - INFO: epoch 031:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17656.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3352.6, ups=0.19, wpb=17656.6, bsz=1024, num_updates=11870, lr=3.70436e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=75687
2024-11-07 10:43:40 - progress_bar.py[line:274] - INFO: epoch 031:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17654.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3390.8, ups=0.19, wpb=17654.4, bsz=1024, num_updates=11880, lr=3.703e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=75739
2024-11-07 10:44:33 - progress_bar.py[line:274] - INFO: epoch 031:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=18158.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3430.5, ups=0.19, wpb=18158.1, bsz=1024, num_updates=11890, lr=3.70164e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=75792
2024-11-07 10:45:25 - progress_bar.py[line:274] - INFO: epoch 031:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.395, ntokens=17633.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.26, wps=3372.9, ups=0.19, wpb=17633.8, bsz=1024, num_updates=11900, lr=3.70028e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=75844
2024-11-07 10:46:18 - progress_bar.py[line:274] - INFO: epoch 031:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17907.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3395, ups=0.19, wpb=17907.3, bsz=1024, num_updates=11910, lr=3.69892e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=75897
2024-11-07 10:47:10 - progress_bar.py[line:274] - INFO: epoch 031:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.456, ntokens=17973.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.49, wps=3448.8, ups=0.19, wpb=17973.2, bsz=1024, num_updates=11920, lr=3.69756e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=75949
2024-11-07 10:48:02 - progress_bar.py[line:274] - INFO: epoch 031:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.436, ntokens=17877.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.41, wps=3404.6, ups=0.19, wpb=17877.2, bsz=1024, num_updates=11930, lr=3.6962e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=76001
2024-11-07 10:48:54 - progress_bar.py[line:274] - INFO: epoch 031:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=17559.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=3364.7, ups=0.19, wpb=17559.7, bsz=1024, num_updates=11940, lr=3.69484e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76053
2024-11-07 10:49:47 - progress_bar.py[line:274] - INFO: epoch 031:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.4, ntokens=17497.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.28, wps=3335.1, ups=0.19, wpb=17497.6, bsz=1024, num_updates=11950, lr=3.69348e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76106
2024-11-07 10:50:39 - progress_bar.py[line:274] - INFO: epoch 031:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17653.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3380.9, ups=0.19, wpb=17653.1, bsz=1024, num_updates=11960, lr=3.69212e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76158
2024-11-07 10:51:32 - progress_bar.py[line:274] - INFO: epoch 031:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.417, ntokens=17593.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.34, wps=3324.4, ups=0.19, wpb=17593.4, bsz=1024, num_updates=11970, lr=3.69075e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76211
2024-11-07 10:52:25 - progress_bar.py[line:274] - INFO: epoch 031:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.408, ntokens=17668.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.31, wps=3361.6, ups=0.19, wpb=17668.8, bsz=1024, num_updates=11980, lr=3.68939e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76264
2024-11-07 10:53:17 - progress_bar.py[line:274] - INFO: epoch 031:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.41, ntokens=17689.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.32, wps=3355.8, ups=0.19, wpb=17689.1, bsz=1024, num_updates=11990, lr=3.68803e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76316
2024-11-07 10:54:10 - progress_bar.py[line:274] - INFO: epoch 031:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.425, ntokens=17771, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.37, wps=3373.7, ups=0.19, wpb=17771, bsz=1024, num_updates=12000, lr=3.68667e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76369
2024-11-07 10:55:02 - progress_bar.py[line:274] - INFO: epoch 031:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3402.8, ups=0.19, wpb=17589.3, bsz=1024, num_updates=12010, lr=3.68531e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=76421
2024-11-07 10:55:54 - progress_bar.py[line:274] - INFO: epoch 031:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.458, ntokens=17762.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.5, wps=3425.7, ups=0.19, wpb=17762.1, bsz=1024, num_updates=12020, lr=3.68395e-05, gnorm=0.013, clip=0, loss_scale=65536, train_wall=35, gb_free=13.1, wall=76472
2024-11-07 10:56:46 - progress_bar.py[line:274] - INFO: epoch 031:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=18367.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3512.9, ups=0.19, wpb=18367.6, bsz=1024, num_updates=12030, lr=3.68259e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=44, gb_free=13.3, wall=76525
2024-11-07 10:57:39 - progress_bar.py[line:274] - INFO: epoch 031:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=18272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3454.8, ups=0.19, wpb=18272.4, bsz=1024, num_updates=12040, lr=3.68123e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76578
2024-11-07 10:58:31 - progress_bar.py[line:274] - INFO: epoch 031:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=18470.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3512.3, ups=0.19, wpb=18470.2, bsz=1024, num_updates=12050, lr=3.67987e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=76630
2024-11-07 10:59:24 - progress_bar.py[line:274] - INFO: epoch 031:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=18340.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3456.4, ups=0.19, wpb=18340.8, bsz=1024, num_updates=12060, lr=3.67851e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76683
2024-11-07 11:00:17 - progress_bar.py[line:274] - INFO: epoch 031:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=18917.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3564.5, ups=0.19, wpb=18917.2, bsz=1024, num_updates=12070, lr=3.67715e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76736
2024-11-07 11:01:10 - progress_bar.py[line:274] - INFO: epoch 031:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=18471.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3506.6, ups=0.19, wpb=18471.1, bsz=1024, num_updates=12080, lr=3.67579e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=76789
2024-11-07 11:02:03 - progress_bar.py[line:274] - INFO: epoch 031:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=17893.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3414.3, ups=0.19, wpb=17893.1, bsz=1024, num_updates=12090, lr=3.67443e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=76841
2024-11-07 11:02:55 - progress_bar.py[line:274] - INFO: epoch 031:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18096.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3448.7, ups=0.19, wpb=18096.5, bsz=1024, num_updates=12100, lr=3.67307e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76894
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 11:03:47 - progress_bar.py[line:274] - INFO: epoch 031:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.478, ntokens=17942.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.57, wps=3424.9, ups=0.19, wpb=17942.9, bsz=1024, num_updates=12110, lr=3.67171e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=76946
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-07 11:03:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 31 @ 12111 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-07 11:03:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 11:05:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 11:07:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 31 @ 12111 updates, score 0) (writing took 220.8156002679898 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 11:08:25 - train.py[line:336] - INFO: end of epoch 31 (average epoch stats below)
2024-11-07 11:08:25 - progress_bar.py[line:282] - INFO: epoch 031 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.448 | ntokens 17837.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.46 | wps 2799.2 | ups 0.16 | wpb 17837.8 | bsz 1023 | num_updates 12111 | lr 3.67157e-05 | gnorm 0.008 | clip 0 | loss_scale 65536 | train_wall 1383 | gb_free 13.3 | wall 77223
2024-11-07 11:08:25 - trainer.py[line:639] - INFO: loading train data for epoch 32
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 11:11:04 - trainer.py[line:703] - INFO: begin training epoch 32
2024-11-07 11:11:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 11:11:54 - progress_bar.py[line:274] - INFO: epoch 032:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=16796.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=345.5, ups=0.02, wpb=16796.3, bsz=985.6, num_updates=12120, lr=3.67035e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=77432
2024-11-07 11:12:47 - progress_bar.py[line:274] - INFO: epoch 032:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.388, ntokens=17547.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.23, wps=3288.6, ups=0.19, wpb=17547.6, bsz=1024, num_updates=12130, lr=3.66899e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77486
2024-11-07 11:13:39 - progress_bar.py[line:274] - INFO: epoch 032:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.406, ntokens=17660.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=3397, ups=0.19, wpb=17660.5, bsz=1024, num_updates=12140, lr=3.66763e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77538
2024-11-07 11:14:32 - progress_bar.py[line:274] - INFO: epoch 032:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17861.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3383.9, ups=0.19, wpb=17861.8, bsz=1024, num_updates=12150, lr=3.66627e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77591
2024-11-07 11:15:24 - progress_bar.py[line:274] - INFO: epoch 032:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.385, ntokens=17492.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3336.5, ups=0.19, wpb=17492.3, bsz=1024, num_updates=12160, lr=3.66491e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77643
2024-11-07 11:16:17 - progress_bar.py[line:274] - INFO: epoch 032:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.383, ntokens=17610.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.22, wps=3335.4, ups=0.19, wpb=17610.8, bsz=1024, num_updates=12170, lr=3.66355e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77696
2024-11-07 11:17:10 - progress_bar.py[line:274] - INFO: epoch 032:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.394, ntokens=17588.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3309.1, ups=0.19, wpb=17588.2, bsz=1024, num_updates=12180, lr=3.66219e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77749
2024-11-07 11:18:03 - progress_bar.py[line:274] - INFO: epoch 032:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17700.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3371.8, ups=0.19, wpb=17700.3, bsz=1024, num_updates=12190, lr=3.66083e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77801
2024-11-07 11:18:55 - progress_bar.py[line:274] - INFO: epoch 032:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.432, ntokens=17824.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3389.6, ups=0.19, wpb=17824.1, bsz=1024, num_updates=12200, lr=3.65947e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77854
2024-11-07 11:19:49 - progress_bar.py[line:274] - INFO: epoch 032:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17383.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3251.6, ups=0.19, wpb=17383.3, bsz=1024, num_updates=12210, lr=3.65811e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77908
2024-11-07 11:20:41 - progress_bar.py[line:274] - INFO: epoch 032:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.399, ntokens=17444.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.27, wps=3327.5, ups=0.19, wpb=17444.9, bsz=1024, num_updates=12220, lr=3.65674e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77960
2024-11-07 11:21:34 - progress_bar.py[line:274] - INFO: epoch 032:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17682.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3338.2, ups=0.19, wpb=17682.8, bsz=1024, num_updates=12230, lr=3.65538e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78013
2024-11-07 11:22:27 - progress_bar.py[line:274] - INFO: epoch 032:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.379, ntokens=17337.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.2, wps=3291.8, ups=0.19, wpb=17337.7, bsz=1024, num_updates=12240, lr=3.65402e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78066
2024-11-07 11:23:19 - progress_bar.py[line:274] - INFO: epoch 032:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.437, ntokens=17761.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3412.2, ups=0.19, wpb=17761.9, bsz=1024, num_updates=12250, lr=3.65266e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78118
2024-11-07 11:24:12 - progress_bar.py[line:274] - INFO: epoch 032:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.439, ntokens=17839.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.42, wps=3378.2, ups=0.19, wpb=17839.5, bsz=1024, num_updates=12260, lr=3.6513e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78170
2024-11-07 11:25:04 - progress_bar.py[line:274] - INFO: epoch 032:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.391, ntokens=17540.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3315.5, ups=0.19, wpb=17540.7, bsz=1024, num_updates=12270, lr=3.64994e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=78223
2024-11-07 11:25:57 - progress_bar.py[line:274] - INFO: epoch 032:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.431, ntokens=17937, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3400.7, ups=0.19, wpb=17937, bsz=1024, num_updates=12280, lr=3.64858e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=78276
2024-11-07 11:26:50 - progress_bar.py[line:274] - INFO: epoch 032:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.393, ntokens=17454.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.25, wps=3297.8, ups=0.19, wpb=17454.4, bsz=1024, num_updates=12290, lr=3.64722e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78329
2024-11-07 11:27:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-07 11:27:48 - progress_bar.py[line:274] - INFO: epoch 032:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.461, ntokens=17970, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.51, wps=3110.5, ups=0.17, wpb=17970, bsz=1024, num_updates=12300, lr=3.64586e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=78387
2024-11-07 11:28:41 - progress_bar.py[line:274] - INFO: epoch 032:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.446, ntokens=17964.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.45, wps=3413.2, ups=0.19, wpb=17964.3, bsz=1024, num_updates=12310, lr=3.6445e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78439
2024-11-07 11:29:33 - progress_bar.py[line:274] - INFO: epoch 032:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.42, ntokens=17876.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3407, ups=0.19, wpb=17876.3, bsz=1024, num_updates=12320, lr=3.64314e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78492
2024-11-07 11:30:25 - progress_bar.py[line:274] - INFO: epoch 032:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.442, ntokens=17902.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3445.6, ups=0.19, wpb=17902.1, bsz=1024, num_updates=12330, lr=3.64178e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78544
2024-11-07 11:31:18 - progress_bar.py[line:274] - INFO: epoch 032:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.419, ntokens=17641.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.35, wps=3326.2, ups=0.19, wpb=17641.2, bsz=1024, num_updates=12340, lr=3.64042e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=78597
2024-11-07 11:32:10 - progress_bar.py[line:274] - INFO: epoch 032:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.413, ntokens=17689.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.33, wps=3381, ups=0.19, wpb=17689.8, bsz=1024, num_updates=12350, lr=3.63906e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=39, gb_free=13.5, wall=78649
2024-11-07 11:33:03 - progress_bar.py[line:274] - INFO: epoch 032:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.377, ntokens=17330.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.19, wps=3296.5, ups=0.19, wpb=17330.9, bsz=1024, num_updates=12360, lr=3.6377e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=40, gb_free=13.6, wall=78702
2024-11-07 11:33:55 - progress_bar.py[line:274] - INFO: epoch 032:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.433, ntokens=17867.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.4, wps=3422.8, ups=0.19, wpb=17867.4, bsz=1024, num_updates=12370, lr=3.63634e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=41, gb_free=13.6, wall=78754
2024-11-07 11:34:47 - progress_bar.py[line:274] - INFO: epoch 032:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.467, ntokens=18150.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3471.9, ups=0.19, wpb=18150.8, bsz=1024, num_updates=12380, lr=3.63498e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.6, wall=78806
2024-11-07 11:35:40 - progress_bar.py[line:274] - INFO: epoch 032:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.441, ntokens=17897.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.43, wps=3420.6, ups=0.19, wpb=17897.8, bsz=1024, num_updates=12390, lr=3.63362e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.6, wall=78859
2024-11-07 11:36:32 - progress_bar.py[line:274] - INFO: epoch 032:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.39, ntokens=17552.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.24, wps=3342.1, ups=0.19, wpb=17552.6, bsz=1024, num_updates=12400, lr=3.63226e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=78911
2024-11-07 11:37:25 - progress_bar.py[line:274] - INFO: epoch 032:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.47, ntokens=17944.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.54, wps=3424.7, ups=0.19, wpb=17944.4, bsz=1024, num_updates=12410, lr=3.6309e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=38, gb_free=13.1, wall=78964
2024-11-07 11:38:17 - progress_bar.py[line:274] - INFO: epoch 032:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=18320.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3504.3, ups=0.19, wpb=18320.9, bsz=1024, num_updates=12420, lr=3.62954e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=79016
2024-11-07 11:39:09 - progress_bar.py[line:274] - INFO: epoch 032:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=18238.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3476.2, ups=0.19, wpb=18238.7, bsz=1024, num_updates=12430, lr=3.62818e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=79068
2024-11-07 11:40:02 - progress_bar.py[line:274] - INFO: epoch 032:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.502, ntokens=18102, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3447.6, ups=0.19, wpb=18102, bsz=1024, num_updates=12440, lr=3.62682e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=79121
2024-11-07 11:40:55 - progress_bar.py[line:274] - INFO: epoch 032:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=18057.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3424.7, ups=0.19, wpb=18057.9, bsz=1024, num_updates=12450, lr=3.62546e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=79174
2024-11-07 11:41:47 - progress_bar.py[line:274] - INFO: epoch 032:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=18681.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3547, ups=0.19, wpb=18681.4, bsz=1024, num_updates=12460, lr=3.6241e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=79226
2024-11-07 11:42:42 - progress_bar.py[line:274] - INFO: epoch 032:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=18267.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3335.5, ups=0.18, wpb=18267.2, bsz=1024, num_updates=12470, lr=3.62273e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=79281
2024-11-07 11:43:37 - progress_bar.py[line:274] - INFO: epoch 032:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=18177.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3339, ups=0.18, wpb=18177.6, bsz=1024, num_updates=12480, lr=3.62137e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.1, wall=79335
2024-11-07 11:44:30 - progress_bar.py[line:274] - INFO: epoch 032:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.496, ntokens=18084.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.64, wps=3352.2, ups=0.19, wpb=18084.9, bsz=1024, num_updates=12490, lr=3.62001e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=79389
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-07 11:45:25 - progress_bar.py[line:274] - INFO: epoch 032:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.482, ntokens=17953.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.59, wps=3308.9, ups=0.18, wpb=17953.9, bsz=1024, num_updates=12500, lr=3.61865e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=79444
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-07 11:45:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 32 @ 12501 updates

cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-07 11:45:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 11:47:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 11:49:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 32 @ 12501 updates, score 0) (writing took 221.09385545700206 seconds)
cp ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-07 11:50:03 - train.py[line:336] - INFO: end of epoch 32 (average epoch stats below)
2024-11-07 11:50:03 - progress_bar.py[line:282] - INFO: epoch 032 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.439 | ntokens 17795.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.42 | wps 2777.3 | ups 0.16 | wpb 17795.4 | bsz 1023 | num_updates 12501 | lr 3.61852e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1445 | gb_free 13.4 | wall 79722
2024-11-07 11:50:03 - trainer.py[line:639] - INFO: loading train data for epoch 33
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor/aihub_indoor_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 11:52:44 - trainer.py[line:703] - INFO: begin training epoch 33
2024-11-07 11:52:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 11:53:33 - progress_bar.py[line:274] - INFO: epoch 033:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.403, ntokens=16817.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.29, wps=344.1, ups=0.02, wpb=16817.7, bsz=985.6, num_updates=12510, lr=3.61729e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=29, gb_free=13.6, wall=79932
2024-11-07 11:54:27 - progress_bar.py[line:274] - INFO: epoch 033:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.43, ntokens=17924.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.39, wps=3331.2, ups=0.19, wpb=17924.5, bsz=1024, num_updates=12520, lr=3.61593e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=79986
2024-11-07 11:54:50 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 11:55:29 - progress_bar.py[line:274] - INFO: epoch 033:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.405, ntokens=17758.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.3, wps=2871.3, ups=0.16, wpb=17758.2, bsz=1024, num_updates=12530, lr=3.61457e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=60, gb_free=13.5, wall=80048
2024-11-07 11:56:22 - progress_bar.py[line:274] - INFO: epoch 033:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.466, ntokens=18046.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.53, wps=3433.4, ups=0.19, wpb=18046.9, bsz=1024, num_updates=12540, lr=3.61321e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=80101
