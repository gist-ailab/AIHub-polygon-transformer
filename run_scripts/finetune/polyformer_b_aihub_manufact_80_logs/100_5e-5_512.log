/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:02 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-07 03:49:04 - utils.py[line:261] - INFO: Start init
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-07 03:49:04 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 1
single-machine distributed training is initialized.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 6
single-machine distributed training is initialized.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 5
single-machine distributed training is initialized.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 3
single-machine distributed training is initialized.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 0
single-machine distributed training is initialized.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 2
single-machine distributed training is initialized.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 4
single-machine distributed training is initialized.
2024-11-07 03:49:04 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-07 03:49:04 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 7
single-machine distributed training is initialized.
2024-11-07 03:49:08 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512', 'restore_file': '../pretrain/polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4980.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv,../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../pretrain/polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4980.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv,../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-07 03:49:08 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-07 03:49:08 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

2024-11-07 03:49:22 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-07 03:49:22 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-07 03:49:22 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-07 03:49:22 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-07 03:49:22 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-07 03:49:22 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 3 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 1 row count 6955 total row count 55640file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 7 row count 6955 total row count 55640file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 0 row count 6955 total row count 55640


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 4 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 2 row count 6955 total row count 55640
file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 5 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_val.tsv slice_id 6 row count 6955 total row count 55640
2024-11-07 03:49:44 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-07 03:49:45 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-07 03:49:45 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-07 03:49:47 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-07 03:49:47 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-07 03:49:47 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-07 03:49:47 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-07 03:49:47 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../pretrain/polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4980.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 03:49:58 - trainer.py[line:619] - INFO: Loaded checkpoint ../pretrain/polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4980.pt (epoch 20 @ 0 updates)
2024-11-07 03:49:58 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 5 seek offset 250000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 0 seek offset 0
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
2024-11-07 03:52:41 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-07 03:52:41 - train.py[line:297] - INFO: Start iterating over samples
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.3977091073167286 loss_cls: 0.011207920499145985
loss_reg: 0.36102111555514227 loss_cls: 0.008432662114501
loss_reg: 0.3659482435985721 loss_cls: 0.011590862646698952
loss_reg: 0.40414460153298293 loss_cls: 0.010221962817013264
loss_reg: 0.3992227223160886 loss_cls: 0.011034611612558365
loss_reg: 0.12776814955705784 loss_cls: 0.009030530229210854
loss_reg: 0.397620823524556 loss_cls: 0.010044220834970474
loss_reg: 0.3436609833096163 loss_cls: 0.014174502342939377
loss_reg: 0.34072814757152153 loss_cls: 0.013733647763729095
loss_reg: 0.3751142060351273 loss_cls: 0.01454905141144991
loss_reg: 0.1033040109244737 loss_cls: 0.008840864524245262
loss_reg: 0.3059362593536628 loss_cls: 0.012865675613284111
loss_reg: 0.3873861934686729 loss_cls: 0.014050877653062344
loss_reg: 0.330013615158273 loss_cls: 0.008872412145137787
loss_reg: 0.28083771322726864 loss_cls: 0.008129016496241093
loss_reg: 0.36615990072163 loss_cls: 0.013098638504743576
loss_reg: 0.42926307327699054 loss_cls: 0.012041449546813965
loss_reg: 0.3974993785701384 loss_cls: 0.010014061816036701
loss_reg: 0.10808560299420962 loss_cls: 0.008410517126321793
loss_reg: 0.3483265163529442 loss_cls: 0.01362575776875019
loss_reg: 0.3410682527623609 loss_cls: 0.010380369611084461
loss_reg: 0.31725091620140383 loss_cls: 0.009255710989236832
loss_reg: 0.3375077907095839 loss_cls: 0.009613128378987312
loss_reg: 0.3194472806975795 loss_cls: 0.01042796578258276
loss_reg: 0.28734452167930136 loss_cls: 0.009594316594302654
loss_reg: 0.32506921004403466 loss_cls: 0.011178459972143173
loss_reg: 0.3466766482980053 loss_cls: 0.005753102712333202
loss_reg: 0.1110948166951431 loss_cls: 0.008790903724730015
loss_reg: 0.34166236751649565 loss_cls: 0.00943810399621725
loss_reg: 0.3252306742838178 loss_cls: 0.007585520856082439
loss_reg: 0.33559849392962043 loss_cls: 0.014350993558764458
loss_reg: 0.30780160064696105 loss_cls: 0.010498312301933765
loss_reg: 0.25552591388664164 loss_cls: 0.010789147578179836
loss_reg: 0.3323987143947288 loss_cls: 0.014300311915576458
loss_reg: 0.35805291699707076 loss_cls: 0.014479395933449268
loss_reg: 0.12645976553117527 loss_cls: 0.011551731266081333
loss_reg: 0.3515741016843843 loss_cls: 0.010200627148151398
loss_reg: 0.37713995475018497 loss_cls: 0.012143791653215885
loss_reg: 0.36451311779706674 loss_cls: 0.00949885230511427
loss_reg: 0.3652265786048845 loss_cls: 0.011390489526093006
loss_reg: 0.40701820874289685 loss_cls: 0.009534839540719986
loss_reg: 0.2867527895314106 loss_cls: 0.009989197365939617
loss_reg: 0.10005091385957973 loss_cls: 0.010042562149465084
loss_reg: 0.3687750068970539 loss_cls: 0.014218823984265327
loss_reg: 0.34608525678801894 loss_cls: 0.016426049172878265
loss_reg: 0.387080502091767 loss_cls: 0.00909595936536789
loss_reg: 0.39374707652537494 loss_cls: 0.008176208473742008
loss_reg: 0.35929305420831004 loss_cls: 0.01025272998958826
loss_reg: 0.3225347412891489 loss_cls: 0.010904733091592789
loss_reg: 0.411494124332507 loss_cls: 0.017676519230008125
loss_reg: 0.13646483675045715 loss_cls: 0.01094895601272583
loss_reg: 0.3124420250399511 loss_cls: 0.012744979932904243
loss_reg: 0.3426326453805473 loss_cls: 0.011134658008813858
loss_reg: 0.350518995264716 loss_cls: 0.006630134768784046
loss_reg: 0.3161635480520825 loss_cls: 0.008819271810352802
loss_reg: 0.3697117669004861 loss_cls: 0.009494295343756676
loss_reg: 0.3289472645558596 loss_cls: 0.007596579845994711
loss_reg: 0.357074597122021 loss_cls: 0.012098364531993866
loss_reg: 0.06936681786385841 loss_cls: 0.009038225747644901
loss_reg: 0.2759805479901225 loss_cls: 0.010288569144904613
loss_reg: 0.37552321793842913 loss_cls: 0.017154542729258537
loss_reg: 0.34872697707570877 loss_cls: 0.010856518521904945
loss_reg: 0.35927887358941996 loss_cls: 0.01577123999595642
loss_reg: 0.3829147089775387 loss_cls: 0.01200323086231947
2024-11-07 03:53:40 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 391 loss=0.021, loss_v1=0, loss_v2=0, nll_loss=22.66, ntokens=17540.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62685e+06, wps=3314.2, ups=0.19, wpb=17540.3, bsz=1024, num_updates=10, lr=2.13129e-07, gnorm=0.078, clip=0, loss_scale=128, train_wall=36, gb_free=13.4, wall=233
2024-11-07 03:54:34 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 391 loss=0.02, loss_v1=0, loss_v2=0, nll_loss=21.937, ntokens=17260.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=4.01446e+06, wps=3206.8, ups=0.19, wpb=17260.7, bsz=1024, num_updates=20, lr=4.26257e-07, gnorm=0.08, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=287
2024-11-07 03:55:28 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 391 loss=0.019, loss_v1=0, loss_v2=0, nll_loss=21.397, ntokens=17251.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=2.76114e+06, wps=3200.9, ups=0.19, wpb=17251.5, bsz=1024, num_updates=30, lr=6.39386e-07, gnorm=0.115, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=341
2024-11-07 03:56:22 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 391 loss=0.014, loss_v1=0, loss_v2=0, nll_loss=20.492, ntokens=17478.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=1.47514e+06, wps=3219.3, ups=0.18, wpb=17478.8, bsz=1024, num_updates=40, lr=8.52515e-07, gnorm=0.19, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=395
2024-11-07 03:57:16 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 391 loss=0.009, loss_v1=0, loss_v2=0, nll_loss=18.376, ntokens=17533.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=340123, wps=3248.7, ups=0.19, wpb=17533.4, bsz=1024, num_updates=50, lr=1.06564e-06, gnorm=0.092, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=449
2024-11-07 03:58:10 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 391 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=16.603, ntokens=17189.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=99516.8, wps=3174, ups=0.18, wpb=17189.2, bsz=1024, num_updates=60, lr=1.27877e-06, gnorm=0.03, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=503
2024-11-07 03:59:04 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 391 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=15.083, ntokens=17125.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34715.8, wps=3190.2, ups=0.19, wpb=17125.8, bsz=1024, num_updates=70, lr=1.4919e-06, gnorm=0.019, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=557
2024-11-07 03:59:58 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 391 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=13.575, ntokens=17101.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12202.2, wps=3158.4, ups=0.18, wpb=17101.4, bsz=1024, num_updates=80, lr=1.70503e-06, gnorm=0.015, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=611
2024-11-07 04:00:52 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 391 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=12.356, ntokens=17305.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5242.19, wps=3210.2, ups=0.19, wpb=17305.5, bsz=1024, num_updates=90, lr=1.91816e-06, gnorm=0.012, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=665
2024-11-07 04:01:46 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=11.11, ntokens=17447.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=2210.68, wps=3234.2, ups=0.19, wpb=17447.2, bsz=1024, num_updates=100, lr=2.13129e-06, gnorm=0.01, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=719
2024-11-07 04:02:39 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=9.878, ntokens=17243, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=941.15, wps=3223.6, ups=0.19, wpb=17243, bsz=1024, num_updates=110, lr=2.34442e-06, gnorm=0.01, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=773
2024-11-07 04:03:33 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=8.791, ntokens=17360.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=443.06, wps=3229.3, ups=0.19, wpb=17360.4, bsz=1024, num_updates=120, lr=2.55754e-06, gnorm=0.008, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=826
2024-11-07 04:04:27 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=7.996, ntokens=17477.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=255.38, wps=3248.9, ups=0.19, wpb=17477.1, bsz=1024, num_updates=130, lr=2.77067e-06, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=880
2024-11-07 04:05:20 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=7.339, ntokens=17116.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=161.93, wps=3201.3, ups=0.19, wpb=17116.8, bsz=1024, num_updates=140, lr=2.9838e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=934
2024-11-07 04:06:14 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=6.659, ntokens=16833.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=101.08, wps=3121.3, ups=0.19, wpb=16833.8, bsz=1024, num_updates=150, lr=3.19693e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=988
2024-11-07 04:07:07 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=6.544, ntokens=17365.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=93.33, wps=3263.5, ups=0.19, wpb=17365.6, bsz=1024, num_updates=160, lr=3.41006e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=1041
2024-11-07 04:08:01 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=6.203, ntokens=17362, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=73.69, wps=3228.4, ups=0.19, wpb=17362, bsz=1024, num_updates=170, lr=3.62319e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1095
2024-11-07 04:08:55 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.99, ntokens=17273, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=63.57, wps=3215.7, ups=0.19, wpb=17273, bsz=1024, num_updates=180, lr=3.83632e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1148
2024-11-07 04:09:48 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.751, ntokens=17160.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=53.84, wps=3227.5, ups=0.19, wpb=17160.1, bsz=1024, num_updates=190, lr=4.04945e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1201
2024-11-07 04:10:41 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.64, ntokens=17197.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=49.86, wps=3211.6, ups=0.19, wpb=17197.6, bsz=1024, num_updates=200, lr=4.26257e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1255
2024-11-07 04:11:35 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.527, ntokens=17104.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=46.09, wps=3203.5, ups=0.19, wpb=17104.6, bsz=1024, num_updates=210, lr=4.4757e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=1308
2024-11-07 04:12:28 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.528, ntokens=17212.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=46.16, wps=3244.6, ups=0.19, wpb=17212.7, bsz=1024, num_updates=220, lr=4.68883e-06, gnorm=0.007, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=1361
2024-11-07 04:13:21 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.617, ntokens=17548.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=49.08, wps=3281.7, ups=0.19, wpb=17548.1, bsz=1024, num_updates=230, lr=4.90196e-06, gnorm=0.011, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1415
2024-11-07 04:14:15 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.79, ntokens=17237.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=55.34, wps=3231.6, ups=0.19, wpb=17237.3, bsz=1024, num_updates=240, lr=5.11509e-06, gnorm=0.017, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1468
2024-11-07 04:15:09 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=5.993, ntokens=17724.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=63.67, wps=3293.6, ups=0.19, wpb=17724.1, bsz=1024, num_updates=250, lr=5.32822e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=1522
2024-11-07 04:16:02 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.768, ntokens=17418.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=54.48, wps=3244.9, ups=0.19, wpb=17418.1, bsz=1024, num_updates=260, lr=5.54135e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1576
2024-11-07 04:16:57 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.628, ntokens=17186.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=49.46, wps=3157.4, ups=0.18, wpb=17186.2, bsz=1024, num_updates=270, lr=5.75448e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1630
2024-11-07 04:17:50 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.575, ntokens=17241.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=47.67, wps=3234.7, ups=0.19, wpb=17241.2, bsz=1024, num_updates=280, lr=5.9676e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1683
2024-11-07 04:18:44 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.496, ntokens=17176.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=45.13, wps=3200.2, ups=0.19, wpb=17176.9, bsz=1024, num_updates=290, lr=6.18073e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=12.8, wall=1737
2024-11-07 04:19:37 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.434, ntokens=17101.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=43.22, wps=3219.4, ups=0.19, wpb=17101.7, bsz=1024, num_updates=300, lr=6.39386e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1790
2024-11-07 04:20:31 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.471, ntokens=17503, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=44.37, wps=3251.9, ups=0.19, wpb=17503, bsz=1024, num_updates=310, lr=6.60699e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=1844
2024-11-07 04:21:24 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.471, ntokens=17704.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=44.34, wps=3297.8, ups=0.19, wpb=17704.2, bsz=1024, num_updates=320, lr=6.82012e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1898
2024-11-07 04:22:17 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.298, ntokens=17217.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=39.35, wps=3255.8, ups=0.19, wpb=17217.9, bsz=1024, num_updates=330, lr=7.03325e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1951
2024-11-07 04:23:11 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.329, ntokens=17513.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=40.2, wps=3269.4, ups=0.19, wpb=17513.1, bsz=1024, num_updates=340, lr=7.24638e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2004
2024-11-07 04:24:04 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.248, ntokens=17225, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=37.99, wps=3223.5, ups=0.19, wpb=17225, bsz=1024, num_updates=350, lr=7.45951e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2058
2024-11-07 04:24:58 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.306, ntokens=17669.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=39.56, wps=3310.3, ups=0.19, wpb=17669.3, bsz=1024, num_updates=360, lr=7.67263e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2111
2024-11-07 04:25:51 - progress_bar.py[line:274] - INFO: epoch 001:    370 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.316, ntokens=17888.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=39.83, wps=3326.8, ups=0.19, wpb=17888.1, bsz=1024, num_updates=370, lr=7.88576e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2165
2024-11-07 04:26:45 - progress_bar.py[line:274] - INFO: epoch 001:    380 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.241, ntokens=17546.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=37.82, wps=3289.2, ups=0.19, wpb=17546.2, bsz=1024, num_updates=380, lr=8.09889e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2218
2024-11-07 04:27:36 - progress_bar.py[line:274] - INFO: epoch 001:    390 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.189, ntokens=17471.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=36.47, wps=3380.7, ups=0.19, wpb=17471.4, bsz=1024, num_updates=390, lr=8.31202e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2270
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-07 04:27:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 391 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-07 04:27:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cp: cp: cp: cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directorycannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt'
: No such file or directory
: No such file or directory
: No such file or directory
cp: cp: cp: cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
: No such file or directory: No such file or directory

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 04:27:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 04:28:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 391 updates, score 0) (writing took 21.804202956001973 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-07 04:28:05 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-07 04:28:05 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.006 | loss_v1 0 | loss_v2 0 | nll_loss 8.931 | ntokens 17325.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 487.95 | wps 3198.6 | ups 0.18 | wpb 17325.8 | bsz 1023 | num_updates 391 | lr 8.33333e-06 | gnorm 0.021 | clip 0 | loss_scale 128 | train_wall 1191 | gb_free 13.2 | wall 2298
2024-11-07 04:28:05 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000



slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 04:30:44 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-07 04:30:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 04:31:34 - progress_bar.py[line:274] - INFO: epoch 002:      9 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.15, ntokens=16820.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=35.5, wps=707.6, ups=0.04, wpb=16820.5, bsz=985.6, num_updates=400, lr=8.52515e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=29, gb_free=13.6, wall=2508
2024-11-07 04:32:27 - progress_bar.py[line:274] - INFO: epoch 002:     19 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.107, ntokens=17396.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.47, wps=3293.3, ups=0.19, wpb=17396.1, bsz=1024, num_updates=410, lr=8.73828e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2560
2024-11-07 04:33:20 - progress_bar.py[line:274] - INFO: epoch 002:     29 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.069, ntokens=17345.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=33.58, wps=3268.9, ups=0.19, wpb=17345.7, bsz=1024, num_updates=420, lr=8.95141e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2613
2024-11-07 04:34:13 - progress_bar.py[line:274] - INFO: epoch 002:     39 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.046, ntokens=17270.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=33.03, wps=3251.3, ups=0.19, wpb=17270.9, bsz=1024, num_updates=430, lr=9.16454e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2667
2024-11-07 04:35:06 - progress_bar.py[line:274] - INFO: epoch 002:     49 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.118, ntokens=17754.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.73, wps=3358.7, ups=0.19, wpb=17754.5, bsz=1024, num_updates=440, lr=9.37766e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2719
2024-11-07 04:35:59 - progress_bar.py[line:274] - INFO: epoch 002:     59 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.986, ntokens=17258.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.68, wps=3262.8, ups=0.19, wpb=17258.4, bsz=1024, num_updates=450, lr=9.59079e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2772
2024-11-07 04:36:52 - progress_bar.py[line:274] - INFO: epoch 002:     69 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.966, ntokens=17259.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.25, wps=3256.2, ups=0.19, wpb=17259.7, bsz=1024, num_updates=460, lr=9.80392e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2825
2024-11-07 04:37:46 - progress_bar.py[line:274] - INFO: epoch 002:     79 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.998, ntokens=17348.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.96, wps=3232.4, ups=0.19, wpb=17348.2, bsz=1024, num_updates=470, lr=1.00171e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2879
2024-11-07 04:38:38 - progress_bar.py[line:274] - INFO: epoch 002:     89 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.989, ntokens=17455.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.75, wps=3296.6, ups=0.19, wpb=17455.2, bsz=1024, num_updates=480, lr=1.02302e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=12.8, wall=2932
2024-11-07 04:39:31 - progress_bar.py[line:274] - INFO: epoch 002:     99 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.979, ntokens=17548, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.54, wps=3315, ups=0.19, wpb=17548, bsz=1024, num_updates=490, lr=1.04433e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2985
2024-11-07 04:40:25 - progress_bar.py[line:274] - INFO: epoch 002:    109 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.916, ntokens=17220.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=30.19, wps=3234.7, ups=0.19, wpb=17220.2, bsz=1024, num_updates=500, lr=1.06564e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=3038
2024-11-07 04:41:18 - progress_bar.py[line:274] - INFO: epoch 002:    119 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.965, ntokens=17522.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.23, wps=3285.5, ups=0.19, wpb=17522.6, bsz=1024, num_updates=510, lr=1.08696e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=3091
2024-11-07 04:42:11 - progress_bar.py[line:274] - INFO: epoch 002:    129 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.924, ntokens=17362.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=30.35, wps=3273.2, ups=0.19, wpb=17362.3, bsz=1024, num_updates=520, lr=1.10827e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=3145
2024-11-07 04:43:04 - progress_bar.py[line:274] - INFO: epoch 002:    139 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.869, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.22, wps=3220.4, ups=0.19, wpb=17226, bsz=1024, num_updates=530, lr=1.12958e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3198
2024-11-07 04:43:57 - progress_bar.py[line:274] - INFO: epoch 002:    149 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.851, ntokens=17187.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.86, wps=3256.1, ups=0.19, wpb=17187.8, bsz=1024, num_updates=540, lr=1.1509e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3251
2024-11-07 04:44:50 - progress_bar.py[line:274] - INFO: epoch 002:    159 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.907, ntokens=17475.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=30, wps=3305.1, ups=0.19, wpb=17475.4, bsz=1024, num_updates=550, lr=1.17221e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3304
2024-11-07 04:45:43 - progress_bar.py[line:274] - INFO: epoch 002:    169 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.815, ntokens=17175.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.15, wps=3237.1, ups=0.19, wpb=17175.8, bsz=1024, num_updates=560, lr=1.19352e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3357
2024-11-07 04:46:36 - progress_bar.py[line:274] - INFO: epoch 002:    179 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.856, ntokens=17451.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.95, wps=3299.5, ups=0.19, wpb=17451.7, bsz=1024, num_updates=570, lr=1.21483e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3410
2024-11-07 04:47:29 - progress_bar.py[line:274] - INFO: epoch 002:    189 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.793, ntokens=17070.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.72, wps=3224.7, ups=0.19, wpb=17070.6, bsz=1024, num_updates=580, lr=1.23615e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3463
2024-11-07 04:48:22 - progress_bar.py[line:274] - INFO: epoch 002:    199 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.843, ntokens=17445, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.71, wps=3300.3, ups=0.19, wpb=17445, bsz=1024, num_updates=590, lr=1.25746e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3515
2024-11-07 04:49:15 - progress_bar.py[line:274] - INFO: epoch 002:    209 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.734, ntokens=17023.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.61, wps=3231.6, ups=0.19, wpb=17023.5, bsz=1024, num_updates=600, lr=1.27877e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3568
2024-11-07 04:50:07 - progress_bar.py[line:274] - INFO: epoch 002:    219 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.789, ntokens=17181.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.65, wps=3274.3, ups=0.19, wpb=17181.5, bsz=1024, num_updates=610, lr=1.30009e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3621
2024-11-07 04:51:00 - progress_bar.py[line:274] - INFO: epoch 002:    229 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.791, ntokens=17304.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.68, wps=3253.2, ups=0.19, wpb=17304.7, bsz=1024, num_updates=620, lr=1.3214e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3674
2024-11-07 04:51:53 - progress_bar.py[line:274] - INFO: epoch 002:    239 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.72, ntokens=16997.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.35, wps=3193.6, ups=0.19, wpb=16997.3, bsz=1024, num_updates=630, lr=1.34271e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3727
2024-11-07 04:52:46 - progress_bar.py[line:274] - INFO: epoch 002:    249 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.84, ntokens=17665.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.64, wps=3355.2, ups=0.19, wpb=17665.8, bsz=1024, num_updates=640, lr=1.36402e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3780
2024-11-07 04:53:39 - progress_bar.py[line:274] - INFO: epoch 002:    259 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.727, ntokens=17233.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.49, wps=3272, ups=0.19, wpb=17233.4, bsz=1024, num_updates=650, lr=1.38534e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3832
2024-11-07 04:54:32 - progress_bar.py[line:274] - INFO: epoch 002:    269 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.77, ntokens=17403.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.29, wps=3291.1, ups=0.19, wpb=17403.1, bsz=1024, num_updates=660, lr=1.40665e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3885
2024-11-07 04:55:25 - progress_bar.py[line:274] - INFO: epoch 002:    279 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.729, ntokens=17183.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.52, wps=3234.6, ups=0.19, wpb=17183.8, bsz=1024, num_updates=670, lr=1.42796e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=3938
2024-11-07 04:56:18 - progress_bar.py[line:274] - INFO: epoch 002:    289 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.699, ntokens=17030.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.97, wps=3200.9, ups=0.19, wpb=17030.9, bsz=1024, num_updates=680, lr=1.44928e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3992
2024-11-07 04:57:11 - progress_bar.py[line:274] - INFO: epoch 002:    299 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.755, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27, wps=3299.7, ups=0.19, wpb=17398.1, bsz=1024, num_updates=690, lr=1.47059e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=4044
2024-11-07 04:58:03 - progress_bar.py[line:274] - INFO: epoch 002:    309 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.706, ntokens=17366.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.09, wps=3293.9, ups=0.19, wpb=17366.5, bsz=1024, num_updates=700, lr=1.4919e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=4097
2024-11-07 04:58:56 - progress_bar.py[line:274] - INFO: epoch 002:    319 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.73, ntokens=17491.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.55, wps=3310.3, ups=0.19, wpb=17491.4, bsz=1024, num_updates=710, lr=1.51321e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=4150
2024-11-07 04:59:49 - progress_bar.py[line:274] - INFO: epoch 002:    329 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.708, ntokens=17297.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.14, wps=3278.4, ups=0.19, wpb=17297.5, bsz=1024, num_updates=720, lr=1.53453e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=4203
2024-11-07 05:00:42 - progress_bar.py[line:274] - INFO: epoch 002:    339 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.723, ntokens=17357.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.41, wps=3250.9, ups=0.19, wpb=17357.7, bsz=1024, num_updates=730, lr=1.55584e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=4256
2024-11-07 05:01:36 - progress_bar.py[line:274] - INFO: epoch 002:    349 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.707, ntokens=17502.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.13, wps=3273.6, ups=0.19, wpb=17502.6, bsz=1024, num_updates=740, lr=1.57715e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=4309
2024-11-07 05:02:29 - progress_bar.py[line:274] - INFO: epoch 002:    359 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.675, ntokens=17466.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.55, wps=3288.8, ups=0.19, wpb=17466.8, bsz=1024, num_updates=750, lr=1.59847e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4363
2024-11-07 05:03:22 - progress_bar.py[line:274] - INFO: epoch 002:    369 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.734, ntokens=17610.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.62, wps=3316.4, ups=0.19, wpb=17610.1, bsz=1024, num_updates=760, lr=1.61978e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4416
2024-11-07 05:04:14 - progress_bar.py[line:274] - INFO: epoch 002:    379 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.748, ntokens=17647.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.88, wps=3431.1, ups=0.19, wpb=17647.7, bsz=1024, num_updates=770, lr=1.64109e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=4467
2024-11-07 05:05:05 - progress_bar.py[line:274] - INFO: epoch 002:    389 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.663, ntokens=17343.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.33, wps=3371.9, ups=0.19, wpb=17343.4, bsz=1024, num_updates=780, lr=1.6624e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4519
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt2024-11-07 05:05:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 782 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-07 05:05:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 05:07:03 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-07 05:08:54 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 782 updates, score 0) (writing took 221.90327846098808 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000


slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
2024-11-07 05:09:48 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-07 05:09:48 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 4.847 | ntokens 17333.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 28.78 | wps 2707.1 | ups 0.16 | wpb 17333.8 | bsz 1023 | num_updates 782 | lr 1.66667e-05 | gnorm 0.004 | clip 0 | loss_scale 256 | train_wall 1186 | gb_free 13.2 | wall 4802
2024-11-07 05:09:48 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 05:12:28 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-07 05:12:28 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 05:13:13 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.651, ntokens=16499.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=25.13, wps=338.2, ups=0.02, wpb=16499.1, bsz=985.6, num_updates=790, lr=1.68372e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=29, gb_free=13.4, wall=5006
2024-11-07 05:14:05 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.703, ntokens=17576.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.04, wps=3343.2, ups=0.19, wpb=17576.9, bsz=1024, num_updates=800, lr=1.70503e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5059
2024-11-07 05:14:59 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.634, ntokens=17397.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.82, wps=3267.8, ups=0.19, wpb=17397.9, bsz=1024, num_updates=810, lr=1.72634e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5112
2024-11-07 05:15:52 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.628, ntokens=17349.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.73, wps=3262.6, ups=0.19, wpb=17349.3, bsz=1024, num_updates=820, lr=1.74766e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5165
2024-11-07 05:16:45 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.653, ntokens=17613.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.15, wps=3301.6, ups=0.19, wpb=17613.7, bsz=1024, num_updates=830, lr=1.76897e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5219
2024-11-07 05:17:38 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.611, ntokens=17375.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.44, wps=3290, ups=0.19, wpb=17375.5, bsz=1024, num_updates=840, lr=1.79028e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5272
2024-11-07 05:18:31 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.537, ntokens=16894.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.22, wps=3188.4, ups=0.19, wpb=16894.2, bsz=1024, num_updates=850, lr=1.81159e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=5325
2024-11-07 05:19:24 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.617, ntokens=17353.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.55, wps=3247.7, ups=0.19, wpb=17353.2, bsz=1024, num_updates=860, lr=1.83291e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5378
2024-11-07 05:20:18 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.541, ntokens=17157, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.27, wps=3203.7, ups=0.19, wpb=17157, bsz=1024, num_updates=870, lr=1.85422e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5431
2024-11-07 05:21:12 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.627, ntokens=17454.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.7, wps=3256.9, ups=0.19, wpb=17454.4, bsz=1024, num_updates=880, lr=1.87553e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5485
2024-11-07 05:22:05 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.579, ntokens=17366.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.9, wps=3269.1, ups=0.19, wpb=17366.1, bsz=1024, num_updates=890, lr=1.89685e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13, wall=5538
2024-11-07 05:23:00 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.607, ntokens=17555.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.38, wps=3193.3, ups=0.18, wpb=17555.4, bsz=1024, num_updates=900, lr=1.91816e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5593
2024-11-07 05:23:55 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.56, ntokens=17361.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.59, wps=3165, ups=0.18, wpb=17361.6, bsz=1024, num_updates=910, lr=1.93947e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5648
2024-11-07 05:24:49 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.502, ntokens=17126.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.66, wps=3151.7, ups=0.18, wpb=17126.4, bsz=1024, num_updates=920, lr=1.96078e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5702
2024-11-07 05:25:43 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.527, ntokens=17210, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.05, wps=3191.1, ups=0.19, wpb=17210, bsz=1024, num_updates=930, lr=1.9821e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5756
2024-11-07 05:26:36 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.531, ntokens=17360, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.11, wps=3240.7, ups=0.19, wpb=17360, bsz=1024, num_updates=940, lr=2.00341e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5810
2024-11-07 05:27:30 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.481, ntokens=17161.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.33, wps=3223.3, ups=0.19, wpb=17161.7, bsz=1024, num_updates=950, lr=2.02472e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5863
2024-11-07 05:28:23 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.519, ntokens=17341.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.93, wps=3240.3, ups=0.19, wpb=17341.8, bsz=1024, num_updates=960, lr=2.04604e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5917
2024-11-07 05:29:17 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.482, ntokens=17261.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.35, wps=3232.3, ups=0.19, wpb=17261.1, bsz=1024, num_updates=970, lr=2.06735e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5970
2024-11-07 05:30:09 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.462, ntokens=17135.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.03, wps=3249.4, ups=0.19, wpb=17135.6, bsz=1024, num_updates=980, lr=2.08866e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=6023
2024-11-07 05:31:03 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.451, ntokens=17048, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.87, wps=3203.3, ups=0.19, wpb=17048, bsz=1024, num_updates=990, lr=2.10997e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6076
2024-11-07 05:31:56 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.424, ntokens=16912.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.47, wps=3191.4, ups=0.19, wpb=16912.1, bsz=1024, num_updates=1000, lr=2.13129e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=6129
2024-11-07 05:32:48 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.523, ntokens=17606.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.99, wps=3350.7, ups=0.19, wpb=17606.3, bsz=1024, num_updates=1010, lr=2.1526e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=6182
2024-11-07 05:33:41 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.413, ntokens=17114.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.3, wps=3229.9, ups=0.19, wpb=17114.8, bsz=1024, num_updates=1020, lr=2.17391e-05, gnorm=0.007, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=6235
2024-11-07 05:34:34 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.547, ntokens=17758.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.38, wps=3323.3, ups=0.19, wpb=17758.9, bsz=1024, num_updates=1030, lr=2.19523e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6288
2024-11-07 05:35:27 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.422, ntokens=17330.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.44, wps=3301, ups=0.19, wpb=17330.8, bsz=1024, num_updates=1040, lr=2.21654e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6340
2024-11-07 05:36:20 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.498, ntokens=17492.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.59, wps=3307, ups=0.19, wpb=17492.9, bsz=1024, num_updates=1050, lr=2.23785e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=6393
2024-11-07 05:37:12 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.432, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.58, wps=3288.8, ups=0.19, wpb=17268.7, bsz=1024, num_updates=1060, lr=2.25916e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=6446
2024-11-07 05:38:05 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.34, ntokens=16817.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.25, wps=3179.6, ups=0.19, wpb=16817.1, bsz=1024, num_updates=1070, lr=2.28048e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6499
2024-11-07 05:38:58 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.447, ntokens=17399.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.81, wps=3307, ups=0.19, wpb=17399.6, bsz=1024, num_updates=1080, lr=2.30179e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.1, wall=6551
2024-11-07 05:39:50 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.424, ntokens=17382.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.47, wps=3325.4, ups=0.19, wpb=17382.4, bsz=1024, num_updates=1090, lr=2.3231e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6604
2024-11-07 05:40:44 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.405, ntokens=17352.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.18, wps=3248.1, ups=0.19, wpb=17352.5, bsz=1024, num_updates=1100, lr=2.34442e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=6657
2024-11-07 05:41:36 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.389, ntokens=17319.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.96, wps=3275.9, ups=0.19, wpb=17319.8, bsz=1024, num_updates=1110, lr=2.36573e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6710
2024-11-07 05:42:29 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.419, ntokens=17548, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.39, wps=3356.1, ups=0.19, wpb=17548, bsz=1024, num_updates=1120, lr=2.38704e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6762
2024-11-07 05:43:22 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.393, ntokens=17372.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.01, wps=3288.7, ups=0.19, wpb=17372.9, bsz=1024, num_updates=1130, lr=2.40835e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6815
2024-11-07 05:44:15 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.378, ntokens=17523.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.8, wps=3280.8, ups=0.19, wpb=17523.6, bsz=1024, num_updates=1140, lr=2.42967e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6868
2024-11-07 05:45:08 - progress_bar.py[line:274] - INFO: epoch 003:    368 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.429, ntokens=17615.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.54, wps=3317.5, ups=0.19, wpb=17615.3, bsz=1024, num_updates=1150, lr=2.45098e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6922
2024-11-07 05:46:00 - progress_bar.py[line:274] - INFO: epoch 003:    378 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.423, ntokens=17438.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.45, wps=3385.5, ups=0.19, wpb=17438.5, bsz=1024, num_updates=1160, lr=2.47229e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6973
2024-11-07 05:46:51 - progress_bar.py[line:274] - INFO: epoch 003:    388 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.46, ntokens=17522, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.01, wps=3416.9, ups=0.2, wpb=17522, bsz=1024, num_updates=1170, lr=2.49361e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7024
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-07 05:47:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1173 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-07 05:47:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 05:48:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-07 05:50:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1173 updates, score 0) (writing took 222.20742660100223 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-07 05:51:40 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-07 05:51:40 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 4.504 | ntokens 17319.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 22.69 | wps 2696.3 | ups 0.16 | wpb 17319.9 | bsz 1023 | num_updates 1173 | lr 2.5e-05 | gnorm 0.006 | clip 0 | loss_scale 512 | train_wall 1186 | gb_free 13.3 | wall 7313
2024-11-07 05:51:40 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 05:54:21 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-07 05:54:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 05:55:00 - progress_bar.py[line:274] - INFO: epoch 004:      7 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.395, ntokens=16893.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=21.04, wps=345.1, ups=0.02, wpb=16893.2, bsz=985.6, num_updates=1180, lr=2.51492e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=29, gb_free=13.5, wall=7514
2024-11-07 05:55:53 - progress_bar.py[line:274] - INFO: epoch 004:     17 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.381, ntokens=17563.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.84, wps=3339.5, ups=0.19, wpb=17563.2, bsz=1024, num_updates=1190, lr=2.53623e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7566
2024-11-07 05:56:46 - progress_bar.py[line:274] - INFO: epoch 004:     27 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.353, ntokens=17519, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.43, wps=3303.4, ups=0.19, wpb=17519, bsz=1024, num_updates=1200, lr=2.55754e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7620
2024-11-07 05:57:39 - progress_bar.py[line:274] - INFO: epoch 004:     37 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.311, ntokens=17448.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.85, wps=3316, ups=0.19, wpb=17448.6, bsz=1024, num_updates=1210, lr=2.57886e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7672
2024-11-07 05:58:31 - progress_bar.py[line:274] - INFO: epoch 004:     47 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.342, ntokens=17472.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.27, wps=3334.9, ups=0.19, wpb=17472.3, bsz=1024, num_updates=1220, lr=2.60017e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7725
2024-11-07 05:59:24 - progress_bar.py[line:274] - INFO: epoch 004:     57 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.278, ntokens=17335.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.39, wps=3264, ups=0.19, wpb=17335.9, bsz=1024, num_updates=1230, lr=2.62148e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=7778
2024-11-07 06:00:17 - progress_bar.py[line:274] - INFO: epoch 004:     67 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.256, ntokens=17100.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.11, wps=3262.3, ups=0.19, wpb=17100.3, bsz=1024, num_updates=1240, lr=2.6428e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7830
2024-11-07 06:01:13 - progress_bar.py[line:274] - INFO: epoch 004:     77 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.241, ntokens=17068.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.91, wps=3020.2, ups=0.18, wpb=17068.5, bsz=1024, num_updates=1250, lr=2.66411e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=44, gb_free=13.3, wall=7887
2024-11-07 06:02:05 - progress_bar.py[line:274] - INFO: epoch 004:     87 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.308, ntokens=17510.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.81, wps=3374.7, ups=0.19, wpb=17510.1, bsz=1024, num_updates=1260, lr=2.68542e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=52, gb_free=13.5, wall=7938
2024-11-07 06:02:57 - progress_bar.py[line:274] - INFO: epoch 004:     97 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.255, ntokens=17323.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.09, wps=3347, ups=0.19, wpb=17323.8, bsz=1024, num_updates=1270, lr=2.70673e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=48, gb_free=13.5, wall=7990
2024-11-07 06:03:49 - progress_bar.py[line:274] - INFO: epoch 004:    107 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.269, ntokens=17291.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.28, wps=3288.5, ups=0.19, wpb=17291.4, bsz=1024, num_updates=1280, lr=2.72805e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=46, gb_free=13.4, wall=8043
2024-11-07 06:04:41 - progress_bar.py[line:274] - INFO: epoch 004:    117 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.259, ntokens=17383.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.15, wps=3345.7, ups=0.19, wpb=17383.6, bsz=1024, num_updates=1290, lr=2.74936e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=39, gb_free=13.6, wall=8095
2024-11-07 06:05:34 - progress_bar.py[line:274] - INFO: epoch 004:    127 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.237, ntokens=17377.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.85, wps=3297.9, ups=0.19, wpb=17377.6, bsz=1024, num_updates=1300, lr=2.77067e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8147
2024-11-07 06:06:28 - progress_bar.py[line:274] - INFO: epoch 004:    137 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.212, ntokens=17259.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.54, wps=3215.5, ups=0.19, wpb=17259.7, bsz=1024, num_updates=1310, lr=2.79199e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8201
2024-11-07 06:07:21 - progress_bar.py[line:274] - INFO: epoch 004:    147 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.238, ntokens=17374, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.87, wps=3278.8, ups=0.19, wpb=17374, bsz=1024, num_updates=1320, lr=2.8133e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8254
2024-11-07 06:08:14 - progress_bar.py[line:274] - INFO: epoch 004:    157 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.213, ntokens=17327.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.55, wps=3223.6, ups=0.19, wpb=17327.2, bsz=1024, num_updates=1330, lr=2.83461e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8308
2024-11-07 06:09:07 - progress_bar.py[line:274] - INFO: epoch 004:    167 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.188, ntokens=17212.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.23, wps=3243.7, ups=0.19, wpb=17212.6, bsz=1024, num_updates=1340, lr=2.85592e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8361
2024-11-07 06:10:01 - progress_bar.py[line:274] - INFO: epoch 004:    177 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.226, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.71, wps=3271.4, ups=0.19, wpb=17400.1, bsz=1024, num_updates=1350, lr=2.87724e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8414
2024-11-07 06:10:53 - progress_bar.py[line:274] - INFO: epoch 004:    187 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.158, ntokens=17256.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.86, wps=3270, ups=0.19, wpb=17256.7, bsz=1024, num_updates=1360, lr=2.89855e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8467
2024-11-07 06:11:47 - progress_bar.py[line:274] - INFO: epoch 004:    197 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.175, ntokens=17263.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.07, wps=3251.2, ups=0.19, wpb=17263.8, bsz=1024, num_updates=1370, lr=2.91986e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8520
2024-11-07 06:12:40 - progress_bar.py[line:274] - INFO: epoch 004:    207 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.154, ntokens=17146.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.8, wps=3216.3, ups=0.19, wpb=17146.1, bsz=1024, num_updates=1380, lr=2.94118e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8573
2024-11-07 06:13:32 - progress_bar.py[line:274] - INFO: epoch 004:    217 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.158, ntokens=17203.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.85, wps=3286.1, ups=0.19, wpb=17203.2, bsz=1024, num_updates=1390, lr=2.96249e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=8626
2024-11-07 06:14:27 - progress_bar.py[line:274] - INFO: epoch 004:    227 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.119, ntokens=17291.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.37, wps=3154.5, ups=0.18, wpb=17291.5, bsz=1024, num_updates=1400, lr=2.9838e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=38, gb_free=13.5, wall=8680
2024-11-07 06:15:23 - progress_bar.py[line:274] - INFO: epoch 004:    237 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.139, ntokens=17126.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.62, wps=3059.2, ups=0.18, wpb=17126.1, bsz=1024, num_updates=1410, lr=3.00512e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=56, gb_free=13.3, wall=8736
2024-11-07 06:16:18 - progress_bar.py[line:274] - INFO: epoch 004:    247 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.126, ntokens=17483.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.46, wps=3190, ups=0.18, wpb=17483.5, bsz=1024, num_updates=1420, lr=3.02643e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=55, gb_free=13.6, wall=8791
2024-11-07 06:17:10 - progress_bar.py[line:274] - INFO: epoch 004:    257 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.115, ntokens=17358.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.33, wps=3331.7, ups=0.19, wpb=17358.3, bsz=1024, num_updates=1430, lr=3.04774e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=52, gb_free=13.3, wall=8843
2024-11-07 06:18:06 - progress_bar.py[line:274] - INFO: epoch 004:    267 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.086, ntokens=17119.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.99, wps=3034.5, ups=0.18, wpb=17119.7, bsz=1024, num_updates=1440, lr=3.06905e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=56, gb_free=13.5, wall=8900
2024-11-07 06:19:00 - progress_bar.py[line:274] - INFO: epoch 004:    277 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.099, ntokens=17177.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.14, wps=3199.9, ups=0.19, wpb=17177.4, bsz=1024, num_updates=1450, lr=3.09037e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=54, gb_free=13.3, wall=8953
2024-11-07 06:19:53 - progress_bar.py[line:274] - INFO: epoch 004:    287 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.1, ntokens=17219, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.15, wps=3272.7, ups=0.19, wpb=17219, bsz=1024, num_updates=1460, lr=3.11168e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=53, gb_free=13.3, wall=9006
2024-11-07 06:20:47 - progress_bar.py[line:274] - INFO: epoch 004:    297 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.089, ntokens=17232.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.02, wps=3156.5, ups=0.18, wpb=17232.4, bsz=1024, num_updates=1470, lr=3.13299e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=55, gb_free=13.6, wall=9061
2024-11-07 06:21:41 - progress_bar.py[line:274] - INFO: epoch 004:    307 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.085, ntokens=17260.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.97, wps=3204.2, ups=0.19, wpb=17260.7, bsz=1024, num_updates=1480, lr=3.15431e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=54, gb_free=13.5, wall=9115
2024-11-07 06:22:33 - progress_bar.py[line:274] - INFO: epoch 004:    317 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.101, ntokens=17428.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.17, wps=3384.5, ups=0.19, wpb=17428.5, bsz=1024, num_updates=1490, lr=3.17562e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=51, gb_free=13.4, wall=9166
2024-11-07 06:23:26 - progress_bar.py[line:274] - INFO: epoch 004:    327 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.028, ntokens=17114.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.31, wps=3173.6, ups=0.19, wpb=17114.3, bsz=1024, num_updates=1500, lr=3.19693e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=53, gb_free=13.5, wall=9220
2024-11-07 06:24:19 - progress_bar.py[line:274] - INFO: epoch 004:    337 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.107, ntokens=17536.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.23, wps=3370, ups=0.19, wpb=17536.7, bsz=1024, num_updates=1510, lr=3.21824e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=46, gb_free=13.5, wall=9272
2024-11-07 06:25:11 - progress_bar.py[line:274] - INFO: epoch 004:    347 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.056, ntokens=17380.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.63, wps=3303.7, ups=0.19, wpb=17380.8, bsz=1024, num_updates=1520, lr=3.23956e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=9325
2024-11-07 06:26:05 - progress_bar.py[line:274] - INFO: epoch 004:    357 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.111, ntokens=17588.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.28, wps=3282.4, ups=0.19, wpb=17588.3, bsz=1024, num_updates=1530, lr=3.26087e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=9378
2024-11-07 06:26:58 - progress_bar.py[line:274] - INFO: epoch 004:    367 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.092, ntokens=17641.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.06, wps=3284.7, ups=0.19, wpb=17641.5, bsz=1024, num_updates=1540, lr=3.28218e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=9432
2024-11-07 06:27:51 - progress_bar.py[line:274] - INFO: epoch 004:    377 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.245, ntokens=17916.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.97, wps=3425.3, ups=0.19, wpb=17916.3, bsz=1024, num_updates=1550, lr=3.3035e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=33, gb_free=13.5, wall=9484
2024-11-07 06:28:45 - progress_bar.py[line:274] - INFO: epoch 004:    387 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.241, ntokens=17563.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.91, wps=3232.3, ups=0.18, wpb=17563.5, bsz=1024, num_updates=1560, lr=3.32481e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=9539
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
2024-11-07 06:29:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1564 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
2024-11-07 06:29:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 06:30:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-07 06:32:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1564 updates, score 0) (writing took 219.82252859897562 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
2024-11-07 06:33:37 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-07 06:33:37 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 4.192 | ntokens 17337.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 18.27 | wps 2693 | ups 0.16 | wpb 17337.7 | bsz 1023 | num_updates 1564 | lr 3.33333e-05 | gnorm 0.007 | clip 0 | loss_scale 1024 | train_wall 1552 | gb_free 13.2 | wall 9831
2024-11-07 06:33:37 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 06:36:17 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-07 06:36:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 06:36:51 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.113, ntokens=16895.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=17.31, wps=347.6, ups=0.02, wpb=16895.2, bsz=985.6, num_updates=1570, lr=3.34612e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=36, gb_free=13.5, wall=10025
2024-11-07 06:37:45 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.075, ntokens=17492.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.86, wps=3257.2, ups=0.19, wpb=17492.1, bsz=1024, num_updates=1580, lr=3.36743e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=10078
2024-11-07 06:38:37 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.056, ntokens=17361.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.64, wps=3312.6, ups=0.19, wpb=17361.8, bsz=1024, num_updates=1590, lr=3.38875e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10131
2024-11-07 06:39:32 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.01, ntokens=17373.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.11, wps=3187.8, ups=0.18, wpb=17373.8, bsz=1024, num_updates=1600, lr=3.41006e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10185
2024-11-07 06:40:27 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.046, ntokens=17521.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.52, wps=3198.9, ups=0.18, wpb=17521.6, bsz=1024, num_updates=1610, lr=3.43137e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10240
2024-11-07 06:41:20 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.976, ntokens=17239.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.73, wps=3239.1, ups=0.19, wpb=17239.9, bsz=1024, num_updates=1620, lr=3.45269e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.6, wall=10293
2024-11-07 06:42:13 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.944, ntokens=16966.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.39, wps=3181.1, ups=0.19, wpb=16966.2, bsz=1024, num_updates=1630, lr=3.474e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=10347
2024-11-07 06:43:07 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.973, ntokens=17168.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.71, wps=3207, ups=0.19, wpb=17168.1, bsz=1024, num_updates=1640, lr=3.49531e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10400
2024-11-07 06:44:00 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.991, ntokens=17344.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.9, wps=3262.3, ups=0.19, wpb=17344.3, bsz=1024, num_updates=1650, lr=3.51662e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10453
2024-11-07 06:44:53 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.948, ntokens=17161.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.43, wps=3245.5, ups=0.19, wpb=17161.5, bsz=1024, num_updates=1660, lr=3.53794e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=10506
2024-11-07 06:45:47 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.016, ntokens=17374.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.17, wps=3221.8, ups=0.19, wpb=17374.3, bsz=1024, num_updates=1670, lr=3.55925e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10560
2024-11-07 06:46:41 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.97, ntokens=17274.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.67, wps=3171.9, ups=0.18, wpb=17274.4, bsz=1024, num_updates=1680, lr=3.58056e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=10615
2024-11-07 06:47:34 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.986, ntokens=17428.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.84, wps=3263.5, ups=0.19, wpb=17428.1, bsz=1024, num_updates=1690, lr=3.60188e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=10668
2024-11-07 06:48:28 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.956, ntokens=17418.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.52, wps=3269.8, ups=0.19, wpb=17418.7, bsz=1024, num_updates=1700, lr=3.62319e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10721
2024-11-07 06:49:21 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.943, ntokens=17071.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.38, wps=3184.9, ups=0.19, wpb=17071.4, bsz=1024, num_updates=1710, lr=3.6445e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=10775
2024-11-07 06:50:14 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.931, ntokens=17300.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.25, wps=3260.9, ups=0.19, wpb=17300.1, bsz=1024, num_updates=1720, lr=3.66581e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=10828
2024-11-07 06:51:07 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.935, ntokens=17182.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.3, wps=3247.7, ups=0.19, wpb=17182.6, bsz=1024, num_updates=1730, lr=3.68713e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10881
2024-11-07 06:52:00 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.96, ntokens=17513.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.56, wps=3291.2, ups=0.19, wpb=17513.5, bsz=1024, num_updates=1740, lr=3.70844e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10934
2024-11-07 06:52:54 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.941, ntokens=17157.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.35, wps=3210.1, ups=0.19, wpb=17157.8, bsz=1024, num_updates=1750, lr=3.72975e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10987
2024-11-07 06:53:47 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.941, ntokens=17384.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.35, wps=3246.4, ups=0.19, wpb=17384.9, bsz=1024, num_updates=1760, lr=3.75107e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11041
2024-11-07 06:54:41 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.909, ntokens=17162.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.02, wps=3214.3, ups=0.19, wpb=17162.1, bsz=1024, num_updates=1770, lr=3.77238e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=11094
2024-11-07 06:55:34 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.913, ntokens=17060.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.06, wps=3208.2, ups=0.19, wpb=17060.3, bsz=1024, num_updates=1780, lr=3.79369e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=11148
2024-11-07 06:56:27 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.884, ntokens=17412.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.77, wps=3281.7, ups=0.19, wpb=17412.6, bsz=1024, num_updates=1790, lr=3.815e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11201
2024-11-07 06:57:20 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.916, ntokens=17136.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.09, wps=3227, ups=0.19, wpb=17136.5, bsz=1024, num_updates=1800, lr=3.83632e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11254
2024-11-07 06:58:13 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.946, ntokens=17650.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.41, wps=3349.4, ups=0.19, wpb=17650.3, bsz=1024, num_updates=1810, lr=3.85763e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11306
2024-11-07 06:59:07 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.905, ntokens=17449, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.98, wps=3253.8, ups=0.19, wpb=17449, bsz=1024, num_updates=1820, lr=3.87894e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11360
2024-11-07 07:00:00 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.928, ntokens=17380.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.22, wps=3230.6, ups=0.19, wpb=17380.8, bsz=1024, num_updates=1830, lr=3.90026e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=35, gb_free=13.2, wall=11414
2024-11-07 07:00:54 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.881, ntokens=17134.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.74, wps=3211.7, ups=0.19, wpb=17134.2, bsz=1024, num_updates=1840, lr=3.92157e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11467
2024-11-07 07:01:47 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.89, ntokens=17307.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.83, wps=3257.3, ups=0.19, wpb=17307.8, bsz=1024, num_updates=1850, lr=3.94288e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11520
2024-11-07 07:02:40 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.901, ntokens=17178.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.94, wps=3232.7, ups=0.19, wpb=17178.1, bsz=1024, num_updates=1860, lr=3.96419e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11573
2024-11-07 07:03:33 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.892, ntokens=17440.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.85, wps=3261.5, ups=0.19, wpb=17440.3, bsz=1024, num_updates=1870, lr=3.98551e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11627
2024-11-07 07:04:26 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.885, ntokens=17220.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.78, wps=3247.2, ups=0.19, wpb=17220.6, bsz=1024, num_updates=1880, lr=4.00682e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11680
2024-11-07 07:05:19 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.858, ntokens=17263.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.5, wps=3276.9, ups=0.19, wpb=17263.2, bsz=1024, num_updates=1890, lr=4.02813e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.1, wall=11733
2024-11-07 07:06:13 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.887, ntokens=17341.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.8, wps=3243.6, ups=0.19, wpb=17341.4, bsz=1024, num_updates=1900, lr=4.04945e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11786
2024-11-07 07:07:06 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.819, ntokens=17213.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.12, wps=3200.7, ups=0.19, wpb=17213.5, bsz=1024, num_updates=1910, lr=4.07076e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=11840
2024-11-07 07:08:00 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.937, ntokens=17560.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.31, wps=3249.4, ups=0.19, wpb=17560.1, bsz=1024, num_updates=1920, lr=4.09207e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11894
2024-11-07 07:08:58 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.883, ntokens=17475.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.75, wps=3036.5, ups=0.17, wpb=17475.1, bsz=1024, num_updates=1930, lr=4.11338e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=11952
2024-11-07 07:09:53 - progress_bar.py[line:274] - INFO: epoch 005:    376 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.058, ntokens=17690.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.66, wps=3189.4, ups=0.18, wpb=17690.7, bsz=1024, num_updates=1940, lr=4.1347e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12007
2024-11-07 07:10:49 - progress_bar.py[line:274] - INFO: epoch 005:    386 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.015, ntokens=17241, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.17, wps=3130.3, ups=0.18, wpb=17241, bsz=1024, num_updates=1950, lr=4.15601e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=12062
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt2024-11-07 07:11:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1955 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
2024-11-07 07:11:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 07:13:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-07 07:14:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1955 updates, score 0) (writing took 220.0086488040106 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
2024-11-07 07:15:46 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-07 07:15:46 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.948 | ntokens 17303.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 15.43 | wps 2675 | ups 0.15 | wpb 17303.9 | bsz 1023 | num_updates 1955 | lr 4.16667e-05 | gnorm 0.008 | clip 0 | loss_scale 1024 | train_wall 1193 | gb_free 13.3 | wall 12360
2024-11-07 07:15:46 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 07:18:26 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-07 07:18:26 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 07:18:55 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.921, ntokens=16515.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=15.15, wps=339.4, ups=0.02, wpb=16515.2, bsz=985.6, num_updates=1960, lr=4.17732e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=29, gb_free=13, wall=12549
2024-11-07 07:19:49 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.895, ntokens=17449.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.88, wps=3266.4, ups=0.19, wpb=17449.9, bsz=1024, num_updates=1970, lr=4.19864e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12602
2024-11-07 07:20:41 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.898, ntokens=17543.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.91, wps=3340.5, ups=0.19, wpb=17543.9, bsz=1024, num_updates=1980, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=12655
2024-11-07 07:21:36 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.865, ntokens=17221.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.57, wps=3162.1, ups=0.18, wpb=17221.5, bsz=1024, num_updates=1990, lr=4.24126e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=12709
2024-11-07 07:22:28 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.822, ntokens=17422, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.14, wps=3307.8, ups=0.19, wpb=17422, bsz=1024, num_updates=2000, lr=4.26257e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=12762
2024-11-07 07:23:21 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.847, ntokens=17520.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.39, wps=3298.3, ups=0.19, wpb=17520.4, bsz=1024, num_updates=2010, lr=4.28389e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12815
2024-11-07 07:24:14 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.762, ntokens=16837.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.57, wps=3208.9, ups=0.19, wpb=16837.9, bsz=1024, num_updates=2020, lr=4.3052e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.1, wall=12867
2024-11-07 07:25:07 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.855, ntokens=17495.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.47, wps=3314.1, ups=0.19, wpb=17495.6, bsz=1024, num_updates=2030, lr=4.32651e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12920
2024-11-07 07:26:00 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.835, ntokens=17339.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.27, wps=3265.3, ups=0.19, wpb=17339.5, bsz=1024, num_updates=2040, lr=4.34783e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.6, wall=12973
2024-11-07 07:26:53 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.825, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.17, wps=3254.7, ups=0.19, wpb=17277.5, bsz=1024, num_updates=2050, lr=4.36914e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13026
2024-11-07 07:27:46 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.837, ntokens=17319.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.29, wps=3259.6, ups=0.19, wpb=17319.2, bsz=1024, num_updates=2060, lr=4.39045e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13079
2024-11-07 07:28:39 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.819, ntokens=17095.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.11, wps=3213.7, ups=0.19, wpb=17095.5, bsz=1024, num_updates=2070, lr=4.41176e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13133
2024-11-07 07:29:32 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.794, ntokens=17417.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.87, wps=3291.5, ups=0.19, wpb=17417.3, bsz=1024, num_updates=2080, lr=4.43308e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13186
2024-11-07 07:30:25 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.84, ntokens=17330.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.32, wps=3253.1, ups=0.19, wpb=17330.5, bsz=1024, num_updates=2090, lr=4.45439e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13239
2024-11-07 07:31:18 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17032.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3213.4, ups=0.19, wpb=17032.2, bsz=1024, num_updates=2100, lr=4.4757e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13292
2024-11-07 07:32:11 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.805, ntokens=17341.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.98, wps=3282.2, ups=0.19, wpb=17341.1, bsz=1024, num_updates=2110, lr=4.49702e-05, gnorm=0.015, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13345
2024-11-07 07:33:04 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.797, ntokens=17147.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.9, wps=3234.7, ups=0.19, wpb=17147.3, bsz=1024, num_updates=2120, lr=4.51833e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13398
2024-11-07 07:33:58 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.805, ntokens=17402, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.97, wps=3252.2, ups=0.19, wpb=17402, bsz=1024, num_updates=2130, lr=4.53964e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13451
2024-11-07 07:34:51 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.805, ntokens=17337, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.98, wps=3285.6, ups=0.19, wpb=17337, bsz=1024, num_updates=2140, lr=4.56095e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13504
2024-11-07 07:35:44 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.78, ntokens=17261.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.74, wps=3250.2, ups=0.19, wpb=17261.1, bsz=1024, num_updates=2150, lr=4.58227e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13557
2024-11-07 07:36:36 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.793, ntokens=17031.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.86, wps=3231.9, ups=0.19, wpb=17031.2, bsz=1024, num_updates=2160, lr=4.60358e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13610
2024-11-07 07:37:29 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.719, ntokens=17026.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=3240.4, ups=0.19, wpb=17026.9, bsz=1024, num_updates=2170, lr=4.62489e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=13662
2024-11-07 07:38:22 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.788, ntokens=17359.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.81, wps=3272.3, ups=0.19, wpb=17359.2, bsz=1024, num_updates=2180, lr=4.64621e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13715
2024-11-07 07:39:15 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.756, ntokens=17134.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.51, wps=3255.7, ups=0.19, wpb=17134.2, bsz=1024, num_updates=2190, lr=4.66752e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=13768
2024-11-07 07:40:08 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.748, ntokens=17255, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.44, wps=3243.8, ups=0.19, wpb=17255, bsz=1024, num_updates=2200, lr=4.68883e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13821
2024-11-07 07:41:01 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.779, ntokens=17535.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.73, wps=3281.6, ups=0.19, wpb=17535.8, bsz=1024, num_updates=2210, lr=4.71014e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13875
2024-11-07 07:41:55 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.808, ntokens=17365.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.01, wps=3221.2, ups=0.19, wpb=17365.1, bsz=1024, num_updates=2220, lr=4.73146e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13929
2024-11-07 07:42:49 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.749, ntokens=17119.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.44, wps=3193.5, ups=0.19, wpb=17119.5, bsz=1024, num_updates=2230, lr=4.75277e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=13982
2024-11-07 07:43:42 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.739, ntokens=17182.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.35, wps=3195.1, ups=0.19, wpb=17182.4, bsz=1024, num_updates=2240, lr=4.77408e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14036
2024-11-07 07:44:36 - progress_bar.py[line:274] - INFO: epoch 006:    295 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.758, ntokens=17370.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.53, wps=3234.6, ups=0.19, wpb=17370.6, bsz=1024, num_updates=2250, lr=4.7954e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=14090
2024-11-07 07:45:30 - progress_bar.py[line:274] - INFO: epoch 006:    305 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=17177.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=3184.2, ups=0.19, wpb=17177.8, bsz=1024, num_updates=2260, lr=4.81671e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14144
2024-11-07 07:46:23 - progress_bar.py[line:274] - INFO: epoch 006:    315 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.771, ntokens=17383.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.65, wps=3292.5, ups=0.19, wpb=17383.8, bsz=1024, num_updates=2270, lr=4.83802e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=14196
2024-11-07 07:47:16 - progress_bar.py[line:274] - INFO: epoch 006:    325 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.783, ntokens=17343.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.76, wps=3257.5, ups=0.19, wpb=17343.9, bsz=1024, num_updates=2280, lr=4.85934e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14250
2024-11-07 07:48:09 - progress_bar.py[line:274] - INFO: epoch 006:    335 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=17256.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=3265.9, ups=0.19, wpb=17256.9, bsz=1024, num_updates=2290, lr=4.88065e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=14302
2024-11-07 07:49:04 - progress_bar.py[line:274] - INFO: epoch 006:    345 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=3133.8, ups=0.18, wpb=17219.7, bsz=1024, num_updates=2300, lr=4.90196e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14357
2024-11-07 07:49:57 - progress_bar.py[line:274] - INFO: epoch 006:    355 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17660.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3320.4, ups=0.19, wpb=17660.4, bsz=1024, num_updates=2310, lr=4.92327e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14411
2024-11-07 07:50:50 - progress_bar.py[line:274] - INFO: epoch 006:    365 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.765, ntokens=17557.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.6, wps=3291.3, ups=0.19, wpb=17557.2, bsz=1024, num_updates=2320, lr=4.94459e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13, wall=14464
2024-11-07 07:51:43 - progress_bar.py[line:274] - INFO: epoch 006:    375 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.918, ntokens=17623.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.11, wps=3350, ups=0.19, wpb=17623.7, bsz=1024, num_updates=2330, lr=4.9659e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=14517
2024-11-07 07:52:34 - progress_bar.py[line:274] - INFO: epoch 006:    385 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.887, ntokens=17234.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.8, wps=3356.7, ups=0.19, wpb=17234.6, bsz=1024, num_updates=2340, lr=4.98721e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14568
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-07 07:53:02 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2346 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-07 07:53:02 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 07:54:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-07 07:56:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2346 updates, score 0) (writing took 221.32699325602152 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-07 07:57:37 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-07 07:57:37 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.803 | ntokens 17288.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.95 | wps 2691.9 | ups 0.16 | wpb 17288.1 | bsz 1023 | num_updates 2346 | lr 5e-05 | gnorm 0.008 | clip 0 | loss_scale 2048 | train_wall 1185 | gb_free 13.3 | wall 14871
2024-11-07 07:57:37 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 08:00:17 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-07 08:00:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 08:00:41 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.832, ntokens=16697.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=14.24, wps=343.3, ups=0.02, wpb=16697.9, bsz=985.6, num_updates=2350, lr=4.99946e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=29, gb_free=13.5, wall=15054
2024-11-07 08:01:34 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.788, ntokens=17597.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.81, wps=3305.6, ups=0.19, wpb=17597.9, bsz=1024, num_updates=2360, lr=4.9981e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=31, gb_free=12.7, wall=15108
2024-11-07 08:02:27 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.767, ntokens=17490.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.61, wps=3292.3, ups=0.19, wpb=17490.6, bsz=1024, num_updates=2370, lr=4.99674e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15161
2024-11-07 08:03:20 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.772, ntokens=17387.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.66, wps=3287.2, ups=0.19, wpb=17387.8, bsz=1024, num_updates=2380, lr=4.99537e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=15214
2024-11-07 08:04:13 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.733, ntokens=17497.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=3318, ups=0.19, wpb=17497.9, bsz=1024, num_updates=2390, lr=4.99401e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15266
2024-11-07 08:05:06 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.743, ntokens=17732.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.38, wps=3329.5, ups=0.19, wpb=17732.9, bsz=1024, num_updates=2400, lr=4.99265e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15320
2024-11-07 08:05:59 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.666, ntokens=17132.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.7, wps=3224.6, ups=0.19, wpb=17132.8, bsz=1024, num_updates=2410, lr=4.99129e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=15373
2024-11-07 08:06:53 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.714, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=3252.5, ups=0.19, wpb=17323.2, bsz=1024, num_updates=2420, lr=4.98993e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=15426
2024-11-07 08:07:46 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=17286.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=3245.2, ups=0.19, wpb=17286.5, bsz=1024, num_updates=2430, lr=4.98857e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15479
2024-11-07 08:08:39 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.693, ntokens=17300.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.93, wps=3273.4, ups=0.19, wpb=17300.5, bsz=1024, num_updates=2440, lr=4.98721e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15532
2024-11-07 08:09:32 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.777, ntokens=17739.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.71, wps=3328.4, ups=0.19, wpb=17739.7, bsz=1024, num_updates=2450, lr=4.98585e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15585
2024-11-07 08:10:25 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.725, ntokens=17258.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.22, wps=3243.5, ups=0.19, wpb=17258.6, bsz=1024, num_updates=2460, lr=4.98449e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15639
2024-11-07 08:11:19 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=17327.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.11, wps=3241.9, ups=0.19, wpb=17327.9, bsz=1024, num_updates=2470, lr=4.98313e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=15692
2024-11-07 08:12:14 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.686, ntokens=17358.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.87, wps=3118.9, ups=0.18, wpb=17358.6, bsz=1024, num_updates=2480, lr=4.98177e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.6, wall=15748
2024-11-07 08:13:08 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.712, ntokens=17150, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.1, wps=3211.6, ups=0.19, wpb=17150, bsz=1024, num_updates=2490, lr=4.98041e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=15801
2024-11-07 08:14:01 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.688, ntokens=17488.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.89, wps=3292.4, ups=0.19, wpb=17488.6, bsz=1024, num_updates=2500, lr=4.97905e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=12.8, wall=15854
2024-11-07 08:14:54 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.655, ntokens=17129.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.6, wps=3247.7, ups=0.19, wpb=17129.6, bsz=1024, num_updates=2510, lr=4.97769e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=15907
2024-11-07 08:15:47 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.719, ntokens=17370.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=3269.5, ups=0.19, wpb=17370.5, bsz=1024, num_updates=2520, lr=4.97633e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15960
2024-11-07 08:16:39 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.652, ntokens=17259.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=3279.1, ups=0.19, wpb=17259.4, bsz=1024, num_updates=2530, lr=4.97497e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=16013
2024-11-07 08:17:33 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.69, ntokens=17163, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.9, wps=3215.5, ups=0.19, wpb=17163, bsz=1024, num_updates=2540, lr=4.97361e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=16066
2024-11-07 08:18:26 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.692, ntokens=17168.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.92, wps=3191, ups=0.19, wpb=17168.6, bsz=1024, num_updates=2550, lr=4.97225e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.6, wall=16120
2024-11-07 08:19:20 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.627, ntokens=17163.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.35, wps=3209.2, ups=0.19, wpb=17163.3, bsz=1024, num_updates=2560, lr=4.97089e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16173
2024-11-07 08:20:13 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.684, ntokens=17360.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.85, wps=3271.9, ups=0.19, wpb=17360.6, bsz=1024, num_updates=2570, lr=4.96953e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16227
2024-11-07 08:21:07 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.64, ntokens=17136.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=3178.2, ups=0.19, wpb=17136.7, bsz=1024, num_updates=2580, lr=4.96817e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16280
2024-11-07 08:22:00 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=17349.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=3272.1, ups=0.19, wpb=17349.8, bsz=1024, num_updates=2590, lr=4.96681e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16333
2024-11-07 08:22:53 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.699, ntokens=17722.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.99, wps=3353.2, ups=0.19, wpb=17722.3, bsz=1024, num_updates=2600, lr=4.96545e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16386
2024-11-07 08:23:46 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.686, ntokens=17398.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.87, wps=3260.1, ups=0.19, wpb=17398.3, bsz=1024, num_updates=2610, lr=4.96409e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=16440
2024-11-07 08:24:39 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=17221.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=3240.1, ups=0.19, wpb=17221.4, bsz=1024, num_updates=2620, lr=4.96273e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16493
2024-11-07 08:25:33 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=17171.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=3222.4, ups=0.19, wpb=17171.3, bsz=1024, num_updates=2630, lr=4.96136e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16546
2024-11-07 08:26:26 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=17258.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.69, wps=3234.8, ups=0.19, wpb=17258.2, bsz=1024, num_updates=2640, lr=4.96e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16599
2024-11-07 08:27:19 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.654, ntokens=17431.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.59, wps=3291.3, ups=0.19, wpb=17431.3, bsz=1024, num_updates=2650, lr=4.95864e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16652
2024-11-07 08:28:12 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.689, ntokens=17414.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.9, wps=3298.3, ups=0.19, wpb=17414.6, bsz=1024, num_updates=2660, lr=4.95728e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16705
2024-11-07 08:29:05 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=17356, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=3248.1, ups=0.19, wpb=17356, bsz=1024, num_updates=2670, lr=4.95592e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=16759
2024-11-07 08:29:58 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.635, ntokens=17306.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.42, wps=3246.3, ups=0.19, wpb=17306.2, bsz=1024, num_updates=2680, lr=4.95456e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16812
2024-11-07 08:30:51 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.62, ntokens=17215.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.29, wps=3273.6, ups=0.19, wpb=17215.6, bsz=1024, num_updates=2690, lr=4.9532e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16865
2024-11-07 08:31:44 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.664, ntokens=17631.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.67, wps=3314.9, ups=0.19, wpb=17631.8, bsz=1024, num_updates=2700, lr=4.95184e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=31, gb_free=13.3, wall=16918
2024-11-07 08:32:38 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.672, ntokens=17736.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.75, wps=3329.2, ups=0.19, wpb=17736.2, bsz=1024, num_updates=2710, lr=4.95048e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=16971
2024-11-07 08:33:30 - progress_bar.py[line:274] - INFO: epoch 007:    374 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.763, ntokens=17579.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.58, wps=3379.2, ups=0.19, wpb=17579.1, bsz=1024, num_updates=2720, lr=4.94912e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17023
2024-11-07 08:34:21 - progress_bar.py[line:274] - INFO: epoch 007:    384 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.836, ntokens=17637.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.28, wps=3448.6, ups=0.2, wpb=17637.2, bsz=1024, num_updates=2730, lr=4.94776e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17074
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt2024-11-07 08:34:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2737 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt


cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
2024-11-07 08:34:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 08:36:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 08:38:35 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2737 updates, score 0) (writing took 221.51980265500606 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
2024-11-07 08:39:29 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-07 08:39:29 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.697 | ntokens 17356.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.97 | wps 2701.9 | ups 0.16 | wpb 17356.1 | bsz 1023 | num_updates 2737 | lr 4.94681e-05 | gnorm 0.008 | clip 0 | loss_scale 4096 | train_wall 1187 | gb_free 13.2 | wall 17383
2024-11-07 08:39:29 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 08:42:09 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-07 08:42:09 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 08:42:27 - progress_bar.py[line:274] - INFO: epoch 008:      3 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.745, ntokens=16701.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=343.1, ups=0.02, wpb=16701.5, bsz=985.6, num_updates=2740, lr=4.9464e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=29, gb_free=13.6, wall=17561
2024-11-07 08:43:21 - progress_bar.py[line:274] - INFO: epoch 008:     13 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.613, ntokens=17282.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.24, wps=3254.8, ups=0.19, wpb=17282.2, bsz=1024, num_updates=2750, lr=4.94504e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=17614
2024-11-07 08:44:14 - progress_bar.py[line:274] - INFO: epoch 008:     23 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.678, ntokens=17443.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.8, wps=3275.4, ups=0.19, wpb=17443.5, bsz=1024, num_updates=2760, lr=4.94368e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17667
2024-11-07 08:45:07 - progress_bar.py[line:274] - INFO: epoch 008:     33 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=17217.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3221.6, ups=0.19, wpb=17217.5, bsz=1024, num_updates=2770, lr=4.94232e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17721
2024-11-07 08:46:01 - progress_bar.py[line:274] - INFO: epoch 008:     43 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.617, ntokens=17338.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.27, wps=3257, ups=0.19, wpb=17338.6, bsz=1024, num_updates=2780, lr=4.94096e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17774
2024-11-07 08:46:53 - progress_bar.py[line:274] - INFO: epoch 008:     53 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.6, ntokens=17443.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.12, wps=3314.5, ups=0.19, wpb=17443.7, bsz=1024, num_updates=2790, lr=4.9396e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17827
2024-11-07 08:47:47 - progress_bar.py[line:274] - INFO: epoch 008:     63 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.546, ntokens=17049.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.68, wps=3174.5, ups=0.19, wpb=17049.6, bsz=1024, num_updates=2800, lr=4.93824e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=17880
2024-11-07 08:48:40 - progress_bar.py[line:274] - INFO: epoch 008:     73 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.621, ntokens=17328.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.3, wps=3267.6, ups=0.19, wpb=17328.1, bsz=1024, num_updates=2810, lr=4.93688e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=17933
2024-11-07 08:49:36 - progress_bar.py[line:274] - INFO: epoch 008:     83 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.619, ntokens=17280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3092.5, ups=0.18, wpb=17280.7, bsz=1024, num_updates=2820, lr=4.93552e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=45, gb_free=13.4, wall=17989
2024-11-07 08:50:31 - progress_bar.py[line:274] - INFO: epoch 008:     93 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.577, ntokens=17254.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=3106.9, ups=0.18, wpb=17254.8, bsz=1024, num_updates=2830, lr=4.93416e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=55, gb_free=13.5, wall=18045
2024-11-07 08:51:27 - progress_bar.py[line:274] - INFO: epoch 008:    103 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.637, ntokens=17546.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.44, wps=3171.7, ups=0.18, wpb=17546.9, bsz=1024, num_updates=2840, lr=4.9328e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=55, gb_free=13.4, wall=18100
2024-11-07 08:52:19 - progress_bar.py[line:274] - INFO: epoch 008:    113 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=17328.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.14, wps=3301.1, ups=0.19, wpb=17328.4, bsz=1024, num_updates=2850, lr=4.93144e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=52, gb_free=13.6, wall=18153
2024-11-07 08:53:11 - progress_bar.py[line:274] - INFO: epoch 008:    123 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.607, ntokens=17307.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.19, wps=3353.1, ups=0.19, wpb=17307.3, bsz=1024, num_updates=2860, lr=4.93008e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=47, gb_free=13, wall=18204
2024-11-07 08:54:03 - progress_bar.py[line:274] - INFO: epoch 008:    133 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.626, ntokens=17507.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.34, wps=3367.8, ups=0.19, wpb=17507.4, bsz=1024, num_updates=2870, lr=4.92872e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=33, gb_free=13.6, wall=18256
2024-11-07 08:54:56 - progress_bar.py[line:274] - INFO: epoch 008:    143 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.562, ntokens=17107.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.81, wps=3216, ups=0.19, wpb=17107.7, bsz=1024, num_updates=2880, lr=4.92735e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18309
2024-11-07 08:55:49 - progress_bar.py[line:274] - INFO: epoch 008:    153 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=17348.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.08, wps=3239.9, ups=0.19, wpb=17348.1, bsz=1024, num_updates=2890, lr=4.92599e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18363
2024-11-07 08:56:43 - progress_bar.py[line:274] - INFO: epoch 008:    163 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=17290.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3239.9, ups=0.19, wpb=17290.9, bsz=1024, num_updates=2900, lr=4.92463e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18416
2024-11-07 08:57:36 - progress_bar.py[line:274] - INFO: epoch 008:    173 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.584, ntokens=17269.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.99, wps=3274.4, ups=0.19, wpb=17269.6, bsz=1024, num_updates=2910, lr=4.92327e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18469
2024-11-07 08:58:29 - progress_bar.py[line:274] - INFO: epoch 008:    183 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.568, ntokens=17277, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.86, wps=3260.4, ups=0.19, wpb=17277, bsz=1024, num_updates=2920, lr=4.92191e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18522
2024-11-07 08:59:21 - progress_bar.py[line:274] - INFO: epoch 008:    193 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.574, ntokens=17276.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.91, wps=3267.4, ups=0.19, wpb=17276.4, bsz=1024, num_updates=2930, lr=4.92055e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18575
2024-11-07 09:00:15 - progress_bar.py[line:274] - INFO: epoch 008:    203 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.631, ntokens=17350.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.38, wps=3265.6, ups=0.19, wpb=17350.6, bsz=1024, num_updates=2940, lr=4.91919e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18628
2024-11-07 09:01:08 - progress_bar.py[line:274] - INFO: epoch 008:    213 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=17130.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=3188.3, ups=0.19, wpb=17130.7, bsz=1024, num_updates=2950, lr=4.91783e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18682
2024-11-07 09:02:02 - progress_bar.py[line:274] - INFO: epoch 008:    223 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.577, ntokens=17186.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3196.3, ups=0.19, wpb=17186.4, bsz=1024, num_updates=2960, lr=4.91647e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18736
2024-11-07 09:02:55 - progress_bar.py[line:274] - INFO: epoch 008:    233 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.579, ntokens=17446.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.95, wps=3269.5, ups=0.19, wpb=17446.4, bsz=1024, num_updates=2970, lr=4.91511e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18789
2024-11-07 09:03:49 - progress_bar.py[line:274] - INFO: epoch 008:    243 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=17269.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=3231.9, ups=0.19, wpb=17269.2, bsz=1024, num_updates=2980, lr=4.91375e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18842
2024-11-07 09:04:42 - progress_bar.py[line:274] - INFO: epoch 008:    253 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.594, ntokens=17507.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.08, wps=3327.6, ups=0.19, wpb=17507.5, bsz=1024, num_updates=2990, lr=4.91239e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18895
2024-11-07 09:05:34 - progress_bar.py[line:274] - INFO: epoch 008:    263 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.58, ntokens=17368, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.96, wps=3277.5, ups=0.19, wpb=17368, bsz=1024, num_updates=3000, lr=4.91103e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18948
2024-11-07 09:06:28 - progress_bar.py[line:274] - INFO: epoch 008:    273 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.581, ntokens=17322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.97, wps=3246.4, ups=0.19, wpb=17322.9, bsz=1024, num_updates=3010, lr=4.90967e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19001
2024-11-07 09:07:21 - progress_bar.py[line:274] - INFO: epoch 008:    283 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.525, ntokens=17312.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.51, wps=3263.2, ups=0.19, wpb=17312.1, bsz=1024, num_updates=3020, lr=4.90831e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19054
2024-11-07 09:08:15 - progress_bar.py[line:274] - INFO: epoch 008:    293 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=17304.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=3225.4, ups=0.19, wpb=17304.7, bsz=1024, num_updates=3030, lr=4.90695e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19108
2024-11-07 09:09:08 - progress_bar.py[line:274] - INFO: epoch 008:    303 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.548, ntokens=17309.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.7, wps=3260.9, ups=0.19, wpb=17309.9, bsz=1024, num_updates=3040, lr=4.90559e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=19161
2024-11-07 09:10:01 - progress_bar.py[line:274] - INFO: epoch 008:    313 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.561, ntokens=17204.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.8, wps=3226.9, ups=0.19, wpb=17204.9, bsz=1024, num_updates=3050, lr=4.90423e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=19214
2024-11-07 09:10:54 - progress_bar.py[line:274] - INFO: epoch 008:    323 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=17271.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=3252.8, ups=0.19, wpb=17271.6, bsz=1024, num_updates=3060, lr=4.90287e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.1, wall=19268
2024-11-07 09:11:47 - progress_bar.py[line:274] - INFO: epoch 008:    333 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.562, ntokens=17320.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.81, wps=3262.6, ups=0.19, wpb=17320.7, bsz=1024, num_updates=3070, lr=4.90151e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=19321
2024-11-07 09:12:40 - progress_bar.py[line:274] - INFO: epoch 008:    343 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.55, ntokens=17337.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.71, wps=3256.3, ups=0.19, wpb=17337.1, bsz=1024, num_updates=3080, lr=4.90015e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19374
2024-11-07 09:13:34 - progress_bar.py[line:274] - INFO: epoch 008:    353 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.583, ntokens=17594.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.99, wps=3274.3, ups=0.19, wpb=17594.3, bsz=1024, num_updates=3090, lr=4.89879e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=19428
2024-11-07 09:14:27 - progress_bar.py[line:274] - INFO: epoch 008:    363 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.56, ntokens=17590.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.79, wps=3335.5, ups=0.19, wpb=17590.3, bsz=1024, num_updates=3100, lr=4.89743e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=19480
2024-11-07 09:15:20 - progress_bar.py[line:274] - INFO: epoch 008:    373 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.683, ntokens=17664.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.85, wps=3302.7, ups=0.19, wpb=17664.5, bsz=1024, num_updates=3110, lr=4.89607e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=12.8, wall=19534
2024-11-07 09:16:12 - progress_bar.py[line:274] - INFO: epoch 008:    383 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=17433.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=3397.5, ups=0.19, wpb=17433.6, bsz=1024, num_updates=3120, lr=4.89471e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=19585
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt2024-11-07 09:16:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 3128 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-07 09:16:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:18:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-07 09:20:31 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 3128 updates, score 0) (writing took 221.2953284799878 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
2024-11-07 09:21:26 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-07 09:21:26 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.595 | ntokens 17324.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.09 | wps 2691.8 | ups 0.16 | wpb 17324.5 | bsz 1023 | num_updates 3128 | lr 4.89362e-05 | gnorm 0.008 | clip 0 | loss_scale 8192 | train_wall 1293 | gb_free 13.2 | wall 19899
2024-11-07 09:21:26 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 09:24:06 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-07 09:24:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 09:24:19 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.695, ntokens=16820.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=345.3, ups=0.02, wpb=16820.7, bsz=985.6, num_updates=3130, lr=4.89334e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=29, gb_free=13.5, wall=20072
2024-11-07 09:25:12 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=17388.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3276, ups=0.19, wpb=17388.3, bsz=1024, num_updates=3140, lr=4.89198e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.6, wall=20125
2024-11-07 09:26:05 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.579, ntokens=17392.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.95, wps=3254.8, ups=0.19, wpb=17392.7, bsz=1024, num_updates=3150, lr=4.89062e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=31, gb_free=13.6, wall=20179
2024-11-07 09:26:58 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.533, ntokens=17174.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.58, wps=3252.3, ups=0.19, wpb=17174.6, bsz=1024, num_updates=3160, lr=4.88926e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20232
2024-11-07 09:27:51 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=17454.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=3283.1, ups=0.19, wpb=17454.8, bsz=1024, num_updates=3170, lr=4.8879e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=20285
2024-11-07 09:28:44 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=17346.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=3299.6, ups=0.19, wpb=17346.3, bsz=1024, num_updates=3180, lr=4.88654e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20337
2024-11-07 09:29:37 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.469, ntokens=17143.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3233.5, ups=0.19, wpb=17143.2, bsz=1024, num_updates=3190, lr=4.88518e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20390
2024-11-07 09:30:30 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.497, ntokens=17153.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.29, wps=3243.8, ups=0.19, wpb=17153.5, bsz=1024, num_updates=3200, lr=4.88382e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=20443
2024-11-07 09:31:23 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=17614.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=3321.8, ups=0.19, wpb=17614.2, bsz=1024, num_updates=3210, lr=4.88246e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20496
2024-11-07 09:32:16 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.521, ntokens=17204, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=3231, ups=0.19, wpb=17204, bsz=1024, num_updates=3220, lr=4.8811e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20550
2024-11-07 09:33:09 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.571, ntokens=17617.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.89, wps=3324.8, ups=0.19, wpb=17617.7, bsz=1024, num_updates=3230, lr=4.87974e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20603
2024-11-07 09:34:02 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.524, ntokens=17149, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.5, wps=3215.7, ups=0.19, wpb=17149, bsz=1024, num_updates=3240, lr=4.87838e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20656
2024-11-07 09:34:56 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.549, ntokens=17441.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.7, wps=3269.3, ups=0.19, wpb=17441.8, bsz=1024, num_updates=3250, lr=4.87702e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20709
2024-11-07 09:35:49 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=17554.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=3317.6, ups=0.19, wpb=17554.6, bsz=1024, num_updates=3260, lr=4.87566e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20762
2024-11-07 09:36:42 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=16985.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=3163.1, ups=0.19, wpb=16985.9, bsz=1024, num_updates=3270, lr=4.8743e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20816
2024-11-07 09:37:35 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.507, ntokens=17253.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.37, wps=3245.9, ups=0.19, wpb=17253.5, bsz=1024, num_updates=3280, lr=4.87294e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20869
2024-11-07 09:38:29 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.521, ntokens=17271.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=3252.1, ups=0.19, wpb=17271.9, bsz=1024, num_updates=3290, lr=4.87158e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20922
2024-11-07 09:39:22 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.525, ntokens=17344.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.51, wps=3226.3, ups=0.19, wpb=17344.3, bsz=1024, num_updates=3300, lr=4.87022e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=20976
2024-11-07 09:40:15 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.528, ntokens=17533.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.53, wps=3328.2, ups=0.19, wpb=17533.2, bsz=1024, num_updates=3310, lr=4.86886e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21029
2024-11-07 09:41:08 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.505, ntokens=17045.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.35, wps=3191.2, ups=0.19, wpb=17045.2, bsz=1024, num_updates=3320, lr=4.8675e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21082
2024-11-07 09:42:01 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.488, ntokens=17216.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.22, wps=3269.2, ups=0.19, wpb=17216.2, bsz=1024, num_updates=3330, lr=4.86614e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.6, wall=21135
2024-11-07 09:42:54 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.491, ntokens=16984.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=3218.8, ups=0.19, wpb=16984.7, bsz=1024, num_updates=3340, lr=4.86478e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=21187
2024-11-07 09:43:46 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.47, ntokens=17054.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.08, wps=3253.4, ups=0.19, wpb=17054.7, bsz=1024, num_updates=3350, lr=4.86342e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21240
2024-11-07 09:44:39 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.508, ntokens=17538.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.38, wps=3302.6, ups=0.19, wpb=17538.4, bsz=1024, num_updates=3360, lr=4.86206e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21293
2024-11-07 09:45:32 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.46, ntokens=17091.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11, wps=3232.3, ups=0.19, wpb=17091.4, bsz=1024, num_updates=3370, lr=4.8607e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21346
2024-11-07 09:46:25 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.54, ntokens=17728.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.63, wps=3334, ups=0.19, wpb=17728.3, bsz=1024, num_updates=3380, lr=4.85934e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21399
2024-11-07 09:47:19 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.523, ntokens=17493.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.5, wps=3295.6, ups=0.19, wpb=17493.2, bsz=1024, num_updates=3390, lr=4.85797e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=21452
2024-11-07 09:48:11 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.527, ntokens=17326, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.53, wps=3278.5, ups=0.19, wpb=17326, bsz=1024, num_updates=3400, lr=4.85661e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=21505
2024-11-07 09:49:04 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.457, ntokens=17167.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=3272.4, ups=0.19, wpb=17167.6, bsz=1024, num_updates=3410, lr=4.85525e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21557
2024-11-07 09:49:57 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.503, ntokens=17148.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.33, wps=3237.1, ups=0.19, wpb=17148.2, bsz=1024, num_updates=3420, lr=4.85389e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21610
2024-11-07 09:50:50 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.453, ntokens=17146.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=3237.2, ups=0.19, wpb=17146.4, bsz=1024, num_updates=3430, lr=4.85253e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=21663
2024-11-07 09:51:43 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.525, ntokens=17286.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.51, wps=3277.8, ups=0.19, wpb=17286.2, bsz=1024, num_updates=3440, lr=4.85117e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21716
2024-11-07 09:52:36 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.499, ntokens=17275.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.31, wps=3231.2, ups=0.19, wpb=17275.4, bsz=1024, num_updates=3450, lr=4.84981e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21769
2024-11-07 09:53:29 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=17253.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3265.9, ups=0.19, wpb=17253.2, bsz=1024, num_updates=3460, lr=4.84845e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21822
2024-11-07 09:54:22 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.49, ntokens=17484.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=3291, ups=0.19, wpb=17484.5, bsz=1024, num_updates=3470, lr=4.84709e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=21875
2024-11-07 09:55:15 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.501, ntokens=17329.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.33, wps=3278.6, ups=0.19, wpb=17329.3, bsz=1024, num_updates=3480, lr=4.84573e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21928
2024-11-07 09:56:08 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.506, ntokens=17638.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.36, wps=3308.8, ups=0.19, wpb=17638.4, bsz=1024, num_updates=3490, lr=4.84437e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21982
2024-11-07 09:57:00 - progress_bar.py[line:274] - INFO: epoch 009:    372 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.651, ntokens=17953.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.56, wps=3430.6, ups=0.19, wpb=17953.3, bsz=1024, num_updates=3500, lr=4.84301e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22034
2024-11-07 09:57:53 - progress_bar.py[line:274] - INFO: epoch 009:    382 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.67, ntokens=17403.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.73, wps=3305.1, ups=0.19, wpb=17403.6, bsz=1024, num_updates=3510, lr=4.84165e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22087
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt2024-11-07 09:58:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3519 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-07 09:58:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists: File exists

: File exists: File exists: File exists

: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 09:59:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000



slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-07 10:02:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3519 updates, score 0) (writing took 211.15634601100464 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-07 10:03:01 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-07 10:03:01 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.527 | ntokens 17320.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.53 | wps 2713.9 | ups 0.16 | wpb 17320.1 | bsz 1023 | num_updates 3519 | lr 4.84043e-05 | gnorm 0.007 | clip 0 | loss_scale 8192 | train_wall 1186 | gb_free 13.2 | wall 22395
2024-11-07 10:03:01 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 10:05:41 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-07 10:05:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 10:05:49 - progress_bar.py[line:274] - INFO: epoch 010:      1 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.66, ntokens=16894.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=355, ups=0.02, wpb=16894.9, bsz=985.6, num_updates=3520, lr=4.84029e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=29, gb_free=13.4, wall=22562
2024-11-07 10:06:42 - progress_bar.py[line:274] - INFO: epoch 010:     11 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.532, ntokens=17520, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=3328, ups=0.19, wpb=17520, bsz=1024, num_updates=3530, lr=4.83893e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22615
2024-11-07 10:07:35 - progress_bar.py[line:274] - INFO: epoch 010:     21 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.505, ntokens=17302.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.35, wps=3267.2, ups=0.19, wpb=17302.3, bsz=1024, num_updates=3540, lr=4.83757e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22668
2024-11-07 10:08:28 - progress_bar.py[line:274] - INFO: epoch 010:     31 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.507, ntokens=17263.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.37, wps=3254, ups=0.19, wpb=17263.1, bsz=1024, num_updates=3550, lr=4.83621e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=22721
2024-11-07 10:09:21 - progress_bar.py[line:274] - INFO: epoch 010:     41 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.498, ntokens=17433, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.3, wps=3286.8, ups=0.19, wpb=17433, bsz=1024, num_updates=3560, lr=4.83485e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=22774
2024-11-07 10:10:14 - progress_bar.py[line:274] - INFO: epoch 010:     51 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=17524.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=3288.7, ups=0.19, wpb=17524.4, bsz=1024, num_updates=3570, lr=4.83349e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22827
2024-11-07 10:11:07 - progress_bar.py[line:274] - INFO: epoch 010:     61 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=17038, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=3203.3, ups=0.19, wpb=17038, bsz=1024, num_updates=3580, lr=4.83213e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=22881
2024-11-07 10:12:01 - progress_bar.py[line:274] - INFO: epoch 010:     71 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.44, ntokens=17128.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.86, wps=3195, ups=0.19, wpb=17128.8, bsz=1024, num_updates=3590, lr=4.83077e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=22934
2024-11-07 10:12:54 - progress_bar.py[line:274] - INFO: epoch 010:     81 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.53, ntokens=17500.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.55, wps=3268.7, ups=0.19, wpb=17500.4, bsz=1024, num_updates=3600, lr=4.82941e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=22988
2024-11-07 10:13:47 - progress_bar.py[line:274] - INFO: epoch 010:     91 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.457, ntokens=17293.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=3252.3, ups=0.19, wpb=17293.7, bsz=1024, num_updates=3610, lr=4.82805e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23041
2024-11-07 10:14:41 - progress_bar.py[line:274] - INFO: epoch 010:    101 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.496, ntokens=17392.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=3254.5, ups=0.19, wpb=17392.6, bsz=1024, num_updates=3620, lr=4.82669e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23094
2024-11-07 10:15:34 - progress_bar.py[line:274] - INFO: epoch 010:    111 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.482, ntokens=17176.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.17, wps=3214.4, ups=0.19, wpb=17176.8, bsz=1024, num_updates=3630, lr=4.82533e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23148
2024-11-07 10:16:27 - progress_bar.py[line:274] - INFO: epoch 010:    121 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.469, ntokens=17437.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3283.2, ups=0.19, wpb=17437.3, bsz=1024, num_updates=3640, lr=4.82396e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23201
2024-11-07 10:17:20 - progress_bar.py[line:274] - INFO: epoch 010:    131 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.501, ntokens=17316.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.32, wps=3266.7, ups=0.19, wpb=17316.7, bsz=1024, num_updates=3650, lr=4.8226e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23254
2024-11-07 10:18:14 - progress_bar.py[line:274] - INFO: epoch 010:    141 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.482, ntokens=17200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.18, wps=3224.3, ups=0.19, wpb=17200.2, bsz=1024, num_updates=3660, lr=4.82124e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23307
2024-11-07 10:19:07 - progress_bar.py[line:274] - INFO: epoch 010:    151 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.449, ntokens=17287.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.92, wps=3254.9, ups=0.19, wpb=17287.5, bsz=1024, num_updates=3670, lr=4.81988e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=23360
2024-11-07 10:20:00 - progress_bar.py[line:274] - INFO: epoch 010:    161 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=17327.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=3235.5, ups=0.19, wpb=17327.3, bsz=1024, num_updates=3680, lr=4.81852e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23414
2024-11-07 10:20:53 - progress_bar.py[line:274] - INFO: epoch 010:    171 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.459, ntokens=17392.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=3282.1, ups=0.19, wpb=17392.8, bsz=1024, num_updates=3690, lr=4.81716e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23467
2024-11-07 10:21:47 - progress_bar.py[line:274] - INFO: epoch 010:    181 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.49, ntokens=17476.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=3288.2, ups=0.19, wpb=17476.1, bsz=1024, num_updates=3700, lr=4.8158e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23520
2024-11-07 10:22:40 - progress_bar.py[line:274] - INFO: epoch 010:    191 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=17206.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=3250.4, ups=0.19, wpb=17206.2, bsz=1024, num_updates=3710, lr=4.81444e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23573
2024-11-07 10:23:33 - progress_bar.py[line:274] - INFO: epoch 010:    201 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.468, ntokens=17228.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3207.8, ups=0.19, wpb=17228.9, bsz=1024, num_updates=3720, lr=4.81308e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23627
2024-11-07 10:24:27 - progress_bar.py[line:274] - INFO: epoch 010:    211 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.42, ntokens=17183.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.71, wps=3194.1, ups=0.19, wpb=17183.3, bsz=1024, num_updates=3730, lr=4.81172e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23681
2024-11-07 10:25:20 - progress_bar.py[line:274] - INFO: epoch 010:    221 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.465, ntokens=17160.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.04, wps=3223.6, ups=0.19, wpb=17160.6, bsz=1024, num_updates=3740, lr=4.81036e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=23734
2024-11-07 10:26:14 - progress_bar.py[line:274] - INFO: epoch 010:    231 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=17725.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3319.3, ups=0.19, wpb=17725.4, bsz=1024, num_updates=3750, lr=4.809e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23787
2024-11-07 10:27:07 - progress_bar.py[line:274] - INFO: epoch 010:    241 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=17142.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3217.9, ups=0.19, wpb=17142.3, bsz=1024, num_updates=3760, lr=4.80764e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=23840
2024-11-07 10:28:00 - progress_bar.py[line:274] - INFO: epoch 010:    251 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.477, ntokens=17597.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=3302.7, ups=0.19, wpb=17597.8, bsz=1024, num_updates=3770, lr=4.80628e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23894
2024-11-07 10:28:53 - progress_bar.py[line:274] - INFO: epoch 010:    261 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=17172.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=3275.5, ups=0.19, wpb=17172.1, bsz=1024, num_updates=3780, lr=4.80492e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23946
2024-11-07 10:29:46 - progress_bar.py[line:274] - INFO: epoch 010:    271 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.445, ntokens=17205.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.89, wps=3238.2, ups=0.19, wpb=17205.5, bsz=1024, num_updates=3790, lr=4.80356e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23999
2024-11-07 10:30:39 - progress_bar.py[line:274] - INFO: epoch 010:    281 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=17353.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=3255.8, ups=0.19, wpb=17353.4, bsz=1024, num_updates=3800, lr=4.8022e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24053
2024-11-07 10:31:32 - progress_bar.py[line:274] - INFO: epoch 010:    291 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.446, ntokens=17234.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=3260.3, ups=0.19, wpb=17234.8, bsz=1024, num_updates=3810, lr=4.80084e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=24105
2024-11-07 10:32:26 - progress_bar.py[line:274] - INFO: epoch 010:    301 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.464, ntokens=17438.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.04, wps=3258.3, ups=0.19, wpb=17438.7, bsz=1024, num_updates=3820, lr=4.79948e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24159
2024-11-07 10:33:19 - progress_bar.py[line:274] - INFO: epoch 010:    311 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.53, ntokens=17349.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.55, wps=3270.3, ups=0.19, wpb=17349.3, bsz=1024, num_updates=3830, lr=4.79812e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=24212
2024-11-07 10:34:12 - progress_bar.py[line:274] - INFO: epoch 010:    321 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.452, ntokens=17301.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.94, wps=3220.9, ups=0.19, wpb=17301.7, bsz=1024, num_updates=3840, lr=4.79676e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24266
2024-11-07 10:35:06 - progress_bar.py[line:274] - INFO: epoch 010:    331 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=17147.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3196.5, ups=0.19, wpb=17147.7, bsz=1024, num_updates=3850, lr=4.7954e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=24319
2024-11-07 10:36:00 - progress_bar.py[line:274] - INFO: epoch 010:    341 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.431, ntokens=17435.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.79, wps=3250.3, ups=0.19, wpb=17435.8, bsz=1024, num_updates=3860, lr=4.79404e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=24373
2024-11-07 10:36:53 - progress_bar.py[line:274] - INFO: epoch 010:    351 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.513, ntokens=17591.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.42, wps=3265.7, ups=0.19, wpb=17591.9, bsz=1024, num_updates=3870, lr=4.79268e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24427
2024-11-07 10:37:47 - progress_bar.py[line:274] - INFO: epoch 010:    361 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.434, ntokens=17443.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.81, wps=3254.9, ups=0.19, wpb=17443.9, bsz=1024, num_updates=3880, lr=4.79132e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24481
2024-11-07 10:38:40 - progress_bar.py[line:274] - INFO: epoch 010:    371 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.556, ntokens=17616, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.76, wps=3318.2, ups=0.19, wpb=17616, bsz=1024, num_updates=3890, lr=4.78995e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24534
2024-11-07 10:39:31 - progress_bar.py[line:274] - INFO: epoch 010:    381 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.629, ntokens=17640.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.37, wps=3451.5, ups=0.2, wpb=17640.6, bsz=1024, num_updates=3900, lr=4.78859e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24585
2024-11-07 10:40:20 - progress_bar.py[line:274] - INFO: epoch 010:    391 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.664, ntokens=16836.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=3482.3, ups=0.21, wpb=16836.9, bsz=985.6, num_updates=3910, lr=4.78723e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=29, gb_free=13.2, wall=24633
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

2024-11-07 10:40:20 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3910 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
2024-11-07 10:40:20 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 10:42:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 10:43:59 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3910 updates, score 0) (writing took 219.8397065269819 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 10:44:54 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-07 10:44:54 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.481 | ntokens 17334.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.17 | wps 2697.3 | ups 0.16 | wpb 17334.5 | bsz 1023 | num_updates 3910 | lr 4.78723e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1186 | gb_free 13.2 | wall 24907
2024-11-07 10:44:54 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 10:47:34 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-07 10:47:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 10:48:29 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.486, ntokens=17580.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.2, wps=358.9, ups=0.02, wpb=17580.5, bsz=1024, num_updates=3920, lr=4.78587e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25123
2024-11-07 10:49:22 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.463, ntokens=17219.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.02, wps=3256.3, ups=0.19, wpb=17219.8, bsz=1024, num_updates=3930, lr=4.78451e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=25176
2024-11-07 10:50:16 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.44, ntokens=17390, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=3252.5, ups=0.19, wpb=17390, bsz=1024, num_updates=3940, lr=4.78315e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=25229
2024-11-07 10:51:09 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=17383.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=3257.3, ups=0.19, wpb=17383.6, bsz=1024, num_updates=3950, lr=4.78179e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25283
2024-11-07 10:52:02 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17462.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3300.6, ups=0.19, wpb=17462.8, bsz=1024, num_updates=3960, lr=4.78043e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25335
2024-11-07 10:52:55 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=17184.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=3236.4, ups=0.19, wpb=17184.1, bsz=1024, num_updates=3970, lr=4.77907e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=25389
2024-11-07 10:53:48 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=17043.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=3223.1, ups=0.19, wpb=17043.7, bsz=1024, num_updates=3980, lr=4.77771e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25441
2024-11-07 10:54:41 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.46, ntokens=17333.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.01, wps=3257.9, ups=0.19, wpb=17333.6, bsz=1024, num_updates=3990, lr=4.77635e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25495
2024-11-07 10:55:35 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=17197.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=3212.6, ups=0.19, wpb=17197.6, bsz=1024, num_updates=4000, lr=4.77499e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25548
2024-11-07 10:56:28 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.457, ntokens=17442.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=3285, ups=0.19, wpb=17442.6, bsz=1024, num_updates=4010, lr=4.77363e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25601
2024-11-07 10:57:22 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.469, ntokens=17281.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3218.1, ups=0.19, wpb=17281.7, bsz=1024, num_updates=4020, lr=4.77227e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25655
2024-11-07 10:58:15 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.443, ntokens=17415, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.87, wps=3260.3, ups=0.19, wpb=17415, bsz=1024, num_updates=4030, lr=4.77091e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25708
2024-11-07 10:59:08 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.426, ntokens=17285, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.75, wps=3267.4, ups=0.19, wpb=17285, bsz=1024, num_updates=4040, lr=4.76955e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=25761
2024-11-07 11:00:01 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.424, ntokens=17111.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=3206.2, ups=0.19, wpb=17111.3, bsz=1024, num_updates=4050, lr=4.76819e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25815
2024-11-07 11:00:54 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=17052.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=3207.3, ups=0.19, wpb=17052.3, bsz=1024, num_updates=4060, lr=4.76683e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25868
2024-11-07 11:01:47 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=17276.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.87, wps=3274.6, ups=0.19, wpb=17276.7, bsz=1024, num_updates=4070, lr=4.76547e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=25921
2024-11-07 11:02:40 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.439, ntokens=17365.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=3266.5, ups=0.19, wpb=17365.7, bsz=1024, num_updates=4080, lr=4.76411e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=25974
2024-11-07 11:03:33 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.46, ntokens=17682.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11, wps=3345.1, ups=0.19, wpb=17682.2, bsz=1024, num_updates=4090, lr=4.76275e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=26027
2024-11-07 11:04:26 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.462, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.02, wps=3241.3, ups=0.19, wpb=17291.2, bsz=1024, num_updates=4100, lr=4.76139e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26080
2024-11-07 11:05:19 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=17044, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3218.8, ups=0.19, wpb=17044, bsz=1024, num_updates=4110, lr=4.76003e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26133
2024-11-07 11:05:30 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 11:06:19 - progress_bar.py[line:274] - INFO: epoch 011:    211 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=16993.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=2866.4, ups=0.17, wpb=16993.2, bsz=1024, num_updates=4120, lr=4.75867e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=33, gb_free=13.4, wall=26192
2024-11-07 11:07:11 - progress_bar.py[line:274] - INFO: epoch 011:    221 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.43, ntokens=17167.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.78, wps=3260.5, ups=0.19, wpb=17167.4, bsz=1024, num_updates=4130, lr=4.75731e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26245
2024-11-07 11:08:05 - progress_bar.py[line:274] - INFO: epoch 011:    231 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=17512.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=3269.9, ups=0.19, wpb=17512.8, bsz=1024, num_updates=4140, lr=4.75594e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26298
2024-11-07 11:08:58 - progress_bar.py[line:274] - INFO: epoch 011:    241 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17020.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3213.5, ups=0.19, wpb=17020.7, bsz=1024, num_updates=4150, lr=4.75458e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=26351
2024-11-07 11:09:51 - progress_bar.py[line:274] - INFO: epoch 011:    251 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.434, ntokens=17674, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.81, wps=3303.9, ups=0.19, wpb=17674, bsz=1024, num_updates=4160, lr=4.75322e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26405
2024-11-07 11:10:44 - progress_bar.py[line:274] - INFO: epoch 011:    261 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.417, ntokens=17313.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.68, wps=3277, ups=0.19, wpb=17313.9, bsz=1024, num_updates=4170, lr=4.75186e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=26458
2024-11-07 11:11:37 - progress_bar.py[line:274] - INFO: epoch 011:    271 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.447, ntokens=17471.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=3312.8, ups=0.19, wpb=17471.3, bsz=1024, num_updates=4180, lr=4.7505e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26510
2024-11-07 11:12:30 - progress_bar.py[line:274] - INFO: epoch 011:    281 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=17121.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=3223.3, ups=0.19, wpb=17121.6, bsz=1024, num_updates=4190, lr=4.74914e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26564
2024-11-07 11:13:24 - progress_bar.py[line:274] - INFO: epoch 011:    291 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=16918.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=3164.3, ups=0.19, wpb=16918.2, bsz=1024, num_updates=4200, lr=4.74778e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26617
2024-11-07 11:14:17 - progress_bar.py[line:274] - INFO: epoch 011:    301 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17515.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.71, wps=3290.6, ups=0.19, wpb=17515.4, bsz=1024, num_updates=4210, lr=4.74642e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26670
2024-11-07 11:15:10 - progress_bar.py[line:274] - INFO: epoch 011:    311 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.484, ntokens=17243.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.19, wps=3249.9, ups=0.19, wpb=17243.8, bsz=1024, num_updates=4220, lr=4.74506e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26723
2024-11-07 11:16:04 - progress_bar.py[line:274] - INFO: epoch 011:    321 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=17260.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=3211.1, ups=0.19, wpb=17260.5, bsz=1024, num_updates=4230, lr=4.7437e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26777
2024-11-07 11:17:00 - progress_bar.py[line:274] - INFO: epoch 011:    331 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=17288, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=3079.6, ups=0.18, wpb=17288, bsz=1024, num_updates=4240, lr=4.74234e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26833
2024-11-07 11:17:54 - progress_bar.py[line:274] - INFO: epoch 011:    341 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=17596.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=3247.9, ups=0.18, wpb=17596.8, bsz=1024, num_updates=4250, lr=4.74098e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=26887
2024-11-07 11:18:49 - progress_bar.py[line:274] - INFO: epoch 011:    351 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.444, ntokens=17365.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.89, wps=3180, ups=0.18, wpb=17365.3, bsz=1024, num_updates=4260, lr=4.73962e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=26942
2024-11-07 11:19:44 - progress_bar.py[line:274] - INFO: epoch 011:    361 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17544.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3185.3, ups=0.18, wpb=17544.2, bsz=1024, num_updates=4270, lr=4.73826e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26997
2024-11-07 11:20:41 - progress_bar.py[line:274] - INFO: epoch 011:    371 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=17807, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=3098.6, ups=0.17, wpb=17807, bsz=1024, num_updates=4280, lr=4.7369e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=27055
2024-11-07 11:21:37 - progress_bar.py[line:274] - INFO: epoch 011:    381 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=17582.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.16, wps=3146.2, ups=0.18, wpb=17582.7, bsz=1024, num_updates=4290, lr=4.73554e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=27110
2024-11-07 11:22:29 - progress_bar.py[line:274] - INFO: epoch 011:    391 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.55, ntokens=16566.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=11.71, wps=3165.7, ups=0.19, wpb=16566.1, bsz=985.6, num_updates=4300, lr=4.73418e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=29, gb_free=13.4, wall=27163
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-07 11:22:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4300 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-07 11:22:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 11:24:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 11:26:11 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4300 updates, score 0) (writing took 222.0328797190159 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-07 11:27:06 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-07 11:27:06 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.438 | ntokens 17307.9 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.83 | wps 2666 | ups 0.15 | wpb 17307.9 | bsz 1023 | num_updates 4300 | lr 4.73418e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1187 | gb_free 13.4 | wall 27439
2024-11-07 11:27:06 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 11:29:46 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-07 11:29:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 11:30:42 - progress_bar.py[line:274] - INFO: epoch 012:     10 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17445.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=354.2, ups=0.02, wpb=17445.1, bsz=1024, num_updates=4310, lr=4.73282e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=27655
2024-11-07 11:31:35 - progress_bar.py[line:274] - INFO: epoch 012:     20 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=17351.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=3253.6, ups=0.19, wpb=17351.6, bsz=1024, num_updates=4320, lr=4.73146e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=27709
2024-11-07 11:32:28 - progress_bar.py[line:274] - INFO: epoch 012:     30 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.437, ntokens=17231.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=3249.3, ups=0.19, wpb=17231.3, bsz=1024, num_updates=4330, lr=4.7301e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=27762
2024-11-07 11:33:22 - progress_bar.py[line:274] - INFO: epoch 012:     40 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=17212, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3214.9, ups=0.19, wpb=17212, bsz=1024, num_updates=4340, lr=4.72874e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=27815
2024-11-07 11:34:15 - progress_bar.py[line:274] - INFO: epoch 012:     50 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=17505.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3305.4, ups=0.19, wpb=17505.5, bsz=1024, num_updates=4350, lr=4.72738e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=27868
2024-11-07 11:35:08 - progress_bar.py[line:274] - INFO: epoch 012:     60 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=17258, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3246.9, ups=0.19, wpb=17258, bsz=1024, num_updates=4360, lr=4.72602e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=27921
2024-11-07 11:36:01 - progress_bar.py[line:274] - INFO: epoch 012:     70 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.328, ntokens=17035.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=3204.2, ups=0.19, wpb=17035.3, bsz=1024, num_updates=4370, lr=4.72466e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=27975
2024-11-07 11:36:54 - progress_bar.py[line:274] - INFO: epoch 012:     80 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.432, ntokens=17385.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.79, wps=3261.1, ups=0.19, wpb=17385.5, bsz=1024, num_updates=4380, lr=4.7233e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=28028
2024-11-07 11:37:48 - progress_bar.py[line:274] - INFO: epoch 012:     90 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=3249.6, ups=0.19, wpb=17291.2, bsz=1024, num_updates=4390, lr=4.72194e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=28081
2024-11-07 11:38:41 - progress_bar.py[line:274] - INFO: epoch 012:    100 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=17388.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=3266.7, ups=0.19, wpb=17388.2, bsz=1024, num_updates=4400, lr=4.72057e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=28134
2024-11-07 11:39:34 - progress_bar.py[line:274] - INFO: epoch 012:    110 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=17081.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=3183.2, ups=0.19, wpb=17081.1, bsz=1024, num_updates=4410, lr=4.71921e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=28188
2024-11-07 11:40:28 - progress_bar.py[line:274] - INFO: epoch 012:    120 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=17301.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=3250.2, ups=0.19, wpb=17301.3, bsz=1024, num_updates=4420, lr=4.71785e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=28241
2024-11-07 11:41:21 - progress_bar.py[line:274] - INFO: epoch 012:    130 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=17453.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=3289.3, ups=0.19, wpb=17453.7, bsz=1024, num_updates=4430, lr=4.71649e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=28294
2024-11-07 11:42:14 - progress_bar.py[line:274] - INFO: epoch 012:    140 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=17184.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3229.1, ups=0.19, wpb=17184.4, bsz=1024, num_updates=4440, lr=4.71513e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=28347
2024-11-07 11:43:07 - progress_bar.py[line:274] - INFO: epoch 012:    150 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17027.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3230.6, ups=0.19, wpb=17027.3, bsz=1024, num_updates=4450, lr=4.71377e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=28400
2024-11-07 11:44:00 - progress_bar.py[line:274] - INFO: epoch 012:    160 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.443, ntokens=17479.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.88, wps=3281.7, ups=0.19, wpb=17479.4, bsz=1024, num_updates=4460, lr=4.71241e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=28453
2024-11-07 11:44:53 - progress_bar.py[line:274] - INFO: epoch 012:    170 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=17185.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=3223.8, ups=0.19, wpb=17185.4, bsz=1024, num_updates=4470, lr=4.71105e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=28507
2024-11-07 11:45:47 - progress_bar.py[line:274] - INFO: epoch 012:    180 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=17388.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3247.5, ups=0.19, wpb=17388.5, bsz=1024, num_updates=4480, lr=4.70969e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=28560
2024-11-07 11:46:43 - progress_bar.py[line:274] - INFO: epoch 012:    190 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=17207.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=3053.4, ups=0.18, wpb=17207.8, bsz=1024, num_updates=4490, lr=4.70833e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=46, gb_free=13.3, wall=28617
2024-11-07 11:47:39 - progress_bar.py[line:274] - INFO: epoch 012:    200 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=16968.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3015.2, ups=0.18, wpb=16968.5, bsz=1024, num_updates=4500, lr=4.70697e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=28673
2024-11-07 11:48:36 - progress_bar.py[line:274] - INFO: epoch 012:    210 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=16941.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=3021.6, ups=0.18, wpb=16941.4, bsz=1024, num_updates=4510, lr=4.70561e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=56, gb_free=13.6, wall=28729
2024-11-07 11:49:32 - progress_bar.py[line:274] - INFO: epoch 012:    220 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=17093.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3047.9, ups=0.18, wpb=17093.8, bsz=1024, num_updates=4520, lr=4.70425e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.1, wall=28785
2024-11-07 11:50:28 - progress_bar.py[line:274] - INFO: epoch 012:    230 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=17645.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=3149.2, ups=0.18, wpb=17645.8, bsz=1024, num_updates=4530, lr=4.70289e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=28841
2024-11-07 11:51:23 - progress_bar.py[line:274] - INFO: epoch 012:    240 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=17130.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=3068.9, ups=0.18, wpb=17130.5, bsz=1024, num_updates=4540, lr=4.70153e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=28897
2024-11-07 11:52:17 - progress_bar.py[line:274] - INFO: epoch 012:    250 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.391, ntokens=17678.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=3276.8, ups=0.19, wpb=17678.8, bsz=1024, num_updates=4550, lr=4.70017e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.6, wall=28951
2024-11-07 11:53:12 - progress_bar.py[line:274] - INFO: epoch 012:    260 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=17235.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=3173.1, ups=0.18, wpb=17235.2, bsz=1024, num_updates=4560, lr=4.69881e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=29005
2024-11-07 11:54:05 - progress_bar.py[line:274] - INFO: epoch 012:    270 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=17383.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=3283.8, ups=0.19, wpb=17383.6, bsz=1024, num_updates=4570, lr=4.69745e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=29058
2024-11-07 11:55:01 - progress_bar.py[line:274] - INFO: epoch 012:    280 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.316, ntokens=17053.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.96, wps=3034.9, ups=0.18, wpb=17053.5, bsz=1024, num_updates=4580, lr=4.69609e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=29114
2024-11-07 11:55:56 - progress_bar.py[line:274] - INFO: epoch 012:    290 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.355, ntokens=17091.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.23, wps=3123.3, ups=0.18, wpb=17091.8, bsz=1024, num_updates=4590, lr=4.69473e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=12.6, wall=29169
2024-11-07 11:56:49 - progress_bar.py[line:274] - INFO: epoch 012:    300 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.352, ntokens=17329.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=3233.3, ups=0.19, wpb=17329.7, bsz=1024, num_updates=4600, lr=4.69337e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=29223
2024-11-07 11:57:45 - progress_bar.py[line:274] - INFO: epoch 012:    310 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.489, ntokens=17490.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.23, wps=3106.8, ups=0.18, wpb=17490.2, bsz=1024, num_updates=4610, lr=4.69201e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.6, wall=29279
2024-11-07 11:58:42 - progress_bar.py[line:274] - INFO: epoch 012:    320 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=17191.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3053.3, ups=0.18, wpb=17191.6, bsz=1024, num_updates=4620, lr=4.69065e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=29335
2024-11-07 11:59:34 - progress_bar.py[line:274] - INFO: epoch 012:    330 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=17253.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=3295.6, ups=0.19, wpb=17253.4, bsz=1024, num_updates=4630, lr=4.68929e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=29388
2024-11-07 12:00:27 - progress_bar.py[line:274] - INFO: epoch 012:    340 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=17352.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=3286.1, ups=0.19, wpb=17352.8, bsz=1024, num_updates=4640, lr=4.68793e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=29440
2024-11-07 12:01:20 - progress_bar.py[line:274] - INFO: epoch 012:    350 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.44, ntokens=17605.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=3321.7, ups=0.19, wpb=17605.7, bsz=1024, num_updates=4650, lr=4.68656e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=29493
2024-11-07 12:02:12 - progress_bar.py[line:274] - INFO: epoch 012:    360 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=17461.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=3346.1, ups=0.19, wpb=17461.7, bsz=1024, num_updates=4660, lr=4.6852e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=46, gb_free=13.6, wall=29546
2024-11-07 12:03:05 - progress_bar.py[line:274] - INFO: epoch 012:    370 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=17759.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3380.6, ups=0.19, wpb=17759.6, bsz=1024, num_updates=4670, lr=4.68384e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=29598
2024-11-07 12:03:56 - progress_bar.py[line:274] - INFO: epoch 012:    380 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.537, ntokens=17454.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.61, wps=3382.7, ups=0.19, wpb=17454.2, bsz=1024, num_updates=4680, lr=4.68248e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=29650
2024-11-07 12:04:48 - progress_bar.py[line:274] - INFO: epoch 012:    390 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.578, ntokens=17583.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=3413.7, ups=0.19, wpb=17583.3, bsz=1024, num_updates=4690, lr=4.68112e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=29701
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-07 12:04:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4691 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-07 12:04:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 12:06:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-07 12:08:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4691 updates, score 0) (writing took 226.84144709599786 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-07 12:09:32 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-07 12:09:32 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.399 | ntokens 17295.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.55 | wps 2655.6 | ups 0.15 | wpb 17295.4 | bsz 1023 | num_updates 4691 | lr 4.68099e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1609 | gb_free 13.2 | wall 29986
2024-11-07 12:09:32 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 12:12:13 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-07 12:12:13 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 12:13:04 - progress_bar.py[line:274] - INFO: epoch 013:      9 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=16707.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=336.5, ups=0.02, wpb=16707.1, bsz=985.6, num_updates=4700, lr=4.67976e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=29, gb_free=13.5, wall=30198
2024-11-07 12:13:58 - progress_bar.py[line:274] - INFO: epoch 013:     19 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.418, ntokens=17322.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.69, wps=3253.1, ups=0.19, wpb=17322.2, bsz=1024, num_updates=4710, lr=4.6784e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=30251
2024-11-07 12:14:50 - progress_bar.py[line:274] - INFO: epoch 013:     29 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.345, ntokens=17352.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=3280.3, ups=0.19, wpb=17352.4, bsz=1024, num_updates=4720, lr=4.67704e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=30304
2024-11-07 12:15:44 - progress_bar.py[line:274] - INFO: epoch 013:     39 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=17290.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=3230.4, ups=0.19, wpb=17290.6, bsz=1024, num_updates=4730, lr=4.67568e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=30357
2024-11-07 12:16:37 - progress_bar.py[line:274] - INFO: epoch 013:     49 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=17715.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=3338, ups=0.19, wpb=17715.9, bsz=1024, num_updates=4740, lr=4.67432e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=30411
2024-11-07 12:17:31 - progress_bar.py[line:274] - INFO: epoch 013:     59 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17217.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3211.1, ups=0.19, wpb=17217.9, bsz=1024, num_updates=4750, lr=4.67296e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=30464
2024-11-07 12:18:24 - progress_bar.py[line:274] - INFO: epoch 013:     69 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.294, ntokens=17115, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.81, wps=3212.4, ups=0.19, wpb=17115, bsz=1024, num_updates=4760, lr=4.6716e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=30517
2024-11-07 12:19:18 - progress_bar.py[line:274] - INFO: epoch 013:     79 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.402, ntokens=17344.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=3225.8, ups=0.19, wpb=17344.4, bsz=1024, num_updates=4770, lr=4.67024e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=30571
2024-11-07 12:20:12 - progress_bar.py[line:274] - INFO: epoch 013:     89 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=17188.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3185.8, ups=0.19, wpb=17188.9, bsz=1024, num_updates=4780, lr=4.66888e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=12.9, wall=30625
2024-11-07 12:21:05 - progress_bar.py[line:274] - INFO: epoch 013:     99 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=17398, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=3277.7, ups=0.19, wpb=17398, bsz=1024, num_updates=4790, lr=4.66752e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=30678
2024-11-07 12:21:59 - progress_bar.py[line:274] - INFO: epoch 013:    109 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.355, ntokens=17084.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=3173.1, ups=0.19, wpb=17084.4, bsz=1024, num_updates=4800, lr=4.66616e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=30732
2024-11-07 12:22:52 - progress_bar.py[line:274] - INFO: epoch 013:    119 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=17500.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=3260.4, ups=0.19, wpb=17500.4, bsz=1024, num_updates=4810, lr=4.6648e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=30786
2024-11-07 12:23:46 - progress_bar.py[line:274] - INFO: epoch 013:    129 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=17272, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3212.5, ups=0.19, wpb=17272, bsz=1024, num_updates=4820, lr=4.66344e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=30840
2024-11-07 12:24:40 - progress_bar.py[line:274] - INFO: epoch 013:    139 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=17434.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3246.6, ups=0.19, wpb=17434.6, bsz=1024, num_updates=4830, lr=4.66208e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=30893
2024-11-07 12:25:35 - progress_bar.py[line:274] - INFO: epoch 013:    149 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.338, ntokens=17227.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=3119.2, ups=0.18, wpb=17227.9, bsz=1024, num_updates=4840, lr=4.66072e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=30948
2024-11-07 12:26:29 - progress_bar.py[line:274] - INFO: epoch 013:    159 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=17301.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3214.1, ups=0.19, wpb=17301.7, bsz=1024, num_updates=4850, lr=4.65936e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=31002
2024-11-07 12:27:22 - progress_bar.py[line:274] - INFO: epoch 013:    169 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=17010.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3172.8, ups=0.19, wpb=17010.3, bsz=1024, num_updates=4860, lr=4.658e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=31056
2024-11-07 12:28:17 - progress_bar.py[line:274] - INFO: epoch 013:    179 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=17501.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=3214.6, ups=0.18, wpb=17501.4, bsz=1024, num_updates=4870, lr=4.65664e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=31110
2024-11-07 12:29:12 - progress_bar.py[line:274] - INFO: epoch 013:    189 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=17143.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=3134.2, ups=0.18, wpb=17143.9, bsz=1024, num_updates=4880, lr=4.65528e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=31165
2024-11-07 12:30:05 - progress_bar.py[line:274] - INFO: epoch 013:    199 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=17096, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=3187.9, ups=0.19, wpb=17096, bsz=1024, num_updates=4890, lr=4.65392e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=31219
2024-11-07 12:30:59 - progress_bar.py[line:274] - INFO: epoch 013:    209 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=17110.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3176.3, ups=0.19, wpb=17110.3, bsz=1024, num_updates=4900, lr=4.65255e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=31273
2024-11-07 12:31:53 - progress_bar.py[line:274] - INFO: epoch 013:    219 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17222.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3210.1, ups=0.19, wpb=17222.2, bsz=1024, num_updates=4910, lr=4.65119e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=31326
2024-11-07 12:32:47 - progress_bar.py[line:274] - INFO: epoch 013:    229 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=17421.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=3223, ups=0.18, wpb=17421.9, bsz=1024, num_updates=4920, lr=4.64983e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=31380
2024-11-07 12:33:41 - progress_bar.py[line:274] - INFO: epoch 013:    239 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.299, ntokens=16941.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.84, wps=3141.6, ups=0.19, wpb=16941.1, bsz=1024, num_updates=4930, lr=4.64847e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=31434
2024-11-07 12:34:35 - progress_bar.py[line:274] - INFO: epoch 013:    249 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=17565, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3231.3, ups=0.18, wpb=17565, bsz=1024, num_updates=4940, lr=4.64711e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=31489
2024-11-07 12:35:29 - progress_bar.py[line:274] - INFO: epoch 013:    259 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.366, ntokens=17508.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3222.5, ups=0.18, wpb=17508.5, bsz=1024, num_updates=4950, lr=4.64575e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=31543
2024-11-07 12:36:25 - progress_bar.py[line:274] - INFO: epoch 013:    269 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=17318.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=3131.7, ups=0.18, wpb=17318.4, bsz=1024, num_updates=4960, lr=4.64439e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=31598
2024-11-07 12:37:23 - progress_bar.py[line:274] - INFO: epoch 013:    279 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=17321.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=2977.5, ups=0.17, wpb=17321.8, bsz=1024, num_updates=4970, lr=4.64303e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=31656
2024-11-07 12:38:20 - progress_bar.py[line:274] - INFO: epoch 013:    289 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17070.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=2981, ups=0.17, wpb=17070.7, bsz=1024, num_updates=4980, lr=4.64167e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=31714
2024-11-07 12:39:14 - progress_bar.py[line:274] - INFO: epoch 013:    299 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=17228.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=3185.4, ups=0.18, wpb=17228.5, bsz=1024, num_updates=4990, lr=4.64031e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=31768
2024-11-07 12:40:08 - progress_bar.py[line:274] - INFO: epoch 013:    309 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=17161.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=3160.1, ups=0.18, wpb=17161.6, bsz=1024, num_updates=5000, lr=4.63895e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=31822
loss_reg: 0.03793376788191728 loss_cls: 0.006085121538490057
loss_reg: 0.020556269727361662 loss_cls: 0.003222172847017646
loss_reg: 0.029623165928515972 loss_cls: 0.003784765023738146
loss_reg: 0.03209051293844488 loss_cls: 0.003475555684417486
loss_reg: 0.01985621320718837 loss_cls: 0.0033140438608825207
loss_reg: 0.027962017418928897 loss_cls: 0.003710900666192174
loss_reg: 0.034415932557785606 loss_cls: 0.003162202425301075
loss_reg: 0.02776207116782677 loss_cls: 0.003434291807934642
loss_reg: 0.024532441319507367 loss_cls: 0.00386081263422966
loss_reg: 0.030866266715067692 loss_cls: 0.0038736225105822086
loss_reg: 0.019307737733840764 loss_cls: 0.003504454391077161
loss_reg: 0.028107833006109993 loss_cls: 0.0035740912426263094
loss_reg: 0.01746651215117091 loss_cls: 0.004262516275048256
loss_reg: 0.028281116937464892 loss_cls: 0.003354978282004595
loss_reg: 0.01947082655728287 loss_cls: 0.0036544848699122667
loss_reg: 0.018712994885989417 loss_cls: 0.003967545926570892
loss_reg: 0.019564525218907617 loss_cls: 0.004500122740864754
loss_reg: 0.024679794911191755 loss_cls: 0.003762032138183713
loss_reg: 0.014705343384837656 loss_cls: 0.0033320030197501183
loss_reg: 0.030580973640926913 loss_cls: 0.0035784938372671604
loss_reg: 0.015899997626555445 loss_cls: 0.0036312895826995373
loss_reg: 0.028336546903029315 loss_cls: 0.003472962649539113
loss_reg: 0.015531035303122435 loss_cls: 0.0037672258913517
loss_reg: 0.023163144234405946 loss_cls: 0.0036432016640901566
loss_reg: 0.018008958004281428 loss_cls: 0.0032792703714221716
loss_reg: 0.019913893676280395 loss_cls: 0.004003714304417372
loss_reg: 0.025658680518266305 loss_cls: 0.003324806457385421
loss_reg: 0.025793570825356573 loss_cls: 0.0037647972349077463
loss_reg: 0.02373630124905895 loss_cls: 0.003956472035497427
loss_reg: 0.01929215750477954 loss_cls: 0.0024991538375616074
loss_reg: 0.021838043254561686 loss_cls: 0.003042047144845128
loss_reg: 0.022264714109068193 loss_cls: 0.004423718433827162
loss_reg: 0.025922323263342158 loss_cls: 0.003787822322919965
loss_reg: 0.017475829431702238 loss_cls: 0.0030428010504692793
loss_reg: 0.02164424370301503 loss_cls: 0.004871551878750324
loss_reg: 0.015057395401672778 loss_cls: 0.004412442445755005
loss_reg: 0.018802697552609552 loss_cls: 0.003566870465874672
loss_reg: 0.03155294314506719 loss_cls: 0.004715294577181339
loss_reg: 0.024826306310331808 loss_cls: 0.004165526479482651
loss_reg: 0.022829481165933085 loss_cls: 0.003955818247050047
loss_reg: 0.028996222984052057 loss_cls: 0.003400408895686269
loss_reg: 0.025353471830495987 loss_cls: 0.004953943658620119
loss_reg: 0.027355792193099145 loss_cls: 0.004234854131937027
loss_reg: 0.0256492521143065 loss_cls: 0.0028781197033822536
loss_reg: 0.018276912496770763 loss_cls: 0.004299386404454708
loss_reg: 0.020139949163776392 loss_cls: 0.0035167757887393236
loss_reg: 0.024018806749171763 loss_cls: 0.004376938100904226
loss_reg: 0.029600269430470505 loss_cls: 0.00339528894983232
loss_reg: 0.027225172182532942 loss_cls: 0.003605176694691181
loss_reg: 0.006882685188063005 loss_cls: 0.0033492008224129677
loss_reg: 0.02230295269416626 loss_cls: 0.0037889848463237286
loss_reg: 0.020964234125908893 loss_cls: 0.004058385267853737
loss_reg: 0.022683107064253076 loss_cls: 0.0034897574223577976
loss_reg: 0.01723029102268428 loss_cls: 0.003878179704770446
loss_reg: 0.02517751115748866 loss_cls: 0.004184878431260586
loss_reg: 0.020202047946413147 loss_cls: 0.0035823180805891752
loss_reg: 0.029580910068567737 loss_cls: 0.0044205524027347565
loss_reg: 0.012505655118176298 loss_cls: 0.0035829218104481697
loss_reg: 0.009922120657290937 loss_cls: 0.0032326134387403727
loss_reg: 0.005103853620346864 loss_cls: 0.0033128950744867325
loss_reg: 0.008654583010147904 loss_cls: 0.0036059177946299314
loss_reg: 0.010960446998156546 loss_cls: 0.0032704093027859926
loss_reg: 0.005044034208709027 loss_cls: 0.0033252397552132607
loss_reg: 0.00877225812809266 loss_cls: 0.00354841910302639
2024-11-07 12:41:02 - progress_bar.py[line:274] - INFO: epoch 013:    319 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=17435, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=3264, ups=0.19, wpb=17435, bsz=1024, num_updates=5010, lr=4.63759e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=31875
2024-11-07 12:41:56 - progress_bar.py[line:274] - INFO: epoch 013:    329 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=17331.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=3205.5, ups=0.18, wpb=17331.5, bsz=1024, num_updates=5020, lr=4.63623e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=31929
2024-11-07 12:42:51 - progress_bar.py[line:274] - INFO: epoch 013:    339 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=17448, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=3198.3, ups=0.18, wpb=17448, bsz=1024, num_updates=5030, lr=4.63487e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=31984
2024-11-07 12:43:46 - progress_bar.py[line:274] - INFO: epoch 013:    349 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=17459, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3145, ups=0.18, wpb=17459, bsz=1024, num_updates=5040, lr=4.63351e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=32040
2024-11-07 12:44:42 - progress_bar.py[line:274] - INFO: epoch 013:    359 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.271, ntokens=17236.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.65, wps=3082.8, ups=0.18, wpb=17236.7, bsz=1024, num_updates=5050, lr=4.63215e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=32095
2024-11-07 12:45:36 - progress_bar.py[line:274] - INFO: epoch 013:    369 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=17423.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=3246.5, ups=0.19, wpb=17423.7, bsz=1024, num_updates=5060, lr=4.63079e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=32149
2024-11-07 12:46:32 - progress_bar.py[line:274] - INFO: epoch 013:    379 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.524, ntokens=17659.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.5, wps=3112.8, ups=0.18, wpb=17659.8, bsz=1024, num_updates=5070, lr=4.62943e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=32206
2024-11-07 12:47:29 - progress_bar.py[line:274] - INFO: epoch 013:    389 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.533, ntokens=17591.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.58, wps=3099, ups=0.18, wpb=17591.4, bsz=1024, num_updates=5080, lr=4.62807e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=32263
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

2024-11-07 12:47:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 5082 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
2024-11-07 12:47:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 12:49:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 12:51:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 5082 updates, score 0) (writing took 224.69202583600418 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
2024-11-07 12:52:17 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-07 12:52:17 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.364 | ntokens 17299.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.3 | wps 2637.3 | ups 0.15 | wpb 17299.7 | bsz 1023 | num_updates 5082 | lr 4.6278e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1266 | gb_free 13.3 | wall 32550
2024-11-07 12:52:17 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 12:54:59 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-07 12:54:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 12:55:44 - progress_bar.py[line:274] - INFO: epoch 014:      8 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=16640.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=336.1, ups=0.02, wpb=16640.9, bsz=985.6, num_updates=5090, lr=4.62671e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.4, wall=32758
2024-11-07 12:56:38 - progress_bar.py[line:274] - INFO: epoch 014:     18 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=17409.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=3224.6, ups=0.19, wpb=17409.6, bsz=1024, num_updates=5100, lr=4.62535e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=32812
2024-11-07 12:57:32 - progress_bar.py[line:274] - INFO: epoch 014:     28 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.304, ntokens=17343, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3234, ups=0.19, wpb=17343, bsz=1024, num_updates=5110, lr=4.62399e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=32865
2024-11-07 12:58:25 - progress_bar.py[line:274] - INFO: epoch 014:     38 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=3228.7, ups=0.19, wpb=17298.6, bsz=1024, num_updates=5120, lr=4.62263e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=32919
2024-11-07 12:59:19 - progress_bar.py[line:274] - INFO: epoch 014:     48 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17492.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3262.2, ups=0.19, wpb=17492.9, bsz=1024, num_updates=5130, lr=4.62127e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=32972
2024-11-07 12:59:51 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 13:00:18 - progress_bar.py[line:274] - INFO: epoch 014:     59 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.304, ntokens=17127.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=2907.2, ups=0.17, wpb=17127.2, bsz=1024, num_updates=5140, lr=4.61991e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=33031
2024-11-07 13:01:12 - progress_bar.py[line:274] - INFO: epoch 014:     69 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17082.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3175.9, ups=0.19, wpb=17082.7, bsz=1024, num_updates=5150, lr=4.61854e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=33085
2024-11-07 13:02:05 - progress_bar.py[line:274] - INFO: epoch 014:     79 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=17407, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=3273.1, ups=0.19, wpb=17407, bsz=1024, num_updates=5160, lr=4.61718e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=33138
2024-11-07 13:02:59 - progress_bar.py[line:274] - INFO: epoch 014:     89 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17367.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3226.3, ups=0.19, wpb=17367.4, bsz=1024, num_updates=5170, lr=4.61582e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=33192
2024-11-07 13:03:53 - progress_bar.py[line:274] - INFO: epoch 014:     99 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=17572.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3247.3, ups=0.18, wpb=17572.5, bsz=1024, num_updates=5180, lr=4.61446e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=33246
2024-11-07 13:04:48 - progress_bar.py[line:274] - INFO: epoch 014:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.337, ntokens=17215.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=3139, ups=0.18, wpb=17215.7, bsz=1024, num_updates=5190, lr=4.6131e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33301
2024-11-07 13:05:42 - progress_bar.py[line:274] - INFO: epoch 014:    119 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=17491.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=3243.1, ups=0.19, wpb=17491.6, bsz=1024, num_updates=5200, lr=4.61174e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=33355
2024-11-07 13:06:35 - progress_bar.py[line:274] - INFO: epoch 014:    129 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=17298.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3242, ups=0.19, wpb=17298.5, bsz=1024, num_updates=5210, lr=4.61038e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=33408
2024-11-07 13:07:29 - progress_bar.py[line:274] - INFO: epoch 014:    139 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17355, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3228.1, ups=0.19, wpb=17355, bsz=1024, num_updates=5220, lr=4.60902e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=33462
2024-11-07 13:08:22 - progress_bar.py[line:274] - INFO: epoch 014:    149 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.308, ntokens=17188.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.9, wps=3214.5, ups=0.19, wpb=17188.6, bsz=1024, num_updates=5230, lr=4.60766e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=33516
2024-11-07 13:09:17 - progress_bar.py[line:274] - INFO: epoch 014:    159 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=17669.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=3240.6, ups=0.18, wpb=17669.7, bsz=1024, num_updates=5240, lr=4.6063e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=33570
2024-11-07 13:10:11 - progress_bar.py[line:274] - INFO: epoch 014:    169 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.277, ntokens=17050.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3156.9, ups=0.19, wpb=17050.6, bsz=1024, num_updates=5250, lr=4.60494e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=33624
2024-11-07 13:11:05 - progress_bar.py[line:274] - INFO: epoch 014:    179 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=17560.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3232.2, ups=0.18, wpb=17560.2, bsz=1024, num_updates=5260, lr=4.60358e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=33679
2024-11-07 13:11:59 - progress_bar.py[line:274] - INFO: epoch 014:    189 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.315, ntokens=17118.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3191.7, ups=0.19, wpb=17118.1, bsz=1024, num_updates=5270, lr=4.60222e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=33732
2024-11-07 13:12:52 - progress_bar.py[line:274] - INFO: epoch 014:    199 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17203.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3203.1, ups=0.19, wpb=17203.5, bsz=1024, num_updates=5280, lr=4.60086e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=33786
2024-11-07 13:13:47 - progress_bar.py[line:274] - INFO: epoch 014:    209 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.301, ntokens=17098, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3143.7, ups=0.18, wpb=17098, bsz=1024, num_updates=5290, lr=4.5995e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=33840
2024-11-07 13:14:40 - progress_bar.py[line:274] - INFO: epoch 014:    219 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.359, ntokens=17344.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=3232, ups=0.19, wpb=17344.1, bsz=1024, num_updates=5300, lr=4.59814e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=33894
2024-11-07 13:15:35 - progress_bar.py[line:274] - INFO: epoch 014:    229 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=17465.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.94, wps=3222.6, ups=0.18, wpb=17465.2, bsz=1024, num_updates=5310, lr=4.59678e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.2, wall=33948
2024-11-07 13:16:31 - progress_bar.py[line:274] - INFO: epoch 014:    239 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.267, ntokens=16979.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.63, wps=3039.5, ups=0.18, wpb=16979.5, bsz=1024, num_updates=5320, lr=4.59542e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=50, gb_free=13.6, wall=34004
2024-11-07 13:17:26 - progress_bar.py[line:274] - INFO: epoch 014:    249 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=17718, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=3191.6, ups=0.18, wpb=17718, bsz=1024, num_updates=5330, lr=4.59406e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=34060
2024-11-07 13:18:20 - progress_bar.py[line:274] - INFO: epoch 014:    259 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.29, ntokens=17386.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3216.2, ups=0.18, wpb=17386.3, bsz=1024, num_updates=5340, lr=4.5927e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=34114
2024-11-07 13:19:12 - progress_bar.py[line:274] - INFO: epoch 014:    269 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=17488.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=3338.9, ups=0.19, wpb=17488.4, bsz=1024, num_updates=5350, lr=4.59134e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=52, gb_free=13.6, wall=34166
2024-11-07 13:20:07 - progress_bar.py[line:274] - INFO: epoch 014:    279 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17224.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3150.8, ups=0.18, wpb=17224.8, bsz=1024, num_updates=5360, lr=4.58998e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=47, gb_free=13.6, wall=34221
2024-11-07 13:21:01 - progress_bar.py[line:274] - INFO: epoch 014:    289 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17164.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3199.3, ups=0.19, wpb=17164.9, bsz=1024, num_updates=5370, lr=4.58862e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=34274
2024-11-07 13:21:53 - progress_bar.py[line:274] - INFO: epoch 014:    299 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.309, ntokens=17348.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.91, wps=3297.5, ups=0.19, wpb=17348.9, bsz=1024, num_updates=5380, lr=4.58726e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=34327
2024-11-07 13:22:45 - progress_bar.py[line:274] - INFO: epoch 014:    309 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=17098.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3286.5, ups=0.19, wpb=17098.9, bsz=1024, num_updates=5390, lr=4.5859e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=34379
2024-11-07 13:23:39 - progress_bar.py[line:274] - INFO: epoch 014:    319 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.292, ntokens=17361.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3246.5, ups=0.19, wpb=17361.1, bsz=1024, num_updates=5400, lr=4.58454e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=34432
2024-11-07 13:24:33 - progress_bar.py[line:274] - INFO: epoch 014:    329 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.305, ntokens=17198.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.88, wps=3201.6, ups=0.19, wpb=17198.1, bsz=1024, num_updates=5410, lr=4.58317e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=34486
2024-11-07 13:25:26 - progress_bar.py[line:274] - INFO: epoch 014:    339 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=17362.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3257.5, ups=0.19, wpb=17362.4, bsz=1024, num_updates=5420, lr=4.58181e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=34539
2024-11-07 13:26:20 - progress_bar.py[line:274] - INFO: epoch 014:    349 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=17331.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=3202.8, ups=0.18, wpb=17331.8, bsz=1024, num_updates=5430, lr=4.58045e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=34594
2024-11-07 13:27:13 - progress_bar.py[line:274] - INFO: epoch 014:    359 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.283, ntokens=17434.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.73, wps=3263.6, ups=0.19, wpb=17434.9, bsz=1024, num_updates=5440, lr=4.57909e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=34647
2024-11-07 13:28:07 - progress_bar.py[line:274] - INFO: epoch 014:    369 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=17679.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3280.7, ups=0.19, wpb=17679.6, bsz=1024, num_updates=5450, lr=4.57773e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=34701
2024-11-07 13:29:00 - progress_bar.py[line:274] - INFO: epoch 014:    379 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=17609.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3349.5, ups=0.19, wpb=17609.9, bsz=1024, num_updates=5460, lr=4.57637e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=34753
2024-11-07 13:29:52 - progress_bar.py[line:274] - INFO: epoch 014:    389 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=17223.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=3337.4, ups=0.19, wpb=17223.7, bsz=1024, num_updates=5470, lr=4.57501e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=34805
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt2024-11-07 13:29:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5472 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-07 13:29:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 13:31:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-07 13:33:42 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5472 updates, score 0) (writing took 223.01328016101616 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 13:34:37 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-07 13:34:37 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.338 | ntokens 17316.9 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.11 | wps 2659.2 | ups 0.15 | wpb 17316.9 | bsz 1023 | num_updates 5472 | lr 4.57474e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1356 | gb_free 13.3 | wall 35090
2024-11-07 13:34:37 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 13:37:18 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-07 13:37:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 13:38:03 - progress_bar.py[line:274] - INFO: epoch 015:      8 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=16699.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=339.9, ups=0.02, wpb=16699.4, bsz=985.6, num_updates=5480, lr=4.57365e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.4, wall=35296
2024-11-07 13:38:56 - progress_bar.py[line:274] - INFO: epoch 015:     18 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.349, ntokens=17430.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.19, wps=3256.8, ups=0.19, wpb=17430.2, bsz=1024, num_updates=5490, lr=4.57229e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=35350
2024-11-07 13:39:50 - progress_bar.py[line:274] - INFO: epoch 015:     28 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.285, ntokens=17246.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.75, wps=3227.1, ups=0.19, wpb=17246.3, bsz=1024, num_updates=5500, lr=4.57093e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=35403
2024-11-07 13:40:44 - progress_bar.py[line:274] - INFO: epoch 015:     38 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=17252.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=3196.8, ups=0.19, wpb=17252.3, bsz=1024, num_updates=5510, lr=4.56957e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35457
2024-11-07 13:41:37 - progress_bar.py[line:274] - INFO: epoch 015:     48 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.303, ntokens=17491.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3277.3, ups=0.19, wpb=17491.7, bsz=1024, num_updates=5520, lr=4.56821e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=35511
2024-11-07 13:42:33 - progress_bar.py[line:274] - INFO: epoch 015:     58 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.303, ntokens=17240.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3113.8, ups=0.18, wpb=17240.5, bsz=1024, num_updates=5530, lr=4.56685e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=35566
2024-11-07 13:43:26 - progress_bar.py[line:274] - INFO: epoch 015:     68 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.23, ntokens=17272.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.38, wps=3217.5, ups=0.19, wpb=17272.5, bsz=1024, num_updates=5540, lr=4.56549e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.6, wall=35620
2024-11-07 13:44:20 - progress_bar.py[line:274] - INFO: epoch 015:     78 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=17304.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=3239.7, ups=0.19, wpb=17304.6, bsz=1024, num_updates=5550, lr=4.56413e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=35673
2024-11-07 13:45:14 - progress_bar.py[line:274] - INFO: epoch 015:     88 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.29, ntokens=17349.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3205.7, ups=0.18, wpb=17349.5, bsz=1024, num_updates=5560, lr=4.56277e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=35727
2024-11-07 13:46:08 - progress_bar.py[line:274] - INFO: epoch 015:     98 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=17528.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=3231.5, ups=0.18, wpb=17528.6, bsz=1024, num_updates=5570, lr=4.56141e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=35782
2024-11-07 13:46:30 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 13:47:08 - progress_bar.py[line:274] - INFO: epoch 015:    109 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.3, ntokens=16966.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.85, wps=2836.1, ups=0.17, wpb=16966.5, bsz=1024, num_updates=5580, lr=4.56005e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.4, wall=35841
2024-11-07 13:48:02 - progress_bar.py[line:274] - INFO: epoch 015:    119 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.338, ntokens=17429.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=3195.7, ups=0.18, wpb=17429.1, bsz=1024, num_updates=5590, lr=4.55869e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=35896
2024-11-07 13:48:56 - progress_bar.py[line:274] - INFO: epoch 015:    129 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.287, ntokens=17294.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.76, wps=3211, ups=0.19, wpb=17294.9, bsz=1024, num_updates=5600, lr=4.55733e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=35950
2024-11-07 13:49:51 - progress_bar.py[line:274] - INFO: epoch 015:    139 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.345, ntokens=17367, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=3192.3, ups=0.18, wpb=17367, bsz=1024, num_updates=5610, lr=4.55597e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=36004
2024-11-07 13:50:45 - progress_bar.py[line:274] - INFO: epoch 015:    149 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17127.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3166.5, ups=0.18, wpb=17127.2, bsz=1024, num_updates=5620, lr=4.55461e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=36058
2024-11-07 13:51:39 - progress_bar.py[line:274] - INFO: epoch 015:    159 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=17367.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.94, wps=3187.6, ups=0.18, wpb=17367.2, bsz=1024, num_updates=5630, lr=4.55325e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=36113
2024-11-07 13:52:34 - progress_bar.py[line:274] - INFO: epoch 015:    169 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.315, ntokens=17397.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3198.3, ups=0.18, wpb=17397.3, bsz=1024, num_updates=5640, lr=4.55189e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=36167
2024-11-07 13:53:28 - progress_bar.py[line:274] - INFO: epoch 015:    179 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.282, ntokens=17484.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.73, wps=3230.4, ups=0.18, wpb=17484.1, bsz=1024, num_updates=5650, lr=4.55053e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=36221
2024-11-07 13:54:21 - progress_bar.py[line:274] - INFO: epoch 015:    189 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=17027, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3187.3, ups=0.19, wpb=17027, bsz=1024, num_updates=5660, lr=4.54916e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=36275
2024-11-07 13:55:16 - progress_bar.py[line:274] - INFO: epoch 015:    199 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.276, ntokens=17307, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.69, wps=3135.8, ups=0.18, wpb=17307, bsz=1024, num_updates=5670, lr=4.5478e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=35, gb_free=13.5, wall=36330
2024-11-07 13:56:10 - progress_bar.py[line:274] - INFO: epoch 015:    209 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.264, ntokens=17092.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3196.6, ups=0.19, wpb=17092.2, bsz=1024, num_updates=5680, lr=4.54644e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=37, gb_free=13.6, wall=36383
2024-11-07 13:57:05 - progress_bar.py[line:274] - INFO: epoch 015:    219 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.321, ntokens=17341.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3160.7, ups=0.18, wpb=17341.5, bsz=1024, num_updates=5690, lr=4.54508e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=36438
2024-11-07 13:58:00 - progress_bar.py[line:274] - INFO: epoch 015:    229 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.288, ntokens=17516, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.77, wps=3148.8, ups=0.18, wpb=17516, bsz=1024, num_updates=5700, lr=4.54372e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=47, gb_free=13.3, wall=36494
2024-11-07 13:58:54 - progress_bar.py[line:274] - INFO: epoch 015:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.248, ntokens=17044.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3159.4, ups=0.19, wpb=17044.3, bsz=1024, num_updates=5710, lr=4.54236e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=34, gb_free=13.5, wall=36548
2024-11-07 13:59:48 - progress_bar.py[line:274] - INFO: epoch 015:    249 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17565.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3281.5, ups=0.19, wpb=17565.2, bsz=1024, num_updates=5720, lr=4.541e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=36601
2024-11-07 14:00:42 - progress_bar.py[line:274] - INFO: epoch 015:    259 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17255.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3210.3, ups=0.19, wpb=17255.4, bsz=1024, num_updates=5730, lr=4.53964e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=36655
2024-11-07 14:01:35 - progress_bar.py[line:274] - INFO: epoch 015:    269 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=17355.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3218, ups=0.19, wpb=17355.7, bsz=1024, num_updates=5740, lr=4.53828e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=36709
2024-11-07 14:02:29 - progress_bar.py[line:274] - INFO: epoch 015:    279 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17207.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3196.8, ups=0.19, wpb=17207.6, bsz=1024, num_updates=5750, lr=4.53692e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=36763
2024-11-07 14:03:23 - progress_bar.py[line:274] - INFO: epoch 015:    289 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=17283.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3202.7, ups=0.19, wpb=17283.8, bsz=1024, num_updates=5760, lr=4.53556e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=36817
2024-11-07 14:04:17 - progress_bar.py[line:274] - INFO: epoch 015:    299 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.273, ntokens=17342.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.67, wps=3217.9, ups=0.19, wpb=17342.9, bsz=1024, num_updates=5770, lr=4.5342e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=36871
2024-11-07 14:05:12 - progress_bar.py[line:274] - INFO: epoch 015:    309 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3144.7, ups=0.18, wpb=17332.3, bsz=1024, num_updates=5780, lr=4.53284e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=36926
2024-11-07 14:06:06 - progress_bar.py[line:274] - INFO: epoch 015:    319 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17275, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.4, wps=3215.3, ups=0.19, wpb=17275, bsz=1024, num_updates=5790, lr=4.53148e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=36980
2024-11-07 14:07:00 - progress_bar.py[line:274] - INFO: epoch 015:    329 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.3, ntokens=17331.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.85, wps=3236.6, ups=0.19, wpb=17331.8, bsz=1024, num_updates=5800, lr=4.53012e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=37033
2024-11-07 14:07:53 - progress_bar.py[line:274] - INFO: epoch 015:    339 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.316, ntokens=17636.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.96, wps=3302.5, ups=0.19, wpb=17636.3, bsz=1024, num_updates=5810, lr=4.52876e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=37086
2024-11-07 14:08:46 - progress_bar.py[line:274] - INFO: epoch 015:    349 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.321, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3265.3, ups=0.19, wpb=17372.7, bsz=1024, num_updates=5820, lr=4.5274e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=37140
2024-11-07 14:09:41 - progress_bar.py[line:274] - INFO: epoch 015:    359 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.272, ntokens=17542.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3215.4, ups=0.18, wpb=17542.3, bsz=1024, num_updates=5830, lr=4.52604e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=37194
2024-11-07 14:10:35 - progress_bar.py[line:274] - INFO: epoch 015:    369 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.357, ntokens=17543.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=3261, ups=0.19, wpb=17543.6, bsz=1024, num_updates=5840, lr=4.52468e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=37248
2024-11-07 14:11:28 - progress_bar.py[line:274] - INFO: epoch 015:    379 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.493, ntokens=17635.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.26, wps=3318.5, ups=0.19, wpb=17635.3, bsz=1024, num_updates=5850, lr=4.52332e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=37301
2024-11-07 14:12:22 - progress_bar.py[line:274] - INFO: epoch 015:    389 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=17381.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3223.7, ups=0.19, wpb=17381.6, bsz=1024, num_updates=5860, lr=4.52196e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=48, gb_free=13.3, wall=37355
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-07 14:12:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5862 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

2024-11-07 14:12:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 14:14:21 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-07 14:16:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5862 updates, score 0) (writing took 224.82947769999737 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-07 14:17:09 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-07 14:17:09 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.309 | ntokens 17324.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.91 | wps 2646.9 | ups 0.15 | wpb 17324.4 | bsz 1023 | num_updates 5862 | lr 4.52168e-05 | gnorm 0.009 | clip 0 | loss_scale 16384 | train_wall 1287 | gb_free 13.3 | wall 37643
2024-11-07 14:17:09 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 14:19:50 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-07 14:19:50 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 14:20:36 - progress_bar.py[line:274] - INFO: epoch 016:      8 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.362, ntokens=16760.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=339.2, ups=0.02, wpb=16760.8, bsz=985.6, num_updates=5870, lr=4.5206e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=37849
2024-11-07 14:21:29 - progress_bar.py[line:274] - INFO: epoch 016:     18 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.309, ntokens=17376.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.91, wps=3252.5, ups=0.19, wpb=17376.2, bsz=1024, num_updates=5880, lr=4.51924e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=37903
2024-11-07 14:22:24 - progress_bar.py[line:274] - INFO: epoch 016:     28 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17380.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3170.6, ups=0.18, wpb=17380.5, bsz=1024, num_updates=5890, lr=4.51788e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=37957
2024-11-07 14:23:18 - progress_bar.py[line:274] - INFO: epoch 016:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=17560.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=3219.1, ups=0.18, wpb=17560.9, bsz=1024, num_updates=5900, lr=4.51652e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=38012
2024-11-07 14:24:12 - progress_bar.py[line:274] - INFO: epoch 016:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.249, ntokens=17452.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.51, wps=3244.3, ups=0.19, wpb=17452.7, bsz=1024, num_updates=5910, lr=4.51515e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=38066
2024-11-07 14:25:06 - progress_bar.py[line:274] - INFO: epoch 016:     58 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17256.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=3214.4, ups=0.19, wpb=17256.7, bsz=1024, num_updates=5920, lr=4.51379e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=38119
2024-11-07 14:26:00 - progress_bar.py[line:274] - INFO: epoch 016:     68 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=16909.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3119.7, ups=0.18, wpb=16909.6, bsz=1024, num_updates=5930, lr=4.51243e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=38174
2024-11-07 14:26:54 - progress_bar.py[line:274] - INFO: epoch 016:     78 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=17225.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3199.7, ups=0.19, wpb=17225.5, bsz=1024, num_updates=5940, lr=4.51107e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=38228
2024-11-07 14:27:48 - progress_bar.py[line:274] - INFO: epoch 016:     88 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17208.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3167.9, ups=0.18, wpb=17208.7, bsz=1024, num_updates=5950, lr=4.50971e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=38282
2024-11-07 14:28:42 - progress_bar.py[line:274] - INFO: epoch 016:     98 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.289, ntokens=17351.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3243.1, ups=0.19, wpb=17351.5, bsz=1024, num_updates=5960, lr=4.50835e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38335
2024-11-07 14:29:35 - progress_bar.py[line:274] - INFO: epoch 016:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17078.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3183.1, ups=0.19, wpb=17078.8, bsz=1024, num_updates=5970, lr=4.50699e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=38389
2024-11-07 14:30:29 - progress_bar.py[line:274] - INFO: epoch 016:    118 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=17384.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=3252.3, ups=0.19, wpb=17384.9, bsz=1024, num_updates=5980, lr=4.50563e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38442
2024-11-07 14:31:23 - progress_bar.py[line:274] - INFO: epoch 016:    128 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.267, ntokens=17312.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.63, wps=3209.8, ups=0.19, wpb=17312.1, bsz=1024, num_updates=5990, lr=4.50427e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=38496
2024-11-07 14:32:17 - progress_bar.py[line:274] - INFO: epoch 016:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.299, ntokens=17364.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.84, wps=3207.7, ups=0.18, wpb=17364.2, bsz=1024, num_updates=6000, lr=4.50291e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=38551
2024-11-07 14:33:11 - progress_bar.py[line:274] - INFO: epoch 016:    148 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.263, ntokens=17330.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.6, wps=3222.9, ups=0.19, wpb=17330.9, bsz=1024, num_updates=6010, lr=4.50155e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=38604
2024-11-07 14:34:05 - progress_bar.py[line:274] - INFO: epoch 016:    158 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.288, ntokens=17345.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.77, wps=3219.2, ups=0.19, wpb=17345.2, bsz=1024, num_updates=6020, lr=4.50019e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=38658
2024-11-07 14:34:59 - progress_bar.py[line:274] - INFO: epoch 016:    168 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.278, ntokens=17282.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3164.5, ups=0.18, wpb=17282.9, bsz=1024, num_updates=6030, lr=4.49883e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=32, gb_free=13.5, wall=38713
2024-11-07 14:35:55 - progress_bar.py[line:274] - INFO: epoch 016:    178 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.263, ntokens=17515, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.6, wps=3118.7, ups=0.18, wpb=17515, bsz=1024, num_updates=6040, lr=4.49747e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=38769
2024-11-07 14:36:51 - progress_bar.py[line:274] - INFO: epoch 016:    188 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17278.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3098.7, ups=0.18, wpb=17278.2, bsz=1024, num_updates=6050, lr=4.49611e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=38825
2024-11-07 14:37:47 - progress_bar.py[line:274] - INFO: epoch 016:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17208.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3062.3, ups=0.18, wpb=17208.8, bsz=1024, num_updates=6060, lr=4.49475e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=38881
2024-11-07 14:38:42 - progress_bar.py[line:274] - INFO: epoch 016:    208 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.239, ntokens=16977.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3124.8, ups=0.18, wpb=16977.8, bsz=1024, num_updates=6070, lr=4.49339e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=54, gb_free=13.6, wall=38935
2024-11-07 14:39:34 - progress_bar.py[line:274] - INFO: epoch 016:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.266, ntokens=17136.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3260.7, ups=0.19, wpb=17136.5, bsz=1024, num_updates=6080, lr=4.49203e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=38988
2024-11-07 14:40:26 - progress_bar.py[line:274] - INFO: epoch 016:    228 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.24, ntokens=17293, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3327.2, ups=0.19, wpb=17293, bsz=1024, num_updates=6090, lr=4.49067e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.5, wall=39040
2024-11-07 14:41:20 - progress_bar.py[line:274] - INFO: epoch 016:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.207, ntokens=17031.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3171.5, ups=0.19, wpb=17031.1, bsz=1024, num_updates=6100, lr=4.48931e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=39093
2024-11-07 14:42:14 - progress_bar.py[line:274] - INFO: epoch 016:    248 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.284, ntokens=17616.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.74, wps=3265.6, ups=0.19, wpb=17616.6, bsz=1024, num_updates=6110, lr=4.48795e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=39147
2024-11-07 14:43:08 - progress_bar.py[line:274] - INFO: epoch 016:    258 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.253, ntokens=17404.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.53, wps=3233.3, ups=0.19, wpb=17404.8, bsz=1024, num_updates=6120, lr=4.48659e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=39201
2024-11-07 14:44:02 - progress_bar.py[line:274] - INFO: epoch 016:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.307, ntokens=17438.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3230.3, ups=0.19, wpb=17438.2, bsz=1024, num_updates=6130, lr=4.48523e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=39255
2024-11-07 14:44:55 - progress_bar.py[line:274] - INFO: epoch 016:    278 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17060.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3175.7, ups=0.19, wpb=17060.2, bsz=1024, num_updates=6140, lr=4.48387e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=39309
2024-11-07 14:45:50 - progress_bar.py[line:274] - INFO: epoch 016:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.215, ntokens=17000.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3140.4, ups=0.18, wpb=17000.6, bsz=1024, num_updates=6150, lr=4.48251e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=39363
2024-11-07 14:46:44 - progress_bar.py[line:274] - INFO: epoch 016:    298 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17421.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3217.1, ups=0.18, wpb=17421.1, bsz=1024, num_updates=6160, lr=4.48114e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=39417
2024-11-07 14:47:38 - progress_bar.py[line:274] - INFO: epoch 016:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.317, ntokens=17237.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=3198.8, ups=0.19, wpb=17237.1, bsz=1024, num_updates=6170, lr=4.47978e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=39471
2024-11-07 14:48:32 - progress_bar.py[line:274] - INFO: epoch 016:    318 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17332.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3215.2, ups=0.19, wpb=17332.4, bsz=1024, num_updates=6180, lr=4.47842e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=39525
2024-11-07 14:49:26 - progress_bar.py[line:274] - INFO: epoch 016:    328 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.266, ntokens=17275.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3198.6, ups=0.19, wpb=17275.4, bsz=1024, num_updates=6190, lr=4.47706e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=39579
2024-11-07 14:50:19 - progress_bar.py[line:274] - INFO: epoch 016:    338 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17237.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3202.8, ups=0.19, wpb=17237.6, bsz=1024, num_updates=6200, lr=4.4757e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=39633
2024-11-07 14:51:15 - progress_bar.py[line:274] - INFO: epoch 016:    348 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.303, ntokens=17406, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3154, ups=0.18, wpb=17406, bsz=1024, num_updates=6210, lr=4.47434e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=44, gb_free=13.5, wall=39688
2024-11-07 14:52:10 - progress_bar.py[line:274] - INFO: epoch 016:    358 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.232, ntokens=17538.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.4, wps=3156.5, ups=0.18, wpb=17538.5, bsz=1024, num_updates=6220, lr=4.47298e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=39744
2024-11-07 14:53:06 - progress_bar.py[line:274] - INFO: epoch 016:    368 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=17622.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=3180.8, ups=0.18, wpb=17622.2, bsz=1024, num_updates=6230, lr=4.47162e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=39799
2024-11-07 14:54:01 - progress_bar.py[line:274] - INFO: epoch 016:    378 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=17383.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3110.9, ups=0.18, wpb=17383.6, bsz=1024, num_updates=6240, lr=4.47026e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=39855
2024-11-07 14:54:56 - progress_bar.py[line:274] - INFO: epoch 016:    388 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.444, ntokens=17608.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.88, wps=3254.8, ups=0.18, wpb=17608.8, bsz=1024, num_updates=6250, lr=4.4689e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=39909
2024-11-07 14:55:01 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 14:55:08 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 6252 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-07 14:55:08 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 14:56:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-07 14:58:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 6252 updates, score 0) (writing took 220.54484279698227 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-07 14:59:43 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-07 14:59:43 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.279 | ntokens 17297 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.71 | wps 2641.2 | ups 0.15 | wpb 17297 | bsz 1023 | num_updates 6252 | lr 4.46863e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1440 | gb_free 13.2 | wall 40197
2024-11-07 14:59:43 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 15:02:25 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-07 15:02:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 15:03:11 - progress_bar.py[line:274] - INFO: epoch 017:      8 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=16547.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=334.2, ups=0.02, wpb=16547.4, bsz=985.6, num_updates=6260, lr=4.46754e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=37, gb_free=13.4, wall=40404
2024-11-07 15:04:04 - progress_bar.py[line:274] - INFO: epoch 017:     18 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=17332.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.94, wps=3243, ups=0.19, wpb=17332.9, bsz=1024, num_updates=6270, lr=4.46618e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=40458
2024-11-07 15:04:58 - progress_bar.py[line:274] - INFO: epoch 017:     28 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.214, ntokens=17381.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3214.7, ups=0.18, wpb=17381.2, bsz=1024, num_updates=6280, lr=4.46482e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=40512
2024-11-07 15:05:52 - progress_bar.py[line:274] - INFO: epoch 017:     38 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17285.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=3215.8, ups=0.19, wpb=17285.3, bsz=1024, num_updates=6290, lr=4.46346e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=40565
2024-11-07 15:06:45 - progress_bar.py[line:274] - INFO: epoch 017:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=17391.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3279.9, ups=0.19, wpb=17391.7, bsz=1024, num_updates=6300, lr=4.4621e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=40618
2024-11-07 15:07:39 - progress_bar.py[line:274] - INFO: epoch 017:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.282, ntokens=17303.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.73, wps=3211.9, ups=0.19, wpb=17303.2, bsz=1024, num_updates=6310, lr=4.46074e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=40672
2024-11-07 15:08:32 - progress_bar.py[line:274] - INFO: epoch 017:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17072.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3188.8, ups=0.19, wpb=17072.9, bsz=1024, num_updates=6320, lr=4.45938e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=40726
2024-11-07 15:09:27 - progress_bar.py[line:274] - INFO: epoch 017:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.275, ntokens=17116.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.68, wps=3148.3, ups=0.18, wpb=17116.1, bsz=1024, num_updates=6330, lr=4.45802e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=40780
2024-11-07 15:10:20 - progress_bar.py[line:274] - INFO: epoch 017:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17503.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3265.1, ups=0.19, wpb=17503.2, bsz=1024, num_updates=6340, lr=4.45666e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=40834
2024-11-07 15:11:15 - progress_bar.py[line:274] - INFO: epoch 017:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.282, ntokens=17528.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.73, wps=3232.3, ups=0.18, wpb=17528.8, bsz=1024, num_updates=6350, lr=4.4553e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=40888
2024-11-07 15:12:09 - progress_bar.py[line:274] - INFO: epoch 017:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.28, ntokens=17272.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.71, wps=3197.9, ups=0.19, wpb=17272.6, bsz=1024, num_updates=6360, lr=4.45394e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=12.9, wall=40942
2024-11-07 15:13:02 - progress_bar.py[line:274] - INFO: epoch 017:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17574.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3261.6, ups=0.19, wpb=17574.1, bsz=1024, num_updates=6370, lr=4.45258e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=40996
2024-11-07 15:13:56 - progress_bar.py[line:274] - INFO: epoch 017:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17509.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3269.7, ups=0.19, wpb=17509.4, bsz=1024, num_updates=6380, lr=4.45122e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=41049
2024-11-07 15:14:50 - progress_bar.py[line:274] - INFO: epoch 017:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.272, ntokens=17316.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3207.3, ups=0.19, wpb=17316.6, bsz=1024, num_updates=6390, lr=4.44986e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=41103
2024-11-07 15:15:43 - progress_bar.py[line:274] - INFO: epoch 017:    148 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17156.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3208.7, ups=0.19, wpb=17156.7, bsz=1024, num_updates=6400, lr=4.4485e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=41157
2024-11-07 15:16:37 - progress_bar.py[line:274] - INFO: epoch 017:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17326.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3211.5, ups=0.19, wpb=17326.7, bsz=1024, num_updates=6410, lr=4.44714e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=41211
2024-11-07 15:17:31 - progress_bar.py[line:274] - INFO: epoch 017:    168 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.182, ntokens=16962, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3167.2, ups=0.19, wpb=16962, bsz=1024, num_updates=6420, lr=4.44577e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=41264
2024-11-07 15:18:25 - progress_bar.py[line:274] - INFO: epoch 017:    178 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.243, ntokens=17454.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3237.3, ups=0.19, wpb=17454.2, bsz=1024, num_updates=6430, lr=4.44441e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=41318
2024-11-07 15:19:19 - progress_bar.py[line:274] - INFO: epoch 017:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.277, ntokens=17373, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3228.4, ups=0.19, wpb=17373, bsz=1024, num_updates=6440, lr=4.44305e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=41372
2024-11-07 15:20:12 - progress_bar.py[line:274] - INFO: epoch 017:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.253, ntokens=17404, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.53, wps=3243.7, ups=0.19, wpb=17404, bsz=1024, num_updates=6450, lr=4.44169e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=41426
2024-11-07 15:21:07 - progress_bar.py[line:274] - INFO: epoch 017:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.207, ntokens=16949.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3094.1, ups=0.18, wpb=16949.7, bsz=1024, num_updates=6460, lr=4.44033e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=41, gb_free=13.6, wall=41481
2024-11-07 15:22:02 - progress_bar.py[line:274] - INFO: epoch 017:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17088.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3109.4, ups=0.18, wpb=17088.1, bsz=1024, num_updates=6470, lr=4.43897e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=41536
2024-11-07 15:22:58 - progress_bar.py[line:274] - INFO: epoch 017:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.293, ntokens=17588.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.8, wps=3154, ups=0.18, wpb=17588.9, bsz=1024, num_updates=6480, lr=4.43761e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=41591
2024-11-07 15:23:53 - progress_bar.py[line:274] - INFO: epoch 017:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17126.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3083.2, ups=0.18, wpb=17126.8, bsz=1024, num_updates=6490, lr=4.43625e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=55, gb_free=13.6, wall=41647
2024-11-07 15:24:48 - progress_bar.py[line:274] - INFO: epoch 017:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.251, ntokens=17575.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.52, wps=3213, ups=0.18, wpb=17575.2, bsz=1024, num_updates=6500, lr=4.43489e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=41702
2024-11-07 15:25:43 - progress_bar.py[line:274] - INFO: epoch 017:    258 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.214, ntokens=17355.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3152.9, ups=0.18, wpb=17355.4, bsz=1024, num_updates=6510, lr=4.43353e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=41757
2024-11-07 15:26:39 - progress_bar.py[line:274] - INFO: epoch 017:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.255, ntokens=17444.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.55, wps=3111.7, ups=0.18, wpb=17444.2, bsz=1024, num_updates=6520, lr=4.43217e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=56, gb_free=13.6, wall=41813
2024-11-07 15:27:36 - progress_bar.py[line:274] - INFO: epoch 017:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.231, ntokens=17146.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.39, wps=3044.6, ups=0.18, wpb=17146.4, bsz=1024, num_updates=6530, lr=4.43081e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=41869
2024-11-07 15:28:29 - progress_bar.py[line:274] - INFO: epoch 017:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.174, ntokens=17028.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=3159.7, ups=0.19, wpb=17028.2, bsz=1024, num_updates=6540, lr=4.42945e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=41923
2024-11-07 15:29:23 - progress_bar.py[line:274] - INFO: epoch 017:    298 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17170.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3225.3, ups=0.19, wpb=17170.6, bsz=1024, num_updates=6550, lr=4.42809e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=53, gb_free=12.9, wall=41976
2024-11-07 15:30:18 - progress_bar.py[line:274] - INFO: epoch 017:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.272, ntokens=17255.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3126.4, ups=0.18, wpb=17255.2, bsz=1024, num_updates=6560, lr=4.42673e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=42031
2024-11-07 15:31:14 - progress_bar.py[line:274] - INFO: epoch 017:    318 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3100.4, ups=0.18, wpb=17424.2, bsz=1024, num_updates=6570, lr=4.42537e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=42088
2024-11-07 15:32:09 - progress_bar.py[line:274] - INFO: epoch 017:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17355.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3168.6, ups=0.18, wpb=17355.5, bsz=1024, num_updates=6580, lr=4.42401e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=42142
2024-11-07 15:33:05 - progress_bar.py[line:274] - INFO: epoch 017:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.26, ntokens=17545.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.58, wps=3131.2, ups=0.18, wpb=17545.9, bsz=1024, num_updates=6590, lr=4.42265e-05, gnorm=0.016, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=42198
2024-11-07 15:34:00 - progress_bar.py[line:274] - INFO: epoch 017:    348 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.275, ntokens=17336.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.68, wps=3143.4, ups=0.18, wpb=17336.4, bsz=1024, num_updates=6600, lr=4.42129e-05, gnorm=0.017, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=42254
2024-11-07 15:34:53 - progress_bar.py[line:274] - INFO: epoch 017:    358 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.205, ntokens=17495, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.22, wps=3274.7, ups=0.19, wpb=17495, bsz=1024, num_updates=6610, lr=4.41993e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=53, gb_free=13.2, wall=42307
2024-11-07 15:35:50 - progress_bar.py[line:274] - INFO: epoch 017:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=17702.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3108.1, ups=0.18, wpb=17702.4, bsz=1024, num_updates=6620, lr=4.41857e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=57, gb_free=13.3, wall=42364
2024-11-07 15:36:44 - progress_bar.py[line:274] - INFO: epoch 017:    378 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.349, ntokens=17311.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.19, wps=3228, ups=0.19, wpb=17311.8, bsz=1024, num_updates=6630, lr=4.41721e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=42418
2024-11-07 15:37:38 - progress_bar.py[line:274] - INFO: epoch 017:    388 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.424, ntokens=17629.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.74, wps=3270.7, ups=0.19, wpb=17629.4, bsz=1024, num_updates=6640, lr=4.41585e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=42471
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt2024-11-07 15:37:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6643 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-07 15:37:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 15:39:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-07 15:41:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6643 updates, score 0) (writing took 223.54341171201668 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-07 15:42:29 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-07 15:42:29 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.255 | ntokens 17317 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.55 | wps 2638.9 | ups 0.15 | wpb 17317 | bsz 1023 | num_updates 6643 | lr 4.41544e-05 | gnorm 0.01 | clip 0 | loss_scale 16384 | train_wall 1648 | gb_free 13.2 | wall 42763
2024-11-07 15:42:29 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 15:45:10 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-07 15:45:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 15:45:50 - progress_bar.py[line:274] - INFO: epoch 018:      7 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.278, ntokens=16721.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=339.6, ups=0.02, wpb=16721.3, bsz=985.6, num_updates=6650, lr=4.41449e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=34, gb_free=13.5, wall=42964
2024-11-07 15:46:44 - progress_bar.py[line:274] - INFO: epoch 018:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17264.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3209.8, ups=0.19, wpb=17264.6, bsz=1024, num_updates=6660, lr=4.41313e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=43018
2024-11-07 15:47:38 - progress_bar.py[line:274] - INFO: epoch 018:     27 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.21, ntokens=17323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3228.2, ups=0.19, wpb=17323.6, bsz=1024, num_updates=6670, lr=4.41176e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=43071
2024-11-07 15:48:31 - progress_bar.py[line:274] - INFO: epoch 018:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17207.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3203.4, ups=0.19, wpb=17207.4, bsz=1024, num_updates=6680, lr=4.4104e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=43125
2024-11-07 15:49:25 - progress_bar.py[line:274] - INFO: epoch 018:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17604.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3288.4, ups=0.19, wpb=17604.2, bsz=1024, num_updates=6690, lr=4.40904e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=43178
2024-11-07 15:50:18 - progress_bar.py[line:274] - INFO: epoch 018:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.264, ntokens=17346.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3239.9, ups=0.19, wpb=17346.7, bsz=1024, num_updates=6700, lr=4.40768e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=43232
2024-11-07 15:51:13 - progress_bar.py[line:274] - INFO: epoch 018:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17019.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3136.4, ups=0.18, wpb=17019.1, bsz=1024, num_updates=6710, lr=4.40632e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43286
2024-11-07 15:52:07 - progress_bar.py[line:274] - INFO: epoch 018:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17256.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.58, wps=3196.1, ups=0.19, wpb=17256.9, bsz=1024, num_updates=6720, lr=4.40496e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=43340
2024-11-07 15:53:00 - progress_bar.py[line:274] - INFO: epoch 018:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.237, ntokens=17513.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3257.7, ups=0.19, wpb=17513.8, bsz=1024, num_updates=6730, lr=4.4036e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=43394
2024-11-07 15:53:54 - progress_bar.py[line:274] - INFO: epoch 018:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.267, ntokens=17394.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.63, wps=3227.8, ups=0.19, wpb=17394.6, bsz=1024, num_updates=6740, lr=4.40224e-05, gnorm=0.015, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=43448
2024-11-07 15:54:48 - progress_bar.py[line:274] - INFO: epoch 018:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.242, ntokens=17407, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3239.1, ups=0.19, wpb=17407, bsz=1024, num_updates=6750, lr=4.40088e-05, gnorm=0.017, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=43502
2024-11-07 15:55:43 - progress_bar.py[line:274] - INFO: epoch 018:    117 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.256, ntokens=17214.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.55, wps=3164.2, ups=0.18, wpb=17214.8, bsz=1024, num_updates=6760, lr=4.39952e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=43556
2024-11-07 15:56:37 - progress_bar.py[line:274] - INFO: epoch 018:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.173, ntokens=17311.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.02, wps=3198.5, ups=0.18, wpb=17311.7, bsz=1024, num_updates=6770, lr=4.39816e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=43610
2024-11-07 15:57:32 - progress_bar.py[line:274] - INFO: epoch 018:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.264, ntokens=17278.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3137.5, ups=0.18, wpb=17278.8, bsz=1024, num_updates=6780, lr=4.3968e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=43665
2024-11-07 15:58:26 - progress_bar.py[line:274] - INFO: epoch 018:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17487.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3193, ups=0.18, wpb=17487.3, bsz=1024, num_updates=6790, lr=4.39544e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=43720
2024-11-07 15:59:21 - progress_bar.py[line:274] - INFO: epoch 018:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.251, ntokens=17440, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.52, wps=3214.4, ups=0.18, wpb=17440, bsz=1024, num_updates=6800, lr=4.39408e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=43774
2024-11-07 16:00:15 - progress_bar.py[line:274] - INFO: epoch 018:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17113.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3128.4, ups=0.18, wpb=17113.5, bsz=1024, num_updates=6810, lr=4.39272e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=43829
2024-11-07 16:01:10 - progress_bar.py[line:274] - INFO: epoch 018:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.207, ntokens=17531.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3191.7, ups=0.18, wpb=17531.2, bsz=1024, num_updates=6820, lr=4.39136e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=43884
2024-11-07 16:02:05 - progress_bar.py[line:274] - INFO: epoch 018:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.217, ntokens=17134.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3161.3, ups=0.18, wpb=17134.3, bsz=1024, num_updates=6830, lr=4.39e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=43938
2024-11-07 16:02:59 - progress_bar.py[line:274] - INFO: epoch 018:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=17201.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3152.4, ups=0.18, wpb=17201.8, bsz=1024, num_updates=6840, lr=4.38864e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=43993
2024-11-07 16:03:53 - progress_bar.py[line:274] - INFO: epoch 018:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.208, ntokens=17139.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3174.2, ups=0.19, wpb=17139.2, bsz=1024, num_updates=6850, lr=4.38728e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=44047
2024-11-07 16:04:48 - progress_bar.py[line:274] - INFO: epoch 018:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.208, ntokens=17133.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3146.7, ups=0.18, wpb=17133.8, bsz=1024, num_updates=6860, lr=4.38592e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=44101
2024-11-07 16:05:42 - progress_bar.py[line:274] - INFO: epoch 018:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17522.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3212.3, ups=0.18, wpb=17522.1, bsz=1024, num_updates=6870, lr=4.38456e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=44156
2024-11-07 16:06:36 - progress_bar.py[line:274] - INFO: epoch 018:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.154, ntokens=17031.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.9, wps=3174.4, ups=0.19, wpb=17031.7, bsz=1024, num_updates=6880, lr=4.3832e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=44209
2024-11-07 16:07:30 - progress_bar.py[line:274] - INFO: epoch 018:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.24, ntokens=17487.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3245, ups=0.19, wpb=17487.7, bsz=1024, num_updates=6890, lr=4.38184e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=44263
2024-11-07 16:08:24 - progress_bar.py[line:274] - INFO: epoch 018:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17389.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3180, ups=0.18, wpb=17389.5, bsz=1024, num_updates=6900, lr=4.38048e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=44318
2024-11-07 16:09:18 - progress_bar.py[line:274] - INFO: epoch 018:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.241, ntokens=17326.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3227.5, ups=0.19, wpb=17326.2, bsz=1024, num_updates=6910, lr=4.37912e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=44372
2024-11-07 16:10:12 - progress_bar.py[line:274] - INFO: epoch 018:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=17291.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3183.3, ups=0.18, wpb=17291.7, bsz=1024, num_updates=6920, lr=4.37775e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=44426
2024-11-07 16:11:08 - progress_bar.py[line:274] - INFO: epoch 018:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.173, ntokens=17131.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.02, wps=3106.8, ups=0.18, wpb=17131.2, bsz=1024, num_updates=6930, lr=4.37639e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=44481
2024-11-07 16:12:03 - progress_bar.py[line:274] - INFO: epoch 018:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3109, ups=0.18, wpb=17312.9, bsz=1024, num_updates=6940, lr=4.37503e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=44537
2024-11-07 16:12:59 - progress_bar.py[line:274] - INFO: epoch 018:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17216.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3112.7, ups=0.18, wpb=17216.8, bsz=1024, num_updates=6950, lr=4.37367e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=44592
2024-11-07 16:13:53 - progress_bar.py[line:274] - INFO: epoch 018:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17273.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3142.5, ups=0.18, wpb=17273.9, bsz=1024, num_updates=6960, lr=4.37231e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=44647
2024-11-07 16:14:48 - progress_bar.py[line:274] - INFO: epoch 018:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.19, ntokens=17164.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3154.6, ups=0.18, wpb=17164.9, bsz=1024, num_updates=6970, lr=4.37095e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=44701
2024-11-07 16:15:43 - progress_bar.py[line:274] - INFO: epoch 018:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.224, ntokens=17394.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3132.6, ups=0.18, wpb=17394.7, bsz=1024, num_updates=6980, lr=4.36959e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=44757
2024-11-07 16:16:39 - progress_bar.py[line:274] - INFO: epoch 018:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.235, ntokens=17361.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3139.1, ups=0.18, wpb=17361.8, bsz=1024, num_updates=6990, lr=4.36823e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=44812
2024-11-07 16:17:35 - progress_bar.py[line:274] - INFO: epoch 018:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.195, ntokens=17596.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3147.1, ups=0.18, wpb=17596.2, bsz=1024, num_updates=7000, lr=4.36687e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=44868
2024-11-07 16:18:30 - progress_bar.py[line:274] - INFO: epoch 018:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=17812.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3201.1, ups=0.18, wpb=17812.1, bsz=1024, num_updates=7010, lr=4.36551e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=44924
2024-11-07 16:19:24 - progress_bar.py[line:274] - INFO: epoch 018:    377 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=17803.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3293.5, ups=0.18, wpb=17803.2, bsz=1024, num_updates=7020, lr=4.36415e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=44978
2024-11-07 16:20:18 - progress_bar.py[line:274] - INFO: epoch 018:    387 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=17562.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=3279.4, ups=0.19, wpb=17562.3, bsz=1024, num_updates=7030, lr=4.36279e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=45031
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt

2024-11-07 16:20:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 7034 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
2024-11-07 16:20:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 16:22:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-07 16:24:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 18 @ 7034 updates, score 0) (writing took 225.10859888698906 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
2024-11-07 16:25:17 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-07 16:25:17 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.23 | ntokens 17322.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.38 | wps 2638.1 | ups 0.15 | wpb 17322.7 | bsz 1023 | num_updates 7034 | lr 4.36225e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 1448 | gb_free 13.4 | wall 45330
2024-11-07 16:25:17 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 16:27:58 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-07 16:27:58 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 16:28:32 - progress_bar.py[line:274] - INFO: epoch 019:      6 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.222, ntokens=16462.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.33, wps=332.9, ups=0.02, wpb=16462.6, bsz=985.6, num_updates=7040, lr=4.36143e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=36, gb_free=13.6, wall=45526
2024-11-07 16:29:27 - progress_bar.py[line:274] - INFO: epoch 019:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.3, ntokens=17446.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.85, wps=3225.4, ups=0.18, wpb=17446.7, bsz=1024, num_updates=7050, lr=4.36007e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=45580
2024-11-07 16:30:21 - progress_bar.py[line:274] - INFO: epoch 019:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17398.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3226, ups=0.19, wpb=17398.4, bsz=1024, num_updates=7060, lr=4.35871e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=45634
2024-11-07 16:31:14 - progress_bar.py[line:274] - INFO: epoch 019:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3241.7, ups=0.19, wpb=17258.7, bsz=1024, num_updates=7070, lr=4.35735e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=45687
2024-11-07 16:32:08 - progress_bar.py[line:274] - INFO: epoch 019:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.177, ntokens=17507.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3254, ups=0.19, wpb=17507.5, bsz=1024, num_updates=7080, lr=4.35599e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=45741
2024-11-07 16:33:00 - progress_bar.py[line:274] - INFO: epoch 019:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.255, ntokens=17471.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.55, wps=3300.4, ups=0.19, wpb=17471.8, bsz=1024, num_updates=7090, lr=4.35463e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=45794
2024-11-07 16:33:54 - progress_bar.py[line:274] - INFO: epoch 019:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.08, ntokens=17023.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3177.1, ups=0.19, wpb=17023.8, bsz=1024, num_updates=7100, lr=4.35327e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=45848
2024-11-07 16:34:48 - progress_bar.py[line:274] - INFO: epoch 019:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.242, ntokens=17278, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3223.3, ups=0.19, wpb=17278, bsz=1024, num_updates=7110, lr=4.35191e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=45901
2024-11-07 16:35:42 - progress_bar.py[line:274] - INFO: epoch 019:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.248, ntokens=17585, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3231.2, ups=0.18, wpb=17585, bsz=1024, num_updates=7120, lr=4.35055e-05, gnorm=0.015, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=45956
2024-11-07 16:36:37 - progress_bar.py[line:274] - INFO: epoch 019:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17120.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3143.7, ups=0.18, wpb=17120.4, bsz=1024, num_updates=7130, lr=4.34919e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=46010
2024-11-07 16:37:32 - progress_bar.py[line:274] - INFO: epoch 019:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17638.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3193.1, ups=0.18, wpb=17638.8, bsz=1024, num_updates=7140, lr=4.34783e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46065
2024-11-07 16:38:27 - progress_bar.py[line:274] - INFO: epoch 019:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=17108.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3094.2, ups=0.18, wpb=17108.7, bsz=1024, num_updates=7150, lr=4.34647e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=46121
2024-11-07 16:39:22 - progress_bar.py[line:274] - INFO: epoch 019:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.217, ntokens=17642.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3211.7, ups=0.18, wpb=17642.1, bsz=1024, num_updates=7160, lr=4.34511e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=46176
2024-11-07 16:40:17 - progress_bar.py[line:274] - INFO: epoch 019:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.231, ntokens=17290.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.39, wps=3157.9, ups=0.18, wpb=17290.8, bsz=1024, num_updates=7170, lr=4.34374e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=46230
2024-11-07 16:41:13 - progress_bar.py[line:274] - INFO: epoch 019:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.203, ntokens=17279.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.21, wps=3096.2, ups=0.18, wpb=17279.3, bsz=1024, num_updates=7180, lr=4.34238e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=46286
2024-11-07 16:42:08 - progress_bar.py[line:274] - INFO: epoch 019:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17202.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3084.8, ups=0.18, wpb=17202.2, bsz=1024, num_updates=7190, lr=4.34102e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=46342
2024-11-07 16:43:04 - progress_bar.py[line:274] - INFO: epoch 019:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.188, ntokens=17156.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=3087.5, ups=0.18, wpb=17156.8, bsz=1024, num_updates=7200, lr=4.33966e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=46397
2024-11-07 16:43:59 - progress_bar.py[line:274] - INFO: epoch 019:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17336.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3141.6, ups=0.18, wpb=17336.1, bsz=1024, num_updates=7210, lr=4.3383e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=46453
2024-11-07 16:44:54 - progress_bar.py[line:274] - INFO: epoch 019:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.201, ntokens=17069.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3114.3, ups=0.18, wpb=17069.8, bsz=1024, num_updates=7220, lr=4.33694e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=46507
2024-11-07 16:45:49 - progress_bar.py[line:274] - INFO: epoch 019:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=17497.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3189.2, ups=0.18, wpb=17497.3, bsz=1024, num_updates=7230, lr=4.33558e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=46562
2024-11-07 16:46:44 - progress_bar.py[line:274] - INFO: epoch 019:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.205, ntokens=17260.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.22, wps=3147.4, ups=0.18, wpb=17260.3, bsz=1024, num_updates=7240, lr=4.33422e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=46617
2024-11-07 16:47:39 - progress_bar.py[line:274] - INFO: epoch 019:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=17176.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3123.7, ups=0.18, wpb=17176.9, bsz=1024, num_updates=7250, lr=4.33286e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=46672
2024-11-07 16:48:33 - progress_bar.py[line:274] - INFO: epoch 019:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17207.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3170.6, ups=0.18, wpb=17207.2, bsz=1024, num_updates=7260, lr=4.3315e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=46726
2024-11-07 16:49:27 - progress_bar.py[line:274] - INFO: epoch 019:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.213, ntokens=17302.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3195.3, ups=0.18, wpb=17302.3, bsz=1024, num_updates=7270, lr=4.33014e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=46781
2024-11-07 16:50:23 - progress_bar.py[line:274] - INFO: epoch 019:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.242, ntokens=17533.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3143, ups=0.18, wpb=17533.7, bsz=1024, num_updates=7280, lr=4.32878e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=46836
2024-11-07 16:51:18 - progress_bar.py[line:274] - INFO: epoch 019:    256 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17291.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3121, ups=0.18, wpb=17291.3, bsz=1024, num_updates=7290, lr=4.32742e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=46892
2024-11-07 16:52:14 - progress_bar.py[line:274] - INFO: epoch 019:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17348.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3130.4, ups=0.18, wpb=17348.3, bsz=1024, num_updates=7300, lr=4.32606e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=46947
2024-11-07 16:53:09 - progress_bar.py[line:274] - INFO: epoch 019:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17258, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3103.5, ups=0.18, wpb=17258, bsz=1024, num_updates=7310, lr=4.3247e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=47003
2024-11-07 16:54:07 - progress_bar.py[line:274] - INFO: epoch 019:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.167, ntokens=17219.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3002.7, ups=0.17, wpb=17219.4, bsz=1024, num_updates=7320, lr=4.32334e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=47060
2024-11-07 16:54:12 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 16:55:09 - progress_bar.py[line:274] - INFO: epoch 019:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17202.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=2746.5, ups=0.16, wpb=17202.1, bsz=1024, num_updates=7330, lr=4.32198e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=47123
2024-11-07 16:56:06 - progress_bar.py[line:274] - INFO: epoch 019:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.218, ntokens=17187.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3014.3, ups=0.18, wpb=17187.6, bsz=1024, num_updates=7340, lr=4.32062e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=47180
2024-11-07 16:57:02 - progress_bar.py[line:274] - INFO: epoch 019:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.211, ntokens=17506.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3126.6, ups=0.18, wpb=17506.6, bsz=1024, num_updates=7350, lr=4.31926e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=47236
2024-11-07 16:57:59 - progress_bar.py[line:274] - INFO: epoch 019:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.169, ntokens=17315.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3075.9, ups=0.18, wpb=17315.1, bsz=1024, num_updates=7360, lr=4.3179e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=47292
2024-11-07 16:58:54 - progress_bar.py[line:274] - INFO: epoch 019:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17371.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3109, ups=0.18, wpb=17371.5, bsz=1024, num_updates=7370, lr=4.31654e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=47348
2024-11-07 16:59:49 - progress_bar.py[line:274] - INFO: epoch 019:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.175, ntokens=17129, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=3155.4, ups=0.18, wpb=17129, bsz=1024, num_updates=7380, lr=4.31518e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47402
2024-11-07 17:00:42 - progress_bar.py[line:274] - INFO: epoch 019:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17568.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3278.3, ups=0.19, wpb=17568.9, bsz=1024, num_updates=7390, lr=4.31382e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=47456
2024-11-07 17:01:38 - progress_bar.py[line:274] - INFO: epoch 019:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.224, ntokens=17513.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3170.9, ups=0.18, wpb=17513.7, bsz=1024, num_updates=7400, lr=4.31246e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=47511
2024-11-07 17:02:31 - progress_bar.py[line:274] - INFO: epoch 019:    377 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=17782.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=3298.2, ups=0.19, wpb=17782.9, bsz=1024, num_updates=7410, lr=4.3111e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=47565
2024-11-07 17:03:23 - progress_bar.py[line:274] - INFO: epoch 019:    387 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3340.8, ups=0.19, wpb=17378.7, bsz=1024, num_updates=7420, lr=4.30973e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=47617
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-07 17:03:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 7424 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-07 17:03:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 17:05:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-07 17:07:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 19 @ 7424 updates, score 0) (writing took 220.81387617599103 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-07 17:08:17 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-07 17:08:17 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.21 | ntokens 17320.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.26 | wps 2617.6 | ups 0.15 | wpb 17320.5 | bsz 1023 | num_updates 7424 | lr 4.30919e-05 | gnorm 0.009 | clip 0 | loss_scale 32768 | train_wall 1193 | gb_free 13.2 | wall 47911
2024-11-07 17:08:17 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 17:10:58 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-07 17:10:58 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 17:11:33 - progress_bar.py[line:274] - INFO: epoch 020:      6 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.261, ntokens=16851.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=344.5, ups=0.02, wpb=16851.1, bsz=985.6, num_updates=7430, lr=4.30837e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.5, wall=48106
2024-11-07 17:12:26 - progress_bar.py[line:274] - INFO: epoch 020:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.289, ntokens=17626.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.77, wps=3309.8, ups=0.19, wpb=17626.6, bsz=1024, num_updates=7440, lr=4.30701e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=48159
2024-11-07 17:13:19 - progress_bar.py[line:274] - INFO: epoch 020:     26 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17196.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3223.3, ups=0.19, wpb=17196.3, bsz=1024, num_updates=7450, lr=4.30565e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48213
2024-11-07 17:14:12 - progress_bar.py[line:274] - INFO: epoch 020:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=17111.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3210.9, ups=0.19, wpb=17111.2, bsz=1024, num_updates=7460, lr=4.30429e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48266
2024-11-07 17:15:07 - progress_bar.py[line:274] - INFO: epoch 020:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17701.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3219.5, ups=0.18, wpb=17701.7, bsz=1024, num_updates=7470, lr=4.30293e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48321
2024-11-07 17:16:01 - progress_bar.py[line:274] - INFO: epoch 020:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17358.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.4, wps=3227, ups=0.19, wpb=17358.5, bsz=1024, num_updates=7480, lr=4.30157e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=48375
2024-11-07 17:16:55 - progress_bar.py[line:274] - INFO: epoch 020:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17161.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3182.3, ups=0.19, wpb=17161.2, bsz=1024, num_updates=7490, lr=4.30021e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=48429
2024-11-07 17:17:49 - progress_bar.py[line:274] - INFO: epoch 020:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17310.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3226.2, ups=0.19, wpb=17310.6, bsz=1024, num_updates=7500, lr=4.29885e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=48482
2024-11-07 17:18:43 - progress_bar.py[line:274] - INFO: epoch 020:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17393.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3188.7, ups=0.18, wpb=17393.1, bsz=1024, num_updates=7510, lr=4.29749e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48537
2024-11-07 17:19:37 - progress_bar.py[line:274] - INFO: epoch 020:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.19, ntokens=17141, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3188.3, ups=0.19, wpb=17141, bsz=1024, num_updates=7520, lr=4.29613e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=48591
2024-11-07 17:20:31 - progress_bar.py[line:274] - INFO: epoch 020:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17462.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3230.9, ups=0.19, wpb=17462.9, bsz=1024, num_updates=7530, lr=4.29477e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=48645
2024-11-07 17:21:25 - progress_bar.py[line:274] - INFO: epoch 020:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.172, ntokens=17127.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3164.1, ups=0.18, wpb=17127.8, bsz=1024, num_updates=7540, lr=4.29341e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=48699
2024-11-07 17:22:20 - progress_bar.py[line:274] - INFO: epoch 020:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17542.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3212.3, ups=0.18, wpb=17542.4, bsz=1024, num_updates=7550, lr=4.29205e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=48753
2024-11-07 17:23:15 - progress_bar.py[line:274] - INFO: epoch 020:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17120.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3109.5, ups=0.18, wpb=17120.5, bsz=1024, num_updates=7560, lr=4.29069e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=48808
2024-11-07 17:24:09 - progress_bar.py[line:274] - INFO: epoch 020:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.172, ntokens=17146.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3167.2, ups=0.18, wpb=17146.3, bsz=1024, num_updates=7570, lr=4.28933e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48863
2024-11-07 17:25:03 - progress_bar.py[line:274] - INFO: epoch 020:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17385.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3222.6, ups=0.19, wpb=17385.1, bsz=1024, num_updates=7580, lr=4.28797e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=48917
2024-11-07 17:25:58 - progress_bar.py[line:274] - INFO: epoch 020:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17165.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3097.6, ups=0.18, wpb=17165.3, bsz=1024, num_updates=7590, lr=4.28661e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=48972
2024-11-07 17:26:53 - progress_bar.py[line:274] - INFO: epoch 020:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17413.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3210.8, ups=0.18, wpb=17413.9, bsz=1024, num_updates=7600, lr=4.28525e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=49026
2024-11-07 17:27:47 - progress_bar.py[line:274] - INFO: epoch 020:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.18, ntokens=17122.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3139, ups=0.18, wpb=17122.2, bsz=1024, num_updates=7610, lr=4.28389e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=49081
2024-11-07 17:28:41 - progress_bar.py[line:274] - INFO: epoch 020:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17149.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3204.9, ups=0.19, wpb=17149.7, bsz=1024, num_updates=7620, lr=4.28253e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=49134
2024-11-07 17:29:35 - progress_bar.py[line:274] - INFO: epoch 020:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17188.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3172.4, ups=0.18, wpb=17188.9, bsz=1024, num_updates=7630, lr=4.28117e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=49188
2024-11-07 17:30:29 - progress_bar.py[line:274] - INFO: epoch 020:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=16902.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3140, ups=0.19, wpb=16902.5, bsz=1024, num_updates=7640, lr=4.27981e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=49242
2024-11-07 17:31:22 - progress_bar.py[line:274] - INFO: epoch 020:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.165, ntokens=17366.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.97, wps=3247.8, ups=0.19, wpb=17366.7, bsz=1024, num_updates=7650, lr=4.27845e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=49296
2024-11-07 17:32:16 - progress_bar.py[line:274] - INFO: epoch 020:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.164, ntokens=17213.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3189.7, ups=0.19, wpb=17213.6, bsz=1024, num_updates=7660, lr=4.27709e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=49350
2024-11-07 17:33:11 - progress_bar.py[line:274] - INFO: epoch 020:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.178, ntokens=17496.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3223.1, ups=0.18, wpb=17496.7, bsz=1024, num_updates=7670, lr=4.27573e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=49404
2024-11-07 17:34:04 - progress_bar.py[line:274] - INFO: epoch 020:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.144, ntokens=17425.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.84, wps=3252.1, ups=0.19, wpb=17425.5, bsz=1024, num_updates=7680, lr=4.27436e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=49458
2024-11-07 17:34:58 - progress_bar.py[line:274] - INFO: epoch 020:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17295.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3197.4, ups=0.18, wpb=17295.3, bsz=1024, num_updates=7690, lr=4.273e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=49512
2024-11-07 17:35:52 - progress_bar.py[line:274] - INFO: epoch 020:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.158, ntokens=17271.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3192, ups=0.18, wpb=17271.2, bsz=1024, num_updates=7700, lr=4.27164e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=49566
2024-11-07 17:36:47 - progress_bar.py[line:274] - INFO: epoch 020:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.165, ntokens=17312.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.97, wps=3141.4, ups=0.18, wpb=17312.4, bsz=1024, num_updates=7710, lr=4.27028e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=38, gb_free=13.5, wall=49621
2024-11-07 17:37:42 - progress_bar.py[line:274] - INFO: epoch 020:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.151, ntokens=17301.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3156.7, ups=0.18, wpb=17301.6, bsz=1024, num_updates=7720, lr=4.26892e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=46, gb_free=13.6, wall=49676
2024-11-07 17:38:37 - progress_bar.py[line:274] - INFO: epoch 020:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.174, ntokens=17062.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.02, wps=3129.1, ups=0.18, wpb=17062.2, bsz=1024, num_updates=7730, lr=4.26756e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=51, gb_free=13.6, wall=49730
2024-11-07 17:39:32 - progress_bar.py[line:274] - INFO: epoch 020:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17418.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3180.2, ups=0.18, wpb=17418.3, bsz=1024, num_updates=7740, lr=4.2662e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13, wall=49785
2024-11-07 17:40:29 - progress_bar.py[line:274] - INFO: epoch 020:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17403.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3024.6, ups=0.17, wpb=17403.1, bsz=1024, num_updates=7750, lr=4.26484e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.1, wall=49843
2024-11-07 17:41:24 - progress_bar.py[line:274] - INFO: epoch 020:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.213, ntokens=17603.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3194.9, ups=0.18, wpb=17603.7, bsz=1024, num_updates=7760, lr=4.26348e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=49898
2024-11-07 17:42:21 - progress_bar.py[line:274] - INFO: epoch 020:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17358.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3034.4, ups=0.17, wpb=17358.7, bsz=1024, num_updates=7770, lr=4.26212e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=49955
2024-11-07 17:43:18 - progress_bar.py[line:274] - INFO: epoch 020:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3055, ups=0.18, wpb=17448.2, bsz=1024, num_updates=7780, lr=4.26076e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=50012
2024-11-07 17:44:12 - progress_bar.py[line:274] - INFO: epoch 020:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17543.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3262.7, ups=0.19, wpb=17543.4, bsz=1024, num_updates=7790, lr=4.2594e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=50066
2024-11-07 17:45:08 - progress_bar.py[line:274] - INFO: epoch 020:    376 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17535.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3153.6, ups=0.18, wpb=17535.7, bsz=1024, num_updates=7800, lr=4.25804e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=50121
2024-11-07 17:46:01 - progress_bar.py[line:274] - INFO: epoch 020:    386 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=17578.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=3334.7, ups=0.19, wpb=17578.8, bsz=1024, num_updates=7810, lr=4.25668e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=50174
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
2024-11-07 17:46:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 7815 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
2024-11-07 17:46:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 17:48:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-07 17:50:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 20 @ 7815 updates, score 0) (writing took 226.10088957601693 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-07 17:51:05 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-07 17:51:05 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.187 | ntokens 17314.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.11 | wps 2636.4 | ups 0.15 | wpb 17314.5 | bsz 1023 | num_updates 7815 | lr 4.256e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1442 | gb_free 13.2 | wall 50479
2024-11-07 17:51:05 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 17:53:47 - trainer.py[line:703] - INFO: begin training epoch 21
2024-11-07 17:53:47 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 17:54:16 - progress_bar.py[line:274] - INFO: epoch 021:      5 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.207, ntokens=16651.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=336, ups=0.02, wpb=16651.8, bsz=985.6, num_updates=7820, lr=4.25532e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=38, gb_free=13, wall=50670
2024-11-07 17:55:12 - progress_bar.py[line:274] - INFO: epoch 021:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.24, ntokens=17471.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3126.1, ups=0.18, wpb=17471.4, bsz=1024, num_updates=7830, lr=4.25396e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=50725
2024-11-07 17:56:06 - progress_bar.py[line:274] - INFO: epoch 021:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=17565.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3250.9, ups=0.19, wpb=17565.7, bsz=1024, num_updates=7840, lr=4.2526e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=50780
2024-11-07 17:57:00 - progress_bar.py[line:274] - INFO: epoch 021:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.201, ntokens=17487.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3238.2, ups=0.19, wpb=17487.4, bsz=1024, num_updates=7850, lr=4.25124e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=50834
2024-11-07 17:57:54 - progress_bar.py[line:274] - INFO: epoch 021:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.146, ntokens=17355.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3217.2, ups=0.19, wpb=17355.1, bsz=1024, num_updates=7860, lr=4.24988e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=50887
2024-11-07 17:58:48 - progress_bar.py[line:274] - INFO: epoch 021:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.152, ntokens=17206.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3189.8, ups=0.19, wpb=17206.6, bsz=1024, num_updates=7870, lr=4.24852e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50941
2024-11-07 17:59:43 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 17:59:49 - progress_bar.py[line:274] - INFO: epoch 021:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17213.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=2820, ups=0.16, wpb=17213.2, bsz=1024, num_updates=7880, lr=4.24716e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=51002
2024-11-07 18:00:43 - progress_bar.py[line:274] - INFO: epoch 021:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.182, ntokens=17262.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3187.7, ups=0.18, wpb=17262.1, bsz=1024, num_updates=7890, lr=4.2458e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=51057
2024-11-07 18:01:37 - progress_bar.py[line:274] - INFO: epoch 021:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17471.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3251.8, ups=0.19, wpb=17471.3, bsz=1024, num_updates=7900, lr=4.24444e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=51110
2024-11-07 18:02:31 - progress_bar.py[line:274] - INFO: epoch 021:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3168.6, ups=0.18, wpb=17289.7, bsz=1024, num_updates=7910, lr=4.24308e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=35, gb_free=13.6, wall=51165
2024-11-07 18:03:27 - progress_bar.py[line:274] - INFO: epoch 021:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17579.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3165.7, ups=0.18, wpb=17579.1, bsz=1024, num_updates=7920, lr=4.24172e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=50, gb_free=13.2, wall=51220
2024-11-07 18:04:22 - progress_bar.py[line:274] - INFO: epoch 021:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17427.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3173.8, ups=0.18, wpb=17427.5, bsz=1024, num_updates=7930, lr=4.24035e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=51275
2024-11-07 18:05:17 - progress_bar.py[line:274] - INFO: epoch 021:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17270.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3122.5, ups=0.18, wpb=17270.6, bsz=1024, num_updates=7940, lr=4.23899e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=51331
2024-11-07 18:06:12 - progress_bar.py[line:274] - INFO: epoch 021:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.165, ntokens=17194.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.97, wps=3119.6, ups=0.18, wpb=17194.9, bsz=1024, num_updates=7950, lr=4.23763e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=51386
2024-11-07 18:07:07 - progress_bar.py[line:274] - INFO: epoch 021:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17058.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3130.4, ups=0.18, wpb=17058.6, bsz=1024, num_updates=7960, lr=4.23627e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=51440
2024-11-07 18:08:02 - progress_bar.py[line:274] - INFO: epoch 021:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17334.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3155, ups=0.18, wpb=17334.8, bsz=1024, num_updates=7970, lr=4.23491e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=51495
2024-11-07 18:08:55 - progress_bar.py[line:274] - INFO: epoch 021:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17160.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3208.3, ups=0.19, wpb=17160.6, bsz=1024, num_updates=7980, lr=4.23355e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=51549
2024-11-07 18:09:48 - progress_bar.py[line:274] - INFO: epoch 021:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=17531, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3304, ups=0.19, wpb=17531, bsz=1024, num_updates=7990, lr=4.23219e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=51602
2024-11-07 18:10:41 - progress_bar.py[line:274] - INFO: epoch 021:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.168, ntokens=17155.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=3237, ups=0.19, wpb=17155.9, bsz=1024, num_updates=8000, lr=4.23083e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=35, gb_free=13.4, wall=51655
2024-11-07 18:11:36 - progress_bar.py[line:274] - INFO: epoch 021:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17206.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3149.8, ups=0.18, wpb=17206.4, bsz=1024, num_updates=8010, lr=4.22947e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=51709
2024-11-07 18:12:30 - progress_bar.py[line:274] - INFO: epoch 021:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17145.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3173.5, ups=0.19, wpb=17145.1, bsz=1024, num_updates=8020, lr=4.22811e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=51763
2024-11-07 18:13:24 - progress_bar.py[line:274] - INFO: epoch 021:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=16969.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3149.9, ups=0.19, wpb=16969.3, bsz=1024, num_updates=8030, lr=4.22675e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=51817
2024-11-07 18:14:18 - progress_bar.py[line:274] - INFO: epoch 021:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.153, ntokens=17463.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.9, wps=3224.3, ups=0.18, wpb=17463.5, bsz=1024, num_updates=8040, lr=4.22539e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=51871
2024-11-07 18:15:13 - progress_bar.py[line:274] - INFO: epoch 021:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17252.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3146.4, ups=0.18, wpb=17252.4, bsz=1024, num_updates=8050, lr=4.22403e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=51926
2024-11-07 18:16:08 - progress_bar.py[line:274] - INFO: epoch 021:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17643.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3189.6, ups=0.18, wpb=17643.4, bsz=1024, num_updates=8060, lr=4.22267e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=51982
2024-11-07 18:17:03 - progress_bar.py[line:274] - INFO: epoch 021:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.114, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3150.6, ups=0.18, wpb=17435.9, bsz=1024, num_updates=8070, lr=4.22131e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=52037
2024-11-07 18:17:59 - progress_bar.py[line:274] - INFO: epoch 021:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.198, ntokens=17481, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3136.6, ups=0.18, wpb=17481, bsz=1024, num_updates=8080, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=52093
2024-11-07 18:18:56 - progress_bar.py[line:274] - INFO: epoch 021:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.181, ntokens=17392.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3054.1, ups=0.18, wpb=17392.8, bsz=1024, num_updates=8090, lr=4.21859e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=52150
2024-11-07 18:19:50 - progress_bar.py[line:274] - INFO: epoch 021:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17232.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3188.4, ups=0.19, wpb=17232.5, bsz=1024, num_updates=8100, lr=4.21723e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=52204
2024-11-07 18:20:45 - progress_bar.py[line:274] - INFO: epoch 021:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17347.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3184.5, ups=0.18, wpb=17347.5, bsz=1024, num_updates=8110, lr=4.21587e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=52258
2024-11-07 18:21:39 - progress_bar.py[line:274] - INFO: epoch 021:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.167, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3203.6, ups=0.19, wpb=17274.5, bsz=1024, num_updates=8120, lr=4.21451e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.6, wall=52312
2024-11-07 18:22:34 - progress_bar.py[line:274] - INFO: epoch 021:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17256.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3113.3, ups=0.18, wpb=17256.1, bsz=1024, num_updates=8130, lr=4.21315e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=52367
2024-11-07 18:23:26 - progress_bar.py[line:274] - INFO: epoch 021:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.125, ntokens=17214.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3339.5, ups=0.19, wpb=17214.9, bsz=1024, num_updates=8140, lr=4.21179e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=51, gb_free=13.2, wall=52419
2024-11-07 18:24:20 - progress_bar.py[line:274] - INFO: epoch 021:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17233.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=3145, ups=0.18, wpb=17233.6, bsz=1024, num_updates=8150, lr=4.21043e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=35, gb_free=13.6, wall=52474
2024-11-07 18:25:16 - progress_bar.py[line:274] - INFO: epoch 021:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17162.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3057.6, ups=0.18, wpb=17162.9, bsz=1024, num_updates=8160, lr=4.20907e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=52530
2024-11-07 18:26:13 - progress_bar.py[line:274] - INFO: epoch 021:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.153, ntokens=17595.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3136, ups=0.18, wpb=17595.8, bsz=1024, num_updates=8170, lr=4.20771e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=52586
2024-11-07 18:27:09 - progress_bar.py[line:274] - INFO: epoch 021:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17737.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.4, wps=3132.1, ups=0.18, wpb=17737.2, bsz=1024, num_updates=8180, lr=4.20634e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=52643
2024-11-07 18:28:05 - progress_bar.py[line:274] - INFO: epoch 021:    376 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.318, ntokens=17815.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=3221.8, ups=0.18, wpb=17815.3, bsz=1024, num_updates=8190, lr=4.20498e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=52698
2024-11-07 18:28:58 - progress_bar.py[line:274] - INFO: epoch 021:    386 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=17572.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3261.6, ups=0.19, wpb=17572.8, bsz=1024, num_updates=8200, lr=4.20362e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=52752
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
2024-11-07 18:29:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 21 @ 8205 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
2024-11-07 18:29:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 18:31:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-07 18:33:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 21 @ 8205 updates, score 0) (writing took 225.2046563560143 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-07 18:34:01 - train.py[line:336] - INFO: end of epoch 21 (average epoch stats below)
2024-11-07 18:34:01 - progress_bar.py[line:282] - INFO: epoch 021 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.168 | ntokens 17333.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.99 | wps 2624.2 | ups 0.15 | wpb 17333.4 | bsz 1023 | num_updates 8205 | lr 4.20294e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1545 | gb_free 13.3 | wall 53055
2024-11-07 18:34:01 - trainer.py[line:639] - INFO: loading train data for epoch 22
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 18:36:44 - trainer.py[line:703] - INFO: begin training epoch 22
2024-11-07 18:36:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 18:37:13 - progress_bar.py[line:274] - INFO: epoch 022:      5 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.174, ntokens=16562.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=334.6, ups=0.02, wpb=16562.1, bsz=985.6, num_updates=8210, lr=4.20226e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=29, gb_free=13.2, wall=53247
2024-11-07 18:38:07 - progress_bar.py[line:274] - INFO: epoch 022:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.24, ntokens=17448.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3252.1, ups=0.19, wpb=17448.8, bsz=1024, num_updates=8220, lr=4.2009e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53301
2024-11-07 18:39:01 - progress_bar.py[line:274] - INFO: epoch 022:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17507.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3230.7, ups=0.18, wpb=17507.2, bsz=1024, num_updates=8230, lr=4.19954e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53355
2024-11-07 18:39:55 - progress_bar.py[line:274] - INFO: epoch 022:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.172, ntokens=17376.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.02, wps=3203.7, ups=0.18, wpb=17376.6, bsz=1024, num_updates=8240, lr=4.19818e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=53409
2024-11-07 18:40:50 - progress_bar.py[line:274] - INFO: epoch 022:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.145, ntokens=17318.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3173.5, ups=0.18, wpb=17318.4, bsz=1024, num_updates=8250, lr=4.19682e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=53464
2024-11-07 18:41:44 - progress_bar.py[line:274] - INFO: epoch 022:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17500.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3230.5, ups=0.18, wpb=17500.5, bsz=1024, num_updates=8260, lr=4.19546e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=53518
2024-11-07 18:42:41 - progress_bar.py[line:274] - INFO: epoch 022:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=16803.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=2974, ups=0.18, wpb=16803.6, bsz=1024, num_updates=8270, lr=4.1941e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=46, gb_free=13.3, wall=53574
2024-11-07 18:43:36 - progress_bar.py[line:274] - INFO: epoch 022:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17382.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3124.5, ups=0.18, wpb=17382.5, bsz=1024, num_updates=8280, lr=4.19274e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=53630
2024-11-07 18:44:33 - progress_bar.py[line:274] - INFO: epoch 022:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17559, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3106.7, ups=0.18, wpb=17559, bsz=1024, num_updates=8290, lr=4.19138e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=53686
2024-11-07 18:45:29 - progress_bar.py[line:274] - INFO: epoch 022:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.166, ntokens=17401.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3113.1, ups=0.18, wpb=17401.7, bsz=1024, num_updates=8300, lr=4.19002e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=53742
2024-11-07 18:46:25 - progress_bar.py[line:274] - INFO: epoch 022:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.19, ntokens=17412, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3116.7, ups=0.18, wpb=17412, bsz=1024, num_updates=8310, lr=4.18866e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=53798
2024-11-07 18:47:21 - progress_bar.py[line:274] - INFO: epoch 022:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17003.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3012.7, ups=0.18, wpb=17003.3, bsz=1024, num_updates=8320, lr=4.1873e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=53855
2024-11-07 18:48:17 - progress_bar.py[line:274] - INFO: epoch 022:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.17, ntokens=17520.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3115.6, ups=0.18, wpb=17520.4, bsz=1024, num_updates=8330, lr=4.18594e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=53911
2024-11-07 18:49:13 - progress_bar.py[line:274] - INFO: epoch 022:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17441.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3132.7, ups=0.18, wpb=17441.9, bsz=1024, num_updates=8340, lr=4.18458e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.6, wall=53967
2024-11-07 18:50:09 - progress_bar.py[line:274] - INFO: epoch 022:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17397.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3083.2, ups=0.18, wpb=17397.4, bsz=1024, num_updates=8350, lr=4.18322e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=54023
2024-11-07 18:51:04 - progress_bar.py[line:274] - INFO: epoch 022:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=17165.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3137.1, ups=0.18, wpb=17165.8, bsz=1024, num_updates=8360, lr=4.18186e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.6, wall=54078
2024-11-07 18:51:57 - progress_bar.py[line:274] - INFO: epoch 022:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.141, ntokens=17152.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3227, ups=0.19, wpb=17152.2, bsz=1024, num_updates=8370, lr=4.1805e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=54131
2024-11-07 18:52:51 - progress_bar.py[line:274] - INFO: epoch 022:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=17493.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3253.9, ups=0.19, wpb=17493.9, bsz=1024, num_updates=8380, lr=4.17914e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.6, wall=54185
2024-11-07 18:53:45 - progress_bar.py[line:274] - INFO: epoch 022:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17249, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3207.8, ups=0.19, wpb=17249, bsz=1024, num_updates=8390, lr=4.17778e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=47, gb_free=13.6, wall=54238
2024-11-07 18:54:37 - progress_bar.py[line:274] - INFO: epoch 022:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=16912.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3232.2, ups=0.19, wpb=16912.7, bsz=1024, num_updates=8400, lr=4.17642e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=44, gb_free=13.6, wall=54291
2024-11-07 18:54:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 18:55:37 - progress_bar.py[line:274] - INFO: epoch 022:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.149, ntokens=17352.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=2907.4, ups=0.17, wpb=17352.5, bsz=1024, num_updates=8410, lr=4.17506e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=54350
2024-11-07 18:56:34 - progress_bar.py[line:274] - INFO: epoch 022:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.103, ntokens=17023.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=2988.8, ups=0.18, wpb=17023.6, bsz=1024, num_updates=8420, lr=4.1737e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=54407
2024-11-07 18:57:30 - progress_bar.py[line:274] - INFO: epoch 022:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=17368.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3096.9, ups=0.18, wpb=17368.1, bsz=1024, num_updates=8430, lr=4.17233e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=54463
2024-11-07 18:58:25 - progress_bar.py[line:274] - INFO: epoch 022:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.151, ntokens=17258.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3106.2, ups=0.18, wpb=17258.1, bsz=1024, num_updates=8440, lr=4.17097e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=54519
2024-11-07 18:59:21 - progress_bar.py[line:274] - INFO: epoch 022:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17453.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3168.9, ups=0.18, wpb=17453.5, bsz=1024, num_updates=8450, lr=4.16961e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=54574
2024-11-07 19:00:18 - progress_bar.py[line:274] - INFO: epoch 022:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17395.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3053.7, ups=0.18, wpb=17395.3, bsz=1024, num_updates=8460, lr=4.16825e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=54631
2024-11-07 19:01:14 - progress_bar.py[line:274] - INFO: epoch 022:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=17422.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3082.6, ups=0.18, wpb=17422.2, bsz=1024, num_updates=8470, lr=4.16689e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=54688
2024-11-07 19:02:09 - progress_bar.py[line:274] - INFO: epoch 022:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17367.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3188.2, ups=0.18, wpb=17367.9, bsz=1024, num_updates=8480, lr=4.16553e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=54742
2024-11-07 19:03:05 - progress_bar.py[line:274] - INFO: epoch 022:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17247.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3029.8, ups=0.18, wpb=17247.1, bsz=1024, num_updates=8490, lr=4.16417e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=54799
2024-11-07 19:04:03 - progress_bar.py[line:274] - INFO: epoch 022:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.151, ntokens=17380.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3029.5, ups=0.17, wpb=17380.6, bsz=1024, num_updates=8500, lr=4.16281e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.6, wall=54856
2024-11-07 19:04:20 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 19:05:06 - progress_bar.py[line:274] - INFO: epoch 022:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17227.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=2728, ups=0.16, wpb=17227.4, bsz=1024, num_updates=8510, lr=4.16145e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=63, gb_free=13.4, wall=54919
2024-11-07 19:06:04 - progress_bar.py[line:274] - INFO: epoch 022:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17472.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3028.6, ups=0.17, wpb=17472.5, bsz=1024, num_updates=8520, lr=4.16009e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=54977
2024-11-07 19:07:01 - progress_bar.py[line:274] - INFO: epoch 022:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17224.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3017.8, ups=0.18, wpb=17224.5, bsz=1024, num_updates=8530, lr=4.15873e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.5, wall=55034
2024-11-07 19:07:57 - progress_bar.py[line:274] - INFO: epoch 022:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17320.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3081.2, ups=0.18, wpb=17320.7, bsz=1024, num_updates=8540, lr=4.15737e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=55090
2024-11-07 19:08:52 - progress_bar.py[line:274] - INFO: epoch 022:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.131, ntokens=17313, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=3146.2, ups=0.18, wpb=17313, bsz=1024, num_updates=8550, lr=4.15601e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=55145
2024-11-07 19:09:48 - progress_bar.py[line:274] - INFO: epoch 022:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17520.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3139.5, ups=0.18, wpb=17520.6, bsz=1024, num_updates=8560, lr=4.15465e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=55201
2024-11-07 19:10:45 - progress_bar.py[line:274] - INFO: epoch 022:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.166, ntokens=17568.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3073.8, ups=0.17, wpb=17568.6, bsz=1024, num_updates=8570, lr=4.15329e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=55258
2024-11-07 19:11:42 - progress_bar.py[line:274] - INFO: epoch 022:    377 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.305, ntokens=17711.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.88, wps=3101.6, ups=0.18, wpb=17711.9, bsz=1024, num_updates=8580, lr=4.15193e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=57, gb_free=13.6, wall=55316
2024-11-07 19:12:36 - progress_bar.py[line:274] - INFO: epoch 022:    387 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.292, ntokens=17514.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.8, wps=3234.2, ups=0.18, wpb=17514.3, bsz=1024, num_updates=8590, lr=4.15057e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=55370
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt

2024-11-07 19:12:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 22 @ 8594 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
2024-11-07 19:12:54 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 19:14:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-07 19:16:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 22 @ 8594 updates, score 0) (writing took 223.49734773300588 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-07 19:17:32 - train.py[line:336] - INFO: end of epoch 22 (average epoch stats below)
2024-11-07 19:17:32 - progress_bar.py[line:282] - INFO: epoch 022 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.151 | ntokens 17329.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.88 | wps 2581.7 | ups 0.15 | wpb 17329.5 | bsz 1023 | num_updates 8594 | lr 4.15002e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1979 | gb_free 13.2 | wall 55666
2024-11-07 19:17:32 - trainer.py[line:639] - INFO: loading train data for epoch 23
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 19:20:14 - trainer.py[line:703] - INFO: begin training epoch 23
2024-11-07 19:20:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 19:20:49 - progress_bar.py[line:274] - INFO: epoch 023:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=16833.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=341.5, ups=0.02, wpb=16833.8, bsz=985.6, num_updates=8600, lr=4.14921e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=36, gb_free=13.5, wall=55863
2024-11-07 19:21:43 - progress_bar.py[line:274] - INFO: epoch 023:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17245.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3194.8, ups=0.19, wpb=17245.2, bsz=1024, num_updates=8610, lr=4.14785e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=55917
2024-11-07 19:22:37 - progress_bar.py[line:274] - INFO: epoch 023:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.141, ntokens=17261.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3205.2, ups=0.19, wpb=17261.2, bsz=1024, num_updates=8620, lr=4.14649e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=55970
2024-11-07 19:23:31 - progress_bar.py[line:274] - INFO: epoch 023:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17370.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3221.3, ups=0.19, wpb=17370.4, bsz=1024, num_updates=8630, lr=4.14513e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=56024
2024-11-07 19:24:25 - progress_bar.py[line:274] - INFO: epoch 023:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.142, ntokens=17685.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3282.3, ups=0.19, wpb=17685.5, bsz=1024, num_updates=8640, lr=4.14377e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=56078
2024-11-07 19:25:19 - progress_bar.py[line:274] - INFO: epoch 023:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.177, ntokens=17564.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3230, ups=0.18, wpb=17564.6, bsz=1024, num_updates=8650, lr=4.14241e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=56133
2024-11-07 19:26:13 - progress_bar.py[line:274] - INFO: epoch 023:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=16734.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3104.6, ups=0.19, wpb=16734.8, bsz=1024, num_updates=8660, lr=4.14105e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=56187
2024-11-07 19:27:07 - progress_bar.py[line:274] - INFO: epoch 023:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17228, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3208.8, ups=0.19, wpb=17228, bsz=1024, num_updates=8670, lr=4.13969e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=56240
2024-11-07 19:28:01 - progress_bar.py[line:274] - INFO: epoch 023:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.134, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3245.4, ups=0.19, wpb=17540.6, bsz=1024, num_updates=8680, lr=4.13833e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=56294
2024-11-07 19:28:55 - progress_bar.py[line:274] - INFO: epoch 023:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17194.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3147.2, ups=0.18, wpb=17194.7, bsz=1024, num_updates=8690, lr=4.13696e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=56349
2024-11-07 19:29:50 - progress_bar.py[line:274] - INFO: epoch 023:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.164, ntokens=17540.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.97, wps=3234.9, ups=0.18, wpb=17540.9, bsz=1024, num_updates=8700, lr=4.1356e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=56403
2024-11-07 19:30:44 - progress_bar.py[line:274] - INFO: epoch 023:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17181.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3145.6, ups=0.18, wpb=17181.1, bsz=1024, num_updates=8710, lr=4.13424e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=56458
2024-11-07 19:31:39 - progress_bar.py[line:274] - INFO: epoch 023:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17409.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3185.6, ups=0.18, wpb=17409.9, bsz=1024, num_updates=8720, lr=4.13288e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=56512
2024-11-07 19:32:35 - progress_bar.py[line:274] - INFO: epoch 023:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.146, ntokens=17511.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3132.8, ups=0.18, wpb=17511.6, bsz=1024, num_updates=8730, lr=4.13152e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=56568
2024-11-07 19:33:30 - progress_bar.py[line:274] - INFO: epoch 023:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17164.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3090.8, ups=0.18, wpb=17164.9, bsz=1024, num_updates=8740, lr=4.13016e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=56624
2024-11-07 19:34:26 - progress_bar.py[line:274] - INFO: epoch 023:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17393, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3117.7, ups=0.18, wpb=17393, bsz=1024, num_updates=8750, lr=4.1288e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=56680
2024-11-07 19:35:22 - progress_bar.py[line:274] - INFO: epoch 023:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17166.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3076.1, ups=0.18, wpb=17166.2, bsz=1024, num_updates=8760, lr=4.12744e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=56735
2024-11-07 19:36:18 - progress_bar.py[line:274] - INFO: epoch 023:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.129, ntokens=17542.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3142.1, ups=0.18, wpb=17542.4, bsz=1024, num_updates=8770, lr=4.12608e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=56791
2024-11-07 19:37:13 - progress_bar.py[line:274] - INFO: epoch 023:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17261.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3129.5, ups=0.18, wpb=17261.3, bsz=1024, num_updates=8780, lr=4.12472e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=56846
2024-11-07 19:38:09 - progress_bar.py[line:274] - INFO: epoch 023:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17168.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3072.2, ups=0.18, wpb=17168.8, bsz=1024, num_updates=8790, lr=4.12336e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=56902
2024-11-07 19:39:05 - progress_bar.py[line:274] - INFO: epoch 023:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=17116.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3055.2, ups=0.18, wpb=17116.6, bsz=1024, num_updates=8800, lr=4.122e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=56958
2024-11-07 19:40:00 - progress_bar.py[line:274] - INFO: epoch 023:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.09, ntokens=17005.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=3105, ups=0.18, wpb=17005.3, bsz=1024, num_updates=8810, lr=4.12064e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=57013
2024-11-07 19:40:53 - progress_bar.py[line:274] - INFO: epoch 023:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17124.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3194.8, ups=0.19, wpb=17124.8, bsz=1024, num_updates=8820, lr=4.11928e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=57067
2024-11-07 19:41:47 - progress_bar.py[line:274] - INFO: epoch 023:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17440.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3235.2, ups=0.19, wpb=17440.4, bsz=1024, num_updates=8830, lr=4.11792e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=57121
2024-11-07 19:42:42 - progress_bar.py[line:274] - INFO: epoch 023:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17424.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3199.6, ups=0.18, wpb=17424.9, bsz=1024, num_updates=8840, lr=4.11656e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=57175
2024-11-07 19:43:36 - progress_bar.py[line:274] - INFO: epoch 023:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.1, ntokens=17553.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3225.5, ups=0.18, wpb=17553.1, bsz=1024, num_updates=8850, lr=4.1152e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=57230
2024-11-07 19:44:31 - progress_bar.py[line:274] - INFO: epoch 023:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17382.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3171.7, ups=0.18, wpb=17382.2, bsz=1024, num_updates=8860, lr=4.11384e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=57284
2024-11-07 19:45:25 - progress_bar.py[line:274] - INFO: epoch 023:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.131, ntokens=17308.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=3207.4, ups=0.19, wpb=17308.5, bsz=1024, num_updates=8870, lr=4.11248e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=57338
2024-11-07 19:46:19 - progress_bar.py[line:274] - INFO: epoch 023:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17167.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3196.9, ups=0.19, wpb=17167.8, bsz=1024, num_updates=8880, lr=4.11112e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=57392
2024-11-07 19:47:15 - progress_bar.py[line:274] - INFO: epoch 023:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17254.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3071.9, ups=0.18, wpb=17254.3, bsz=1024, num_updates=8890, lr=4.10976e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=57448
2024-11-07 19:48:09 - progress_bar.py[line:274] - INFO: epoch 023:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17350.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3201.3, ups=0.18, wpb=17350.6, bsz=1024, num_updates=8900, lr=4.1084e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=57502
2024-11-07 19:49:03 - progress_bar.py[line:274] - INFO: epoch 023:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17328.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3178.6, ups=0.18, wpb=17328.5, bsz=1024, num_updates=8910, lr=4.10704e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=57557
2024-11-07 19:49:59 - progress_bar.py[line:274] - INFO: epoch 023:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17309.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3100.6, ups=0.18, wpb=17309.2, bsz=1024, num_updates=8920, lr=4.10568e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=46, gb_free=13.2, wall=57613
2024-11-07 19:50:56 - progress_bar.py[line:274] - INFO: epoch 023:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17298.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3061.4, ups=0.18, wpb=17298.1, bsz=1024, num_updates=8930, lr=4.10432e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=56, gb_free=13.6, wall=57669
2024-11-07 19:51:52 - progress_bar.py[line:274] - INFO: epoch 023:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17209.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3070.1, ups=0.18, wpb=17209.4, bsz=1024, num_updates=8940, lr=4.10295e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=56, gb_free=13.6, wall=57725
2024-11-07 19:52:47 - progress_bar.py[line:274] - INFO: epoch 023:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.085, ntokens=17700.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3222, ups=0.18, wpb=17700.6, bsz=1024, num_updates=8950, lr=4.10159e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=57780
2024-11-07 19:53:43 - progress_bar.py[line:274] - INFO: epoch 023:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.195, ntokens=17735.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3180.4, ups=0.18, wpb=17735.4, bsz=1024, num_updates=8960, lr=4.10023e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=57836
2024-11-07 19:54:38 - progress_bar.py[line:274] - INFO: epoch 023:    376 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17718.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3215, ups=0.18, wpb=17718.2, bsz=1024, num_updates=8970, lr=4.09887e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=57891
2024-11-07 19:55:34 - progress_bar.py[line:274] - INFO: epoch 023:    386 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.286, ntokens=17476.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.75, wps=3097.7, ups=0.18, wpb=17476.7, bsz=1024, num_updates=8980, lr=4.09751e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=57948
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 19:55:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 23 @ 8985 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-07 19:55:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 19:57:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-07 19:59:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 23 @ 8985 updates, score 0) (writing took 224.82426005401067 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
2024-11-07 20:00:39 - train.py[line:336] - INFO: end of epoch 23 (average epoch stats below)
2024-11-07 20:00:39 - progress_bar.py[line:282] - INFO: epoch 023 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.128 | ntokens 17329.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.74 | wps 2619.8 | ups 0.15 | wpb 17329.8 | bsz 1023 | num_updates 8985 | lr 4.09683e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1370 | gb_free 13.2 | wall 58252
2024-11-07 20:00:39 - trainer.py[line:639] - INFO: loading train data for epoch 24
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 20:03:19 - trainer.py[line:703] - INFO: begin training epoch 24
2024-11-07 20:03:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 20:03:49 - progress_bar.py[line:274] - INFO: epoch 024:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.134, ntokens=16707.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=337.6, ups=0.02, wpb=16707.8, bsz=985.6, num_updates=8990, lr=4.09615e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=40, gb_free=13.6, wall=58442
2024-11-07 20:04:43 - progress_bar.py[line:274] - INFO: epoch 024:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.174, ntokens=17482.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=3231.6, ups=0.18, wpb=17482.2, bsz=1024, num_updates=9000, lr=4.09479e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=58497
2024-11-07 20:05:38 - progress_bar.py[line:274] - INFO: epoch 024:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.151, ntokens=17584.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3194.1, ups=0.18, wpb=17584.4, bsz=1024, num_updates=9010, lr=4.09343e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=58552
2024-11-07 20:06:32 - progress_bar.py[line:274] - INFO: epoch 024:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17366.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3227.3, ups=0.19, wpb=17366.7, bsz=1024, num_updates=9020, lr=4.09207e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=58605
2024-11-07 20:07:26 - progress_bar.py[line:274] - INFO: epoch 024:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.149, ntokens=17621.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3285.3, ups=0.19, wpb=17621.1, bsz=1024, num_updates=9030, lr=4.09071e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=58659
2024-11-07 20:08:20 - progress_bar.py[line:274] - INFO: epoch 024:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.121, ntokens=17358.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3186.7, ups=0.18, wpb=17358.6, bsz=1024, num_updates=9040, lr=4.08935e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=58714
2024-11-07 20:09:15 - progress_bar.py[line:274] - INFO: epoch 024:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17144.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3120.4, ups=0.18, wpb=17144.8, bsz=1024, num_updates=9050, lr=4.08799e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=58768
2024-11-07 20:10:11 - progress_bar.py[line:274] - INFO: epoch 024:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17405.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3087.2, ups=0.18, wpb=17405.8, bsz=1024, num_updates=9060, lr=4.08663e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=58825
2024-11-07 20:11:06 - progress_bar.py[line:274] - INFO: epoch 024:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=17679.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3229, ups=0.18, wpb=17679.1, bsz=1024, num_updates=9070, lr=4.08527e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=58880
2024-11-07 20:12:00 - progress_bar.py[line:274] - INFO: epoch 024:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17230, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3183.9, ups=0.18, wpb=17230, bsz=1024, num_updates=9080, lr=4.08391e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=58934
2024-11-07 20:12:55 - progress_bar.py[line:274] - INFO: epoch 024:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17508.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3213.9, ups=0.18, wpb=17508.9, bsz=1024, num_updates=9090, lr=4.08255e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=58988
2024-11-07 20:13:49 - progress_bar.py[line:274] - INFO: epoch 024:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17145.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3161.5, ups=0.18, wpb=17145.1, bsz=1024, num_updates=9100, lr=4.08119e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=59042
2024-11-07 20:14:43 - progress_bar.py[line:274] - INFO: epoch 024:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17451.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3248.9, ups=0.19, wpb=17451.6, bsz=1024, num_updates=9110, lr=4.07983e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=59096
2024-11-07 20:15:37 - progress_bar.py[line:274] - INFO: epoch 024:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.115, ntokens=17361.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3166.5, ups=0.18, wpb=17361.6, bsz=1024, num_updates=9120, lr=4.07847e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=59151
2024-11-07 20:16:32 - progress_bar.py[line:274] - INFO: epoch 024:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17121.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3116.3, ups=0.18, wpb=17121.6, bsz=1024, num_updates=9130, lr=4.07711e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=59206
2024-11-07 20:17:27 - progress_bar.py[line:274] - INFO: epoch 024:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17168.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3146.7, ups=0.18, wpb=17168.7, bsz=1024, num_updates=9140, lr=4.07575e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=59260
2024-11-07 20:18:21 - progress_bar.py[line:274] - INFO: epoch 024:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.1, ntokens=17215, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3197.3, ups=0.19, wpb=17215, bsz=1024, num_updates=9150, lr=4.07439e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=59314
2024-11-07 20:19:16 - progress_bar.py[line:274] - INFO: epoch 024:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17396.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3162.7, ups=0.18, wpb=17396.3, bsz=1024, num_updates=9160, lr=4.07303e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=59369
2024-11-07 20:20:10 - progress_bar.py[line:274] - INFO: epoch 024:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17280.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3171.2, ups=0.18, wpb=17280.3, bsz=1024, num_updates=9170, lr=4.07167e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=59424
2024-11-07 20:21:04 - progress_bar.py[line:274] - INFO: epoch 024:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17070.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3168.8, ups=0.19, wpb=17070.5, bsz=1024, num_updates=9180, lr=4.07031e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=59478
2024-11-07 20:21:59 - progress_bar.py[line:274] - INFO: epoch 024:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.131, ntokens=17303, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=3172.2, ups=0.18, wpb=17303, bsz=1024, num_updates=9190, lr=4.06894e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=59532
2024-11-07 20:22:53 - progress_bar.py[line:274] - INFO: epoch 024:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=16947.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3118.1, ups=0.18, wpb=16947.1, bsz=1024, num_updates=9200, lr=4.06758e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=59587
2024-11-07 20:23:50 - progress_bar.py[line:274] - INFO: epoch 024:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17526.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3098.6, ups=0.18, wpb=17526.1, bsz=1024, num_updates=9210, lr=4.06622e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=59643
2024-11-07 20:24:46 - progress_bar.py[line:274] - INFO: epoch 024:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3067.5, ups=0.18, wpb=17323.2, bsz=1024, num_updates=9220, lr=4.06486e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=59700
2024-11-07 20:25:41 - progress_bar.py[line:274] - INFO: epoch 024:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17397, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3159.4, ups=0.18, wpb=17397, bsz=1024, num_updates=9230, lr=4.0635e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=59755
2024-11-07 20:26:37 - progress_bar.py[line:274] - INFO: epoch 024:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.09, ntokens=17630.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3167.9, ups=0.18, wpb=17630.6, bsz=1024, num_updates=9240, lr=4.06214e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=59810
2024-11-07 20:27:34 - progress_bar.py[line:274] - INFO: epoch 024:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17247.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3030.8, ups=0.18, wpb=17247.8, bsz=1024, num_updates=9250, lr=4.06078e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=59867
2024-11-07 20:28:32 - progress_bar.py[line:274] - INFO: epoch 024:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17146, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=2964, ups=0.17, wpb=17146, bsz=1024, num_updates=9260, lr=4.05942e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=59925
2024-11-07 20:29:29 - progress_bar.py[line:274] - INFO: epoch 024:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17363.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3028.7, ups=0.17, wpb=17363.8, bsz=1024, num_updates=9270, lr=4.05806e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=59982
2024-11-07 20:30:27 - progress_bar.py[line:274] - INFO: epoch 024:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17421.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=2991.7, ups=0.17, wpb=17421.4, bsz=1024, num_updates=9280, lr=4.0567e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=58, gb_free=13.6, wall=60041
2024-11-07 20:31:23 - progress_bar.py[line:274] - INFO: epoch 024:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.115, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3113.4, ups=0.18, wpb=17372.7, bsz=1024, num_updates=9290, lr=4.05534e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=60096
2024-11-07 20:32:17 - progress_bar.py[line:274] - INFO: epoch 024:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17237.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3165.6, ups=0.18, wpb=17237.5, bsz=1024, num_updates=9300, lr=4.05398e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=60151
2024-11-07 20:33:13 - progress_bar.py[line:274] - INFO: epoch 024:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17388.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=3150.4, ups=0.18, wpb=17388.5, bsz=1024, num_updates=9310, lr=4.05262e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=60206
2024-11-07 20:34:11 - progress_bar.py[line:274] - INFO: epoch 024:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17446.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=2997.1, ups=0.17, wpb=17446.9, bsz=1024, num_updates=9320, lr=4.05126e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=58, gb_free=13.6, wall=60264
2024-11-07 20:35:09 - progress_bar.py[line:274] - INFO: epoch 024:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17318.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=2973.8, ups=0.17, wpb=17318.8, bsz=1024, num_updates=9330, lr=4.0499e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=60323
2024-11-07 20:36:07 - progress_bar.py[line:274] - INFO: epoch 024:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.134, ntokens=17818.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3054.3, ups=0.17, wpb=17818.1, bsz=1024, num_updates=9340, lr=4.04854e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=60381
2024-11-07 20:37:06 - progress_bar.py[line:274] - INFO: epoch 024:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=17614.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3028.7, ups=0.17, wpb=17614.1, bsz=1024, num_updates=9350, lr=4.04718e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=58, gb_free=13, wall=60439
2024-11-07 20:38:02 - progress_bar.py[line:274] - INFO: epoch 024:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.214, ntokens=17598.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3132.6, ups=0.18, wpb=17598.4, bsz=1024, num_updates=9360, lr=4.04582e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=60495
2024-11-07 20:38:57 - progress_bar.py[line:274] - INFO: epoch 024:    385 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.273, ntokens=17525.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3158.4, ups=0.18, wpb=17525.6, bsz=1024, num_updates=9370, lr=4.04446e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=60551
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-07 20:39:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 24 @ 9376 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-07 20:39:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 20:41:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
2024-11-07 20:43:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 24 @ 9376 updates, score 0) (writing took 226.0904258689843 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
2024-11-07 20:44:10 - train.py[line:336] - INFO: end of epoch 24 (average epoch stats below)
2024-11-07 20:44:10 - progress_bar.py[line:282] - INFO: epoch 024 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.112 | ntokens 17356 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.65 | wps 2598.5 | ups 0.15 | wpb 17356 | bsz 1023 | num_updates 9376 | lr 4.04364e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1632 | gb_free 13.2 | wall 60864
2024-11-07 20:44:10 - trainer.py[line:639] - INFO: loading train data for epoch 25
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 20:46:51 - trainer.py[line:703] - INFO: begin training epoch 25
2024-11-07 20:46:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 20:47:17 - progress_bar.py[line:274] - INFO: epoch 025:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=16678.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=333.6, ups=0.02, wpb=16678.5, bsz=985.6, num_updates=9380, lr=4.0431e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=42, gb_free=13.6, wall=61051
2024-11-07 20:48:15 - progress_bar.py[line:274] - INFO: epoch 025:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17315.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=2992.5, ups=0.17, wpb=17315.2, bsz=1024, num_updates=9390, lr=4.04174e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=12.7, wall=61109
2024-11-07 20:49:14 - progress_bar.py[line:274] - INFO: epoch 025:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17598, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3005.7, ups=0.17, wpb=17598, bsz=1024, num_updates=9400, lr=4.04038e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61167
2024-11-07 20:50:13 - progress_bar.py[line:274] - INFO: epoch 025:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.086, ntokens=17277.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=2921.1, ups=0.17, wpb=17277.2, bsz=1024, num_updates=9410, lr=4.03902e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61226
2024-11-07 20:51:11 - progress_bar.py[line:274] - INFO: epoch 025:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17392.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=2963.6, ups=0.17, wpb=17392.5, bsz=1024, num_updates=9420, lr=4.03766e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61285
2024-11-07 20:52:11 - progress_bar.py[line:274] - INFO: epoch 025:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17641.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=2983.6, ups=0.17, wpb=17641.1, bsz=1024, num_updates=9430, lr=4.0363e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=61344
2024-11-07 20:53:10 - progress_bar.py[line:274] - INFO: epoch 025:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=17158.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=2897.7, ups=0.17, wpb=17158.1, bsz=1024, num_updates=9440, lr=4.03493e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=61403
2024-11-07 20:54:09 - progress_bar.py[line:274] - INFO: epoch 025:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17207, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=2918, ups=0.17, wpb=17207, bsz=1024, num_updates=9450, lr=4.03357e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61462
2024-11-07 20:55:08 - progress_bar.py[line:274] - INFO: epoch 025:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17470.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=2952.3, ups=0.17, wpb=17470.4, bsz=1024, num_updates=9460, lr=4.03221e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=61521
2024-11-07 20:56:06 - progress_bar.py[line:274] - INFO: epoch 025:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17110.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2933.3, ups=0.17, wpb=17110.5, bsz=1024, num_updates=9470, lr=4.03085e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=61580
2024-11-07 20:57:05 - progress_bar.py[line:274] - INFO: epoch 025:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17557.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=2963.2, ups=0.17, wpb=17557.1, bsz=1024, num_updates=9480, lr=4.02949e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61639
2024-11-07 20:58:04 - progress_bar.py[line:274] - INFO: epoch 025:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17266.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=2935, ups=0.17, wpb=17266.1, bsz=1024, num_updates=9490, lr=4.02813e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61698
2024-11-07 20:59:03 - progress_bar.py[line:274] - INFO: epoch 025:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17326.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=2959, ups=0.17, wpb=17326.4, bsz=1024, num_updates=9500, lr=4.02677e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=61756
2024-11-07 21:00:02 - progress_bar.py[line:274] - INFO: epoch 025:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17393.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=2936.8, ups=0.17, wpb=17393.5, bsz=1024, num_updates=9510, lr=4.02541e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=61816
2024-11-07 21:01:01 - progress_bar.py[line:274] - INFO: epoch 025:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=16924.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=2878.1, ups=0.17, wpb=16924.6, bsz=1024, num_updates=9520, lr=4.02405e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=61874
2024-11-07 21:02:00 - progress_bar.py[line:274] - INFO: epoch 025:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17281.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=2931, ups=0.17, wpb=17281.1, bsz=1024, num_updates=9530, lr=4.02269e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=61933
2024-11-07 21:02:59 - progress_bar.py[line:274] - INFO: epoch 025:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=16990.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=2869.6, ups=0.17, wpb=16990.1, bsz=1024, num_updates=9540, lr=4.02133e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=61993
2024-11-07 21:03:58 - progress_bar.py[line:274] - INFO: epoch 025:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17443.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=2940.7, ups=0.17, wpb=17443.8, bsz=1024, num_updates=9550, lr=4.01997e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=62052
2024-11-07 21:04:57 - progress_bar.py[line:274] - INFO: epoch 025:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17475.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=2956.7, ups=0.17, wpb=17475.6, bsz=1024, num_updates=9560, lr=4.01861e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=62111
2024-11-07 21:05:57 - progress_bar.py[line:274] - INFO: epoch 025:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17337.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=2909.2, ups=0.17, wpb=17337.5, bsz=1024, num_updates=9570, lr=4.01725e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=62171
2024-11-07 21:06:56 - progress_bar.py[line:274] - INFO: epoch 025:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17153.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=2889.2, ups=0.17, wpb=17153.4, bsz=1024, num_updates=9580, lr=4.01589e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=62230
2024-11-07 21:07:54 - progress_bar.py[line:274] - INFO: epoch 025:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=17033.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=2961.6, ups=0.17, wpb=17033.3, bsz=1024, num_updates=9590, lr=4.01453e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=62287
2024-11-07 21:08:53 - progress_bar.py[line:274] - INFO: epoch 025:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17223.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=2920.5, ups=0.17, wpb=17223.7, bsz=1024, num_updates=9600, lr=4.01317e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62346
2024-11-07 21:09:52 - progress_bar.py[line:274] - INFO: epoch 025:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.085, ntokens=17270.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=2909.8, ups=0.17, wpb=17270.9, bsz=1024, num_updates=9610, lr=4.01181e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62406
2024-11-07 21:10:52 - progress_bar.py[line:274] - INFO: epoch 025:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17337.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2890.5, ups=0.17, wpb=17337.2, bsz=1024, num_updates=9620, lr=4.01045e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=62466
2024-11-07 21:11:52 - progress_bar.py[line:274] - INFO: epoch 025:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17533.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2930.2, ups=0.17, wpb=17533.7, bsz=1024, num_updates=9630, lr=4.00909e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=62526
2024-11-07 21:12:52 - progress_bar.py[line:274] - INFO: epoch 025:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17132.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=2860.7, ups=0.17, wpb=17132.9, bsz=1024, num_updates=9640, lr=4.00773e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=62585
2024-11-07 21:13:50 - progress_bar.py[line:274] - INFO: epoch 025:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17279.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=2967.2, ups=0.17, wpb=17279.8, bsz=1024, num_updates=9650, lr=4.00637e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=62644
2024-11-07 21:14:50 - progress_bar.py[line:274] - INFO: epoch 025:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17194.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=2854, ups=0.17, wpb=17194.1, bsz=1024, num_updates=9660, lr=4.00501e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62704
2024-11-07 21:15:50 - progress_bar.py[line:274] - INFO: epoch 025:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.062, ntokens=17312, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=2915.4, ups=0.17, wpb=17312, bsz=1024, num_updates=9670, lr=4.00365e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62763
2024-11-07 21:16:50 - progress_bar.py[line:274] - INFO: epoch 025:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17452.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=2888.2, ups=0.17, wpb=17452.4, bsz=1024, num_updates=9680, lr=4.00229e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62824
2024-11-07 21:17:50 - progress_bar.py[line:274] - INFO: epoch 025:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17048.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=2853.9, ups=0.17, wpb=17048.8, bsz=1024, num_updates=9690, lr=4.00093e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=62884
2024-11-07 21:18:50 - progress_bar.py[line:274] - INFO: epoch 025:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17387.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=2876, ups=0.17, wpb=17387.3, bsz=1024, num_updates=9700, lr=3.99956e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=62944
2024-11-07 21:19:50 - progress_bar.py[line:274] - INFO: epoch 025:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17279.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=2910.2, ups=0.17, wpb=17279.3, bsz=1024, num_updates=9710, lr=3.9982e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=63003
2024-11-07 21:20:50 - progress_bar.py[line:274] - INFO: epoch 025:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17349.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=2879.2, ups=0.17, wpb=17349.9, bsz=1024, num_updates=9720, lr=3.99684e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=63064
2024-11-07 21:21:51 - progress_bar.py[line:274] - INFO: epoch 025:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.09, ntokens=17525.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=2872.5, ups=0.16, wpb=17525.4, bsz=1024, num_updates=9730, lr=3.99548e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=63125
2024-11-07 21:22:51 - progress_bar.py[line:274] - INFO: epoch 025:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17339.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=2878, ups=0.17, wpb=17339.1, bsz=1024, num_updates=9740, lr=3.99412e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=63185
2024-11-07 21:23:51 - progress_bar.py[line:274] - INFO: epoch 025:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.188, ntokens=17623.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=2966.8, ups=0.17, wpb=17623.5, bsz=1024, num_updates=9750, lr=3.99276e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63244
2024-11-07 21:24:50 - progress_bar.py[line:274] - INFO: epoch 025:    384 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.274, ntokens=17716.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.68, wps=3015.2, ups=0.17, wpb=17716.7, bsz=1024, num_updates=9760, lr=3.9914e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63303
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt

2024-11-07 21:25:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 25 @ 9767 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt

2024-11-07 21:25:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 21:27:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 21:29:09 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 25 @ 9767 updates, score 0) (writing took 222.37437088199658 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-07 21:30:06 - train.py[line:336] - INFO: end of epoch 25 (average epoch stats below)
2024-11-07 21:30:06 - progress_bar.py[line:282] - INFO: epoch 025 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.088 | ntokens 17311.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.5 | wps 2455.9 | ups 0.14 | wpb 17311.4 | bsz 1023 | num_updates 9767 | lr 3.99045e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1204 | gb_free 13.3 | wall 63620
2024-11-07 21:30:07 - trainer.py[line:639] - INFO: loading train data for epoch 26
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 21:32:48 - trainer.py[line:703] - INFO: begin training epoch 26
2024-11-07 21:32:48 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 21:33:08 - progress_bar.py[line:274] - INFO: epoch 026:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.129, ntokens=16841.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=338, ups=0.02, wpb=16841.5, bsz=985.6, num_updates=9770, lr=3.99004e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=63801
2024-11-07 21:34:06 - progress_bar.py[line:274] - INFO: epoch 026:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=17473.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3025.5, ups=0.17, wpb=17473.5, bsz=1024, num_updates=9780, lr=3.98868e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=63859
2024-11-07 21:35:03 - progress_bar.py[line:274] - INFO: epoch 026:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17387.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3040.4, ups=0.17, wpb=17387.8, bsz=1024, num_updates=9790, lr=3.98732e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63916
2024-11-07 21:36:00 - progress_bar.py[line:274] - INFO: epoch 026:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17186.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=2984.7, ups=0.17, wpb=17186.6, bsz=1024, num_updates=9800, lr=3.98596e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63974
2024-11-07 21:36:58 - progress_bar.py[line:274] - INFO: epoch 026:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17490, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3038.9, ups=0.17, wpb=17490, bsz=1024, num_updates=9810, lr=3.9846e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=64031
2024-11-07 21:37:32 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-07 21:38:02 - progress_bar.py[line:274] - INFO: epoch 026:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17445.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=2725.8, ups=0.16, wpb=17445.3, bsz=1024, num_updates=9820, lr=3.98324e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=64095
2024-11-07 21:38:26 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 21:39:06 - progress_bar.py[line:274] - INFO: epoch 026:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=16975, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=2632.5, ups=0.16, wpb=16975, bsz=1024, num_updates=9830, lr=3.98188e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=34, gb_free=13.1, wall=64160
2024-11-07 21:40:04 - progress_bar.py[line:274] - INFO: epoch 026:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17365.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3009, ups=0.17, wpb=17365.8, bsz=1024, num_updates=9840, lr=3.98052e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=64218
2024-11-07 21:41:02 - progress_bar.py[line:274] - INFO: epoch 026:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17417.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=2981.1, ups=0.17, wpb=17417.9, bsz=1024, num_updates=9850, lr=3.97916e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=64276
2024-11-07 21:42:01 - progress_bar.py[line:274] - INFO: epoch 026:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17179.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=2952.5, ups=0.17, wpb=17179.8, bsz=1024, num_updates=9860, lr=3.9778e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=64334
2024-11-07 21:42:59 - progress_bar.py[line:274] - INFO: epoch 026:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17523.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3012.6, ups=0.17, wpb=17523.5, bsz=1024, num_updates=9870, lr=3.97644e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64392
2024-11-07 21:43:57 - progress_bar.py[line:274] - INFO: epoch 026:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.086, ntokens=17261.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=2957.1, ups=0.17, wpb=17261.7, bsz=1024, num_updates=9880, lr=3.97508e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64451
2024-11-07 21:44:56 - progress_bar.py[line:274] - INFO: epoch 026:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17264.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=2950.7, ups=0.17, wpb=17264.1, bsz=1024, num_updates=9890, lr=3.97372e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=64509
2024-11-07 21:45:54 - progress_bar.py[line:274] - INFO: epoch 026:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.091, ntokens=17542.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=3028.6, ups=0.17, wpb=17542.1, bsz=1024, num_updates=9900, lr=3.97236e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64567
2024-11-07 21:46:52 - progress_bar.py[line:274] - INFO: epoch 026:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=16971.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=2895.3, ups=0.17, wpb=16971.8, bsz=1024, num_updates=9910, lr=3.971e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=64626
2024-11-07 21:47:51 - progress_bar.py[line:274] - INFO: epoch 026:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17374.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=2961.6, ups=0.17, wpb=17374.2, bsz=1024, num_updates=9920, lr=3.96964e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64684
2024-11-07 21:48:49 - progress_bar.py[line:274] - INFO: epoch 026:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=16984.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=2909.3, ups=0.17, wpb=16984.1, bsz=1024, num_updates=9930, lr=3.96828e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=64743
2024-11-07 21:49:48 - progress_bar.py[line:274] - INFO: epoch 026:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17472.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=2976, ups=0.17, wpb=17472.5, bsz=1024, num_updates=9940, lr=3.96692e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64802
2024-11-07 21:50:47 - progress_bar.py[line:274] - INFO: epoch 026:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17279.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=2917.9, ups=0.17, wpb=17279.6, bsz=1024, num_updates=9950, lr=3.96555e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64861
2024-11-07 21:51:45 - progress_bar.py[line:274] - INFO: epoch 026:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17313.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=2981.2, ups=0.17, wpb=17313.2, bsz=1024, num_updates=9960, lr=3.96419e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=64919
2024-11-07 21:52:43 - progress_bar.py[line:274] - INFO: epoch 026:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.079, ntokens=17153.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=2953.7, ups=0.17, wpb=17153.2, bsz=1024, num_updates=9970, lr=3.96283e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=64977
2024-11-07 21:53:42 - progress_bar.py[line:274] - INFO: epoch 026:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=16890.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=2891.4, ups=0.17, wpb=16890.8, bsz=1024, num_updates=9980, lr=3.96147e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65035
2024-11-07 21:54:40 - progress_bar.py[line:274] - INFO: epoch 026:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17541.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2992.6, ups=0.17, wpb=17541.2, bsz=1024, num_updates=9990, lr=3.96011e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65094
2024-11-07 21:55:39 - progress_bar.py[line:274] - INFO: epoch 026:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.043, ntokens=17227.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=2961.1, ups=0.17, wpb=17227.1, bsz=1024, num_updates=10000, lr=3.95875e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=65152
loss_reg: 0.01749906065686027 loss_cls: 0.004841140005737543
loss_reg: 0.01894102687103614 loss_cls: 0.004227809142321348
loss_reg: 0.022176973113198255 loss_cls: 0.003874974325299263
loss_reg: 0.025917367597206996 loss_cls: 0.004456049297004938
loss_reg: 0.013767156826998622 loss_cls: 0.0039061999414116144
loss_reg: 0.01897857801559348 loss_cls: 0.003711666679009795
loss_reg: 0.02174711895258402 loss_cls: 0.004602134693413973
loss_reg: 0.017954002123682856 loss_cls: 0.004032318480312824loss_reg: 0.018878588245013886 loss_cls: 0.0045879799872636795

loss_reg: 0.02888732746578719 loss_cls: 0.004160130862146616
loss_reg: 0.012658343842555464 loss_cls: 0.003845910308882594
loss_reg: 0.021528265937592744 loss_cls: 0.0035496042110025883
loss_reg: 0.021506648045488595 loss_cls: 0.003473865333944559
loss_reg: 0.017726454530206007 loss_cls: 0.004511282313615084
loss_reg: 0.017367560645511145 loss_cls: 0.007308948785066605
loss_reg: 0.01683702790187236 loss_cls: 0.0046689617447555065
loss_reg: 0.01751918136130209 loss_cls: 0.003644124139100313
loss_reg: 0.01800753014258965 loss_cls: 0.003124884096905589
loss_reg: 0.024235997182556326 loss_cls: 0.003433155594393611
loss_reg: 0.023038295208813227 loss_cls: 0.0036533698439598083
loss_reg: 0.025340551427567012 loss_cls: 0.006338453385978937
loss_reg: 0.02098680992627735 loss_cls: 0.0034498313907533884
loss_reg: 0.021389624824179762 loss_cls: 0.002592492150142789
loss_reg: 0.01743028316841209 loss_cls: 0.003876836970448494
loss_reg: 0.02045863028748135 loss_cls: 0.004088620655238628
loss_reg: 0.01862258541335067 loss_cls: 0.004184443969279528
loss_reg: 0.027576199280035275 loss_cls: 0.0038755235727876425
loss_reg: 0.02472592868628842 loss_cls: 0.004233292769640684
loss_reg: 0.02546131140467457 loss_cls: 0.004950523842126131
loss_reg: 0.01611102366051781 loss_cls: 0.0035788300447165966
loss_reg: 0.016257264907770255 loss_cls: 0.0036343212705105543
loss_reg: 0.016975117016526556 loss_cls: 0.0031652403995394707
loss_reg: 0.01968542608262803 loss_cls: 0.0035396758466959
loss_reg: 0.015653349659912323 loss_cls: 0.004183175973594189
loss_reg: 0.02180253057199619 loss_cls: 0.0028868550434708595
loss_reg: 0.020891675762374634 loss_cls: 0.0036997401621192694
loss_reg: 0.021468900208053823 loss_cls: 0.0034329367335885763
loss_reg: 0.020899613209137875 loss_cls: 0.0031273667700588703
loss_reg: 0.023121338818116954 loss_cls: 0.0043272352777421474
loss_reg: 0.022647467741691754 loss_cls: 0.0040828995406627655
loss_reg: 0.026259925177109743 loss_cls: 0.0025507649406790733
loss_reg: 0.01879345701796569 loss_cls: 0.004481955897063017
loss_reg: 0.016477426546543744 loss_cls: 0.0030534989200532436
loss_reg: 0.01778336868618139 loss_cls: 0.003645383520051837
loss_reg: 0.02587653240248812 loss_cls: 0.0035647389013320208
loss_reg: 0.021650647127554747 loss_cls: 0.003006754908710718
loss_reg: 0.01718833606766214 loss_cls: 0.003973467741161585
loss_reg: 0.016890994347946588 loss_cls: 0.003924997989088297
loss_reg: 0.027722400516222746 loss_cls: 0.0036745653487741947
loss_reg: 0.013849591401239519 loss_cls: 0.003596728667616844
loss_reg: 0.026708852231143748 loss_cls: 0.003619410563260317
loss_reg: 0.01869879243554032 loss_cls: 0.0039535206742584705
loss_reg: 0.025527539114680777 loss_cls: 0.006205067969858646
loss_reg: 0.03680684140566162 loss_cls: 0.004722449462860823
loss_reg: 0.01655125159403871 loss_cls: 0.0032647133339196444
loss_reg: 0.015361315617008493 loss_cls: 0.004019754473119974
loss_reg: 0.0042640516282709505 loss_cls: 0.003442199435085058
loss_reg: 0.007910359346573494 loss_cls: 0.004098647274076939
loss_reg: 0.00156014666550472 loss_cls: 0.0030475021339952946
loss_reg: 0.0031805461028257776 loss_cls: 0.00341872894205153
loss_reg: 0.006984426604515949 loss_cls: 0.004500282928347588
loss_reg: 0.007399816091050114 loss_cls: 0.004481593146920204
loss_reg: 0.0016130964782286946 loss_cls: 0.003944945987313986
loss_reg: 0.0014485724758831436 loss_cls: 0.003093046136200428
2024-11-07 21:56:37 - progress_bar.py[line:274] - INFO: epoch 026:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17500.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3013.3, ups=0.17, wpb=17500.2, bsz=1024, num_updates=10010, lr=3.95739e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=65210
2024-11-07 21:57:35 - progress_bar.py[line:274] - INFO: epoch 026:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17674.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3015.6, ups=0.17, wpb=17674.3, bsz=1024, num_updates=10020, lr=3.95603e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=65269
2024-11-07 21:58:33 - progress_bar.py[line:274] - INFO: epoch 026:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17304.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=2989, ups=0.17, wpb=17304.9, bsz=1024, num_updates=10030, lr=3.95467e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=65327
2024-11-07 21:59:32 - progress_bar.py[line:274] - INFO: epoch 026:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17242.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=2937.8, ups=0.17, wpb=17242.5, bsz=1024, num_updates=10040, lr=3.95331e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65385
2024-11-07 22:00:30 - progress_bar.py[line:274] - INFO: epoch 026:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=17223.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=2971.3, ups=0.17, wpb=17223.1, bsz=1024, num_updates=10050, lr=3.95195e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65443
2024-11-07 22:01:28 - progress_bar.py[line:274] - INFO: epoch 026:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=17574.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.65, wps=3002, ups=0.17, wpb=17574.8, bsz=1024, num_updates=10060, lr=3.95059e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=65502
2024-11-07 22:02:27 - progress_bar.py[line:274] - INFO: epoch 026:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17321.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=2971.5, ups=0.17, wpb=17321.4, bsz=1024, num_updates=10070, lr=3.94923e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65560
2024-11-07 22:03:25 - progress_bar.py[line:274] - INFO: epoch 026:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17343.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=2964, ups=0.17, wpb=17343.2, bsz=1024, num_updates=10080, lr=3.94787e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=65619
2024-11-07 22:04:24 - progress_bar.py[line:274] - INFO: epoch 026:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17151.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=2923.4, ups=0.17, wpb=17151.2, bsz=1024, num_updates=10090, lr=3.94651e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=65677
2024-11-07 22:05:21 - progress_bar.py[line:274] - INFO: epoch 026:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.078, ntokens=17338.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3051.1, ups=0.18, wpb=17338.1, bsz=1024, num_updates=10100, lr=3.94515e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=65734
2024-11-07 22:06:18 - progress_bar.py[line:274] - INFO: epoch 026:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17231.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3002, ups=0.17, wpb=17231.8, bsz=1024, num_updates=10110, lr=3.94379e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=65792
2024-11-07 22:07:17 - progress_bar.py[line:274] - INFO: epoch 026:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17727.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3011.9, ups=0.17, wpb=17727.1, bsz=1024, num_updates=10120, lr=3.94243e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=65850
2024-11-07 22:08:16 - progress_bar.py[line:274] - INFO: epoch 026:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.098, ntokens=17647.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3012.1, ups=0.17, wpb=17647.4, bsz=1024, num_updates=10130, lr=3.94107e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=12.8, wall=65909
2024-11-07 22:09:13 - progress_bar.py[line:274] - INFO: epoch 026:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17439.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3010.8, ups=0.17, wpb=17439.7, bsz=1024, num_updates=10140, lr=3.93971e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=65967
2024-11-07 22:10:11 - progress_bar.py[line:274] - INFO: epoch 026:    385 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.208, ntokens=17504.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3050.9, ups=0.17, wpb=17504.1, bsz=1024, num_updates=10150, lr=3.93835e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=66024
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-07 22:10:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 26 @ 10156 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-07 22:10:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 22:12:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-07 22:14:26 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 26 @ 10156 updates, score 0) (writing took 224.5758520209929 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-07 22:15:22 - train.py[line:336] - INFO: end of epoch 26 (average epoch stats below)
2024-11-07 22:15:22 - progress_bar.py[line:282] - INFO: epoch 026 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.073 | ntokens 17324.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.41 | wps 2481.4 | ups 0.14 | wpb 17324.8 | bsz 1023 | num_updates 10156 | lr 3.93753e-05 | gnorm 0.009 | clip 0 | loss_scale 16384 | train_wall 1202 | gb_free 13.3 | wall 66336
2024-11-07 22:15:22 - trainer.py[line:639] - INFO: loading train data for epoch 27
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 22:18:04 - trainer.py[line:703] - INFO: begin training epoch 27
2024-11-07 22:18:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 22:18:30 - progress_bar.py[line:274] - INFO: epoch 027:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=16732.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=335.2, ups=0.02, wpb=16732.2, bsz=985.6, num_updates=10160, lr=3.93699e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66523
2024-11-07 22:19:28 - progress_bar.py[line:274] - INFO: epoch 027:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.078, ntokens=17426.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=2985.2, ups=0.17, wpb=17426.9, bsz=1024, num_updates=10170, lr=3.93563e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=12.8, wall=66582
2024-11-07 22:20:27 - progress_bar.py[line:274] - INFO: epoch 027:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17569.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3008, ups=0.17, wpb=17569.2, bsz=1024, num_updates=10180, lr=3.93427e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66640
2024-11-07 22:21:25 - progress_bar.py[line:274] - INFO: epoch 027:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17382.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=2973.9, ups=0.17, wpb=17382.2, bsz=1024, num_updates=10190, lr=3.93291e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66699
2024-11-07 22:22:24 - progress_bar.py[line:274] - INFO: epoch 027:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=2978.2, ups=0.17, wpb=17448.4, bsz=1024, num_updates=10200, lr=3.93154e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66757
2024-11-07 22:23:22 - progress_bar.py[line:274] - INFO: epoch 027:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17421.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3016.6, ups=0.17, wpb=17421.1, bsz=1024, num_updates=10210, lr=3.93018e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=66815
2024-11-07 22:24:20 - progress_bar.py[line:274] - INFO: epoch 027:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17150.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=2925.4, ups=0.17, wpb=17150.6, bsz=1024, num_updates=10220, lr=3.92882e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=66874
2024-11-07 22:25:19 - progress_bar.py[line:274] - INFO: epoch 027:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17236.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=2917.5, ups=0.17, wpb=17236.6, bsz=1024, num_updates=10230, lr=3.92746e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66933
2024-11-07 22:26:19 - progress_bar.py[line:274] - INFO: epoch 027:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.066, ntokens=17336.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=2924.7, ups=0.17, wpb=17336.1, bsz=1024, num_updates=10240, lr=3.9261e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=66992
2024-11-07 22:27:17 - progress_bar.py[line:274] - INFO: epoch 027:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.998, ntokens=17207, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=2956.9, ups=0.17, wpb=17207, bsz=1024, num_updates=10250, lr=3.92474e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=67050
2024-11-07 22:28:15 - progress_bar.py[line:274] - INFO: epoch 027:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17688.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3024.2, ups=0.17, wpb=17688.8, bsz=1024, num_updates=10260, lr=3.92338e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=67109
2024-11-07 22:29:14 - progress_bar.py[line:274] - INFO: epoch 027:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.043, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=2907.7, ups=0.17, wpb=17219.7, bsz=1024, num_updates=10270, lr=3.92202e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=67168
2024-11-07 22:30:14 - progress_bar.py[line:274] - INFO: epoch 027:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17393.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=2939.6, ups=0.17, wpb=17393.4, bsz=1024, num_updates=10280, lr=3.92066e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=67227
2024-11-07 22:31:12 - progress_bar.py[line:274] - INFO: epoch 027:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17434.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=2961.9, ups=0.17, wpb=17434.1, bsz=1024, num_updates=10290, lr=3.9193e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=67286
2024-11-07 22:32:12 - progress_bar.py[line:274] - INFO: epoch 027:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17154.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2887.9, ups=0.17, wpb=17154.2, bsz=1024, num_updates=10300, lr=3.91794e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=67345
2024-11-07 22:33:11 - progress_bar.py[line:274] - INFO: epoch 027:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17385.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=2954, ups=0.17, wpb=17385.4, bsz=1024, num_updates=10310, lr=3.91658e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=12.8, wall=67404
2024-11-07 22:34:10 - progress_bar.py[line:274] - INFO: epoch 027:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17127.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=2901, ups=0.17, wpb=17127.2, bsz=1024, num_updates=10320, lr=3.91522e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=67463
2024-11-07 22:35:08 - progress_bar.py[line:274] - INFO: epoch 027:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17279.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=2973.3, ups=0.17, wpb=17279.2, bsz=1024, num_updates=10330, lr=3.91386e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=67521
2024-11-07 22:36:06 - progress_bar.py[line:274] - INFO: epoch 027:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17588.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3000, ups=0.17, wpb=17588.7, bsz=1024, num_updates=10340, lr=3.9125e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=67580
2024-11-07 22:37:05 - progress_bar.py[line:274] - INFO: epoch 027:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17083.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=2919.5, ups=0.17, wpb=17083.5, bsz=1024, num_updates=10350, lr=3.91114e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=67639
2024-11-07 22:38:04 - progress_bar.py[line:274] - INFO: epoch 027:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17280.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=2946.2, ups=0.17, wpb=17280.2, bsz=1024, num_updates=10360, lr=3.90978e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=67697
2024-11-07 22:39:02 - progress_bar.py[line:274] - INFO: epoch 027:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=16945.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=2884.2, ups=0.17, wpb=16945.6, bsz=1024, num_updates=10370, lr=3.90842e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=67756
2024-11-07 22:40:01 - progress_bar.py[line:274] - INFO: epoch 027:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17179.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=2956.2, ups=0.17, wpb=17179.6, bsz=1024, num_updates=10380, lr=3.90706e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=67814
2024-11-07 22:40:59 - progress_bar.py[line:274] - INFO: epoch 027:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17231.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=2946.8, ups=0.17, wpb=17231.1, bsz=1024, num_updates=10390, lr=3.9057e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=67872
2024-11-07 22:41:57 - progress_bar.py[line:274] - INFO: epoch 027:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=17201.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=2965.5, ups=0.17, wpb=17201.2, bsz=1024, num_updates=10400, lr=3.90434e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=67931
2024-11-07 22:42:56 - progress_bar.py[line:274] - INFO: epoch 027:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17809.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=2996.3, ups=0.17, wpb=17809.8, bsz=1024, num_updates=10410, lr=3.90298e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=67990
2024-11-07 22:43:55 - progress_bar.py[line:274] - INFO: epoch 027:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17471.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=2966.4, ups=0.17, wpb=17471.6, bsz=1024, num_updates=10420, lr=3.90162e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=68049
2024-11-07 22:44:54 - progress_bar.py[line:274] - INFO: epoch 027:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=2955.6, ups=0.17, wpb=17289.7, bsz=1024, num_updates=10430, lr=3.90026e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=68107
2024-11-07 22:45:52 - progress_bar.py[line:274] - INFO: epoch 027:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17338.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=2956.4, ups=0.17, wpb=17338.4, bsz=1024, num_updates=10440, lr=3.8989e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68166
2024-11-07 22:46:52 - progress_bar.py[line:274] - INFO: epoch 027:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17231.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=2911.4, ups=0.17, wpb=17231.1, bsz=1024, num_updates=10450, lr=3.89753e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68225
2024-11-07 22:47:51 - progress_bar.py[line:274] - INFO: epoch 027:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17259.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=2920.1, ups=0.17, wpb=17259.3, bsz=1024, num_updates=10460, lr=3.89617e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=68284
2024-11-07 22:48:49 - progress_bar.py[line:274] - INFO: epoch 027:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.053, ntokens=17230.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=2950.6, ups=0.17, wpb=17230.3, bsz=1024, num_updates=10470, lr=3.89481e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=68343
2024-11-07 22:49:47 - progress_bar.py[line:274] - INFO: epoch 027:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17367.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3001.8, ups=0.17, wpb=17367.7, bsz=1024, num_updates=10480, lr=3.89345e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=68401
2024-11-07 22:50:42 - progress_bar.py[line:274] - INFO: epoch 027:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17329.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3177.4, ups=0.18, wpb=17329.3, bsz=1024, num_updates=10490, lr=3.89209e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=68455
2024-11-07 22:51:36 - progress_bar.py[line:274] - INFO: epoch 027:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17291.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3178, ups=0.18, wpb=17291.7, bsz=1024, num_updates=10500, lr=3.89073e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=49, gb_free=13.6, wall=68509
2024-11-07 22:52:29 - progress_bar.py[line:274] - INFO: epoch 027:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.084, ntokens=17658.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3334.7, ups=0.19, wpb=17658.3, bsz=1024, num_updates=10510, lr=3.88937e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=68562
2024-11-07 22:53:24 - progress_bar.py[line:274] - INFO: epoch 027:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17568.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3184.2, ups=0.18, wpb=17568.7, bsz=1024, num_updates=10520, lr=3.88801e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=45, gb_free=13.6, wall=68618
2024-11-07 22:54:21 - progress_bar.py[line:274] - INFO: epoch 027:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17662.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3103.5, ups=0.18, wpb=17662.1, bsz=1024, num_updates=10530, lr=3.88665e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=68675
2024-11-07 22:55:19 - progress_bar.py[line:274] - INFO: epoch 027:    384 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.215, ntokens=17505.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3039.4, ups=0.17, wpb=17505.4, bsz=1024, num_updates=10540, lr=3.88529e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=68732
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt2024-11-07 22:55:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 27 @ 10547 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt

2024-11-07 22:55:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 22:57:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-07 22:59:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 27 @ 10547 updates, score 0) (writing took 219.77548728699912 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
2024-11-07 23:00:29 - train.py[line:336] - INFO: end of epoch 27 (average epoch stats below)
2024-11-07 23:00:29 - progress_bar.py[line:282] - INFO: epoch 027 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.057 | ntokens 17340.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.32 | wps 2505.1 | ups 0.14 | wpb 17340.7 | bsz 1023 | num_updates 10547 | lr 3.88434e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1330 | gb_free 13.2 | wall 69042
2024-11-07 23:00:29 - trainer.py[line:639] - INFO: loading train data for epoch 28
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 23:03:09 - trainer.py[line:703] - INFO: begin training epoch 28
2024-11-07 23:03:09 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 23:03:27 - progress_bar.py[line:274] - INFO: epoch 028:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=16800.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=344, ups=0.02, wpb=16800.6, bsz=985.6, num_updates=10550, lr=3.88393e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.6, wall=69221
2024-11-07 23:04:21 - progress_bar.py[line:274] - INFO: epoch 028:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.075, ntokens=17416.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=3255.2, ups=0.19, wpb=17416.8, bsz=1024, num_updates=10560, lr=3.88257e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=69274
2024-11-07 23:05:14 - progress_bar.py[line:274] - INFO: epoch 028:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.098, ntokens=17686.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3316.2, ups=0.19, wpb=17686.5, bsz=1024, num_updates=10570, lr=3.88121e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=69327
2024-11-07 23:06:07 - progress_bar.py[line:274] - INFO: epoch 028:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17168.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3260, ups=0.19, wpb=17168.6, bsz=1024, num_updates=10580, lr=3.87985e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=69380
2024-11-07 23:07:00 - progress_bar.py[line:274] - INFO: epoch 028:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17505.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3262.7, ups=0.19, wpb=17505.6, bsz=1024, num_updates=10590, lr=3.87849e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=69434
2024-11-07 23:07:53 - progress_bar.py[line:274] - INFO: epoch 028:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.044, ntokens=17415.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3272.5, ups=0.19, wpb=17415.7, bsz=1024, num_updates=10600, lr=3.87713e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69487
2024-11-07 23:08:47 - progress_bar.py[line:274] - INFO: epoch 028:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17207.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3240, ups=0.19, wpb=17207.2, bsz=1024, num_updates=10610, lr=3.87577e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=69540
2024-11-07 23:09:40 - progress_bar.py[line:274] - INFO: epoch 028:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17412.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3266.3, ups=0.19, wpb=17412.1, bsz=1024, num_updates=10620, lr=3.87441e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=69593
2024-11-07 23:10:33 - progress_bar.py[line:274] - INFO: epoch 028:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17191.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3221.6, ups=0.19, wpb=17191.7, bsz=1024, num_updates=10630, lr=3.87305e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69647
2024-11-07 23:11:26 - progress_bar.py[line:274] - INFO: epoch 028:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3238.7, ups=0.19, wpb=17239.6, bsz=1024, num_updates=10640, lr=3.87169e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=69700
2024-11-07 23:12:20 - progress_bar.py[line:274] - INFO: epoch 028:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.086, ntokens=17442.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=3279.6, ups=0.19, wpb=17442.7, bsz=1024, num_updates=10650, lr=3.87033e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69753
2024-11-07 23:13:13 - progress_bar.py[line:274] - INFO: epoch 028:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17128.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3217.7, ups=0.19, wpb=17128.5, bsz=1024, num_updates=10660, lr=3.86897e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=69806
2024-11-07 23:14:07 - progress_bar.py[line:274] - INFO: epoch 028:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17379.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3187.6, ups=0.18, wpb=17379.9, bsz=1024, num_updates=10670, lr=3.86761e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=69861
2024-11-07 23:15:01 - progress_bar.py[line:274] - INFO: epoch 028:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17451.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3230, ups=0.19, wpb=17451.9, bsz=1024, num_updates=10680, lr=3.86625e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=69915
2024-11-07 23:15:28 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-07 23:16:00 - progress_bar.py[line:274] - INFO: epoch 028:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=17106.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=2921.4, ups=0.17, wpb=17106.7, bsz=1024, num_updates=10690, lr=3.86489e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=33, gb_free=13.1, wall=69973
2024-11-07 23:16:53 - progress_bar.py[line:274] - INFO: epoch 028:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.027, ntokens=17426.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3258.5, ups=0.19, wpb=17426.3, bsz=1024, num_updates=10700, lr=3.86353e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=70027
2024-11-07 23:17:47 - progress_bar.py[line:274] - INFO: epoch 028:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17113.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3213.9, ups=0.19, wpb=17113.1, bsz=1024, num_updates=10710, lr=3.86216e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=70080
2024-11-07 23:18:41 - progress_bar.py[line:274] - INFO: epoch 028:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17300.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3156, ups=0.18, wpb=17300.6, bsz=1024, num_updates=10720, lr=3.8608e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=70135
2024-11-07 23:19:40 - progress_bar.py[line:274] - INFO: epoch 028:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.093, ntokens=17679.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3001.3, ups=0.17, wpb=17679.8, bsz=1024, num_updates=10730, lr=3.85944e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=70194
2024-11-07 23:20:37 - progress_bar.py[line:274] - INFO: epoch 028:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17173, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3023.3, ups=0.18, wpb=17173, bsz=1024, num_updates=10740, lr=3.85808e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=70251
2024-11-07 23:21:30 - progress_bar.py[line:274] - INFO: epoch 028:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.036, ntokens=17256.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3241.7, ups=0.19, wpb=17256.7, bsz=1024, num_updates=10750, lr=3.85672e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=70304
2024-11-07 23:22:23 - progress_bar.py[line:274] - INFO: epoch 028:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.007, ntokens=17085.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3230.9, ups=0.19, wpb=17085.2, bsz=1024, num_updates=10760, lr=3.85536e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=70357
2024-11-07 23:23:16 - progress_bar.py[line:274] - INFO: epoch 028:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.011, ntokens=17514.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3298.3, ups=0.19, wpb=17514.2, bsz=1024, num_updates=10770, lr=3.854e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=70410
2024-11-07 23:24:10 - progress_bar.py[line:274] - INFO: epoch 028:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17364.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3229.7, ups=0.19, wpb=17364.3, bsz=1024, num_updates=10780, lr=3.85264e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=70464
2024-11-07 23:25:03 - progress_bar.py[line:274] - INFO: epoch 028:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.032, ntokens=17436.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3270.7, ups=0.19, wpb=17436.3, bsz=1024, num_updates=10790, lr=3.85128e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=70517
2024-11-07 23:25:57 - progress_bar.py[line:274] - INFO: epoch 028:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3274.7, ups=0.19, wpb=17570.6, bsz=1024, num_updates=10800, lr=3.84992e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=70571
2024-11-07 23:26:50 - progress_bar.py[line:274] - INFO: epoch 028:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17341.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3261, ups=0.19, wpb=17341.3, bsz=1024, num_updates=10810, lr=3.84856e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=70624
2024-11-07 23:27:45 - progress_bar.py[line:274] - INFO: epoch 028:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.011, ntokens=17255.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3178.1, ups=0.18, wpb=17255.8, bsz=1024, num_updates=10820, lr=3.8472e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=70678
2024-11-07 23:28:38 - progress_bar.py[line:274] - INFO: epoch 028:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17145.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3211.3, ups=0.19, wpb=17145.3, bsz=1024, num_updates=10830, lr=3.84584e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=70732
2024-11-07 23:29:32 - progress_bar.py[line:274] - INFO: epoch 028:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=17226.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3202.6, ups=0.19, wpb=17226.6, bsz=1024, num_updates=10840, lr=3.84448e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=70785
2024-11-07 23:30:26 - progress_bar.py[line:274] - INFO: epoch 028:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17363.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3228.9, ups=0.19, wpb=17363.8, bsz=1024, num_updates=10850, lr=3.84312e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=70839
2024-11-07 23:31:19 - progress_bar.py[line:274] - INFO: epoch 028:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17315.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3229, ups=0.19, wpb=17315.6, bsz=1024, num_updates=10860, lr=3.84176e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=70893
2024-11-07 23:32:13 - progress_bar.py[line:274] - INFO: epoch 028:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17247.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3206.6, ups=0.19, wpb=17247.3, bsz=1024, num_updates=10870, lr=3.8404e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=12.9, wall=70946
2024-11-07 23:33:06 - progress_bar.py[line:274] - INFO: epoch 028:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.009, ntokens=17316.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3267.7, ups=0.19, wpb=17316.3, bsz=1024, num_updates=10880, lr=3.83904e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=70999
2024-11-07 23:33:59 - progress_bar.py[line:274] - INFO: epoch 028:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17410.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3274.9, ups=0.19, wpb=17410.8, bsz=1024, num_updates=10890, lr=3.83768e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=71053
2024-11-07 23:34:53 - progress_bar.py[line:274] - INFO: epoch 028:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.053, ntokens=17679.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3302.4, ups=0.19, wpb=17679.3, bsz=1024, num_updates=10900, lr=3.83632e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=71106
2024-11-07 23:35:47 - progress_bar.py[line:274] - INFO: epoch 028:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17489, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3246.7, ups=0.19, wpb=17489, bsz=1024, num_updates=10910, lr=3.83496e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=71160
2024-11-07 23:36:41 - progress_bar.py[line:274] - INFO: epoch 028:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17602.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3220.7, ups=0.18, wpb=17602.9, bsz=1024, num_updates=10920, lr=3.8336e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=71215
2024-11-07 23:37:37 - progress_bar.py[line:274] - INFO: epoch 028:    384 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.191, ntokens=17537.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.13, wps=3164.1, ups=0.18, wpb=17537.5, bsz=1024, num_updates=10930, lr=3.83224e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=71270
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt

2024-11-07 23:38:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 28 @ 10937 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-07 23:38:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt': File exists: File exists: File exists
: File exists: File exists
: File exists



local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-07 23:39:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-07 23:41:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 28 @ 10937 updates, score 0) (writing took 214.38513332299772 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-07 23:42:41 - train.py[line:336] - INFO: end of epoch 28 (average epoch stats below)
2024-11-07 23:42:41 - progress_bar.py[line:282] - INFO: epoch 028 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.038 | ntokens 17338.7 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.21 | wps 2670.5 | ups 0.15 | wpb 17338.7 | bsz 1023 | num_updates 10937 | lr 3.83128e-05 | gnorm 0.008 | clip 0 | loss_scale 16384 | train_wall 1219 | gb_free 13.2 | wall 71575
2024-11-07 23:42:41 - trainer.py[line:639] - INFO: loading train data for epoch 29
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 23:45:21 - trainer.py[line:703] - INFO: begin training epoch 29
2024-11-07 23:45:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 23:45:40 - progress_bar.py[line:274] - INFO: epoch 029:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=16709.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=346, ups=0.02, wpb=16709.2, bsz=985.6, num_updates=10940, lr=3.83088e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=45, gb_free=13.6, wall=71753
2024-11-07 23:46:33 - progress_bar.py[line:274] - INFO: epoch 029:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17305, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3218.3, ups=0.19, wpb=17305, bsz=1024, num_updates=10950, lr=3.82952e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=71807
2024-11-07 23:47:27 - progress_bar.py[line:274] - INFO: epoch 029:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17479, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3282.4, ups=0.19, wpb=17479, bsz=1024, num_updates=10960, lr=3.82815e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=71860
2024-11-07 23:48:20 - progress_bar.py[line:274] - INFO: epoch 029:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.948, ntokens=17095.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3196.1, ups=0.19, wpb=17095.9, bsz=1024, num_updates=10970, lr=3.82679e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=71914
2024-11-07 23:49:13 - progress_bar.py[line:274] - INFO: epoch 029:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17413.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3268.4, ups=0.19, wpb=17413.4, bsz=1024, num_updates=10980, lr=3.82543e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=71967
2024-11-07 23:50:07 - progress_bar.py[line:274] - INFO: epoch 029:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17573.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3303.1, ups=0.19, wpb=17573.5, bsz=1024, num_updates=10990, lr=3.82407e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=72020
2024-11-07 23:50:59 - progress_bar.py[line:274] - INFO: epoch 029:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.907, ntokens=17040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3235.7, ups=0.19, wpb=17040.3, bsz=1024, num_updates=11000, lr=3.82271e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=72073
2024-11-07 23:51:53 - progress_bar.py[line:274] - INFO: epoch 029:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.027, ntokens=17177.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3214, ups=0.19, wpb=17177.1, bsz=1024, num_updates=11010, lr=3.82135e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=72126
2024-11-07 23:52:46 - progress_bar.py[line:274] - INFO: epoch 029:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17489.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3268.8, ups=0.19, wpb=17489.7, bsz=1024, num_updates=11020, lr=3.81999e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=72180
2024-11-07 23:53:40 - progress_bar.py[line:274] - INFO: epoch 029:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.975, ntokens=17122.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3162.3, ups=0.18, wpb=17122.6, bsz=1024, num_updates=11030, lr=3.81863e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=72234
2024-11-07 23:54:33 - progress_bar.py[line:274] - INFO: epoch 029:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17479.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3297.9, ups=0.19, wpb=17479.6, bsz=1024, num_updates=11040, lr=3.81727e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=72287
2024-11-07 23:55:28 - progress_bar.py[line:274] - INFO: epoch 029:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17144.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3148.2, ups=0.18, wpb=17144.5, bsz=1024, num_updates=11050, lr=3.81591e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=72341
2024-11-07 23:56:22 - progress_bar.py[line:274] - INFO: epoch 029:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17431.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3235.8, ups=0.19, wpb=17431.9, bsz=1024, num_updates=11060, lr=3.81455e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=72395
2024-11-07 23:57:15 - progress_bar.py[line:274] - INFO: epoch 029:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17566.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3280.2, ups=0.19, wpb=17566.3, bsz=1024, num_updates=11070, lr=3.81319e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=72449
2024-11-07 23:58:09 - progress_bar.py[line:274] - INFO: epoch 029:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.005, ntokens=16984.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3172.5, ups=0.19, wpb=16984.9, bsz=1024, num_updates=11080, lr=3.81183e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=72502
2024-11-07 23:59:03 - progress_bar.py[line:274] - INFO: epoch 029:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17191.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3179.5, ups=0.18, wpb=17191.3, bsz=1024, num_updates=11090, lr=3.81047e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=72556
2024-11-07 23:59:57 - progress_bar.py[line:274] - INFO: epoch 029:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=17330.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3195.2, ups=0.18, wpb=17330.8, bsz=1024, num_updates=11100, lr=3.80911e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=72611
2024-11-08 00:00:52 - progress_bar.py[line:274] - INFO: epoch 029:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17251.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3159.4, ups=0.18, wpb=17251.6, bsz=1024, num_updates=11110, lr=3.80775e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=38, gb_free=13.5, wall=72665
2024-11-08 00:01:47 - progress_bar.py[line:274] - INFO: epoch 029:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17378.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3164.8, ups=0.18, wpb=17378.5, bsz=1024, num_updates=11120, lr=3.80639e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.6, wall=72720
2024-11-08 00:02:42 - progress_bar.py[line:274] - INFO: epoch 029:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17202.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3114.5, ups=0.18, wpb=17202.4, bsz=1024, num_updates=11130, lr=3.80503e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=72775
2024-11-08 00:03:37 - progress_bar.py[line:274] - INFO: epoch 029:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17219.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3134.4, ups=0.18, wpb=17219.9, bsz=1024, num_updates=11140, lr=3.80367e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=72830
2024-11-08 00:04:31 - progress_bar.py[line:274] - INFO: epoch 029:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17000.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3135, ups=0.18, wpb=17000.1, bsz=1024, num_updates=11150, lr=3.80231e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=72885
2024-11-08 00:05:23 - progress_bar.py[line:274] - INFO: epoch 029:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=16889.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3226.9, ups=0.19, wpb=16889.9, bsz=1024, num_updates=11160, lr=3.80095e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=72937
2024-11-08 00:06:15 - progress_bar.py[line:274] - INFO: epoch 029:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17220.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3318.5, ups=0.19, wpb=17220.2, bsz=1024, num_updates=11170, lr=3.79959e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=50, gb_free=13.6, wall=72989
2024-11-08 00:07:08 - progress_bar.py[line:274] - INFO: epoch 029:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17352.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3306, ups=0.19, wpb=17352.2, bsz=1024, num_updates=11180, lr=3.79823e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=35, gb_free=13.4, wall=73041
2024-11-08 00:08:01 - progress_bar.py[line:274] - INFO: epoch 029:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17826.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3342.5, ups=0.19, wpb=17826.4, bsz=1024, num_updates=11190, lr=3.79687e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=73095
2024-11-08 00:08:55 - progress_bar.py[line:274] - INFO: epoch 029:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17377.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3236.8, ups=0.19, wpb=17377.9, bsz=1024, num_updates=11200, lr=3.79551e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=73148
2024-11-08 00:09:48 - progress_bar.py[line:274] - INFO: epoch 029:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.998, ntokens=17322.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3232.1, ups=0.19, wpb=17322.8, bsz=1024, num_updates=11210, lr=3.79414e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=73202
2024-11-08 00:10:42 - progress_bar.py[line:274] - INFO: epoch 029:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.007, ntokens=17227, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3224.1, ups=0.19, wpb=17227, bsz=1024, num_updates=11220, lr=3.79278e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=73255
2024-11-08 00:11:35 - progress_bar.py[line:274] - INFO: epoch 029:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17229.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3216.2, ups=0.19, wpb=17229.1, bsz=1024, num_updates=11230, lr=3.79142e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=73309
2024-11-08 00:12:29 - progress_bar.py[line:274] - INFO: epoch 029:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.023, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3290.8, ups=0.19, wpb=17543.5, bsz=1024, num_updates=11240, lr=3.79006e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=73362
2024-11-08 00:13:23 - progress_bar.py[line:274] - INFO: epoch 029:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17051.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3164.5, ups=0.19, wpb=17051.7, bsz=1024, num_updates=11250, lr=3.7887e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=73416
2024-11-08 00:14:16 - progress_bar.py[line:274] - INFO: epoch 029:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17491.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3253.7, ups=0.19, wpb=17491.6, bsz=1024, num_updates=11260, lr=3.78734e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=73470
2024-11-08 00:15:10 - progress_bar.py[line:274] - INFO: epoch 029:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17332.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3251.4, ups=0.19, wpb=17332.7, bsz=1024, num_updates=11270, lr=3.78598e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=73523
2024-11-08 00:16:04 - progress_bar.py[line:274] - INFO: epoch 029:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17359.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3212.8, ups=0.19, wpb=17359.1, bsz=1024, num_updates=11280, lr=3.78462e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=73577
2024-11-08 00:16:57 - progress_bar.py[line:274] - INFO: epoch 029:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17507.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3270.7, ups=0.19, wpb=17507.9, bsz=1024, num_updates=11290, lr=3.78326e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=73631
2024-11-08 00:17:51 - progress_bar.py[line:274] - INFO: epoch 029:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17406.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3247.1, ups=0.19, wpb=17406.2, bsz=1024, num_updates=11300, lr=3.7819e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=73684
2024-11-08 00:18:44 - progress_bar.py[line:274] - INFO: epoch 029:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17641.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3328.4, ups=0.19, wpb=17641.7, bsz=1024, num_updates=11310, lr=3.78054e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=73737
2024-11-08 00:19:36 - progress_bar.py[line:274] - INFO: epoch 029:    383 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.181, ntokens=17735.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3382.7, ups=0.19, wpb=17735.6, bsz=1024, num_updates=11320, lr=3.77918e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=73790
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt2024-11-08 00:20:15 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 29 @ 11328 updates

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
2024-11-08 00:20:15 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 00:22:03 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-08 00:23:55 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 29 @ 11328 updates, score 0) (writing took 220.567070494988 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
2024-11-08 00:24:50 - train.py[line:336] - INFO: end of epoch 29 (average epoch stats below)
2024-11-08 00:24:50 - progress_bar.py[line:282] - INFO: epoch 029 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.019 | ntokens 17316.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.11 | wps 2677.9 | ups 0.15 | wpb 17316.5 | bsz 1023 | num_updates 11328 | lr 3.77809e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1333 | gb_free 13.2 | wall 74103
2024-11-08 00:24:50 - trainer.py[line:639] - INFO: loading train data for epoch 30
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 00:27:30 - trainer.py[line:703] - INFO: begin training epoch 30
2024-11-08 00:27:30 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 00:27:43 - progress_bar.py[line:274] - INFO: epoch 030:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=16856.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=346.1, ups=0.02, wpb=16856.2, bsz=985.6, num_updates=11330, lr=3.77782e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=29, gb_free=13.5, wall=74277
2024-11-08 00:28:37 - progress_bar.py[line:274] - INFO: epoch 030:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17418.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3220.5, ups=0.18, wpb=17418.2, bsz=1024, num_updates=11340, lr=3.77646e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=74331
2024-11-08 00:29:31 - progress_bar.py[line:274] - INFO: epoch 030:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17441, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3249.3, ups=0.19, wpb=17441, bsz=1024, num_updates=11350, lr=3.7751e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=74384
2024-11-08 00:30:25 - progress_bar.py[line:274] - INFO: epoch 030:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3211.3, ups=0.19, wpb=17200.2, bsz=1024, num_updates=11360, lr=3.77374e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=74438
2024-11-08 00:31:18 - progress_bar.py[line:274] - INFO: epoch 030:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.027, ntokens=17517.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3288.3, ups=0.19, wpb=17517.4, bsz=1024, num_updates=11370, lr=3.77238e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=74491
2024-11-08 00:32:11 - progress_bar.py[line:274] - INFO: epoch 030:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17553.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3279.2, ups=0.19, wpb=17553.7, bsz=1024, num_updates=11380, lr=3.77102e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74545
2024-11-08 00:33:05 - progress_bar.py[line:274] - INFO: epoch 030:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17180.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3217.5, ups=0.19, wpb=17180.3, bsz=1024, num_updates=11390, lr=3.76966e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=74598
2024-11-08 00:33:58 - progress_bar.py[line:274] - INFO: epoch 030:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17153.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3218, ups=0.19, wpb=17153.3, bsz=1024, num_updates=11400, lr=3.7683e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74652
2024-11-08 00:34:51 - progress_bar.py[line:274] - INFO: epoch 030:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.047, ntokens=17556.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3297.7, ups=0.19, wpb=17556.8, bsz=1024, num_updates=11410, lr=3.76694e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=74705
2024-11-08 00:35:44 - progress_bar.py[line:274] - INFO: epoch 030:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17330.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3260.9, ups=0.19, wpb=17330.4, bsz=1024, num_updates=11420, lr=3.76558e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=74758
2024-11-08 00:36:38 - progress_bar.py[line:274] - INFO: epoch 030:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17589.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3295.7, ups=0.19, wpb=17589.8, bsz=1024, num_updates=11430, lr=3.76422e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74811
2024-11-08 00:37:31 - progress_bar.py[line:274] - INFO: epoch 030:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=16873.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3155.6, ups=0.19, wpb=16873.7, bsz=1024, num_updates=11440, lr=3.76286e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=74865
2024-11-08 00:38:25 - progress_bar.py[line:274] - INFO: epoch 030:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.005, ntokens=17471.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3279.3, ups=0.19, wpb=17471.6, bsz=1024, num_updates=11450, lr=3.7615e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74918
2024-11-08 00:39:18 - progress_bar.py[line:274] - INFO: epoch 030:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3277.4, ups=0.19, wpb=17455, bsz=1024, num_updates=11460, lr=3.76013e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=74971
2024-11-08 00:40:11 - progress_bar.py[line:274] - INFO: epoch 030:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17043.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3184.7, ups=0.19, wpb=17043.4, bsz=1024, num_updates=11470, lr=3.75877e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75025
2024-11-08 00:41:05 - progress_bar.py[line:274] - INFO: epoch 030:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.938, ntokens=17172.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3226.7, ups=0.19, wpb=17172.2, bsz=1024, num_updates=11480, lr=3.75741e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75078
2024-11-08 00:41:58 - progress_bar.py[line:274] - INFO: epoch 030:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17297.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3231.9, ups=0.19, wpb=17297.5, bsz=1024, num_updates=11490, lr=3.75605e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75132
2024-11-08 00:42:51 - progress_bar.py[line:274] - INFO: epoch 030:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17185.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3217.9, ups=0.19, wpb=17185.3, bsz=1024, num_updates=11500, lr=3.75469e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75185
2024-11-08 00:43:45 - progress_bar.py[line:274] - INFO: epoch 030:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17476.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3256.4, ups=0.19, wpb=17476.2, bsz=1024, num_updates=11510, lr=3.75333e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75239
2024-11-08 00:44:38 - progress_bar.py[line:274] - INFO: epoch 030:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17188.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3221.8, ups=0.19, wpb=17188.5, bsz=1024, num_updates=11520, lr=3.75197e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=75292
2024-11-08 00:45:32 - progress_bar.py[line:274] - INFO: epoch 030:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17242.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3230.1, ups=0.19, wpb=17242.8, bsz=1024, num_updates=11530, lr=3.75061e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75345
2024-11-08 00:46:25 - progress_bar.py[line:274] - INFO: epoch 030:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17178.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3217.1, ups=0.19, wpb=17178.6, bsz=1024, num_updates=11540, lr=3.74925e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75399
2024-11-08 00:47:19 - progress_bar.py[line:274] - INFO: epoch 030:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17151.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3208.7, ups=0.19, wpb=17151.5, bsz=1024, num_updates=11550, lr=3.74789e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75452
2024-11-08 00:48:12 - progress_bar.py[line:274] - INFO: epoch 030:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17603.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3300.6, ups=0.19, wpb=17603.9, bsz=1024, num_updates=11560, lr=3.74653e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75506
2024-11-08 00:49:05 - progress_bar.py[line:274] - INFO: epoch 030:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17105.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3216.9, ups=0.19, wpb=17105.4, bsz=1024, num_updates=11570, lr=3.74517e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75559
2024-11-08 00:50:00 - progress_bar.py[line:274] - INFO: epoch 030:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.009, ntokens=17783, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3262.4, ups=0.18, wpb=17783, bsz=1024, num_updates=11580, lr=3.74381e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75613
2024-11-08 00:50:54 - progress_bar.py[line:274] - INFO: epoch 030:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.007, ntokens=17411, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3195.5, ups=0.18, wpb=17411, bsz=1024, num_updates=11590, lr=3.74245e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=32, gb_free=13.2, wall=75668
2024-11-08 00:51:47 - progress_bar.py[line:274] - INFO: epoch 030:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.001, ntokens=17390.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3278.5, ups=0.19, wpb=17390.8, bsz=1024, num_updates=11600, lr=3.74109e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=75721
2024-11-08 00:52:41 - progress_bar.py[line:274] - INFO: epoch 030:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17140.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3192.6, ups=0.19, wpb=17140.6, bsz=1024, num_updates=11610, lr=3.73973e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=75774
2024-11-08 00:53:35 - progress_bar.py[line:274] - INFO: epoch 030:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17294.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3201.7, ups=0.19, wpb=17294.8, bsz=1024, num_updates=11620, lr=3.73837e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75828
2024-11-08 00:54:29 - progress_bar.py[line:274] - INFO: epoch 030:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17198.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3203.6, ups=0.19, wpb=17198.1, bsz=1024, num_updates=11630, lr=3.73701e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75882
2024-11-08 00:55:22 - progress_bar.py[line:274] - INFO: epoch 030:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17390.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3243.7, ups=0.19, wpb=17390.9, bsz=1024, num_updates=11640, lr=3.73565e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75936
2024-11-08 00:56:16 - progress_bar.py[line:274] - INFO: epoch 030:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=17521.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3251.2, ups=0.19, wpb=17521.7, bsz=1024, num_updates=11650, lr=3.73429e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=75990
2024-11-08 00:57:10 - progress_bar.py[line:274] - INFO: epoch 030:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3194.6, ups=0.19, wpb=17245.1, bsz=1024, num_updates=11660, lr=3.73293e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=76044
2024-11-08 00:58:03 - progress_bar.py[line:274] - INFO: epoch 030:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17304, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3252, ups=0.19, wpb=17304, bsz=1024, num_updates=11670, lr=3.73157e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=76097
2024-11-08 00:58:57 - progress_bar.py[line:274] - INFO: epoch 030:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.997, ntokens=17405.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3256.3, ups=0.19, wpb=17405.7, bsz=1024, num_updates=11680, lr=3.73021e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=76150
2024-11-08 00:59:50 - progress_bar.py[line:274] - INFO: epoch 030:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17503.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3286, ups=0.19, wpb=17503.2, bsz=1024, num_updates=11690, lr=3.72885e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76204
2024-11-08 01:00:42 - progress_bar.py[line:274] - INFO: epoch 030:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17555.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3350.3, ups=0.19, wpb=17555.8, bsz=1024, num_updates=11700, lr=3.72749e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=76256
2024-11-08 01:01:34 - progress_bar.py[line:274] - INFO: epoch 030:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17571.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3379.4, ups=0.19, wpb=17571.8, bsz=1024, num_updates=11710, lr=3.72613e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=76308
2024-11-08 01:02:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 30 @ 11719 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-08 01:02:18 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 01:04:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-08 01:05:58 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 30 @ 11719 updates, score 0) (writing took 220.00395496498095 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
2024-11-08 01:06:52 - train.py[line:336] - INFO: end of epoch 30 (average epoch stats below)
2024-11-08 01:06:52 - progress_bar.py[line:282] - INFO: epoch 030 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.004 | ntokens 17335.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.02 | wps 2686.9 | ups 0.15 | wpb 17335.7 | bsz 1023 | num_updates 11719 | lr 3.7249e-05 | gnorm 0.009 | clip 0 | loss_scale 65536 | train_wall 1188 | gb_free 13.2 | wall 76626
2024-11-08 01:06:52 - trainer.py[line:639] - INFO: loading train data for epoch 31
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 01:09:33 - trainer.py[line:703] - INFO: begin training epoch 31
2024-11-08 01:09:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 01:09:41 - progress_bar.py[line:274] - INFO: epoch 031:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.142, ntokens=17027.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=350.3, ups=0.02, wpb=17027.6, bsz=985.6, num_updates=11720, lr=3.72476e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=29, gb_free=13.3, wall=76794
2024-11-08 01:10:34 - progress_bar.py[line:274] - INFO: epoch 031:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=17563.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3276.5, ups=0.19, wpb=17563.9, bsz=1024, num_updates=11730, lr=3.7234e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76848
2024-11-08 01:11:27 - progress_bar.py[line:274] - INFO: epoch 031:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.023, ntokens=17294.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3248.7, ups=0.19, wpb=17294.8, bsz=1024, num_updates=11740, lr=3.72204e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=76901
2024-11-08 01:12:21 - progress_bar.py[line:274] - INFO: epoch 031:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.986, ntokens=17407.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3255.7, ups=0.19, wpb=17407.4, bsz=1024, num_updates=11750, lr=3.72068e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=76954
2024-11-08 01:13:14 - progress_bar.py[line:274] - INFO: epoch 031:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17444.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3276.2, ups=0.19, wpb=17444.3, bsz=1024, num_updates=11760, lr=3.71932e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77008
2024-11-08 01:14:07 - progress_bar.py[line:274] - INFO: epoch 031:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17547.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3305, ups=0.19, wpb=17547.7, bsz=1024, num_updates=11770, lr=3.71796e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77061
2024-11-08 01:15:01 - progress_bar.py[line:274] - INFO: epoch 031:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17045.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3177.3, ups=0.19, wpb=17045.8, bsz=1024, num_updates=11780, lr=3.7166e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77114
2024-11-08 01:15:55 - progress_bar.py[line:274] - INFO: epoch 031:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17016.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3173.9, ups=0.19, wpb=17016.8, bsz=1024, num_updates=11790, lr=3.71524e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77168
2024-11-08 01:16:49 - progress_bar.py[line:274] - INFO: epoch 031:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17316.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3199.8, ups=0.18, wpb=17316.7, bsz=1024, num_updates=11800, lr=3.71388e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77222
2024-11-08 01:17:42 - progress_bar.py[line:274] - INFO: epoch 031:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17151.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3217.4, ups=0.19, wpb=17151.3, bsz=1024, num_updates=11810, lr=3.71252e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=77275
2024-11-08 01:18:36 - progress_bar.py[line:274] - INFO: epoch 031:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17661.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3264.4, ups=0.18, wpb=17661.3, bsz=1024, num_updates=11820, lr=3.71116e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=77330
2024-11-08 01:19:30 - progress_bar.py[line:274] - INFO: epoch 031:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17111.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3197.3, ups=0.19, wpb=17111.6, bsz=1024, num_updates=11830, lr=3.7098e-05, gnorm=0.011, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77383
2024-11-08 01:20:24 - progress_bar.py[line:274] - INFO: epoch 031:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17668.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3269.6, ups=0.19, wpb=17668.3, bsz=1024, num_updates=11840, lr=3.70844e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77437
2024-11-08 01:21:17 - progress_bar.py[line:274] - INFO: epoch 031:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17374.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3257.4, ups=0.19, wpb=17374.8, bsz=1024, num_updates=11850, lr=3.70708e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77490
2024-11-08 01:22:11 - progress_bar.py[line:274] - INFO: epoch 031:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17103.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3190.1, ups=0.19, wpb=17103.8, bsz=1024, num_updates=11860, lr=3.70572e-05, gnorm=0.012, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77544
2024-11-08 01:23:04 - progress_bar.py[line:274] - INFO: epoch 031:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17288.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3256.9, ups=0.19, wpb=17288.4, bsz=1024, num_updates=11870, lr=3.70436e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=77597
2024-11-08 01:23:57 - progress_bar.py[line:274] - INFO: epoch 031:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17244.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3229.9, ups=0.19, wpb=17244.3, bsz=1024, num_updates=11880, lr=3.703e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77651
2024-11-08 01:24:50 - progress_bar.py[line:274] - INFO: epoch 031:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17335.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3259, ups=0.19, wpb=17335.8, bsz=1024, num_updates=11890, lr=3.70164e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77704
2024-11-08 01:25:45 - progress_bar.py[line:274] - INFO: epoch 031:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17469.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3182.9, ups=0.18, wpb=17469.8, bsz=1024, num_updates=11900, lr=3.70028e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77759
2024-11-08 01:26:39 - progress_bar.py[line:274] - INFO: epoch 031:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17317.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3224.3, ups=0.19, wpb=17317.8, bsz=1024, num_updates=11910, lr=3.69892e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77812
2024-11-08 01:27:32 - progress_bar.py[line:274] - INFO: epoch 031:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17180.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3211.9, ups=0.19, wpb=17180.4, bsz=1024, num_updates=11920, lr=3.69756e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77866
2024-11-08 01:28:27 - progress_bar.py[line:274] - INFO: epoch 031:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17061.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3137.3, ups=0.18, wpb=17061.9, bsz=1024, num_updates=11930, lr=3.6962e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=77920
2024-11-08 01:29:20 - progress_bar.py[line:274] - INFO: epoch 031:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17099.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3223.1, ups=0.19, wpb=17099.3, bsz=1024, num_updates=11940, lr=3.69484e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=77973
2024-11-08 01:30:13 - progress_bar.py[line:274] - INFO: epoch 031:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17447.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3290, ups=0.19, wpb=17447.6, bsz=1024, num_updates=11950, lr=3.69348e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78026
2024-11-08 01:31:06 - progress_bar.py[line:274] - INFO: epoch 031:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17094.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3195.6, ups=0.19, wpb=17094.6, bsz=1024, num_updates=11960, lr=3.69212e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78080
2024-11-08 01:32:00 - progress_bar.py[line:274] - INFO: epoch 031:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17823.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3292.3, ups=0.18, wpb=17823.4, bsz=1024, num_updates=11970, lr=3.69075e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78134
2024-11-08 01:32:54 - progress_bar.py[line:274] - INFO: epoch 031:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17276, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3239, ups=0.19, wpb=17276, bsz=1024, num_updates=11980, lr=3.68939e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=78187
2024-11-08 01:33:47 - progress_bar.py[line:274] - INFO: epoch 031:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17315.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3258.1, ups=0.19, wpb=17315.5, bsz=1024, num_updates=11990, lr=3.68803e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=78240
2024-11-08 01:34:41 - progress_bar.py[line:274] - INFO: epoch 031:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17180.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3205.5, ups=0.19, wpb=17180.3, bsz=1024, num_updates=12000, lr=3.68667e-05, gnorm=0.015, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=78294
2024-11-08 01:35:07 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-08 01:35:40 - progress_bar.py[line:274] - INFO: epoch 031:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17219.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=2894.3, ups=0.17, wpb=17219.3, bsz=1024, num_updates=12010, lr=3.68531e-05, gnorm=0.016, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=78354
2024-11-08 01:36:34 - progress_bar.py[line:274] - INFO: epoch 031:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17402.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3214.5, ups=0.18, wpb=17402.8, bsz=1024, num_updates=12020, lr=3.68395e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=78408
2024-11-08 01:37:27 - progress_bar.py[line:274] - INFO: epoch 031:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17293, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3251.1, ups=0.19, wpb=17293, bsz=1024, num_updates=12030, lr=3.68259e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=78461
2024-11-08 01:38:21 - progress_bar.py[line:274] - INFO: epoch 031:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17260.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3227.9, ups=0.19, wpb=17260.2, bsz=1024, num_updates=12040, lr=3.68123e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=78514
2024-11-08 01:39:14 - progress_bar.py[line:274] - INFO: epoch 031:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17359.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3252.7, ups=0.19, wpb=17359.9, bsz=1024, num_updates=12050, lr=3.67987e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=78568
2024-11-08 01:40:08 - progress_bar.py[line:274] - INFO: epoch 031:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17746.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3303.8, ups=0.19, wpb=17746.1, bsz=1024, num_updates=12060, lr=3.67851e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=78621
2024-11-08 01:41:01 - progress_bar.py[line:274] - INFO: epoch 031:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17580.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3285.6, ups=0.19, wpb=17580.9, bsz=1024, num_updates=12070, lr=3.67715e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=78675
2024-11-08 01:41:55 - progress_bar.py[line:274] - INFO: epoch 031:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17536.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3259.2, ups=0.19, wpb=17536.2, bsz=1024, num_updates=12080, lr=3.67579e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=78729
2024-11-08 01:42:48 - progress_bar.py[line:274] - INFO: epoch 031:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17422.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3295, ups=0.19, wpb=17422.5, bsz=1024, num_updates=12090, lr=3.67443e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=78782
2024-11-08 01:43:40 - progress_bar.py[line:274] - INFO: epoch 031:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17704.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3388.5, ups=0.19, wpb=17704.8, bsz=1024, num_updates=12100, lr=3.67307e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=78834
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-08 01:44:25 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 31 @ 12109 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-08 01:44:25 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt': File exists
: File exists: File exists: File exists
: File exists
: File exists


local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 01:45:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-08 01:48:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 31 @ 12109 updates, score 0) (writing took 215.34687528500217 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-08 01:48:55 - train.py[line:336] - INFO: end of epoch 31 (average epoch stats below)
2024-11-08 01:48:55 - progress_bar.py[line:282] - INFO: epoch 031 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.99 | ntokens 17337.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.94 | wps 2680.8 | ups 0.15 | wpb 17337.6 | bsz 1023 | num_updates 12109 | lr 3.67185e-05 | gnorm 0.009 | clip 0 | loss_scale 32768 | train_wall 1201 | gb_free 13.2 | wall 79148
2024-11-08 01:48:55 - trainer.py[line:639] - INFO: loading train data for epoch 32
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 01:51:35 - trainer.py[line:703] - INFO: begin training epoch 32
2024-11-08 01:51:35 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 01:51:42 - progress_bar.py[line:274] - INFO: epoch 032:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=16837.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=349.4, ups=0.02, wpb=16837.6, bsz=985.6, num_updates=12110, lr=3.67171e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=79316
2024-11-08 01:52:35 - progress_bar.py[line:274] - INFO: epoch 032:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17304.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3264.7, ups=0.19, wpb=17304.8, bsz=1024, num_updates=12120, lr=3.67035e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=79369
2024-11-08 01:53:29 - progress_bar.py[line:274] - INFO: epoch 032:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.94, ntokens=17064.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3193.6, ups=0.19, wpb=17064.4, bsz=1024, num_updates=12130, lr=3.66899e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=79422
2024-11-08 01:54:22 - progress_bar.py[line:274] - INFO: epoch 032:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.986, ntokens=17487.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3255.8, ups=0.19, wpb=17487.2, bsz=1024, num_updates=12140, lr=3.66763e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=79476
2024-11-08 01:55:16 - progress_bar.py[line:274] - INFO: epoch 032:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17293, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3229.8, ups=0.19, wpb=17293, bsz=1024, num_updates=12150, lr=3.66627e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=79529
2024-11-08 01:56:09 - progress_bar.py[line:274] - INFO: epoch 032:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17540, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3301.3, ups=0.19, wpb=17540, bsz=1024, num_updates=12160, lr=3.66491e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=79583
2024-11-08 01:57:02 - progress_bar.py[line:274] - INFO: epoch 032:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.907, ntokens=17052.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3209, ups=0.19, wpb=17052.7, bsz=1024, num_updates=12170, lr=3.66355e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=79636
2024-11-08 01:57:56 - progress_bar.py[line:274] - INFO: epoch 032:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17148.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3169.2, ups=0.18, wpb=17148.1, bsz=1024, num_updates=12180, lr=3.66219e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=79690
2024-11-08 01:58:23 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-08 01:58:55 - progress_bar.py[line:274] - INFO: epoch 032:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17492.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=2964.2, ups=0.17, wpb=17492.1, bsz=1024, num_updates=12190, lr=3.66083e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=79749
2024-11-08 01:59:49 - progress_bar.py[line:274] - INFO: epoch 032:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17286.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3201.4, ups=0.19, wpb=17286.4, bsz=1024, num_updates=12200, lr=3.65947e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=79803
2024-11-08 02:00:43 - progress_bar.py[line:274] - INFO: epoch 032:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17280.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3214.9, ups=0.19, wpb=17280.4, bsz=1024, num_updates=12210, lr=3.65811e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=79857
2024-11-08 02:01:37 - progress_bar.py[line:274] - INFO: epoch 032:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17064.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3160.4, ups=0.19, wpb=17064.1, bsz=1024, num_updates=12220, lr=3.65674e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=79911
2024-11-08 02:02:31 - progress_bar.py[line:274] - INFO: epoch 032:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17387, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3210.5, ups=0.18, wpb=17387, bsz=1024, num_updates=12230, lr=3.65538e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=79965
2024-11-08 02:03:26 - progress_bar.py[line:274] - INFO: epoch 032:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17368.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3181.4, ups=0.18, wpb=17368.2, bsz=1024, num_updates=12240, lr=3.65402e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=38, gb_free=13.6, wall=80019
2024-11-08 02:04:18 - progress_bar.py[line:274] - INFO: epoch 032:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17027.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3282.6, ups=0.19, wpb=17027.9, bsz=1024, num_updates=12250, lr=3.65266e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=41, gb_free=13.5, wall=80071
2024-11-08 02:05:11 - progress_bar.py[line:274] - INFO: epoch 032:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17194, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3236.4, ups=0.19, wpb=17194, bsz=1024, num_updates=12260, lr=3.6513e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=80124
2024-11-08 02:06:05 - progress_bar.py[line:274] - INFO: epoch 032:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17213.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3193.5, ups=0.19, wpb=17213.8, bsz=1024, num_updates=12270, lr=3.64994e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=80178
2024-11-08 02:06:59 - progress_bar.py[line:274] - INFO: epoch 032:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17369.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3206.3, ups=0.18, wpb=17369.4, bsz=1024, num_updates=12280, lr=3.64858e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=80232
2024-11-08 02:07:52 - progress_bar.py[line:274] - INFO: epoch 032:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17239.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3243.5, ups=0.19, wpb=17239.8, bsz=1024, num_updates=12290, lr=3.64722e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=39, gb_free=13.4, wall=80286
2024-11-08 02:08:46 - progress_bar.py[line:274] - INFO: epoch 032:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17102.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3187.6, ups=0.19, wpb=17102.4, bsz=1024, num_updates=12300, lr=3.64586e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80339
2024-11-08 02:09:39 - progress_bar.py[line:274] - INFO: epoch 032:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17074.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3215, ups=0.19, wpb=17074.9, bsz=1024, num_updates=12310, lr=3.6445e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=80392
2024-11-08 02:10:32 - progress_bar.py[line:274] - INFO: epoch 032:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17080.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3185.7, ups=0.19, wpb=17080.3, bsz=1024, num_updates=12320, lr=3.64314e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=80446
2024-11-08 02:11:26 - progress_bar.py[line:274] - INFO: epoch 032:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17177.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3211.5, ups=0.19, wpb=17177.4, bsz=1024, num_updates=12330, lr=3.64178e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80499
2024-11-08 02:12:19 - progress_bar.py[line:274] - INFO: epoch 032:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17404.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3252.6, ups=0.19, wpb=17404.3, bsz=1024, num_updates=12340, lr=3.64042e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80553
2024-11-08 02:13:12 - progress_bar.py[line:274] - INFO: epoch 032:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17121.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3239.7, ups=0.19, wpb=17121.2, bsz=1024, num_updates=12350, lr=3.63906e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80606
2024-11-08 02:14:06 - progress_bar.py[line:274] - INFO: epoch 032:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17663.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3301, ups=0.19, wpb=17663.4, bsz=1024, num_updates=12360, lr=3.6377e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80659
2024-11-08 02:14:59 - progress_bar.py[line:274] - INFO: epoch 032:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17529.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3291.5, ups=0.19, wpb=17529.8, bsz=1024, num_updates=12370, lr=3.63634e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=80713
2024-11-08 02:15:53 - progress_bar.py[line:274] - INFO: epoch 032:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17435.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3254.1, ups=0.19, wpb=17435.2, bsz=1024, num_updates=12380, lr=3.63498e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=80766
2024-11-08 02:16:46 - progress_bar.py[line:274] - INFO: epoch 032:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17254.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3216, ups=0.19, wpb=17254.9, bsz=1024, num_updates=12390, lr=3.63362e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=80820
2024-11-08 02:17:40 - progress_bar.py[line:274] - INFO: epoch 032:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17058.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3168.6, ups=0.19, wpb=17058.9, bsz=1024, num_updates=12400, lr=3.63226e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80874
2024-11-08 02:18:33 - progress_bar.py[line:274] - INFO: epoch 032:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17500.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3282.5, ups=0.19, wpb=17500.3, bsz=1024, num_updates=12410, lr=3.6309e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=80927
2024-11-08 02:19:27 - progress_bar.py[line:274] - INFO: epoch 032:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17206, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3225.8, ups=0.19, wpb=17206, bsz=1024, num_updates=12420, lr=3.62954e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=80980
2024-11-08 02:20:20 - progress_bar.py[line:274] - INFO: epoch 032:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17446.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3256.9, ups=0.19, wpb=17446.7, bsz=1024, num_updates=12430, lr=3.62818e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=81034
2024-11-08 02:21:14 - progress_bar.py[line:274] - INFO: epoch 032:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17188.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3226.4, ups=0.19, wpb=17188.3, bsz=1024, num_updates=12440, lr=3.62682e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81087
2024-11-08 02:22:07 - progress_bar.py[line:274] - INFO: epoch 032:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17321, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3247, ups=0.19, wpb=17321, bsz=1024, num_updates=12450, lr=3.62546e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=81141
2024-11-08 02:23:01 - progress_bar.py[line:274] - INFO: epoch 032:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17473.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3249.7, ups=0.19, wpb=17473.1, bsz=1024, num_updates=12460, lr=3.6241e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81194
2024-11-08 02:23:55 - progress_bar.py[line:274] - INFO: epoch 032:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17561.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3245.3, ups=0.18, wpb=17561.8, bsz=1024, num_updates=12470, lr=3.62273e-05, gnorm=0.014, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81248
2024-11-08 02:24:48 - progress_bar.py[line:274] - INFO: epoch 032:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17511.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3312.7, ups=0.19, wpb=17511.8, bsz=1024, num_updates=12480, lr=3.62137e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81301
2024-11-08 02:25:39 - progress_bar.py[line:274] - INFO: epoch 032:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17609.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3403.6, ups=0.19, wpb=17609.8, bsz=1024, num_updates=12490, lr=3.62001e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=81353
2024-11-08 02:26:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 32 @ 12499 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-08 02:26:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 02:28:12 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000


slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-08 02:30:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 32 @ 12499 updates, score 0) (writing took 220.35579185999813 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-08 02:30:58 - train.py[line:336] - INFO: end of epoch 32 (average epoch stats below)
2024-11-08 02:30:58 - progress_bar.py[line:282] - INFO: epoch 032 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.966 | ntokens 17289.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.82 | wps 2671.7 | ups 0.15 | wpb 17289.1 | bsz 1023 | num_updates 12499 | lr 3.61879e-05 | gnorm 0.009 | clip 0 | loss_scale 16384 | train_wall 1216 | gb_free 13.2 | wall 81672
2024-11-08 02:30:58 - trainer.py[line:639] - INFO: loading train data for epoch 33
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 02:33:38 - trainer.py[line:703] - INFO: begin training epoch 33
2024-11-08 02:33:38 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 02:33:46 - progress_bar.py[line:274] - INFO: epoch 033:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=16699.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=343.2, ups=0.02, wpb=16699.1, bsz=985.6, num_updates=12500, lr=3.61865e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=81840
2024-11-08 02:34:40 - progress_bar.py[line:274] - INFO: epoch 033:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3249, ups=0.19, wpb=17398.1, bsz=1024, num_updates=12510, lr=3.61729e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81893
2024-11-08 02:35:33 - progress_bar.py[line:274] - INFO: epoch 033:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17332.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3265.8, ups=0.19, wpb=17332.8, bsz=1024, num_updates=12520, lr=3.61593e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81946
2024-11-08 02:36:27 - progress_bar.py[line:274] - INFO: epoch 033:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17268.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3192.1, ups=0.18, wpb=17268.2, bsz=1024, num_updates=12530, lr=3.61457e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=33, gb_free=13.2, wall=82000
2024-11-08 02:37:22 - progress_bar.py[line:274] - INFO: epoch 033:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.938, ntokens=17411.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3146.1, ups=0.18, wpb=17411.6, bsz=1024, num_updates=12540, lr=3.61321e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=46, gb_free=13.4, wall=82056
2024-11-08 02:38:17 - progress_bar.py[line:274] - INFO: epoch 033:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17621.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3225.7, ups=0.18, wpb=17621.9, bsz=1024, num_updates=12550, lr=3.61185e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=82110
2024-11-08 02:39:12 - progress_bar.py[line:274] - INFO: epoch 033:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17300.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3160.3, ups=0.18, wpb=17300.8, bsz=1024, num_updates=12560, lr=3.61049e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=55, gb_free=13.6, wall=82165
2024-11-08 02:40:07 - progress_bar.py[line:274] - INFO: epoch 033:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17130.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3109.6, ups=0.18, wpb=17130.2, bsz=1024, num_updates=12570, lr=3.60913e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=82220
2024-11-08 02:41:02 - progress_bar.py[line:274] - INFO: epoch 033:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=17458.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3181.3, ups=0.18, wpb=17458.7, bsz=1024, num_updates=12580, lr=3.60777e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=82275
2024-11-08 02:41:56 - progress_bar.py[line:274] - INFO: epoch 033:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17206.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3164, ups=0.18, wpb=17206.8, bsz=1024, num_updates=12590, lr=3.60641e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=82329
2024-11-08 02:42:49 - progress_bar.py[line:274] - INFO: epoch 033:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=17708.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3361.5, ups=0.19, wpb=17708.7, bsz=1024, num_updates=12600, lr=3.60505e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=82382
2024-11-08 02:43:42 - progress_bar.py[line:274] - INFO: epoch 033:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17115.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3234.5, ups=0.19, wpb=17115.2, bsz=1024, num_updates=12610, lr=3.60369e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=82435
2024-11-08 02:44:34 - progress_bar.py[line:274] - INFO: epoch 033:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17498.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3320.6, ups=0.19, wpb=17498.1, bsz=1024, num_updates=12620, lr=3.60233e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=82488
2024-11-08 02:45:27 - progress_bar.py[line:274] - INFO: epoch 033:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.962, ntokens=17491.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3299.9, ups=0.19, wpb=17491.6, bsz=1024, num_updates=12630, lr=3.60097e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=36, gb_free=13.5, wall=82541
2024-11-08 02:46:21 - progress_bar.py[line:274] - INFO: epoch 033:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17202.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3211.3, ups=0.19, wpb=17202.2, bsz=1024, num_updates=12640, lr=3.59961e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.6, wall=82594
2024-11-08 02:47:15 - progress_bar.py[line:274] - INFO: epoch 033:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17194.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3183.4, ups=0.19, wpb=17194.1, bsz=1024, num_updates=12650, lr=3.59825e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=82648
2024-11-08 02:48:08 - progress_bar.py[line:274] - INFO: epoch 033:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17347.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3247.8, ups=0.19, wpb=17347.9, bsz=1024, num_updates=12660, lr=3.59689e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=82702
2024-11-08 02:49:02 - progress_bar.py[line:274] - INFO: epoch 033:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17342.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3220.4, ups=0.19, wpb=17342.3, bsz=1024, num_updates=12670, lr=3.59553e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=82756
2024-11-08 02:49:55 - progress_bar.py[line:274] - INFO: epoch 033:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.963, ntokens=17408.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3265.7, ups=0.19, wpb=17408.7, bsz=1024, num_updates=12680, lr=3.59417e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=82809
2024-11-08 02:50:49 - progress_bar.py[line:274] - INFO: epoch 033:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17031.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3182.6, ups=0.19, wpb=17031.8, bsz=1024, num_updates=12690, lr=3.59281e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=82862
2024-11-08 02:51:42 - progress_bar.py[line:274] - INFO: epoch 033:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17248.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3223.9, ups=0.19, wpb=17248.1, bsz=1024, num_updates=12700, lr=3.59145e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=82916
2024-11-08 02:52:37 - progress_bar.py[line:274] - INFO: epoch 033:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17140, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3163.5, ups=0.18, wpb=17140, bsz=1024, num_updates=12710, lr=3.59009e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=82970
2024-11-08 02:53:32 - progress_bar.py[line:274] - INFO: epoch 033:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17111.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3064, ups=0.18, wpb=17111.9, bsz=1024, num_updates=12720, lr=3.58873e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83026
2024-11-08 02:54:31 - progress_bar.py[line:274] - INFO: epoch 033:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17479.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=2973.8, ups=0.17, wpb=17479.1, bsz=1024, num_updates=12730, lr=3.58736e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.6, wall=83085
2024-11-08 02:55:26 - progress_bar.py[line:274] - INFO: epoch 033:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17133.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3123.8, ups=0.18, wpb=17133.7, bsz=1024, num_updates=12740, lr=3.586e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83140
2024-11-08 02:56:20 - progress_bar.py[line:274] - INFO: epoch 033:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.001, ntokens=18024.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3359, ups=0.19, wpb=18024.4, bsz=1024, num_updates=12750, lr=3.58464e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=83193
2024-11-08 02:57:13 - progress_bar.py[line:274] - INFO: epoch 033:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17408.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3239.8, ups=0.19, wpb=17408.6, bsz=1024, num_updates=12760, lr=3.58328e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=83247
2024-11-08 02:58:07 - progress_bar.py[line:274] - INFO: epoch 033:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=17304, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3220.5, ups=0.19, wpb=17304, bsz=1024, num_updates=12770, lr=3.58192e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=83301
2024-11-08 02:59:01 - progress_bar.py[line:274] - INFO: epoch 033:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17211.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3210.1, ups=0.19, wpb=17211.3, bsz=1024, num_updates=12780, lr=3.58056e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=83354
2024-11-08 02:59:55 - progress_bar.py[line:274] - INFO: epoch 033:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17013, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3159.4, ups=0.19, wpb=17013, bsz=1024, num_updates=12790, lr=3.5792e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=83408
2024-11-08 03:00:49 - progress_bar.py[line:274] - INFO: epoch 033:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=17290.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3196.8, ups=0.18, wpb=17290.6, bsz=1024, num_updates=12800, lr=3.57784e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=83462
2024-11-08 03:01:42 - progress_bar.py[line:274] - INFO: epoch 033:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17062.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3177.1, ups=0.19, wpb=17062.9, bsz=1024, num_updates=12810, lr=3.57648e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83516
2024-11-08 03:02:36 - progress_bar.py[line:274] - INFO: epoch 033:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17313.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3235.4, ups=0.19, wpb=17313.2, bsz=1024, num_updates=12820, lr=3.57512e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83569
2024-11-08 03:03:29 - progress_bar.py[line:274] - INFO: epoch 033:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17156.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3214.4, ups=0.19, wpb=17156.4, bsz=1024, num_updates=12830, lr=3.57376e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83623
2024-11-08 03:04:23 - progress_bar.py[line:274] - INFO: epoch 033:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17509.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3288.2, ups=0.19, wpb=17509.6, bsz=1024, num_updates=12840, lr=3.5724e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=83676
2024-11-08 03:05:16 - progress_bar.py[line:274] - INFO: epoch 033:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17479.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3241.3, ups=0.19, wpb=17479.2, bsz=1024, num_updates=12850, lr=3.57104e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=83730
2024-11-08 03:06:10 - progress_bar.py[line:274] - INFO: epoch 033:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17348.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3243, ups=0.19, wpb=17348.6, bsz=1024, num_updates=12860, lr=3.56968e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=83783
2024-11-08 03:07:03 - progress_bar.py[line:274] - INFO: epoch 033:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17567.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3303.4, ups=0.19, wpb=17567.7, bsz=1024, num_updates=12870, lr=3.56832e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=83837
2024-11-08 03:07:55 - progress_bar.py[line:274] - INFO: epoch 033:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17515.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3397.3, ups=0.19, wpb=17515.6, bsz=1024, num_updates=12880, lr=3.56696e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=83888
2024-11-08 03:08:43 - progress_bar.py[line:274] - INFO: epoch 033:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=16686.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3425.2, ups=0.21, wpb=16686.3, bsz=985.6, num_updates=12890, lr=3.5656e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=83937
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt2024-11-08 03:08:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 33 @ 12890 updates
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt

cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
2024-11-08 03:08:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 03:10:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-08 03:12:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 33 @ 12890 updates, score 0) (writing took 221.56189146699035 seconds)
cp ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-08 03:13:19 - train.py[line:336] - INFO: end of epoch 33 (average epoch stats below)
2024-11-08 03:13:19 - progress_bar.py[line:282] - INFO: epoch 033 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.96 | ntokens 17320.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.78 | wps 2665.1 | ups 0.15 | wpb 17320.5 | bsz 1023 | num_updates 12890 | lr 3.5656e-05 | gnorm 0.008 | clip 0 | loss_scale 32768 | train_wall 1390 | gb_free 13.3 | wall 84213
2024-11-08 03:13:19 - trainer.py[line:639] - INFO: loading train data for epoch 34
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-08 03:16:00 - trainer.py[line:703] - INFO: begin training epoch 34
2024-11-08 03:16:00 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 03:16:56 - progress_bar.py[line:274] - INFO: epoch 034:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17297.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=351, ups=0.02, wpb=17297.2, bsz=1024, num_updates=12900, lr=3.56424e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=84430
2024-11-08 03:17:50 - progress_bar.py[line:274] - INFO: epoch 034:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17283.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3234.6, ups=0.19, wpb=17283.9, bsz=1024, num_updates=12910, lr=3.56288e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84483
2024-11-08 03:18:43 - progress_bar.py[line:274] - INFO: epoch 034:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17419.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3261, ups=0.19, wpb=17419.3, bsz=1024, num_updates=12920, lr=3.56152e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84537
2024-11-08 03:19:37 - progress_bar.py[line:274] - INFO: epoch 034:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17507.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3224.9, ups=0.18, wpb=17507.8, bsz=1024, num_updates=12930, lr=3.56016e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84591
2024-11-08 03:20:32 - progress_bar.py[line:274] - INFO: epoch 034:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17408.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3210.7, ups=0.18, wpb=17408.8, bsz=1024, num_updates=12940, lr=3.5588e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=84645
2024-11-08 03:21:25 - progress_bar.py[line:274] - INFO: epoch 034:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3217.5, ups=0.19, wpb=17219.7, bsz=1024, num_updates=12950, lr=3.55744e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=84699
2024-11-08 03:22:19 - progress_bar.py[line:274] - INFO: epoch 034:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17157.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3184.6, ups=0.19, wpb=17157.5, bsz=1024, num_updates=12960, lr=3.55608e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=84753
2024-11-08 03:23:13 - progress_bar.py[line:274] - INFO: epoch 034:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17285.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3179.3, ups=0.18, wpb=17285.6, bsz=1024, num_updates=12970, lr=3.55472e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=84807
2024-11-08 03:24:07 - progress_bar.py[line:274] - INFO: epoch 034:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17183.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3217.9, ups=0.19, wpb=17183.7, bsz=1024, num_updates=12980, lr=3.55335e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84860
2024-11-08 03:25:00 - progress_bar.py[line:274] - INFO: epoch 034:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17336.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3269, ups=0.19, wpb=17336.9, bsz=1024, num_updates=12990, lr=3.55199e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84913
2024-11-08 03:25:54 - progress_bar.py[line:274] - INFO: epoch 034:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.94, ntokens=17180.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3196.6, ups=0.19, wpb=17180.1, bsz=1024, num_updates=13000, lr=3.55063e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=84967
2024-11-08 03:26:47 - progress_bar.py[line:274] - INFO: epoch 034:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17384.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3262.9, ups=0.19, wpb=17384.5, bsz=1024, num_updates=13010, lr=3.54927e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=85020
2024-11-08 03:27:40 - progress_bar.py[line:274] - INFO: epoch 034:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17469.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3265, ups=0.19, wpb=17469.2, bsz=1024, num_updates=13020, lr=3.54791e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=85074
2024-11-08 03:28:34 - progress_bar.py[line:274] - INFO: epoch 034:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17428.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3247, ups=0.19, wpb=17428.7, bsz=1024, num_updates=13030, lr=3.54655e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=85128
2024-11-08 03:29:27 - progress_bar.py[line:274] - INFO: epoch 034:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17113, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3210.2, ups=0.19, wpb=17113, bsz=1024, num_updates=13040, lr=3.54519e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=85181
2024-11-08 03:30:21 - progress_bar.py[line:274] - INFO: epoch 034:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.939, ntokens=17333.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3255.3, ups=0.19, wpb=17333.7, bsz=1024, num_updates=13050, lr=3.54383e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=85234
2024-11-08 03:31:15 - progress_bar.py[line:274] - INFO: epoch 034:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17137.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3152.2, ups=0.18, wpb=17137.5, bsz=1024, num_updates=13060, lr=3.54247e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=85288
2024-11-08 03:32:09 - progress_bar.py[line:274] - INFO: epoch 034:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17263, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3201.6, ups=0.19, wpb=17263, bsz=1024, num_updates=13070, lr=3.54111e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=85342
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846924 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846925 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846926 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846927 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846928 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846929 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846930 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846931 closing signal SIGINT
  File "../../train.py", line 298, in train
    for i, samples in enumerate(progress):
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/logging/progress_bar.py", line 261, in __iter__
    for i, obj in enumerate(self.iterable, start=self.n):
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 509, in _chunk_iterator
    for x in itr:
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 56, in __next__
    x = next(self._itr)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/data/iterators.py", line 635, in __next__
    item = self._queue.get(True)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/queue.py", line 170, in get
    self.not_empty.wait()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/threading.py", line 296, in wait
    waiter.acquire()
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
Traceback (most recent call last):
    loss.backward()  File "../../train.py", line 543, in <module>

  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
        log_output = trainer.train_step(samples)valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)

  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
      File "../../train.py", line 302, in train
return func(*args, **kwds)    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt

  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
terminate called without an active exception
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846924 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846925 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846926 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846927 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846928 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846929 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846930 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 846931 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 846829 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 716, in run
    self._shutdown(e.sigval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 846829 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/run.py", line 756, in run
    )(*cmd_args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 237, in launch_agent
    result = agent.run()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/metrics/api.py", line 129, in wrapper
    result = f(*args, **kwargs)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 721, in run
    self._shutdown()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 846829 got signal: 2
