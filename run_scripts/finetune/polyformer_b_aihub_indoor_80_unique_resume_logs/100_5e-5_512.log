/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:19 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-12 05:43:21 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-12 05:43:21 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:21 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-12 05:43:22 - utils.py[line:261] - INFO: Start init
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-12 05:43:22 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 2
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 6
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 3
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 5
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 7
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 4
single-machine distributed training is initialized.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 1
single-machine distributed training is initialized.
2024-11-12 05:43:22 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 0
single-machine distributed training is initialized.
2024-11-12 05:43:25 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512', 'restore_file': '../finetune/polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../finetune/polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-12 05:43:25 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-12 05:43:25 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 05:43:37 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-12 05:43:37 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-12 05:43:37 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-12 05:43:37 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-12 05:43:37 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-12 05:43:37 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 row count 10034 total row count 80273file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 row count 10034 total row count 80273

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 row count 10034 total row count 80273file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 row count 10034 total row count 80273

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 row count 10035 total row count 80273
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 row count 10034 total row count 80273
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 row count 10034 total row count 80273
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 row count 10034 total row count 80273
2024-11-12 05:44:12 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-12 05:44:13 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-12 05:44:13 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-12 05:44:14 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-12 05:44:14 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-12 05:44:14 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-12 05:44:14 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-12 05:44:14 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../finetune/polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 05:44:27 - trainer.py[line:619] - INFO: Loaded checkpoint ../finetune/polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 101 @ 0 updates)
2024-11-12 05:44:27 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 2 seek offset 93612
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 1 seek offset 46806
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 6 seek offset 280832
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442



slice_id 0 seek offset 0
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
2024-11-12 05:46:58 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-12 05:46:58 - train.py[line:297] - INFO: Start iterating over samples
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
slice_id 3 seek offset 140417
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
slice_id 4 seek offset 187222
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.005237162807722498 loss_cls: 0.0030990245286375284
loss_reg: 0.007315753883172198 loss_cls: 0.00342093245126307
loss_reg: 0.008180463546359018 loss_cls: 0.0030986883211880922
loss_reg: 0.005326023935936331 loss_cls: 0.003013226669281721
loss_reg: 0.005404214156121237 loss_cls: 0.0035529006272554398
loss_reg: 0.007852660619395217 loss_cls: 0.003723947564139962
loss_reg: 0.0050581103566408455 loss_cls: 0.004001636523753405
loss_reg: 0.007148560781248867 loss_cls: 0.0031610552687197924
loss_reg: 0.004836889855282128 loss_cls: 0.0034708937164396048
loss_reg: 0.004920848603155892 loss_cls: 0.003120994893833995
loss_reg: 0.007009264192230751 loss_cls: 0.003032101783901453
loss_reg: 0.004177027151817265 loss_cls: 0.003878864226862788
loss_reg: 0.00905496903478423 loss_cls: 0.0034022575709968805
loss_reg: 0.005383267018712576 loss_cls: 0.004468834958970547
loss_reg: 0.007752846550378282 loss_cls: 0.003257914911955595
loss_reg: 0.004688894289211288 loss_cls: 0.0031776425894349813
loss_reg: 0.0046872163406017865 loss_cls: 0.003444880247116089
loss_reg: 0.00665385386386551 loss_cls: 0.0034060003235936165
loss_reg: 0.005992431531368204 loss_cls: 0.004326942842453718
loss_reg: 0.0056994287193180395 loss_cls: 0.0030807096045464277
loss_reg: 0.005199771032392918 loss_cls: 0.0038346105720847845
loss_reg: 0.0074145880980837475 loss_cls: 0.003497333498671651
loss_reg: 0.006357946432731757 loss_cls: 0.0040289671160280704
loss_reg: 0.006568770373469226 loss_cls: 0.0029725467320531607
loss_reg: 0.007111406924859787 loss_cls: 0.0050138202495872974
loss_reg: 0.005717953935121903 loss_cls: 0.0035582848358899355
loss_reg: 0.005186838062000085 loss_cls: 0.0037750983610749245
loss_reg: 0.006675794428463626 loss_cls: 0.0031372690573334694
loss_reg: 0.006767204688680329 loss_cls: 0.003450909862294793
loss_reg: 0.004966821586564279 loss_cls: 0.003924500197172165
loss_reg: 0.005665050075618302 loss_cls: 0.0030246544629335403
loss_reg: 0.005355392325838218 loss_cls: 0.003970094956457615
loss_reg: 0.00527843414787522 loss_cls: 0.005296219140291214
loss_reg: 0.004856343638933288 loss_cls: 0.005128240212798119
loss_reg: 0.005125703231437927 loss_cls: 0.004632240626960993
loss_reg: 0.004967590955093668 loss_cls: 0.0036079727578908205
loss_reg: 0.0062827373996067505 loss_cls: 0.003996437881141901
loss_reg: 0.008911685512617748 loss_cls: 0.0030407686717808247
loss_reg: 0.004316166957839112 loss_cls: 0.00423545204102993
loss_reg: 0.008039007716071429 loss_cls: 0.0030084929894655943
loss_reg: 0.0075841754135066814 loss_cls: 0.0033219715114682913
loss_reg: 0.007710590651537965 loss_cls: 0.003217857563868165
loss_reg: 0.004427484288070602 loss_cls: 0.003733979072421789
loss_reg: 0.006078044347196138 loss_cls: 0.0033125949557870626
loss_reg: 0.004664262186143967 loss_cls: 0.004021854605525732
loss_reg: 0.006906616885835765 loss_cls: 0.004363024607300758
loss_reg: 0.011457331862940073 loss_cls: 0.0032880704384297132
loss_reg: 0.005489282697691507 loss_cls: 0.004252416081726551
loss_reg: 0.005850524550930264 loss_cls: 0.003262141952291131
loss_reg: 0.004495082110284784 loss_cls: 0.0035717536229640245
loss_reg: 0.008590046442526039 loss_cls: 0.0031147561967372894
loss_reg: 0.004706213610195148 loss_cls: 0.003965812269598246
loss_reg: 0.008191854980553318 loss_cls: 0.002434222726151347
loss_reg: 0.008566748012878298 loss_cls: 0.003239895449951291
loss_reg: 0.006034630225419914 loss_cls: 0.003483545035123825
loss_reg: 0.004535283722304986 loss_cls: 0.003080825787037611
loss_reg: 0.006321293205123734 loss_cls: 0.003433658741414547
loss_reg: 0.0071848921689479945 loss_cls: 0.002730850363150239
loss_reg: 0.0056747899755203906 loss_cls: 0.004710369743406773
loss_reg: 0.009463986844977535 loss_cls: 0.003842651844024658
loss_reg: 0.006787920860364573 loss_cls: 0.0035274457186460495
loss_reg: 0.006122863705012379 loss_cls: 0.0035174409858882427
loss_reg: 0.00494358661952369 loss_cls: 0.0031065100338310003
loss_reg: 0.006333765324519838 loss_cls: 0.0034248491283506155
2024-11-12 05:47:57 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17405.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3330.2, ups=0.19, wpb=17405.4, bsz=1024, num_updates=10, lr=2.27687e-07, gnorm=0.001, clip=0, loss_scale=128, train_wall=39, gb_free=13.3, wall=223
2024-11-12 05:48:50 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17297.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3256.9, ups=0.19, wpb=17297.6, bsz=1024, num_updates=20, lr=4.55373e-07, gnorm=0.001, clip=0, loss_scale=128, train_wall=34, gb_free=13.4, wall=276
2024-11-12 05:49:44 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17074.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3162.2, ups=0.19, wpb=17074.8, bsz=1015.4, num_updates=30, lr=6.8306e-07, gnorm=0.001, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=330
2024-11-12 05:50:38 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17466.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3267.8, ups=0.19, wpb=17466.5, bsz=1024, num_updates=40, lr=9.10747e-07, gnorm=0.001, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=383
2024-11-12 05:51:31 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17539.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3273.8, ups=0.19, wpb=17539.3, bsz=1024, num_updates=50, lr=1.13843e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.1, wall=437
2024-11-12 05:52:25 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17517.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3275, ups=0.19, wpb=17517.9, bsz=1024, num_updates=60, lr=1.36612e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=490
2024-11-12 05:53:18 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17528.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3313.1, ups=0.19, wpb=17528.6, bsz=1024, num_updates=70, lr=1.59381e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=543
2024-11-12 05:54:11 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17225.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3237.7, ups=0.19, wpb=17225.3, bsz=1024, num_updates=80, lr=1.82149e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.6, wall=597
2024-11-12 05:55:04 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17554.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3321.5, ups=0.19, wpb=17554.4, bsz=1024, num_updates=90, lr=2.04918e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=649
2024-11-12 05:55:57 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17365.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3274.2, ups=0.19, wpb=17365.3, bsz=1024, num_updates=100, lr=2.27687e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=702
2024-11-12 05:56:50 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17589.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3324, ups=0.19, wpb=17589.8, bsz=1024, num_updates=110, lr=2.50455e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.2, wall=755
2024-11-12 05:57:43 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17627, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3335.8, ups=0.19, wpb=17627, bsz=1024, num_updates=120, lr=2.73224e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=808
2024-11-12 05:58:36 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17431.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3266.8, ups=0.19, wpb=17431.9, bsz=1024, num_updates=130, lr=2.95993e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=862
2024-11-12 05:59:29 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17280.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3273.7, ups=0.19, wpb=17280.5, bsz=1024, num_updates=140, lr=3.18761e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=914
2024-11-12 06:00:22 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17294.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3226.8, ups=0.19, wpb=17294.4, bsz=1024, num_updates=150, lr=3.4153e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=968
2024-11-12 06:01:15 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17416, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3302.5, ups=0.19, wpb=17416, bsz=1024, num_updates=160, lr=3.64299e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=1021
2024-11-12 06:02:09 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17448.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3225.6, ups=0.18, wpb=17448.5, bsz=1024, num_updates=170, lr=3.87067e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1075
2024-11-12 06:03:02 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17459.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3315.3, ups=0.19, wpb=17459.1, bsz=1024, num_updates=180, lr=4.09836e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1127
2024-11-12 06:03:55 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17319.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3272.2, ups=0.19, wpb=17319.2, bsz=1024, num_updates=190, lr=4.32605e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=33, gb_free=13.5, wall=1180
2024-11-12 06:04:48 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17396.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3295.1, ups=0.19, wpb=17396.1, bsz=1024, num_updates=200, lr=4.55373e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1233
2024-11-12 06:05:40 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17392.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3295, ups=0.19, wpb=17392.1, bsz=1024, num_updates=210, lr=4.78142e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1286
2024-11-12 06:06:34 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17271.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3236.2, ups=0.19, wpb=17271.7, bsz=1024, num_updates=220, lr=5.00911e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=1339
2024-11-12 06:07:27 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17428.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3281.2, ups=0.19, wpb=17428.8, bsz=1024, num_updates=230, lr=5.23679e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1392
2024-11-12 06:08:20 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17848.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3332.7, ups=0.19, wpb=17848.5, bsz=1024, num_updates=240, lr=5.46448e-06, gnorm=0.001, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1446
2024-11-12 06:09:13 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17200.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3243.2, ups=0.19, wpb=17200.3, bsz=1024, num_updates=250, lr=5.69217e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=1499
2024-11-12 06:10:07 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17416.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3266.7, ups=0.19, wpb=17416.3, bsz=1024, num_updates=260, lr=5.91985e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1552
2024-11-12 06:11:00 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17133.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3237, ups=0.19, wpb=17133.2, bsz=1024, num_updates=270, lr=6.14754e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=1605
2024-11-12 06:11:53 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17418.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3255.7, ups=0.19, wpb=17418.6, bsz=1024, num_updates=280, lr=6.37523e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1659
2024-11-12 06:12:46 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17404.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3272.3, ups=0.19, wpb=17404.3, bsz=1024, num_updates=290, lr=6.60291e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1712
2024-11-12 06:13:39 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17287.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3278.7, ups=0.19, wpb=17287.3, bsz=1024, num_updates=300, lr=6.8306e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1765
2024-11-12 06:14:31 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17739.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3418.1, ups=0.19, wpb=17739.3, bsz=1024, num_updates=310, lr=7.05829e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1817
2024-11-12 06:15:23 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17760.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3419.7, ups=0.19, wpb=17760.8, bsz=1024, num_updates=320, lr=7.28597e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1869
2024-11-12 06:16:15 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17632.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3402.7, ups=0.19, wpb=17632.1, bsz=1024, num_updates=330, lr=7.51366e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1920
2024-11-12 06:17:06 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17825, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3453.1, ups=0.19, wpb=17825, bsz=1024, num_updates=340, lr=7.74135e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=1972
2024-11-12 06:17:58 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17545.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3410.8, ups=0.19, wpb=17545.6, bsz=1024, num_updates=350, lr=7.96903e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2023
2024-11-12 06:18:50 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17874.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3436.7, ups=0.19, wpb=17874.1, bsz=1024, num_updates=360, lr=8.19672e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=2075
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-12 06:19:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 366 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-12 06:19:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory: No such file or directory


cp: cp: cp: cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'cp: : No such file or directory: No such file or directory: No such file or directorycannot stat './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt'


: No such file or directory
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 06:19:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 06:19:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 366 updates, score 0) (writing took 22.473848517984152 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-12 06:19:47 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-12 06:19:47 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.68 | ntokens 17447.5 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.41 | wps 3254.1 | ups 0.19 | wpb 17447.5 | bsz 1023.1 | num_updates 366 | lr 8.33333e-06 | gnorm 0.002 | clip 0 | loss_scale 128 | train_wall 1136 | gb_free 13.4 | wall 2133
2024-11-12 06:19:47 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 06:22:17 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-12 06:22:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 06:22:41 - progress_bar.py[line:274] - INFO: epoch 002:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17171.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=743.3, ups=0.04, wpb=17171.5, bsz=998.4, num_updates=370, lr=8.42441e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2306
2024-11-12 06:23:33 - progress_bar.py[line:274] - INFO: epoch 002:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17276.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3280.7, ups=0.19, wpb=17276.8, bsz=1024, num_updates=380, lr=8.65209e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.2, wall=2359
2024-11-12 06:24:26 - progress_bar.py[line:274] - INFO: epoch 002:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17550.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3337.5, ups=0.19, wpb=17550.6, bsz=1024, num_updates=390, lr=8.87978e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.6, wall=2412
2024-11-12 06:25:19 - progress_bar.py[line:274] - INFO: epoch 002:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17533, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3324.8, ups=0.19, wpb=17533, bsz=1024, num_updates=400, lr=9.10747e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.2, wall=2464
2024-11-12 06:26:11 - progress_bar.py[line:274] - INFO: epoch 002:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17467.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3317.4, ups=0.19, wpb=17467.7, bsz=1024, num_updates=410, lr=9.33515e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2517
2024-11-12 06:27:05 - progress_bar.py[line:274] - INFO: epoch 002:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17446.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3284.6, ups=0.19, wpb=17446.6, bsz=1024, num_updates=420, lr=9.56284e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=2570
2024-11-12 06:27:58 - progress_bar.py[line:274] - INFO: epoch 002:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17466.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3299.6, ups=0.19, wpb=17466.1, bsz=1024, num_updates=430, lr=9.79053e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2623
2024-11-12 06:28:50 - progress_bar.py[line:274] - INFO: epoch 002:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17551.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3319.3, ups=0.19, wpb=17551.2, bsz=1024, num_updates=440, lr=1.00182e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2676
2024-11-12 06:29:44 - progress_bar.py[line:274] - INFO: epoch 002:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17492.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3285.9, ups=0.19, wpb=17492.7, bsz=1024, num_updates=450, lr=1.02459e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2729
2024-11-12 06:30:36 - progress_bar.py[line:274] - INFO: epoch 002:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17572.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3326.1, ups=0.19, wpb=17572.9, bsz=1024, num_updates=460, lr=1.04736e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2782
2024-11-12 06:31:30 - progress_bar.py[line:274] - INFO: epoch 002:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17468.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3293, ups=0.19, wpb=17468.7, bsz=1024, num_updates=470, lr=1.07013e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2835
2024-11-12 06:32:23 - progress_bar.py[line:274] - INFO: epoch 002:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17672.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3300.1, ups=0.19, wpb=17672.2, bsz=1024, num_updates=480, lr=1.0929e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2889
2024-11-12 06:33:16 - progress_bar.py[line:274] - INFO: epoch 002:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3265.1, ups=0.19, wpb=17424.2, bsz=1024, num_updates=490, lr=1.11566e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2942
2024-11-12 06:34:09 - progress_bar.py[line:274] - INFO: epoch 002:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17313, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3272.1, ups=0.19, wpb=17313, bsz=1024, num_updates=500, lr=1.13843e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2995
2024-11-12 06:35:03 - progress_bar.py[line:274] - INFO: epoch 002:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17520.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3242.7, ups=0.19, wpb=17520.1, bsz=1024, num_updates=510, lr=1.1612e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=3049
2024-11-12 06:35:57 - progress_bar.py[line:274] - INFO: epoch 002:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17647.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3270.1, ups=0.19, wpb=17647.7, bsz=1024, num_updates=520, lr=1.18397e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3103
2024-11-12 06:36:52 - progress_bar.py[line:274] - INFO: epoch 002:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17170.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3144.9, ups=0.18, wpb=17170.9, bsz=1024, num_updates=530, lr=1.20674e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=3158
2024-11-12 06:37:46 - progress_bar.py[line:274] - INFO: epoch 002:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17321.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3230.3, ups=0.19, wpb=17321.9, bsz=1015.4, num_updates=540, lr=1.22951e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3211
2024-11-12 06:38:40 - progress_bar.py[line:274] - INFO: epoch 002:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17509.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3244.6, ups=0.19, wpb=17509.8, bsz=1024, num_updates=550, lr=1.25228e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=3265
2024-11-12 06:39:33 - progress_bar.py[line:274] - INFO: epoch 002:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17214.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3199.8, ups=0.19, wpb=17214.3, bsz=1024, num_updates=560, lr=1.27505e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3319
2024-11-12 06:40:27 - progress_bar.py[line:274] - INFO: epoch 002:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17416.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3251.5, ups=0.19, wpb=17416.4, bsz=1024, num_updates=570, lr=1.29781e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=3373
2024-11-12 06:41:20 - progress_bar.py[line:274] - INFO: epoch 002:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17242.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3232.2, ups=0.19, wpb=17242.1, bsz=1024, num_updates=580, lr=1.32058e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3426
2024-11-12 06:42:14 - progress_bar.py[line:274] - INFO: epoch 002:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17668.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3274.5, ups=0.19, wpb=17668.7, bsz=1024, num_updates=590, lr=1.34335e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3480
2024-11-12 06:43:08 - progress_bar.py[line:274] - INFO: epoch 002:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3255.4, ups=0.19, wpb=17372.7, bsz=1024, num_updates=600, lr=1.36612e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3533
2024-11-12 06:44:02 - progress_bar.py[line:274] - INFO: epoch 002:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17427.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3185, ups=0.18, wpb=17427.7, bsz=1024, num_updates=610, lr=1.38889e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3588
2024-11-12 06:44:57 - progress_bar.py[line:274] - INFO: epoch 002:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17235.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3157.6, ups=0.18, wpb=17235.9, bsz=1024, num_updates=620, lr=1.41166e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3643
2024-11-12 06:45:52 - progress_bar.py[line:274] - INFO: epoch 002:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17311.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3137.1, ups=0.18, wpb=17311.6, bsz=1024, num_updates=630, lr=1.43443e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=3698
2024-11-12 06:46:46 - progress_bar.py[line:274] - INFO: epoch 002:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3200.2, ups=0.18, wpb=17400.1, bsz=1024, num_updates=640, lr=1.45719e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3752
2024-11-12 06:47:42 - progress_bar.py[line:274] - INFO: epoch 002:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17065.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3079, ups=0.18, wpb=17065.9, bsz=1024, num_updates=650, lr=1.47996e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=3807
2024-11-12 06:48:37 - progress_bar.py[line:274] - INFO: epoch 002:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17271.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3116.4, ups=0.18, wpb=17271.7, bsz=1024, num_updates=660, lr=1.50273e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=3863
2024-11-12 06:49:32 - progress_bar.py[line:274] - INFO: epoch 002:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17618.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3233, ups=0.18, wpb=17618.4, bsz=1024, num_updates=670, lr=1.5255e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=3917
2024-11-12 06:50:26 - progress_bar.py[line:274] - INFO: epoch 002:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17342.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3202.3, ups=0.18, wpb=17342.4, bsz=1024, num_updates=680, lr=1.54827e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=3972
2024-11-12 06:51:21 - progress_bar.py[line:274] - INFO: epoch 002:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17701, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3241.2, ups=0.18, wpb=17701, bsz=1024, num_updates=690, lr=1.57104e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=4026
2024-11-12 06:52:16 - progress_bar.py[line:274] - INFO: epoch 002:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17715.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3202.4, ups=0.18, wpb=17715.2, bsz=1024, num_updates=700, lr=1.59381e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.1, wall=4082
2024-11-12 06:53:11 - progress_bar.py[line:274] - INFO: epoch 002:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17681.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3207.1, ups=0.18, wpb=17681.7, bsz=1024, num_updates=710, lr=1.61658e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=4137
2024-11-12 06:54:06 - progress_bar.py[line:274] - INFO: epoch 002:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17555.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3173.5, ups=0.18, wpb=17555.3, bsz=1024, num_updates=720, lr=1.63934e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.2, wall=4192
2024-11-12 06:55:01 - progress_bar.py[line:274] - INFO: epoch 002:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17542, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3183.4, ups=0.18, wpb=17542, bsz=1024, num_updates=730, lr=1.66211e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4247
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt2024-11-12 06:55:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 732 updates



cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-12 06:55:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 06:57:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
2024-11-12 06:58:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 732 updates, score 0) (writing took 222.12725621601567 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-12 06:59:47 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-12 06:59:47 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.687 | ntokens 17439 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.44 | wps 2659.8 | ups 0.15 | wpb 17439 | bsz 1023.1 | num_updates 732 | lr 1.66667e-05 | gnorm 0.004 | clip 0 | loss_scale 256 | train_wall 1117 | gb_free 13.4 | wall 4532
2024-11-12 06:59:47 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 07:02:17 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-12 07:02:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 07:03:04 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17038.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=353.1, ups=0.02, wpb=17038.7, bsz=998.4, num_updates=740, lr=1.68488e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=4730
2024-11-12 07:04:01 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17349.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3036.2, ups=0.18, wpb=17349.6, bsz=1024, num_updates=750, lr=1.70765e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=4787
2024-11-12 07:04:58 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17432.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3053.1, ups=0.18, wpb=17432.1, bsz=1024, num_updates=760, lr=1.73042e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=4844
2024-11-12 07:05:55 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17425.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3056.7, ups=0.18, wpb=17425.6, bsz=1024, num_updates=770, lr=1.75319e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=4901
2024-11-12 07:06:52 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17323.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3052.1, ups=0.18, wpb=17323.7, bsz=1024, num_updates=780, lr=1.77596e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=4958
2024-11-12 07:07:49 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17267, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3039.5, ups=0.18, wpb=17267, bsz=1024, num_updates=790, lr=1.79872e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5014
2024-11-12 07:08:46 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17278.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3042.6, ups=0.18, wpb=17278.2, bsz=1024, num_updates=800, lr=1.82149e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5071
2024-11-12 07:09:42 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17289.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3085.1, ups=0.18, wpb=17289.6, bsz=1015.4, num_updates=810, lr=1.84426e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5127
2024-11-12 07:10:39 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17533.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3057.4, ups=0.17, wpb=17533.4, bsz=1024, num_updates=820, lr=1.86703e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.1, wall=5185
2024-11-12 07:11:36 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17506, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3056.7, ups=0.17, wpb=17506, bsz=1024, num_updates=830, lr=1.8898e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5242
2024-11-12 07:12:33 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17445.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3067.9, ups=0.18, wpb=17445.1, bsz=1024, num_updates=840, lr=1.91257e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5299
2024-11-12 07:13:31 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17343.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2997.6, ups=0.17, wpb=17343.2, bsz=1024, num_updates=850, lr=1.93534e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5357
2024-11-12 07:14:28 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3010.6, ups=0.17, wpb=17269.4, bsz=1024, num_updates=860, lr=1.95811e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=5414
2024-11-12 07:15:26 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17251, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2984.9, ups=0.17, wpb=17251, bsz=1024, num_updates=870, lr=1.98087e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=5472
2024-11-12 07:16:23 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17382.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3050.4, ups=0.18, wpb=17382.5, bsz=1024, num_updates=880, lr=2.00364e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5529
2024-11-12 07:17:20 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3064.2, ups=0.17, wpb=17525.8, bsz=1024, num_updates=890, lr=2.02641e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.1, wall=5586
2024-11-12 07:18:18 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17485.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3048.6, ups=0.17, wpb=17485.3, bsz=1024, num_updates=900, lr=2.04918e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5643
2024-11-12 07:19:15 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17432.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3032.3, ups=0.17, wpb=17432.2, bsz=1024, num_updates=910, lr=2.07195e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=5701
2024-11-12 07:20:12 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17009.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3009.3, ups=0.18, wpb=17009.1, bsz=1024, num_updates=920, lr=2.09472e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5757
2024-11-12 07:21:09 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17408.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3048.1, ups=0.18, wpb=17408.9, bsz=1024, num_updates=930, lr=2.11749e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=5814
2024-11-12 07:22:06 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17576.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3074.7, ups=0.17, wpb=17576.9, bsz=1024, num_updates=940, lr=2.14026e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5872
2024-11-12 07:23:03 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17387.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3030.7, ups=0.17, wpb=17387.5, bsz=1024, num_updates=950, lr=2.16302e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5929
2024-11-12 07:24:00 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17293.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3047, ups=0.18, wpb=17293.8, bsz=1024, num_updates=960, lr=2.18579e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5986
2024-11-12 07:24:57 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17393, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3067.7, ups=0.18, wpb=17393, bsz=1024, num_updates=970, lr=2.20856e-05, gnorm=0.007, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=6042
2024-11-12 07:25:55 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17201.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=2977.4, ups=0.17, wpb=17201.7, bsz=1024, num_updates=980, lr=2.23133e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=6100
2024-11-12 07:26:52 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17274.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3003.6, ups=0.17, wpb=17274.9, bsz=1024, num_updates=990, lr=2.2541e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=6158
2024-11-12 07:27:50 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17093.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=2956.5, ups=0.17, wpb=17093.5, bsz=1024, num_updates=1000, lr=2.27687e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=6216
2024-11-12 07:28:47 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17373.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3044.7, ups=0.18, wpb=17373.1, bsz=1024, num_updates=1010, lr=2.29964e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=6273
2024-11-12 07:29:45 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3004, ups=0.17, wpb=17298.6, bsz=1024, num_updates=1020, lr=2.3224e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=6330
2024-11-12 07:30:41 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17401.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3076.6, ups=0.18, wpb=17401.7, bsz=1024, num_updates=1030, lr=2.34517e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6387
2024-11-12 07:31:37 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17327.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3118.9, ups=0.18, wpb=17327.7, bsz=1024, num_updates=1040, lr=2.36794e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6442
2024-11-12 07:32:33 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17740.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3143, ups=0.18, wpb=17740.1, bsz=1024, num_updates=1050, lr=2.39071e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=6499
2024-11-12 07:33:29 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17709.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3168.7, ups=0.18, wpb=17709.5, bsz=1024, num_updates=1060, lr=2.41348e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=6555
2024-11-12 07:34:23 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17336.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3196, ups=0.18, wpb=17336.2, bsz=1024, num_updates=1070, lr=2.43625e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=6609
2024-11-12 07:35:19 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17808, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3206.2, ups=0.18, wpb=17808, bsz=1024, num_updates=1080, lr=2.45902e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=31, gb_free=13.2, wall=6664
2024-11-12 07:36:16 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17640.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3071.8, ups=0.17, wpb=17640.3, bsz=1024, num_updates=1090, lr=2.48179e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=6722
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-12 07:36:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1098 updates
2024-11-12 07:36:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 07:38:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 07:40:42 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1098 updates, score 0) (writing took 223.08365542301908 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 07:41:37 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-12 07:41:37 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.688 | ntokens 17384.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.44 | wps 2534.8 | ups 0.15 | wpb 17384.7 | bsz 1023.1 | num_updates 1098 | lr 2.5e-05 | gnorm 0.004 | clip 0 | loss_scale 512 | train_wall 1127 | gb_free 13.5 | wall 7043
2024-11-12 07:41:37 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 07:44:08 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-12 07:44:08 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 07:44:21 - progress_bar.py[line:274] - INFO: epoch 004:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17054.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=351.5, ups=0.02, wpb=17054.8, bsz=998.4, num_updates=1100, lr=2.50455e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7207
2024-11-12 07:45:17 - progress_bar.py[line:274] - INFO: epoch 004:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17260.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3120.3, ups=0.18, wpb=17260.2, bsz=1024, num_updates=1110, lr=2.52732e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7262
2024-11-12 07:46:09 - progress_bar.py[line:274] - INFO: epoch 004:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17719.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3366, ups=0.19, wpb=17719.6, bsz=1024, num_updates=1120, lr=2.55009e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7315
2024-11-12 07:47:03 - progress_bar.py[line:274] - INFO: epoch 004:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17328.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3254.7, ups=0.19, wpb=17328.8, bsz=1024, num_updates=1130, lr=2.57286e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7368
2024-11-12 07:47:55 - progress_bar.py[line:274] - INFO: epoch 004:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17540.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3353.2, ups=0.19, wpb=17540.2, bsz=1024, num_updates=1140, lr=2.59563e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=7421
2024-11-12 07:48:48 - progress_bar.py[line:274] - INFO: epoch 004:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17241, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3264.8, ups=0.19, wpb=17241, bsz=1024, num_updates=1150, lr=2.6184e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7473
2024-11-12 07:49:41 - progress_bar.py[line:274] - INFO: epoch 004:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17289.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3280.5, ups=0.19, wpb=17289.1, bsz=1024, num_updates=1160, lr=2.64117e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7526
2024-11-12 07:50:34 - progress_bar.py[line:274] - INFO: epoch 004:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17301.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3257.4, ups=0.19, wpb=17301.2, bsz=1024, num_updates=1170, lr=2.66393e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=7579
2024-11-12 07:51:26 - progress_bar.py[line:274] - INFO: epoch 004:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17497.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3313.3, ups=0.19, wpb=17497.2, bsz=1024, num_updates=1180, lr=2.6867e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7632
2024-11-12 07:52:19 - progress_bar.py[line:274] - INFO: epoch 004:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17667.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3380.5, ups=0.19, wpb=17667.4, bsz=1024, num_updates=1190, lr=2.70947e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7684
2024-11-12 07:53:11 - progress_bar.py[line:274] - INFO: epoch 004:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17358.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3289.7, ups=0.19, wpb=17358.1, bsz=1024, num_updates=1200, lr=2.73224e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=7737
2024-11-12 07:54:05 - progress_bar.py[line:274] - INFO: epoch 004:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17615, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3304.9, ups=0.19, wpb=17615, bsz=1024, num_updates=1210, lr=2.75501e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7790
2024-11-12 07:54:57 - progress_bar.py[line:274] - INFO: epoch 004:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3312.1, ups=0.19, wpb=17422.9, bsz=1024, num_updates=1220, lr=2.77778e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=7843
2024-11-12 07:55:50 - progress_bar.py[line:274] - INFO: epoch 004:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17386.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3322.5, ups=0.19, wpb=17386.4, bsz=1024, num_updates=1230, lr=2.80055e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7895
2024-11-12 07:56:43 - progress_bar.py[line:274] - INFO: epoch 004:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17358.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3271.9, ups=0.19, wpb=17358.5, bsz=1024, num_updates=1240, lr=2.82332e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=7948
2024-11-12 07:57:36 - progress_bar.py[line:274] - INFO: epoch 004:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17250.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3237.8, ups=0.19, wpb=17250.8, bsz=1024, num_updates=1250, lr=2.84608e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=8002
2024-11-12 07:58:29 - progress_bar.py[line:274] - INFO: epoch 004:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17313.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3288, ups=0.19, wpb=17313.2, bsz=1024, num_updates=1260, lr=2.86885e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=8054
2024-11-12 07:59:22 - progress_bar.py[line:274] - INFO: epoch 004:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17526.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3293.6, ups=0.19, wpb=17526.1, bsz=1024, num_updates=1270, lr=2.89162e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=8108
2024-11-12 08:00:15 - progress_bar.py[line:274] - INFO: epoch 004:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17366.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3297.2, ups=0.19, wpb=17366.7, bsz=1024, num_updates=1280, lr=2.91439e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8160
2024-11-12 08:01:07 - progress_bar.py[line:274] - INFO: epoch 004:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17359.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3334.9, ups=0.19, wpb=17359.6, bsz=1015.4, num_updates=1290, lr=2.93716e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8212
2024-11-12 08:01:59 - progress_bar.py[line:274] - INFO: epoch 004:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17534.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3331, ups=0.19, wpb=17534.9, bsz=1024, num_updates=1300, lr=2.95993e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8265
2024-11-12 08:02:52 - progress_bar.py[line:274] - INFO: epoch 004:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17246.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3270.3, ups=0.19, wpb=17246.5, bsz=1024, num_updates=1310, lr=2.9827e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8318
2024-11-12 08:03:44 - progress_bar.py[line:274] - INFO: epoch 004:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17481.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3334.1, ups=0.19, wpb=17481.2, bsz=1024, num_updates=1320, lr=3.00546e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8370
2024-11-12 08:04:37 - progress_bar.py[line:274] - INFO: epoch 004:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17414, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3303.3, ups=0.19, wpb=17414, bsz=1024, num_updates=1330, lr=3.02823e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8423
2024-11-12 08:05:30 - progress_bar.py[line:274] - INFO: epoch 004:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17615.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3357.9, ups=0.19, wpb=17615.2, bsz=1024, num_updates=1340, lr=3.051e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.2, wall=8475
2024-11-12 08:06:22 - progress_bar.py[line:274] - INFO: epoch 004:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17118.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3251.2, ups=0.19, wpb=17118.3, bsz=1024, num_updates=1350, lr=3.07377e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8528
2024-11-12 08:07:15 - progress_bar.py[line:274] - INFO: epoch 004:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17490.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3334.6, ups=0.19, wpb=17490.3, bsz=1024, num_updates=1360, lr=3.09654e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8580
2024-11-12 08:08:08 - progress_bar.py[line:274] - INFO: epoch 004:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17425.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3299.5, ups=0.19, wpb=17425.7, bsz=1024, num_updates=1370, lr=3.11931e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.2, wall=8633
2024-11-12 08:09:00 - progress_bar.py[line:274] - INFO: epoch 004:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17250.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3278.4, ups=0.19, wpb=17250.5, bsz=1024, num_updates=1380, lr=3.14208e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8686
2024-11-12 08:09:53 - progress_bar.py[line:274] - INFO: epoch 004:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17360.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3312.6, ups=0.19, wpb=17360.6, bsz=1024, num_updates=1390, lr=3.16485e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=8738
2024-11-12 08:10:45 - progress_bar.py[line:274] - INFO: epoch 004:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17209, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3303.9, ups=0.19, wpb=17209, bsz=1024, num_updates=1400, lr=3.18761e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8790
2024-11-12 08:11:36 - progress_bar.py[line:274] - INFO: epoch 004:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17523.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3410.1, ups=0.19, wpb=17523.7, bsz=1024, num_updates=1410, lr=3.21038e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8842
2024-11-12 08:12:28 - progress_bar.py[line:274] - INFO: epoch 004:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17427.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3374.1, ups=0.19, wpb=17427.5, bsz=1024, num_updates=1420, lr=3.23315e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8893
2024-11-12 08:13:19 - progress_bar.py[line:274] - INFO: epoch 004:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17341.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3347.9, ups=0.19, wpb=17341.7, bsz=1024, num_updates=1430, lr=3.25592e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=8945
2024-11-12 08:14:12 - progress_bar.py[line:274] - INFO: epoch 004:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17348.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3330.7, ups=0.19, wpb=17348.6, bsz=1024, num_updates=1440, lr=3.27869e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=8997
2024-11-12 08:15:03 - progress_bar.py[line:274] - INFO: epoch 004:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17533.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3387.8, ups=0.19, wpb=17533.2, bsz=1024, num_updates=1450, lr=3.30146e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=9049
2024-11-12 08:15:55 - progress_bar.py[line:274] - INFO: epoch 004:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17584.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3404.5, ups=0.19, wpb=17584.7, bsz=1024, num_updates=1460, lr=3.32423e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=32, gb_free=13.4, wall=9101
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
2024-11-12 08:16:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1464 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt

2024-11-12 08:16:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 08:18:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
2024-11-12 08:19:58 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1464 updates, score 0) (writing took 224.3705339190783 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

slice_id 5 seek offset 234027
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 7 seek offset 327637
2024-11-12 08:20:53 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-12 08:20:53 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.697 | ntokens 17403.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.48 | wps 2703.6 | ups 0.16 | wpb 17403.2 | bsz 1023.1 | num_updates 1464 | lr 3.33333e-05 | gnorm 0.005 | clip 0 | loss_scale 512 | train_wall 1121 | gb_free 13.5 | wall 9399
2024-11-12 08:20:53 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 08:23:23 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-12 08:23:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 08:23:57 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=16921.7, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=351.1, ups=0.02, wpb=16921.7, bsz=989.8, num_updates=1470, lr=3.34699e-05, gnorm=0.009, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=9583
2024-11-12 08:24:50 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=17498.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3331.6, ups=0.19, wpb=17498.9, bsz=1024, num_updates=1480, lr=3.36976e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=31, gb_free=13.6, wall=9635
2024-11-12 08:25:42 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17281.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3282.7, ups=0.19, wpb=17281.5, bsz=1024, num_updates=1490, lr=3.39253e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9688
2024-11-12 08:26:35 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17268.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3288.3, ups=0.19, wpb=17268.4, bsz=1024, num_updates=1500, lr=3.4153e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=9740
2024-11-12 08:27:27 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17476.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3350.7, ups=0.19, wpb=17476.7, bsz=1024, num_updates=1510, lr=3.43807e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9792
2024-11-12 08:28:20 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17560, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3304.8, ups=0.19, wpb=17560, bsz=1024, num_updates=1520, lr=3.46084e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9846
2024-11-12 08:29:13 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17576.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3331.8, ups=0.19, wpb=17576.3, bsz=1024, num_updates=1530, lr=3.48361e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=9898
2024-11-12 08:30:05 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17231.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3298.1, ups=0.19, wpb=17231.9, bsz=1024, num_updates=1540, lr=3.50638e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=9951
2024-11-12 08:30:58 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17724.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3365.7, ups=0.19, wpb=17724.9, bsz=1024, num_updates=1550, lr=3.52914e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10003
2024-11-12 08:31:50 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17588.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3349.2, ups=0.19, wpb=17588.8, bsz=1024, num_updates=1560, lr=3.55191e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=10056
2024-11-12 08:32:43 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3292.7, ups=0.19, wpb=17400.1, bsz=1024, num_updates=1570, lr=3.57468e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10109
2024-11-12 08:33:36 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17530.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3313, ups=0.19, wpb=17530.2, bsz=1024, num_updates=1580, lr=3.59745e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10162
2024-11-12 08:34:28 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17566.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3350.5, ups=0.19, wpb=17566.6, bsz=1024, num_updates=1590, lr=3.62022e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=10214
2024-11-12 08:35:21 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17491.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3344.9, ups=0.19, wpb=17491.2, bsz=1024, num_updates=1600, lr=3.64299e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10266
2024-11-12 08:36:13 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17519.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3348.2, ups=0.19, wpb=17519.6, bsz=1024, num_updates=1610, lr=3.66576e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10319
2024-11-12 08:37:06 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17190.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3247.9, ups=0.19, wpb=17190.7, bsz=1024, num_updates=1620, lr=3.68852e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10372
2024-11-12 08:38:00 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17237, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3211.6, ups=0.19, wpb=17237, bsz=1024, num_updates=1630, lr=3.71129e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=31, gb_free=13.2, wall=10425
2024-11-12 08:38:52 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17229.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3281.5, ups=0.19, wpb=17229.3, bsz=1024, num_updates=1640, lr=3.73406e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10478
2024-11-12 08:39:45 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17279.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3273.8, ups=0.19, wpb=17279.5, bsz=1024, num_updates=1650, lr=3.75683e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10530
2024-11-12 08:40:38 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17347.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3294.5, ups=0.19, wpb=17347.6, bsz=1024, num_updates=1660, lr=3.7796e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10583
2024-11-12 08:41:30 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17330.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3286.8, ups=0.19, wpb=17330.9, bsz=1024, num_updates=1670, lr=3.80237e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13, wall=10636
2024-11-12 08:42:23 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17372, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3310, ups=0.19, wpb=17372, bsz=1024, num_updates=1680, lr=3.82514e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=31, gb_free=13.2, wall=10688
2024-11-12 08:43:16 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17506, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3285.2, ups=0.19, wpb=17506, bsz=1024, num_updates=1690, lr=3.84791e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10742
2024-11-12 08:44:08 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17475.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3339.6, ups=0.19, wpb=17475.1, bsz=1024, num_updates=1700, lr=3.87067e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10794
2024-11-12 08:45:01 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17306, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3308, ups=0.19, wpb=17306, bsz=1024, num_updates=1710, lr=3.89344e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10846
2024-11-12 08:45:54 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17232.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3238.2, ups=0.19, wpb=17232.7, bsz=1024, num_updates=1720, lr=3.91621e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10900
2024-11-12 08:46:48 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17336.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3225.9, ups=0.19, wpb=17336.4, bsz=1024, num_updates=1730, lr=3.93898e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10953
2024-11-12 08:47:41 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17328.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3260.9, ups=0.19, wpb=17328.9, bsz=1024, num_updates=1740, lr=3.96175e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11006
2024-11-12 08:48:34 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17206, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3251.7, ups=0.19, wpb=17206, bsz=1024, num_updates=1750, lr=3.98452e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11059
2024-11-12 08:49:26 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17473.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3345.5, ups=0.19, wpb=17473.1, bsz=1024, num_updates=1760, lr=4.00729e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=11112
2024-11-12 08:50:18 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17505.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3334.2, ups=0.19, wpb=17505.9, bsz=1024, num_updates=1770, lr=4.03005e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11164
2024-11-12 08:51:10 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17692.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3408.9, ups=0.19, wpb=17692.6, bsz=1024, num_updates=1780, lr=4.05282e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11216
2024-11-12 08:52:03 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17691.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3379.6, ups=0.19, wpb=17691.5, bsz=1024, num_updates=1790, lr=4.07559e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=11268
2024-11-12 08:52:55 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17422.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3336.5, ups=0.19, wpb=17422.2, bsz=1024, num_updates=1800, lr=4.09836e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.2, wall=11321
2024-11-12 08:53:47 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17643.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3413, ups=0.19, wpb=17643.8, bsz=1024, num_updates=1810, lr=4.12113e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=11372
2024-11-12 08:54:39 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17689.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3377.1, ups=0.19, wpb=17689.5, bsz=1024, num_updates=1820, lr=4.1439e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=33, gb_free=13.2, wall=11425
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-12 08:55:29 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=16890.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3365.9, ups=0.2, wpb=16890.1, bsz=998.4, num_updates=1830, lr=4.16667e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=43, gb_free=13.5, wall=11475
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
2024-11-12 08:55:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1830 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
2024-11-12 08:55:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 08:57:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
2024-11-12 08:59:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1830 updates, score 0) (writing took 225.72589703998528 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 09:00:10 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-12 09:00:10 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.708 | ntokens 17413.3 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.54 | wps 2704.2 | ups 0.16 | wpb 17413.3 | bsz 1023.1 | num_updates 1830 | lr 4.16667e-05 | gnorm 0.007 | clip 0 | loss_scale 1024 | train_wall 1132 | gb_free 13.5 | wall 11756
2024-11-12 09:00:10 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 09:02:40 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-12 09:02:40 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 09:03:35 - progress_bar.py[line:274] - INFO: epoch 006:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17296.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=355.9, ups=0.02, wpb=17296.5, bsz=1024, num_updates=1840, lr=4.18944e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11961
2024-11-12 09:04:28 - progress_bar.py[line:274] - INFO: epoch 006:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17399.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3277.5, ups=0.19, wpb=17399.4, bsz=1024, num_updates=1850, lr=4.2122e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12014
2024-11-12 09:05:21 - progress_bar.py[line:274] - INFO: epoch 006:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17116, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3228.7, ups=0.19, wpb=17116, bsz=1024, num_updates=1860, lr=4.23497e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=12067
2024-11-12 09:06:14 - progress_bar.py[line:274] - INFO: epoch 006:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17727.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3346, ups=0.19, wpb=17727.4, bsz=1024, num_updates=1870, lr=4.25774e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12120
2024-11-12 09:07:07 - progress_bar.py[line:274] - INFO: epoch 006:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17271.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3286, ups=0.19, wpb=17271.3, bsz=1024, num_updates=1880, lr=4.28051e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=12172
2024-11-12 09:08:00 - progress_bar.py[line:274] - INFO: epoch 006:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17184.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3217.6, ups=0.19, wpb=17184.8, bsz=1024, num_updates=1890, lr=4.30328e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=12226
2024-11-12 09:08:53 - progress_bar.py[line:274] - INFO: epoch 006:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17293.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3295.1, ups=0.19, wpb=17293.5, bsz=1024, num_updates=1900, lr=4.32605e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=12278
2024-11-12 09:09:45 - progress_bar.py[line:274] - INFO: epoch 006:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17348.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3284.8, ups=0.19, wpb=17348.1, bsz=1024, num_updates=1910, lr=4.34882e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12331
2024-11-12 09:10:39 - progress_bar.py[line:274] - INFO: epoch 006:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3266.2, ups=0.19, wpb=17448.4, bsz=1024, num_updates=1920, lr=4.37158e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=12385
2024-11-12 09:11:32 - progress_bar.py[line:274] - INFO: epoch 006:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17190.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3257.2, ups=0.19, wpb=17190.8, bsz=1024, num_updates=1930, lr=4.39435e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12437
2024-11-12 09:12:25 - progress_bar.py[line:274] - INFO: epoch 006:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17553.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3293.5, ups=0.19, wpb=17553.6, bsz=1024, num_updates=1940, lr=4.41712e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12491
2024-11-12 09:13:18 - progress_bar.py[line:274] - INFO: epoch 006:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17262.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3282, ups=0.19, wpb=17262.8, bsz=1024, num_updates=1950, lr=4.43989e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12543
2024-11-12 09:14:10 - progress_bar.py[line:274] - INFO: epoch 006:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17154.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3263.4, ups=0.19, wpb=17154.7, bsz=1024, num_updates=1960, lr=4.46266e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12596
2024-11-12 09:15:03 - progress_bar.py[line:274] - INFO: epoch 006:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3302.8, ups=0.19, wpb=17370.2, bsz=1024, num_updates=1970, lr=4.48543e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.3, wall=12648
2024-11-12 09:15:55 - progress_bar.py[line:274] - INFO: epoch 006:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17658.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3358.2, ups=0.19, wpb=17658.6, bsz=1024, num_updates=1980, lr=4.5082e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12701
2024-11-12 09:16:49 - progress_bar.py[line:274] - INFO: epoch 006:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17308.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3238, ups=0.19, wpb=17308.1, bsz=1024, num_updates=1990, lr=4.53097e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=12754
2024-11-12 09:17:42 - progress_bar.py[line:274] - INFO: epoch 006:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17328.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3259.6, ups=0.19, wpb=17328.9, bsz=1024, num_updates=2000, lr=4.55373e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=12808
2024-11-12 09:18:35 - progress_bar.py[line:274] - INFO: epoch 006:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17558.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3302.6, ups=0.19, wpb=17558.6, bsz=1024, num_updates=2010, lr=4.5765e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=12861
2024-11-12 09:19:29 - progress_bar.py[line:274] - INFO: epoch 006:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17041.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3190.5, ups=0.19, wpb=17041.3, bsz=1024, num_updates=2020, lr=4.59927e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12914
2024-11-12 09:20:21 - progress_bar.py[line:274] - INFO: epoch 006:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17790, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3375, ups=0.19, wpb=17790, bsz=1024, num_updates=2030, lr=4.62204e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12967
2024-11-12 09:21:14 - progress_bar.py[line:274] - INFO: epoch 006:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3285.3, ups=0.19, wpb=17268.7, bsz=1024, num_updates=2040, lr=4.64481e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=13019
2024-11-12 09:22:06 - progress_bar.py[line:274] - INFO: epoch 006:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17333.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3311.1, ups=0.19, wpb=17333.4, bsz=1015.4, num_updates=2050, lr=4.66758e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13072
2024-11-12 09:23:01 - progress_bar.py[line:274] - INFO: epoch 006:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17262.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3132.7, ups=0.18, wpb=17262.7, bsz=1024, num_updates=2060, lr=4.69035e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13127
2024-11-12 09:23:54 - progress_bar.py[line:274] - INFO: epoch 006:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17390.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3303.5, ups=0.19, wpb=17390.1, bsz=1024, num_updates=2070, lr=4.71311e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=13180
2024-11-12 09:24:46 - progress_bar.py[line:274] - INFO: epoch 006:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17466.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3332, ups=0.19, wpb=17466.8, bsz=1024, num_updates=2080, lr=4.73588e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=31, gb_free=13.3, wall=13232
2024-11-12 09:25:38 - progress_bar.py[line:274] - INFO: epoch 006:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17636.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3385.6, ups=0.19, wpb=17636.8, bsz=1024, num_updates=2090, lr=4.75865e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13284
2024-11-12 09:26:30 - progress_bar.py[line:274] - INFO: epoch 006:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17086.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3283.9, ups=0.19, wpb=17086.4, bsz=1024, num_updates=2100, lr=4.78142e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=13336
2024-11-12 09:27:24 - progress_bar.py[line:274] - INFO: epoch 006:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17394.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3269, ups=0.19, wpb=17394.3, bsz=1024, num_updates=2110, lr=4.80419e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=13389
2024-11-12 09:28:17 - progress_bar.py[line:274] - INFO: epoch 006:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17347.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3253.1, ups=0.19, wpb=17347.3, bsz=1024, num_updates=2120, lr=4.82696e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=13443
2024-11-12 09:29:10 - progress_bar.py[line:274] - INFO: epoch 006:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17295.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3259.5, ups=0.19, wpb=17295.2, bsz=1024, num_updates=2130, lr=4.84973e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=13496
2024-11-12 09:30:03 - progress_bar.py[line:274] - INFO: epoch 006:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17566, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3320.5, ups=0.19, wpb=17566, bsz=1024, num_updates=2140, lr=4.8725e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=34, gb_free=13.2, wall=13549
2024-11-12 09:30:56 - progress_bar.py[line:274] - INFO: epoch 006:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17882.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3352, ups=0.19, wpb=17882.8, bsz=1024, num_updates=2150, lr=4.89526e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=47, gb_free=13.5, wall=13602
2024-11-12 09:31:48 - progress_bar.py[line:274] - INFO: epoch 006:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17495.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3392.1, ups=0.19, wpb=17495.3, bsz=1024, num_updates=2160, lr=4.91803e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=50, gb_free=13.3, wall=13653
2024-11-12 09:32:40 - progress_bar.py[line:274] - INFO: epoch 006:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17503.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3360.8, ups=0.19, wpb=17503.6, bsz=1024, num_updates=2170, lr=4.9408e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=51, gb_free=13.3, wall=13706
2024-11-12 09:33:32 - progress_bar.py[line:274] - INFO: epoch 006:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17616, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3403.6, ups=0.19, wpb=17616, bsz=1024, num_updates=2180, lr=4.96357e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=50, gb_free=13.4, wall=13757
2024-11-12 09:34:24 - progress_bar.py[line:274] - INFO: epoch 006:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17454.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3367.7, ups=0.19, wpb=17454.3, bsz=1024, num_updates=2190, lr=4.98634e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=13809
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

2024-11-12 09:34:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2196 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-12 09:34:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt': File exists
: File exists: File exists: File exists

: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 09:36:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
2024-11-12 09:38:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2196 updates, score 0) (writing took 229.87998697999865 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-12 09:39:42 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-12 09:39:42 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.716 | ntokens 17387.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.57 | wps 2682.5 | ups 0.15 | wpb 17387.7 | bsz 1023.1 | num_updates 2196 | lr 5e-05 | gnorm 0.007 | clip 0 | loss_scale 2048 | train_wall 1229 | gb_free 13.3 | wall 14128
2024-11-12 09:39:42 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 09:47:50 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-12 09:47:50 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 09:48:16 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=16976.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=204, ups=0.01, wpb=16976.3, bsz=998.4, num_updates=2200, lr=4.99942e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=47, gb_free=13.5, wall=14641
2024-11-12 09:49:10 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17358.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3186.3, ups=0.18, wpb=17358.1, bsz=1024, num_updates=2210, lr=4.99797e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=42, gb_free=13.5, wall=14696
2024-11-12 09:50:09 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17580.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=2963.5, ups=0.17, wpb=17580.5, bsz=1024, num_updates=2220, lr=4.99651e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=50, gb_free=13.5, wall=14755
2024-11-12 09:51:15 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17434, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2653, ups=0.15, wpb=17434, bsz=1024, num_updates=2230, lr=4.99506e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=66, gb_free=13.2, wall=14821
2024-11-12 09:52:21 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17378.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2655.1, ups=0.15, wpb=17378.9, bsz=1024, num_updates=2240, lr=4.99361e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=14886
2024-11-12 09:53:26 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17446.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2656.1, ups=0.15, wpb=17446.3, bsz=1024, num_updates=2250, lr=4.99215e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=66, gb_free=13.1, wall=14952
2024-11-12 09:54:32 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17412.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=2666, ups=0.15, wpb=17412.6, bsz=1024, num_updates=2260, lr=4.9907e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=15017
2024-11-12 09:55:37 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17376.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2650.5, ups=0.15, wpb=17376.3, bsz=1024, num_updates=2270, lr=4.98925e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=15083
2024-11-12 09:56:43 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2684.8, ups=0.15, wpb=17589.3, bsz=1024, num_updates=2280, lr=4.98779e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=15148
2024-11-12 09:57:48 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17406.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2655.2, ups=0.15, wpb=17406.1, bsz=1024, num_updates=2290, lr=4.98634e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=15214
2024-11-12 09:58:54 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17458, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2669.5, ups=0.15, wpb=17458, bsz=1024, num_updates=2300, lr=4.98489e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=65, gb_free=13.3, wall=15279
2024-11-12 09:59:59 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17443.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=2659.5, ups=0.15, wpb=17443.3, bsz=1024, num_updates=2310, lr=4.98343e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=65, gb_free=13.3, wall=15345
2024-11-12 10:01:05 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2662.7, ups=0.15, wpb=17422.9, bsz=1024, num_updates=2320, lr=4.98198e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=65, gb_free=13.5, wall=15410
2024-11-12 10:02:10 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17408.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2654.1, ups=0.15, wpb=17408.3, bsz=1024, num_updates=2330, lr=4.98053e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=65, gb_free=13.4, wall=15476
2024-11-12 10:03:16 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17046.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=2611.7, ups=0.15, wpb=17046.5, bsz=1024, num_updates=2340, lr=4.97907e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=65, gb_free=13.4, wall=15541
2024-11-12 10:04:21 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17491.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2670.3, ups=0.15, wpb=17491.3, bsz=1024, num_updates=2350, lr=4.97762e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=65, gb_free=13.3, wall=15607
2024-11-12 10:05:27 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17508.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2659, ups=0.15, wpb=17508.5, bsz=1024, num_updates=2360, lr=4.97617e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=66, gb_free=13.4, wall=15673
2024-11-12 10:06:33 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17360.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2644.8, ups=0.15, wpb=17360.4, bsz=1024, num_updates=2370, lr=4.97471e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=66, gb_free=13.5, wall=15738
2024-11-12 10:07:38 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17646.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2687.6, ups=0.15, wpb=17646.1, bsz=1024, num_updates=2380, lr=4.97326e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=66, gb_free=13.4, wall=15804
2024-11-12 10:08:40 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17309.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2788.3, ups=0.16, wpb=17309.3, bsz=1024, num_updates=2390, lr=4.97181e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=62, gb_free=13.4, wall=15866
2024-11-12 10:09:32 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17546.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3403.1, ups=0.19, wpb=17546.6, bsz=1024, num_updates=2400, lr=4.97035e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=33, gb_free=13.2, wall=15918
2024-11-12 10:10:25 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17385.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3287.3, ups=0.19, wpb=17385.2, bsz=1024, num_updates=2410, lr=4.9689e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=34, gb_free=13.1, wall=15971
2024-11-12 10:11:18 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17588.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3342.1, ups=0.19, wpb=17588.2, bsz=1024, num_updates=2420, lr=4.96745e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=16023
2024-11-12 10:12:11 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17409.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3256, ups=0.19, wpb=17409.5, bsz=1024, num_updates=2430, lr=4.96599e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=16077
2024-11-12 10:13:04 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17498, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3278.5, ups=0.19, wpb=17498, bsz=1024, num_updates=2440, lr=4.96454e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=16130
2024-11-12 10:13:58 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17611, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3302.8, ups=0.19, wpb=17611, bsz=1024, num_updates=2450, lr=4.96309e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=16183
2024-11-12 10:14:51 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17589.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3303.7, ups=0.19, wpb=17589.6, bsz=1024, num_updates=2460, lr=4.96163e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=16237
2024-11-12 10:15:44 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17219.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3248.3, ups=0.19, wpb=17219.3, bsz=1024, num_updates=2470, lr=4.96018e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=16290
2024-11-12 10:16:36 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=16993.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3243.1, ups=0.19, wpb=16993.8, bsz=1015.4, num_updates=2480, lr=4.95873e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=16342
2024-11-12 10:17:29 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3275, ups=0.19, wpb=17398.1, bsz=1024, num_updates=2490, lr=4.95727e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=16395
2024-11-12 10:18:22 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17676.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3347.3, ups=0.19, wpb=17676.5, bsz=1024, num_updates=2500, lr=4.95582e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=16448
2024-11-12 10:19:14 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17735.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3411.6, ups=0.19, wpb=17735.5, bsz=1024, num_updates=2510, lr=4.95437e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=16500
2024-11-12 10:20:06 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17700.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3394.8, ups=0.19, wpb=17700.5, bsz=1024, num_updates=2520, lr=4.95291e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=31, gb_free=13.2, wall=16552
2024-11-12 10:20:58 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3350.7, ups=0.19, wpb=17333.1, bsz=1024, num_updates=2530, lr=4.95146e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=31, gb_free=13.2, wall=16604
2024-11-12 10:21:50 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17814.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3419, ups=0.19, wpb=17814.3, bsz=1024, num_updates=2540, lr=4.95001e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=16656
2024-11-12 10:22:42 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17504.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3350.2, ups=0.19, wpb=17504.5, bsz=1024, num_updates=2550, lr=4.94855e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=16708
2024-11-12 10:23:35 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17872.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3410.2, ups=0.19, wpb=17872.1, bsz=1024, num_updates=2560, lr=4.9471e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=31, gb_free=13.3, wall=16761
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-12 10:23:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2562 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
2024-11-12 10:23:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 10:25:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
2024-11-12 10:27:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2562 updates, score 0) (writing took 217.7619758999208 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-12 10:28:15 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-12 10:28:15 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.721 | ntokens 17458.4 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.59 | wps 2193.5 | ups 0.13 | wpb 17458.4 | bsz 1023.1 | num_updates 2562 | lr 4.94681e-05 | gnorm 0.007 | clip 0 | loss_scale 4096 | train_wall 1748 | gb_free 13.5 | wall 17041
2024-11-12 10:28:15 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 10:30:45 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-12 10:30:45 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 10:31:29 - progress_bar.py[line:274] - INFO: epoch 008:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=16956, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=357.4, ups=0.02, wpb=16956, bsz=998.4, num_updates=2570, lr=4.94565e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17235
2024-11-12 10:32:22 - progress_bar.py[line:274] - INFO: epoch 008:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3260.5, ups=0.19, wpb=17102.7, bsz=1024, num_updates=2580, lr=4.94419e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17287
2024-11-12 10:33:14 - progress_bar.py[line:274] - INFO: epoch 008:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3335.2, ups=0.19, wpb=17543.5, bsz=1024, num_updates=2590, lr=4.94274e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17340
2024-11-12 10:34:07 - progress_bar.py[line:274] - INFO: epoch 008:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17599, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3364.3, ups=0.19, wpb=17599, bsz=1024, num_updates=2600, lr=4.94129e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17392
2024-11-12 10:34:59 - progress_bar.py[line:274] - INFO: epoch 008:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3300.9, ups=0.19, wpb=17309.4, bsz=1024, num_updates=2610, lr=4.93983e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17445
2024-11-12 10:35:52 - progress_bar.py[line:274] - INFO: epoch 008:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17439.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3301.6, ups=0.19, wpb=17439.9, bsz=1024, num_updates=2620, lr=4.93838e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17498
2024-11-12 10:36:45 - progress_bar.py[line:274] - INFO: epoch 008:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17258.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3262.1, ups=0.19, wpb=17258.9, bsz=1024, num_updates=2630, lr=4.93693e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17550
2024-11-12 10:37:39 - progress_bar.py[line:274] - INFO: epoch 008:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3228.8, ups=0.19, wpb=17378.7, bsz=1024, num_updates=2640, lr=4.93547e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17604
2024-11-12 10:38:31 - progress_bar.py[line:274] - INFO: epoch 008:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17484.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3314.2, ups=0.19, wpb=17484.3, bsz=1024, num_updates=2650, lr=4.93402e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=31, gb_free=13.1, wall=17657
2024-11-12 10:39:24 - progress_bar.py[line:274] - INFO: epoch 008:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17567.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3323.4, ups=0.19, wpb=17567.9, bsz=1024, num_updates=2660, lr=4.93257e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17710
2024-11-12 10:40:17 - progress_bar.py[line:274] - INFO: epoch 008:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17427.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3328.9, ups=0.19, wpb=17427.2, bsz=1024, num_updates=2670, lr=4.93111e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17762
2024-11-12 10:41:08 - progress_bar.py[line:274] - INFO: epoch 008:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17406.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3356, ups=0.19, wpb=17406.8, bsz=1015.4, num_updates=2680, lr=4.92966e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17814
2024-11-12 10:42:01 - progress_bar.py[line:274] - INFO: epoch 008:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17072.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3254.2, ups=0.19, wpb=17072.2, bsz=1024, num_updates=2690, lr=4.92821e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17867
2024-11-12 10:42:54 - progress_bar.py[line:274] - INFO: epoch 008:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17554.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3318.3, ups=0.19, wpb=17554.5, bsz=1024, num_updates=2700, lr=4.92675e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17919
2024-11-12 10:43:46 - progress_bar.py[line:274] - INFO: epoch 008:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17807.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3383, ups=0.19, wpb=17807.7, bsz=1024, num_updates=2710, lr=4.9253e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17972
2024-11-12 10:44:40 - progress_bar.py[line:274] - INFO: epoch 008:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17247.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3221.3, ups=0.19, wpb=17247.7, bsz=1024, num_updates=2720, lr=4.92385e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=31, gb_free=13.1, wall=18026
2024-11-12 10:45:33 - progress_bar.py[line:274] - INFO: epoch 008:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17431, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3260.4, ups=0.19, wpb=17431, bsz=1024, num_updates=2730, lr=4.92239e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=18079
2024-11-12 10:46:26 - progress_bar.py[line:274] - INFO: epoch 008:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17252.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3284.6, ups=0.19, wpb=17252.6, bsz=1024, num_updates=2740, lr=4.92094e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18132
2024-11-12 10:47:19 - progress_bar.py[line:274] - INFO: epoch 008:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17115, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3204.1, ups=0.19, wpb=17115, bsz=1024, num_updates=2750, lr=4.91949e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.3, wall=18185
2024-11-12 10:48:12 - progress_bar.py[line:274] - INFO: epoch 008:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17493.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3305.1, ups=0.19, wpb=17493.1, bsz=1024, num_updates=2760, lr=4.91803e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18238
2024-11-12 10:49:06 - progress_bar.py[line:274] - INFO: epoch 008:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17508.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3265.9, ups=0.19, wpb=17508.3, bsz=1024, num_updates=2770, lr=4.91658e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18292
2024-11-12 10:49:59 - progress_bar.py[line:274] - INFO: epoch 008:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17027.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3231.7, ups=0.19, wpb=17027.4, bsz=1024, num_updates=2780, lr=4.91513e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18344
2024-11-12 10:50:52 - progress_bar.py[line:274] - INFO: epoch 008:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17410.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3286.7, ups=0.19, wpb=17410.4, bsz=1024, num_updates=2790, lr=4.91367e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18397
2024-11-12 10:51:45 - progress_bar.py[line:274] - INFO: epoch 008:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17581.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3308.5, ups=0.19, wpb=17581.6, bsz=1024, num_updates=2800, lr=4.91222e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18450
2024-11-12 10:52:38 - progress_bar.py[line:274] - INFO: epoch 008:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3293.4, ups=0.19, wpb=17435.9, bsz=1024, num_updates=2810, lr=4.91077e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=18503
2024-11-12 10:53:31 - progress_bar.py[line:274] - INFO: epoch 008:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17077.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3197.2, ups=0.19, wpb=17077.4, bsz=1024, num_updates=2820, lr=4.90931e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=18557
2024-11-12 10:54:24 - progress_bar.py[line:274] - INFO: epoch 008:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17404.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3279.4, ups=0.19, wpb=17404.8, bsz=1024, num_updates=2830, lr=4.90786e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.6, wall=18610
2024-11-12 10:55:18 - progress_bar.py[line:274] - INFO: epoch 008:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17322.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3232.6, ups=0.19, wpb=17322.7, bsz=1024, num_updates=2840, lr=4.90641e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18663
2024-11-12 10:56:11 - progress_bar.py[line:274] - INFO: epoch 008:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17391.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3273.4, ups=0.19, wpb=17391.9, bsz=1024, num_updates=2850, lr=4.90495e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18717
2024-11-12 10:57:04 - progress_bar.py[line:274] - INFO: epoch 008:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17375.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3286.2, ups=0.19, wpb=17375.1, bsz=1024, num_updates=2860, lr=4.9035e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=18769
2024-11-12 10:57:56 - progress_bar.py[line:274] - INFO: epoch 008:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17897, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3445.8, ups=0.19, wpb=17897, bsz=1024, num_updates=2870, lr=4.90205e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18821
2024-11-12 10:58:48 - progress_bar.py[line:274] - INFO: epoch 008:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17827.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3400.8, ups=0.19, wpb=17827.9, bsz=1024, num_updates=2880, lr=4.90059e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=33, gb_free=13.4, wall=18874
2024-11-12 10:59:40 - progress_bar.py[line:274] - INFO: epoch 008:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17743.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3415.6, ups=0.19, wpb=17743.1, bsz=1024, num_updates=2890, lr=4.89914e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18926
2024-11-12 11:00:32 - progress_bar.py[line:274] - INFO: epoch 008:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17614, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3394.8, ups=0.19, wpb=17614, bsz=1024, num_updates=2900, lr=4.89769e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=18978
2024-11-12 11:01:24 - progress_bar.py[line:274] - INFO: epoch 008:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17461.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3366.4, ups=0.19, wpb=17461.8, bsz=1024, num_updates=2910, lr=4.89623e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19030
2024-11-12 11:02:16 - progress_bar.py[line:274] - INFO: epoch 008:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17631.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3383.7, ups=0.19, wpb=17631.7, bsz=1024, num_updates=2920, lr=4.89478e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=33, gb_free=13.2, wall=19082
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt2024-11-12 11:02:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2928 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-12 11:02:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 11:04:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
2024-11-12 11:06:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 2928 updates, score 0) (writing took 221.66547890100628 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
2024-11-12 11:07:32 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-12 11:07:32 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.709 | ntokens 17422.6 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.54 | wps 2705.8 | ups 0.16 | wpb 17422.6 | bsz 1023.1 | num_updates 2928 | lr 4.89362e-05 | gnorm 0.007 | clip 0 | loss_scale 4096 | train_wall 1126 | gb_free 13.4 | wall 19398
2024-11-12 11:07:32 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 11:10:03 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-12 11:10:03 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 11:10:16 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17103.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=356.5, ups=0.02, wpb=17103.7, bsz=998.4, num_updates=2930, lr=4.89333e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=36, gb_free=13.2, wall=19561
2024-11-12 11:11:08 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17419.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3316.9, ups=0.19, wpb=17419.1, bsz=1024, num_updates=2940, lr=4.89187e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=19614
2024-11-12 11:12:01 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17619.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3341.9, ups=0.19, wpb=17619.5, bsz=1024, num_updates=2950, lr=4.89042e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19667
2024-11-12 11:12:54 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17429.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3302.2, ups=0.19, wpb=17429.3, bsz=1024, num_updates=2960, lr=4.88897e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=19719
2024-11-12 11:13:46 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17494.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3324.9, ups=0.19, wpb=17494.2, bsz=1024, num_updates=2970, lr=4.88751e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19772
2024-11-12 11:14:39 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17399.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3306, ups=0.19, wpb=17399.6, bsz=1015.4, num_updates=2980, lr=4.88606e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19825
2024-11-12 11:15:32 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3287.8, ups=0.19, wpb=17309.4, bsz=1024, num_updates=2990, lr=4.88461e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.5, wall=19877
2024-11-12 11:16:24 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17283.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3291.6, ups=0.19, wpb=17283.8, bsz=1024, num_updates=3000, lr=4.88315e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19930
2024-11-12 11:17:16 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17352.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3311.9, ups=0.19, wpb=17352.6, bsz=1024, num_updates=3010, lr=4.8817e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=19982
2024-11-12 11:18:10 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17610.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3321.5, ups=0.19, wpb=17610.6, bsz=1024, num_updates=3020, lr=4.88025e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=20035
2024-11-12 11:19:03 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17416.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3276.6, ups=0.19, wpb=17416.7, bsz=1024, num_updates=3030, lr=4.87879e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=20088
2024-11-12 11:19:56 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17449.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3299.5, ups=0.19, wpb=17449.5, bsz=1024, num_updates=3040, lr=4.87734e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=20141
2024-11-12 11:20:48 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17513.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3315.1, ups=0.19, wpb=17513.6, bsz=1024, num_updates=3050, lr=4.87589e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=20194
2024-11-12 11:21:41 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17196.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3278.1, ups=0.19, wpb=17196.7, bsz=1024, num_updates=3060, lr=4.87443e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=20246
2024-11-12 11:22:34 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3296.1, ups=0.19, wpb=17590.9, bsz=1024, num_updates=3070, lr=4.87298e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=31, gb_free=13.3, wall=20300
2024-11-12 11:23:27 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17461.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3321.5, ups=0.19, wpb=17461.5, bsz=1024, num_updates=3080, lr=4.87153e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20352
2024-11-12 11:24:20 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17307.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3274.1, ups=0.19, wpb=17307.4, bsz=1024, num_updates=3090, lr=4.87007e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20405
2024-11-12 11:25:12 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3303.9, ups=0.19, wpb=17435.9, bsz=1024, num_updates=3100, lr=4.86862e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=20458
2024-11-12 11:26:05 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3306.2, ups=0.19, wpb=17521.3, bsz=1024, num_updates=3110, lr=4.86717e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=20511
2024-11-12 11:26:58 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17047.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3221.6, ups=0.19, wpb=17047.3, bsz=1024, num_updates=3120, lr=4.86571e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=20564
2024-11-12 11:27:50 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17353.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3339.2, ups=0.19, wpb=17353.7, bsz=1024, num_updates=3130, lr=4.86426e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20616
2024-11-12 11:28:43 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17171.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3232.8, ups=0.19, wpb=17171.8, bsz=1024, num_updates=3140, lr=4.86281e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20669
2024-11-12 11:29:36 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17316.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3279.8, ups=0.19, wpb=17316.5, bsz=1024, num_updates=3150, lr=4.86135e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20722
2024-11-12 11:30:29 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17424, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3310.1, ups=0.19, wpb=17424, bsz=1024, num_updates=3160, lr=4.8599e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20775
2024-11-12 11:31:22 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17476, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3290, ups=0.19, wpb=17476, bsz=1024, num_updates=3170, lr=4.85845e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.2, wall=20828
2024-11-12 11:32:15 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17049.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3219.4, ups=0.19, wpb=17049.5, bsz=1024, num_updates=3180, lr=4.85699e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=35, gb_free=13.5, wall=20881
2024-11-12 11:33:08 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17394.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3269.2, ups=0.19, wpb=17394.4, bsz=1024, num_updates=3190, lr=4.85554e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=43, gb_free=13.4, wall=20934
2024-11-12 11:34:01 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17217.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3274.4, ups=0.19, wpb=17217.4, bsz=1024, num_updates=3200, lr=4.85409e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=41, gb_free=13.2, wall=20986
2024-11-12 11:34:53 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17497.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3328.9, ups=0.19, wpb=17497.3, bsz=1024, num_updates=3210, lr=4.85263e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=40, gb_free=13.4, wall=21039
2024-11-12 11:35:46 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17383, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3314.9, ups=0.19, wpb=17383, bsz=1024, num_updates=3220, lr=4.85118e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=33, gb_free=13.4, wall=21091
2024-11-12 11:36:38 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17598.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3336.8, ups=0.19, wpb=17598.1, bsz=1024, num_updates=3230, lr=4.84973e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21144
2024-11-12 11:37:30 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17373.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3343.6, ups=0.19, wpb=17373.2, bsz=1024, num_updates=3240, lr=4.84827e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=21196
2024-11-12 11:38:22 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17570.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3378.4, ups=0.19, wpb=17570.4, bsz=1024, num_updates=3250, lr=4.84682e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=35, gb_free=13.4, wall=21248
2024-11-12 11:39:15 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17748.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3390.2, ups=0.19, wpb=17748.8, bsz=1024, num_updates=3260, lr=4.84537e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=37, gb_free=13.4, wall=21300
2024-11-12 11:40:07 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17543.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3354.5, ups=0.19, wpb=17543.7, bsz=1024, num_updates=3270, lr=4.84391e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=46, gb_free=13.4, wall=21353
2024-11-12 11:40:59 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17614.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3388.3, ups=0.19, wpb=17614.6, bsz=1024, num_updates=3280, lr=4.84246e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=45, gb_free=13, wall=21405
2024-11-12 11:41:50 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17537.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3416.2, ups=0.19, wpb=17537.3, bsz=1024, num_updates=3290, lr=4.84101e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=43, gb_free=13.4, wall=21456
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt2024-11-12 11:42:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3294 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-12 11:42:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 11:43:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 11:45:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3294 updates, score 0) (writing took 218.2382304869825 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-12 11:46:42 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-12 11:46:42 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.702 | ntokens 17411.5 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.51 | wps 2711.8 | ups 0.16 | wpb 17411.5 | bsz 1023.1 | num_updates 3294 | lr 4.84043e-05 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 1213 | gb_free 13.3 | wall 21748
2024-11-12 11:46:42 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 11:49:10 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-12 11:49:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 11:49:44 - progress_bar.py[line:274] - INFO: epoch 010:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=16968.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=358.2, ups=0.02, wpb=16968.5, bsz=998.4, num_updates=3300, lr=4.83955e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=35, gb_free=13.4, wall=21930
2024-11-12 11:50:37 - progress_bar.py[line:274] - INFO: epoch 010:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17570.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3343.2, ups=0.19, wpb=17570.4, bsz=1024, num_updates=3310, lr=4.8381e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21982
2024-11-12 11:51:29 - progress_bar.py[line:274] - INFO: epoch 010:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17437.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3313.4, ups=0.19, wpb=17437.8, bsz=1024, num_updates=3320, lr=4.83665e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22035
2024-11-12 11:52:22 - progress_bar.py[line:274] - INFO: epoch 010:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17487.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3338.1, ups=0.19, wpb=17487.9, bsz=1024, num_updates=3330, lr=4.83519e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22087
2024-11-12 11:53:14 - progress_bar.py[line:274] - INFO: epoch 010:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17465.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3314.8, ups=0.19, wpb=17465.9, bsz=1024, num_updates=3340, lr=4.83374e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22140
2024-11-12 11:54:07 - progress_bar.py[line:274] - INFO: epoch 010:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17413, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3316.1, ups=0.19, wpb=17413, bsz=1024, num_updates=3350, lr=4.83229e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22193
2024-11-12 11:55:00 - progress_bar.py[line:274] - INFO: epoch 010:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17535.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3328.1, ups=0.19, wpb=17535.1, bsz=1024, num_updates=3360, lr=4.83083e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22245
2024-11-12 11:55:52 - progress_bar.py[line:274] - INFO: epoch 010:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17195.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3283.2, ups=0.19, wpb=17195.2, bsz=1024, num_updates=3370, lr=4.82938e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22298
2024-11-12 11:56:45 - progress_bar.py[line:274] - INFO: epoch 010:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17504.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3320, ups=0.19, wpb=17504.6, bsz=1024, num_updates=3380, lr=4.82793e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22350
2024-11-12 11:57:37 - progress_bar.py[line:274] - INFO: epoch 010:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17580.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3328.4, ups=0.19, wpb=17580.5, bsz=1024, num_updates=3390, lr=4.82647e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22403
2024-11-12 11:58:30 - progress_bar.py[line:274] - INFO: epoch 010:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3265.4, ups=0.19, wpb=17268.7, bsz=1024, num_updates=3400, lr=4.82502e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=22456
2024-11-12 11:59:24 - progress_bar.py[line:274] - INFO: epoch 010:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17455.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3239.3, ups=0.19, wpb=17455.4, bsz=1024, num_updates=3410, lr=4.82357e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22510
2024-11-12 12:00:17 - progress_bar.py[line:274] - INFO: epoch 010:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17374.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3276.4, ups=0.19, wpb=17374.4, bsz=1024, num_updates=3420, lr=4.82211e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.2, wall=22563
2024-11-12 12:01:10 - progress_bar.py[line:274] - INFO: epoch 010:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17186.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3234.8, ups=0.19, wpb=17186.4, bsz=1024, num_updates=3430, lr=4.82066e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22616
2024-11-12 12:02:03 - progress_bar.py[line:274] - INFO: epoch 010:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17540.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3356.4, ups=0.19, wpb=17540.7, bsz=1024, num_updates=3440, lr=4.81921e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22668
2024-11-12 12:02:55 - progress_bar.py[line:274] - INFO: epoch 010:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17354.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3302.4, ups=0.19, wpb=17354.7, bsz=1024, num_updates=3450, lr=4.81775e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=22721
2024-11-12 12:03:49 - progress_bar.py[line:274] - INFO: epoch 010:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17338, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3243, ups=0.19, wpb=17338, bsz=1024, num_updates=3460, lr=4.8163e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=22774
2024-11-12 12:04:41 - progress_bar.py[line:274] - INFO: epoch 010:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17453.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3337.5, ups=0.19, wpb=17453.7, bsz=1024, num_updates=3470, lr=4.81485e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=22827
2024-11-12 12:05:34 - progress_bar.py[line:274] - INFO: epoch 010:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17260.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3261.7, ups=0.19, wpb=17260.3, bsz=1024, num_updates=3480, lr=4.81339e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=22880
2024-11-12 12:06:27 - progress_bar.py[line:274] - INFO: epoch 010:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17432.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3300.4, ups=0.19, wpb=17432.6, bsz=1024, num_updates=3490, lr=4.81194e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=22932
2024-11-12 12:07:21 - progress_bar.py[line:274] - INFO: epoch 010:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17817.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3300.1, ups=0.19, wpb=17817.9, bsz=1024, num_updates=3500, lr=4.81049e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=34, gb_free=13.5, wall=22986
2024-11-12 12:08:15 - progress_bar.py[line:274] - INFO: epoch 010:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17077.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3158.3, ups=0.18, wpb=17077.9, bsz=1024, num_updates=3510, lr=4.80903e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=53, gb_free=13.1, wall=23040
2024-11-12 12:09:07 - progress_bar.py[line:274] - INFO: epoch 010:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3355.8, ups=0.19, wpb=17478.4, bsz=1024, num_updates=3520, lr=4.80758e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=23093
2024-11-12 12:09:59 - progress_bar.py[line:274] - INFO: epoch 010:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17497.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3343.5, ups=0.19, wpb=17497.4, bsz=1024, num_updates=3530, lr=4.80613e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=23145
2024-11-12 12:10:52 - progress_bar.py[line:274] - INFO: epoch 010:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17352, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3281.3, ups=0.19, wpb=17352, bsz=1024, num_updates=3540, lr=4.80467e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=50, gb_free=13.5, wall=23198
2024-11-12 12:11:44 - progress_bar.py[line:274] - INFO: epoch 010:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17329.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3326.2, ups=0.19, wpb=17329.5, bsz=1024, num_updates=3550, lr=4.80322e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=43, gb_free=13.4, wall=23250
2024-11-12 12:12:37 - progress_bar.py[line:274] - INFO: epoch 010:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3272.9, ups=0.19, wpb=17272.4, bsz=1024, num_updates=3560, lr=4.80177e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=36, gb_free=13.3, wall=23303
2024-11-12 12:13:30 - progress_bar.py[line:274] - INFO: epoch 010:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17359.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3279.7, ups=0.19, wpb=17359.2, bsz=1024, num_updates=3570, lr=4.80031e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=31, gb_free=13.5, wall=23356
2024-11-12 12:14:25 - progress_bar.py[line:274] - INFO: epoch 010:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17154.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3135, ups=0.18, wpb=17154.1, bsz=1024, num_updates=3580, lr=4.79886e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=36, gb_free=13.4, wall=23410
2024-11-12 12:15:18 - progress_bar.py[line:274] - INFO: epoch 010:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17263.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3252.4, ups=0.19, wpb=17263.3, bsz=1024, num_updates=3590, lr=4.79741e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=51, gb_free=13.5, wall=23463
2024-11-12 12:16:11 - progress_bar.py[line:274] - INFO: epoch 010:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17611.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3278.2, ups=0.19, wpb=17611.3, bsz=1024, num_updates=3600, lr=4.79595e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=23517
2024-11-12 12:17:03 - progress_bar.py[line:274] - INFO: epoch 010:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17942.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3471.7, ups=0.19, wpb=17942.5, bsz=1024, num_updates=3610, lr=4.7945e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=23569
2024-11-12 12:17:55 - progress_bar.py[line:274] - INFO: epoch 010:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3344.4, ups=0.19, wpb=17435.9, bsz=1024, num_updates=3620, lr=4.79305e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=23621
2024-11-12 12:18:47 - progress_bar.py[line:274] - INFO: epoch 010:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17776, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3414.4, ups=0.19, wpb=17776, bsz=1024, num_updates=3630, lr=4.79159e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=23673
2024-11-12 12:19:39 - progress_bar.py[line:274] - INFO: epoch 010:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17514.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3374.8, ups=0.19, wpb=17514.7, bsz=1024, num_updates=3640, lr=4.79014e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=23725
2024-11-12 12:20:32 - progress_bar.py[line:274] - INFO: epoch 010:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17590.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3312.5, ups=0.19, wpb=17590.1, bsz=1024, num_updates=3650, lr=4.78869e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=37, gb_free=13.2, wall=23778
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-12 12:21:21 - progress_bar.py[line:274] - INFO: epoch 010:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=16882.1, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3462.7, ups=0.21, wpb=16882.1, bsz=989.8, num_updates=3660, lr=4.78723e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=38, gb_free=13.5, wall=23827
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt2024-11-12 12:21:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3660 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
2024-11-12 12:21:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 12:23:10 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 12:25:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3660 updates, score 0) (writing took 221.50211390701588 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-12 12:25:57 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-12 12:25:57 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.7 | ntokens 17418.1 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.5 | wps 2706.5 | ups 0.16 | wpb 17418.1 | bsz 1023.1 | num_updates 3660 | lr 4.78723e-05 | gnorm 0.007 | clip 0 | loss_scale 16384 | train_wall 1261 | gb_free 13.5 | wall 24103
2024-11-12 12:25:57 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 12:28:28 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-12 12:28:28 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 12:29:22 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17558.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=364.9, ups=0.02, wpb=17558.3, bsz=1024, num_updates=3670, lr=4.78578e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24308
2024-11-12 12:30:15 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17391.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3281.4, ups=0.19, wpb=17391.7, bsz=1024, num_updates=3680, lr=4.78433e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24361
2024-11-12 12:31:08 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17596.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3332.3, ups=0.19, wpb=17596.5, bsz=1024, num_updates=3690, lr=4.78287e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=24414
2024-11-12 12:32:01 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17638.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3342.6, ups=0.19, wpb=17638.9, bsz=1024, num_updates=3700, lr=4.78142e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24466
2024-11-12 12:32:54 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17589.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3313.2, ups=0.19, wpb=17589.4, bsz=1024, num_updates=3710, lr=4.77997e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=24520
2024-11-12 12:33:46 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17274.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3288, ups=0.19, wpb=17274.7, bsz=1024, num_updates=3720, lr=4.77851e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24572
2024-11-12 12:34:40 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17484.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3258.5, ups=0.19, wpb=17484.6, bsz=1024, num_updates=3730, lr=4.77706e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=24626
2024-11-12 12:35:34 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3261.8, ups=0.19, wpb=17508.1, bsz=1024, num_updates=3740, lr=4.77561e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=24679
2024-11-12 12:36:27 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17726.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3324.7, ups=0.19, wpb=17726.8, bsz=1024, num_updates=3750, lr=4.77415e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=24733
2024-11-12 12:37:21 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17475.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3270.1, ups=0.19, wpb=17475.9, bsz=1024, num_updates=3760, lr=4.7727e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24786
2024-11-12 12:38:13 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17229.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3273.3, ups=0.19, wpb=17229.9, bsz=1024, num_updates=3770, lr=4.77125e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24839
2024-11-12 12:39:06 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17299.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3291.3, ups=0.19, wpb=17299.7, bsz=1024, num_updates=3780, lr=4.76979e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=24891
2024-11-12 12:40:00 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17081.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3125.4, ups=0.18, wpb=17081.3, bsz=1024, num_updates=3790, lr=4.76834e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=24946
2024-11-12 12:40:58 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17283.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3025.8, ups=0.18, wpb=17283.3, bsz=1015.4, num_updates=3800, lr=4.76689e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25003
2024-11-12 12:41:51 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17673.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3329.5, ups=0.19, wpb=17673.9, bsz=1024, num_updates=3810, lr=4.76543e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=25056
2024-11-12 12:42:43 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3311.4, ups=0.19, wpb=17448.2, bsz=1024, num_updates=3820, lr=4.76398e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=25109
2024-11-12 12:43:36 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17379.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3311.4, ups=0.19, wpb=17379.2, bsz=1024, num_updates=3830, lr=4.76253e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.5, wall=25161
2024-11-12 12:44:29 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17326.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3249.3, ups=0.19, wpb=17326.3, bsz=1024, num_updates=3840, lr=4.76107e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25215
2024-11-12 12:45:22 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3267.6, ups=0.19, wpb=17370.2, bsz=1024, num_updates=3850, lr=4.75962e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25268
2024-11-12 12:46:16 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17545, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3288.3, ups=0.19, wpb=17545, bsz=1024, num_updates=3860, lr=4.75817e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=25321
2024-11-12 12:47:09 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17475.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3292.3, ups=0.19, wpb=17475.4, bsz=1024, num_updates=3870, lr=4.75671e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25374
2024-11-12 12:48:02 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17406.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3284, ups=0.19, wpb=17406.4, bsz=1024, num_updates=3880, lr=4.75526e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=25427
2024-11-12 12:48:54 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17283.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3273.1, ups=0.19, wpb=17283.6, bsz=1024, num_updates=3890, lr=4.75381e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25480
2024-11-12 12:49:48 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17611.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3300.9, ups=0.19, wpb=17611.8, bsz=1024, num_updates=3900, lr=4.75235e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=25533
2024-11-12 12:50:41 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17419.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3284.4, ups=0.19, wpb=17419.6, bsz=1024, num_updates=3910, lr=4.7509e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25587
2024-11-12 12:51:34 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17294.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3247.8, ups=0.19, wpb=17294.2, bsz=1024, num_updates=3920, lr=4.74945e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25640
2024-11-12 12:52:28 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17252.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3175.9, ups=0.18, wpb=17252.1, bsz=1024, num_updates=3930, lr=4.74799e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=54, gb_free=13.2, wall=25694
2024-11-12 12:53:22 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17384, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3231.3, ups=0.19, wpb=17384, bsz=1024, num_updates=3940, lr=4.74654e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=25748
2024-11-12 12:54:15 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17458.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3290.1, ups=0.19, wpb=17458.7, bsz=1024, num_updates=3950, lr=4.74509e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25801
2024-11-12 12:55:10 - progress_bar.py[line:274] - INFO: epoch 011:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17403.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3192.5, ups=0.18, wpb=17403.5, bsz=1024, num_updates=3960, lr=4.74363e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=25855
2024-11-12 12:56:03 - progress_bar.py[line:274] - INFO: epoch 011:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17493.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3316, ups=0.19, wpb=17493.5, bsz=1024, num_updates=3970, lr=4.74218e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25908
2024-11-12 12:56:59 - progress_bar.py[line:274] - INFO: epoch 011:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17635.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3123.1, ups=0.18, wpb=17635.1, bsz=1024, num_updates=3980, lr=4.74073e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=25965
2024-11-12 12:57:52 - progress_bar.py[line:274] - INFO: epoch 011:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17750.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3350.2, ups=0.19, wpb=17750.2, bsz=1024, num_updates=3990, lr=4.73927e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=26018
2024-11-12 12:58:45 - progress_bar.py[line:274] - INFO: epoch 011:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3296.4, ups=0.19, wpb=17543.5, bsz=1024, num_updates=4000, lr=4.73782e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=26071
2024-11-12 12:59:39 - progress_bar.py[line:274] - INFO: epoch 011:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17757.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3328.3, ups=0.19, wpb=17757.6, bsz=1024, num_updates=4010, lr=4.73637e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=26124
2024-11-12 13:00:31 - progress_bar.py[line:274] - INFO: epoch 011:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17825.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3394.4, ups=0.19, wpb=17825.5, bsz=1024, num_updates=4020, lr=4.73491e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=26177
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-12 13:01:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4026 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-12 13:01:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 13:02:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
2024-11-12 13:04:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4026 updates, score 0) (writing took 217.06158386799507 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 13:05:32 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-12 13:05:32 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.7 | ntokens 17461 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.5 | wps 2691 | ups 0.15 | wpb 17461 | bsz 1023.1 | num_updates 4026 | lr 4.73404e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1653 | gb_free 13.4 | wall 26478
2024-11-12 13:05:32 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 13:08:04 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-12 13:08:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 13:08:27 - progress_bar.py[line:274] - INFO: epoch 012:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17053.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=358.3, ups=0.02, wpb=17053.1, bsz=998.4, num_updates=4030, lr=4.73346e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=26653
2024-11-12 13:09:20 - progress_bar.py[line:274] - INFO: epoch 012:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17205, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3275.4, ups=0.19, wpb=17205, bsz=1024, num_updates=4040, lr=4.73201e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26705
2024-11-12 13:10:12 - progress_bar.py[line:274] - INFO: epoch 012:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17028, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3225.7, ups=0.19, wpb=17028, bsz=1024, num_updates=4050, lr=4.73055e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26758
2024-11-12 13:11:05 - progress_bar.py[line:274] - INFO: epoch 012:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3286, ups=0.19, wpb=17323.2, bsz=1024, num_updates=4060, lr=4.7291e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=26811
2024-11-12 13:11:58 - progress_bar.py[line:274] - INFO: epoch 012:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17351.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3310.3, ups=0.19, wpb=17351.8, bsz=1024, num_updates=4070, lr=4.72765e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26863
2024-11-12 13:12:51 - progress_bar.py[line:274] - INFO: epoch 012:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17457, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3279.4, ups=0.19, wpb=17457, bsz=1024, num_updates=4080, lr=4.72619e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26916
2024-11-12 13:13:45 - progress_bar.py[line:274] - INFO: epoch 012:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17847.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3278, ups=0.18, wpb=17847.1, bsz=1024, num_updates=4090, lr=4.72474e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=26971
2024-11-12 13:14:39 - progress_bar.py[line:274] - INFO: epoch 012:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17361.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3240.1, ups=0.19, wpb=17361.8, bsz=1024, num_updates=4100, lr=4.72329e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27024
2024-11-12 13:15:34 - progress_bar.py[line:274] - INFO: epoch 012:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17520.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3194, ups=0.18, wpb=17520.6, bsz=1024, num_updates=4110, lr=4.72183e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=27079
2024-11-12 13:16:26 - progress_bar.py[line:274] - INFO: epoch 012:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17163, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3273.5, ups=0.19, wpb=17163, bsz=1024, num_updates=4120, lr=4.72038e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=47, gb_free=13.5, wall=27132
2024-11-12 13:17:23 - progress_bar.py[line:274] - INFO: epoch 012:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17598.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3119.9, ups=0.18, wpb=17598.9, bsz=1024, num_updates=4130, lr=4.71893e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=27188
2024-11-12 13:18:20 - progress_bar.py[line:274] - INFO: epoch 012:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17469.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3054.1, ups=0.17, wpb=17469.6, bsz=1024, num_updates=4140, lr=4.71747e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27245
2024-11-12 13:19:16 - progress_bar.py[line:274] - INFO: epoch 012:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17292.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3091.9, ups=0.18, wpb=17292.3, bsz=1024, num_updates=4150, lr=4.71602e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=27301
2024-11-12 13:20:09 - progress_bar.py[line:274] - INFO: epoch 012:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17390.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3260.1, ups=0.19, wpb=17390.5, bsz=1024, num_updates=4160, lr=4.71457e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=27355
2024-11-12 13:21:03 - progress_bar.py[line:274] - INFO: epoch 012:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17501.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3240.1, ups=0.19, wpb=17501.5, bsz=1024, num_updates=4170, lr=4.71311e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27409
2024-11-12 13:21:56 - progress_bar.py[line:274] - INFO: epoch 012:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17494, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3300.2, ups=0.19, wpb=17494, bsz=1024, num_updates=4180, lr=4.71166e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27462
2024-11-12 13:22:50 - progress_bar.py[line:274] - INFO: epoch 012:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17145.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3189.4, ups=0.19, wpb=17145.2, bsz=1024, num_updates=4190, lr=4.71021e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27515
2024-11-12 13:23:46 - progress_bar.py[line:274] - INFO: epoch 012:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17347.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3085.7, ups=0.18, wpb=17347.3, bsz=1024, num_updates=4200, lr=4.70875e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=27572
2024-11-12 13:24:41 - progress_bar.py[line:274] - INFO: epoch 012:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17400.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3191.8, ups=0.18, wpb=17400.5, bsz=1024, num_updates=4210, lr=4.7073e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27626
2024-11-12 13:25:34 - progress_bar.py[line:274] - INFO: epoch 012:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17404.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3239.2, ups=0.19, wpb=17404.2, bsz=1024, num_updates=4220, lr=4.70585e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27680
2024-11-12 13:26:28 - progress_bar.py[line:274] - INFO: epoch 012:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17375.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3244.2, ups=0.19, wpb=17375.4, bsz=1024, num_updates=4230, lr=4.70439e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=27733
2024-11-12 13:27:22 - progress_bar.py[line:274] - INFO: epoch 012:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17482.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3242.7, ups=0.19, wpb=17482.8, bsz=1024, num_updates=4240, lr=4.70294e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=27787
2024-11-12 13:28:15 - progress_bar.py[line:274] - INFO: epoch 012:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17703.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3333, ups=0.19, wpb=17703.4, bsz=1024, num_updates=4250, lr=4.70149e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27840
2024-11-12 13:29:08 - progress_bar.py[line:274] - INFO: epoch 012:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17230.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3232.9, ups=0.19, wpb=17230.4, bsz=1024, num_updates=4260, lr=4.70003e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=27894
2024-11-12 13:30:03 - progress_bar.py[line:274] - INFO: epoch 012:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17486.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3205.8, ups=0.18, wpb=17486.8, bsz=1024, num_updates=4270, lr=4.69858e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=27948
2024-11-12 13:30:57 - progress_bar.py[line:274] - INFO: epoch 012:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17496.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3211.9, ups=0.18, wpb=17496.7, bsz=1024, num_updates=4280, lr=4.69713e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=28003
2024-11-12 13:31:51 - progress_bar.py[line:274] - INFO: epoch 012:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17449.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3235.5, ups=0.19, wpb=17449.3, bsz=1024, num_updates=4290, lr=4.69567e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=28057
2024-11-12 13:32:44 - progress_bar.py[line:274] - INFO: epoch 012:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17068.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3218.4, ups=0.19, wpb=17068.7, bsz=1015.4, num_updates=4300, lr=4.69422e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=28110
2024-11-12 13:33:37 - progress_bar.py[line:274] - INFO: epoch 012:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17111.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3212.9, ups=0.19, wpb=17111.8, bsz=1024, num_updates=4310, lr=4.69277e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=39, gb_free=13.3, wall=28163
2024-11-12 13:34:31 - progress_bar.py[line:274] - INFO: epoch 012:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17388.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3225.1, ups=0.19, wpb=17388.2, bsz=1024, num_updates=4320, lr=4.69131e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.5, wall=28217
2024-11-12 13:35:26 - progress_bar.py[line:274] - INFO: epoch 012:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17421, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3202.3, ups=0.18, wpb=17421, bsz=1024, num_updates=4330, lr=4.68986e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=28271
2024-11-12 13:36:19 - progress_bar.py[line:274] - INFO: epoch 012:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17267.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3210.5, ups=0.19, wpb=17267.9, bsz=1024, num_updates=4340, lr=4.68841e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=28325
2024-11-12 13:37:13 - progress_bar.py[line:274] - INFO: epoch 012:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17527, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3259.2, ups=0.19, wpb=17527, bsz=1024, num_updates=4350, lr=4.68696e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=28379
2024-11-12 13:38:07 - progress_bar.py[line:274] - INFO: epoch 012:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17649.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3268, ups=0.19, wpb=17649.3, bsz=1024, num_updates=4360, lr=4.6855e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=13.2, wall=28433
2024-11-12 13:39:01 - progress_bar.py[line:274] - INFO: epoch 012:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17485, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3258.2, ups=0.19, wpb=17485, bsz=1024, num_updates=4370, lr=4.68405e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=28487
2024-11-12 13:39:56 - progress_bar.py[line:274] - INFO: epoch 012:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17643.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3218.6, ups=0.18, wpb=17643.2, bsz=1024, num_updates=4380, lr=4.6826e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=28541
2024-11-12 13:40:51 - progress_bar.py[line:274] - INFO: epoch 012:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17650.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3195.3, ups=0.18, wpb=17650.9, bsz=1024, num_updates=4390, lr=4.68114e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=28597
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-12 13:40:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4392 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-12 13:40:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 13:42:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
2024-11-12 13:44:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4392 updates, score 0) (writing took 229.155495865969 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
2024-11-12 13:45:45 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-12 13:45:45 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.684 | ntokens 17394.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.42 | wps 2638.2 | ups 0.15 | wpb 17394.9 | bsz 1023.1 | num_updates 4392 | lr 4.68085e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1297 | gb_free 13.4 | wall 28891
2024-11-12 13:45:45 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 13:48:18 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-12 13:48:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 13:49:03 - progress_bar.py[line:274] - INFO: epoch 013:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=16733.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=340, ups=0.02, wpb=16733.3, bsz=998.4, num_updates=4400, lr=4.67969e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.3, wall=29089
2024-11-12 13:49:58 - progress_bar.py[line:274] - INFO: epoch 013:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17436.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3166.6, ups=0.18, wpb=17436.6, bsz=1024, num_updates=4410, lr=4.67824e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=29144
2024-11-12 13:50:55 - progress_bar.py[line:274] - INFO: epoch 013:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17282.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3051.2, ups=0.18, wpb=17282.7, bsz=1024, num_updates=4420, lr=4.67678e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=29200
2024-11-12 13:51:52 - progress_bar.py[line:274] - INFO: epoch 013:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17530.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3055.2, ups=0.17, wpb=17530.5, bsz=1024, num_updates=4430, lr=4.67533e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=29258
2024-11-12 13:52:49 - progress_bar.py[line:274] - INFO: epoch 013:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17402.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3058.4, ups=0.18, wpb=17402.5, bsz=1024, num_updates=4440, lr=4.67388e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=29315
2024-11-12 13:53:46 - progress_bar.py[line:274] - INFO: epoch 013:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17377.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3069, ups=0.18, wpb=17377.8, bsz=1024, num_updates=4450, lr=4.67242e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=29371
2024-11-12 13:54:42 - progress_bar.py[line:274] - INFO: epoch 013:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17540.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3130.8, ups=0.18, wpb=17540.3, bsz=1024, num_updates=4460, lr=4.67097e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=29427
2024-11-12 13:55:39 - progress_bar.py[line:274] - INFO: epoch 013:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17384.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3060.5, ups=0.18, wpb=17384.5, bsz=1024, num_updates=4470, lr=4.66952e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=29484
2024-11-12 13:56:35 - progress_bar.py[line:274] - INFO: epoch 013:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17529.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3102.4, ups=0.18, wpb=17529.9, bsz=1024, num_updates=4480, lr=4.66806e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=29541
2024-11-12 13:57:32 - progress_bar.py[line:274] - INFO: epoch 013:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17127.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3024.5, ups=0.18, wpb=17127.3, bsz=1024, num_updates=4490, lr=4.66661e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=29597
2024-11-12 13:58:28 - progress_bar.py[line:274] - INFO: epoch 013:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17159.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3025.1, ups=0.18, wpb=17159.4, bsz=1024, num_updates=4500, lr=4.66516e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=29654
2024-11-12 13:59:25 - progress_bar.py[line:274] - INFO: epoch 013:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17392.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3092.1, ups=0.18, wpb=17392.6, bsz=1024, num_updates=4510, lr=4.6637e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=29710
2024-11-12 14:00:21 - progress_bar.py[line:274] - INFO: epoch 013:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17249, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3086.3, ups=0.18, wpb=17249, bsz=1024, num_updates=4520, lr=4.66225e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=29766
2024-11-12 14:01:17 - progress_bar.py[line:274] - INFO: epoch 013:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17484.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3116.3, ups=0.18, wpb=17484.2, bsz=1024, num_updates=4530, lr=4.6608e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=29822
2024-11-12 14:02:12 - progress_bar.py[line:274] - INFO: epoch 013:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17385.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3137.6, ups=0.18, wpb=17385.1, bsz=1015.4, num_updates=4540, lr=4.65934e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=29878
2024-11-12 14:03:07 - progress_bar.py[line:274] - INFO: epoch 013:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17362.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3141.8, ups=0.18, wpb=17362.9, bsz=1024, num_updates=4550, lr=4.65789e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=29933
2024-11-12 14:04:03 - progress_bar.py[line:274] - INFO: epoch 013:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17455.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3124, ups=0.18, wpb=17455.5, bsz=1024, num_updates=4560, lr=4.65644e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=29989
2024-11-12 14:04:59 - progress_bar.py[line:274] - INFO: epoch 013:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17288.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3088.7, ups=0.18, wpb=17288.5, bsz=1024, num_updates=4570, lr=4.65498e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=30045
2024-11-12 14:05:55 - progress_bar.py[line:274] - INFO: epoch 013:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17027, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3052.1, ups=0.18, wpb=17027, bsz=1024, num_updates=4580, lr=4.65353e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=30101
2024-11-12 14:06:51 - progress_bar.py[line:274] - INFO: epoch 013:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17427.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3118, ups=0.18, wpb=17427.5, bsz=1024, num_updates=4590, lr=4.65208e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=30156
2024-11-12 14:07:46 - progress_bar.py[line:274] - INFO: epoch 013:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17566.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3183.7, ups=0.18, wpb=17566.9, bsz=1024, num_updates=4600, lr=4.65062e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=30212
2024-11-12 14:08:42 - progress_bar.py[line:274] - INFO: epoch 013:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17464.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3128.3, ups=0.18, wpb=17464.7, bsz=1024, num_updates=4610, lr=4.64917e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=42, gb_free=13.3, wall=30267
2024-11-12 14:09:38 - progress_bar.py[line:274] - INFO: epoch 013:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17241.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3085.1, ups=0.18, wpb=17241.5, bsz=1024, num_updates=4620, lr=4.64772e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=40, gb_free=13.4, wall=30323
2024-11-12 14:10:34 - progress_bar.py[line:274] - INFO: epoch 013:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3091.1, ups=0.18, wpb=17455, bsz=1024, num_updates=4630, lr=4.64626e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=30380
2024-11-12 14:11:30 - progress_bar.py[line:274] - INFO: epoch 013:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17327.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3083.3, ups=0.18, wpb=17327.3, bsz=1024, num_updates=4640, lr=4.64481e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=30436
2024-11-12 14:12:26 - progress_bar.py[line:274] - INFO: epoch 013:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17510, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3159, ups=0.18, wpb=17510, bsz=1024, num_updates=4650, lr=4.64336e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=30491
2024-11-12 14:13:21 - progress_bar.py[line:274] - INFO: epoch 013:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17257.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3116.5, ups=0.18, wpb=17257.9, bsz=1024, num_updates=4660, lr=4.6419e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=30547
2024-11-12 14:14:17 - progress_bar.py[line:274] - INFO: epoch 013:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17399.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3116.5, ups=0.18, wpb=17399.9, bsz=1024, num_updates=4670, lr=4.64045e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=30603
2024-11-12 14:15:13 - progress_bar.py[line:274] - INFO: epoch 013:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17320.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3098.2, ups=0.18, wpb=17320.9, bsz=1024, num_updates=4680, lr=4.639e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=30659
2024-11-12 14:16:09 - progress_bar.py[line:274] - INFO: epoch 013:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17593.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3159.2, ups=0.18, wpb=17593.7, bsz=1024, num_updates=4690, lr=4.63754e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=30714
2024-11-12 14:17:04 - progress_bar.py[line:274] - INFO: epoch 013:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17426.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3136.5, ups=0.18, wpb=17426.5, bsz=1024, num_updates=4700, lr=4.63609e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=30770
2024-11-12 14:18:00 - progress_bar.py[line:274] - INFO: epoch 013:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17627.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3180.7, ups=0.18, wpb=17627.2, bsz=1024, num_updates=4710, lr=4.63464e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=30825
2024-11-12 14:18:53 - progress_bar.py[line:274] - INFO: epoch 013:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17730.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3318.4, ups=0.19, wpb=17730.8, bsz=1024, num_updates=4720, lr=4.63318e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.3, wall=30879
2024-11-12 14:19:46 - progress_bar.py[line:274] - INFO: epoch 013:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17648.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3352.1, ups=0.19, wpb=17648.7, bsz=1024, num_updates=4730, lr=4.63173e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=30931
2024-11-12 14:20:39 - progress_bar.py[line:274] - INFO: epoch 013:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17802.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3327.6, ups=0.19, wpb=17802.5, bsz=1024, num_updates=4740, lr=4.63028e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=30985
2024-11-12 14:21:33 - progress_bar.py[line:274] - INFO: epoch 013:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17781.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3318.8, ups=0.19, wpb=17781.5, bsz=1024, num_updates=4750, lr=4.62882e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=31038
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt2024-11-12 14:22:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 4758 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
2024-11-12 14:22:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 14:24:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
2024-11-12 14:25:55 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 4758 updates, score 0) (writing took 222.2835957260104 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-12 14:26:50 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-12 14:26:50 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.684 | ntokens 17409.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.43 | wps 2585.4 | ups 0.15 | wpb 17409.2 | bsz 1023.1 | num_updates 4758 | lr 4.62766e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1845 | gb_free 13.4 | wall 31356
2024-11-12 14:26:50 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 14:29:21 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-12 14:29:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 14:29:35 - progress_bar.py[line:274] - INFO: epoch 014:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=16883.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=350.3, ups=0.02, wpb=16883.3, bsz=998.4, num_updates=4760, lr=4.62737e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=31520
2024-11-12 14:30:33 - progress_bar.py[line:274] - INFO: epoch 014:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17383.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3004.6, ups=0.17, wpb=17383.9, bsz=1024, num_updates=4770, lr=4.62592e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=31578
2024-11-12 14:31:26 - progress_bar.py[line:274] - INFO: epoch 014:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17339.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3259.4, ups=0.19, wpb=17339.3, bsz=1024, num_updates=4780, lr=4.62446e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31631
2024-11-12 14:32:19 - progress_bar.py[line:274] - INFO: epoch 014:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17402.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3249.9, ups=0.19, wpb=17402.3, bsz=1024, num_updates=4790, lr=4.62301e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=31685
2024-11-12 14:33:13 - progress_bar.py[line:274] - INFO: epoch 014:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17564.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3288.9, ups=0.19, wpb=17564.8, bsz=1024, num_updates=4800, lr=4.62156e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=31738
2024-11-12 14:34:06 - progress_bar.py[line:274] - INFO: epoch 014:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17232.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3236.1, ups=0.19, wpb=17232.2, bsz=1024, num_updates=4810, lr=4.6201e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=31792
2024-11-12 14:34:59 - progress_bar.py[line:274] - INFO: epoch 014:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17421.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3285.7, ups=0.19, wpb=17421.4, bsz=1024, num_updates=4820, lr=4.61865e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=31845
2024-11-12 14:35:54 - progress_bar.py[line:274] - INFO: epoch 014:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17465.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3196.8, ups=0.18, wpb=17465.8, bsz=1024, num_updates=4830, lr=4.6172e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=31899
2024-11-12 14:36:50 - progress_bar.py[line:274] - INFO: epoch 014:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3125.4, ups=0.18, wpb=17570.6, bsz=1024, num_updates=4840, lr=4.61574e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=31955
2024-11-12 14:37:44 - progress_bar.py[line:274] - INFO: epoch 014:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17608, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3267.3, ups=0.19, wpb=17608, bsz=1024, num_updates=4850, lr=4.61429e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32009
2024-11-12 14:38:37 - progress_bar.py[line:274] - INFO: epoch 014:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3244, ups=0.19, wpb=17219.7, bsz=1024, num_updates=4860, lr=4.61284e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32062
2024-11-12 14:39:31 - progress_bar.py[line:274] - INFO: epoch 014:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17339.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3202.3, ups=0.18, wpb=17339.1, bsz=1024, num_updates=4870, lr=4.61138e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32117
2024-11-12 14:40:25 - progress_bar.py[line:274] - INFO: epoch 014:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17318, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3188.1, ups=0.18, wpb=17318, bsz=1024, num_updates=4880, lr=4.60993e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32171
2024-11-12 14:41:20 - progress_bar.py[line:274] - INFO: epoch 014:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17223.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3157.8, ups=0.18, wpb=17223.7, bsz=1024, num_updates=4890, lr=4.60848e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32225
2024-11-12 14:42:13 - progress_bar.py[line:274] - INFO: epoch 014:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17299.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3263.9, ups=0.19, wpb=17299.1, bsz=1015.4, num_updates=4900, lr=4.60702e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=32278
2024-11-12 14:43:07 - progress_bar.py[line:274] - INFO: epoch 014:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17518.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3252.2, ups=0.19, wpb=17518.7, bsz=1024, num_updates=4910, lr=4.60557e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32332
2024-11-12 14:44:00 - progress_bar.py[line:274] - INFO: epoch 014:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17258, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3267.8, ups=0.19, wpb=17258, bsz=1024, num_updates=4920, lr=4.60412e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32385
2024-11-12 14:44:53 - progress_bar.py[line:274] - INFO: epoch 014:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17065.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3216.5, ups=0.19, wpb=17065.7, bsz=1024, num_updates=4930, lr=4.60266e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32438
2024-11-12 14:45:47 - progress_bar.py[line:274] - INFO: epoch 014:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17189.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3177.8, ups=0.18, wpb=17189.9, bsz=1024, num_updates=4940, lr=4.60121e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32492
2024-11-12 14:46:40 - progress_bar.py[line:274] - INFO: epoch 014:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17444.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3288.4, ups=0.19, wpb=17444.4, bsz=1024, num_updates=4950, lr=4.59976e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32545
2024-11-12 14:47:32 - progress_bar.py[line:274] - INFO: epoch 014:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17363, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3307.4, ups=0.19, wpb=17363, bsz=1024, num_updates=4960, lr=4.5983e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32598
2024-11-12 14:48:26 - progress_bar.py[line:274] - INFO: epoch 014:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17507.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3233.5, ups=0.18, wpb=17507.7, bsz=1024, num_updates=4970, lr=4.59685e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32652
2024-11-12 14:49:20 - progress_bar.py[line:274] - INFO: epoch 014:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17380.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3231.5, ups=0.19, wpb=17380.9, bsz=1024, num_updates=4980, lr=4.5954e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=32706
2024-11-12 14:50:13 - progress_bar.py[line:274] - INFO: epoch 014:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17288.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3251.6, ups=0.19, wpb=17288.2, bsz=1024, num_updates=4990, lr=4.59394e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32759
2024-11-12 14:51:08 - progress_bar.py[line:274] - INFO: epoch 014:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17532.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3233.7, ups=0.18, wpb=17532.4, bsz=1024, num_updates=5000, lr=4.59249e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=32813
loss_reg: 0.006290149713126617 loss_cls: 0.0033758741337805986
loss_reg: 0.004617678644052701 loss_cls: 0.0031937584280967712
loss_reg: 0.004855556395274966 loss_cls: 0.003922454081475735
loss_reg: 0.004152097659512308 loss_cls: 0.0041860113851726055
loss_reg: 0.0038337603131663317 loss_cls: 0.004295362159609795
loss_reg: 0.004404602955289146 loss_cls: 0.003407177049666643
loss_reg: 0.004544040534933946 loss_cls: 0.00399944419041276
loss_reg: 0.004242994122587865 loss_cls: 0.0035324557684361935
loss_reg: 0.004499161848776261 loss_cls: 0.0038020911160856485
loss_reg: 0.00494465491273217 loss_cls: 0.0034541995264589787
loss_reg: 0.007923748219494695 loss_cls: 0.0029966675210744143
loss_reg: 0.004643950614917217 loss_cls: 0.003714579390361905
loss_reg: 0.006249248787229615 loss_cls: 0.004228466656059027
loss_reg: 0.007441831157207399 loss_cls: 0.0034247953444719315
loss_reg: 0.005896805656568256 loss_cls: 0.0036713702138513327
loss_reg: 0.00847554612597863 loss_cls: 0.0033082417212426662
loss_reg: 0.007964002194762097 loss_cls: 0.0031990865245461464
loss_reg: 0.005448372307728385 loss_cls: 0.0033261689823120832
loss_reg: 0.007573184960773826 loss_cls: 0.003342659445479512
loss_reg: 0.006790221561784974 loss_cls: 0.003400458488613367
loss_reg: 0.006074404766688238 loss_cls: 0.004564070142805576
loss_reg: 0.010928981324868827 loss_cls: 0.0031052129343152046
loss_reg: 0.00437614744131844 loss_cls: 0.003472117241472006
loss_reg: 0.005067670893134447 loss_cls: 0.004675994161516428
loss_reg: 0.007156136607932606 loss_cls: 0.003049589227885008
loss_reg: 0.0067853934761153405 loss_cls: 0.0029766929801553488
loss_reg: 0.005328743748501788 loss_cls: 0.0036604839842766523
loss_reg: 0.004906113069880212 loss_cls: 0.0036552452947944403
loss_reg: 0.0064688767520327045 loss_cls: 0.0049304659478366375
loss_reg: 0.007214318694815559 loss_cls: 0.004346663597971201
loss_reg: 0.008096672447133881 loss_cls: 0.0033172504045069218
loss_reg: 0.0052059853550717496 loss_cls: 0.0032833332661539316
loss_reg: 0.006648230192926872 loss_cls: 0.002965585794299841
loss_reg: 0.008544323923679747 loss_cls: 0.002939781406894326
loss_reg: 0.004782285316302832 loss_cls: 0.0030955630354583263
loss_reg: 0.0077637105507543215 loss_cls: 0.003398355096578598
loss_reg: 0.006264932362110988 loss_cls: 0.004591980017721653
loss_reg: 0.006383502551555448 loss_cls: 0.004042529035359621
loss_reg: 0.00492876260876047 loss_cls: 0.0039110793732106686
loss_reg: 0.0052161937763875125 loss_cls: 0.0035583453718572855
loss_reg: 0.004914544190037892 loss_cls: 0.00366220623254776
loss_reg: 0.004160013129758519 loss_cls: 0.003947338555008173
loss_reg: 0.007293930591817609 loss_cls: 0.0030267760157585144
loss_reg: 0.00850289196639885 loss_cls: 0.0027527303900569677
loss_reg: 0.007454743261869073 loss_cls: 0.0028572576120495796
loss_reg: 0.007678703908183127 loss_cls: 0.003975199069827795
loss_reg: 0.006708351445146497 loss_cls: 0.003449109848588705
loss_reg: 0.0070487091254125625 loss_cls: 0.003324727527797222
loss_reg: 0.0067007369377720056 loss_cls: 0.0032960225362330675
loss_reg: 0.006794886187162012 loss_cls: 0.002804187824949622
loss_reg: 0.004387374284574312 loss_cls: 0.0040243263356387615
loss_reg: 0.00783823074046462 loss_cls: 0.003064894350245595
loss_reg: 0.005932918904278389 loss_cls: 0.003390321973711252
loss_reg: 0.005843136367142798 loss_cls: 0.003190333489328623
loss_reg: 0.006107736478560207 loss_cls: 0.0032295011915266514
loss_reg: 0.005620925464354783 loss_cls: 0.0029340663459151983
loss_reg: 0.004568113632219816 loss_cls: 0.003174321260303259
loss_reg: 0.007200642097558294 loss_cls: 0.003136572428047657
loss_reg: 0.004963561740779837 loss_cls: 0.0032608062028884888
loss_reg: 0.006871854736670534 loss_cls: 0.002575475722551346
loss_reg: 0.005662646267936053 loss_cls: 0.0032961403485387564
loss_reg: 0.00751621223437725 loss_cls: 0.003310878062620759
loss_reg: 0.007061715211577763 loss_cls: 0.003224312560632825
loss_reg: 0.006345194272245723 loss_cls: 0.0032127900049090385
2024-11-12 14:52:00 - progress_bar.py[line:274] - INFO: epoch 014:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17307.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3283.4, ups=0.19, wpb=17307.9, bsz=1024, num_updates=5010, lr=4.59104e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32866
2024-11-12 14:52:53 - progress_bar.py[line:274] - INFO: epoch 014:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17378.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3266.4, ups=0.19, wpb=17378.8, bsz=1024, num_updates=5020, lr=4.58958e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32919
2024-11-12 14:53:47 - progress_bar.py[line:274] - INFO: epoch 014:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17481.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3288.3, ups=0.19, wpb=17481.8, bsz=1024, num_updates=5030, lr=4.58813e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=32972
2024-11-12 14:54:42 - progress_bar.py[line:274] - INFO: epoch 014:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17507.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3177, ups=0.18, wpb=17507.6, bsz=1024, num_updates=5040, lr=4.58668e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=43, gb_free=13.3, wall=33027
2024-11-12 14:55:34 - progress_bar.py[line:274] - INFO: epoch 014:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17150.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3280.7, ups=0.19, wpb=17150.7, bsz=1024, num_updates=5050, lr=4.58522e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=45, gb_free=13.5, wall=33080
2024-11-12 14:56:29 - progress_bar.py[line:274] - INFO: epoch 014:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3206, ups=0.18, wpb=17478.4, bsz=1024, num_updates=5060, lr=4.58377e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.4, wall=33134
2024-11-12 14:57:24 - progress_bar.py[line:274] - INFO: epoch 014:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17507.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3153.4, ups=0.18, wpb=17507.6, bsz=1024, num_updates=5070, lr=4.58232e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=33190
2024-11-12 14:58:19 - progress_bar.py[line:274] - INFO: epoch 014:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17895.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3246.2, ups=0.18, wpb=17895.7, bsz=1024, num_updates=5080, lr=4.58086e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=33245
2024-11-12 14:59:14 - progress_bar.py[line:274] - INFO: epoch 014:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17551.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3187.9, ups=0.18, wpb=17551.2, bsz=1024, num_updates=5090, lr=4.57941e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=33300
2024-11-12 15:00:09 - progress_bar.py[line:274] - INFO: epoch 014:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17612.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3204.2, ups=0.18, wpb=17612.8, bsz=1024, num_updates=5100, lr=4.57796e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=33355
2024-11-12 15:01:05 - progress_bar.py[line:274] - INFO: epoch 014:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3174.4, ups=0.18, wpb=17590.9, bsz=1024, num_updates=5110, lr=4.5765e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=33410
2024-11-12 15:02:00 - progress_bar.py[line:274] - INFO: epoch 014:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17588.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3161.7, ups=0.18, wpb=17588.6, bsz=1024, num_updates=5120, lr=4.57505e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=33466
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-12 15:02:20 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5124 updates
2024-11-12 15:02:20 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 15:04:12 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
2024-11-12 15:06:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5124 updates, score 0) (writing took 226.95905751001555 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612slice_id 7 seek offset 327637

2024-11-12 15:07:02 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-12 15:07:02 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.677 | ntokens 17402.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.39 | wps 2640.3 | ups 0.15 | wpb 17402.9 | bsz 1023.1 | num_updates 5124 | lr 4.57447e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1148 | gb_free 13.4 | wall 33768
2024-11-12 15:07:02 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 15:09:35 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-12 15:09:35 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 15:10:11 - progress_bar.py[line:274] - INFO: epoch 015:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=16904.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=344.7, ups=0.02, wpb=16904.3, bsz=998.4, num_updates=5130, lr=4.5736e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=33956
2024-11-12 15:11:07 - progress_bar.py[line:274] - INFO: epoch 015:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17564.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3139, ups=0.18, wpb=17564.1, bsz=1024, num_updates=5140, lr=4.57214e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=34012
2024-11-12 15:12:01 - progress_bar.py[line:274] - INFO: epoch 015:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17350.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3194, ups=0.18, wpb=17350.7, bsz=1024, num_updates=5150, lr=4.57069e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=34067
2024-11-12 15:12:55 - progress_bar.py[line:274] - INFO: epoch 015:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17447.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3242.2, ups=0.19, wpb=17447.5, bsz=1024, num_updates=5160, lr=4.56924e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34120
2024-11-12 15:13:48 - progress_bar.py[line:274] - INFO: epoch 015:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17319.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3263.3, ups=0.19, wpb=17319.6, bsz=1024, num_updates=5170, lr=4.56778e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=34174
2024-11-12 15:14:42 - progress_bar.py[line:274] - INFO: epoch 015:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17569.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3226.9, ups=0.18, wpb=17569.5, bsz=1024, num_updates=5180, lr=4.56633e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=34228
2024-11-12 15:15:35 - progress_bar.py[line:274] - INFO: epoch 015:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17529.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3303.4, ups=0.19, wpb=17529.5, bsz=1024, num_updates=5190, lr=4.56488e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=34281
2024-11-12 15:16:29 - progress_bar.py[line:274] - INFO: epoch 015:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17435.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3234.8, ups=0.19, wpb=17435.2, bsz=1024, num_updates=5200, lr=4.56342e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=34335
2024-11-12 15:17:22 - progress_bar.py[line:274] - INFO: epoch 015:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17464.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3296.6, ups=0.19, wpb=17464.9, bsz=1024, num_updates=5210, lr=4.56197e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=34388
2024-11-12 15:18:15 - progress_bar.py[line:274] - INFO: epoch 015:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17544.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3319.7, ups=0.19, wpb=17544.3, bsz=1024, num_updates=5220, lr=4.56052e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=34441
2024-11-12 15:19:08 - progress_bar.py[line:274] - INFO: epoch 015:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17391.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3298.2, ups=0.19, wpb=17391.1, bsz=1024, num_updates=5230, lr=4.55906e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.1, wall=34493
2024-11-12 15:20:01 - progress_bar.py[line:274] - INFO: epoch 015:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17498.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3276.5, ups=0.19, wpb=17498.5, bsz=1024, num_updates=5240, lr=4.55761e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=34547
2024-11-12 15:20:55 - progress_bar.py[line:274] - INFO: epoch 015:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17420.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3269.6, ups=0.19, wpb=17420.3, bsz=1024, num_updates=5250, lr=4.55616e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=34600
2024-11-12 15:21:48 - progress_bar.py[line:274] - INFO: epoch 015:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17475.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3272.7, ups=0.19, wpb=17475.3, bsz=1024, num_updates=5260, lr=4.5547e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=34654
2024-11-12 15:22:41 - progress_bar.py[line:274] - INFO: epoch 015:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17396.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3282.5, ups=0.19, wpb=17396.8, bsz=1024, num_updates=5270, lr=4.55325e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34707
2024-11-12 15:23:34 - progress_bar.py[line:274] - INFO: epoch 015:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17160.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3244.9, ups=0.19, wpb=17160.2, bsz=1024, num_updates=5280, lr=4.5518e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34759
2024-11-12 15:24:27 - progress_bar.py[line:274] - INFO: epoch 015:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17441.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3269.6, ups=0.19, wpb=17441.3, bsz=1024, num_updates=5290, lr=4.55034e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=34813
2024-11-12 15:25:20 - progress_bar.py[line:274] - INFO: epoch 015:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17484.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3286.9, ups=0.19, wpb=17484.2, bsz=1024, num_updates=5300, lr=4.54889e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=34866
2024-11-12 15:26:14 - progress_bar.py[line:274] - INFO: epoch 015:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3262.5, ups=0.19, wpb=17370.2, bsz=1024, num_updates=5310, lr=4.54744e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=34919
2024-11-12 15:27:07 - progress_bar.py[line:274] - INFO: epoch 015:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17239.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3244.4, ups=0.19, wpb=17239.8, bsz=1024, num_updates=5320, lr=4.54598e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=34972
2024-11-12 15:28:00 - progress_bar.py[line:274] - INFO: epoch 015:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17400.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3275.3, ups=0.19, wpb=17400.7, bsz=1024, num_updates=5330, lr=4.54453e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=35026
2024-11-12 15:28:53 - progress_bar.py[line:274] - INFO: epoch 015:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3254.4, ups=0.19, wpb=17269.4, bsz=1024, num_updates=5340, lr=4.54308e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=35079
2024-11-12 15:29:47 - progress_bar.py[line:274] - INFO: epoch 015:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17661.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3280.7, ups=0.19, wpb=17661.6, bsz=1024, num_updates=5350, lr=4.54162e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=35132
2024-11-12 15:30:44 - progress_bar.py[line:274] - INFO: epoch 015:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17371, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3052, ups=0.18, wpb=17371, bsz=1024, num_updates=5360, lr=4.54017e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=36, gb_free=13.5, wall=35189
2024-11-12 15:31:37 - progress_bar.py[line:274] - INFO: epoch 015:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17444.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3296.6, ups=0.19, wpb=17444.9, bsz=1024, num_updates=5370, lr=4.53872e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=42, gb_free=13.6, wall=35242
2024-11-12 15:32:31 - progress_bar.py[line:274] - INFO: epoch 015:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17433, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3232.3, ups=0.19, wpb=17433, bsz=1024, num_updates=5380, lr=4.53726e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=35296
2024-11-12 15:33:24 - progress_bar.py[line:274] - INFO: epoch 015:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17162.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3184.3, ups=0.19, wpb=17162.9, bsz=1024, num_updates=5390, lr=4.53581e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=35350
2024-11-12 15:34:19 - progress_bar.py[line:274] - INFO: epoch 015:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=16968.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3137.2, ups=0.18, wpb=16968.3, bsz=1015.4, num_updates=5400, lr=4.53436e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=35404
2024-11-12 15:35:12 - progress_bar.py[line:274] - INFO: epoch 015:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17077.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3188.4, ups=0.19, wpb=17077.2, bsz=1024, num_updates=5410, lr=4.5329e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=35458
2024-11-12 15:36:06 - progress_bar.py[line:274] - INFO: epoch 015:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17335.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3209.1, ups=0.19, wpb=17335.6, bsz=1024, num_updates=5420, lr=4.53145e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.1, wall=35512
2024-11-12 15:37:00 - progress_bar.py[line:274] - INFO: epoch 015:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17488.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3242, ups=0.19, wpb=17488.2, bsz=1024, num_updates=5430, lr=4.53e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=35566
2024-11-12 15:37:53 - progress_bar.py[line:274] - INFO: epoch 015:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17770.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3355.3, ups=0.19, wpb=17770.5, bsz=1024, num_updates=5440, lr=4.52854e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=35619
2024-11-12 15:38:46 - progress_bar.py[line:274] - INFO: epoch 015:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3325, ups=0.19, wpb=17521.3, bsz=1024, num_updates=5450, lr=4.52709e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=35671
2024-11-12 15:39:39 - progress_bar.py[line:274] - INFO: epoch 015:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17501.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3307.5, ups=0.19, wpb=17501.2, bsz=1024, num_updates=5460, lr=4.52564e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=35724
2024-11-12 15:40:31 - progress_bar.py[line:274] - INFO: epoch 015:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17366.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3289, ups=0.19, wpb=17366.5, bsz=1024, num_updates=5470, lr=4.52418e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=35777
2024-11-12 15:41:24 - progress_bar.py[line:274] - INFO: epoch 015:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17535.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3350.6, ups=0.19, wpb=17535.8, bsz=1024, num_updates=5480, lr=4.52273e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.1, wall=35829
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-12 15:42:13 - progress_bar.py[line:274] - INFO: epoch 015:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17039.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3443, ups=0.2, wpb=17039.5, bsz=998.4, num_updates=5490, lr=4.52128e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=35879
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt2024-11-12 15:42:13 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5490 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-12 15:42:13 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 15:44:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442


slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
slice_id 7 seek offset 327637
2024-11-12 15:45:59 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5490 updates, score 0) (writing took 225.66355396597646 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-12 15:46:54 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-12 15:46:54 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.676 | ntokens 17398.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.39 | wps 2662.2 | ups 0.15 | wpb 17398.2 | bsz 1023.1 | num_updates 5490 | lr 4.52128e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1138 | gb_free 13.4 | wall 36160
2024-11-12 15:46:54 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 15:49:24 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-12 15:49:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 15:50:21 - progress_bar.py[line:274] - INFO: epoch 016:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17223.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=353.2, ups=0.02, wpb=17223.8, bsz=1024, num_updates=5500, lr=4.51982e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=36367
2024-11-12 15:51:16 - progress_bar.py[line:274] - INFO: epoch 016:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17573.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3167.2, ups=0.18, wpb=17573.7, bsz=1024, num_updates=5510, lr=4.51837e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=36422
2024-11-12 15:52:13 - progress_bar.py[line:274] - INFO: epoch 016:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17411.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3078.6, ups=0.18, wpb=17411.5, bsz=1024, num_updates=5520, lr=4.51692e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=36479
2024-11-12 15:53:10 - progress_bar.py[line:274] - INFO: epoch 016:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17458.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3047.1, ups=0.17, wpb=17458.9, bsz=1024, num_updates=5530, lr=4.51546e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=36536
2024-11-12 15:54:07 - progress_bar.py[line:274] - INFO: epoch 016:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17426, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3065.6, ups=0.18, wpb=17426, bsz=1024, num_updates=5540, lr=4.51401e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=36593
2024-11-12 15:55:03 - progress_bar.py[line:274] - INFO: epoch 016:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17492.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3114.6, ups=0.18, wpb=17492.4, bsz=1024, num_updates=5550, lr=4.51256e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=36649
2024-11-12 15:55:59 - progress_bar.py[line:274] - INFO: epoch 016:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17397.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3107.6, ups=0.18, wpb=17397.2, bsz=1024, num_updates=5560, lr=4.5111e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=36705
2024-11-12 15:56:57 - progress_bar.py[line:274] - INFO: epoch 016:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17676.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3084.4, ups=0.17, wpb=17676.4, bsz=1024, num_updates=5570, lr=4.50965e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=36762
2024-11-12 15:57:54 - progress_bar.py[line:274] - INFO: epoch 016:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17224.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3014.4, ups=0.18, wpb=17224.5, bsz=1024, num_updates=5580, lr=4.5082e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=36819
2024-11-12 15:58:51 - progress_bar.py[line:274] - INFO: epoch 016:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17345.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3009.4, ups=0.17, wpb=17345.3, bsz=1024, num_updates=5590, lr=4.50674e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=36877
2024-11-12 15:59:48 - progress_bar.py[line:274] - INFO: epoch 016:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17218.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3040.1, ups=0.18, wpb=17218.1, bsz=1024, num_updates=5600, lr=4.50529e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=36934
2024-11-12 16:00:44 - progress_bar.py[line:274] - INFO: epoch 016:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17741.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3136.5, ups=0.18, wpb=17741.6, bsz=1024, num_updates=5610, lr=4.50384e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=36990
2024-11-12 16:01:41 - progress_bar.py[line:274] - INFO: epoch 016:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17315.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3046, ups=0.18, wpb=17315.7, bsz=1024, num_updates=5620, lr=4.50238e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=37047
2024-11-12 16:02:38 - progress_bar.py[line:274] - INFO: epoch 016:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17479.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3104.5, ups=0.18, wpb=17479.3, bsz=1024, num_updates=5630, lr=4.50093e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=37103
2024-11-12 16:03:34 - progress_bar.py[line:274] - INFO: epoch 016:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17820, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3162, ups=0.18, wpb=17820, bsz=1024, num_updates=5640, lr=4.49948e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=37160
2024-11-12 16:04:31 - progress_bar.py[line:274] - INFO: epoch 016:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3078, ups=0.18, wpb=17400.1, bsz=1024, num_updates=5650, lr=4.49802e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=37216
2024-11-12 16:05:27 - progress_bar.py[line:274] - INFO: epoch 016:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17472.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3112.2, ups=0.18, wpb=17472.8, bsz=1024, num_updates=5660, lr=4.49657e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=37272
2024-11-12 16:06:28 - progress_bar.py[line:274] - INFO: epoch 016:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17462.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2840, ups=0.16, wpb=17462.4, bsz=1024, num_updates=5670, lr=4.49512e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.3, wall=37334
2024-11-12 16:07:22 - progress_bar.py[line:274] - INFO: epoch 016:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17457.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3224.6, ups=0.18, wpb=17457.9, bsz=1024, num_updates=5680, lr=4.49366e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=31, gb_free=13.3, wall=37388
2024-11-12 16:08:18 - progress_bar.py[line:274] - INFO: epoch 016:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17386.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3112.4, ups=0.18, wpb=17386.8, bsz=1024, num_updates=5690, lr=4.49221e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=37444
2024-11-12 16:08:52 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-12 16:09:19 - progress_bar.py[line:274] - INFO: epoch 016:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17549.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2892.2, ups=0.16, wpb=17549.5, bsz=1024, num_updates=5700, lr=4.49076e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=38, gb_free=13.2, wall=37504
2024-11-12 16:10:14 - progress_bar.py[line:274] - INFO: epoch 016:    221 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17373.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3145, ups=0.18, wpb=17373.7, bsz=1024, num_updates=5710, lr=4.4893e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=34, gb_free=13.5, wall=37560
2024-11-12 16:11:10 - progress_bar.py[line:274] - INFO: epoch 016:    231 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17268.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3115.3, ups=0.18, wpb=17268.8, bsz=1024, num_updates=5720, lr=4.48785e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=43, gb_free=13.4, wall=37615
2024-11-12 16:12:05 - progress_bar.py[line:274] - INFO: epoch 016:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17346.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3138.1, ups=0.18, wpb=17346.7, bsz=1024, num_updates=5730, lr=4.4864e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=37670
2024-11-12 16:13:00 - progress_bar.py[line:274] - INFO: epoch 016:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17331.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3143.5, ups=0.18, wpb=17331.4, bsz=1024, num_updates=5740, lr=4.48494e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=47, gb_free=13.4, wall=37726
2024-11-12 16:13:55 - progress_bar.py[line:274] - INFO: epoch 016:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17097.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3121.2, ups=0.18, wpb=17097.3, bsz=1024, num_updates=5750, lr=4.48349e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=41, gb_free=13.5, wall=37780
2024-11-12 16:14:50 - progress_bar.py[line:274] - INFO: epoch 016:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17601.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3188, ups=0.18, wpb=17601.3, bsz=1024, num_updates=5760, lr=4.48204e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=37836
2024-11-12 16:15:44 - progress_bar.py[line:274] - INFO: epoch 016:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17197.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3154.2, ups=0.18, wpb=17197.2, bsz=1024, num_updates=5770, lr=4.48058e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=37890
2024-11-12 16:16:38 - progress_bar.py[line:274] - INFO: epoch 016:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17559.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3278.9, ups=0.19, wpb=17559.7, bsz=1024, num_updates=5780, lr=4.47913e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=37944
2024-11-12 16:17:32 - progress_bar.py[line:274] - INFO: epoch 016:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17251.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3213, ups=0.19, wpb=17251.3, bsz=1024, num_updates=5790, lr=4.47768e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=37997
2024-11-12 16:18:25 - progress_bar.py[line:274] - INFO: epoch 016:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17567.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3290.2, ups=0.19, wpb=17567.2, bsz=1024, num_updates=5800, lr=4.47622e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=32, gb_free=13.5, wall=38051
2024-11-12 16:19:18 - progress_bar.py[line:274] - INFO: epoch 016:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=18035.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3382, ups=0.19, wpb=18035.1, bsz=1024, num_updates=5810, lr=4.47477e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=36, gb_free=13.4, wall=38104
2024-11-12 16:20:13 - progress_bar.py[line:274] - INFO: epoch 016:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17692.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3231, ups=0.18, wpb=17692.4, bsz=1024, num_updates=5820, lr=4.47332e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=38159
2024-11-12 16:21:07 - progress_bar.py[line:274] - INFO: epoch 016:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17601.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3288, ups=0.19, wpb=17601.4, bsz=1015.4, num_updates=5830, lr=4.47186e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=38212
2024-11-12 16:22:06 - progress_bar.py[line:274] - INFO: epoch 016:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17413.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2948.5, ups=0.17, wpb=17413.4, bsz=1024, num_updates=5840, lr=4.47041e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=38271
2024-11-12 16:23:04 - progress_bar.py[line:274] - INFO: epoch 016:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17664.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3039.4, ups=0.17, wpb=17664.7, bsz=1024, num_updates=5850, lr=4.46896e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=38330
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-12 16:23:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 5855 updates
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-12 16:23:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 16:25:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-12 16:27:17 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 5855 updates, score 0) (writing took 225.97345561289694 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-12 16:28:14 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-12 16:28:14 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.673 | ntokens 17447 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.38 | wps 2568.6 | ups 0.15 | wpb 17447 | bsz 1023.1 | num_updates 5855 | lr 4.46823e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1256 | gb_free 13.4 | wall 38639
2024-11-12 16:28:14 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-12 16:30:49 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-12 16:30:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 16:31:18 - progress_bar.py[line:274] - INFO: epoch 017:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=16982.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=343.5, ups=0.02, wpb=16982.3, bsz=998.4, num_updates=5860, lr=4.4675e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38824
2024-11-12 16:32:13 - progress_bar.py[line:274] - INFO: epoch 017:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17387.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3202.8, ups=0.18, wpb=17387.6, bsz=1024, num_updates=5870, lr=4.46605e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=35, gb_free=13.5, wall=38878
2024-11-12 16:33:07 - progress_bar.py[line:274] - INFO: epoch 017:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17330.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3205.3, ups=0.18, wpb=17330.1, bsz=1024, num_updates=5880, lr=4.4646e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=38932
2024-11-12 16:34:04 - progress_bar.py[line:274] - INFO: epoch 017:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17389.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3029.6, ups=0.17, wpb=17389.5, bsz=1024, num_updates=5890, lr=4.46314e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=38990
2024-11-12 16:34:57 - progress_bar.py[line:274] - INFO: epoch 017:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17574.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3315.4, ups=0.19, wpb=17574.1, bsz=1024, num_updates=5900, lr=4.46169e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=39043
2024-11-12 16:35:54 - progress_bar.py[line:274] - INFO: epoch 017:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17368.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3070.9, ups=0.18, wpb=17368.3, bsz=1024, num_updates=5910, lr=4.46024e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.6, wall=39099
2024-11-12 16:36:50 - progress_bar.py[line:274] - INFO: epoch 017:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17296.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3069.4, ups=0.18, wpb=17296.6, bsz=1024, num_updates=5920, lr=4.45878e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=39156
2024-11-12 16:37:46 - progress_bar.py[line:274] - INFO: epoch 017:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17223.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3068.2, ups=0.18, wpb=17223.2, bsz=1024, num_updates=5930, lr=4.45733e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=39212
2024-11-12 16:38:43 - progress_bar.py[line:274] - INFO: epoch 017:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17419.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3089.2, ups=0.18, wpb=17419.9, bsz=1024, num_updates=5940, lr=4.45588e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39268
2024-11-12 16:39:39 - progress_bar.py[line:274] - INFO: epoch 017:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17437.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3113.5, ups=0.18, wpb=17437.8, bsz=1024, num_updates=5950, lr=4.45442e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=39324
2024-11-12 16:40:35 - progress_bar.py[line:274] - INFO: epoch 017:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17365.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3088.1, ups=0.18, wpb=17365.4, bsz=1024, num_updates=5960, lr=4.45297e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=39380
2024-11-12 16:41:31 - progress_bar.py[line:274] - INFO: epoch 017:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17322.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3076.9, ups=0.18, wpb=17322.5, bsz=1024, num_updates=5970, lr=4.45152e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=39437
2024-11-12 16:42:27 - progress_bar.py[line:274] - INFO: epoch 017:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17286.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3073.3, ups=0.18, wpb=17286.1, bsz=1024, num_updates=5980, lr=4.45006e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39493
2024-11-12 16:43:23 - progress_bar.py[line:274] - INFO: epoch 017:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17468.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3112.2, ups=0.18, wpb=17468.2, bsz=1024, num_updates=5990, lr=4.44861e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=39549
2024-11-12 16:44:20 - progress_bar.py[line:274] - INFO: epoch 017:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17460.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3063.5, ups=0.18, wpb=17460.7, bsz=1024, num_updates=6000, lr=4.44716e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=39606
2024-11-12 16:45:17 - progress_bar.py[line:274] - INFO: epoch 017:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17609.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3116.6, ups=0.18, wpb=17609.2, bsz=1024, num_updates=6010, lr=4.4457e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39663
2024-11-12 16:46:14 - progress_bar.py[line:274] - INFO: epoch 017:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17581.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3100, ups=0.18, wpb=17581.4, bsz=1024, num_updates=6020, lr=4.44425e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39719
2024-11-12 16:47:10 - progress_bar.py[line:274] - INFO: epoch 017:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17419.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3097.9, ups=0.18, wpb=17419.2, bsz=1024, num_updates=6030, lr=4.4428e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39776
2024-11-12 16:48:06 - progress_bar.py[line:274] - INFO: epoch 017:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3075.3, ups=0.18, wpb=17272.4, bsz=1024, num_updates=6040, lr=4.44134e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=39832
2024-11-12 16:49:03 - progress_bar.py[line:274] - INFO: epoch 017:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17506.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3056.8, ups=0.17, wpb=17506.9, bsz=1024, num_updates=6050, lr=4.43989e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=39889
2024-11-12 16:50:00 - progress_bar.py[line:274] - INFO: epoch 017:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17405.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3094.4, ups=0.18, wpb=17405.2, bsz=1024, num_updates=6060, lr=4.43844e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=39945
2024-11-12 16:50:57 - progress_bar.py[line:274] - INFO: epoch 017:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17269.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3032.8, ups=0.18, wpb=17269.2, bsz=1024, num_updates=6070, lr=4.43698e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=40002
2024-11-12 16:51:53 - progress_bar.py[line:274] - INFO: epoch 017:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17486.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3111.5, ups=0.18, wpb=17486.6, bsz=1024, num_updates=6080, lr=4.43553e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=40058
2024-11-12 16:52:48 - progress_bar.py[line:274] - INFO: epoch 017:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3182, ups=0.18, wpb=17455, bsz=1024, num_updates=6090, lr=4.43408e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=40113
2024-11-12 16:53:43 - progress_bar.py[line:274] - INFO: epoch 017:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17095.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3081.5, ups=0.18, wpb=17095.5, bsz=1024, num_updates=6100, lr=4.43262e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=40169
2024-11-12 16:54:40 - progress_bar.py[line:274] - INFO: epoch 017:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17275.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3020.2, ups=0.17, wpb=17275.9, bsz=1024, num_updates=6110, lr=4.43117e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=40226
2024-11-12 16:55:36 - progress_bar.py[line:274] - INFO: epoch 017:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17235.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3065.4, ups=0.18, wpb=17235.3, bsz=1024, num_updates=6120, lr=4.42972e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=40282
2024-11-12 16:56:33 - progress_bar.py[line:274] - INFO: epoch 017:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17435.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3075.4, ups=0.18, wpb=17435.1, bsz=1024, num_updates=6130, lr=4.42826e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=40339
2024-11-12 16:57:29 - progress_bar.py[line:274] - INFO: epoch 017:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17287.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3096.3, ups=0.18, wpb=17287.8, bsz=1024, num_updates=6140, lr=4.42681e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=48, gb_free=13.5, wall=40395
2024-11-12 16:58:26 - progress_bar.py[line:274] - INFO: epoch 017:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17115.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3008.6, ups=0.18, wpb=17115.6, bsz=1024, num_updates=6150, lr=4.42536e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=40452
2024-11-12 16:59:22 - progress_bar.py[line:274] - INFO: epoch 017:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17481.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3100.8, ups=0.18, wpb=17481.6, bsz=1024, num_updates=6160, lr=4.4239e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=40508
2024-11-12 17:00:19 - progress_bar.py[line:274] - INFO: epoch 017:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17811.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3165.3, ups=0.18, wpb=17811.2, bsz=1024, num_updates=6170, lr=4.42245e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=40564
2024-11-12 17:01:15 - progress_bar.py[line:274] - INFO: epoch 017:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17492.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3105.6, ups=0.18, wpb=17492.4, bsz=1024, num_updates=6180, lr=4.421e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=40621
2024-11-12 17:02:13 - progress_bar.py[line:274] - INFO: epoch 017:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17380.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3010.1, ups=0.17, wpb=17380.1, bsz=1024, num_updates=6190, lr=4.41954e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=40678
2024-11-12 17:03:07 - progress_bar.py[line:274] - INFO: epoch 017:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17578.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3251.5, ups=0.18, wpb=17578.5, bsz=1024, num_updates=6200, lr=4.41809e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=40732
2024-11-12 17:04:02 - progress_bar.py[line:274] - INFO: epoch 017:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17484.5, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3145.1, ups=0.18, wpb=17484.5, bsz=1015.4, num_updates=6210, lr=4.41664e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=40788
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-12 17:04:58 - progress_bar.py[line:274] - INFO: epoch 017:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17711.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3173.5, ups=0.18, wpb=17711.3, bsz=1024, num_updates=6220, lr=4.41518e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=40844
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt2024-11-12 17:05:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6221 updates

cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-12 17:05:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 17:06:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
2024-11-12 17:08:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6221 updates, score 0) (writing took 227.04599334893283 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_resume_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
