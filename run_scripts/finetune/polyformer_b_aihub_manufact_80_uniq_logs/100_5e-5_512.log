/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:32 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-09 10:43:34 - utils.py[line:261] - INFO: Start init
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-09 10:43:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 3
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 2
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 5
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 6
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 1
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 0
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 7
single-machine distributed training is initialized.
2024-11-09 10:43:34 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 10:43:34 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 4
single-machine distributed training is initialized.
2024-11-09 10:43:38 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512', 'restore_file': '../pretrain/polyformer_b_pretrain_aihub_manufact_uniq_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.7740.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv,../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../pretrain/polyformer_b_pretrain_aihub_manufact_uniq_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.7740.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv,../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-09 10:43:38 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-09 10:43:38 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

2024-11-09 10:43:52 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-09 10:43:52 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-09 10:43:52 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-09 10:43:52 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-09 10:43:52 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-09 10:43:52 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 4 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 7 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 1 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 2 row count 6955 total row count 55640
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 0 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 5 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 6 row count 6955 total row count 55640
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_val.tsv slice_id 3 row count 6955 total row count 55640
2024-11-09 10:44:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-09 10:44:15 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-09 10:44:15 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-09 10:44:17 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 10:44:17 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-09 10:44:17 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-09 10:44:17 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-09 10:44:17 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../pretrain/polyformer_b_pretrain_aihub_manufact_uniq_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.7740.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 10:44:28 - trainer.py[line:619] - INFO: Loaded checkpoint ../pretrain/polyformer_b_pretrain_aihub_manufact_uniq_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.7740.pt (epoch 20 @ 0 updates)
2024-11-09 10:44:28 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 6 seek offset 300000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 5 seek offset 250000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
slice_id 0 seek offset 0
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
2024-11-09 10:47:13 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-09 10:47:13 - train.py[line:297] - INFO: Start iterating over samples
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
Total steps 39100, warmup steps 2346, warmup_factor 0.00042625745950554135
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.0857446564761166 loss_cls: 0.010018018074333668
loss_reg: 0.07644580590770887 loss_cls: 0.008724049665033817
loss_reg: 0.05519463175461785 loss_cls: 0.007200537249445915
loss_reg: 0.08155719347097419 loss_cls: 0.008217128925025463
loss_reg: 0.0872048456799959 loss_cls: 0.010196604765951633
loss_reg: 0.07691476422180796 loss_cls: 0.008865575306117535
loss_reg: 0.05746724411784366 loss_cls: 0.008279303088784218
loss_reg: 0.07837634739548703 loss_cls: 0.009154497645795345
loss_reg: 0.1058654996930444 loss_cls: 0.012574452906847
loss_reg: 0.10589975843697849 loss_cls: 0.012861870229244232
loss_reg: 0.07984440708794338 loss_cls: 0.010100601240992546
loss_reg: 0.07684384348644156 loss_cls: 0.010292398743331432
loss_reg: 0.08983463276875571 loss_cls: 0.009815984405577183
loss_reg: 0.06238788934462636 loss_cls: 0.007784638088196516
loss_reg: 0.05527946302335996 loss_cls: 0.0076294769532978535
loss_reg: 0.07327979054814351 loss_cls: 0.007271903567016125
loss_reg: 0.07770149707485789 loss_cls: 0.009003965184092522
loss_reg: 0.08063962506075781 loss_cls: 0.009050996974110603
loss_reg: 0.06495236972838182 loss_cls: 0.008460640907287598
loss_reg: 0.0766175743013391 loss_cls: 0.007942663505673409
loss_reg: 0.07282320918314532 loss_cls: 0.008400925435125828
loss_reg: 0.09309804822199075 loss_cls: 0.012640144675970078
loss_reg: 0.05670073664943756 loss_cls: 0.008326085284352303
loss_reg: 0.0719364035061464 loss_cls: 0.009320678189396858
loss_reg: 0.07424742512818826 loss_cls: 0.008184174075722694
loss_reg: 0.07188135477388627 loss_cls: 0.009845234453678131
loss_reg: 0.06564300104784111 loss_cls: 0.010765932500362396
loss_reg: 0.08010433625917156 loss_cls: 0.007370890583842993
loss_reg: 0.07392022599285598 loss_cls: 0.008319794200360775
loss_reg: 0.06779082043198899 loss_cls: 0.008234024979174137
loss_reg: 0.11619287852077093 loss_cls: 0.017738476395606995
loss_reg: 0.06704631138475599 loss_cls: 0.011709650978446007
loss_reg: 0.07239070891897302 loss_cls: 0.010563764721155167
loss_reg: 0.07909151591468919 loss_cls: 0.008487457409501076
loss_reg: 0.09350487440368312 loss_cls: 0.01533178798854351
loss_reg: 0.11292080930752527 loss_cls: 0.011152221821248531
loss_reg: 0.08092920997051838 loss_cls: 0.011577008292078972
loss_reg: 0.07351463886790656 loss_cls: 0.009524593129754066
loss_reg: 0.11886254573377669 loss_cls: 0.013608239591121674
loss_reg: 0.07735493214410151 loss_cls: 0.008194971829652786
loss_reg: 0.07023074738287667 loss_cls: 0.00902686920017004
loss_reg: 0.10090206362616809 loss_cls: 0.010366925969719887
loss_reg: 0.07589903724174407 loss_cls: 0.008993986062705517
loss_reg: 0.09287224952091148 loss_cls: 0.011584814637899399
loss_reg: 0.07046671159966862 loss_cls: 0.009095222689211369
loss_reg: 0.0851819405015365 loss_cls: 0.010453474707901478
loss_reg: 0.08566910548599906 loss_cls: 0.011249487288296223
loss_reg: 0.07419721558205819 loss_cls: 0.008487118408083916
loss_reg: 0.1074008111327329 loss_cls: 0.013047083280980587
loss_reg: 0.09222020475938505 loss_cls: 0.011381571181118488
loss_reg: 0.08861146254006587 loss_cls: 0.012485956773161888
loss_reg: 0.08038434328048386 loss_cls: 0.009925786405801773
loss_reg: 0.06413044895620527 loss_cls: 0.010856729932129383
loss_reg: 0.06639473684525254 loss_cls: 0.009199247695505619
loss_reg: 0.07377879025779588 loss_cls: 0.009428302757441998
loss_reg: 0.06575721512728598 loss_cls: 0.006967256311327219
loss_reg: 0.09765720166693237 loss_cls: 0.006630112882703543
loss_reg: 0.08272804694186425 loss_cls: 0.007917698472738266
loss_reg: 0.06694781180814646 loss_cls: 0.009467503055930138
loss_reg: 0.06071032401352475 loss_cls: 0.009976495988667011
loss_reg: 0.07671786134944777 loss_cls: 0.007058413699269295
loss_reg: 0.06917609665499773 loss_cls: 0.009042482823133469
loss_reg: 0.05278851603496221 loss_cls: 0.008637862280011177
loss_reg: 0.06390450804442706 loss_cls: 0.008130259811878204
2024-11-09 10:48:14 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 391 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=19.977, ntokens=17274.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=1.03217e+06, wps=3195.8, ups=0.19, wpb=17274.4, bsz=1024, num_updates=10, lr=2.13129e-07, gnorm=0.06, clip=0, loss_scale=128, train_wall=34, gb_free=13.4, wall=236
2024-11-09 10:49:08 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=19.589, ntokens=17090.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=788781, wps=3128.1, ups=0.18, wpb=17090.5, bsz=1024, num_updates=20, lr=4.26257e-07, gnorm=0.059, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=291
2024-11-09 10:50:02 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 391 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=19.1, ntokens=17075.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=561965, wps=3147.7, ups=0.18, wpb=17075.2, bsz=1024, num_updates=30, lr=6.39386e-07, gnorm=0.052, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=345
2024-11-09 10:50:57 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 391 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=18.186, ntokens=17116, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=298219, wps=3150.7, ups=0.18, wpb=17116, bsz=1024, num_updates=40, lr=8.52515e-07, gnorm=0.036, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=400
2024-11-09 10:51:51 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=17.32, ntokens=17336.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=163640, wps=3215.2, ups=0.19, wpb=17336.8, bsz=1024, num_updates=50, lr=1.06564e-06, gnorm=0.017, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=454
2024-11-09 10:52:46 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=15.519, ntokens=17214, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=46950.9, wps=3135.8, ups=0.18, wpb=17214, bsz=1024, num_updates=60, lr=1.27877e-06, gnorm=0.009, clip=0, loss_scale=128, train_wall=31, gb_free=13.2, wall=509
2024-11-09 10:53:40 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=13.433, ntokens=16992.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11056.7, wps=3127, ups=0.18, wpb=16992.8, bsz=1024, num_updates=70, lr=1.4919e-06, gnorm=0.008, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=563
2024-11-09 10:54:34 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=11.787, ntokens=17090.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=3533.27, wps=3177.4, ups=0.19, wpb=17090.7, bsz=1024, num_updates=80, lr=1.70503e-06, gnorm=0.006, clip=0, loss_scale=128, train_wall=31, gb_free=13.2, wall=617
2024-11-09 10:55:28 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=10.337, ntokens=17348.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=1293.18, wps=3199.9, ups=0.18, wpb=17348.2, bsz=1024, num_updates=90, lr=1.91816e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=671
2024-11-09 10:56:22 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=9.07, ntokens=17153.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=537.31, wps=3167.8, ups=0.18, wpb=17153.4, bsz=1024, num_updates=100, lr=2.13129e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=32, gb_free=13.5, wall=725
2024-11-09 10:57:16 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=8.119, ntokens=17206.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=277.95, wps=3215.7, ups=0.19, wpb=17206.3, bsz=1024, num_updates=110, lr=2.34442e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=779
2024-11-09 10:58:10 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=7.378, ntokens=17254.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=166.29, wps=3152.2, ups=0.18, wpb=17254.2, bsz=1024, num_updates=120, lr=2.55754e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13, wall=833
2024-11-09 10:59:04 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 391 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=6.766, ntokens=17431.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=108.83, wps=3247.9, ups=0.19, wpb=17431.8, bsz=1024, num_updates=130, lr=2.77067e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13, wall=887
2024-11-09 10:59:58 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=6.153, ntokens=16945.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=71.14, wps=3156.3, ups=0.19, wpb=16945.5, bsz=1024, num_updates=140, lr=2.9838e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=941
2024-11-09 11:00:52 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.834, ntokens=16856.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=57.04, wps=3109.5, ups=0.18, wpb=16856.6, bsz=1024, num_updates=150, lr=3.19693e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=995
2024-11-09 11:01:45 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.703, ntokens=17206.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=52.08, wps=3222.2, ups=0.19, wpb=17206.9, bsz=1024, num_updates=160, lr=3.41006e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=1048
2024-11-09 11:02:40 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.551, ntokens=17382.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=46.89, wps=3205.8, ups=0.18, wpb=17382.9, bsz=1024, num_updates=170, lr=3.62319e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1102
2024-11-09 11:03:33 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.369, ntokens=17123.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=41.32, wps=3176.3, ups=0.19, wpb=17123.1, bsz=1024, num_updates=180, lr=3.83632e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1156
2024-11-09 11:04:28 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.215, ntokens=16932, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=37.14, wps=3126, ups=0.18, wpb=16932, bsz=1024, num_updates=190, lr=4.04945e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1211
2024-11-09 11:05:22 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.283, ntokens=17338.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=38.94, wps=3194.8, ups=0.18, wpb=17338.5, bsz=1024, num_updates=200, lr=4.26257e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13, wall=1265
2024-11-09 11:06:16 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.115, ntokens=17086.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.66, wps=3182.8, ups=0.19, wpb=17086.5, bsz=1024, num_updates=210, lr=4.4757e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=1318
2024-11-09 11:07:09 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.095, ntokens=17141.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.19, wps=3196.3, ups=0.19, wpb=17141.9, bsz=1024, num_updates=220, lr=4.68883e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=31, gb_free=13.1, wall=1372
2024-11-09 11:08:03 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.074, ntokens=17320, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=33.69, wps=3247.7, ups=0.19, wpb=17320, bsz=1024, num_updates=230, lr=4.90196e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1425
2024-11-09 11:08:56 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.037, ntokens=17276.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=32.83, wps=3220, ups=0.19, wpb=17276.5, bsz=1024, num_updates=240, lr=5.11509e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1479
2024-11-09 11:09:50 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=5.029, ntokens=17325.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=32.65, wps=3231.7, ups=0.19, wpb=17325.8, bsz=1024, num_updates=250, lr=5.32822e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=12.8, wall=1533
2024-11-09 11:10:44 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.963, ntokens=17284.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.19, wps=3186.7, ups=0.18, wpb=17284.5, bsz=1024, num_updates=260, lr=5.54135e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1587
2024-11-09 11:11:38 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.861, ntokens=16949.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.05, wps=3128.1, ups=0.18, wpb=16949.5, bsz=1024, num_updates=270, lr=5.75448e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1641
2024-11-09 11:12:32 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.916, ntokens=17230.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=30.2, wps=3184.7, ups=0.18, wpb=17230.3, bsz=1024, num_updates=280, lr=5.9676e-06, gnorm=0.002, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1695
2024-11-09 11:13:26 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.859, ntokens=17092.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.01, wps=3191, ups=0.19, wpb=17092.1, bsz=1024, num_updates=290, lr=6.18073e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=1749
2024-11-09 11:14:19 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.862, ntokens=17215.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.07, wps=3216.3, ups=0.19, wpb=17215.6, bsz=1024, num_updates=300, lr=6.39386e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1802
2024-11-09 11:15:14 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.858, ntokens=17369.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.01, wps=3199, ups=0.18, wpb=17369.2, bsz=1024, num_updates=310, lr=6.60699e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=1857
2024-11-09 11:16:08 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.819, ntokens=17242.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.24, wps=3168.5, ups=0.18, wpb=17242.1, bsz=1024, num_updates=320, lr=6.82012e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=1911
2024-11-09 11:17:02 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.796, ntokens=17153.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.77, wps=3198.3, ups=0.19, wpb=17153.7, bsz=1024, num_updates=330, lr=7.03325e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1965
2024-11-09 11:17:55 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.813, ntokens=17199.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.11, wps=3224.9, ups=0.19, wpb=17199.8, bsz=1024, num_updates=340, lr=7.24638e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=2018
2024-11-09 11:18:49 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.767, ntokens=17076.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.23, wps=3192.7, ups=0.19, wpb=17076.5, bsz=1024, num_updates=350, lr=7.45951e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2072
2024-11-09 11:19:42 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.821, ntokens=17571.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.26, wps=3272.3, ups=0.19, wpb=17571.7, bsz=1024, num_updates=360, lr=7.67263e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2125
2024-11-09 11:20:36 - progress_bar.py[line:274] - INFO: epoch 001:    370 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.775, ntokens=17561.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.38, wps=3267.2, ups=0.19, wpb=17561.1, bsz=1024, num_updates=370, lr=7.88576e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=2179
2024-11-09 11:21:28 - progress_bar.py[line:274] - INFO: epoch 001:    380 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.727, ntokens=17168.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.49, wps=3318, ups=0.19, wpb=17168.2, bsz=1024, num_updates=380, lr=8.09889e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2231
2024-11-09 11:22:19 - progress_bar.py[line:274] - INFO: epoch 001:    390 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.699, ntokens=17179.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.98, wps=3338.3, ups=0.19, wpb=17179.4, bsz=1024, num_updates=390, lr=8.31202e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2282
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt


2024-11-09 11:22:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 391 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt

2024-11-09 11:22:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
: No such file or directory
cp: cp: cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory

cp: cp: cp: cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory: No such file or directory: No such file or directory


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 11:22:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 11:22:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 391 updates, score 0) (writing took 22.429828271036968 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-09 11:22:48 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-09 11:22:48 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 7.902 | ntokens 17184.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 239.14 | wps 3156.4 | ups 0.18 | wpb 17184.5 | bsz 1023 | num_updates 391 | lr 8.33333e-06 | gnorm 0.009 | clip 0 | loss_scale 128 | train_wall 1192 | gb_free 13.3 | wall 2311
2024-11-09 11:22:48 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 11:25:29 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-09 11:25:29 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 11:26:19 - progress_bar.py[line:274] - INFO: epoch 002:      9 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.725, ntokens=16669.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=26.44, wps=694.5, ups=0.04, wpb=16669.3, bsz=985.6, num_updates=400, lr=8.52515e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=29, gb_free=13.3, wall=2522
2024-11-09 11:27:12 - progress_bar.py[line:274] - INFO: epoch 002:     19 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.684, ntokens=17214.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.71, wps=3253.1, ups=0.19, wpb=17214.3, bsz=1024, num_updates=410, lr=8.73828e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2575
2024-11-09 11:28:06 - progress_bar.py[line:274] - INFO: epoch 002:     29 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.686, ntokens=17238.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.74, wps=3205, ups=0.19, wpb=17238.1, bsz=1024, num_updates=420, lr=8.95141e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2629
2024-11-09 11:29:00 - progress_bar.py[line:274] - INFO: epoch 002:     39 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.629, ntokens=17114.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.75, wps=3189.9, ups=0.19, wpb=17114.4, bsz=1024, num_updates=430, lr=9.16454e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2683
2024-11-09 11:29:53 - progress_bar.py[line:274] - INFO: epoch 002:     49 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.682, ntokens=17410.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.67, wps=3237.5, ups=0.19, wpb=17410.9, bsz=1024, num_updates=440, lr=9.37766e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=2736
2024-11-09 11:30:47 - progress_bar.py[line:274] - INFO: epoch 002:     59 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.62, ntokens=17125.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.59, wps=3213.5, ups=0.19, wpb=17125.5, bsz=1024, num_updates=450, lr=9.59079e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2790
2024-11-09 11:31:41 - progress_bar.py[line:274] - INFO: epoch 002:     69 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.603, ntokens=17083.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.31, wps=3145.1, ups=0.18, wpb=17083.5, bsz=1024, num_updates=460, lr=9.80392e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=2844
2024-11-09 11:32:35 - progress_bar.py[line:274] - INFO: epoch 002:     79 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.642, ntokens=17300.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.96, wps=3233.1, ups=0.19, wpb=17300.7, bsz=1024, num_updates=470, lr=1.00171e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2897
2024-11-09 11:33:28 - progress_bar.py[line:274] - INFO: epoch 002:     89 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.617, ntokens=17284.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.54, wps=3224.8, ups=0.19, wpb=17284.8, bsz=1024, num_updates=480, lr=1.02302e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13, wall=2951
2024-11-09 11:34:22 - progress_bar.py[line:274] - INFO: epoch 002:     99 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.599, ntokens=17294.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.23, wps=3226.8, ups=0.19, wpb=17294.3, bsz=1024, num_updates=490, lr=1.04433e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=3005
2024-11-09 11:35:16 - progress_bar.py[line:274] - INFO: epoch 002:    109 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.58, ntokens=17213.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.91, wps=3201.3, ups=0.19, wpb=17213.5, bsz=1024, num_updates=500, lr=1.06564e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=3058
2024-11-09 11:36:09 - progress_bar.py[line:274] - INFO: epoch 002:    119 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.6, ntokens=17319, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.25, wps=3223.5, ups=0.19, wpb=17319, bsz=1024, num_updates=510, lr=1.08696e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=3112
2024-11-09 11:37:02 - progress_bar.py[line:274] - INFO: epoch 002:    129 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.558, ntokens=17173.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.56, wps=3229.6, ups=0.19, wpb=17173.4, bsz=1024, num_updates=520, lr=1.10827e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3165
2024-11-09 11:37:55 - progress_bar.py[line:274] - INFO: epoch 002:    139 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.534, ntokens=17031.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.17, wps=3218.3, ups=0.19, wpb=17031.1, bsz=1024, num_updates=530, lr=1.12958e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3218
2024-11-09 11:38:49 - progress_bar.py[line:274] - INFO: epoch 002:    149 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.482, ntokens=16985.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.35, wps=3183.9, ups=0.19, wpb=16985.5, bsz=1024, num_updates=540, lr=1.1509e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3272
2024-11-09 11:39:42 - progress_bar.py[line:274] - INFO: epoch 002:    159 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.567, ntokens=17340.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.71, wps=3235.4, ups=0.19, wpb=17340.1, bsz=1024, num_updates=550, lr=1.17221e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.1, wall=3325
2024-11-09 11:40:36 - progress_bar.py[line:274] - INFO: epoch 002:    169 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.472, ntokens=17093, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.2, wps=3175.8, ups=0.19, wpb=17093, bsz=1024, num_updates=560, lr=1.19352e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3379
2024-11-09 11:41:30 - progress_bar.py[line:274] - INFO: epoch 002:    179 / 391 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.515, ntokens=17208.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.87, wps=3214.4, ups=0.19, wpb=17208.5, bsz=1024, num_updates=570, lr=1.21483e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13, wall=3433
2024-11-09 11:42:23 - progress_bar.py[line:274] - INFO: epoch 002:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.459, ntokens=16928.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.99, wps=3164.5, ups=0.19, wpb=16928.8, bsz=1024, num_updates=580, lr=1.23615e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3486
2024-11-09 11:43:16 - progress_bar.py[line:274] - INFO: epoch 002:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.492, ntokens=17421.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.51, wps=3311.5, ups=0.19, wpb=17421.8, bsz=1024, num_updates=590, lr=1.25746e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=3539
2024-11-09 11:44:10 - progress_bar.py[line:274] - INFO: epoch 002:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.465, ntokens=17161.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.09, wps=3190.8, ups=0.19, wpb=17161.7, bsz=1024, num_updates=600, lr=1.27877e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3592
2024-11-09 11:45:03 - progress_bar.py[line:274] - INFO: epoch 002:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.458, ntokens=17159.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.98, wps=3232.8, ups=0.19, wpb=17159.4, bsz=1024, num_updates=610, lr=1.30009e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3646
2024-11-09 11:45:56 - progress_bar.py[line:274] - INFO: epoch 002:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.402, ntokens=17012.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.14, wps=3187.9, ups=0.19, wpb=17012.9, bsz=1024, num_updates=620, lr=1.3214e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13, wall=3699
2024-11-09 11:46:50 - progress_bar.py[line:274] - INFO: epoch 002:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.413, ntokens=17006.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.3, wps=3156.8, ups=0.19, wpb=17006.1, bsz=1024, num_updates=630, lr=1.34271e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=3753
2024-11-09 11:47:43 - progress_bar.py[line:274] - INFO: epoch 002:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.421, ntokens=17148.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.43, wps=3215.6, ups=0.19, wpb=17148.3, bsz=1024, num_updates=640, lr=1.36402e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3806
2024-11-09 11:48:37 - progress_bar.py[line:274] - INFO: epoch 002:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.367, ntokens=16955.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.64, wps=3159.6, ups=0.19, wpb=16955.4, bsz=1024, num_updates=650, lr=1.38534e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3860
2024-11-09 11:49:30 - progress_bar.py[line:274] - INFO: epoch 002:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.42, ntokens=17308.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.41, wps=3243.9, ups=0.19, wpb=17308.2, bsz=1024, num_updates=660, lr=1.40665e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3913
2024-11-09 11:50:24 - progress_bar.py[line:274] - INFO: epoch 002:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.382, ntokens=17196, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.86, wps=3202.1, ups=0.19, wpb=17196, bsz=1024, num_updates=670, lr=1.42796e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3967
2024-11-09 11:51:17 - progress_bar.py[line:274] - INFO: epoch 002:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.346, ntokens=16978.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.33, wps=3212.9, ups=0.19, wpb=16978.6, bsz=1024, num_updates=680, lr=1.44928e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=4020
2024-11-09 11:52:10 - progress_bar.py[line:274] - INFO: epoch 002:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.366, ntokens=17255.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.62, wps=3249.2, ups=0.19, wpb=17255.8, bsz=1024, num_updates=690, lr=1.47059e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=4073
2024-11-09 11:53:03 - progress_bar.py[line:274] - INFO: epoch 002:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.386, ntokens=17335.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.91, wps=3249, ups=0.19, wpb=17335.6, bsz=1024, num_updates=700, lr=1.4919e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4126
2024-11-09 11:53:57 - progress_bar.py[line:274] - INFO: epoch 002:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.342, ntokens=17206.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.28, wps=3202.8, ups=0.19, wpb=17206.6, bsz=1024, num_updates=710, lr=1.51321e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=4180
2024-11-09 11:54:50 - progress_bar.py[line:274] - INFO: epoch 002:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.362, ntokens=17151.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.57, wps=3216, ups=0.19, wpb=17151.2, bsz=1024, num_updates=720, lr=1.53453e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=4233
2024-11-09 11:55:44 - progress_bar.py[line:274] - INFO: epoch 002:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.304, ntokens=17157.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.75, wps=3211.9, ups=0.19, wpb=17157.5, bsz=1024, num_updates=730, lr=1.55584e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=4287
2024-11-09 11:56:37 - progress_bar.py[line:274] - INFO: epoch 002:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.317, ntokens=17216.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.94, wps=3235, ups=0.19, wpb=17216.1, bsz=1024, num_updates=740, lr=1.57715e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=4340
2024-11-09 11:57:30 - progress_bar.py[line:274] - INFO: epoch 002:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.342, ntokens=17368.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.28, wps=3286.7, ups=0.19, wpb=17368.6, bsz=1024, num_updates=750, lr=1.59847e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4393
2024-11-09 11:58:24 - progress_bar.py[line:274] - INFO: epoch 002:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.327, ntokens=17342.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.06, wps=3214.6, ups=0.19, wpb=17342.5, bsz=1024, num_updates=760, lr=1.61978e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4447
2024-11-09 11:59:15 - progress_bar.py[line:274] - INFO: epoch 002:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.314, ntokens=17286.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.89, wps=3364.1, ups=0.19, wpb=17286.5, bsz=1024, num_updates=770, lr=1.64109e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.2, wall=4498
2024-11-09 12:00:07 - progress_bar.py[line:274] - INFO: epoch 002:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.257, ntokens=16931.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.12, wps=3244.6, ups=0.19, wpb=16931.3, bsz=1024, num_updates=780, lr=1.6624e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=31, gb_free=13.2, wall=4550
2024-11-09 12:00:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 782 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-09 12:00:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 12:02:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 12:03:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 782 updates, score 0) (writing took 222.4233408619766 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-09 12:04:51 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-09 12:04:51 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 4.479 | ntokens 17168.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 22.3 | wps 2660.5 | ups 0.15 | wpb 17168.5 | bsz 1023 | num_updates 782 | lr 1.66667e-05 | gnorm 0.004 | clip 0 | loss_scale 256 | train_wall 1187 | gb_free 13.3 | wall 4834
2024-11-09 12:04:51 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 12:07:33 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-09 12:07:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 12:08:17 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.237, ntokens=16360.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=18.85, wps=333.8, ups=0.02, wpb=16360.8, bsz=985.6, num_updates=790, lr=1.68372e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=29, gb_free=13.2, wall=5040
2024-11-09 12:09:11 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.3, ntokens=17302.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.69, wps=3239.4, ups=0.19, wpb=17302.3, bsz=1024, num_updates=800, lr=1.70503e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5094
2024-11-09 12:10:04 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.257, ntokens=17261.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.12, wps=3222.8, ups=0.19, wpb=17261.2, bsz=1024, num_updates=810, lr=1.72634e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=5147
2024-11-09 12:10:58 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.236, ntokens=17109.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.84, wps=3197.1, ups=0.19, wpb=17109.7, bsz=1024, num_updates=820, lr=1.74766e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=5201
2024-11-09 12:11:51 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.236, ntokens=17276.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.84, wps=3240.9, ups=0.19, wpb=17276.6, bsz=1024, num_updates=830, lr=1.76897e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5254
2024-11-09 12:12:45 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.263, ntokens=17278.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.2, wps=3220.9, ups=0.19, wpb=17278.9, bsz=1024, num_updates=840, lr=1.79028e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5308
2024-11-09 12:13:39 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.155, ntokens=16734.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.82, wps=3091.8, ups=0.18, wpb=16734.7, bsz=1024, num_updates=850, lr=1.81159e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5362
2024-11-09 12:14:32 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.231, ntokens=17289.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.78, wps=3237, ups=0.19, wpb=17289.9, bsz=1024, num_updates=860, lr=1.83291e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5415
2024-11-09 12:15:26 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.177, ntokens=17018.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.09, wps=3160.6, ups=0.19, wpb=17018.7, bsz=1024, num_updates=870, lr=1.85422e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=5469
2024-11-09 12:16:20 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.182, ntokens=17130.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.15, wps=3205.6, ups=0.19, wpb=17130.5, bsz=1024, num_updates=880, lr=1.87553e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5523
2024-11-09 12:17:14 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.184, ntokens=17167.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.18, wps=3189.2, ups=0.19, wpb=17167.5, bsz=1024, num_updates=890, lr=1.89685e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5576
2024-11-09 12:18:07 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.21, ntokens=17369.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.51, wps=3232.2, ups=0.19, wpb=17369.4, bsz=1024, num_updates=900, lr=1.91816e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5630
2024-11-09 12:19:00 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.165, ntokens=17298, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.94, wps=3269.5, ups=0.19, wpb=17298, bsz=1024, num_updates=910, lr=1.93947e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=5683
2024-11-09 12:19:54 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.124, ntokens=17009.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.44, wps=3176, ups=0.19, wpb=17009.3, bsz=1024, num_updates=920, lr=1.96078e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5737
2024-11-09 12:20:47 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.142, ntokens=17005.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.65, wps=3180.8, ups=0.19, wpb=17005.5, bsz=1024, num_updates=930, lr=1.9821e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5790
2024-11-09 12:21:41 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.159, ntokens=17342.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.86, wps=3239, ups=0.19, wpb=17342.6, bsz=1024, num_updates=940, lr=2.00341e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5844
2024-11-09 12:22:34 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.114, ntokens=17174.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.32, wps=3211.4, ups=0.19, wpb=17174.7, bsz=1024, num_updates=950, lr=2.02472e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=5897
2024-11-09 12:23:27 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.084, ntokens=16938.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.96, wps=3186.7, ups=0.19, wpb=16938.6, bsz=1024, num_updates=960, lr=2.04604e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5950
2024-11-09 12:24:21 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.095, ntokens=16995.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.09, wps=3168, ups=0.19, wpb=16995.1, bsz=1024, num_updates=970, lr=2.06735e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=6004
2024-11-09 12:25:15 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.103, ntokens=17158.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.18, wps=3207.3, ups=0.19, wpb=17158.4, bsz=1024, num_updates=980, lr=2.08866e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=6057
2024-11-09 12:26:08 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.114, ntokens=17252.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.31, wps=3230.6, ups=0.19, wpb=17252.4, bsz=1024, num_updates=990, lr=2.10997e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=6111
2024-11-09 12:27:01 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.054, ntokens=16858.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.61, wps=3177.4, ups=0.19, wpb=16858.8, bsz=1024, num_updates=1000, lr=2.13129e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=6164
2024-11-09 12:27:54 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.105, ntokens=17330.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.21, wps=3254.6, ups=0.19, wpb=17330.5, bsz=1024, num_updates=1010, lr=2.1526e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=6217
2024-11-09 12:28:48 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.046, ntokens=17003.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.52, wps=3177.9, ups=0.19, wpb=17003.8, bsz=1024, num_updates=1020, lr=2.17391e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=6271
2024-11-09 12:29:41 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.093, ntokens=17285, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.06, wps=3218.7, ups=0.19, wpb=17285, bsz=1024, num_updates=1030, lr=2.19523e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=6324
2024-11-09 12:30:35 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.056, ntokens=17046.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.63, wps=3160, ups=0.19, wpb=17046.8, bsz=1024, num_updates=1040, lr=2.21654e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=6378
2024-11-09 12:31:28 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.089, ntokens=17333.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.02, wps=3266.6, ups=0.19, wpb=17333.3, bsz=1024, num_updates=1050, lr=2.23785e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6431
2024-11-09 12:32:22 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.039, ntokens=17095.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.44, wps=3191.5, ups=0.19, wpb=17095.5, bsz=1024, num_updates=1060, lr=2.25916e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13, wall=6485
2024-11-09 12:33:15 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.986, ntokens=16811.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.85, wps=3168.2, ups=0.19, wpb=16811.1, bsz=1024, num_updates=1070, lr=2.28048e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13, wall=6538
2024-11-09 12:34:09 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.082, ntokens=17326.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.93, wps=3241.7, ups=0.19, wpb=17326.7, bsz=1024, num_updates=1080, lr=2.30179e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6591
2024-11-09 12:35:02 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.051, ntokens=17307.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.58, wps=3239.3, ups=0.19, wpb=17307.2, bsz=1024, num_updates=1090, lr=2.3231e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6645
2024-11-09 12:35:56 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.991, ntokens=16946.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.9, wps=3153.4, ups=0.19, wpb=16946.6, bsz=1024, num_updates=1100, lr=2.34442e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6699
2024-11-09 12:36:49 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.015, ntokens=17131.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.17, wps=3235.7, ups=0.19, wpb=17131.7, bsz=1024, num_updates=1110, lr=2.36573e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6752
2024-11-09 12:37:42 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.042, ntokens=17444.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.47, wps=3268.2, ups=0.19, wpb=17444.9, bsz=1024, num_updates=1120, lr=2.38704e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6805
2024-11-09 12:38:36 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.046, ntokens=17204.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.52, wps=3212.1, ups=0.19, wpb=17204.1, bsz=1024, num_updates=1130, lr=2.40835e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6859
2024-11-09 12:39:30 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.006, ntokens=17262.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.07, wps=3196.4, ups=0.19, wpb=17262.9, bsz=1024, num_updates=1140, lr=2.42967e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=6913
2024-11-09 12:40:23 - progress_bar.py[line:274] - INFO: epoch 003:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.017, ntokens=17349.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.19, wps=3241.7, ups=0.19, wpb=17349.6, bsz=1024, num_updates=1150, lr=2.45098e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13, wall=6966
2024-11-09 12:41:15 - progress_bar.py[line:274] - INFO: epoch 003:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.992, ntokens=17224.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.92, wps=3331.8, ups=0.19, wpb=17224.5, bsz=1024, num_updates=1160, lr=2.47229e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7018
2024-11-09 12:42:06 - progress_bar.py[line:274] - INFO: epoch 003:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.007, ntokens=17109.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.08, wps=3352.8, ups=0.2, wpb=17109.3, bsz=1024, num_updates=1170, lr=2.49361e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=7069
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt2024-11-09 12:42:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1173 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-09 12:42:18 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 12:44:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-09 12:46:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1173 updates, score 0) (writing took 222.45422556897392 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-09 12:46:55 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-09 12:46:55 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 4.114 | ntokens 17144.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 17.32 | wps 2656.5 | ups 0.15 | wpb 17144.9 | bsz 1023 | num_updates 1173 | lr 2.5e-05 | gnorm 0.004 | clip 0 | loss_scale 512 | train_wall 1183 | gb_free 13.3 | wall 7358
2024-11-09 12:46:55 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 12:49:36 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-09 12:49:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 12:50:16 - progress_bar.py[line:274] - INFO: epoch 004:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.023, ntokens=16733.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=16.26, wps=341.7, ups=0.02, wpb=16733.6, bsz=985.6, num_updates=1180, lr=2.51492e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=29, gb_free=13.2, wall=7559
2024-11-09 12:51:09 - progress_bar.py[line:274] - INFO: epoch 004:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.01, ntokens=17446.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.11, wps=3286, ups=0.19, wpb=17446.3, bsz=1024, num_updates=1190, lr=2.53623e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=7612
2024-11-09 12:52:03 - progress_bar.py[line:274] - INFO: epoch 004:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.008, ntokens=17404.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.09, wps=3228, ups=0.19, wpb=17404.6, bsz=1024, num_updates=1200, lr=2.55754e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7666
2024-11-09 12:52:56 - progress_bar.py[line:274] - INFO: epoch 004:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.97, ntokens=17155.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.67, wps=3222.2, ups=0.19, wpb=17155.7, bsz=1024, num_updates=1210, lr=2.57886e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7719
2024-11-09 12:53:49 - progress_bar.py[line:274] - INFO: epoch 004:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.973, ntokens=17217, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.7, wps=3222.5, ups=0.19, wpb=17217, bsz=1024, num_updates=1220, lr=2.60017e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7772
2024-11-09 12:54:44 - progress_bar.py[line:274] - INFO: epoch 004:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.955, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.51, wps=3179.4, ups=0.18, wpb=17227.5, bsz=1024, num_updates=1230, lr=2.62148e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=7826
2024-11-09 12:55:37 - progress_bar.py[line:274] - INFO: epoch 004:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.938, ntokens=16993.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.33, wps=3165.8, ups=0.19, wpb=16993.7, bsz=1024, num_updates=1240, lr=2.6428e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7880
2024-11-09 12:56:31 - progress_bar.py[line:274] - INFO: epoch 004:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.925, ntokens=17028.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.19, wps=3179.7, ups=0.19, wpb=17028.4, bsz=1024, num_updates=1250, lr=2.66411e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7934
2024-11-09 12:57:25 - progress_bar.py[line:274] - INFO: epoch 004:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.966, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.63, wps=3189.6, ups=0.18, wpb=17291.2, bsz=1024, num_updates=1260, lr=2.68542e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=30, gb_free=13.1, wall=7988
2024-11-09 12:58:19 - progress_bar.py[line:274] - INFO: epoch 004:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.933, ntokens=17198.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.27, wps=3191.9, ups=0.19, wpb=17198.6, bsz=1024, num_updates=1270, lr=2.70673e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8042
2024-11-09 12:59:12 - progress_bar.py[line:274] - INFO: epoch 004:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.941, ntokens=17160.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.36, wps=3206.2, ups=0.19, wpb=17160.5, bsz=1024, num_updates=1280, lr=2.72805e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8095
2024-11-09 13:00:06 - progress_bar.py[line:274] - INFO: epoch 004:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.956, ntokens=17259.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.52, wps=3217.8, ups=0.19, wpb=17259.3, bsz=1024, num_updates=1290, lr=2.74936e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8149
2024-11-09 13:00:59 - progress_bar.py[line:274] - INFO: epoch 004:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.92, ntokens=17309.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.14, wps=3251.7, ups=0.19, wpb=17309.5, bsz=1024, num_updates=1300, lr=2.77067e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8202
2024-11-09 13:01:53 - progress_bar.py[line:274] - INFO: epoch 004:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.935, ntokens=17152.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.29, wps=3198.2, ups=0.19, wpb=17152.5, bsz=1024, num_updates=1310, lr=2.79199e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8256
2024-11-09 13:02:47 - progress_bar.py[line:274] - INFO: epoch 004:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.922, ntokens=17203, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.16, wps=3205.1, ups=0.19, wpb=17203, bsz=1024, num_updates=1320, lr=2.8133e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8309
2024-11-09 13:03:40 - progress_bar.py[line:274] - INFO: epoch 004:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.894, ntokens=17201.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.87, wps=3225.5, ups=0.19, wpb=17201.7, bsz=1024, num_updates=1330, lr=2.83461e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8363
2024-11-09 13:04:33 - progress_bar.py[line:274] - INFO: epoch 004:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.933, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.28, wps=3243.6, ups=0.19, wpb=17289.7, bsz=1024, num_updates=1340, lr=2.85592e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8416
2024-11-09 13:05:27 - progress_bar.py[line:274] - INFO: epoch 004:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.889, ntokens=17071.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.82, wps=3167.1, ups=0.19, wpb=17071.6, bsz=1024, num_updates=1350, lr=2.87724e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8470
2024-11-09 13:06:21 - progress_bar.py[line:274] - INFO: epoch 004:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.893, ntokens=17128.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.86, wps=3196.9, ups=0.19, wpb=17128.4, bsz=1024, num_updates=1360, lr=2.89855e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8524
2024-11-09 13:07:14 - progress_bar.py[line:274] - INFO: epoch 004:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.918, ntokens=17360.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.11, wps=3249.3, ups=0.19, wpb=17360.2, bsz=1024, num_updates=1370, lr=2.91986e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=12.9, wall=8577
2024-11-09 13:08:08 - progress_bar.py[line:274] - INFO: epoch 004:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.905, ntokens=17227.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.98, wps=3206.1, ups=0.19, wpb=17227.2, bsz=1024, num_updates=1380, lr=2.94118e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8631
2024-11-09 13:09:01 - progress_bar.py[line:274] - INFO: epoch 004:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.866, ntokens=17090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.58, wps=3187.8, ups=0.19, wpb=17090.1, bsz=1024, num_updates=1390, lr=2.96249e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8684
2024-11-09 13:09:55 - progress_bar.py[line:274] - INFO: epoch 004:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.85, ntokens=16941.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.42, wps=3147.7, ups=0.19, wpb=16941.2, bsz=1024, num_updates=1400, lr=2.9838e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8738
2024-11-09 13:10:49 - progress_bar.py[line:274] - INFO: epoch 004:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.88, ntokens=17106.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.72, wps=3168.6, ups=0.19, wpb=17106.5, bsz=1024, num_updates=1410, lr=3.00512e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8792
2024-11-09 13:11:43 - progress_bar.py[line:274] - INFO: epoch 004:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.819, ntokens=17062.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.11, wps=3173.3, ups=0.19, wpb=17062.3, bsz=1024, num_updates=1420, lr=3.02643e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8846
2024-11-09 13:12:37 - progress_bar.py[line:274] - INFO: epoch 004:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.862, ntokens=17046.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.54, wps=3144.7, ups=0.18, wpb=17046.7, bsz=1024, num_updates=1430, lr=3.04774e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8900
2024-11-09 13:13:31 - progress_bar.py[line:274] - INFO: epoch 004:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.819, ntokens=16914.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.11, wps=3169.8, ups=0.19, wpb=16914.8, bsz=1024, num_updates=1440, lr=3.06905e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8953
2024-11-09 13:14:24 - progress_bar.py[line:274] - INFO: epoch 004:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.864, ntokens=17124.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.56, wps=3200.5, ups=0.19, wpb=17124.2, bsz=1024, num_updates=1450, lr=3.09037e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=9007
2024-11-09 13:15:17 - progress_bar.py[line:274] - INFO: epoch 004:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.817, ntokens=17031.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.1, wps=3192.3, ups=0.19, wpb=17031.6, bsz=1024, num_updates=1460, lr=3.11168e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9060
2024-11-09 13:16:11 - progress_bar.py[line:274] - INFO: epoch 004:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.861, ntokens=17226.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.53, wps=3228.5, ups=0.19, wpb=17226.7, bsz=1024, num_updates=1470, lr=3.13299e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.1, wall=9114
2024-11-09 13:17:04 - progress_bar.py[line:274] - INFO: epoch 004:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.865, ntokens=17207.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.58, wps=3216.6, ups=0.19, wpb=17207.8, bsz=1024, num_updates=1480, lr=3.15431e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=9167
2024-11-09 13:17:58 - progress_bar.py[line:274] - INFO: epoch 004:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.832, ntokens=17057.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.24, wps=3190.9, ups=0.19, wpb=17057.5, bsz=1024, num_updates=1490, lr=3.17562e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=9221
2024-11-09 13:18:51 - progress_bar.py[line:274] - INFO: epoch 004:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.804, ntokens=16894.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.96, wps=3168, ups=0.19, wpb=16894.8, bsz=1024, num_updates=1500, lr=3.19693e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9274
2024-11-09 13:19:44 - progress_bar.py[line:274] - INFO: epoch 004:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.872, ntokens=17422.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.64, wps=3293.6, ups=0.19, wpb=17422.6, bsz=1024, num_updates=1510, lr=3.21824e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=9327
2024-11-09 13:20:38 - progress_bar.py[line:274] - INFO: epoch 004:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.834, ntokens=17066, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.26, wps=3180.2, ups=0.19, wpb=17066, bsz=1024, num_updates=1520, lr=3.23956e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.1, wall=9381
2024-11-09 13:21:31 - progress_bar.py[line:274] - INFO: epoch 004:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.846, ntokens=17381, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.38, wps=3237.8, ups=0.19, wpb=17381, bsz=1024, num_updates=1530, lr=3.26087e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=9434
2024-11-09 13:22:25 - progress_bar.py[line:274] - INFO: epoch 004:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.843, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.35, wps=3233.1, ups=0.19, wpb=17277.5, bsz=1024, num_updates=1540, lr=3.28218e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=9488
2024-11-09 13:23:17 - progress_bar.py[line:274] - INFO: epoch 004:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.883, ntokens=17615.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.76, wps=3393.1, ups=0.19, wpb=17615.1, bsz=1024, num_updates=1550, lr=3.3035e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=9540
2024-11-09 13:24:09 - progress_bar.py[line:274] - INFO: epoch 004:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.828, ntokens=17105.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.2, wps=3289.5, ups=0.19, wpb=17105.5, bsz=1024, num_updates=1560, lr=3.32481e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=9592
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt2024-11-09 13:24:26 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1564 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
2024-11-09 13:24:26 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 13:26:17 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-09 13:28:09 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1564 updates, score 0) (writing took 222.98249861301156 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-09 13:29:04 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-09 13:29:04 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.897 | ntokens 17169.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 14.9 | wps 2654.5 | ups 0.15 | wpb 17169.4 | bsz 1023 | num_updates 1564 | lr 3.33333e-05 | gnorm 0.005 | clip 0 | loss_scale 1024 | train_wall 1185 | gb_free 13.3 | wall 9887
2024-11-09 13:29:04 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 13:31:46 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-09 13:31:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 13:32:20 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.824, ntokens=16654.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=14.16, wps=339, ups=0.02, wpb=16654.8, bsz=985.6, num_updates=1570, lr=3.34612e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=29, gb_free=13.4, wall=10083
2024-11-09 13:33:14 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.847, ntokens=17375.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.39, wps=3231.9, ups=0.19, wpb=17375.4, bsz=1024, num_updates=1580, lr=3.36743e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10137
2024-11-09 13:34:07 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.839, ntokens=17409.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.31, wps=3274.8, ups=0.19, wpb=17409.8, bsz=1024, num_updates=1590, lr=3.38875e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10190
2024-11-09 13:35:00 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17170.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3209, ups=0.19, wpb=17170.1, bsz=1024, num_updates=1600, lr=3.41006e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10243
2024-11-09 13:35:55 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.813, ntokens=17183.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.06, wps=3161, ups=0.18, wpb=17183.4, bsz=1024, num_updates=1610, lr=3.43137e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13, wall=10298
2024-11-09 13:36:48 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.782, ntokens=16982.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.76, wps=3189.8, ups=0.19, wpb=16982.8, bsz=1024, num_updates=1620, lr=3.45269e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10351
2024-11-09 13:37:42 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=16942.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=3168.9, ups=0.19, wpb=16942.5, bsz=1024, num_updates=1630, lr=3.474e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10404
2024-11-09 13:38:35 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.789, ntokens=17021.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.83, wps=3192.5, ups=0.19, wpb=17021.8, bsz=1024, num_updates=1640, lr=3.49531e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10458
2024-11-09 13:39:29 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.799, ntokens=17178.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.92, wps=3190.8, ups=0.19, wpb=17178.5, bsz=1024, num_updates=1650, lr=3.51662e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10512
2024-11-09 13:40:23 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=17174.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.62, wps=3179.4, ups=0.19, wpb=17174.5, bsz=1024, num_updates=1660, lr=3.53794e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10566
2024-11-09 13:41:16 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.808, ntokens=17186.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.01, wps=3212.1, ups=0.19, wpb=17186.8, bsz=1024, num_updates=1670, lr=3.55925e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10619
2024-11-09 13:42:10 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.785, ntokens=17216.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.79, wps=3196.6, ups=0.19, wpb=17216.9, bsz=1024, num_updates=1680, lr=3.58056e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10673
2024-11-09 13:43:04 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17333.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3212.4, ups=0.19, wpb=17333.7, bsz=1024, num_updates=1690, lr=3.60188e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13, wall=10727
2024-11-09 13:43:58 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.808, ntokens=17312.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14, wps=3195, ups=0.18, wpb=17312.3, bsz=1024, num_updates=1700, lr=3.62319e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=10781
2024-11-09 13:44:52 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.726, ntokens=16915.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.23, wps=3137.8, ups=0.19, wpb=16915.9, bsz=1024, num_updates=1710, lr=3.6445e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.1, wall=10835
2024-11-09 13:45:46 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.765, ntokens=17176.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.6, wps=3177.5, ups=0.18, wpb=17176.5, bsz=1024, num_updates=1720, lr=3.66581e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10889
2024-11-09 13:46:39 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.754, ntokens=17215.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.49, wps=3236.3, ups=0.19, wpb=17215.3, bsz=1024, num_updates=1730, lr=3.68713e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=10942
2024-11-09 13:47:33 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.788, ntokens=17187.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.82, wps=3223.8, ups=0.19, wpb=17187.3, bsz=1024, num_updates=1740, lr=3.70844e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10996
2024-11-09 13:48:26 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=17057.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.41, wps=3190.1, ups=0.19, wpb=17057.8, bsz=1024, num_updates=1750, lr=3.72975e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11049
2024-11-09 13:49:20 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.77, ntokens=17293.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.64, wps=3220.2, ups=0.19, wpb=17293.2, bsz=1024, num_updates=1760, lr=3.75107e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11103
2024-11-09 13:50:13 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17344.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3253, ups=0.19, wpb=17344.8, bsz=1024, num_updates=1770, lr=3.77238e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=12.9, wall=11156
2024-11-09 13:51:07 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.728, ntokens=16997.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=3155.4, ups=0.19, wpb=16997.4, bsz=1024, num_updates=1780, lr=3.79369e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11210
2024-11-09 13:52:01 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.757, ntokens=17172, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.52, wps=3186.2, ups=0.19, wpb=17172, bsz=1024, num_updates=1790, lr=3.815e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11264
2024-11-09 13:52:55 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.714, ntokens=17106.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=3158.1, ups=0.18, wpb=17106.8, bsz=1024, num_updates=1800, lr=3.83632e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11318
2024-11-09 13:53:49 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.785, ntokens=17468, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.78, wps=3246.4, ups=0.19, wpb=17468, bsz=1024, num_updates=1810, lr=3.85763e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=12.9, wall=11372
2024-11-09 13:54:42 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.767, ntokens=17304.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.61, wps=3234.6, ups=0.19, wpb=17304.3, bsz=1024, num_updates=1820, lr=3.87894e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11425
2024-11-09 13:55:36 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.736, ntokens=17113.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.33, wps=3188.8, ups=0.19, wpb=17113.9, bsz=1024, num_updates=1830, lr=3.90026e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11479
2024-11-09 13:56:29 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=17019.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.27, wps=3188.7, ups=0.19, wpb=17019.5, bsz=1024, num_updates=1840, lr=3.92157e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11532
2024-11-09 13:57:23 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.699, ntokens=17053.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.99, wps=3178.6, ups=0.19, wpb=17053.1, bsz=1024, num_updates=1850, lr=3.94288e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11586
2024-11-09 13:58:17 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.719, ntokens=17064.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=3179.9, ups=0.19, wpb=17064.6, bsz=1024, num_updates=1860, lr=3.96419e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=11640
2024-11-09 13:59:10 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.769, ntokens=17547.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.63, wps=3269.7, ups=0.19, wpb=17547.1, bsz=1024, num_updates=1870, lr=3.98551e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11693
2024-11-09 14:00:04 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.76, ntokens=17092.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.55, wps=3203.1, ups=0.19, wpb=17092.8, bsz=1024, num_updates=1880, lr=4.00682e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11747
2024-11-09 14:00:58 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.676, ntokens=17013.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=3158.3, ups=0.19, wpb=17013.3, bsz=1024, num_updates=1890, lr=4.02813e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11801
2024-11-09 14:01:51 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=17211.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=3209.3, ups=0.19, wpb=17211.4, bsz=1024, num_updates=1900, lr=4.04945e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=11854
2024-11-09 14:02:45 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.692, ntokens=16991.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.92, wps=3179.2, ups=0.19, wpb=16991.2, bsz=1024, num_updates=1910, lr=4.07076e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11908
2024-11-09 14:03:39 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.723, ntokens=17184.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.2, wps=3183.9, ups=0.19, wpb=17184.8, bsz=1024, num_updates=1920, lr=4.09207e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11962
2024-11-09 14:04:32 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.709, ntokens=17235.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.08, wps=3224.9, ups=0.19, wpb=17235.6, bsz=1024, num_updates=1930, lr=4.11338e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12015
2024-11-09 14:05:25 - progress_bar.py[line:274] - INFO: epoch 005:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=17380.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=3315.3, ups=0.19, wpb=17380.1, bsz=1024, num_updates=1940, lr=4.1347e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=12068
2024-11-09 14:06:16 - progress_bar.py[line:274] - INFO: epoch 005:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.7, ntokens=16964.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13, wps=3308.4, ups=0.2, wpb=16964.9, bsz=1024, num_updates=1950, lr=4.15601e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.1, wall=12119
2024-11-09 14:06:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1955 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
2024-11-09 14:06:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 14:08:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 14:10:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1955 updates, score 0) (writing took 222.5111090989667 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-09 14:11:15 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-09 14:11:15 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.76 | ntokens 17158 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.55 | wps 2650.1 | ups 0.15 | wpb 17158 | bsz 1023 | num_updates 1955 | lr 4.16667e-05 | gnorm 0.006 | clip 0 | loss_scale 1024 | train_wall 1184 | gb_free 13.3 | wall 12418
2024-11-09 14:11:15 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 14:13:56 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-09 14:13:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 14:14:25 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=16377.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=335.1, ups=0.02, wpb=16377.6, bsz=985.6, num_updates=1960, lr=4.17732e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.1, wall=12608
2024-11-09 14:15:18 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.728, ntokens=17312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=3216.8, ups=0.19, wpb=17312.9, bsz=1024, num_updates=1970, lr=4.19864e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=31, gb_free=13.4, wall=12661
2024-11-09 14:16:12 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=17461.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.62, wps=3282.4, ups=0.19, wpb=17461.8, bsz=1024, num_updates=1980, lr=4.21995e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12715
2024-11-09 14:17:05 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.697, ntokens=17141, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.97, wps=3211.4, ups=0.19, wpb=17141, bsz=1024, num_updates=1990, lr=4.24126e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12768
2024-11-09 14:17:59 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.674, ntokens=17026.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.77, wps=3154.3, ups=0.19, wpb=17026.6, bsz=1024, num_updates=2000, lr=4.26257e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12822
2024-11-09 14:18:52 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.704, ntokens=17216.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.03, wps=3225.7, ups=0.19, wpb=17216.7, bsz=1024, num_updates=2010, lr=4.28389e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=12875
2024-11-09 14:19:46 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=16766.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.49, wps=3105.7, ups=0.19, wpb=16766.9, bsz=1024, num_updates=2020, lr=4.3052e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12929
2024-11-09 14:20:40 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.711, ntokens=17355.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.1, wps=3246.5, ups=0.19, wpb=17355.5, bsz=1024, num_updates=2030, lr=4.32651e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=12983
2024-11-09 14:21:33 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.688, ntokens=17166.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.89, wps=3226.3, ups=0.19, wpb=17166.9, bsz=1024, num_updates=2040, lr=4.34783e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=13036
2024-11-09 14:22:26 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.704, ntokens=17200.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.03, wps=3228.4, ups=0.19, wpb=17200.8, bsz=1024, num_updates=2050, lr=4.36914e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13089
2024-11-09 14:23:21 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.704, ntokens=17117.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.03, wps=3151.9, ups=0.18, wpb=17117.1, bsz=1024, num_updates=2060, lr=4.39045e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=32, gb_free=13.4, wall=13144
2024-11-09 14:24:16 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.657, ntokens=16982.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.61, wps=3066.7, ups=0.18, wpb=16982.3, bsz=1024, num_updates=2070, lr=4.41176e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=44, gb_free=13.5, wall=13199
2024-11-09 14:25:12 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.728, ntokens=17331.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=3125.3, ups=0.18, wpb=17331.5, bsz=1024, num_updates=2080, lr=4.43308e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=13254
2024-11-09 14:26:06 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.649, ntokens=17147, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.54, wps=3149.9, ups=0.18, wpb=17147, bsz=1024, num_updates=2090, lr=4.45439e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=54, gb_free=13.4, wall=13309
2024-11-09 14:26:58 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.652, ntokens=16830.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=3255.3, ups=0.19, wpb=16830.8, bsz=1024, num_updates=2100, lr=4.4757e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=52, gb_free=13.2, wall=13361
2024-11-09 14:27:49 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.679, ntokens=17255.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.81, wps=3341.6, ups=0.19, wpb=17255.2, bsz=1024, num_updates=2110, lr=4.49702e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=40, gb_free=13.4, wall=13412
2024-11-09 14:28:42 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.681, ntokens=17125, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.82, wps=3239.4, ups=0.19, wpb=17125, bsz=1024, num_updates=2120, lr=4.51833e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=13465
2024-11-09 14:29:36 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.674, ntokens=17194.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.77, wps=3189.3, ups=0.19, wpb=17194.3, bsz=1024, num_updates=2130, lr=4.53964e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13519
2024-11-09 14:30:30 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.664, ntokens=17142.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=3184.7, ups=0.19, wpb=17142.4, bsz=1024, num_updates=2140, lr=4.56095e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13, wall=13573
2024-11-09 14:31:24 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.676, ntokens=17243.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=3190, ups=0.18, wpb=17243.5, bsz=1024, num_updates=2150, lr=4.58227e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=31, gb_free=13.3, wall=13627
2024-11-09 14:32:18 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=17042.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.63, wps=3171.8, ups=0.19, wpb=17042.4, bsz=1024, num_updates=2160, lr=4.60358e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=13681
2024-11-09 14:33:11 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.647, ntokens=17037, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.52, wps=3194.3, ups=0.19, wpb=17037, bsz=1024, num_updates=2170, lr=4.62489e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=31, gb_free=13.2, wall=13734
2024-11-09 14:34:05 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.633, ntokens=17184.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.41, wps=3202.7, ups=0.19, wpb=17184.6, bsz=1024, num_updates=2180, lr=4.64621e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13788
2024-11-09 14:34:59 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=17132.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.63, wps=3153.8, ups=0.18, wpb=17132.7, bsz=1024, num_updates=2190, lr=4.66752e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=13842
2024-11-09 14:35:52 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.645, ntokens=17230, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.51, wps=3230.5, ups=0.19, wpb=17230, bsz=1024, num_updates=2200, lr=4.68883e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=13895
2024-11-09 14:36:46 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.653, ntokens=17206.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.58, wps=3216.2, ups=0.19, wpb=17206.4, bsz=1024, num_updates=2210, lr=4.71014e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=13949
2024-11-09 14:37:39 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=17116.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.69, wps=3220, ups=0.19, wpb=17116.6, bsz=1024, num_updates=2220, lr=4.73146e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=14002
2024-11-09 14:38:33 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.627, ntokens=16951.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.35, wps=3159.7, ups=0.19, wpb=16951.1, bsz=1024, num_updates=2230, lr=4.75277e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=14056
2024-11-09 14:39:26 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.619, ntokens=17125.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.29, wps=3188.6, ups=0.19, wpb=17125.6, bsz=1024, num_updates=2240, lr=4.77408e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=14109
2024-11-09 14:40:19 - progress_bar.py[line:274] - INFO: epoch 006:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.675, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.77, wps=3264.3, ups=0.19, wpb=17345, bsz=1024, num_updates=2250, lr=4.7954e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14162
2024-11-09 14:41:13 - progress_bar.py[line:274] - INFO: epoch 006:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.644, ntokens=17137.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.5, wps=3199, ups=0.19, wpb=17137.8, bsz=1024, num_updates=2260, lr=4.81671e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=14216
2024-11-09 14:42:07 - progress_bar.py[line:274] - INFO: epoch 006:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.625, ntokens=17099.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.34, wps=3162.2, ups=0.18, wpb=17099.3, bsz=1024, num_updates=2270, lr=4.83802e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=14270
2024-11-09 14:43:01 - progress_bar.py[line:274] - INFO: epoch 006:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.65, ntokens=17202, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.55, wps=3199.5, ups=0.19, wpb=17202, bsz=1024, num_updates=2280, lr=4.85934e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=14324
2024-11-09 14:43:55 - progress_bar.py[line:274] - INFO: epoch 006:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.661, ntokens=17194.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.65, wps=3204.4, ups=0.19, wpb=17194.2, bsz=1024, num_updates=2290, lr=4.88065e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=14377
2024-11-09 14:44:48 - progress_bar.py[line:274] - INFO: epoch 006:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.612, ntokens=17013.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.23, wps=3157.4, ups=0.19, wpb=17013.7, bsz=1024, num_updates=2300, lr=4.90196e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=12.9, wall=14431
2024-11-09 14:45:42 - progress_bar.py[line:274] - INFO: epoch 006:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.643, ntokens=17245.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.49, wps=3205.5, ups=0.19, wpb=17245.2, bsz=1024, num_updates=2310, lr=4.92327e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=14485
2024-11-09 14:46:36 - progress_bar.py[line:274] - INFO: epoch 006:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.645, ntokens=17261.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.51, wps=3212.4, ups=0.19, wpb=17261.9, bsz=1024, num_updates=2320, lr=4.94459e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=30, gb_free=13, wall=14539
2024-11-09 14:47:29 - progress_bar.py[line:274] - INFO: epoch 006:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.648, ntokens=17262.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.53, wps=3254.7, ups=0.19, wpb=17262.8, bsz=1024, num_updates=2330, lr=4.9659e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=14592
2024-11-09 14:48:21 - progress_bar.py[line:274] - INFO: epoch 006:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=16827.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=3230.6, ups=0.19, wpb=16827.5, bsz=1024, num_updates=2340, lr=4.98721e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=14644
2024-11-09 14:48:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2346 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-09 14:48:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 14:50:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
2024-11-09 14:52:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2346 updates, score 0) (writing took 220.42853473400464 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-09 14:53:23 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-09 14:53:23 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.666 | ntokens 17130.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.69 | wps 2649.4 | ups 0.15 | wpb 17130.3 | bsz 1023 | num_updates 2346 | lr 5e-05 | gnorm 0.007 | clip 0 | loss_scale 2048 | train_wall 1279 | gb_free 13.3 | wall 14946
2024-11-09 14:53:23 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 14:56:04 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-09 14:56:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 14:56:28 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=16415.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=337.1, ups=0.02, wpb=16415.4, bsz=985.6, num_updates=2350, lr=4.99946e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=29, gb_free=13.4, wall=15131
2024-11-09 14:57:22 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.641, ntokens=17340.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.47, wps=3230.7, ups=0.19, wpb=17340.3, bsz=1024, num_updates=2360, lr=4.9981e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=12.8, wall=15185
2024-11-09 14:58:15 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.656, ntokens=17331.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.6, wps=3248.5, ups=0.19, wpb=17331.9, bsz=1024, num_updates=2370, lr=4.99674e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.2, wall=15238
2024-11-09 14:59:09 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.651, ntokens=17206.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=3210.7, ups=0.19, wpb=17206.8, bsz=1024, num_updates=2380, lr=4.99537e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15292
2024-11-09 15:00:02 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=17123.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.08, wps=3233.5, ups=0.19, wpb=17123.3, bsz=1024, num_updates=2390, lr=4.99401e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15345
2024-11-09 15:00:55 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.657, ntokens=17377.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.62, wps=3258.7, ups=0.19, wpb=17377.4, bsz=1024, num_updates=2400, lr=4.99265e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15398
2024-11-09 15:01:48 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.606, ntokens=17172.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.18, wps=3235, ups=0.19, wpb=17172.5, bsz=1024, num_updates=2410, lr=4.99129e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15451
2024-11-09 15:02:41 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.65, ntokens=17376.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.55, wps=3253.8, ups=0.19, wpb=17376.4, bsz=1024, num_updates=2420, lr=4.98993e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=12.9, wall=15504
2024-11-09 15:03:35 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.623, ntokens=17215.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.32, wps=3239.2, ups=0.19, wpb=17215.9, bsz=1024, num_updates=2430, lr=4.98857e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=31, gb_free=13.4, wall=15557
2024-11-09 15:04:28 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.624, ntokens=17235.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.33, wps=3216.7, ups=0.19, wpb=17235.6, bsz=1024, num_updates=2440, lr=4.98721e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15611
2024-11-09 15:05:22 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.66, ntokens=17487.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=3237.9, ups=0.19, wpb=17487.9, bsz=1024, num_updates=2450, lr=4.98585e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15665
2024-11-09 15:06:16 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.635, ntokens=17327.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.42, wps=3224.2, ups=0.19, wpb=17327.4, bsz=1024, num_updates=2460, lr=4.98449e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15719
2024-11-09 15:07:09 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.566, ntokens=17017.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=3212.6, ups=0.19, wpb=17017.2, bsz=1024, num_updates=2470, lr=4.98313e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=15772
2024-11-09 15:08:03 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.582, ntokens=17015.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.98, wps=3171.9, ups=0.19, wpb=17015.2, bsz=1024, num_updates=2480, lr=4.98177e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15825
2024-11-09 15:08:56 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.572, ntokens=17025.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.89, wps=3167.4, ups=0.19, wpb=17025.4, bsz=1024, num_updates=2490, lr=4.98041e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=15879
2024-11-09 15:09:50 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.612, ntokens=17452.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.23, wps=3263.7, ups=0.19, wpb=17452.2, bsz=1024, num_updates=2500, lr=4.97905e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=15933
2024-11-09 15:10:44 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=17294.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=3203.3, ups=0.19, wpb=17294.7, bsz=1024, num_updates=2510, lr=4.97769e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.3, wall=15987
2024-11-09 15:11:37 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=17300.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3270.5, ups=0.19, wpb=17300.4, bsz=1024, num_updates=2520, lr=4.97633e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=16040
2024-11-09 15:12:30 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.573, ntokens=16987.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.9, wps=3177, ups=0.19, wpb=16987.2, bsz=1024, num_updates=2530, lr=4.97497e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.4, wall=16093
2024-11-09 15:13:23 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.558, ntokens=17091.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.78, wps=3209.4, ups=0.19, wpb=17091.7, bsz=1024, num_updates=2540, lr=4.97361e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=16146
2024-11-09 15:14:18 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.599, ntokens=17193.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.12, wps=3175.1, ups=0.18, wpb=17193.5, bsz=1024, num_updates=2550, lr=4.97225e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=31, gb_free=13.1, wall=16200
2024-11-09 15:15:11 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.586, ntokens=17147.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.01, wps=3204.5, ups=0.19, wpb=17147.5, bsz=1024, num_updates=2560, lr=4.97089e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16254
2024-11-09 15:16:04 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.563, ntokens=17143.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.82, wps=3227.5, ups=0.19, wpb=17143.2, bsz=1024, num_updates=2570, lr=4.96953e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16307
2024-11-09 15:16:58 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.538, ntokens=16979.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.62, wps=3171.9, ups=0.19, wpb=16979.7, bsz=1024, num_updates=2580, lr=4.96817e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16361
2024-11-09 15:17:51 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=17283.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.05, wps=3236, ups=0.19, wpb=17283.9, bsz=1024, num_updates=2590, lr=4.96681e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=16414
2024-11-09 15:18:45 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.559, ntokens=17248.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.79, wps=3221.3, ups=0.19, wpb=17248.4, bsz=1024, num_updates=2600, lr=4.96545e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16468
2024-11-09 15:19:38 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=17300, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=3255.7, ups=0.19, wpb=17300, bsz=1024, num_updates=2610, lr=4.96409e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16521
2024-11-09 15:20:31 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.564, ntokens=17030.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.83, wps=3191.4, ups=0.19, wpb=17030.4, bsz=1024, num_updates=2620, lr=4.96273e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16574
2024-11-09 15:21:24 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.49, ntokens=16864.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.23, wps=3183, ups=0.19, wpb=16864.9, bsz=1024, num_updates=2630, lr=4.96136e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16627
2024-11-09 15:22:18 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.549, ntokens=17123.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.7, wps=3183.4, ups=0.19, wpb=17123.9, bsz=1024, num_updates=2640, lr=4.96e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16681
2024-11-09 15:23:11 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.572, ntokens=17304, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.89, wps=3250, ups=0.19, wpb=17304, bsz=1024, num_updates=2650, lr=4.95864e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16734
2024-11-09 15:24:04 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.587, ntokens=17207, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.02, wps=3248.2, ups=0.19, wpb=17207, bsz=1024, num_updates=2660, lr=4.95728e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16787
2024-11-09 15:24:58 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.545, ntokens=17195.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.67, wps=3206.1, ups=0.19, wpb=17195.9, bsz=1024, num_updates=2670, lr=4.95592e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.1, wall=16841
2024-11-09 15:25:51 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.564, ntokens=17187.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.83, wps=3214.8, ups=0.19, wpb=17187.4, bsz=1024, num_updates=2680, lr=4.95456e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16894
2024-11-09 15:26:44 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.523, ntokens=16921.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.49, wps=3199.1, ups=0.19, wpb=16921.8, bsz=1024, num_updates=2690, lr=4.9532e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16947
2024-11-09 15:27:38 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.598, ntokens=17455.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.11, wps=3264.3, ups=0.19, wpb=17455.6, bsz=1024, num_updates=2700, lr=4.95184e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17001
2024-11-09 15:28:31 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.57, ntokens=17560.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.87, wps=3307, ups=0.19, wpb=17560.9, bsz=1024, num_updates=2710, lr=4.95048e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=17054
2024-11-09 15:29:24 - progress_bar.py[line:274] - INFO: epoch 007:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.556, ntokens=17260.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.76, wps=3238.8, ups=0.19, wpb=17260.2, bsz=1024, num_updates=2720, lr=4.94912e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13, wall=17107
2024-11-09 15:30:17 - progress_bar.py[line:274] - INFO: epoch 007:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.606, ntokens=17505.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.18, wps=3316, ups=0.19, wpb=17505.5, bsz=1024, num_updates=2730, lr=4.94776e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=42, gb_free=13.3, wall=17160
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
2024-11-09 15:30:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2737 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
2024-11-09 15:30:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists: File exists
: File exists
: File exists
: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 15:32:03 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-09 15:34:24 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2737 updates, score 0) (writing took 214.40649640600896 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
2024-11-09 15:35:18 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-09 15:35:18 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.59 | ntokens 17191.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.04 | wps 2673 | ups 0.16 | wpb 17191.6 | bsz 1023 | num_updates 2737 | lr 4.94681e-05 | gnorm 0.007 | clip 0 | loss_scale 4096 | train_wall 1204 | gb_free 13.2 | wall 17461
2024-11-09 15:35:18 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 15:38:00 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-09 15:38:00 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 15:38:18 - progress_bar.py[line:274] - INFO: epoch 008:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.531, ntokens=16328.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=339.5, ups=0.02, wpb=16328.4, bsz=985.6, num_updates=2740, lr=4.9464e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=38, gb_free=13.4, wall=17641
2024-11-09 15:39:11 - progress_bar.py[line:274] - INFO: epoch 008:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.543, ntokens=16982, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.65, wps=3204.1, ups=0.19, wpb=16982, bsz=1024, num_updates=2750, lr=4.94504e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17694
2024-11-09 15:40:05 - progress_bar.py[line:274] - INFO: epoch 008:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.546, ntokens=17303.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.68, wps=3205.9, ups=0.19, wpb=17303.5, bsz=1024, num_updates=2760, lr=4.94368e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17748
2024-11-09 15:40:58 - progress_bar.py[line:274] - INFO: epoch 008:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.555, ntokens=17117, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.75, wps=3236, ups=0.19, wpb=17117, bsz=1024, num_updates=2770, lr=4.94232e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.1, wall=17800
2024-11-09 15:41:50 - progress_bar.py[line:274] - INFO: epoch 008:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=17028.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=3231.7, ups=0.19, wpb=17028.8, bsz=1024, num_updates=2780, lr=4.94096e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=17853
2024-11-09 15:42:44 - progress_bar.py[line:274] - INFO: epoch 008:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.514, ntokens=16988.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.42, wps=3160.4, ups=0.19, wpb=16988.9, bsz=1024, num_updates=2790, lr=4.9396e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17907
2024-11-09 15:43:38 - progress_bar.py[line:274] - INFO: epoch 008:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=17133.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=3182.4, ups=0.19, wpb=17133.1, bsz=1024, num_updates=2800, lr=4.93824e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17961
2024-11-09 15:44:31 - progress_bar.py[line:274] - INFO: epoch 008:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.546, ntokens=17219.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.68, wps=3240.7, ups=0.19, wpb=17219.2, bsz=1024, num_updates=2810, lr=4.93688e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=18014
2024-11-09 15:45:24 - progress_bar.py[line:274] - INFO: epoch 008:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.501, ntokens=17078.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.32, wps=3196.6, ups=0.19, wpb=17078.6, bsz=1024, num_updates=2820, lr=4.93552e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=18067
2024-11-09 15:46:18 - progress_bar.py[line:274] - INFO: epoch 008:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.522, ntokens=17057.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=3170.6, ups=0.19, wpb=17057.3, bsz=1024, num_updates=2830, lr=4.93416e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=31, gb_free=13.1, wall=18121
2024-11-09 15:47:12 - progress_bar.py[line:274] - INFO: epoch 008:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.519, ntokens=17257.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.46, wps=3220.1, ups=0.19, wpb=17257.6, bsz=1024, num_updates=2840, lr=4.9328e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18175
2024-11-09 15:48:05 - progress_bar.py[line:274] - INFO: epoch 008:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.545, ntokens=17313.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.67, wps=3229.9, ups=0.19, wpb=17313.7, bsz=1024, num_updates=2850, lr=4.93144e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=18228
2024-11-09 15:48:59 - progress_bar.py[line:274] - INFO: epoch 008:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.541, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.64, wps=3236.3, ups=0.19, wpb=17291.2, bsz=1024, num_updates=2860, lr=4.93008e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=18282
2024-11-09 15:49:52 - progress_bar.py[line:274] - INFO: epoch 008:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.539, ntokens=17388, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.62, wps=3265.4, ups=0.19, wpb=17388, bsz=1024, num_updates=2870, lr=4.92872e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18335
2024-11-09 15:50:45 - progress_bar.py[line:274] - INFO: epoch 008:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.523, ntokens=17061, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.5, wps=3206.4, ups=0.19, wpb=17061, bsz=1024, num_updates=2880, lr=4.92735e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18388
2024-11-09 15:51:39 - progress_bar.py[line:274] - INFO: epoch 008:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.478, ntokens=17300.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=3204.6, ups=0.19, wpb=17300.4, bsz=1024, num_updates=2890, lr=4.92599e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18442
2024-11-09 15:52:33 - progress_bar.py[line:274] - INFO: epoch 008:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.532, ntokens=17241.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=3238.5, ups=0.19, wpb=17241.4, bsz=1024, num_updates=2900, lr=4.92463e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=18495
2024-11-09 15:53:26 - progress_bar.py[line:274] - INFO: epoch 008:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=17071.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=3212.3, ups=0.19, wpb=17071.3, bsz=1024, num_updates=2910, lr=4.92327e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18549
2024-11-09 15:54:19 - progress_bar.py[line:274] - INFO: epoch 008:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.498, ntokens=17150, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.3, wps=3195, ups=0.19, wpb=17150, bsz=1024, num_updates=2920, lr=4.92191e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18602
2024-11-09 15:55:13 - progress_bar.py[line:274] - INFO: epoch 008:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=17208.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=3225.4, ups=0.19, wpb=17208.9, bsz=1024, num_updates=2930, lr=4.92055e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18656
2024-11-09 15:56:06 - progress_bar.py[line:274] - INFO: epoch 008:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.543, ntokens=17251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.66, wps=3223.3, ups=0.19, wpb=17251.2, bsz=1024, num_updates=2940, lr=4.91919e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18709
2024-11-09 15:57:00 - progress_bar.py[line:274] - INFO: epoch 008:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.478, ntokens=17087, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=3183.1, ups=0.19, wpb=17087, bsz=1024, num_updates=2950, lr=4.91783e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=18763
2024-11-09 15:57:53 - progress_bar.py[line:274] - INFO: epoch 008:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.487, ntokens=17193, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.21, wps=3244, ups=0.19, wpb=17193, bsz=1024, num_updates=2960, lr=4.91647e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18816
2024-11-09 15:58:47 - progress_bar.py[line:274] - INFO: epoch 008:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.502, ntokens=17380.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.33, wps=3241.1, ups=0.19, wpb=17380.4, bsz=1024, num_updates=2970, lr=4.91511e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=18869
2024-11-09 15:59:40 - progress_bar.py[line:274] - INFO: epoch 008:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.489, ntokens=17173, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.23, wps=3193.1, ups=0.19, wpb=17173, bsz=1024, num_updates=2980, lr=4.91375e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=18923
2024-11-09 16:00:34 - progress_bar.py[line:274] - INFO: epoch 008:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.484, ntokens=17077.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.19, wps=3184.1, ups=0.19, wpb=17077.4, bsz=1024, num_updates=2990, lr=4.91239e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18977
2024-11-09 16:01:28 - progress_bar.py[line:274] - INFO: epoch 008:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.506, ntokens=17267.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.36, wps=3223.1, ups=0.19, wpb=17267.7, bsz=1024, num_updates=3000, lr=4.91103e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=31, gb_free=13.3, wall=19030
2024-11-09 16:02:21 - progress_bar.py[line:274] - INFO: epoch 008:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.486, ntokens=17148.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.21, wps=3206.8, ups=0.19, wpb=17148.8, bsz=1024, num_updates=3010, lr=4.90967e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.2, wall=19084
2024-11-09 16:03:15 - progress_bar.py[line:274] - INFO: epoch 008:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.464, ntokens=17227.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.04, wps=3199.2, ups=0.19, wpb=17227.1, bsz=1024, num_updates=3020, lr=4.90831e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13, wall=19138
2024-11-09 16:04:08 - progress_bar.py[line:274] - INFO: epoch 008:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=17159.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=3221.1, ups=0.19, wpb=17159.7, bsz=1024, num_updates=3030, lr=4.90695e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=31, gb_free=13, wall=19191
2024-11-09 16:05:01 - progress_bar.py[line:274] - INFO: epoch 008:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=17165.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=3223.7, ups=0.19, wpb=17165.9, bsz=1024, num_updates=3040, lr=4.90559e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=19244
2024-11-09 16:05:55 - progress_bar.py[line:274] - INFO: epoch 008:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.519, ntokens=17192.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.46, wps=3219.6, ups=0.19, wpb=17192.4, bsz=1024, num_updates=3050, lr=4.90423e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19298
2024-11-09 16:06:48 - progress_bar.py[line:274] - INFO: epoch 008:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=16958, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3183.2, ups=0.19, wpb=16958, bsz=1024, num_updates=3060, lr=4.90287e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=31, gb_free=12.8, wall=19351
2024-11-09 16:07:42 - progress_bar.py[line:274] - INFO: epoch 008:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.515, ntokens=17271.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.43, wps=3227.7, ups=0.19, wpb=17271.5, bsz=1024, num_updates=3070, lr=4.90151e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=33, gb_free=13.4, wall=19404
2024-11-09 16:08:36 - progress_bar.py[line:274] - INFO: epoch 008:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.454, ntokens=17047.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.96, wps=3160.5, ups=0.19, wpb=17047.8, bsz=1024, num_updates=3080, lr=4.90015e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=37, gb_free=13.4, wall=19458
2024-11-09 16:09:29 - progress_bar.py[line:274] - INFO: epoch 008:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.479, ntokens=17258.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.15, wps=3252.3, ups=0.19, wpb=17258.8, bsz=1024, num_updates=3090, lr=4.89879e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=42, gb_free=13.1, wall=19511
2024-11-09 16:10:21 - progress_bar.py[line:274] - INFO: epoch 008:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.483, ntokens=17305.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.18, wps=3309.2, ups=0.19, wpb=17305.9, bsz=1024, num_updates=3100, lr=4.89743e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=33, gb_free=13.4, wall=19564
2024-11-09 16:11:13 - progress_bar.py[line:274] - INFO: epoch 008:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=17465, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=3360.4, ups=0.19, wpb=17465, bsz=1024, num_updates=3110, lr=4.89607e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=19616
2024-11-09 16:12:05 - progress_bar.py[line:274] - INFO: epoch 008:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=17098.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=3268, ups=0.19, wpb=17098.8, bsz=1024, num_updates=3120, lr=4.89471e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=19668
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt



cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-09 16:12:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 3128 updates
2024-11-09 16:12:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists
: File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 16:14:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-09 16:16:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 3128 updates, score 0) (writing took 220.34643068001606 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-09 16:17:20 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-09 16:17:20 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.503 | ntokens 17166.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.34 | wps 2661.8 | ups 0.16 | wpb 17166.8 | bsz 1023 | num_updates 3128 | lr 4.89362e-05 | gnorm 0.007 | clip 0 | loss_scale 8192 | train_wall 1213 | gb_free 13.3 | wall 19983
2024-11-09 16:17:20 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 16:20:01 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-09 16:20:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 16:20:14 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.472, ntokens=16546.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=11.1, wps=338.6, ups=0.02, wpb=16546.1, bsz=985.6, num_updates=3130, lr=4.89334e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=34, gb_free=13.4, wall=20157
2024-11-09 16:21:08 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.469, ntokens=17063.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3159.2, ups=0.19, wpb=17063.2, bsz=1024, num_updates=3140, lr=4.89198e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20211
2024-11-09 16:22:01 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.492, ntokens=17330.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.25, wps=3273, ups=0.19, wpb=17330.4, bsz=1024, num_updates=3150, lr=4.89062e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20264
2024-11-09 16:22:54 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.473, ntokens=17127.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.1, wps=3206.2, ups=0.19, wpb=17127.6, bsz=1024, num_updates=3160, lr=4.88926e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=20317
2024-11-09 16:23:48 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.453, ntokens=17228.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=3224, ups=0.19, wpb=17228.5, bsz=1024, num_updates=3170, lr=4.8879e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=20371
2024-11-09 16:24:41 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.439, ntokens=17040.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=3222.2, ups=0.19, wpb=17040.8, bsz=1024, num_updates=3180, lr=4.88654e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20423
2024-11-09 16:25:34 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.43, ntokens=17054.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.78, wps=3204, ups=0.19, wpb=17054.1, bsz=1024, num_updates=3190, lr=4.88518e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20477
2024-11-09 16:26:27 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=16946.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3164.4, ups=0.19, wpb=16946.3, bsz=1024, num_updates=3200, lr=4.88382e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20530
2024-11-09 16:27:21 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.484, ntokens=17390.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.19, wps=3244.4, ups=0.19, wpb=17390.2, bsz=1024, num_updates=3210, lr=4.88246e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20584
2024-11-09 16:28:15 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.405, ntokens=16959, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=3152.6, ups=0.19, wpb=16959, bsz=1024, num_updates=3220, lr=4.8811e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20638
2024-11-09 16:29:09 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=17420.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=3223.4, ups=0.19, wpb=17420.7, bsz=1024, num_updates=3230, lr=4.87974e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20692
2024-11-09 16:30:02 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17015.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3176.3, ups=0.19, wpb=17015.7, bsz=1024, num_updates=3240, lr=4.87838e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20745
2024-11-09 16:30:57 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=17291.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=3190.8, ups=0.18, wpb=17291.8, bsz=1024, num_updates=3250, lr=4.87702e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20799
2024-11-09 16:31:50 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.462, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.02, wps=3243, ups=0.19, wpb=17378.7, bsz=1024, num_updates=3260, lr=4.87566e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20853
2024-11-09 16:32:44 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=16925.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=3144.1, ups=0.19, wpb=16925.7, bsz=1024, num_updates=3270, lr=4.8743e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20907
2024-11-09 16:33:37 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.435, ntokens=17380.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=3249.6, ups=0.19, wpb=17380.2, bsz=1024, num_updates=3280, lr=4.87294e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20960
2024-11-09 16:34:31 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.437, ntokens=17037.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=3179.5, ups=0.19, wpb=17037.8, bsz=1024, num_updates=3290, lr=4.87158e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21014
2024-11-09 16:35:24 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.455, ntokens=17141.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=3226.8, ups=0.19, wpb=17141.7, bsz=1024, num_updates=3300, lr=4.87022e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=21067
2024-11-09 16:36:18 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=17161, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3183.8, ups=0.19, wpb=17161, bsz=1024, num_updates=3310, lr=4.86886e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21121
2024-11-09 16:37:12 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.447, ntokens=17071.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.91, wps=3148.3, ups=0.18, wpb=17071.7, bsz=1024, num_updates=3320, lr=4.8675e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=21175
2024-11-09 16:38:06 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17250.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3214.8, ups=0.19, wpb=17250.1, bsz=1024, num_updates=3330, lr=4.86614e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=21229
2024-11-09 16:38:59 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=16944.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3174.3, ups=0.19, wpb=16944.1, bsz=1024, num_updates=3340, lr=4.86478e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=21282
2024-11-09 16:39:52 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=17064.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=3219, ups=0.19, wpb=17064.2, bsz=1024, num_updates=3350, lr=4.86342e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21335
2024-11-09 16:40:46 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.452, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.94, wps=3209.9, ups=0.19, wpb=17309.4, bsz=1024, num_updates=3360, lr=4.86206e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21389
2024-11-09 16:41:40 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=17056.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3197.7, ups=0.19, wpb=17056.3, bsz=1024, num_updates=3370, lr=4.8607e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21443
2024-11-09 16:42:33 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.455, ntokens=17238.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=3219, ups=0.19, wpb=17238.5, bsz=1024, num_updates=3380, lr=4.85934e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21496
2024-11-09 16:43:27 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=17434.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=3239, ups=0.19, wpb=17434.4, bsz=1024, num_updates=3390, lr=4.85797e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13, wall=21550
2024-11-09 16:44:20 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=16966.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=3171.7, ups=0.19, wpb=16966.8, bsz=1024, num_updates=3400, lr=4.85661e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=21603
2024-11-09 16:45:14 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=17107.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3211.6, ups=0.19, wpb=17107.9, bsz=1024, num_updates=3410, lr=4.85525e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21657
2024-11-09 16:46:07 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17163.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3210.9, ups=0.19, wpb=17163.6, bsz=1024, num_updates=3420, lr=4.85389e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21710
2024-11-09 16:47:01 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=16988.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3155.1, ups=0.19, wpb=16988.4, bsz=1024, num_updates=3430, lr=4.85253e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=21764
2024-11-09 16:47:54 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.451, ntokens=17200.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.94, wps=3229.5, ups=0.19, wpb=17200.4, bsz=1024, num_updates=3440, lr=4.85117e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21817
2024-11-09 16:48:48 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=16989.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=3187.6, ups=0.19, wpb=16989.5, bsz=1024, num_updates=3450, lr=4.84981e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=21871
2024-11-09 16:49:41 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.419, ntokens=17234.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.69, wps=3200.6, ups=0.19, wpb=17234.9, bsz=1024, num_updates=3460, lr=4.84845e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21924
2024-11-09 16:50:36 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=17194.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=3159.3, ups=0.18, wpb=17194.3, bsz=1024, num_updates=3470, lr=4.84709e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21979
2024-11-09 16:51:30 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.402, ntokens=16998.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=3164.1, ups=0.19, wpb=16998.9, bsz=1024, num_updates=3480, lr=4.84573e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13, wall=22033
2024-11-09 16:52:25 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=17405, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=3149.8, ups=0.18, wpb=17405, bsz=1024, num_updates=3490, lr=4.84437e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22088
2024-11-09 16:53:20 - progress_bar.py[line:274] - INFO: epoch 009:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=17802.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=3248.2, ups=0.18, wpb=17802.1, bsz=1024, num_updates=3500, lr=4.84301e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=22143
2024-11-09 16:54:12 - progress_bar.py[line:274] - INFO: epoch 009:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=17082.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=3257.2, ups=0.19, wpb=17082.4, bsz=1024, num_updates=3510, lr=4.84165e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22195
2024-11-09 16:54:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3519 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-09 16:54:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 16:56:41 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-09 16:58:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3519 updates, score 0) (writing took 216.99921762599843 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-09 16:59:28 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-09 16:59:28 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.435 | ntokens 17153.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.81 | wps 2653.1 | ups 0.15 | wpb 17153.2 | bsz 1023 | num_updates 3519 | lr 4.84043e-05 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 1185 | gb_free 13.4 | wall 22511
2024-11-09 16:59:28 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 17:02:09 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-09 17:02:09 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 17:02:17 - progress_bar.py[line:274] - INFO: epoch 010:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=16601.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=342.5, ups=0.02, wpb=16601.1, bsz=985.6, num_updates=3520, lr=4.84029e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=29, gb_free=13.4, wall=22680
2024-11-09 17:03:10 - progress_bar.py[line:274] - INFO: epoch 010:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=17378.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=3267.2, ups=0.19, wpb=17378.4, bsz=1024, num_updates=3530, lr=4.83893e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=22733
2024-11-09 17:04:04 - progress_bar.py[line:274] - INFO: epoch 010:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=17247.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=3224.5, ups=0.19, wpb=17247.1, bsz=1024, num_updates=3540, lr=4.83757e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.2, wall=22786
2024-11-09 17:04:57 - progress_bar.py[line:274] - INFO: epoch 010:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=17106.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=3218.7, ups=0.19, wpb=17106.3, bsz=1024, num_updates=3550, lr=4.83621e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13, wall=22840
2024-11-09 17:05:50 - progress_bar.py[line:274] - INFO: epoch 010:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=17271.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=3229.3, ups=0.19, wpb=17271.3, bsz=1024, num_updates=3560, lr=4.83485e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22893
2024-11-09 17:06:44 - progress_bar.py[line:274] - INFO: epoch 010:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.439, ntokens=17334.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.84, wps=3229.2, ups=0.19, wpb=17334.2, bsz=1024, num_updates=3570, lr=4.83349e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=22947
2024-11-09 17:07:37 - progress_bar.py[line:274] - INFO: epoch 010:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.328, ntokens=16976.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=3192.6, ups=0.19, wpb=16976.3, bsz=1024, num_updates=3580, lr=4.83213e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=23000
2024-11-09 17:08:31 - progress_bar.py[line:274] - INFO: epoch 010:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=16866.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3149.7, ups=0.19, wpb=16866.2, bsz=1024, num_updates=3590, lr=4.83077e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23053
2024-11-09 17:09:24 - progress_bar.py[line:274] - INFO: epoch 010:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=17281.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=3221.3, ups=0.19, wpb=17281.7, bsz=1024, num_updates=3600, lr=4.82941e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23107
2024-11-09 17:10:18 - progress_bar.py[line:274] - INFO: epoch 010:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=17202.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=3210.8, ups=0.19, wpb=17202.4, bsz=1024, num_updates=3610, lr=4.82805e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23161
2024-11-09 17:11:12 - progress_bar.py[line:274] - INFO: epoch 010:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=17208.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=3191.7, ups=0.19, wpb=17208.2, bsz=1024, num_updates=3620, lr=4.82669e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=23215
2024-11-09 17:12:06 - progress_bar.py[line:274] - INFO: epoch 010:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=17088, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=3170.3, ups=0.19, wpb=17088, bsz=1024, num_updates=3630, lr=4.82533e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23269
2024-11-09 17:12:59 - progress_bar.py[line:274] - INFO: epoch 010:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=17186.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3197, ups=0.19, wpb=17186.9, bsz=1024, num_updates=3640, lr=4.82396e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=23322
2024-11-09 17:13:54 - progress_bar.py[line:274] - INFO: epoch 010:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=17166.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=3167.1, ups=0.18, wpb=17166.1, bsz=1024, num_updates=3650, lr=4.8226e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23376
2024-11-09 17:14:48 - progress_bar.py[line:274] - INFO: epoch 010:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=16929.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3118.6, ups=0.18, wpb=16929.9, bsz=1024, num_updates=3660, lr=4.82124e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23431
2024-11-09 17:15:41 - progress_bar.py[line:274] - INFO: epoch 010:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=17338.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=3250.6, ups=0.19, wpb=17338.2, bsz=1024, num_updates=3670, lr=4.81988e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=23484
2024-11-09 17:16:35 - progress_bar.py[line:274] - INFO: epoch 010:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=17221.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=3220.9, ups=0.19, wpb=17221.2, bsz=1024, num_updates=3680, lr=4.81852e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23538
2024-11-09 17:17:28 - progress_bar.py[line:274] - INFO: epoch 010:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=17224.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=3209.9, ups=0.19, wpb=17224.2, bsz=1024, num_updates=3690, lr=4.81716e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23591
2024-11-09 17:18:22 - progress_bar.py[line:274] - INFO: epoch 010:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=17332.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=3201, ups=0.18, wpb=17332.1, bsz=1024, num_updates=3700, lr=4.8158e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=23645
2024-11-09 17:19:16 - progress_bar.py[line:274] - INFO: epoch 010:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=17121.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=3219.2, ups=0.19, wpb=17121.2, bsz=1024, num_updates=3710, lr=4.81444e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=23699
2024-11-09 17:20:10 - progress_bar.py[line:274] - INFO: epoch 010:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=17303.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.65, wps=3203.8, ups=0.19, wpb=17303.9, bsz=1024, num_updates=3720, lr=4.81308e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=23753
2024-11-09 17:21:03 - progress_bar.py[line:274] - INFO: epoch 010:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17034.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3169.9, ups=0.19, wpb=17034.3, bsz=1024, num_updates=3730, lr=4.81172e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23806
2024-11-09 17:21:57 - progress_bar.py[line:274] - INFO: epoch 010:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=17023, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3180.7, ups=0.19, wpb=17023, bsz=1024, num_updates=3740, lr=4.81036e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23860
2024-11-09 17:22:51 - progress_bar.py[line:274] - INFO: epoch 010:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=17546.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=3273.9, ups=0.19, wpb=17546.3, bsz=1024, num_updates=3750, lr=4.809e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23913
2024-11-09 17:23:44 - progress_bar.py[line:274] - INFO: epoch 010:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.366, ntokens=17215.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3235.3, ups=0.19, wpb=17215.6, bsz=1024, num_updates=3760, lr=4.80764e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23967
2024-11-09 17:24:38 - progress_bar.py[line:274] - INFO: epoch 010:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=17174.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=3189.1, ups=0.19, wpb=17174.5, bsz=1024, num_updates=3770, lr=4.80628e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=24021
2024-11-09 17:25:32 - progress_bar.py[line:274] - INFO: epoch 010:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.344, ntokens=16995.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=3151, ups=0.19, wpb=16995.1, bsz=1024, num_updates=3780, lr=4.80492e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=24074
2024-11-09 17:26:25 - progress_bar.py[line:274] - INFO: epoch 010:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=16997.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3175.1, ups=0.19, wpb=16997.7, bsz=1024, num_updates=3790, lr=4.80356e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=12.9, wall=24128
2024-11-09 17:27:19 - progress_bar.py[line:274] - INFO: epoch 010:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=17188.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=3187.2, ups=0.19, wpb=17188.1, bsz=1024, num_updates=3800, lr=4.8022e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24182
2024-11-09 17:28:12 - progress_bar.py[line:274] - INFO: epoch 010:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=17400.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=3253.5, ups=0.19, wpb=17400.6, bsz=1024, num_updates=3810, lr=4.80084e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=24235
2024-11-09 17:29:06 - progress_bar.py[line:274] - INFO: epoch 010:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=17290.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=3243.9, ups=0.19, wpb=17290.3, bsz=1024, num_updates=3820, lr=4.79948e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24289
2024-11-09 17:29:59 - progress_bar.py[line:274] - INFO: epoch 010:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=17143.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=3230.1, ups=0.19, wpb=17143.2, bsz=1024, num_updates=3830, lr=4.79812e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=24342
2024-11-09 17:30:52 - progress_bar.py[line:274] - INFO: epoch 010:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=17078, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3190.8, ups=0.19, wpb=17078, bsz=1024, num_updates=3840, lr=4.79676e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24395
2024-11-09 17:31:46 - progress_bar.py[line:274] - INFO: epoch 010:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=17139.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=3193.2, ups=0.19, wpb=17139.9, bsz=1024, num_updates=3850, lr=4.7954e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24449
2024-11-09 17:32:40 - progress_bar.py[line:274] - INFO: epoch 010:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=17215.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=3207.2, ups=0.19, wpb=17215.7, bsz=1024, num_updates=3860, lr=4.79404e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24503
2024-11-09 17:33:34 - progress_bar.py[line:274] - INFO: epoch 010:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=17208.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3181, ups=0.18, wpb=17208.1, bsz=1024, num_updates=3870, lr=4.79268e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24557
2024-11-09 17:34:28 - progress_bar.py[line:274] - INFO: epoch 010:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=17151.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3187.9, ups=0.19, wpb=17151.5, bsz=1024, num_updates=3880, lr=4.79132e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24611
2024-11-09 17:35:21 - progress_bar.py[line:274] - INFO: epoch 010:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=17340.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=3252.4, ups=0.19, wpb=17340.3, bsz=1024, num_updates=3890, lr=4.78995e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24664
2024-11-09 17:36:13 - progress_bar.py[line:274] - INFO: epoch 010:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=17404.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=3351.9, ups=0.19, wpb=17404.2, bsz=1024, num_updates=3900, lr=4.78859e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=12.7, wall=24716
2024-11-09 17:37:01 - progress_bar.py[line:274] - INFO: epoch 010:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=16607.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=3455.5, ups=0.21, wpb=16607.1, bsz=985.6, num_updates=3910, lr=4.78723e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=29, gb_free=13.5, wall=24764
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
2024-11-09 17:37:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3910 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
2024-11-09 17:37:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 17:38:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
2024-11-09 17:40:42 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3910 updates, score 0) (writing took 220.71005299902754 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
2024-11-09 17:41:36 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-09 17:41:36 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.381 | ntokens 17178.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.42 | wps 2656.6 | ups 0.15 | wpb 17178.2 | bsz 1023 | num_updates 3910 | lr 4.78723e-05 | gnorm 0.007 | clip 0 | loss_scale 16384 | train_wall 1185 | gb_free 13.5 | wall 25039
2024-11-09 17:41:36 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 17:44:18 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-09 17:44:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 17:45:14 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=17258, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=350.2, ups=0.02, wpb=17258, bsz=1024, num_updates=3920, lr=4.78587e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=25257
2024-11-09 17:46:08 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=17038.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3162.5, ups=0.19, wpb=17038.2, bsz=1024, num_updates=3930, lr=4.78451e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=25311
2024-11-09 17:47:01 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.362, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=3256.1, ups=0.19, wpb=17333.1, bsz=1024, num_updates=3940, lr=4.78315e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=25364
2024-11-09 17:47:55 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=17157.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=3182.9, ups=0.19, wpb=17157.7, bsz=1024, num_updates=3950, lr=4.78179e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=25418
2024-11-09 17:48:48 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.357, ntokens=17224.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=3225.4, ups=0.19, wpb=17224.1, bsz=1024, num_updates=3960, lr=4.78043e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=25471
2024-11-09 17:49:41 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17187.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=3226.2, ups=0.19, wpb=17187.1, bsz=1024, num_updates=3970, lr=4.77907e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=25524
2024-11-09 17:50:35 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=16964, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=3174.1, ups=0.19, wpb=16964, bsz=1024, num_updates=3980, lr=4.77771e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=25578
2024-11-09 17:51:28 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.362, ntokens=17412.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=3255.3, ups=0.19, wpb=17412.8, bsz=1024, num_updates=3990, lr=4.77635e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25631
2024-11-09 17:52:22 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=17103.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=3165.3, ups=0.19, wpb=17103.7, bsz=1024, num_updates=4000, lr=4.77499e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=25685
2024-11-09 17:53:16 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=17188.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=3179.9, ups=0.19, wpb=17188.3, bsz=1024, num_updates=4010, lr=4.77363e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25739
2024-11-09 17:54:10 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=17197.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=3230.9, ups=0.19, wpb=17197.5, bsz=1024, num_updates=4020, lr=4.77227e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=25793
2024-11-09 17:55:04 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=17285.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=3210.8, ups=0.19, wpb=17285.2, bsz=1024, num_updates=4030, lr=4.77091e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=25846
2024-11-09 17:55:57 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.301, ntokens=17114.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3219.3, ups=0.19, wpb=17114.7, bsz=1024, num_updates=4040, lr=4.76955e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=25900
2024-11-09 17:56:50 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.294, ntokens=16758.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.81, wps=3117.4, ups=0.19, wpb=16758.7, bsz=1024, num_updates=4050, lr=4.76819e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=25953
2024-11-09 17:57:44 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.287, ntokens=17147.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.76, wps=3206.1, ups=0.19, wpb=17147.6, bsz=1024, num_updates=4060, lr=4.76683e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=26007
2024-11-09 17:58:38 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=17205.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3195.6, ups=0.19, wpb=17205.3, bsz=1024, num_updates=4070, lr=4.76547e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=26061
2024-11-09 17:59:31 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=17307.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=3241.5, ups=0.19, wpb=17307.8, bsz=1024, num_updates=4080, lr=4.76411e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26114
2024-11-09 18:00:25 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=17446.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=3262.4, ups=0.19, wpb=17446.3, bsz=1024, num_updates=4090, lr=4.76275e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=12.9, wall=26168
2024-11-09 18:01:19 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.325, ntokens=17032.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=3151.2, ups=0.19, wpb=17032.9, bsz=1024, num_updates=4100, lr=4.76139e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26222
2024-11-09 18:02:12 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.355, ntokens=17252.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.23, wps=3224.1, ups=0.19, wpb=17252.3, bsz=1024, num_updates=4110, lr=4.76003e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=26275
2024-11-09 18:03:05 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=16828.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3182.4, ups=0.19, wpb=16828.7, bsz=1024, num_updates=4120, lr=4.75867e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26328
2024-11-09 18:03:58 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.325, ntokens=17191.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=3241.1, ups=0.19, wpb=17191.9, bsz=1024, num_updates=4130, lr=4.75731e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=26381
2024-11-09 18:04:52 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17187.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3222.2, ups=0.19, wpb=17187.7, bsz=1024, num_updates=4140, lr=4.75594e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26434
2024-11-09 18:05:45 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=16976.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3201.5, ups=0.19, wpb=16976.2, bsz=1024, num_updates=4150, lr=4.75458e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=26487
2024-11-09 18:06:38 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.315, ntokens=17237.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3234.7, ups=0.19, wpb=17237.7, bsz=1024, num_updates=4160, lr=4.75322e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26541
2024-11-09 18:07:32 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17184.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3191.5, ups=0.19, wpb=17184.2, bsz=1024, num_updates=4170, lr=4.75186e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=26595
2024-11-09 18:08:26 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=17325.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=3204.8, ups=0.18, wpb=17325.3, bsz=1024, num_updates=4180, lr=4.7505e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26649
2024-11-09 18:09:20 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.25, ntokens=17004.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.51, wps=3158.6, ups=0.19, wpb=17004.1, bsz=1024, num_updates=4190, lr=4.74914e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26702
2024-11-09 18:10:13 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.287, ntokens=16855.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.76, wps=3157.8, ups=0.19, wpb=16855.4, bsz=1024, num_updates=4200, lr=4.74778e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26756
2024-11-09 18:11:07 - progress_bar.py[line:274] - INFO: epoch 011:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.318, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3204.2, ups=0.19, wpb=17258.7, bsz=1024, num_updates=4210, lr=4.74642e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=26810
2024-11-09 18:12:00 - progress_bar.py[line:274] - INFO: epoch 011:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.303, ntokens=17191.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3237, ups=0.19, wpb=17191.1, bsz=1024, num_updates=4220, lr=4.74506e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=26863
2024-11-09 18:12:54 - progress_bar.py[line:274] - INFO: epoch 011:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=17114, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3141.8, ups=0.18, wpb=17114, bsz=1024, num_updates=4230, lr=4.7437e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=26917
2024-11-09 18:13:50 - progress_bar.py[line:274] - INFO: epoch 011:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.29, ntokens=17242.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3127.8, ups=0.18, wpb=17242.6, bsz=1024, num_updates=4240, lr=4.74234e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=46, gb_free=13.3, wall=26972
2024-11-09 18:14:44 - progress_bar.py[line:274] - INFO: epoch 011:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=17318.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=3162.3, ups=0.18, wpb=17318.5, bsz=1024, num_updates=4250, lr=4.74098e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=27027
2024-11-09 18:15:39 - progress_bar.py[line:274] - INFO: epoch 011:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.294, ntokens=17092.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.81, wps=3112.5, ups=0.18, wpb=17092.5, bsz=1024, num_updates=4260, lr=4.73962e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=27082
2024-11-09 18:16:33 - progress_bar.py[line:274] - INFO: epoch 011:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17326.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=3243.3, ups=0.19, wpb=17326.6, bsz=1024, num_updates=4270, lr=4.73826e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=27136
2024-11-09 18:17:24 - progress_bar.py[line:274] - INFO: epoch 011:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.322, ntokens=17478.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=3399.5, ups=0.19, wpb=17478.7, bsz=1024, num_updates=4280, lr=4.7369e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=27187
2024-11-09 18:18:16 - progress_bar.py[line:274] - INFO: epoch 011:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=17366.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=3344.8, ups=0.19, wpb=17366.3, bsz=1024, num_updates=4290, lr=4.73554e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=27239
2024-11-09 18:19:10 - progress_bar.py[line:274] - INFO: epoch 011:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.302, ntokens=16863.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3132.3, ups=0.19, wpb=16863.5, bsz=1024, num_updates=4300, lr=4.73418e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=27293
2024-11-09 18:19:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4301 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
2024-11-09 18:19:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 18:21:03 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-09 18:22:54 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4301 updates, score 0) (writing took 222.45661645196378 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 7 seek offset 350000slice_id 4 seek offset 200000

slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-09 18:23:49 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-09 18:23:49 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.324 | ntokens 17153.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.01 | wps 2648.2 | ups 0.15 | wpb 17153.5 | bsz 1023 | num_updates 4301 | lr 4.73404e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1299 | gb_free 13.4 | wall 27572
2024-11-09 18:23:49 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 18:26:30 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-09 18:26:30 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 18:27:20 - progress_bar.py[line:274] - INFO: epoch 012:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=16487.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=336.2, ups=0.02, wpb=16487.1, bsz=985.6, num_updates=4310, lr=4.73282e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=27783
2024-11-09 18:28:13 - progress_bar.py[line:274] - INFO: epoch 012:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=17178.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=3228.2, ups=0.19, wpb=17178.8, bsz=1024, num_updates=4320, lr=4.73146e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=27836
2024-11-09 18:29:06 - progress_bar.py[line:274] - INFO: epoch 012:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.282, ntokens=17058.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.73, wps=3214.7, ups=0.19, wpb=17058.1, bsz=1024, num_updates=4330, lr=4.7301e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27889
2024-11-09 18:30:00 - progress_bar.py[line:274] - INFO: epoch 012:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.261, ntokens=16943.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3138.2, ups=0.19, wpb=16943.6, bsz=1024, num_updates=4340, lr=4.72874e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=27943
2024-11-09 18:30:54 - progress_bar.py[line:274] - INFO: epoch 012:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=17309.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3226.7, ups=0.19, wpb=17309.9, bsz=1024, num_updates=4350, lr=4.72738e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27997
2024-11-09 18:31:48 - progress_bar.py[line:274] - INFO: epoch 012:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.284, ntokens=17143.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.74, wps=3179.3, ups=0.19, wpb=17143.5, bsz=1024, num_updates=4360, lr=4.72602e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=28051
2024-11-09 18:32:41 - progress_bar.py[line:274] - INFO: epoch 012:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.248, ntokens=16866.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3202, ups=0.19, wpb=16866.4, bsz=1024, num_updates=4370, lr=4.72466e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28104
2024-11-09 18:33:35 - progress_bar.py[line:274] - INFO: epoch 012:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.307, ntokens=17294.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.9, wps=3169.2, ups=0.18, wpb=17294.7, bsz=1024, num_updates=4380, lr=4.7233e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28158
2024-11-09 18:34:28 - progress_bar.py[line:274] - INFO: epoch 012:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.298, ntokens=17243.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.84, wps=3252.7, ups=0.19, wpb=17243.4, bsz=1024, num_updates=4390, lr=4.72194e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=28211
2024-11-09 18:35:22 - progress_bar.py[line:274] - INFO: epoch 012:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.279, ntokens=16983.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.71, wps=3175.5, ups=0.19, wpb=16983.5, bsz=1024, num_updates=4400, lr=4.72057e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=28265
2024-11-09 18:36:16 - progress_bar.py[line:274] - INFO: epoch 012:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.29, ntokens=17122.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.78, wps=3170.1, ups=0.19, wpb=17122.5, bsz=1024, num_updates=4410, lr=4.71921e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28319
2024-11-09 18:37:09 - progress_bar.py[line:274] - INFO: epoch 012:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.287, ntokens=17200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.76, wps=3231.3, ups=0.19, wpb=17200.2, bsz=1024, num_updates=4420, lr=4.71785e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28372
2024-11-09 18:38:02 - progress_bar.py[line:274] - INFO: epoch 012:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17421.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3260, ups=0.19, wpb=17421.6, bsz=1024, num_updates=4430, lr=4.71649e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=28425
2024-11-09 18:38:56 - progress_bar.py[line:274] - INFO: epoch 012:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.332, ntokens=17225.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=3231.9, ups=0.19, wpb=17225.6, bsz=1024, num_updates=4440, lr=4.71513e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28479
2024-11-09 18:39:49 - progress_bar.py[line:274] - INFO: epoch 012:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.229, ntokens=17100.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.38, wps=3203.5, ups=0.19, wpb=17100.7, bsz=1024, num_updates=4450, lr=4.71377e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28532
2024-11-09 18:40:42 - progress_bar.py[line:274] - INFO: epoch 012:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.319, ntokens=17277.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3239.8, ups=0.19, wpb=17277.3, bsz=1024, num_updates=4460, lr=4.71241e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28585
2024-11-09 18:41:36 - progress_bar.py[line:274] - INFO: epoch 012:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.254, ntokens=17114.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3185.8, ups=0.19, wpb=17114.1, bsz=1024, num_updates=4470, lr=4.71105e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28639
2024-11-09 18:42:29 - progress_bar.py[line:274] - INFO: epoch 012:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17140.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3233, ups=0.19, wpb=17140.2, bsz=1024, num_updates=4480, lr=4.70969e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=28692
2024-11-09 18:43:23 - progress_bar.py[line:274] - INFO: epoch 012:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=16896.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3147.5, ups=0.19, wpb=16896.3, bsz=1024, num_updates=4490, lr=4.70833e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28746
2024-11-09 18:44:16 - progress_bar.py[line:274] - INFO: epoch 012:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.255, ntokens=17026, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3185.5, ups=0.19, wpb=17026, bsz=1024, num_updates=4500, lr=4.70697e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28799
2024-11-09 18:45:09 - progress_bar.py[line:274] - INFO: epoch 012:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.261, ntokens=16872.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.58, wps=3184.3, ups=0.19, wpb=16872.2, bsz=1024, num_updates=4510, lr=4.70561e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28852
2024-11-09 18:46:03 - progress_bar.py[line:274] - INFO: epoch 012:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17050, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3202.4, ups=0.19, wpb=17050, bsz=1024, num_updates=4520, lr=4.70425e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=28905
2024-11-09 18:46:57 - progress_bar.py[line:274] - INFO: epoch 012:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.315, ntokens=17443.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=3230.1, ups=0.19, wpb=17443.4, bsz=1024, num_updates=4530, lr=4.70289e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=28959
2024-11-09 18:47:50 - progress_bar.py[line:274] - INFO: epoch 012:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.27, ntokens=17149.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3205.2, ups=0.19, wpb=17149.6, bsz=1024, num_updates=4540, lr=4.70153e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29013
2024-11-09 18:48:44 - progress_bar.py[line:274] - INFO: epoch 012:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.269, ntokens=17235.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3224.1, ups=0.19, wpb=17235.2, bsz=1024, num_updates=4550, lr=4.70017e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=29066
2024-11-09 18:49:37 - progress_bar.py[line:274] - INFO: epoch 012:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.279, ntokens=17192.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.71, wps=3228.7, ups=0.19, wpb=17192.6, bsz=1024, num_updates=4560, lr=4.69881e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29120
2024-11-09 18:50:31 - progress_bar.py[line:274] - INFO: epoch 012:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.256, ntokens=17157.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.55, wps=3188.8, ups=0.19, wpb=17157.2, bsz=1024, num_updates=4570, lr=4.69745e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=29174
2024-11-09 18:51:24 - progress_bar.py[line:274] - INFO: epoch 012:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.211, ntokens=16934.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3196, ups=0.19, wpb=16934.7, bsz=1024, num_updates=4580, lr=4.69609e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=29226
2024-11-09 18:52:17 - progress_bar.py[line:274] - INFO: epoch 012:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.27, ntokens=17097.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3225.7, ups=0.19, wpb=17097.7, bsz=1024, num_updates=4590, lr=4.69473e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29279
2024-11-09 18:53:10 - progress_bar.py[line:274] - INFO: epoch 012:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=17368.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3254.9, ups=0.19, wpb=17368.8, bsz=1024, num_updates=4600, lr=4.69337e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29333
2024-11-09 18:54:03 - progress_bar.py[line:274] - INFO: epoch 012:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=17250.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3259.7, ups=0.19, wpb=17250.8, bsz=1024, num_updates=4610, lr=4.69201e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=29386
2024-11-09 18:54:56 - progress_bar.py[line:274] - INFO: epoch 012:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.217, ntokens=16991, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3175.1, ups=0.19, wpb=16991, bsz=1024, num_updates=4620, lr=4.69065e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=29439
2024-11-09 18:55:50 - progress_bar.py[line:274] - INFO: epoch 012:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.278, ntokens=17277.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3206.2, ups=0.19, wpb=17277.8, bsz=1024, num_updates=4630, lr=4.68929e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=29493
2024-11-09 18:56:44 - progress_bar.py[line:274] - INFO: epoch 012:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17198.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3215.9, ups=0.19, wpb=17198.6, bsz=1024, num_updates=4640, lr=4.68793e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=29547
2024-11-09 18:57:37 - progress_bar.py[line:274] - INFO: epoch 012:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.28, ntokens=17249.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.71, wps=3212.5, ups=0.19, wpb=17249.9, bsz=1024, num_updates=4650, lr=4.68656e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=29600
2024-11-09 18:58:31 - progress_bar.py[line:274] - INFO: epoch 012:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.239, ntokens=17178.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3202, ups=0.19, wpb=17178.6, bsz=1024, num_updates=4660, lr=4.6852e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=29654
2024-11-09 18:59:25 - progress_bar.py[line:274] - INFO: epoch 012:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.293, ntokens=17506.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.8, wps=3265.7, ups=0.19, wpb=17506.6, bsz=1024, num_updates=4670, lr=4.68384e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=29708
2024-11-09 19:00:17 - progress_bar.py[line:274] - INFO: epoch 012:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17284.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3330.5, ups=0.19, wpb=17284.2, bsz=1024, num_updates=4680, lr=4.68248e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=29760
2024-11-09 19:01:08 - progress_bar.py[line:274] - INFO: epoch 012:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.285, ntokens=17126, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.74, wps=3306.4, ups=0.19, wpb=17126, bsz=1024, num_updates=4690, lr=4.68112e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=29811
2024-11-09 19:01:15 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4692 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-09 19:01:15 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 19:03:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-09 19:04:58 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4692 updates, score 0) (writing took 222.4567834220361 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-09 19:05:52 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-09 19:05:52 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.276 | ntokens 17146.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.69 | wps 2656.8 | ups 0.15 | wpb 17146.5 | bsz 1023 | num_updates 4692 | lr 4.68085e-05 | gnorm 0.007 | clip 0 | loss_scale 65536 | train_wall 1185 | gb_free 13.1 | wall 30095
2024-11-09 19:05:52 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 19:08:34 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-09 19:08:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 19:09:19 - progress_bar.py[line:274] - INFO: epoch 013:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.276, ntokens=16531.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.69, wps=337, ups=0.02, wpb=16531.5, bsz=985.6, num_updates=4700, lr=4.67976e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=29, gb_free=13.3, wall=30302
2024-11-09 19:10:12 - progress_bar.py[line:274] - INFO: epoch 013:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.242, ntokens=17199.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3217, ups=0.19, wpb=17199.1, bsz=1024, num_updates=4710, lr=4.6784e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30355
2024-11-09 19:11:05 - progress_bar.py[line:274] - INFO: epoch 013:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.275, ntokens=17290, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.68, wps=3261.4, ups=0.19, wpb=17290, bsz=1024, num_updates=4720, lr=4.67704e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=30408
2024-11-09 19:11:59 - progress_bar.py[line:274] - INFO: epoch 013:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17115.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3182.8, ups=0.19, wpb=17115.4, bsz=1024, num_updates=4730, lr=4.67568e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30462
2024-11-09 19:12:53 - progress_bar.py[line:274] - INFO: epoch 013:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.278, ntokens=17300.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3224.7, ups=0.19, wpb=17300.9, bsz=1024, num_updates=4740, lr=4.67432e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30516
2024-11-09 19:13:46 - progress_bar.py[line:274] - INFO: epoch 013:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.252, ntokens=17326.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.53, wps=3250.5, ups=0.19, wpb=17326.3, bsz=1024, num_updates=4750, lr=4.67296e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30569
2024-11-09 19:14:39 - progress_bar.py[line:274] - INFO: epoch 013:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.202, ntokens=16825.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3176.8, ups=0.19, wpb=16825.5, bsz=1024, num_updates=4760, lr=4.6716e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=30622
2024-11-09 19:15:33 - progress_bar.py[line:274] - INFO: epoch 013:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.236, ntokens=17234.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.42, wps=3215.9, ups=0.19, wpb=17234.9, bsz=1024, num_updates=4770, lr=4.67024e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30676
2024-11-09 19:16:26 - progress_bar.py[line:274] - INFO: epoch 013:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.254, ntokens=17128.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3192.2, ups=0.19, wpb=17128.3, bsz=1024, num_updates=4780, lr=4.66888e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=30729
2024-11-09 19:17:20 - progress_bar.py[line:274] - INFO: epoch 013:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17171, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3226.6, ups=0.19, wpb=17171, bsz=1024, num_updates=4790, lr=4.66752e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30783
2024-11-09 19:18:13 - progress_bar.py[line:274] - INFO: epoch 013:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.258, ntokens=17201.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3201.9, ups=0.19, wpb=17201.9, bsz=1024, num_updates=4800, lr=4.66616e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=12.9, wall=30836
2024-11-09 19:19:07 - progress_bar.py[line:274] - INFO: epoch 013:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.229, ntokens=17182.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.38, wps=3203.7, ups=0.19, wpb=17182.7, bsz=1024, num_updates=4810, lr=4.6648e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=30890
2024-11-09 19:20:01 - progress_bar.py[line:274] - INFO: epoch 013:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17265.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3174.9, ups=0.18, wpb=17265.4, bsz=1024, num_updates=4820, lr=4.66344e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=30944
2024-11-09 19:20:55 - progress_bar.py[line:274] - INFO: epoch 013:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.266, ntokens=17157.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3204, ups=0.19, wpb=17157.6, bsz=1024, num_updates=4830, lr=4.66208e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30998
2024-11-09 19:21:48 - progress_bar.py[line:274] - INFO: epoch 013:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17149.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3246.7, ups=0.19, wpb=17149.3, bsz=1024, num_updates=4840, lr=4.66072e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31051
2024-11-09 19:22:41 - progress_bar.py[line:274] - INFO: epoch 013:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.252, ntokens=17281.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.53, wps=3245.5, ups=0.19, wpb=17281.5, bsz=1024, num_updates=4850, lr=4.65936e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31104
2024-11-09 19:23:35 - progress_bar.py[line:274] - INFO: epoch 013:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.236, ntokens=17079.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.42, wps=3185.8, ups=0.19, wpb=17079.2, bsz=1024, num_updates=4860, lr=4.658e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=31158
2024-11-09 19:24:28 - progress_bar.py[line:274] - INFO: epoch 013:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.242, ntokens=17255.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3208.4, ups=0.19, wpb=17255.4, bsz=1024, num_updates=4870, lr=4.65664e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31211
2024-11-09 19:25:22 - progress_bar.py[line:274] - INFO: epoch 013:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.227, ntokens=16966.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3153.9, ups=0.19, wpb=16966.2, bsz=1024, num_updates=4880, lr=4.65528e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31265
2024-11-09 19:26:17 - progress_bar.py[line:274] - INFO: epoch 013:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17024.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3132.4, ups=0.18, wpb=17024.7, bsz=1024, num_updates=4890, lr=4.65392e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31319
2024-11-09 19:27:10 - progress_bar.py[line:274] - INFO: epoch 013:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.288, ntokens=17285.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.77, wps=3228.6, ups=0.19, wpb=17285.8, bsz=1024, num_updates=4900, lr=4.65255e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=31373
2024-11-09 19:28:04 - progress_bar.py[line:274] - INFO: epoch 013:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.246, ntokens=17173.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.49, wps=3198.4, ups=0.19, wpb=17173.4, bsz=1024, num_updates=4910, lr=4.65119e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=31427
2024-11-09 19:28:57 - progress_bar.py[line:274] - INFO: epoch 013:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17088.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3192.9, ups=0.19, wpb=17088.9, bsz=1024, num_updates=4920, lr=4.64983e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=31480
2024-11-09 19:29:51 - progress_bar.py[line:274] - INFO: epoch 013:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=16852.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3143.6, ups=0.19, wpb=16852.4, bsz=1024, num_updates=4930, lr=4.64847e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=31534
2024-11-09 19:30:44 - progress_bar.py[line:274] - INFO: epoch 013:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17021.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3180.7, ups=0.19, wpb=17021.5, bsz=1024, num_updates=4940, lr=4.64711e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31587
2024-11-09 19:31:38 - progress_bar.py[line:274] - INFO: epoch 013:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17277, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3211.5, ups=0.19, wpb=17277, bsz=1024, num_updates=4950, lr=4.64575e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31641
2024-11-09 19:32:32 - progress_bar.py[line:274] - INFO: epoch 013:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.231, ntokens=17145.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.39, wps=3198.2, ups=0.19, wpb=17145.7, bsz=1024, num_updates=4960, lr=4.64439e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31695
2024-11-09 19:33:26 - progress_bar.py[line:274] - INFO: epoch 013:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17342.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.4, wps=3218.5, ups=0.19, wpb=17342.1, bsz=1024, num_updates=4970, lr=4.64303e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=31749
2024-11-09 19:34:19 - progress_bar.py[line:274] - INFO: epoch 013:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17035.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3194.6, ups=0.19, wpb=17035.6, bsz=1024, num_updates=4980, lr=4.64167e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=31802
2024-11-09 19:35:13 - progress_bar.py[line:274] - INFO: epoch 013:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17156.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3192.7, ups=0.19, wpb=17156.2, bsz=1024, num_updates=4990, lr=4.64031e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31856
2024-11-09 19:36:07 - progress_bar.py[line:274] - INFO: epoch 013:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.218, ntokens=17069.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3159, ups=0.19, wpb=17069.4, bsz=1024, num_updates=5000, lr=4.63895e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31910
loss_reg: 0.011394361958521785 loss_cls: 0.0038600049447268248
loss_reg: 0.007249184360240381 loss_cls: 0.003728778101503849
loss_reg: 0.011151639096232898 loss_cls: 0.00395108200609684
loss_reg: 0.00911728232010242 loss_cls: 0.003998316824436188
loss_reg: 0.007579211836050696 loss_cls: 0.0035100386012345552
loss_reg: 0.00979804175798897 loss_cls: 0.005661447066813707
loss_reg: 0.008765770072552729 loss_cls: 0.004600439220666885
loss_reg: 0.007281565924365739 loss_cls: 0.004085324704647064
loss_reg: 0.00935429825554642 loss_cls: 0.005080068949609995
loss_reg: 0.008195589265665198 loss_cls: 0.003908305894583464
loss_reg: 0.011314290921067971 loss_cls: 0.004064774140715599
loss_reg: 0.008691773510260625 loss_cls: 0.004026475362479687
loss_reg: 0.008482587996610023 loss_cls: 0.004063556902110577
loss_reg: 0.007510365845386875 loss_cls: 0.003660857444629073
loss_reg: 0.010045767410286314 loss_cls: 0.003362025134265423
loss_reg: 0.010783436916161302 loss_cls: 0.003497729543596506
loss_reg: 0.010595303800328663 loss_cls: 0.003093346254900098
loss_reg: 0.010222409394723336 loss_cls: 0.003181444713845849
loss_reg: 0.009408627895466853 loss_cls: 0.0031928354874253273
loss_reg: 0.009426074077854733 loss_cls: 0.0040535698644816875
loss_reg: 0.017073498275480145 loss_cls: 0.0037857687566429377
loss_reg: 0.008365915238366333 loss_cls: 0.004457241389900446
loss_reg: 0.010178073625888639 loss_cls: 0.0031955125741660595
loss_reg: 0.007940490662535831 loss_cls: 0.004161801189184189
loss_reg: 0.01202026173637143 loss_cls: 0.00563250295817852
loss_reg: 0.009415596131347494 loss_cls: 0.004760281648486853
loss_reg: 0.008734601498673054 loss_cls: 0.005111230071634054
loss_reg: 0.009057928217508036 loss_cls: 0.004164600744843483
loss_reg: 0.010747450104254727 loss_cls: 0.004824187606573105
loss_reg: 0.007946618005420503 loss_cls: 0.002856901381164789
loss_reg: 0.009115869191855478 loss_cls: 0.004339253529906273
loss_reg: 0.007118552253733101 loss_cls: 0.003971574362367392
loss_reg: 0.008762834930148924 loss_cls: 0.003591255284845829
loss_reg: 0.009290652322894014 loss_cls: 0.003728761337697506
loss_reg: 0.010944284520927945 loss_cls: 0.005060942843556404
loss_reg: 0.011258399843136951 loss_cls: 0.004190025385469198
loss_reg: 0.01375028382866298 loss_cls: 0.003209915244951844
loss_reg: 0.008272926638419985 loss_cls: 0.004150387831032276
loss_reg: 0.008615410760595094 loss_cls: 0.0035295377019792795
loss_reg: 0.011834175669888687 loss_cls: 0.004666167311370373
loss_reg: 0.014761501053739806 loss_cls: 0.0032302557956427336
loss_reg: 0.009641857158523491 loss_cls: 0.0035601991694420576
loss_reg: 0.010983170043041064 loss_cls: 0.003922293893992901
loss_reg: 0.00976368091844757 loss_cls: 0.0033846423029899597
loss_reg: 0.00915679351799693 loss_cls: 0.004112225957214832
loss_reg: 0.010682597879295194 loss_cls: 0.003954063635319471
loss_reg: 0.01124256966371785 loss_cls: 0.004026798531413078
loss_reg: 0.014309063501118552 loss_cls: 0.0034829440992325544
loss_reg: 0.007136569944667422 loss_cls: 0.003814668394625187
loss_reg: 0.0087462976308422 loss_cls: 0.004842464812099934
loss_reg: 0.011484409589036784 loss_cls: 0.00374226295389235
loss_reg: 0.013989048671197185 loss_cls: 0.003594095353037119
loss_reg: 0.01038366548014157 loss_cls: 0.003631646279245615
loss_reg: 0.011700402345091211 loss_cls: 0.0034466588404029608
loss_reg: 0.01010292975376102 loss_cls: 0.00393163226544857
loss_reg: 0.01049806121329928 loss_cls: 0.0036417541559785604
loss_reg: 0.01243812172756609 loss_cls: 0.0034839417785406113
loss_reg: 0.007772593563849302 loss_cls: 0.00441855238750577
loss_reg: 0.012011000349831758 loss_cls: 0.003251984715461731
loss_reg: 0.008355552374325129 loss_cls: 0.003581514349207282
loss_reg: 0.007414368581580016 loss_cls: 0.004169804975390434
loss_reg: 0.00835124170315979 loss_cls: 0.00397731177508831
loss_reg: 0.013500403413338358 loss_cls: 0.0034632699098438025
loss_reg: 0.01119667228369029 loss_cls: 0.003271285677328706
2024-11-09 19:37:00 - progress_bar.py[line:274] - INFO: epoch 013:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.221, ntokens=17099.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3190.4, ups=0.19, wpb=17099.6, bsz=1024, num_updates=5010, lr=4.63759e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=31963
2024-11-09 19:37:54 - progress_bar.py[line:274] - INFO: epoch 013:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.196, ntokens=17205.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3215.9, ups=0.19, wpb=17205.5, bsz=1024, num_updates=5020, lr=4.63623e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=32017
2024-11-09 19:38:47 - progress_bar.py[line:274] - INFO: epoch 013:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.233, ntokens=17168, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3225.7, ups=0.19, wpb=17168, bsz=1024, num_updates=5030, lr=4.63487e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=32070
2024-11-09 19:39:41 - progress_bar.py[line:274] - INFO: epoch 013:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.235, ntokens=17194.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.42, wps=3218.4, ups=0.19, wpb=17194.8, bsz=1024, num_updates=5040, lr=4.63351e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=12.7, wall=32123
2024-11-09 19:40:34 - progress_bar.py[line:274] - INFO: epoch 013:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.18, ntokens=17098.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3172.2, ups=0.19, wpb=17098.3, bsz=1024, num_updates=5050, lr=4.63215e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=32177
2024-11-09 19:41:28 - progress_bar.py[line:274] - INFO: epoch 013:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17245.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3220.4, ups=0.19, wpb=17245.9, bsz=1024, num_updates=5060, lr=4.63079e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=32231
2024-11-09 19:42:20 - progress_bar.py[line:274] - INFO: epoch 013:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17347.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3339.4, ups=0.19, wpb=17347.4, bsz=1024, num_updates=5070, lr=4.62943e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=32283
2024-11-09 19:43:11 - progress_bar.py[line:274] - INFO: epoch 013:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17248.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3346.9, ups=0.19, wpb=17248.4, bsz=1024, num_updates=5080, lr=4.62807e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=32334
2024-11-09 19:43:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 5083 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
2024-11-09 19:43:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 19:45:15 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 19:47:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 5083 updates, score 0) (writing took 222.77574298501713 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-09 19:48:01 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-09 19:48:01 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.236 | ntokens 17146.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.42 | wps 2651.2 | ups 0.15 | wpb 17146.9 | bsz 1023 | num_updates 5083 | lr 4.62766e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1183 | gb_free 13.3 | wall 32624
2024-11-09 19:48:01 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 19:50:42 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-09 19:50:42 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 19:51:23 - progress_bar.py[line:274] - INFO: epoch 014:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.241, ntokens=16667, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=338.9, ups=0.02, wpb=16667, bsz=985.6, num_updates=5090, lr=4.62671e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=32826
2024-11-09 19:52:17 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-09 19:52:22 - progress_bar.py[line:274] - INFO: epoch 014:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17312.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=2937.1, ups=0.17, wpb=17312.5, bsz=1024, num_updates=5100, lr=4.62535e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=32885
2024-11-09 19:53:15 - progress_bar.py[line:274] - INFO: epoch 014:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17315.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3270.5, ups=0.19, wpb=17315.1, bsz=1024, num_updates=5110, lr=4.62399e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=32938
2024-11-09 19:54:08 - progress_bar.py[line:274] - INFO: epoch 014:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.187, ntokens=16974.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=3189.5, ups=0.19, wpb=16974.3, bsz=1024, num_updates=5120, lr=4.62263e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=32991
2024-11-09 19:55:02 - progress_bar.py[line:274] - INFO: epoch 014:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.224, ntokens=17207.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3243.9, ups=0.19, wpb=17207.8, bsz=1024, num_updates=5130, lr=4.62127e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33044
2024-11-09 19:55:55 - progress_bar.py[line:274] - INFO: epoch 014:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.226, ntokens=17261.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.36, wps=3233.5, ups=0.19, wpb=17261.3, bsz=1024, num_updates=5140, lr=4.61991e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33098
2024-11-09 19:56:48 - progress_bar.py[line:274] - INFO: epoch 014:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=16879.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3150.4, ups=0.19, wpb=16879.4, bsz=1024, num_updates=5150, lr=4.61854e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33151
2024-11-09 19:57:42 - progress_bar.py[line:274] - INFO: epoch 014:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.235, ntokens=17274.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3231.1, ups=0.19, wpb=17274.2, bsz=1024, num_updates=5160, lr=4.61718e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33205
2024-11-09 19:58:36 - progress_bar.py[line:274] - INFO: epoch 014:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=17083.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3178.8, ups=0.19, wpb=17083.5, bsz=1024, num_updates=5170, lr=4.61582e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33259
2024-11-09 19:59:29 - progress_bar.py[line:274] - INFO: epoch 014:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.225, ntokens=17348.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.35, wps=3232.9, ups=0.19, wpb=17348.8, bsz=1024, num_updates=5180, lr=4.61446e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33312
2024-11-09 20:00:23 - progress_bar.py[line:274] - INFO: epoch 014:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.241, ntokens=17280.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3213.5, ups=0.19, wpb=17280.5, bsz=1024, num_updates=5190, lr=4.6131e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=33366
2024-11-09 20:01:17 - progress_bar.py[line:274] - INFO: epoch 014:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.253, ntokens=17332.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3190.9, ups=0.18, wpb=17332.7, bsz=1024, num_updates=5200, lr=4.61174e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=33420
2024-11-09 20:02:10 - progress_bar.py[line:274] - INFO: epoch 014:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17265.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3257.4, ups=0.19, wpb=17265.3, bsz=1024, num_updates=5210, lr=4.61038e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=33473
2024-11-09 20:03:04 - progress_bar.py[line:274] - INFO: epoch 014:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=17384.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3247.6, ups=0.19, wpb=17384.1, bsz=1024, num_updates=5220, lr=4.60902e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33527
2024-11-09 20:03:57 - progress_bar.py[line:274] - INFO: epoch 014:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.177, ntokens=17051.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3212.5, ups=0.19, wpb=17051.4, bsz=1024, num_updates=5230, lr=4.60766e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33580
2024-11-09 20:04:50 - progress_bar.py[line:274] - INFO: epoch 014:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.245, ntokens=17385.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.48, wps=3263.8, ups=0.19, wpb=17385.5, bsz=1024, num_updates=5240, lr=4.6063e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=33633
2024-11-09 20:05:44 - progress_bar.py[line:274] - INFO: epoch 014:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.213, ntokens=17196.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3227.7, ups=0.19, wpb=17196.5, bsz=1024, num_updates=5250, lr=4.60494e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=33687
2024-11-09 20:06:37 - progress_bar.py[line:274] - INFO: epoch 014:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.202, ntokens=17293.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3238.7, ups=0.19, wpb=17293.2, bsz=1024, num_updates=5260, lr=4.60358e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33740
2024-11-09 20:07:30 - progress_bar.py[line:274] - INFO: epoch 014:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=16864.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3176.7, ups=0.19, wpb=16864.7, bsz=1024, num_updates=5270, lr=4.60222e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=33793
2024-11-09 20:08:24 - progress_bar.py[line:274] - INFO: epoch 014:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.197, ntokens=17213.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3194.7, ups=0.19, wpb=17213.9, bsz=1024, num_updates=5280, lr=4.60086e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=33847
2024-11-09 20:09:17 - progress_bar.py[line:274] - INFO: epoch 014:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.243, ntokens=17258.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3230.6, ups=0.19, wpb=17258.2, bsz=1024, num_updates=5290, lr=4.5995e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33900
2024-11-09 20:10:11 - progress_bar.py[line:274] - INFO: epoch 014:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.191, ntokens=17232.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.13, wps=3228.5, ups=0.19, wpb=17232.5, bsz=1024, num_updates=5300, lr=4.59814e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=33954
2024-11-09 20:11:04 - progress_bar.py[line:274] - INFO: epoch 014:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.197, ntokens=17166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3203.9, ups=0.19, wpb=17166.3, bsz=1024, num_updates=5310, lr=4.59678e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=34007
2024-11-09 20:11:58 - progress_bar.py[line:274] - INFO: epoch 014:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17115.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3204.8, ups=0.19, wpb=17115.4, bsz=1024, num_updates=5320, lr=4.59542e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=34061
2024-11-09 20:12:51 - progress_bar.py[line:274] - INFO: epoch 014:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.202, ntokens=17263.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3237.9, ups=0.19, wpb=17263.9, bsz=1024, num_updates=5330, lr=4.59406e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=34114
2024-11-09 20:13:44 - progress_bar.py[line:274] - INFO: epoch 014:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17246.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3233.5, ups=0.19, wpb=17246.7, bsz=1024, num_updates=5340, lr=4.5927e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=34167
2024-11-09 20:14:38 - progress_bar.py[line:274] - INFO: epoch 014:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.224, ntokens=17349.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3264.7, ups=0.19, wpb=17349.7, bsz=1024, num_updates=5350, lr=4.59134e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=34220
2024-11-09 20:15:31 - progress_bar.py[line:274] - INFO: epoch 014:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.197, ntokens=17059.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3189.3, ups=0.19, wpb=17059.9, bsz=1024, num_updates=5360, lr=4.58998e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=34274
2024-11-09 20:16:25 - progress_bar.py[line:274] - INFO: epoch 014:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17122.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3191.4, ups=0.19, wpb=17122.1, bsz=1024, num_updates=5370, lr=4.58862e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=34328
2024-11-09 20:17:19 - progress_bar.py[line:274] - INFO: epoch 014:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.25, ntokens=17453.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.52, wps=3221, ups=0.18, wpb=17453.3, bsz=1024, num_updates=5380, lr=4.58726e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=34382
2024-11-09 20:18:13 - progress_bar.py[line:274] - INFO: epoch 014:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=16868.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3106.4, ups=0.18, wpb=16868.6, bsz=1024, num_updates=5390, lr=4.5859e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=37, gb_free=13.4, wall=34436
2024-11-09 20:19:07 - progress_bar.py[line:274] - INFO: epoch 014:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17032, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3173, ups=0.19, wpb=17032, bsz=1024, num_updates=5400, lr=4.58454e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.4, wall=34490
2024-11-09 20:19:59 - progress_bar.py[line:274] - INFO: epoch 014:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=16965, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3246.4, ups=0.19, wpb=16965, bsz=1024, num_updates=5410, lr=4.58317e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=34542
2024-11-09 20:20:52 - progress_bar.py[line:274] - INFO: epoch 014:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17280, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3243.5, ups=0.19, wpb=17280, bsz=1024, num_updates=5420, lr=4.58181e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=34595
2024-11-09 20:21:46 - progress_bar.py[line:274] - INFO: epoch 014:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=16939.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3177.4, ups=0.19, wpb=16939.4, bsz=1024, num_updates=5430, lr=4.58045e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=34649
2024-11-09 20:22:40 - progress_bar.py[line:274] - INFO: epoch 014:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17199.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3196.8, ups=0.19, wpb=17199.3, bsz=1024, num_updates=5440, lr=4.57909e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=34702
2024-11-09 20:23:33 - progress_bar.py[line:274] - INFO: epoch 014:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17445.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3232.8, ups=0.19, wpb=17445.2, bsz=1024, num_updates=5450, lr=4.57773e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=34756
2024-11-09 20:24:25 - progress_bar.py[line:274] - INFO: epoch 014:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.22, ntokens=17224.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3328.2, ups=0.19, wpb=17224.8, bsz=1024, num_updates=5460, lr=4.57637e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=34808
2024-11-09 20:25:17 - progress_bar.py[line:274] - INFO: epoch 014:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=16900, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3248.1, ups=0.19, wpb=16900, bsz=1024, num_updates=5470, lr=4.57501e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=34860
2024-11-09 20:25:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5473 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-09 20:25:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 20:27:15 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-09 20:29:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5473 updates, score 0) (writing took 217.03546508500585 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
2024-11-09 20:30:01 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-09 20:30:01 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.203 | ntokens 17170.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.21 | wps 2657.5 | ups 0.15 | wpb 17170.8 | bsz 1023 | num_updates 5473 | lr 4.5746e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1220 | gb_free 13.3 | wall 35144
2024-11-09 20:30:01 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 20:32:43 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-09 20:32:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 20:33:24 - progress_bar.py[line:274] - INFO: epoch 015:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.214, ntokens=16699.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=343.3, ups=0.02, wpb=16699.4, bsz=985.6, num_updates=5480, lr=4.57365e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=35347
2024-11-09 20:34:17 - progress_bar.py[line:274] - INFO: epoch 015:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.18, ntokens=17142.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3214, ups=0.19, wpb=17142.8, bsz=1024, num_updates=5490, lr=4.57229e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=35400
2024-11-09 20:35:11 - progress_bar.py[line:274] - INFO: epoch 015:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17137.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3187.8, ups=0.19, wpb=17137.2, bsz=1024, num_updates=5500, lr=4.57093e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=35454
2024-11-09 20:36:04 - progress_bar.py[line:274] - INFO: epoch 015:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.192, ntokens=17171.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3222.8, ups=0.19, wpb=17171.4, bsz=1024, num_updates=5510, lr=4.56957e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35507
2024-11-09 20:36:57 - progress_bar.py[line:274] - INFO: epoch 015:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.182, ntokens=17230.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3226, ups=0.19, wpb=17230.5, bsz=1024, num_updates=5520, lr=4.56821e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=35560
2024-11-09 20:37:51 - progress_bar.py[line:274] - INFO: epoch 015:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.169, ntokens=17150.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3202.7, ups=0.19, wpb=17150.1, bsz=1024, num_updates=5530, lr=4.56685e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=35614
2024-11-09 20:38:44 - progress_bar.py[line:274] - INFO: epoch 015:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.144, ntokens=17013.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.84, wps=3187.4, ups=0.19, wpb=17013.7, bsz=1024, num_updates=5540, lr=4.56549e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35667
2024-11-09 20:39:38 - progress_bar.py[line:274] - INFO: epoch 015:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17295.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3247.7, ups=0.19, wpb=17295.5, bsz=1024, num_updates=5550, lr=4.56413e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35721
2024-11-09 20:40:32 - progress_bar.py[line:274] - INFO: epoch 015:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.21, ntokens=17446.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3234.2, ups=0.19, wpb=17446.9, bsz=1024, num_updates=5560, lr=4.56277e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=35775
2024-11-09 20:41:25 - progress_bar.py[line:274] - INFO: epoch 015:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.168, ntokens=17108, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=3213.5, ups=0.19, wpb=17108, bsz=1024, num_updates=5570, lr=4.56141e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35828
2024-11-09 20:42:18 - progress_bar.py[line:274] - INFO: epoch 015:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.169, ntokens=17014.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=3212.5, ups=0.19, wpb=17014.5, bsz=1024, num_updates=5580, lr=4.56005e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35881
2024-11-09 20:43:12 - progress_bar.py[line:274] - INFO: epoch 015:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17122.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3178.7, ups=0.19, wpb=17122.1, bsz=1024, num_updates=5590, lr=4.55869e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=35935
2024-11-09 20:44:05 - progress_bar.py[line:274] - INFO: epoch 015:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.146, ntokens=17104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3187.8, ups=0.19, wpb=17104.2, bsz=1024, num_updates=5600, lr=4.55733e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=35988
2024-11-09 20:44:59 - progress_bar.py[line:274] - INFO: epoch 015:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.202, ntokens=17369.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3236.5, ups=0.19, wpb=17369.3, bsz=1024, num_updates=5610, lr=4.55597e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=36042
2024-11-09 20:45:53 - progress_bar.py[line:274] - INFO: epoch 015:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.164, ntokens=17007.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3172.7, ups=0.19, wpb=17007.7, bsz=1024, num_updates=5620, lr=4.55461e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=36096
2024-11-09 20:46:46 - progress_bar.py[line:274] - INFO: epoch 015:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.168, ntokens=17185.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=3227.2, ups=0.19, wpb=17185.6, bsz=1024, num_updates=5630, lr=4.55325e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=36149
2024-11-09 20:47:40 - progress_bar.py[line:274] - INFO: epoch 015:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17253.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3206.5, ups=0.19, wpb=17253.8, bsz=1024, num_updates=5640, lr=4.55189e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=36203
2024-11-09 20:48:34 - progress_bar.py[line:274] - INFO: epoch 015:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17314.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3198.2, ups=0.18, wpb=17314.2, bsz=1024, num_updates=5650, lr=4.55053e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=36257
2024-11-09 20:49:28 - progress_bar.py[line:274] - INFO: epoch 015:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=16999.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3163.4, ups=0.19, wpb=16999.2, bsz=1024, num_updates=5660, lr=4.54916e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=36310
2024-11-09 20:50:21 - progress_bar.py[line:274] - INFO: epoch 015:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.169, ntokens=17206.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3202.5, ups=0.19, wpb=17206.9, bsz=1024, num_updates=5670, lr=4.5478e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=36364
2024-11-09 20:51:15 - progress_bar.py[line:274] - INFO: epoch 015:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.216, ntokens=17370.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.29, wps=3260.4, ups=0.19, wpb=17370.7, bsz=1024, num_updates=5680, lr=4.54644e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=36417
2024-11-09 20:52:08 - progress_bar.py[line:274] - INFO: epoch 015:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.178, ntokens=17116.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3214.8, ups=0.19, wpb=17116.7, bsz=1024, num_updates=5690, lr=4.54508e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=36471
2024-11-09 20:53:02 - progress_bar.py[line:274] - INFO: epoch 015:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17250.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3202.4, ups=0.19, wpb=17250.7, bsz=1024, num_updates=5700, lr=4.54372e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=36525
2024-11-09 20:53:55 - progress_bar.py[line:274] - INFO: epoch 015:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17053.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3174.5, ups=0.19, wpb=17053.3, bsz=1024, num_updates=5710, lr=4.54236e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=36578
2024-11-09 20:54:49 - progress_bar.py[line:274] - INFO: epoch 015:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17036.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3184.8, ups=0.19, wpb=17036.5, bsz=1024, num_updates=5720, lr=4.541e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=36632
2024-11-09 20:55:00 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-09 20:55:48 - progress_bar.py[line:274] - INFO: epoch 015:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.168, ntokens=17095.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=2899, ups=0.17, wpb=17095.6, bsz=1024, num_updates=5730, lr=4.53964e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=36691
2024-11-09 20:56:41 - progress_bar.py[line:274] - INFO: epoch 015:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.167, ntokens=17284.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3229.4, ups=0.19, wpb=17284.5, bsz=1024, num_updates=5740, lr=4.53828e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=36744
2024-11-09 20:57:35 - progress_bar.py[line:274] - INFO: epoch 015:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=16938.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3139.9, ups=0.19, wpb=16938.3, bsz=1024, num_updates=5750, lr=4.53692e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=36798
2024-11-09 20:58:29 - progress_bar.py[line:274] - INFO: epoch 015:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17282.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3193.3, ups=0.18, wpb=17282.7, bsz=1024, num_updates=5760, lr=4.53556e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=36852
2024-11-09 20:59:25 - progress_bar.py[line:274] - INFO: epoch 015:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.192, ntokens=17272.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3110, ups=0.18, wpb=17272.5, bsz=1024, num_updates=5770, lr=4.5342e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=36908
2024-11-09 21:00:19 - progress_bar.py[line:274] - INFO: epoch 015:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=17223.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3193.8, ups=0.19, wpb=17223.9, bsz=1024, num_updates=5780, lr=4.53284e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=36962
2024-11-09 21:01:13 - progress_bar.py[line:274] - INFO: epoch 015:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17023.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3160.1, ups=0.19, wpb=17023.9, bsz=1024, num_updates=5790, lr=4.53148e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37016
2024-11-09 21:02:07 - progress_bar.py[line:274] - INFO: epoch 015:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17173.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3162.8, ups=0.18, wpb=17173.8, bsz=1024, num_updates=5800, lr=4.53012e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37070
2024-11-09 21:03:01 - progress_bar.py[line:274] - INFO: epoch 015:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.196, ntokens=17520.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3277.7, ups=0.19, wpb=17520.3, bsz=1024, num_updates=5810, lr=4.52876e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=37123
2024-11-09 21:03:55 - progress_bar.py[line:274] - INFO: epoch 015:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.148, ntokens=17263.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3175.7, ups=0.18, wpb=17263.7, bsz=1024, num_updates=5820, lr=4.5274e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=37178
2024-11-09 21:04:48 - progress_bar.py[line:274] - INFO: epoch 015:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.158, ntokens=17352.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3241, ups=0.19, wpb=17352.1, bsz=1024, num_updates=5830, lr=4.52604e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=37231
2024-11-09 21:05:42 - progress_bar.py[line:274] - INFO: epoch 015:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=17277.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3221.6, ups=0.19, wpb=17277.8, bsz=1024, num_updates=5840, lr=4.52468e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=37285
2024-11-09 21:06:34 - progress_bar.py[line:274] - INFO: epoch 015:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=17551.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3357.8, ups=0.19, wpb=17551.4, bsz=1024, num_updates=5850, lr=4.52332e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=37337
2024-11-09 21:07:26 - progress_bar.py[line:274] - INFO: epoch 015:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17052.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3290.8, ups=0.19, wpb=17052.2, bsz=1024, num_updates=5860, lr=4.52196e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=37389
2024-11-09 21:07:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5863 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-09 21:07:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 21:09:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 21:11:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5863 updates, score 0) (writing took 222.57988528499845 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-09 21:12:16 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-09 21:12:16 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.173 | ntokens 17182.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.02 | wps 2643.9 | ups 0.15 | wpb 17182.6 | bsz 1023 | num_updates 5863 | lr 4.52155e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.3 | wall 37679
2024-11-09 21:12:16 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 21:14:57 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-09 21:14:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 21:15:37 - progress_bar.py[line:274] - INFO: epoch 016:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=16665.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=339.8, ups=0.02, wpb=16665.7, bsz=985.6, num_updates=5870, lr=4.5206e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=29, gb_free=13.4, wall=37880
2024-11-09 21:16:30 - progress_bar.py[line:274] - INFO: epoch 016:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17151.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3216.4, ups=0.19, wpb=17151.1, bsz=1024, num_updates=5880, lr=4.51924e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=37933
2024-11-09 21:17:23 - progress_bar.py[line:274] - INFO: epoch 016:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17255.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3242.4, ups=0.19, wpb=17255.1, bsz=1024, num_updates=5890, lr=4.51788e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=37986
2024-11-09 21:18:16 - progress_bar.py[line:274] - INFO: epoch 016:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.173, ntokens=17224, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.02, wps=3244.5, ups=0.19, wpb=17224, bsz=1024, num_updates=5900, lr=4.51652e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=38039
2024-11-09 21:19:09 - progress_bar.py[line:274] - INFO: epoch 016:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.141, ntokens=17192.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3255.8, ups=0.19, wpb=17192.4, bsz=1024, num_updates=5910, lr=4.51515e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=38092
2024-11-09 21:19:46 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-09 21:20:08 - progress_bar.py[line:274] - INFO: epoch 016:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17177.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=2933.2, ups=0.17, wpb=17177.8, bsz=1024, num_updates=5920, lr=4.51379e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=38151
2024-11-09 21:21:01 - progress_bar.py[line:274] - INFO: epoch 016:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.083, ntokens=16771.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3114.8, ups=0.19, wpb=16771.7, bsz=1024, num_updates=5930, lr=4.51243e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=38204
2024-11-09 21:21:55 - progress_bar.py[line:274] - INFO: epoch 016:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.18, ntokens=17288.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3213.2, ups=0.19, wpb=17288.3, bsz=1024, num_updates=5940, lr=4.51107e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38258
2024-11-09 21:22:49 - progress_bar.py[line:274] - INFO: epoch 016:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17057.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3186.6, ups=0.19, wpb=17057.3, bsz=1024, num_updates=5950, lr=4.50971e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=38312
2024-11-09 21:23:42 - progress_bar.py[line:274] - INFO: epoch 016:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.154, ntokens=17136.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.9, wps=3208.3, ups=0.19, wpb=17136.6, bsz=1024, num_updates=5960, lr=4.50835e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=38365
2024-11-09 21:24:36 - progress_bar.py[line:274] - INFO: epoch 016:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=16990.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3169.2, ups=0.19, wpb=16990.5, bsz=1024, num_updates=5970, lr=4.50699e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=38419
2024-11-09 21:25:30 - progress_bar.py[line:274] - INFO: epoch 016:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.185, ntokens=17308.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3210.2, ups=0.19, wpb=17308.6, bsz=1024, num_updates=5980, lr=4.50563e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38473
2024-11-09 21:26:23 - progress_bar.py[line:274] - INFO: epoch 016:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17206.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3244.9, ups=0.19, wpb=17206.8, bsz=1024, num_updates=5990, lr=4.50427e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=38526
2024-11-09 21:27:16 - progress_bar.py[line:274] - INFO: epoch 016:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.164, ntokens=17269.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3262.5, ups=0.19, wpb=17269.5, bsz=1024, num_updates=6000, lr=4.50291e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38579
2024-11-09 21:28:09 - progress_bar.py[line:274] - INFO: epoch 016:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17253, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3222.6, ups=0.19, wpb=17253, bsz=1024, num_updates=6010, lr=4.50155e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38632
2024-11-09 21:29:03 - progress_bar.py[line:274] - INFO: epoch 016:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17170.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3183.4, ups=0.19, wpb=17170.4, bsz=1024, num_updates=6020, lr=4.50019e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=38686
2024-11-09 21:29:57 - progress_bar.py[line:274] - INFO: epoch 016:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17172.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3189.2, ups=0.19, wpb=17172.2, bsz=1024, num_updates=6030, lr=4.49883e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=38740
2024-11-09 21:30:51 - progress_bar.py[line:274] - INFO: epoch 016:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.145, ntokens=17180.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3202.8, ups=0.19, wpb=17180.6, bsz=1024, num_updates=6040, lr=4.49747e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=38794
2024-11-09 21:31:45 - progress_bar.py[line:274] - INFO: epoch 016:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17133.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.84, wps=3180.4, ups=0.19, wpb=17133.5, bsz=1024, num_updates=6050, lr=4.49611e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=38847
2024-11-09 21:32:39 - progress_bar.py[line:274] - INFO: epoch 016:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17207.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3141.8, ups=0.18, wpb=17207.7, bsz=1024, num_updates=6060, lr=4.49475e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=38902
2024-11-09 21:33:33 - progress_bar.py[line:274] - INFO: epoch 016:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=16961, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3180.1, ups=0.19, wpb=16961, bsz=1024, num_updates=6070, lr=4.49339e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=38956
2024-11-09 21:34:26 - progress_bar.py[line:274] - INFO: epoch 016:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.148, ntokens=17152.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3232.6, ups=0.19, wpb=17152.8, bsz=1024, num_updates=6080, lr=4.49203e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=39009
2024-11-09 21:35:19 - progress_bar.py[line:274] - INFO: epoch 016:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=16974.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3187.9, ups=0.19, wpb=16974.8, bsz=1024, num_updates=6090, lr=4.49067e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=39062
2024-11-09 21:36:12 - progress_bar.py[line:274] - INFO: epoch 016:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.091, ntokens=16968.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=3179.5, ups=0.19, wpb=16968.9, bsz=1024, num_updates=6100, lr=4.48931e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=39115
2024-11-09 21:37:06 - progress_bar.py[line:274] - INFO: epoch 016:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17188.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3203.4, ups=0.19, wpb=17188.7, bsz=1024, num_updates=6110, lr=4.48795e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=39169
2024-11-09 21:38:00 - progress_bar.py[line:274] - INFO: epoch 016:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.182, ntokens=17136.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3156.1, ups=0.18, wpb=17136.4, bsz=1024, num_updates=6120, lr=4.48659e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=39223
2024-11-09 21:38:54 - progress_bar.py[line:274] - INFO: epoch 016:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17168.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3175.5, ups=0.18, wpb=17168.2, bsz=1024, num_updates=6130, lr=4.48523e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=39277
2024-11-09 21:39:47 - progress_bar.py[line:274] - INFO: epoch 016:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=16962.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3193.3, ups=0.19, wpb=16962.4, bsz=1024, num_updates=6140, lr=4.48387e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=39330
2024-11-09 21:40:41 - progress_bar.py[line:274] - INFO: epoch 016:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=17059.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3206.2, ups=0.19, wpb=17059.6, bsz=1024, num_updates=6150, lr=4.48251e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=39384
2024-11-09 21:41:23 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8192.0
2024-11-09 21:41:39 - progress_bar.py[line:274] - INFO: epoch 016:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.187, ntokens=17340, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=2967.6, ups=0.17, wpb=17340, bsz=1024, num_updates=6160, lr=4.48114e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=33, gb_free=13.2, wall=39442
2024-11-09 21:42:33 - progress_bar.py[line:274] - INFO: epoch 016:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17037.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3185.1, ups=0.19, wpb=17037.6, bsz=1024, num_updates=6170, lr=4.47978e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=39495
2024-11-09 21:43:26 - progress_bar.py[line:274] - INFO: epoch 016:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17139.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3193.7, ups=0.19, wpb=17139.6, bsz=1024, num_updates=6180, lr=4.47842e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.6, wall=39549
2024-11-09 21:44:19 - progress_bar.py[line:274] - INFO: epoch 016:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17020.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3218.3, ups=0.19, wpb=17020.2, bsz=1024, num_updates=6190, lr=4.47706e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=39602
2024-11-09 21:45:13 - progress_bar.py[line:274] - INFO: epoch 016:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17204, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3207.1, ups=0.19, wpb=17204, bsz=1024, num_updates=6200, lr=4.4757e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=39656
2024-11-09 21:46:07 - progress_bar.py[line:274] - INFO: epoch 016:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.121, ntokens=17118.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3170.9, ups=0.19, wpb=17118.3, bsz=1024, num_updates=6210, lr=4.47434e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=39710
2024-11-09 21:47:01 - progress_bar.py[line:274] - INFO: epoch 016:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17264.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3201.5, ups=0.19, wpb=17264.4, bsz=1024, num_updates=6220, lr=4.47298e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=39764
2024-11-09 21:47:54 - progress_bar.py[line:274] - INFO: epoch 016:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17364.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3253, ups=0.19, wpb=17364.3, bsz=1024, num_updates=6230, lr=4.47162e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=39817
2024-11-09 21:48:46 - progress_bar.py[line:274] - INFO: epoch 016:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.157, ntokens=17188.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.92, wps=3340.3, ups=0.19, wpb=17188.9, bsz=1024, num_updates=6240, lr=4.47026e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=39868
2024-11-09 21:49:38 - progress_bar.py[line:274] - INFO: epoch 016:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.145, ntokens=17030.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3261.1, ups=0.19, wpb=17030.9, bsz=1024, num_updates=6250, lr=4.4689e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=39921
2024-11-09 21:49:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 6252 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-09 21:49:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 21:51:36 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-09 21:53:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 6252 updates, score 0) (writing took 222.49030615598895 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000


slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-09 21:54:22 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-09 21:54:22 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.142 | ntokens 17129.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.83 | wps 2637.3 | ups 0.15 | wpb 17129.5 | bsz 1023 | num_updates 6252 | lr 4.46863e-05 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 1185 | gb_free 13.2 | wall 40205
2024-11-09 21:54:22 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 21:57:03 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-09 21:57:03 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 21:57:48 - progress_bar.py[line:274] - INFO: epoch 017:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.144, ntokens=16422.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.84, wps=335, ups=0.02, wpb=16422.9, bsz=985.6, num_updates=6260, lr=4.46754e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=40411
2024-11-09 21:58:41 - progress_bar.py[line:274] - INFO: epoch 017:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=17053.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3197.7, ups=0.19, wpb=17053.7, bsz=1024, num_updates=6270, lr=4.46618e-05, gnorm=0.012, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=40464
2024-11-09 21:59:35 - progress_bar.py[line:274] - INFO: epoch 017:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.148, ntokens=17255.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3213.9, ups=0.19, wpb=17255.4, bsz=1024, num_updates=6280, lr=4.46482e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=40518
2024-11-09 22:00:28 - progress_bar.py[line:274] - INFO: epoch 017:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.125, ntokens=17016.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3189.2, ups=0.19, wpb=17016.3, bsz=1024, num_updates=6290, lr=4.46346e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40571
2024-11-09 22:01:22 - progress_bar.py[line:274] - INFO: epoch 017:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17026.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3205.4, ups=0.19, wpb=17026.5, bsz=1024, num_updates=6300, lr=4.4621e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40624
2024-11-09 22:02:15 - progress_bar.py[line:274] - INFO: epoch 017:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17204.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3211.8, ups=0.19, wpb=17204.9, bsz=1024, num_updates=6310, lr=4.46074e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40678
2024-11-09 22:03:09 - progress_bar.py[line:274] - INFO: epoch 017:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.08, ntokens=16858, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3116.7, ups=0.18, wpb=16858, bsz=1024, num_updates=6320, lr=4.45938e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40732
2024-11-09 22:04:02 - progress_bar.py[line:274] - INFO: epoch 017:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.114, ntokens=17090.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3209.6, ups=0.19, wpb=17090.8, bsz=1024, num_updates=6330, lr=4.45802e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40785
2024-11-09 22:04:56 - progress_bar.py[line:274] - INFO: epoch 017:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17303.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3250.7, ups=0.19, wpb=17303.4, bsz=1024, num_updates=6340, lr=4.45666e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40839
2024-11-09 22:05:49 - progress_bar.py[line:274] - INFO: epoch 017:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17188.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3227.8, ups=0.19, wpb=17188.1, bsz=1024, num_updates=6350, lr=4.4553e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=40892
2024-11-09 22:06:43 - progress_bar.py[line:274] - INFO: epoch 017:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.102, ntokens=16980.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3136.1, ups=0.18, wpb=16980.7, bsz=1024, num_updates=6360, lr=4.45394e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=40946
2024-11-09 22:07:36 - progress_bar.py[line:274] - INFO: epoch 017:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17366.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3254.5, ups=0.19, wpb=17366.2, bsz=1024, num_updates=6370, lr=4.45258e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=40999
2024-11-09 22:08:29 - progress_bar.py[line:274] - INFO: epoch 017:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17408.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3292.4, ups=0.19, wpb=17408.2, bsz=1024, num_updates=6380, lr=4.45122e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.1, wall=41052
2024-11-09 22:09:23 - progress_bar.py[line:274] - INFO: epoch 017:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.141, ntokens=17161.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3218.7, ups=0.19, wpb=17161.3, bsz=1024, num_updates=6390, lr=4.44986e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=41106
2024-11-09 22:10:16 - progress_bar.py[line:274] - INFO: epoch 017:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17140.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3183.9, ups=0.19, wpb=17140.2, bsz=1024, num_updates=6400, lr=4.4485e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=41159
2024-11-09 22:11:11 - progress_bar.py[line:274] - INFO: epoch 017:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17141.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3144.8, ups=0.18, wpb=17141.5, bsz=1024, num_updates=6410, lr=4.44714e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=41214
2024-11-09 22:12:05 - progress_bar.py[line:274] - INFO: epoch 017:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=16873.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3124.1, ups=0.19, wpb=16873.5, bsz=1024, num_updates=6420, lr=4.44577e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=41268
2024-11-09 22:12:59 - progress_bar.py[line:274] - INFO: epoch 017:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=17171.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3205, ups=0.19, wpb=17171.4, bsz=1024, num_updates=6430, lr=4.44441e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=41321
2024-11-09 22:13:52 - progress_bar.py[line:274] - INFO: epoch 017:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17222.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3235.5, ups=0.19, wpb=17222.6, bsz=1024, num_updates=6440, lr=4.44305e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=41375
2024-11-09 22:14:47 - progress_bar.py[line:274] - INFO: epoch 017:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.166, ntokens=17649, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3200.7, ups=0.18, wpb=17649, bsz=1024, num_updates=6450, lr=4.44169e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=41430
2024-11-09 22:15:41 - progress_bar.py[line:274] - INFO: epoch 017:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=16965.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.65, wps=3135, ups=0.18, wpb=16965.5, bsz=1024, num_updates=6460, lr=4.44033e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=41484
2024-11-09 22:16:34 - progress_bar.py[line:274] - INFO: epoch 017:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17093.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3237.4, ups=0.19, wpb=17093.7, bsz=1024, num_updates=6470, lr=4.43897e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=41537
2024-11-09 22:17:27 - progress_bar.py[line:274] - INFO: epoch 017:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=17342.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3234.1, ups=0.19, wpb=17342.7, bsz=1024, num_updates=6480, lr=4.43761e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=41590
2024-11-09 22:18:22 - progress_bar.py[line:274] - INFO: epoch 017:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17211.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3131.8, ups=0.18, wpb=17211.4, bsz=1024, num_updates=6490, lr=4.43625e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=35, gb_free=13.3, wall=41645
2024-11-09 22:19:17 - progress_bar.py[line:274] - INFO: epoch 017:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17093.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=3133.1, ups=0.18, wpb=17093.6, bsz=1024, num_updates=6500, lr=4.43489e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=44, gb_free=13.4, wall=41700
2024-11-09 22:20:11 - progress_bar.py[line:274] - INFO: epoch 017:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.091, ntokens=17128.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=3144.6, ups=0.18, wpb=17128.6, bsz=1024, num_updates=6510, lr=4.43353e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=38, gb_free=13.4, wall=41754
2024-11-09 22:21:05 - progress_bar.py[line:274] - INFO: epoch 017:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17277, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3216.5, ups=0.19, wpb=17277, bsz=1024, num_updates=6520, lr=4.43217e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=45, gb_free=13.5, wall=41808
2024-11-09 22:21:58 - progress_bar.py[line:274] - INFO: epoch 017:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=16971.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3219.5, ups=0.19, wpb=16971.2, bsz=1024, num_updates=6530, lr=4.43081e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=41, gb_free=13.2, wall=41861
2024-11-09 22:22:52 - progress_bar.py[line:274] - INFO: epoch 017:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17063.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3171.9, ups=0.19, wpb=17063.9, bsz=1024, num_updates=6540, lr=4.42945e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=34, gb_free=12.9, wall=41915
2024-11-09 22:23:46 - progress_bar.py[line:274] - INFO: epoch 017:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17155.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3182.2, ups=0.19, wpb=17155.3, bsz=1024, num_updates=6550, lr=4.42809e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=41968
2024-11-09 22:24:39 - progress_bar.py[line:274] - INFO: epoch 017:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.132, ntokens=17255.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3240.3, ups=0.19, wpb=17255.7, bsz=1024, num_updates=6560, lr=4.42673e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=42022
2024-11-09 22:25:33 - progress_bar.py[line:274] - INFO: epoch 017:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17101.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3182.8, ups=0.19, wpb=17101.6, bsz=1024, num_updates=6570, lr=4.42537e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=42075
2024-11-09 22:26:26 - progress_bar.py[line:274] - INFO: epoch 017:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.103, ntokens=17331.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3235, ups=0.19, wpb=17331.9, bsz=1024, num_updates=6580, lr=4.42401e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=42129
2024-11-09 22:27:20 - progress_bar.py[line:274] - INFO: epoch 017:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17254.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3229, ups=0.19, wpb=17254.1, bsz=1024, num_updates=6590, lr=4.42265e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=42182
2024-11-09 22:28:13 - progress_bar.py[line:274] - INFO: epoch 017:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.084, ntokens=17082.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3191.6, ups=0.19, wpb=17082.2, bsz=1024, num_updates=6600, lr=4.42129e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=12.7, wall=42236
2024-11-09 22:29:07 - progress_bar.py[line:274] - INFO: epoch 017:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=17287.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3232.6, ups=0.19, wpb=17287.9, bsz=1024, num_updates=6610, lr=4.41993e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=42289
2024-11-09 22:30:00 - progress_bar.py[line:274] - INFO: epoch 017:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17418, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3261.3, ups=0.19, wpb=17418, bsz=1024, num_updates=6620, lr=4.41857e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=42343
2024-11-09 22:30:52 - progress_bar.py[line:274] - INFO: epoch 017:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.091, ntokens=17006.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=3290.3, ups=0.19, wpb=17006.2, bsz=1024, num_updates=6630, lr=4.41721e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=42395
2024-11-09 22:31:44 - progress_bar.py[line:274] - INFO: epoch 017:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17152.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3277.5, ups=0.19, wpb=17152.5, bsz=1024, num_updates=6640, lr=4.41585e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=42447
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt2024-11-09 22:31:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6643 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt



cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-09 22:31:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 22:33:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 22:35:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6643 updates, score 0) (writing took 222.67788093403215 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-09 22:36:33 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-09 22:36:33 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.116 | ntokens 17148 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.67 | wps 2648.8 | ups 0.15 | wpb 17148 | bsz 1023 | num_updates 6643 | lr 4.41544e-05 | gnorm 0.007 | clip 0 | loss_scale 8192 | train_wall 1239 | gb_free 13.4 | wall 42736
2024-11-09 22:36:33 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 22:39:15 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-09 22:39:15 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 22:39:55 - progress_bar.py[line:274] - INFO: epoch 018:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=16592.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=338.2, ups=0.02, wpb=16592.2, bsz=985.6, num_updates=6650, lr=4.41449e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=29, gb_free=13.3, wall=42937
2024-11-09 22:40:48 - progress_bar.py[line:274] - INFO: epoch 018:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.096, ntokens=17113.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3227.6, ups=0.19, wpb=17113.2, bsz=1024, num_updates=6660, lr=4.41313e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=42990
2024-11-09 22:41:42 - progress_bar.py[line:274] - INFO: epoch 018:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.098, ntokens=17155.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3177.7, ups=0.19, wpb=17155.2, bsz=1024, num_updates=6670, lr=4.41176e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43044
2024-11-09 22:42:35 - progress_bar.py[line:274] - INFO: epoch 018:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=16970.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3154.5, ups=0.19, wpb=16970.7, bsz=1024, num_updates=6680, lr=4.4104e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=43098
2024-11-09 22:43:30 - progress_bar.py[line:274] - INFO: epoch 018:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17237.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3184.2, ups=0.18, wpb=17237.3, bsz=1024, num_updates=6690, lr=4.40904e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=43152
2024-11-09 22:44:24 - progress_bar.py[line:274] - INFO: epoch 018:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17237.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=3160.9, ups=0.18, wpb=17237.8, bsz=1024, num_updates=6700, lr=4.40768e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=43207
2024-11-09 22:45:19 - progress_bar.py[line:274] - INFO: epoch 018:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=16915.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3099.1, ups=0.18, wpb=16915.4, bsz=1024, num_updates=6710, lr=4.40632e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43262
2024-11-09 22:46:12 - progress_bar.py[line:274] - INFO: epoch 018:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17199.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3206.1, ups=0.19, wpb=17199.4, bsz=1024, num_updates=6720, lr=4.40496e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43315
2024-11-09 22:47:06 - progress_bar.py[line:274] - INFO: epoch 018:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17314, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3208.8, ups=0.19, wpb=17314, bsz=1024, num_updates=6730, lr=4.4036e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=43369
2024-11-09 22:48:01 - progress_bar.py[line:274] - INFO: epoch 018:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.109, ntokens=17138.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3153.3, ups=0.18, wpb=17138.5, bsz=1024, num_updates=6740, lr=4.40224e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=43423
2024-11-09 22:48:55 - progress_bar.py[line:274] - INFO: epoch 018:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=17224.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.65, wps=3184.9, ups=0.18, wpb=17224.7, bsz=1024, num_updates=6750, lr=4.40088e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43478
2024-11-09 22:49:49 - progress_bar.py[line:274] - INFO: epoch 018:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17086.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3166.8, ups=0.19, wpb=17086.3, bsz=1024, num_updates=6760, lr=4.39952e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=43532
2024-11-09 22:50:42 - progress_bar.py[line:274] - INFO: epoch 018:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.062, ntokens=17133.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3181.6, ups=0.19, wpb=17133.6, bsz=1024, num_updates=6770, lr=4.39816e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43585
2024-11-09 22:51:36 - progress_bar.py[line:274] - INFO: epoch 018:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=16980.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3155.9, ups=0.19, wpb=16980.3, bsz=1024, num_updates=6780, lr=4.3968e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43639
2024-11-09 22:52:30 - progress_bar.py[line:274] - INFO: epoch 018:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.103, ntokens=17370.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3227.8, ups=0.19, wpb=17370.7, bsz=1024, num_updates=6790, lr=4.39544e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=43693
2024-11-09 22:53:24 - progress_bar.py[line:274] - INFO: epoch 018:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17272.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3226.6, ups=0.19, wpb=17272.9, bsz=1024, num_updates=6800, lr=4.39408e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=43747
2024-11-09 22:54:17 - progress_bar.py[line:274] - INFO: epoch 018:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17227.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3232.3, ups=0.19, wpb=17227.3, bsz=1024, num_updates=6810, lr=4.39272e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=43800
2024-11-09 22:55:11 - progress_bar.py[line:274] - INFO: epoch 018:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17184.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3193.6, ups=0.19, wpb=17184.8, bsz=1024, num_updates=6820, lr=4.39136e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=43854
2024-11-09 22:56:04 - progress_bar.py[line:274] - INFO: epoch 018:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=16989.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3172.5, ups=0.19, wpb=16989.1, bsz=1024, num_updates=6830, lr=4.39e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=43907
2024-11-09 22:56:58 - progress_bar.py[line:274] - INFO: epoch 018:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17157.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3209.8, ups=0.19, wpb=17157.3, bsz=1024, num_updates=6840, lr=4.38864e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=43961
2024-11-09 22:57:51 - progress_bar.py[line:274] - INFO: epoch 018:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17180.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3204.6, ups=0.19, wpb=17180.8, bsz=1024, num_updates=6850, lr=4.38728e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=44014
2024-11-09 22:58:45 - progress_bar.py[line:274] - INFO: epoch 018:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17027.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3163.7, ups=0.19, wpb=17027.8, bsz=1024, num_updates=6860, lr=4.38592e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=44068
2024-11-09 22:59:39 - progress_bar.py[line:274] - INFO: epoch 018:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17299, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3217.2, ups=0.19, wpb=17299, bsz=1024, num_updates=6870, lr=4.38456e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=44122
2024-11-09 23:00:32 - progress_bar.py[line:274] - INFO: epoch 018:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=16880.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3182.7, ups=0.19, wpb=16880.7, bsz=1024, num_updates=6880, lr=4.3832e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=44175
2024-11-09 23:01:25 - progress_bar.py[line:274] - INFO: epoch 018:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.079, ntokens=17090, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=3207.1, ups=0.19, wpb=17090, bsz=1024, num_updates=6890, lr=4.38184e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=44228
2024-11-09 23:02:19 - progress_bar.py[line:274] - INFO: epoch 018:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17114.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3204.8, ups=0.19, wpb=17114.1, bsz=1024, num_updates=6900, lr=4.38048e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=12.5, wall=44282
2024-11-09 23:03:13 - progress_bar.py[line:274] - INFO: epoch 018:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.096, ntokens=17269.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3204.9, ups=0.19, wpb=17269.1, bsz=1024, num_updates=6910, lr=4.37912e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=44335
2024-11-09 23:04:06 - progress_bar.py[line:274] - INFO: epoch 018:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17052.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3212.5, ups=0.19, wpb=17052.7, bsz=1024, num_updates=6920, lr=4.37775e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=44389
2024-11-09 23:04:59 - progress_bar.py[line:274] - INFO: epoch 018:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17073.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3185.2, ups=0.19, wpb=17073.9, bsz=1024, num_updates=6930, lr=4.37639e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=44442
2024-11-09 23:05:53 - progress_bar.py[line:274] - INFO: epoch 018:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17253.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3229.3, ups=0.19, wpb=17253.5, bsz=1024, num_updates=6940, lr=4.37503e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=44496
2024-11-09 23:06:46 - progress_bar.py[line:274] - INFO: epoch 018:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17220.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3205.1, ups=0.19, wpb=17220.4, bsz=1024, num_updates=6950, lr=4.37367e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=44549
2024-11-09 23:07:39 - progress_bar.py[line:274] - INFO: epoch 018:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=16886.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3184.4, ups=0.19, wpb=16886.1, bsz=1024, num_updates=6960, lr=4.37231e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=44602
2024-11-09 23:08:33 - progress_bar.py[line:274] - INFO: epoch 018:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=16911.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3160.1, ups=0.19, wpb=16911.8, bsz=1024, num_updates=6970, lr=4.37095e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=44656
2024-11-09 23:09:26 - progress_bar.py[line:274] - INFO: epoch 018:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17253.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3252.3, ups=0.19, wpb=17253.9, bsz=1024, num_updates=6980, lr=4.36959e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=44709
2024-11-09 23:10:21 - progress_bar.py[line:274] - INFO: epoch 018:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17264, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3122.7, ups=0.18, wpb=17264, bsz=1024, num_updates=6990, lr=4.36823e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=44764
2024-11-09 23:11:15 - progress_bar.py[line:274] - INFO: epoch 018:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.093, ntokens=17380.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3244.2, ups=0.19, wpb=17380.8, bsz=1024, num_updates=7000, lr=4.36687e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=44818
2024-11-09 23:12:09 - progress_bar.py[line:274] - INFO: epoch 018:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.134, ntokens=17625.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3270.3, ups=0.19, wpb=17625.6, bsz=1024, num_updates=7010, lr=4.36551e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=44872
2024-11-09 23:13:01 - progress_bar.py[line:274] - INFO: epoch 018:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17524, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3333.2, ups=0.19, wpb=17524, bsz=1024, num_updates=7020, lr=4.36415e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=44924
2024-11-09 23:13:54 - progress_bar.py[line:274] - INFO: epoch 018:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=17159.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3282.4, ups=0.19, wpb=17159.1, bsz=1024, num_updates=7030, lr=4.36279e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=44977
2024-11-09 23:14:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 7034 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
2024-11-09 23:14:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 23:16:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-09 23:17:53 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 18 @ 7034 updates, score 0) (writing took 222.4471898630145 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-09 23:18:48 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-09 23:18:48 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.089 | ntokens 17150.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.51 | wps 2645.8 | ups 0.15 | wpb 17150.1 | bsz 1023 | num_updates 7034 | lr 4.36225e-05 | gnorm 0.007 | clip 0 | loss_scale 16384 | train_wall 1207 | gb_free 13.2 | wall 45271
2024-11-09 23:18:48 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-09 23:21:29 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-09 23:21:29 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 23:22:03 - progress_bar.py[line:274] - INFO: epoch 019:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=16362.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=334.4, ups=0.02, wpb=16362.6, bsz=985.6, num_updates=7040, lr=4.36143e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=45466
2024-11-09 23:22:56 - progress_bar.py[line:274] - INFO: epoch 019:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.083, ntokens=17292.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3251.3, ups=0.19, wpb=17292.1, bsz=1024, num_updates=7050, lr=4.36007e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=45519
2024-11-09 23:23:50 - progress_bar.py[line:274] - INFO: epoch 019:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.086, ntokens=17231.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=3205.7, ups=0.19, wpb=17231.3, bsz=1024, num_updates=7060, lr=4.35871e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=45573
2024-11-09 23:24:43 - progress_bar.py[line:274] - INFO: epoch 019:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=16982.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3177, ups=0.19, wpb=16982.7, bsz=1024, num_updates=7070, lr=4.35735e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=45626
2024-11-09 23:25:36 - progress_bar.py[line:274] - INFO: epoch 019:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17194.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3232, ups=0.19, wpb=17194.5, bsz=1024, num_updates=7080, lr=4.35599e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=45679
2024-11-09 23:26:29 - progress_bar.py[line:274] - INFO: epoch 019:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17266.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3257.4, ups=0.19, wpb=17266.9, bsz=1024, num_updates=7090, lr=4.35463e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=45732
2024-11-09 23:27:23 - progress_bar.py[line:274] - INFO: epoch 019:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=17016.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3190.1, ups=0.19, wpb=17016.3, bsz=1024, num_updates=7100, lr=4.35327e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=45786
2024-11-09 23:28:16 - progress_bar.py[line:274] - INFO: epoch 019:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.08, ntokens=17214.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3247.4, ups=0.19, wpb=17214.2, bsz=1024, num_updates=7110, lr=4.35191e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=45839
2024-11-09 23:29:09 - progress_bar.py[line:274] - INFO: epoch 019:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17469.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3272.2, ups=0.19, wpb=17469.9, bsz=1024, num_updates=7120, lr=4.35055e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=45892
2024-11-09 23:30:02 - progress_bar.py[line:274] - INFO: epoch 019:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=16984.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3193, ups=0.19, wpb=16984.8, bsz=1024, num_updates=7130, lr=4.34919e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=45945
2024-11-09 23:30:56 - progress_bar.py[line:274] - INFO: epoch 019:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17385.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3254.4, ups=0.19, wpb=17385.8, bsz=1024, num_updates=7140, lr=4.34783e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=45999
2024-11-09 23:31:50 - progress_bar.py[line:274] - INFO: epoch 019:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17040.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3159.4, ups=0.19, wpb=17040.6, bsz=1024, num_updates=7150, lr=4.34647e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=46053
2024-11-09 23:32:44 - progress_bar.py[line:274] - INFO: epoch 019:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.085, ntokens=17473.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=3249.4, ups=0.19, wpb=17473.3, bsz=1024, num_updates=7160, lr=4.34511e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=12.9, wall=46106
2024-11-09 23:33:37 - progress_bar.py[line:274] - INFO: epoch 019:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17135.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=3194.2, ups=0.19, wpb=17135.6, bsz=1024, num_updates=7170, lr=4.34374e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=46160
2024-11-09 23:34:31 - progress_bar.py[line:274] - INFO: epoch 019:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17129.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3175.8, ups=0.19, wpb=17129.3, bsz=1024, num_updates=7180, lr=4.34238e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=46214
2024-11-09 23:35:25 - progress_bar.py[line:274] - INFO: epoch 019:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.084, ntokens=17291.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3230, ups=0.19, wpb=17291.6, bsz=1024, num_updates=7190, lr=4.34102e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46268
2024-11-09 23:36:18 - progress_bar.py[line:274] - INFO: epoch 019:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17173.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3208.6, ups=0.19, wpb=17173.5, bsz=1024, num_updates=7200, lr=4.33966e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=46321
2024-11-09 23:37:12 - progress_bar.py[line:274] - INFO: epoch 019:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17009.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3158.6, ups=0.19, wpb=17009.2, bsz=1024, num_updates=7210, lr=4.3383e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46375
2024-11-09 23:38:05 - progress_bar.py[line:274] - INFO: epoch 019:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17017.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3192.9, ups=0.19, wpb=17017.6, bsz=1024, num_updates=7220, lr=4.33694e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46428
2024-11-09 23:38:59 - progress_bar.py[line:274] - INFO: epoch 019:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.084, ntokens=17429.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3267.3, ups=0.19, wpb=17429.8, bsz=1024, num_updates=7230, lr=4.33558e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=46482
2024-11-09 23:39:52 - progress_bar.py[line:274] - INFO: epoch 019:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17380.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3267.6, ups=0.19, wpb=17380.2, bsz=1024, num_updates=7240, lr=4.33422e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=46535
2024-11-09 23:40:46 - progress_bar.py[line:274] - INFO: epoch 019:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17180, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3161.8, ups=0.18, wpb=17180, bsz=1024, num_updates=7250, lr=4.33286e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=46589
2024-11-09 23:41:40 - progress_bar.py[line:274] - INFO: epoch 019:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=16930.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3172.4, ups=0.19, wpb=16930.6, bsz=1024, num_updates=7260, lr=4.3315e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=46642
2024-11-09 23:42:33 - progress_bar.py[line:274] - INFO: epoch 019:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17471.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3252.6, ups=0.19, wpb=17471.3, bsz=1024, num_updates=7270, lr=4.33014e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=46696
2024-11-09 23:43:26 - progress_bar.py[line:274] - INFO: epoch 019:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17208.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3255.2, ups=0.19, wpb=17208.2, bsz=1024, num_updates=7280, lr=4.32878e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=46749
2024-11-09 23:44:20 - progress_bar.py[line:274] - INFO: epoch 019:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17095.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3168.7, ups=0.19, wpb=17095.1, bsz=1024, num_updates=7290, lr=4.32742e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=46803
2024-11-09 23:45:14 - progress_bar.py[line:274] - INFO: epoch 019:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17279.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3215.2, ups=0.19, wpb=17279.5, bsz=1024, num_updates=7300, lr=4.32606e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=46857
2024-11-09 23:46:07 - progress_bar.py[line:274] - INFO: epoch 019:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.078, ntokens=17184.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3221.2, ups=0.19, wpb=17184.8, bsz=1024, num_updates=7310, lr=4.3247e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46910
2024-11-09 23:47:00 - progress_bar.py[line:274] - INFO: epoch 019:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.009, ntokens=17028.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3198.2, ups=0.19, wpb=17028.8, bsz=1024, num_updates=7320, lr=4.32334e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=46963
2024-11-09 23:47:54 - progress_bar.py[line:274] - INFO: epoch 019:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.093, ntokens=17298, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3247.6, ups=0.19, wpb=17298, bsz=1024, num_updates=7330, lr=4.32198e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=47017
2024-11-09 23:48:47 - progress_bar.py[line:274] - INFO: epoch 019:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17209.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3214.2, ups=0.19, wpb=17209.8, bsz=1024, num_updates=7340, lr=4.32062e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47070
2024-11-09 23:49:41 - progress_bar.py[line:274] - INFO: epoch 019:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17146.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3172.5, ups=0.19, wpb=17146.2, bsz=1024, num_updates=7350, lr=4.31926e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47124
2024-11-09 23:50:34 - progress_bar.py[line:274] - INFO: epoch 019:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=16983.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3196.3, ups=0.19, wpb=16983.9, bsz=1024, num_updates=7360, lr=4.3179e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=47177
2024-11-09 23:51:27 - progress_bar.py[line:274] - INFO: epoch 019:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17236.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3248.2, ups=0.19, wpb=17236.5, bsz=1024, num_updates=7370, lr=4.31654e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47230
2024-11-09 23:52:21 - progress_bar.py[line:274] - INFO: epoch 019:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=16965, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3183.5, ups=0.19, wpb=16965, bsz=1024, num_updates=7380, lr=4.31518e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=47284
2024-11-09 23:53:14 - progress_bar.py[line:274] - INFO: epoch 019:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17358.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3251.3, ups=0.19, wpb=17358.4, bsz=1024, num_updates=7390, lr=4.31382e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=47337
2024-11-09 23:54:08 - progress_bar.py[line:274] - INFO: epoch 019:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17264.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3230, ups=0.19, wpb=17264.8, bsz=1024, num_updates=7400, lr=4.31246e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47391
2024-11-09 23:54:59 - progress_bar.py[line:274] - INFO: epoch 019:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.084, ntokens=17400.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3367.3, ups=0.19, wpb=17400.4, bsz=1024, num_updates=7410, lr=4.3111e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=47442
2024-11-09 23:55:51 - progress_bar.py[line:274] - INFO: epoch 019:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.08, ntokens=17130.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=3288.7, ups=0.19, wpb=17130.4, bsz=1024, num_updates=7420, lr=4.30973e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=47494
2024-11-09 23:56:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 7425 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-09 23:56:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 23:58:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-09 23:59:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 19 @ 7425 updates, score 0) (writing took 222.5176292739925 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
2024-11-10 00:00:51 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-10 00:00:51 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.068 | ntokens 17174.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.39 | wps 2661.4 | ups 0.15 | wpb 17174.9 | bsz 1023 | num_updates 7425 | lr 4.30905e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.3 | wall 47794
2024-11-10 00:00:51 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 00:03:32 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-10 00:03:32 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 00:04:01 - progress_bar.py[line:274] - INFO: epoch 020:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=16498, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=336.8, ups=0.02, wpb=16498, bsz=985.6, num_updates=7430, lr=4.30837e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=47984
2024-11-10 00:04:55 - progress_bar.py[line:274] - INFO: epoch 020:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17379, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3260.6, ups=0.19, wpb=17379, bsz=1024, num_updates=7440, lr=4.30701e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=48037
2024-11-10 00:05:48 - progress_bar.py[line:274] - INFO: epoch 020:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3192.5, ups=0.19, wpb=17200.2, bsz=1024, num_updates=7450, lr=4.30565e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=48091
2024-11-10 00:06:42 - progress_bar.py[line:274] - INFO: epoch 020:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=16813.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3134, ups=0.19, wpb=16813.1, bsz=1024, num_updates=7460, lr=4.30429e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=48145
2024-11-10 00:07:35 - progress_bar.py[line:274] - INFO: epoch 020:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17272, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3267, ups=0.19, wpb=17272, bsz=1024, num_updates=7470, lr=4.30293e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=48198
2024-11-10 00:08:28 - progress_bar.py[line:274] - INFO: epoch 020:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17088.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3218.7, ups=0.19, wpb=17088.8, bsz=1024, num_updates=7480, lr=4.30157e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=48251
2024-11-10 00:09:22 - progress_bar.py[line:274] - INFO: epoch 020:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=17097.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3195.7, ups=0.19, wpb=17097.2, bsz=1024, num_updates=7490, lr=4.30021e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=48304
2024-11-10 00:10:15 - progress_bar.py[line:274] - INFO: epoch 020:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.062, ntokens=17251, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3218.6, ups=0.19, wpb=17251, bsz=1024, num_updates=7500, lr=4.29885e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=48358
2024-11-10 00:11:09 - progress_bar.py[line:274] - INFO: epoch 020:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17226.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3225.1, ups=0.19, wpb=17226.4, bsz=1024, num_updates=7510, lr=4.29749e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=48411
2024-11-10 00:12:02 - progress_bar.py[line:274] - INFO: epoch 020:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17111.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3208.1, ups=0.19, wpb=17111.5, bsz=1024, num_updates=7520, lr=4.29613e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=48465
2024-11-10 00:12:55 - progress_bar.py[line:274] - INFO: epoch 020:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17260.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3243.7, ups=0.19, wpb=17260.4, bsz=1024, num_updates=7530, lr=4.29477e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=48518
2024-11-10 00:13:49 - progress_bar.py[line:274] - INFO: epoch 020:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=16984.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3136.1, ups=0.18, wpb=16984.3, bsz=1024, num_updates=7540, lr=4.29341e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=48572
2024-11-10 00:14:43 - progress_bar.py[line:274] - INFO: epoch 020:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17489, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3227.9, ups=0.18, wpb=17489, bsz=1024, num_updates=7550, lr=4.29205e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=48626
2024-11-10 00:15:37 - progress_bar.py[line:274] - INFO: epoch 020:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=16978.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3178.3, ups=0.19, wpb=16978.3, bsz=1024, num_updates=7560, lr=4.29069e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=48680
2024-11-10 00:16:30 - progress_bar.py[line:274] - INFO: epoch 020:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=16898.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3152.3, ups=0.19, wpb=16898.1, bsz=1024, num_updates=7570, lr=4.28933e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=48733
2024-11-10 00:17:24 - progress_bar.py[line:274] - INFO: epoch 020:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17403.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3244.4, ups=0.19, wpb=17403.8, bsz=1024, num_updates=7580, lr=4.28797e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=48787
2024-11-10 00:18:17 - progress_bar.py[line:274] - INFO: epoch 020:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17199.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3236.9, ups=0.19, wpb=17199.4, bsz=1024, num_updates=7590, lr=4.28661e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=48840
2024-11-10 00:19:11 - progress_bar.py[line:274] - INFO: epoch 020:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=16989.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3186, ups=0.19, wpb=16989.3, bsz=1024, num_updates=7600, lr=4.28525e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=48893
2024-11-10 00:20:04 - progress_bar.py[line:274] - INFO: epoch 020:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17107.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3199.6, ups=0.19, wpb=17107.6, bsz=1024, num_updates=7610, lr=4.28389e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=12.8, wall=48947
2024-11-10 00:20:57 - progress_bar.py[line:274] - INFO: epoch 020:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.998, ntokens=16949.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3176.7, ups=0.19, wpb=16949.9, bsz=1024, num_updates=7620, lr=4.28253e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=49000
2024-11-10 00:21:51 - progress_bar.py[line:274] - INFO: epoch 020:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17209.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3194.4, ups=0.19, wpb=17209.8, bsz=1024, num_updates=7630, lr=4.28117e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=49054
2024-11-10 00:22:45 - progress_bar.py[line:274] - INFO: epoch 020:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=16933, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3122.8, ups=0.18, wpb=16933, bsz=1024, num_updates=7640, lr=4.27981e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=49108
2024-11-10 00:23:42 - progress_bar.py[line:274] - INFO: epoch 020:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.046, ntokens=17201.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3067.8, ups=0.18, wpb=17201.4, bsz=1024, num_updates=7650, lr=4.27845e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=49164
2024-11-10 00:24:38 - progress_bar.py[line:274] - INFO: epoch 020:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=17170, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3048.6, ups=0.18, wpb=17170, bsz=1024, num_updates=7660, lr=4.27709e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=49221
2024-11-10 00:25:34 - progress_bar.py[line:274] - INFO: epoch 020:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17154.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3082.9, ups=0.18, wpb=17154.9, bsz=1024, num_updates=7670, lr=4.27573e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=49276
2024-11-10 00:26:30 - progress_bar.py[line:274] - INFO: epoch 020:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17220.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3066.1, ups=0.18, wpb=17220.7, bsz=1024, num_updates=7680, lr=4.27436e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=49333
2024-11-10 00:27:24 - progress_bar.py[line:274] - INFO: epoch 020:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.046, ntokens=17102.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3136.7, ups=0.18, wpb=17102.9, bsz=1024, num_updates=7690, lr=4.273e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=49387
2024-11-10 00:28:16 - progress_bar.py[line:274] - INFO: epoch 020:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=16865.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3278.6, ups=0.19, wpb=16865.7, bsz=1024, num_updates=7700, lr=4.27164e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=49439
2024-11-10 00:29:07 - progress_bar.py[line:274] - INFO: epoch 020:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17328.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3353.5, ups=0.19, wpb=17328.3, bsz=1024, num_updates=7710, lr=4.27028e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=34, gb_free=13, wall=49490
2024-11-10 00:30:01 - progress_bar.py[line:274] - INFO: epoch 020:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.046, ntokens=17155.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3211.2, ups=0.19, wpb=17155.7, bsz=1024, num_updates=7720, lr=4.26892e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=49544
2024-11-10 00:30:55 - progress_bar.py[line:274] - INFO: epoch 020:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.01, ntokens=17132.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3180.8, ups=0.19, wpb=17132.6, bsz=1024, num_updates=7730, lr=4.26756e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=49598
2024-11-10 00:31:48 - progress_bar.py[line:274] - INFO: epoch 020:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=16942.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3157.2, ups=0.19, wpb=16942.6, bsz=1024, num_updates=7740, lr=4.2662e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=49651
2024-11-10 00:32:42 - progress_bar.py[line:274] - INFO: epoch 020:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=17231.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3197.2, ups=0.19, wpb=17231.7, bsz=1024, num_updates=7750, lr=4.26484e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=49705
2024-11-10 00:33:35 - progress_bar.py[line:274] - INFO: epoch 020:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3311.2, ups=0.19, wpb=17448.2, bsz=1024, num_updates=7760, lr=4.26348e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=49758
2024-11-10 00:34:28 - progress_bar.py[line:274] - INFO: epoch 020:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17178.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3221.7, ups=0.19, wpb=17178.9, bsz=1024, num_updates=7770, lr=4.26212e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=49811
2024-11-10 00:35:22 - progress_bar.py[line:274] - INFO: epoch 020:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17176.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3209.4, ups=0.19, wpb=17176.4, bsz=1024, num_updates=7780, lr=4.26076e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=49865
2024-11-10 00:36:15 - progress_bar.py[line:274] - INFO: epoch 020:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17229.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3226.5, ups=0.19, wpb=17229.8, bsz=1024, num_updates=7790, lr=4.2594e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=49918
2024-11-10 00:37:07 - progress_bar.py[line:274] - INFO: epoch 020:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17275.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3306.3, ups=0.19, wpb=17275.4, bsz=1024, num_updates=7800, lr=4.25804e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=49970
2024-11-10 00:37:59 - progress_bar.py[line:274] - INFO: epoch 020:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17217.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3339.6, ups=0.19, wpb=17217.8, bsz=1024, num_updates=7810, lr=4.25668e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=50022
2024-11-10 00:38:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 7816 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
2024-11-10 00:38:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 00:40:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
2024-11-10 00:42:05 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 20 @ 7816 updates, score 0) (writing took 218.50188076897757 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
2024-11-10 00:43:00 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-10 00:43:00 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.041 | ntokens 17139.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.23 | wps 2650.3 | ups 0.15 | wpb 17139.4 | bsz 1023 | num_updates 7816 | lr 4.25586e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1326 | gb_free 13.2 | wall 50323
2024-11-10 00:43:00 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 00:45:41 - trainer.py[line:703] - INFO: begin training epoch 21
2024-11-10 00:45:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 00:46:04 - progress_bar.py[line:274] - INFO: epoch 021:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=16366.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=337.1, ups=0.02, wpb=16366.2, bsz=985.6, num_updates=7820, lr=4.25532e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=50507
2024-11-10 00:46:58 - progress_bar.py[line:274] - INFO: epoch 021:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17128.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3174, ups=0.19, wpb=17128.8, bsz=1024, num_updates=7830, lr=4.25396e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=12.7, wall=50561
2024-11-10 00:47:51 - progress_bar.py[line:274] - INFO: epoch 021:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17578.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3322.7, ups=0.19, wpb=17578.6, bsz=1024, num_updates=7840, lr=4.2526e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=50614
2024-11-10 00:48:45 - progress_bar.py[line:274] - INFO: epoch 021:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17224.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3202.4, ups=0.19, wpb=17224.7, bsz=1024, num_updates=7850, lr=4.25124e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=50668
2024-11-10 00:49:39 - progress_bar.py[line:274] - INFO: epoch 021:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17211.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3216.2, ups=0.19, wpb=17211.7, bsz=1024, num_updates=7860, lr=4.24988e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=50722
2024-11-10 00:50:32 - progress_bar.py[line:274] - INFO: epoch 021:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17011.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3205.7, ups=0.19, wpb=17011.3, bsz=1024, num_updates=7870, lr=4.24852e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=50775
2024-11-10 00:51:25 - progress_bar.py[line:274] - INFO: epoch 021:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=17136.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3216.5, ups=0.19, wpb=17136.1, bsz=1024, num_updates=7880, lr=4.24716e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=50828
2024-11-10 00:52:18 - progress_bar.py[line:274] - INFO: epoch 021:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17136.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3215.3, ups=0.19, wpb=17136.5, bsz=1024, num_updates=7890, lr=4.2458e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=50881
2024-11-10 00:53:01 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 00:53:17 - progress_bar.py[line:274] - INFO: epoch 021:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17373.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=2944.1, ups=0.17, wpb=17373.8, bsz=1024, num_updates=7900, lr=4.24444e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=50940
2024-11-10 00:54:11 - progress_bar.py[line:274] - INFO: epoch 021:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.058, ntokens=17224.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3232.3, ups=0.19, wpb=17224.9, bsz=1024, num_updates=7910, lr=4.24308e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=50993
2024-11-10 00:55:04 - progress_bar.py[line:274] - INFO: epoch 021:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17366.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3255.1, ups=0.19, wpb=17366.2, bsz=1024, num_updates=7920, lr=4.24172e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=51047
2024-11-10 00:55:57 - progress_bar.py[line:274] - INFO: epoch 021:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17167.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3229.4, ups=0.19, wpb=17167.6, bsz=1024, num_updates=7930, lr=4.24035e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=51100
2024-11-10 00:56:51 - progress_bar.py[line:274] - INFO: epoch 021:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3194.7, ups=0.18, wpb=17277.5, bsz=1024, num_updates=7940, lr=4.23899e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=51154
2024-11-10 00:57:45 - progress_bar.py[line:274] - INFO: epoch 021:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17043.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3144.9, ups=0.18, wpb=17043.4, bsz=1024, num_updates=7950, lr=4.23763e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=51208
2024-11-10 00:58:39 - progress_bar.py[line:274] - INFO: epoch 021:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=16780.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3142, ups=0.19, wpb=16780.3, bsz=1024, num_updates=7960, lr=4.23627e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=12.7, wall=51262
2024-11-10 00:59:33 - progress_bar.py[line:274] - INFO: epoch 021:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17214.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3199.5, ups=0.19, wpb=17214.9, bsz=1024, num_updates=7970, lr=4.23491e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=51315
2024-11-10 01:00:28 - progress_bar.py[line:274] - INFO: epoch 021:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.046, ntokens=17358.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3154.4, ups=0.18, wpb=17358.9, bsz=1024, num_updates=7980, lr=4.23355e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=39, gb_free=13.4, wall=51370
2024-11-10 01:01:22 - progress_bar.py[line:274] - INFO: epoch 021:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17205.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3146, ups=0.18, wpb=17205.9, bsz=1024, num_updates=7990, lr=4.23219e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=51425
2024-11-10 01:02:17 - progress_bar.py[line:274] - INFO: epoch 021:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17013.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3100.5, ups=0.18, wpb=17013.7, bsz=1024, num_updates=8000, lr=4.23083e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13, wall=51480
2024-11-10 01:03:12 - progress_bar.py[line:274] - INFO: epoch 021:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17039.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3092.3, ups=0.18, wpb=17039.6, bsz=1024, num_updates=8010, lr=4.22947e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=51535
2024-11-10 01:04:04 - progress_bar.py[line:274] - INFO: epoch 021:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17242.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3313.5, ups=0.19, wpb=17242.4, bsz=1024, num_updates=8020, lr=4.22811e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=51587
2024-11-10 01:04:56 - progress_bar.py[line:274] - INFO: epoch 021:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=16859.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3242.8, ups=0.19, wpb=16859.3, bsz=1024, num_updates=8030, lr=4.22675e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=41, gb_free=13.2, wall=51639
2024-11-10 01:05:50 - progress_bar.py[line:274] - INFO: epoch 021:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17325.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3229.6, ups=0.19, wpb=17325.4, bsz=1024, num_updates=8040, lr=4.22539e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=51693
2024-11-10 01:06:44 - progress_bar.py[line:274] - INFO: epoch 021:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=17251.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3163.7, ups=0.18, wpb=17251.5, bsz=1024, num_updates=8050, lr=4.22403e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=36, gb_free=13.1, wall=51747
2024-11-10 01:07:37 - progress_bar.py[line:274] - INFO: epoch 021:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.047, ntokens=17354.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3272.7, ups=0.19, wpb=17354.2, bsz=1024, num_updates=8060, lr=4.22267e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=41, gb_free=13.2, wall=51800
2024-11-10 01:08:31 - progress_bar.py[line:274] - INFO: epoch 021:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=17236.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3216.9, ups=0.19, wpb=17236.2, bsz=1024, num_updates=8070, lr=4.22131e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=44, gb_free=13.2, wall=51854
2024-11-10 01:09:25 - progress_bar.py[line:274] - INFO: epoch 021:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.048, ntokens=17384.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3212.6, ups=0.18, wpb=17384.8, bsz=1024, num_updates=8080, lr=4.21995e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=51908
2024-11-10 01:10:19 - progress_bar.py[line:274] - INFO: epoch 021:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.037, ntokens=17124.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3159.5, ups=0.18, wpb=17124.8, bsz=1024, num_updates=8090, lr=4.21859e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=51962
2024-11-10 01:11:12 - progress_bar.py[line:274] - INFO: epoch 021:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=17172.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3289.1, ups=0.19, wpb=17172.8, bsz=1024, num_updates=8100, lr=4.21723e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13, wall=52014
2024-11-10 01:12:04 - progress_bar.py[line:274] - INFO: epoch 021:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17346.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3311.9, ups=0.19, wpb=17346.7, bsz=1024, num_updates=8110, lr=4.21587e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=52067
2024-11-10 01:12:58 - progress_bar.py[line:274] - INFO: epoch 021:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17327.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3208.9, ups=0.19, wpb=17327.7, bsz=1024, num_updates=8120, lr=4.21451e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=52121
2024-11-10 01:13:52 - progress_bar.py[line:274] - INFO: epoch 021:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17006.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3164.3, ups=0.19, wpb=17006.9, bsz=1024, num_updates=8130, lr=4.21315e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=52175
2024-11-10 01:14:45 - progress_bar.py[line:274] - INFO: epoch 021:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=16960.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3159.4, ups=0.19, wpb=16960.8, bsz=1024, num_updates=8140, lr=4.21179e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=52228
2024-11-10 01:15:39 - progress_bar.py[line:274] - INFO: epoch 021:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17085.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3210.1, ups=0.19, wpb=17085.1, bsz=1024, num_updates=8150, lr=4.21043e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=52282
2024-11-10 01:16:32 - progress_bar.py[line:274] - INFO: epoch 021:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=16899.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3180.4, ups=0.19, wpb=16899.9, bsz=1024, num_updates=8160, lr=4.20907e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=52335
2024-11-10 01:17:25 - progress_bar.py[line:274] - INFO: epoch 021:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17381.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3261, ups=0.19, wpb=17381.4, bsz=1024, num_updates=8170, lr=4.20771e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=52388
2024-11-10 01:18:18 - progress_bar.py[line:274] - INFO: epoch 021:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17389.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3254.4, ups=0.19, wpb=17389.8, bsz=1024, num_updates=8180, lr=4.20634e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=52441
2024-11-10 01:19:11 - progress_bar.py[line:274] - INFO: epoch 021:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17529.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3366.9, ups=0.19, wpb=17529.6, bsz=1024, num_updates=8190, lr=4.20498e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=52493
2024-11-10 01:20:03 - progress_bar.py[line:274] - INFO: epoch 021:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17242.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3268.1, ups=0.19, wpb=17242.6, bsz=1024, num_updates=8200, lr=4.20362e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=52546
2024-11-10 01:20:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 21 @ 8206 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
2024-11-10 01:20:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 01:22:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
2024-11-10 01:24:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 21 @ 8206 updates, score 0) (writing took 222.40102894499432 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-10 01:25:08 - train.py[line:336] - INFO: end of epoch 21 (average epoch stats below)
2024-11-10 01:25:08 - progress_bar.py[line:282] - INFO: epoch 021 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.03 | ntokens 17178.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.17 | wps 2650.1 | ups 0.15 | wpb 17178.3 | bsz 1023 | num_updates 8206 | lr 4.20281e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1390 | gb_free 13.1 | wall 52851
2024-11-10 01:25:08 - trainer.py[line:639] - INFO: loading train data for epoch 22
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 01:27:49 - trainer.py[line:703] - INFO: begin training epoch 22
2024-11-10 01:27:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 01:28:13 - progress_bar.py[line:274] - INFO: epoch 022:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=16462, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=336.4, ups=0.02, wpb=16462, bsz=985.6, num_updates=8210, lr=4.20226e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=53036
2024-11-10 01:29:06 - progress_bar.py[line:274] - INFO: epoch 022:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=17079.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3198.3, ups=0.19, wpb=17079.2, bsz=1024, num_updates=8220, lr=4.2009e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=53089
2024-11-10 01:30:00 - progress_bar.py[line:274] - INFO: epoch 022:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17362.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3238.5, ups=0.19, wpb=17362.7, bsz=1024, num_updates=8230, lr=4.19954e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=53143
2024-11-10 01:30:53 - progress_bar.py[line:274] - INFO: epoch 022:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17252.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3231.6, ups=0.19, wpb=17252.4, bsz=1024, num_updates=8240, lr=4.19818e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53196
2024-11-10 01:31:46 - progress_bar.py[line:274] - INFO: epoch 022:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=16942.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3169.4, ups=0.19, wpb=16942.1, bsz=1024, num_updates=8250, lr=4.19682e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=53249
2024-11-10 01:32:40 - progress_bar.py[line:274] - INFO: epoch 022:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17274.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3212.3, ups=0.19, wpb=17274.7, bsz=1024, num_updates=8260, lr=4.19546e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=53303
2024-11-10 01:33:34 - progress_bar.py[line:274] - INFO: epoch 022:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=16762.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3110.6, ups=0.19, wpb=16762.3, bsz=1024, num_updates=8270, lr=4.1941e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53357
2024-11-10 01:34:28 - progress_bar.py[line:274] - INFO: epoch 022:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17332.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3241.3, ups=0.19, wpb=17332.7, bsz=1024, num_updates=8280, lr=4.19274e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=53411
2024-11-10 01:35:21 - progress_bar.py[line:274] - INFO: epoch 022:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17209.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3210.3, ups=0.19, wpb=17209.5, bsz=1024, num_updates=8290, lr=4.19138e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53464
2024-11-10 01:36:15 - progress_bar.py[line:274] - INFO: epoch 022:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17298.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3226.3, ups=0.19, wpb=17298.3, bsz=1024, num_updates=8300, lr=4.19002e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53518
2024-11-10 01:37:09 - progress_bar.py[line:274] - INFO: epoch 022:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=17317.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3207.8, ups=0.19, wpb=17317.5, bsz=1024, num_updates=8310, lr=4.18866e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53572
2024-11-10 01:38:03 - progress_bar.py[line:274] - INFO: epoch 022:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=16851.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3125, ups=0.19, wpb=16851.9, bsz=1024, num_updates=8320, lr=4.1873e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=53626
2024-11-10 01:38:56 - progress_bar.py[line:274] - INFO: epoch 022:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.023, ntokens=17353.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3245.5, ups=0.19, wpb=17353.8, bsz=1024, num_updates=8330, lr=4.18594e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=53679
2024-11-10 01:39:49 - progress_bar.py[line:274] - INFO: epoch 022:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17342.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3268.9, ups=0.19, wpb=17342.6, bsz=1024, num_updates=8340, lr=4.18458e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53732
2024-11-10 01:40:43 - progress_bar.py[line:274] - INFO: epoch 022:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=17233.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3199.7, ups=0.19, wpb=17233.2, bsz=1024, num_updates=8350, lr=4.18322e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=53786
2024-11-10 01:41:37 - progress_bar.py[line:274] - INFO: epoch 022:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17225.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3222.6, ups=0.19, wpb=17225.9, bsz=1024, num_updates=8360, lr=4.18186e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=53839
2024-11-10 01:42:30 - progress_bar.py[line:274] - INFO: epoch 022:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17041.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3161, ups=0.19, wpb=17041.5, bsz=1024, num_updates=8370, lr=4.1805e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=53893
2024-11-10 01:43:24 - progress_bar.py[line:274] - INFO: epoch 022:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17186.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3232.5, ups=0.19, wpb=17186.3, bsz=1024, num_updates=8380, lr=4.17914e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=53947
2024-11-10 01:44:18 - progress_bar.py[line:274] - INFO: epoch 022:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17086, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3153.5, ups=0.18, wpb=17086, bsz=1024, num_updates=8390, lr=4.17778e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=54001
2024-11-10 01:45:12 - progress_bar.py[line:274] - INFO: epoch 022:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=16763.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3097.5, ups=0.18, wpb=16763.5, bsz=1024, num_updates=8400, lr=4.17642e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=54055
2024-11-10 01:46:06 - progress_bar.py[line:274] - INFO: epoch 022:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17438.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3250.6, ups=0.19, wpb=17438.2, bsz=1024, num_updates=8410, lr=4.17506e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=54109
2024-11-10 01:46:59 - progress_bar.py[line:274] - INFO: epoch 022:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=16980.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3189.8, ups=0.19, wpb=16980.4, bsz=1024, num_updates=8420, lr=4.1737e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=54162
2024-11-10 01:47:52 - progress_bar.py[line:274] - INFO: epoch 022:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.009, ntokens=17200.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3235.8, ups=0.19, wpb=17200.6, bsz=1024, num_updates=8430, lr=4.17233e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=54215
2024-11-10 01:48:47 - progress_bar.py[line:274] - INFO: epoch 022:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.044, ntokens=17456.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3179.8, ups=0.18, wpb=17456.6, bsz=1024, num_updates=8440, lr=4.17097e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=54270
2024-11-10 01:49:40 - progress_bar.py[line:274] - INFO: epoch 022:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17174.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3209.4, ups=0.19, wpb=17174.7, bsz=1024, num_updates=8450, lr=4.16961e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=54323
2024-11-10 01:50:34 - progress_bar.py[line:274] - INFO: epoch 022:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17213.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3211.7, ups=0.19, wpb=17213.9, bsz=1024, num_updates=8460, lr=4.16825e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=54377
2024-11-10 01:51:28 - progress_bar.py[line:274] - INFO: epoch 022:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17267.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3223.6, ups=0.19, wpb=17267.2, bsz=1024, num_updates=8470, lr=4.16689e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=12.9, wall=54430
2024-11-10 01:52:21 - progress_bar.py[line:274] - INFO: epoch 022:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17239.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3239.1, ups=0.19, wpb=17239.5, bsz=1024, num_updates=8480, lr=4.16553e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=54484
2024-11-10 01:52:31 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 01:53:21 - progress_bar.py[line:274] - INFO: epoch 022:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17206.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=2870.7, ups=0.17, wpb=17206.3, bsz=1024, num_updates=8490, lr=4.16417e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=54544
2024-11-10 01:54:14 - progress_bar.py[line:274] - INFO: epoch 022:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17290, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3234.4, ups=0.19, wpb=17290, bsz=1024, num_updates=8500, lr=4.16281e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=54597
2024-11-10 01:55:08 - progress_bar.py[line:274] - INFO: epoch 022:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17215.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3180.5, ups=0.18, wpb=17215.2, bsz=1024, num_updates=8510, lr=4.16145e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=54651
2024-11-10 01:56:02 - progress_bar.py[line:274] - INFO: epoch 022:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17122.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3203.4, ups=0.19, wpb=17122.6, bsz=1024, num_updates=8520, lr=4.16009e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=54705
2024-11-10 01:56:56 - progress_bar.py[line:274] - INFO: epoch 022:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17062.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3164, ups=0.19, wpb=17062.7, bsz=1024, num_updates=8530, lr=4.15873e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=54759
2024-11-10 01:57:49 - progress_bar.py[line:274] - INFO: epoch 022:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=16937.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3163.6, ups=0.19, wpb=16937.1, bsz=1024, num_updates=8540, lr=4.15737e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=54812
2024-11-10 01:58:43 - progress_bar.py[line:274] - INFO: epoch 022:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.957, ntokens=16926.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3159.2, ups=0.19, wpb=16926.6, bsz=1024, num_updates=8550, lr=4.15601e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=54866
2024-11-10 01:59:36 - progress_bar.py[line:274] - INFO: epoch 022:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17418.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3259.6, ups=0.19, wpb=17418.4, bsz=1024, num_updates=8560, lr=4.15465e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=54919
2024-11-10 02:00:29 - progress_bar.py[line:274] - INFO: epoch 022:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17164.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3224.9, ups=0.19, wpb=17164.4, bsz=1024, num_updates=8570, lr=4.15329e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=54972
2024-11-10 02:01:22 - progress_bar.py[line:274] - INFO: epoch 022:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17486.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3324.3, ups=0.19, wpb=17486.8, bsz=1024, num_updates=8580, lr=4.15193e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=55025
2024-11-10 02:02:14 - progress_bar.py[line:274] - INFO: epoch 022:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17140, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3293.8, ups=0.19, wpb=17140, bsz=1024, num_updates=8590, lr=4.15057e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=55077
2024-11-10 02:02:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 22 @ 8596 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
2024-11-10 02:02:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 02:04:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-10 02:06:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 22 @ 8596 updates, score 0) (writing took 222.49952833302086 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
2024-11-10 02:07:19 - train.py[line:336] - INFO: end of epoch 22 (average epoch stats below)
2024-11-10 02:07:19 - progress_bar.py[line:282] - INFO: epoch 022 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.008 | ntokens 17165.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.05 | wps 2645 | ups 0.15 | wpb 17165.3 | bsz 1023 | num_updates 8596 | lr 4.14975e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.3 | wall 55382
2024-11-10 02:07:19 - trainer.py[line:639] - INFO: loading train data for epoch 23
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 02:10:01 - trainer.py[line:703] - INFO: begin training epoch 23
2024-11-10 02:10:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 02:10:24 - progress_bar.py[line:274] - INFO: epoch 023:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=16661.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=340, ups=0.02, wpb=16661.4, bsz=985.6, num_updates=8600, lr=4.14921e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=29, gb_free=13.2, wall=55567
2024-11-10 02:11:17 - progress_bar.py[line:274] - INFO: epoch 023:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17127.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3212.4, ups=0.19, wpb=17127.7, bsz=1024, num_updates=8610, lr=4.14785e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=55620
2024-11-10 02:12:11 - progress_bar.py[line:274] - INFO: epoch 023:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=17357, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3248, ups=0.19, wpb=17357, bsz=1024, num_updates=8620, lr=4.14649e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=55674
2024-11-10 02:13:04 - progress_bar.py[line:274] - INFO: epoch 023:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=16907.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3157.9, ups=0.19, wpb=16907.4, bsz=1024, num_updates=8630, lr=4.14513e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=55727
2024-11-10 02:13:58 - progress_bar.py[line:274] - INFO: epoch 023:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17343.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3252.1, ups=0.19, wpb=17343.4, bsz=1024, num_updates=8640, lr=4.14377e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=55781
2024-11-10 02:14:51 - progress_bar.py[line:274] - INFO: epoch 023:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=17491.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3288, ups=0.19, wpb=17491.8, bsz=1024, num_updates=8650, lr=4.14241e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=55834
2024-11-10 02:15:44 - progress_bar.py[line:274] - INFO: epoch 023:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=16957.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3172, ups=0.19, wpb=16957.4, bsz=1024, num_updates=8660, lr=4.14105e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=55887
2024-11-10 02:16:38 - progress_bar.py[line:274] - INFO: epoch 023:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17177.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3186.5, ups=0.19, wpb=17177.5, bsz=1024, num_updates=8670, lr=4.13969e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=55941
2024-11-10 02:17:32 - progress_bar.py[line:274] - INFO: epoch 023:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17263, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3202.5, ups=0.19, wpb=17263, bsz=1024, num_updates=8680, lr=4.13833e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=55995
2024-11-10 02:18:25 - progress_bar.py[line:274] - INFO: epoch 023:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=16997.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3206.4, ups=0.19, wpb=16997.1, bsz=1024, num_updates=8690, lr=4.13696e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=56048
2024-11-10 02:19:19 - progress_bar.py[line:274] - INFO: epoch 023:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17267.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3214.9, ups=0.19, wpb=17267.9, bsz=1024, num_updates=8700, lr=4.1356e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=56102
2024-11-10 02:20:13 - progress_bar.py[line:274] - INFO: epoch 023:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17078.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3186.5, ups=0.19, wpb=17078.1, bsz=1024, num_updates=8710, lr=4.13424e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=56155
2024-11-10 02:21:06 - progress_bar.py[line:274] - INFO: epoch 023:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=17263.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3222.4, ups=0.19, wpb=17263.5, bsz=1024, num_updates=8720, lr=4.13288e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=56209
2024-11-10 02:22:00 - progress_bar.py[line:274] - INFO: epoch 023:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17444.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3243.3, ups=0.19, wpb=17444.4, bsz=1024, num_updates=8730, lr=4.13152e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=56263
2024-11-10 02:22:54 - progress_bar.py[line:274] - INFO: epoch 023:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=16922.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3141.4, ups=0.19, wpb=16922.6, bsz=1024, num_updates=8740, lr=4.13016e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=56317
2024-11-10 02:23:47 - progress_bar.py[line:274] - INFO: epoch 023:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17347.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3246.8, ups=0.19, wpb=17347.1, bsz=1024, num_updates=8750, lr=4.1288e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=56370
2024-11-10 02:24:41 - progress_bar.py[line:274] - INFO: epoch 023:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.026, ntokens=17285, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3221.4, ups=0.19, wpb=17285, bsz=1024, num_updates=8760, lr=4.12744e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=56424
2024-11-10 02:25:34 - progress_bar.py[line:274] - INFO: epoch 023:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17208.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3217.9, ups=0.19, wpb=17208.1, bsz=1024, num_updates=8770, lr=4.12608e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=56477
2024-11-10 02:26:28 - progress_bar.py[line:274] - INFO: epoch 023:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17194, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3176.7, ups=0.18, wpb=17194, bsz=1024, num_updates=8780, lr=4.12472e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=56531
2024-11-10 02:27:22 - progress_bar.py[line:274] - INFO: epoch 023:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.963, ntokens=17021.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3167.9, ups=0.19, wpb=17021.1, bsz=1024, num_updates=8790, lr=4.12336e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=56585
2024-11-10 02:28:16 - progress_bar.py[line:274] - INFO: epoch 023:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=17152.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3201.4, ups=0.19, wpb=17152.3, bsz=1024, num_updates=8800, lr=4.122e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=56639
2024-11-10 02:29:09 - progress_bar.py[line:274] - INFO: epoch 023:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=16901.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3154.3, ups=0.19, wpb=16901.4, bsz=1024, num_updates=8810, lr=4.12064e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=56692
2024-11-10 02:30:03 - progress_bar.py[line:274] - INFO: epoch 023:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=16998.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3195.6, ups=0.19, wpb=16998.3, bsz=1024, num_updates=8820, lr=4.11928e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=56745
2024-11-10 02:30:57 - progress_bar.py[line:274] - INFO: epoch 023:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17498.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3221.2, ups=0.18, wpb=17498.9, bsz=1024, num_updates=8830, lr=4.11792e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=56800
2024-11-10 02:31:50 - progress_bar.py[line:274] - INFO: epoch 023:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17042.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3198.2, ups=0.19, wpb=17042.5, bsz=1024, num_updates=8840, lr=4.11656e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=56853
2024-11-10 02:32:44 - progress_bar.py[line:274] - INFO: epoch 023:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.01, ntokens=17289.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3198.5, ups=0.18, wpb=17289.5, bsz=1024, num_updates=8850, lr=4.1152e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=56907
2024-11-10 02:33:38 - progress_bar.py[line:274] - INFO: epoch 023:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.997, ntokens=17202.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3178.5, ups=0.18, wpb=17202.4, bsz=1024, num_updates=8860, lr=4.11384e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=56961
2024-11-10 02:34:33 - progress_bar.py[line:274] - INFO: epoch 023:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17229.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3168.7, ups=0.18, wpb=17229.2, bsz=1024, num_updates=8870, lr=4.11248e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=57016
2024-11-10 02:35:27 - progress_bar.py[line:274] - INFO: epoch 023:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17162.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3188.7, ups=0.19, wpb=17162.6, bsz=1024, num_updates=8880, lr=4.11112e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57069
2024-11-10 02:36:20 - progress_bar.py[line:274] - INFO: epoch 023:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17139.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3176.7, ups=0.19, wpb=17139.8, bsz=1024, num_updates=8890, lr=4.10976e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=57123
2024-11-10 02:37:14 - progress_bar.py[line:274] - INFO: epoch 023:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17378.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3246.8, ups=0.19, wpb=17378.5, bsz=1024, num_updates=8900, lr=4.1084e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57177
2024-11-10 02:38:08 - progress_bar.py[line:274] - INFO: epoch 023:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17106.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3187.1, ups=0.19, wpb=17106.5, bsz=1024, num_updates=8910, lr=4.10704e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=57231
2024-11-10 02:39:01 - progress_bar.py[line:274] - INFO: epoch 023:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17307.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3236.3, ups=0.19, wpb=17307.4, bsz=1024, num_updates=8920, lr=4.10568e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57284
2024-11-10 02:39:55 - progress_bar.py[line:274] - INFO: epoch 023:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17140.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3211.9, ups=0.19, wpb=17140.4, bsz=1024, num_updates=8930, lr=4.10432e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=57337
2024-11-10 02:40:48 - progress_bar.py[line:274] - INFO: epoch 023:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=16936.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3166, ups=0.19, wpb=16936.7, bsz=1024, num_updates=8940, lr=4.10295e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57391
2024-11-10 02:41:42 - progress_bar.py[line:274] - INFO: epoch 023:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17495.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3269.5, ups=0.19, wpb=17495.7, bsz=1024, num_updates=8950, lr=4.10159e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=57444
2024-11-10 02:42:36 - progress_bar.py[line:274] - INFO: epoch 023:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.997, ntokens=17448.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3234.3, ups=0.19, wpb=17448.5, bsz=1024, num_updates=8960, lr=4.10023e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57498
2024-11-10 02:43:28 - progress_bar.py[line:274] - INFO: epoch 023:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17350.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3299.9, ups=0.19, wpb=17350.2, bsz=1024, num_updates=8970, lr=4.09887e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57551
2024-11-10 02:44:20 - progress_bar.py[line:274] - INFO: epoch 023:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17367.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3342.4, ups=0.19, wpb=17367.5, bsz=1024, num_updates=8980, lr=4.09751e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=57603
2024-11-10 02:44:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 23 @ 8987 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-10 02:44:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 02:46:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-10 02:48:35 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 23 @ 8987 updates, score 0) (writing took 222.4664139020024 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 02:49:30 - train.py[line:336] - INFO: end of epoch 23 (average epoch stats below)
2024-11-10 02:49:30 - progress_bar.py[line:282] - INFO: epoch 023 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.993 | ntokens 17189.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.96 | wps 2655.8 | ups 0.15 | wpb 17189.7 | bsz 1023 | num_updates 8987 | lr 4.09656e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.2 | wall 57913
2024-11-10 02:49:30 - trainer.py[line:639] - INFO: loading train data for epoch 24
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 02:52:11 - trainer.py[line:703] - INFO: begin training epoch 24
2024-11-10 02:52:11 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 02:52:29 - progress_bar.py[line:274] - INFO: epoch 024:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=16607.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=339.3, ups=0.02, wpb=16607.7, bsz=985.6, num_updates=8990, lr=4.09615e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.4, wall=58092
2024-11-10 02:53:23 - progress_bar.py[line:274] - INFO: epoch 024:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17096.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3213.5, ups=0.19, wpb=17096.2, bsz=1024, num_updates=9000, lr=4.09479e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=58146
2024-11-10 02:54:16 - progress_bar.py[line:274] - INFO: epoch 024:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17453.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3266, ups=0.19, wpb=17453.9, bsz=1024, num_updates=9010, lr=4.09343e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=58199
2024-11-10 02:55:09 - progress_bar.py[line:274] - INFO: epoch 024:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17252.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3265, ups=0.19, wpb=17252.6, bsz=1024, num_updates=9020, lr=4.09207e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=58252
2024-11-10 02:56:02 - progress_bar.py[line:274] - INFO: epoch 024:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17310.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3251.4, ups=0.19, wpb=17310.6, bsz=1024, num_updates=9030, lr=4.09071e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=58305
2024-11-10 02:56:56 - progress_bar.py[line:274] - INFO: epoch 024:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17121.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3174, ups=0.19, wpb=17121.9, bsz=1024, num_updates=9040, lr=4.08935e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=58359
2024-11-10 02:57:50 - progress_bar.py[line:274] - INFO: epoch 024:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17124.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3197.1, ups=0.19, wpb=17124.6, bsz=1024, num_updates=9050, lr=4.08799e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=58413
2024-11-10 02:58:43 - progress_bar.py[line:274] - INFO: epoch 024:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17285.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3236.1, ups=0.19, wpb=17285.9, bsz=1024, num_updates=9060, lr=4.08663e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=58466
2024-11-10 02:59:37 - progress_bar.py[line:274] - INFO: epoch 024:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17518.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3265.1, ups=0.19, wpb=17518.3, bsz=1024, num_updates=9070, lr=4.08527e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=58520
2024-11-10 03:00:31 - progress_bar.py[line:274] - INFO: epoch 024:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17014.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3136.6, ups=0.18, wpb=17014.6, bsz=1024, num_updates=9080, lr=4.08391e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=58574
2024-11-10 03:01:25 - progress_bar.py[line:274] - INFO: epoch 024:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17289.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3191.8, ups=0.18, wpb=17289.4, bsz=1024, num_updates=9090, lr=4.08255e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=58628
2024-11-10 03:02:19 - progress_bar.py[line:274] - INFO: epoch 024:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17192.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3207.2, ups=0.19, wpb=17192.9, bsz=1024, num_updates=9100, lr=4.08119e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=58682
2024-11-10 03:03:13 - progress_bar.py[line:274] - INFO: epoch 024:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17145.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3176.3, ups=0.19, wpb=17145.1, bsz=1024, num_updates=9110, lr=4.07983e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=58736
2024-11-10 03:04:07 - progress_bar.py[line:274] - INFO: epoch 024:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17326, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3223, ups=0.19, wpb=17326, bsz=1024, num_updates=9120, lr=4.07847e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=58789
2024-11-10 03:05:00 - progress_bar.py[line:274] - INFO: epoch 024:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=16994.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3161.6, ups=0.19, wpb=16994.2, bsz=1024, num_updates=9130, lr=4.07711e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=58843
2024-11-10 03:05:54 - progress_bar.py[line:274] - INFO: epoch 024:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17094.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3171.6, ups=0.19, wpb=17094.5, bsz=1024, num_updates=9140, lr=4.07575e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=58897
2024-11-10 03:06:48 - progress_bar.py[line:274] - INFO: epoch 024:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17246.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3216.9, ups=0.19, wpb=17246.4, bsz=1024, num_updates=9150, lr=4.07439e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=58951
2024-11-10 03:07:41 - progress_bar.py[line:274] - INFO: epoch 024:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17129.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3199.5, ups=0.19, wpb=17129.1, bsz=1024, num_updates=9160, lr=4.07303e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=59004
2024-11-10 03:08:35 - progress_bar.py[line:274] - INFO: epoch 024:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17038.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3175.6, ups=0.19, wpb=17038.4, bsz=1024, num_updates=9170, lr=4.07167e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=59058
2024-11-10 03:09:28 - progress_bar.py[line:274] - INFO: epoch 024:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=16959, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3200.9, ups=0.19, wpb=16959, bsz=1024, num_updates=9180, lr=4.07031e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=59111
2024-11-10 03:10:22 - progress_bar.py[line:274] - INFO: epoch 024:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17269.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3224.9, ups=0.19, wpb=17269.9, bsz=1024, num_updates=9190, lr=4.06894e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=59164
2024-11-10 03:11:16 - progress_bar.py[line:274] - INFO: epoch 024:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=16937.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3126, ups=0.18, wpb=16937.5, bsz=1024, num_updates=9200, lr=4.06758e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=59219
2024-11-10 03:11:48 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 03:12:14 - progress_bar.py[line:274] - INFO: epoch 024:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17309.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=2944.4, ups=0.17, wpb=17309.1, bsz=1024, num_updates=9210, lr=4.06622e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.3, wall=59277
2024-11-10 03:13:09 - progress_bar.py[line:274] - INFO: epoch 024:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17238.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3188.2, ups=0.18, wpb=17238.2, bsz=1024, num_updates=9220, lr=4.06486e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=59331
2024-11-10 03:14:04 - progress_bar.py[line:274] - INFO: epoch 024:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17258.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3132.3, ups=0.18, wpb=17258.2, bsz=1024, num_updates=9230, lr=4.0635e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=39, gb_free=13.2, wall=59387
2024-11-10 03:14:58 - progress_bar.py[line:274] - INFO: epoch 024:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17037.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3110.8, ups=0.18, wpb=17037.1, bsz=1024, num_updates=9240, lr=4.06214e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=59441
2024-11-10 03:15:53 - progress_bar.py[line:274] - INFO: epoch 024:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17463.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3195.9, ups=0.18, wpb=17463.2, bsz=1024, num_updates=9250, lr=4.06078e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=59496
2024-11-10 03:16:48 - progress_bar.py[line:274] - INFO: epoch 024:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17017.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3072.4, ups=0.18, wpb=17017.4, bsz=1024, num_updates=9260, lr=4.05942e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=59551
2024-11-10 03:17:42 - progress_bar.py[line:274] - INFO: epoch 024:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17198.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3220.1, ups=0.19, wpb=17198.2, bsz=1024, num_updates=9270, lr=4.05806e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=59605
2024-11-10 03:18:34 - progress_bar.py[line:274] - INFO: epoch 024:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17239.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3330.1, ups=0.19, wpb=17239.1, bsz=1024, num_updates=9280, lr=4.0567e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=50, gb_free=13.4, wall=59657
2024-11-10 03:19:26 - progress_bar.py[line:274] - INFO: epoch 024:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17448.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3356.7, ups=0.19, wpb=17448.1, bsz=1024, num_updates=9290, lr=4.05534e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=36, gb_free=13.3, wall=59709
2024-11-10 03:20:19 - progress_bar.py[line:274] - INFO: epoch 024:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=16897.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3158.3, ups=0.19, wpb=16897.4, bsz=1024, num_updates=9300, lr=4.05398e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=59762
2024-11-10 03:21:13 - progress_bar.py[line:274] - INFO: epoch 024:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17210.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3202.6, ups=0.19, wpb=17210.2, bsz=1024, num_updates=9310, lr=4.05262e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=59816
2024-11-10 03:22:06 - progress_bar.py[line:274] - INFO: epoch 024:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17326.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3243.5, ups=0.19, wpb=17326.7, bsz=1024, num_updates=9320, lr=4.05126e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=59869
2024-11-10 03:23:00 - progress_bar.py[line:274] - INFO: epoch 024:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17076.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3175.8, ups=0.19, wpb=17076.6, bsz=1024, num_updates=9330, lr=4.0499e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=59923
2024-11-10 03:23:54 - progress_bar.py[line:274] - INFO: epoch 024:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17390.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3195.8, ups=0.18, wpb=17390.6, bsz=1024, num_updates=9340, lr=4.04854e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=59977
2024-11-10 03:24:48 - progress_bar.py[line:274] - INFO: epoch 024:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17128.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3217.2, ups=0.19, wpb=17128.2, bsz=1024, num_updates=9350, lr=4.04718e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=60031
2024-11-10 03:25:42 - progress_bar.py[line:274] - INFO: epoch 024:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17445.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3186.3, ups=0.18, wpb=17445.7, bsz=1024, num_updates=9360, lr=4.04582e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=38, gb_free=13, wall=60085
2024-11-10 03:26:37 - progress_bar.py[line:274] - INFO: epoch 024:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17095, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3111.1, ups=0.18, wpb=17095, bsz=1024, num_updates=9370, lr=4.04446e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=60140
2024-11-10 03:27:13 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 24 @ 9377 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-10 03:27:13 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 03:29:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
2024-11-10 03:30:55 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 24 @ 9377 updates, score 0) (writing took 222.6750297730323 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-10 03:31:50 - train.py[line:336] - INFO: end of epoch 24 (average epoch stats below)
2024-11-10 03:31:50 - progress_bar.py[line:282] - INFO: epoch 024 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.98 | ntokens 17183.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.89 | wps 2638.2 | ups 0.15 | wpb 17183.4 | bsz 1023 | num_updates 9377 | lr 4.04351e-05 | gnorm 0.007 | clip 0 | loss_scale 32768 | train_wall 1360 | gb_free 13.4 | wall 60453
2024-11-10 03:31:50 - trainer.py[line:639] - INFO: loading train data for epoch 25
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 03:34:31 - trainer.py[line:703] - INFO: begin training epoch 25
2024-11-10 03:34:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 03:34:49 - progress_bar.py[line:274] - INFO: epoch 025:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.975, ntokens=16466.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=334.9, ups=0.02, wpb=16466.6, bsz=985.6, num_updates=9380, lr=4.0431e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=60632
2024-11-10 03:35:42 - progress_bar.py[line:274] - INFO: epoch 025:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17117, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3207.3, ups=0.19, wpb=17117, bsz=1024, num_updates=9390, lr=4.04174e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=60685
2024-11-10 03:36:36 - progress_bar.py[line:274] - INFO: epoch 025:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17372.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3242.2, ups=0.19, wpb=17372.3, bsz=1024, num_updates=9400, lr=4.04038e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=12.8, wall=60739
2024-11-10 03:37:29 - progress_bar.py[line:274] - INFO: epoch 025:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.981, ntokens=17291.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3268.4, ups=0.19, wpb=17291.4, bsz=1024, num_updates=9410, lr=4.03902e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=60792
2024-11-10 03:38:23 - progress_bar.py[line:274] - INFO: epoch 025:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=16976.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3147.1, ups=0.19, wpb=16976.6, bsz=1024, num_updates=9420, lr=4.03766e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=60846
2024-11-10 03:39:16 - progress_bar.py[line:274] - INFO: epoch 025:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3247, ups=0.19, wpb=17251.2, bsz=1024, num_updates=9430, lr=4.0363e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=60899
2024-11-10 03:40:10 - progress_bar.py[line:274] - INFO: epoch 025:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17125, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3196.7, ups=0.19, wpb=17125, bsz=1024, num_updates=9440, lr=4.03493e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=60952
2024-11-10 03:41:03 - progress_bar.py[line:274] - INFO: epoch 025:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.975, ntokens=17104.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3208.1, ups=0.19, wpb=17104.4, bsz=1024, num_updates=9450, lr=4.03357e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=61006
2024-11-10 03:41:57 - progress_bar.py[line:274] - INFO: epoch 025:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17263.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3193, ups=0.18, wpb=17263.4, bsz=1024, num_updates=9460, lr=4.03221e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=61060
2024-11-10 03:42:51 - progress_bar.py[line:274] - INFO: epoch 025:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17054.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3166.4, ups=0.19, wpb=17054.2, bsz=1024, num_updates=9470, lr=4.03085e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=61114
2024-11-10 03:43:45 - progress_bar.py[line:274] - INFO: epoch 025:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17280.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3203.6, ups=0.19, wpb=17280.2, bsz=1024, num_updates=9480, lr=4.02949e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=61168
2024-11-10 03:44:38 - progress_bar.py[line:274] - INFO: epoch 025:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17075.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3214, ups=0.19, wpb=17075.8, bsz=1024, num_updates=9490, lr=4.02813e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=61221
2024-11-10 03:45:31 - progress_bar.py[line:274] - INFO: epoch 025:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17264.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3231.3, ups=0.19, wpb=17264.6, bsz=1024, num_updates=9500, lr=4.02677e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=61274
2024-11-10 03:46:26 - progress_bar.py[line:274] - INFO: epoch 025:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.986, ntokens=17356.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3203.5, ups=0.18, wpb=17356.2, bsz=1024, num_updates=9510, lr=4.02541e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=61328
2024-11-10 03:47:19 - progress_bar.py[line:274] - INFO: epoch 025:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17020.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3186.8, ups=0.19, wpb=17020.3, bsz=1024, num_updates=9520, lr=4.02405e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=61382
2024-11-10 03:48:12 - progress_bar.py[line:274] - INFO: epoch 025:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17170.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3227.2, ups=0.19, wpb=17170.6, bsz=1024, num_updates=9530, lr=4.02269e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=61435
2024-11-10 03:49:06 - progress_bar.py[line:274] - INFO: epoch 025:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=16932.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3147.2, ups=0.19, wpb=16932.2, bsz=1024, num_updates=9540, lr=4.02133e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=61489
2024-11-10 03:50:00 - progress_bar.py[line:274] - INFO: epoch 025:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17139.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3164.6, ups=0.18, wpb=17139.9, bsz=1024, num_updates=9550, lr=4.01997e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=61543
2024-11-10 03:50:54 - progress_bar.py[line:274] - INFO: epoch 025:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17084, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3178.5, ups=0.19, wpb=17084, bsz=1024, num_updates=9560, lr=4.01861e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=61597
2024-11-10 03:51:47 - progress_bar.py[line:274] - INFO: epoch 025:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17236.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3245.9, ups=0.19, wpb=17236.8, bsz=1024, num_updates=9570, lr=4.01725e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=61650
2024-11-10 03:52:40 - progress_bar.py[line:274] - INFO: epoch 025:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17140.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3203.1, ups=0.19, wpb=17140.4, bsz=1024, num_updates=9580, lr=4.01589e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=61703
2024-11-10 03:53:35 - progress_bar.py[line:274] - INFO: epoch 025:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=16926.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3125.6, ups=0.18, wpb=16926.8, bsz=1024, num_updates=9590, lr=4.01453e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=61758
2024-11-10 03:54:28 - progress_bar.py[line:274] - INFO: epoch 025:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=16975, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3175.7, ups=0.19, wpb=16975, bsz=1024, num_updates=9600, lr=4.01317e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=61811
2024-11-10 03:55:22 - progress_bar.py[line:274] - INFO: epoch 025:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17196.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3180.1, ups=0.18, wpb=17196.4, bsz=1024, num_updates=9610, lr=4.01181e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=61865
2024-11-10 03:56:16 - progress_bar.py[line:274] - INFO: epoch 025:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17186.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3170.7, ups=0.18, wpb=17186.4, bsz=1024, num_updates=9620, lr=4.01045e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=61919
2024-11-10 03:57:10 - progress_bar.py[line:274] - INFO: epoch 025:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17156, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3217.8, ups=0.19, wpb=17156, bsz=1024, num_updates=9630, lr=4.00909e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=61973
2024-11-10 03:58:04 - progress_bar.py[line:274] - INFO: epoch 025:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=17042.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3148.4, ups=0.18, wpb=17042.7, bsz=1024, num_updates=9640, lr=4.00773e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=62027
2024-11-10 03:58:57 - progress_bar.py[line:274] - INFO: epoch 025:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17059.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3177.7, ups=0.19, wpb=17059.8, bsz=1024, num_updates=9650, lr=4.00637e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=62080
2024-11-10 03:59:51 - progress_bar.py[line:274] - INFO: epoch 025:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=16970.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3197.4, ups=0.19, wpb=16970.1, bsz=1024, num_updates=9660, lr=4.00501e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.2, wall=62133
2024-11-10 04:00:44 - progress_bar.py[line:274] - INFO: epoch 025:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17285.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3245, ups=0.19, wpb=17285.7, bsz=1024, num_updates=9670, lr=4.00365e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=62187
2024-11-10 04:01:37 - progress_bar.py[line:274] - INFO: epoch 025:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.969, ntokens=17288.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3242.1, ups=0.19, wpb=17288.7, bsz=1024, num_updates=9680, lr=4.00229e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=62240
2024-11-10 04:02:31 - progress_bar.py[line:274] - INFO: epoch 025:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=16950.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3173.7, ups=0.19, wpb=16950.7, bsz=1024, num_updates=9690, lr=4.00093e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=62293
2024-11-10 04:03:24 - progress_bar.py[line:274] - INFO: epoch 025:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17166.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3192.1, ups=0.19, wpb=17166.8, bsz=1024, num_updates=9700, lr=3.99956e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=12.8, wall=62347
2024-11-10 04:04:18 - progress_bar.py[line:274] - INFO: epoch 025:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17192.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3199.4, ups=0.19, wpb=17192.2, bsz=1024, num_updates=9710, lr=3.9982e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=62401
2024-11-10 04:05:12 - progress_bar.py[line:274] - INFO: epoch 025:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17217.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3206.2, ups=0.19, wpb=17217.4, bsz=1024, num_updates=9720, lr=3.99684e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=62455
2024-11-10 04:06:06 - progress_bar.py[line:274] - INFO: epoch 025:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17243.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3204.6, ups=0.19, wpb=17243.5, bsz=1024, num_updates=9730, lr=3.99548e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=12.8, wall=62508
2024-11-10 04:06:59 - progress_bar.py[line:274] - INFO: epoch 025:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=16952, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3156.7, ups=0.19, wpb=16952, bsz=1024, num_updates=9740, lr=3.99412e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=62562
2024-11-10 04:07:52 - progress_bar.py[line:274] - INFO: epoch 025:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17200.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3283.7, ups=0.19, wpb=17200.9, bsz=1024, num_updates=9750, lr=3.99276e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=62615
2024-11-10 04:08:43 - progress_bar.py[line:274] - INFO: epoch 025:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17277.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3336.4, ups=0.19, wpb=17277.9, bsz=1024, num_updates=9760, lr=3.9914e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=62666
2024-11-10 04:09:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 25 @ 9768 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
2024-11-10 04:09:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 04:11:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
2024-11-10 04:13:05 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 25 @ 9768 updates, score 0) (writing took 222.61936426896136 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-10 04:13:59 - train.py[line:336] - INFO: end of epoch 25 (average epoch stats below)
2024-11-10 04:13:59 - progress_bar.py[line:282] - INFO: epoch 025 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.957 | ntokens 17130.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.76 | wps 2648 | ups 0.15 | wpb 17130.4 | bsz 1023 | num_updates 9768 | lr 3.99031e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1188 | gb_free 13.3 | wall 62982
2024-11-10 04:13:59 - trainer.py[line:639] - INFO: loading train data for epoch 26
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 04:16:40 - trainer.py[line:703] - INFO: begin training epoch 26
2024-11-10 04:16:40 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 04:16:53 - progress_bar.py[line:274] - INFO: epoch 026:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=16601.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=338.8, ups=0.02, wpb=16601.2, bsz=985.6, num_updates=9770, lr=3.99004e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=29, gb_free=13.2, wall=63156
2024-11-10 04:17:47 - progress_bar.py[line:274] - INFO: epoch 026:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3243.1, ups=0.19, wpb=17345, bsz=1024, num_updates=9780, lr=3.98868e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63210
2024-11-10 04:18:40 - progress_bar.py[line:274] - INFO: epoch 026:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17292.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3233.9, ups=0.19, wpb=17292.8, bsz=1024, num_updates=9790, lr=3.98732e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63263
2024-11-10 04:19:33 - progress_bar.py[line:274] - INFO: epoch 026:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.981, ntokens=17160.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3239, ups=0.19, wpb=17160.4, bsz=1024, num_updates=9800, lr=3.98596e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=63316
2024-11-10 04:20:27 - progress_bar.py[line:274] - INFO: epoch 026:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.969, ntokens=17260.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3222.3, ups=0.19, wpb=17260.7, bsz=1024, num_updates=9810, lr=3.9846e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=63370
2024-11-10 04:21:20 - progress_bar.py[line:274] - INFO: epoch 026:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17302.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3252, ups=0.19, wpb=17302.8, bsz=1024, num_updates=9820, lr=3.98324e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=63423
2024-11-10 04:22:14 - progress_bar.py[line:274] - INFO: epoch 026:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17025.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3179.8, ups=0.19, wpb=17025.5, bsz=1024, num_updates=9830, lr=3.98188e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=63477
2024-11-10 04:23:07 - progress_bar.py[line:274] - INFO: epoch 026:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3247.8, ups=0.19, wpb=17245.1, bsz=1024, num_updates=9840, lr=3.98052e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=63530
2024-11-10 04:24:00 - progress_bar.py[line:274] - INFO: epoch 026:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17148.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3196.8, ups=0.19, wpb=17148.4, bsz=1024, num_updates=9850, lr=3.97916e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=63583
2024-11-10 04:24:54 - progress_bar.py[line:274] - INFO: epoch 026:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17105.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3171.3, ups=0.19, wpb=17105.5, bsz=1024, num_updates=9860, lr=3.9778e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=63637
2024-11-10 04:25:48 - progress_bar.py[line:274] - INFO: epoch 026:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.968, ntokens=17307.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3250.3, ups=0.19, wpb=17307.7, bsz=1024, num_updates=9870, lr=3.97644e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=63691
2024-11-10 04:26:41 - progress_bar.py[line:274] - INFO: epoch 026:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17219.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3204.6, ups=0.19, wpb=17219.2, bsz=1024, num_updates=9880, lr=3.97508e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=63744
2024-11-10 04:27:35 - progress_bar.py[line:274] - INFO: epoch 026:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17140.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3188.9, ups=0.19, wpb=17140.4, bsz=1024, num_updates=9890, lr=3.97372e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=63798
2024-11-10 04:28:29 - progress_bar.py[line:274] - INFO: epoch 026:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17249.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3216.1, ups=0.19, wpb=17249.5, bsz=1024, num_updates=9900, lr=3.97236e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=63852
2024-11-10 04:29:23 - progress_bar.py[line:274] - INFO: epoch 026:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=16891.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3118.8, ups=0.18, wpb=16891.6, bsz=1024, num_updates=9910, lr=3.971e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=63906
2024-11-10 04:30:16 - progress_bar.py[line:274] - INFO: epoch 026:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17238.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3229.8, ups=0.19, wpb=17238.1, bsz=1024, num_updates=9920, lr=3.96964e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=63959
2024-11-10 04:31:10 - progress_bar.py[line:274] - INFO: epoch 026:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=16990.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3187.1, ups=0.19, wpb=16990.8, bsz=1024, num_updates=9930, lr=3.96828e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=64012
2024-11-10 04:32:03 - progress_bar.py[line:274] - INFO: epoch 026:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17132.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3225.6, ups=0.19, wpb=17132.5, bsz=1024, num_updates=9940, lr=3.96692e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=64066
2024-11-10 04:32:18 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 04:33:01 - progress_bar.py[line:274] - INFO: epoch 026:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17160.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=2926.4, ups=0.17, wpb=17160.3, bsz=1024, num_updates=9950, lr=3.96555e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.1, wall=64124
2024-11-10 04:33:55 - progress_bar.py[line:274] - INFO: epoch 026:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17190.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3216.4, ups=0.19, wpb=17190.2, bsz=1024, num_updates=9960, lr=3.96419e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64178
2024-11-10 04:34:49 - progress_bar.py[line:274] - INFO: epoch 026:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17295.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3215.4, ups=0.19, wpb=17295.2, bsz=1024, num_updates=9970, lr=3.96283e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64231
2024-11-10 04:35:42 - progress_bar.py[line:274] - INFO: epoch 026:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=16885.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3171.8, ups=0.19, wpb=16885.2, bsz=1024, num_updates=9980, lr=3.96147e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64285
2024-11-10 04:36:35 - progress_bar.py[line:274] - INFO: epoch 026:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17188.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3210.9, ups=0.19, wpb=17188.2, bsz=1024, num_updates=9990, lr=3.96011e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64338
2024-11-10 04:37:28 - progress_bar.py[line:274] - INFO: epoch 026:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17211.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3243.3, ups=0.19, wpb=17211.1, bsz=1024, num_updates=10000, lr=3.95875e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64391
loss_reg: 0.009822808291323596 loss_cls: 0.0033296167384833097
loss_reg: 0.00867657489102018 loss_cls: 0.0032067280262708664
loss_reg: 0.007733135735690776 loss_cls: 0.0034756918903440237
loss_reg: 0.009901386391750169 loss_cls: 0.002948208712041378
loss_reg: 0.008209256214838073 loss_cls: 0.0034864097833633423
loss_reg: 0.009340972660795085 loss_cls: 0.0028520559426397085
loss_reg: 0.0067353034829477024 loss_cls: 0.003145115915685892
loss_reg: 0.007955821907438689 loss_cls: 0.005597522482275963
loss_reg: 0.005830149167895099 loss_cls: 0.0039893402718007565
loss_reg: 0.005259177633906374 loss_cls: 0.0036831905599683523
loss_reg: 0.006801455672570752 loss_cls: 0.0041001467034220695
loss_reg: 0.005962930261076733 loss_cls: 0.0042387028224766254
loss_reg: 0.005487182077800587 loss_cls: 0.003931311424821615
loss_reg: 0.006928170145781904 loss_cls: 0.004105483181774616
loss_reg: 0.009916431150504466 loss_cls: 0.0038136583752930164
loss_reg: 0.00817351504945216 loss_cls: 0.0033052617218345404
loss_reg: 0.007090120905845855 loss_cls: 0.0032575747463852167
loss_reg: 0.008734739004039184 loss_cls: 0.004135492257773876
loss_reg: 0.011317166665144922 loss_cls: 0.004154261667281389
loss_reg: 0.010309907407920068 loss_cls: 0.003215258475393057
loss_reg: 0.007897084673477666 loss_cls: 0.0028502342756837606
loss_reg: 0.007358352739374914 loss_cls: 0.004016929306089878
loss_reg: 0.006675471407303706 loss_cls: 0.00363609055057168
loss_reg: 0.005459943743182085 loss_cls: 0.003765641711652279
loss_reg: 0.010836010453524524 loss_cls: 0.0039476798847317696
loss_reg: 0.007489857238587283 loss_cls: 0.0035892906598746777
loss_reg: 0.006500449813515043 loss_cls: 0.003561635734513402
loss_reg: 0.006514787838782951 loss_cls: 0.0030295890755951405
loss_reg: 0.007170195113025471 loss_cls: 0.003493800526484847
loss_reg: 0.00889817718763203 loss_cls: 0.004134232643991709
loss_reg: 0.009003876337651404 loss_cls: 0.003306001890450716
loss_reg: 0.01016655914875754 loss_cls: 0.0039428952150046825
loss_reg: 0.007837540422147462 loss_cls: 0.0030111433006823063
loss_reg: 0.008920197418184627 loss_cls: 0.003618623362854123
loss_reg: 0.009644906607505513 loss_cls: 0.003233347088098526
loss_reg: 0.009296589800448774 loss_cls: 0.003216073615476489
loss_reg: 0.007621900725997552 loss_cls: 0.003437928855419159
loss_reg: 0.008003058462552667 loss_cls: 0.003634428372606635
loss_reg: 0.007079609649641924 loss_cls: 0.0038582009728997946
loss_reg: 0.008126231649126878 loss_cls: 0.003515480784699321
loss_reg: 0.007492643164571618 loss_cls: 0.003007899969816208
loss_reg: 0.009191614692600962 loss_cls: 0.0038641479332000017
loss_reg: 0.00970889662235632 loss_cls: 0.004237361717969179
loss_reg: 0.007648038542298841 loss_cls: 0.004100861493498087
loss_reg: 0.008297821363346615 loss_cls: 0.003156848018988967
loss_reg: 0.008590682591151387 loss_cls: 0.002810485428199172
loss_reg: 0.008534320088186626 loss_cls: 0.004390588495880365
loss_reg: 0.005709885920047358 loss_cls: 0.003950908314436674
loss_reg: 0.009353178701138677 loss_cls: 0.004000027198344469
loss_reg: 0.006460316500528781 loss_cls: 0.003274948336184025
loss_reg: 0.00833073619905316 loss_cls: 0.003976170439273119
loss_reg: 0.009607429236064478 loss_cls: 0.003387740347534418
loss_reg: 0.008260726492217272 loss_cls: 0.003539523808285594
loss_reg: 0.006816448533223973 loss_cls: 0.003285248763859272
loss_reg: 0.008567124671102912 loss_cls: 0.0036946027539670467
loss_reg: 0.006993221433181748 loss_cls: 0.0032209125347435474
loss_reg: 0.007895889274409023 loss_cls: 0.002996687078848481
loss_reg: 0.006168500468707793 loss_cls: 0.0038937588687986135
loss_reg: 0.008441971674917136 loss_cls: 0.0032041945960372686
loss_reg: 0.006647615511523805 loss_cls: 0.003331743413582444
loss_reg: 0.009002467711137212 loss_cls: 0.0033773784525692463
loss_reg: 0.009221434926896926 loss_cls: 0.003783784806728363
loss_reg: 0.004654247178339203 loss_cls: 0.00424801092594862
loss_reg: 0.0077335279912523905 loss_cls: 0.0035001749638468027
2024-11-10 04:38:22 - progress_bar.py[line:274] - INFO: epoch 026:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17250, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3238.3, ups=0.19, wpb=17250, bsz=1024, num_updates=10010, lr=3.95739e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64445
2024-11-10 04:39:15 - progress_bar.py[line:274] - INFO: epoch 026:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.957, ntokens=17371.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3231.6, ups=0.19, wpb=17371.9, bsz=1024, num_updates=10020, lr=3.95603e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64498
2024-11-10 04:40:09 - progress_bar.py[line:274] - INFO: epoch 026:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17144.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3201.3, ups=0.19, wpb=17144.4, bsz=1024, num_updates=10030, lr=3.95467e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64552
2024-11-10 04:41:02 - progress_bar.py[line:274] - INFO: epoch 026:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17065, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3214.3, ups=0.19, wpb=17065, bsz=1024, num_updates=10040, lr=3.95331e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=64605
2024-11-10 04:41:55 - progress_bar.py[line:274] - INFO: epoch 026:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17242.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3233.6, ups=0.19, wpb=17242.5, bsz=1024, num_updates=10050, lr=3.95195e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=64658
2024-11-10 04:42:49 - progress_bar.py[line:274] - INFO: epoch 026:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17357.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3253.1, ups=0.19, wpb=17357.7, bsz=1024, num_updates=10060, lr=3.95059e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64712
2024-11-10 04:43:42 - progress_bar.py[line:274] - INFO: epoch 026:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17382.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3255.7, ups=0.19, wpb=17382.5, bsz=1024, num_updates=10070, lr=3.94923e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64765
2024-11-10 04:44:36 - progress_bar.py[line:274] - INFO: epoch 026:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17208.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3211.2, ups=0.19, wpb=17208.9, bsz=1024, num_updates=10080, lr=3.94787e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=64819
2024-11-10 04:45:30 - progress_bar.py[line:274] - INFO: epoch 026:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=16956.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3146.1, ups=0.19, wpb=16956.1, bsz=1024, num_updates=10090, lr=3.94651e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=64873
2024-11-10 04:46:24 - progress_bar.py[line:274] - INFO: epoch 026:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17270.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3194, ups=0.18, wpb=17270.3, bsz=1024, num_updates=10100, lr=3.94515e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=64927
2024-11-10 04:47:17 - progress_bar.py[line:274] - INFO: epoch 026:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17113.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3204.4, ups=0.19, wpb=17113.7, bsz=1024, num_updates=10110, lr=3.94379e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=64980
2024-11-10 04:48:11 - progress_bar.py[line:274] - INFO: epoch 026:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17247.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3202, ups=0.19, wpb=17247.7, bsz=1024, num_updates=10120, lr=3.94243e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=65034
2024-11-10 04:49:05 - progress_bar.py[line:274] - INFO: epoch 026:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17417.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3235.3, ups=0.19, wpb=17417.3, bsz=1024, num_updates=10130, lr=3.94107e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=65088
2024-11-10 04:49:57 - progress_bar.py[line:274] - INFO: epoch 026:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17244.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3275.2, ups=0.19, wpb=17244.4, bsz=1024, num_updates=10140, lr=3.93971e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=65140
2024-11-10 04:50:49 - progress_bar.py[line:274] - INFO: epoch 026:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17227.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3347.3, ups=0.19, wpb=17227.9, bsz=1024, num_updates=10150, lr=3.93835e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=65192
2024-11-10 04:51:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 26 @ 10158 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-10 04:51:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 04:53:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-10 04:55:09 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 26 @ 10158 updates, score 0) (writing took 222.74893135100137 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
2024-11-10 04:56:04 - train.py[line:336] - INFO: end of epoch 26 (average epoch stats below)
2024-11-10 04:56:04 - progress_bar.py[line:282] - INFO: epoch 026 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.948 | ntokens 17178.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.72 | wps 2653.6 | ups 0.15 | wpb 17178.6 | bsz 1023 | num_updates 10158 | lr 3.93726e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.3 | wall 65507
2024-11-10 04:56:04 - trainer.py[line:639] - INFO: loading train data for epoch 27
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 04:58:46 - trainer.py[line:703] - INFO: begin training epoch 27
2024-11-10 04:58:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 04:58:59 - progress_bar.py[line:274] - INFO: epoch 027:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=16450.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=335.9, ups=0.02, wpb=16450.2, bsz=985.6, num_updates=10160, lr=3.93699e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.4, wall=65682
2024-11-10 04:59:52 - progress_bar.py[line:274] - INFO: epoch 027:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17151.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3216.5, ups=0.19, wpb=17151.2, bsz=1024, num_updates=10170, lr=3.93563e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=65735
2024-11-10 05:00:45 - progress_bar.py[line:274] - INFO: epoch 027:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.986, ntokens=17507.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3280.1, ups=0.19, wpb=17507.3, bsz=1024, num_updates=10180, lr=3.93427e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=65788
2024-11-10 05:01:39 - progress_bar.py[line:274] - INFO: epoch 027:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17185.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3195.9, ups=0.19, wpb=17185.5, bsz=1024, num_updates=10190, lr=3.93291e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=65842
2024-11-10 05:02:32 - progress_bar.py[line:274] - INFO: epoch 027:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17169.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3257, ups=0.19, wpb=17169.6, bsz=1024, num_updates=10200, lr=3.93154e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=65895
2024-11-10 05:03:25 - progress_bar.py[line:274] - INFO: epoch 027:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17145.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3218.1, ups=0.19, wpb=17145.3, bsz=1024, num_updates=10210, lr=3.93018e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=65948
2024-11-10 05:04:19 - progress_bar.py[line:274] - INFO: epoch 027:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17180.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3206.4, ups=0.19, wpb=17180.5, bsz=1024, num_updates=10220, lr=3.92882e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=66002
2024-11-10 05:05:12 - progress_bar.py[line:274] - INFO: epoch 027:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17101.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3185.9, ups=0.19, wpb=17101.6, bsz=1024, num_updates=10230, lr=3.92746e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=66055
2024-11-10 05:06:06 - progress_bar.py[line:274] - INFO: epoch 027:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17230, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3234, ups=0.19, wpb=17230, bsz=1024, num_updates=10240, lr=3.9261e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=66109
2024-11-10 05:06:59 - progress_bar.py[line:274] - INFO: epoch 027:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17141.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3236.9, ups=0.19, wpb=17141.5, bsz=1024, num_updates=10250, lr=3.92474e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=66162
2024-11-10 05:07:52 - progress_bar.py[line:274] - INFO: epoch 027:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17226.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3252.8, ups=0.19, wpb=17226.4, bsz=1024, num_updates=10260, lr=3.92338e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=66215
2024-11-10 05:08:45 - progress_bar.py[line:274] - INFO: epoch 027:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17232.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3206.5, ups=0.19, wpb=17232.8, bsz=1024, num_updates=10270, lr=3.92202e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=66268
2024-11-10 05:09:39 - progress_bar.py[line:274] - INFO: epoch 027:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17210, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3229, ups=0.19, wpb=17210, bsz=1024, num_updates=10280, lr=3.92066e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=66322
2024-11-10 05:10:32 - progress_bar.py[line:274] - INFO: epoch 027:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17306, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3226.7, ups=0.19, wpb=17306, bsz=1024, num_updates=10290, lr=3.9193e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=66375
2024-11-10 05:10:37 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 05:11:33 - progress_bar.py[line:274] - INFO: epoch 027:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.938, ntokens=17151.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=2808.4, ups=0.16, wpb=17151.1, bsz=1024, num_updates=10300, lr=3.91794e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=34, gb_free=13.2, wall=66436
2024-11-10 05:12:27 - progress_bar.py[line:274] - INFO: epoch 027:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.939, ntokens=17406.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3250.3, ups=0.19, wpb=17406.7, bsz=1024, num_updates=10310, lr=3.91658e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=66490
2024-11-10 05:13:21 - progress_bar.py[line:274] - INFO: epoch 027:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17161.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3153.9, ups=0.18, wpb=17161.3, bsz=1024, num_updates=10320, lr=3.91522e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=66544
2024-11-10 05:14:15 - progress_bar.py[line:274] - INFO: epoch 027:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=16976.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3160.3, ups=0.19, wpb=16976.4, bsz=1024, num_updates=10330, lr=3.91386e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=66598
2024-11-10 05:15:09 - progress_bar.py[line:274] - INFO: epoch 027:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17327, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3221.6, ups=0.19, wpb=17327, bsz=1024, num_updates=10340, lr=3.9125e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=66652
2024-11-10 05:16:02 - progress_bar.py[line:274] - INFO: epoch 027:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17101.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3230.9, ups=0.19, wpb=17101.9, bsz=1024, num_updates=10350, lr=3.91114e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=66705
2024-11-10 05:16:55 - progress_bar.py[line:274] - INFO: epoch 027:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17319.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3230.4, ups=0.19, wpb=17319.8, bsz=1024, num_updates=10360, lr=3.90978e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=66758
2024-11-10 05:17:49 - progress_bar.py[line:274] - INFO: epoch 027:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=16934.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3179.9, ups=0.19, wpb=16934.7, bsz=1024, num_updates=10370, lr=3.90842e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=66812
2024-11-10 05:18:42 - progress_bar.py[line:274] - INFO: epoch 027:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=16956.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3189.5, ups=0.19, wpb=16956.4, bsz=1024, num_updates=10380, lr=3.90706e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=66865
2024-11-10 05:19:35 - progress_bar.py[line:274] - INFO: epoch 027:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17191.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3211.3, ups=0.19, wpb=17191.2, bsz=1024, num_updates=10390, lr=3.9057e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=66918
2024-11-10 05:20:29 - progress_bar.py[line:274] - INFO: epoch 027:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17053.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3157.8, ups=0.19, wpb=17053.4, bsz=1024, num_updates=10400, lr=3.90434e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=66972
2024-11-10 05:21:23 - progress_bar.py[line:274] - INFO: epoch 027:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3222.1, ups=0.19, wpb=17298.6, bsz=1024, num_updates=10410, lr=3.90298e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=67026
2024-11-10 05:22:17 - progress_bar.py[line:274] - INFO: epoch 027:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17168.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3153.7, ups=0.18, wpb=17168.9, bsz=1024, num_updates=10420, lr=3.90162e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67080
2024-11-10 05:23:11 - progress_bar.py[line:274] - INFO: epoch 027:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17084, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3208.8, ups=0.19, wpb=17084, bsz=1024, num_updates=10430, lr=3.90026e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67134
2024-11-10 05:24:04 - progress_bar.py[line:274] - INFO: epoch 027:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17163.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3215, ups=0.19, wpb=17163.9, bsz=1024, num_updates=10440, lr=3.8989e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=67187
2024-11-10 05:24:58 - progress_bar.py[line:274] - INFO: epoch 027:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17060.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3186.4, ups=0.19, wpb=17060.7, bsz=1024, num_updates=10450, lr=3.89753e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67241
2024-11-10 05:25:51 - progress_bar.py[line:274] - INFO: epoch 027:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17141.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3192.7, ups=0.19, wpb=17141.6, bsz=1024, num_updates=10460, lr=3.89617e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=67294
2024-11-10 05:26:45 - progress_bar.py[line:274] - INFO: epoch 027:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17065.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3183.1, ups=0.19, wpb=17065.4, bsz=1024, num_updates=10470, lr=3.89481e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=67348
2024-11-10 05:27:39 - progress_bar.py[line:274] - INFO: epoch 027:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17040.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3180.6, ups=0.19, wpb=17040.6, bsz=1024, num_updates=10480, lr=3.89345e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67401
2024-11-10 05:28:32 - progress_bar.py[line:274] - INFO: epoch 027:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17249, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3227.9, ups=0.19, wpb=17249, bsz=1024, num_updates=10490, lr=3.89209e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67455
2024-11-10 05:29:26 - progress_bar.py[line:274] - INFO: epoch 027:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17140.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3174.8, ups=0.19, wpb=17140.9, bsz=1024, num_updates=10500, lr=3.89073e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=67509
2024-11-10 05:30:20 - progress_bar.py[line:274] - INFO: epoch 027:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17292.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3216.9, ups=0.19, wpb=17292.1, bsz=1024, num_updates=10510, lr=3.88937e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67563
2024-11-10 05:31:13 - progress_bar.py[line:274] - INFO: epoch 027:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17259.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3240.5, ups=0.19, wpb=17259.9, bsz=1024, num_updates=10520, lr=3.88801e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=67616
2024-11-10 05:32:06 - progress_bar.py[line:274] - INFO: epoch 027:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17344.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3289, ups=0.19, wpb=17344.6, bsz=1024, num_updates=10530, lr=3.88665e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=67669
2024-11-10 05:32:58 - progress_bar.py[line:274] - INFO: epoch 027:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17063, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3291.6, ups=0.19, wpb=17063, bsz=1024, num_updates=10540, lr=3.88529e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=67720
2024-11-10 05:33:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 27 @ 10548 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
2024-11-10 05:33:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 05:35:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 05:37:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 27 @ 10548 updates, score 0) (writing took 217.22515636496246 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-10 05:38:07 - train.py[line:336] - INFO: end of epoch 27 (average epoch stats below)
2024-11-10 05:38:07 - progress_bar.py[line:282] - INFO: epoch 027 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.928 | ntokens 17165.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.61 | wps 2653.3 | ups 0.15 | wpb 17165.1 | bsz 1023 | num_updates 10548 | lr 3.8842e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1186 | gb_free 13.1 | wall 68030
2024-11-10 05:38:07 - trainer.py[line:639] - INFO: loading train data for epoch 28
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 05:40:48 - trainer.py[line:703] - INFO: begin training epoch 28
2024-11-10 05:40:48 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 05:41:01 - progress_bar.py[line:274] - INFO: epoch 028:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=16708.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=345.6, ups=0.02, wpb=16708.8, bsz=985.6, num_updates=10550, lr=3.88393e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=29, gb_free=13.3, wall=68204
2024-11-10 05:41:54 - progress_bar.py[line:274] - INFO: epoch 028:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17042.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3189.5, ups=0.19, wpb=17042.3, bsz=1024, num_updates=10560, lr=3.88257e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=68257
2024-11-10 05:42:48 - progress_bar.py[line:274] - INFO: epoch 028:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17684.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3315.9, ups=0.19, wpb=17684.9, bsz=1024, num_updates=10570, lr=3.88121e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=68311
2024-11-10 05:43:41 - progress_bar.py[line:274] - INFO: epoch 028:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=16928.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3174.7, ups=0.19, wpb=16928.6, bsz=1024, num_updates=10580, lr=3.87985e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=68364
2024-11-10 05:44:34 - progress_bar.py[line:274] - INFO: epoch 028:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17239.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3253.8, ups=0.19, wpb=17239.5, bsz=1024, num_updates=10590, lr=3.87849e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=68417
2024-11-10 05:45:28 - progress_bar.py[line:274] - INFO: epoch 028:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17128.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3187.8, ups=0.19, wpb=17128.4, bsz=1024, num_updates=10600, lr=3.87713e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=68471
2024-11-10 05:46:22 - progress_bar.py[line:274] - INFO: epoch 028:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17363.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3225.3, ups=0.19, wpb=17363.7, bsz=1024, num_updates=10610, lr=3.87577e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=68524
2024-11-10 05:47:15 - progress_bar.py[line:274] - INFO: epoch 028:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17173, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3201.4, ups=0.19, wpb=17173, bsz=1024, num_updates=10620, lr=3.87441e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=68578
2024-11-10 05:48:09 - progress_bar.py[line:274] - INFO: epoch 028:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17259.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3215.8, ups=0.19, wpb=17259.8, bsz=1024, num_updates=10630, lr=3.87305e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=68632
2024-11-10 05:49:03 - progress_bar.py[line:274] - INFO: epoch 028:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17072.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3129.6, ups=0.18, wpb=17072.7, bsz=1024, num_updates=10640, lr=3.87169e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=68686
2024-11-10 05:49:58 - progress_bar.py[line:274] - INFO: epoch 028:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17175.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3159.8, ups=0.18, wpb=17175.9, bsz=1024, num_updates=10650, lr=3.87033e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=68741
2024-11-10 05:50:52 - progress_bar.py[line:274] - INFO: epoch 028:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.9, ntokens=16763.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3078.7, ups=0.18, wpb=16763.9, bsz=1024, num_updates=10660, lr=3.86897e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=68795
2024-11-10 05:51:46 - progress_bar.py[line:274] - INFO: epoch 028:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17148.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3218.6, ups=0.19, wpb=17148.9, bsz=1024, num_updates=10670, lr=3.86761e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=68848
2024-11-10 05:52:39 - progress_bar.py[line:274] - INFO: epoch 028:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17463.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3255.7, ups=0.19, wpb=17463.8, bsz=1024, num_updates=10680, lr=3.86625e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=68902
2024-11-10 05:53:33 - progress_bar.py[line:274] - INFO: epoch 028:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17037.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3165.9, ups=0.19, wpb=17037.8, bsz=1024, num_updates=10690, lr=3.86489e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=68956
2024-11-10 05:54:27 - progress_bar.py[line:274] - INFO: epoch 028:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17181, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3184.8, ups=0.19, wpb=17181, bsz=1024, num_updates=10700, lr=3.86353e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69010
2024-11-10 05:55:20 - progress_bar.py[line:274] - INFO: epoch 028:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17166, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3214.3, ups=0.19, wpb=17166, bsz=1024, num_updates=10710, lr=3.86216e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69063
2024-11-10 05:56:14 - progress_bar.py[line:274] - INFO: epoch 028:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17226.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3215.3, ups=0.19, wpb=17226.9, bsz=1024, num_updates=10720, lr=3.8608e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69117
2024-11-10 05:57:08 - progress_bar.py[line:274] - INFO: epoch 028:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17258.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3214.1, ups=0.19, wpb=17258.9, bsz=1024, num_updates=10730, lr=3.85944e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69171
2024-11-10 05:58:01 - progress_bar.py[line:274] - INFO: epoch 028:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17203.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3247.4, ups=0.19, wpb=17203.2, bsz=1024, num_updates=10740, lr=3.85808e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=69224
2024-11-10 05:58:54 - progress_bar.py[line:274] - INFO: epoch 028:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17364.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3234.1, ups=0.19, wpb=17364.4, bsz=1024, num_updates=10750, lr=3.85672e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69277
2024-11-10 05:59:47 - progress_bar.py[line:274] - INFO: epoch 028:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.907, ntokens=16963.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3205.1, ups=0.19, wpb=16963.9, bsz=1024, num_updates=10760, lr=3.85536e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69330
2024-11-10 06:00:40 - progress_bar.py[line:274] - INFO: epoch 028:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17153.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3238, ups=0.19, wpb=17153.9, bsz=1024, num_updates=10770, lr=3.854e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=69383
2024-11-10 06:01:34 - progress_bar.py[line:274] - INFO: epoch 028:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17329.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3221.2, ups=0.19, wpb=17329.9, bsz=1024, num_updates=10780, lr=3.85264e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=69437
2024-11-10 06:02:28 - progress_bar.py[line:274] - INFO: epoch 028:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.94, ntokens=17290.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3227.2, ups=0.19, wpb=17290.4, bsz=1024, num_updates=10790, lr=3.85128e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=69490
2024-11-10 06:03:21 - progress_bar.py[line:274] - INFO: epoch 028:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17234.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3201.8, ups=0.19, wpb=17234.6, bsz=1024, num_updates=10800, lr=3.84992e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.6, wall=69544
2024-11-10 06:04:15 - progress_bar.py[line:274] - INFO: epoch 028:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17258.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3194.9, ups=0.19, wpb=17258.3, bsz=1024, num_updates=10810, lr=3.84856e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=69598
2024-11-10 06:05:09 - progress_bar.py[line:274] - INFO: epoch 028:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17056, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3177.3, ups=0.19, wpb=17056, bsz=1024, num_updates=10820, lr=3.8472e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=69652
2024-11-10 06:06:02 - progress_bar.py[line:274] - INFO: epoch 028:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17102.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3208, ups=0.19, wpb=17102.9, bsz=1024, num_updates=10830, lr=3.84584e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=69705
2024-11-10 06:06:56 - progress_bar.py[line:274] - INFO: epoch 028:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17191.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3218.7, ups=0.19, wpb=17191.8, bsz=1024, num_updates=10840, lr=3.84448e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=69759
2024-11-10 06:07:50 - progress_bar.py[line:274] - INFO: epoch 028:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17078.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3181.4, ups=0.19, wpb=17078.5, bsz=1024, num_updates=10850, lr=3.84312e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=69812
2024-11-10 06:08:43 - progress_bar.py[line:274] - INFO: epoch 028:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17262.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3228.8, ups=0.19, wpb=17262.4, bsz=1024, num_updates=10860, lr=3.84176e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=69866
2024-11-10 06:09:36 - progress_bar.py[line:274] - INFO: epoch 028:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=16915.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3177.5, ups=0.19, wpb=16915.7, bsz=1024, num_updates=10870, lr=3.8404e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=69919
2024-11-10 06:10:30 - progress_bar.py[line:274] - INFO: epoch 028:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17081.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3170.9, ups=0.19, wpb=17081.1, bsz=1024, num_updates=10880, lr=3.83904e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=69973
2024-11-10 06:11:23 - progress_bar.py[line:274] - INFO: epoch 028:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17242.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3240.7, ups=0.19, wpb=17242.4, bsz=1024, num_updates=10890, lr=3.83768e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=70026
2024-11-10 06:12:17 - progress_bar.py[line:274] - INFO: epoch 028:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17146.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3218.7, ups=0.19, wpb=17146.2, bsz=1024, num_updates=10900, lr=3.83632e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=70079
2024-11-10 06:13:10 - progress_bar.py[line:274] - INFO: epoch 028:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17361.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3234, ups=0.19, wpb=17361.1, bsz=1024, num_updates=10910, lr=3.83496e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=70133
2024-11-10 06:14:03 - progress_bar.py[line:274] - INFO: epoch 028:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17056.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3237.5, ups=0.19, wpb=17056.6, bsz=1024, num_updates=10920, lr=3.8336e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=70186
2024-11-10 06:14:55 - progress_bar.py[line:274] - INFO: epoch 028:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.939, ntokens=17406.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3336.6, ups=0.19, wpb=17406.3, bsz=1024, num_updates=10930, lr=3.83224e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=70238
2024-11-10 06:15:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 28 @ 10939 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-10 06:15:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 06:17:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
2024-11-10 06:19:20 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 28 @ 10939 updates, score 0) (writing took 221.2176626949804 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-10 06:20:15 - train.py[line:336] - INFO: end of epoch 28 (average epoch stats below)
2024-11-10 06:20:15 - progress_bar.py[line:282] - INFO: epoch 028 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.918 | ntokens 17166.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.56 | wps 2655.7 | ups 0.15 | wpb 17166.6 | bsz 1023 | num_updates 10939 | lr 3.83101e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1185 | gb_free 13.2 | wall 70557
2024-11-10 06:20:15 - trainer.py[line:639] - INFO: loading train data for epoch 29
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 06:22:57 - trainer.py[line:703] - INFO: begin training epoch 29
2024-11-10 06:22:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 06:23:04 - progress_bar.py[line:274] - INFO: epoch 029:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=16473.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=336.7, ups=0.02, wpb=16473.4, bsz=985.6, num_updates=10940, lr=3.83088e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=70727
2024-11-10 06:23:58 - progress_bar.py[line:274] - INFO: epoch 029:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17259, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3227.3, ups=0.19, wpb=17259, bsz=1024, num_updates=10950, lr=3.82952e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=70781
2024-11-10 06:24:51 - progress_bar.py[line:274] - INFO: epoch 029:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17332.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3254.3, ups=0.19, wpb=17332.4, bsz=1024, num_updates=10960, lr=3.82815e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=70834
2024-11-10 06:25:44 - progress_bar.py[line:274] - INFO: epoch 029:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17087, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3212.3, ups=0.19, wpb=17087, bsz=1024, num_updates=10970, lr=3.82679e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=70887
2024-11-10 06:26:38 - progress_bar.py[line:274] - INFO: epoch 029:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17033.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3181.5, ups=0.19, wpb=17033.2, bsz=1024, num_updates=10980, lr=3.82543e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=70941
2024-11-10 06:27:32 - progress_bar.py[line:274] - INFO: epoch 029:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3235, ups=0.19, wpb=17372.7, bsz=1024, num_updates=10990, lr=3.82407e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=70994
2024-11-10 06:28:25 - progress_bar.py[line:274] - INFO: epoch 029:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17179.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3211.8, ups=0.19, wpb=17179.2, bsz=1024, num_updates=11000, lr=3.82271e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71048
2024-11-10 06:29:19 - progress_bar.py[line:274] - INFO: epoch 029:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=16708.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3118.7, ups=0.19, wpb=16708.9, bsz=1024, num_updates=11010, lr=3.82135e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=71102
2024-11-10 06:30:12 - progress_bar.py[line:274] - INFO: epoch 029:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17364.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3262.2, ups=0.19, wpb=17364.1, bsz=1024, num_updates=11020, lr=3.81999e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=71155
2024-11-10 06:31:05 - progress_bar.py[line:274] - INFO: epoch 029:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17224.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3229.4, ups=0.19, wpb=17224.5, bsz=1024, num_updates=11030, lr=3.81863e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=71208
2024-11-10 06:32:00 - progress_bar.py[line:274] - INFO: epoch 029:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17230.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3155.5, ups=0.18, wpb=17230.9, bsz=1024, num_updates=11040, lr=3.81727e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=71263
2024-11-10 06:32:53 - progress_bar.py[line:274] - INFO: epoch 029:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17061.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3193.2, ups=0.19, wpb=17061.4, bsz=1024, num_updates=11050, lr=3.81591e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=71316
2024-11-10 06:33:47 - progress_bar.py[line:274] - INFO: epoch 029:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17388.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3260.4, ups=0.19, wpb=17388.1, bsz=1024, num_updates=11060, lr=3.81455e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71369
2024-11-10 06:34:40 - progress_bar.py[line:274] - INFO: epoch 029:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17286.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3247.5, ups=0.19, wpb=17286.4, bsz=1024, num_updates=11070, lr=3.81319e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=71423
2024-11-10 06:35:33 - progress_bar.py[line:274] - INFO: epoch 029:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=16989.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3171.9, ups=0.19, wpb=16989.4, bsz=1024, num_updates=11080, lr=3.81183e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=71476
2024-11-10 06:36:27 - progress_bar.py[line:274] - INFO: epoch 029:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17233.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3230.7, ups=0.19, wpb=17233.2, bsz=1024, num_updates=11090, lr=3.81047e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71530
2024-11-10 06:37:20 - progress_bar.py[line:274] - INFO: epoch 029:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17169.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3210.5, ups=0.19, wpb=17169.4, bsz=1024, num_updates=11100, lr=3.80911e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=71583
2024-11-10 06:38:14 - progress_bar.py[line:274] - INFO: epoch 029:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17279.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3200.8, ups=0.19, wpb=17279.7, bsz=1024, num_updates=11110, lr=3.80775e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71637
2024-11-10 06:39:08 - progress_bar.py[line:274] - INFO: epoch 029:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=16910.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3147, ups=0.19, wpb=16910.7, bsz=1024, num_updates=11120, lr=3.80639e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=71691
2024-11-10 06:40:01 - progress_bar.py[line:274] - INFO: epoch 029:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17000.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3182.8, ups=0.19, wpb=17000.9, bsz=1024, num_updates=11130, lr=3.80503e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71744
2024-11-10 06:40:55 - progress_bar.py[line:274] - INFO: epoch 029:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17346.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3204.6, ups=0.18, wpb=17346.2, bsz=1024, num_updates=11140, lr=3.80367e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=71798
2024-11-10 06:41:50 - progress_bar.py[line:274] - INFO: epoch 029:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=16852.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3112.3, ups=0.18, wpb=16852.3, bsz=1024, num_updates=11150, lr=3.80231e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=71852
2024-11-10 06:42:43 - progress_bar.py[line:274] - INFO: epoch 029:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.862, ntokens=16916.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3149.5, ups=0.19, wpb=16916.7, bsz=1024, num_updates=11160, lr=3.80095e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=71906
2024-11-10 06:43:36 - progress_bar.py[line:274] - INFO: epoch 029:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.869, ntokens=16964.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3196.9, ups=0.19, wpb=16964.6, bsz=1024, num_updates=11170, lr=3.79959e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=71959
2024-11-10 06:44:30 - progress_bar.py[line:274] - INFO: epoch 029:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17213.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3206.8, ups=0.19, wpb=17213.7, bsz=1024, num_updates=11180, lr=3.79823e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=72013
2024-11-10 06:45:24 - progress_bar.py[line:274] - INFO: epoch 029:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17443.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3250.2, ups=0.19, wpb=17443.9, bsz=1024, num_updates=11190, lr=3.79687e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=72067
2024-11-10 06:46:17 - progress_bar.py[line:274] - INFO: epoch 029:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17228, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3224.7, ups=0.19, wpb=17228, bsz=1024, num_updates=11200, lr=3.79551e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=72120
2024-11-10 06:47:11 - progress_bar.py[line:274] - INFO: epoch 029:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17213.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3202.2, ups=0.19, wpb=17213.6, bsz=1024, num_updates=11210, lr=3.79414e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=72174
2024-11-10 06:48:05 - progress_bar.py[line:274] - INFO: epoch 029:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17178.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3200.4, ups=0.19, wpb=17178.7, bsz=1024, num_updates=11220, lr=3.79278e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=72227
2024-11-10 06:49:01 - progress_bar.py[line:274] - INFO: epoch 029:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17204.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3068.1, ups=0.18, wpb=17204.7, bsz=1024, num_updates=11230, lr=3.79142e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=72284
2024-11-10 06:49:54 - progress_bar.py[line:274] - INFO: epoch 029:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17198, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3219.7, ups=0.19, wpb=17198, bsz=1024, num_updates=11240, lr=3.79006e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=72337
2024-11-10 06:50:48 - progress_bar.py[line:274] - INFO: epoch 029:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17282.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3220, ups=0.19, wpb=17282.1, bsz=1024, num_updates=11250, lr=3.7887e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=72391
2024-11-10 06:51:41 - progress_bar.py[line:274] - INFO: epoch 029:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17212.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3237.5, ups=0.19, wpb=17212.9, bsz=1024, num_updates=11260, lr=3.78734e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=72444
2024-11-10 06:52:35 - progress_bar.py[line:274] - INFO: epoch 029:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17276, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3220.6, ups=0.19, wpb=17276, bsz=1024, num_updates=11270, lr=3.78598e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=72497
2024-11-10 06:53:28 - progress_bar.py[line:274] - INFO: epoch 029:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17085.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3203.2, ups=0.19, wpb=17085.9, bsz=1024, num_updates=11280, lr=3.78462e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=72551
2024-11-10 06:54:22 - progress_bar.py[line:274] - INFO: epoch 029:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17351.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3211.7, ups=0.19, wpb=17351.3, bsz=1024, num_updates=11290, lr=3.78326e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=72605
2024-11-10 06:55:15 - progress_bar.py[line:274] - INFO: epoch 029:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=16934.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3177.1, ups=0.19, wpb=16934.2, bsz=1024, num_updates=11300, lr=3.7819e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=72658
2024-11-10 06:56:08 - progress_bar.py[line:274] - INFO: epoch 029:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17439.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3272.1, ups=0.19, wpb=17439.1, bsz=1024, num_updates=11310, lr=3.78054e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=72711
2024-11-10 06:57:00 - progress_bar.py[line:274] - INFO: epoch 029:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17314.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3345.3, ups=0.19, wpb=17314.4, bsz=1024, num_updates=11320, lr=3.77918e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=12.9, wall=72763
2024-11-10 06:57:49 - progress_bar.py[line:274] - INFO: epoch 029:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=16613.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3419.3, ups=0.21, wpb=16613.6, bsz=985.6, num_updates=11330, lr=3.77782e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=29, gb_free=13.3, wall=72812
2024-11-10 06:57:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 29 @ 11330 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
2024-11-10 06:57:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 06:59:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 07:01:32 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 29 @ 11330 updates, score 0) (writing took 223.41376854700502 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-10 07:02:27 - train.py[line:336] - INFO: end of epoch 29 (average epoch stats below)
2024-11-10 07:02:27 - progress_bar.py[line:282] - INFO: epoch 029 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.904 | ntokens 17164.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.48 | wps 2650.4 | ups 0.15 | wpb 17164.7 | bsz 1023 | num_updates 11330 | lr 3.77782e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1185 | gb_free 13.3 | wall 73090
2024-11-10 07:02:27 - trainer.py[line:639] - INFO: loading train data for epoch 30
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 07:05:08 - trainer.py[line:703] - INFO: begin training epoch 30
2024-11-10 07:05:08 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 07:06:03 - progress_bar.py[line:274] - INFO: epoch 030:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17356.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=351.1, ups=0.02, wpb=17356.9, bsz=1024, num_updates=11340, lr=3.77646e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73306
2024-11-10 07:06:56 - progress_bar.py[line:274] - INFO: epoch 030:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17369, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3266.8, ups=0.19, wpb=17369, bsz=1024, num_updates=11350, lr=3.7751e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73359
2024-11-10 07:07:50 - progress_bar.py[line:274] - INFO: epoch 030:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.9, ntokens=17280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3228.1, ups=0.19, wpb=17280.7, bsz=1024, num_updates=11360, lr=3.77374e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=73413
2024-11-10 07:08:43 - progress_bar.py[line:274] - INFO: epoch 030:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17307.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3240.4, ups=0.19, wpb=17307.3, bsz=1024, num_updates=11370, lr=3.77238e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=73466
2024-11-10 07:09:36 - progress_bar.py[line:274] - INFO: epoch 030:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17231, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3276.9, ups=0.19, wpb=17231, bsz=1024, num_updates=11380, lr=3.77102e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73519
2024-11-10 07:10:30 - progress_bar.py[line:274] - INFO: epoch 030:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17158.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3181.9, ups=0.19, wpb=17158.5, bsz=1024, num_updates=11390, lr=3.76966e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=73573
2024-11-10 07:11:23 - progress_bar.py[line:274] - INFO: epoch 030:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=16944.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3164.7, ups=0.19, wpb=16944.1, bsz=1024, num_updates=11400, lr=3.7683e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73626
2024-11-10 07:12:17 - progress_bar.py[line:274] - INFO: epoch 030:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17455.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3250, ups=0.19, wpb=17455.4, bsz=1024, num_updates=11410, lr=3.76694e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73680
2024-11-10 07:13:11 - progress_bar.py[line:274] - INFO: epoch 030:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.929, ntokens=17490.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3266.7, ups=0.19, wpb=17490.3, bsz=1024, num_updates=11420, lr=3.76558e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=73734
2024-11-10 07:14:04 - progress_bar.py[line:274] - INFO: epoch 030:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=17169.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3190.6, ups=0.19, wpb=17169.8, bsz=1024, num_updates=11430, lr=3.76422e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=73787
2024-11-10 07:14:58 - progress_bar.py[line:274] - INFO: epoch 030:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17029.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3190.4, ups=0.19, wpb=17029.7, bsz=1024, num_updates=11440, lr=3.76286e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=73841
2024-11-10 07:15:51 - progress_bar.py[line:274] - INFO: epoch 030:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17157.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3221.5, ups=0.19, wpb=17157.8, bsz=1024, num_updates=11450, lr=3.7615e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=73894
2024-11-10 07:16:44 - progress_bar.py[line:274] - INFO: epoch 030:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17250.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3251, ups=0.19, wpb=17250.7, bsz=1024, num_updates=11460, lr=3.76013e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=73947
2024-11-10 07:16:49 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 07:17:43 - progress_bar.py[line:274] - INFO: epoch 030:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=16980.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=2873.7, ups=0.17, wpb=16980.7, bsz=1024, num_updates=11470, lr=3.75877e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=74006
2024-11-10 07:18:37 - progress_bar.py[line:274] - INFO: epoch 030:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=17192.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3190.8, ups=0.19, wpb=17192.4, bsz=1024, num_updates=11480, lr=3.75741e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=74060
2024-11-10 07:19:31 - progress_bar.py[line:274] - INFO: epoch 030:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17173.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3209.2, ups=0.19, wpb=17173.2, bsz=1024, num_updates=11490, lr=3.75605e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74114
2024-11-10 07:20:24 - progress_bar.py[line:274] - INFO: epoch 030:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=16959.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3187.2, ups=0.19, wpb=16959.7, bsz=1024, num_updates=11500, lr=3.75469e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=74167
2024-11-10 07:21:17 - progress_bar.py[line:274] - INFO: epoch 030:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17274.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3246.8, ups=0.19, wpb=17274.1, bsz=1024, num_updates=11510, lr=3.75333e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=74220
2024-11-10 07:22:11 - progress_bar.py[line:274] - INFO: epoch 030:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17069.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3178.9, ups=0.19, wpb=17069.9, bsz=1024, num_updates=11520, lr=3.75197e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=74274
2024-11-10 07:23:04 - progress_bar.py[line:274] - INFO: epoch 030:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17377.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3272.9, ups=0.19, wpb=17377.5, bsz=1024, num_updates=11530, lr=3.75061e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=74327
2024-11-10 07:23:57 - progress_bar.py[line:274] - INFO: epoch 030:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=17060.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3213.6, ups=0.19, wpb=17060.3, bsz=1024, num_updates=11540, lr=3.74925e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=74380
2024-11-10 07:24:51 - progress_bar.py[line:274] - INFO: epoch 030:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17101.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3176.4, ups=0.19, wpb=17101.8, bsz=1024, num_updates=11550, lr=3.74789e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=74434
2024-11-10 07:25:44 - progress_bar.py[line:274] - INFO: epoch 030:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17338.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3238.8, ups=0.19, wpb=17338.5, bsz=1024, num_updates=11560, lr=3.74653e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=74487
2024-11-10 07:26:38 - progress_bar.py[line:274] - INFO: epoch 030:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=17296.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3235.6, ups=0.19, wpb=17296.4, bsz=1024, num_updates=11570, lr=3.74517e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=74541
2024-11-10 07:27:31 - progress_bar.py[line:274] - INFO: epoch 030:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17484.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3277.7, ups=0.19, wpb=17484.1, bsz=1024, num_updates=11580, lr=3.74381e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=74594
2024-11-10 07:28:25 - progress_bar.py[line:274] - INFO: epoch 030:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17174.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3203.9, ups=0.19, wpb=17174.5, bsz=1024, num_updates=11590, lr=3.74245e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=74648
2024-11-10 07:29:18 - progress_bar.py[line:274] - INFO: epoch 030:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.873, ntokens=17131.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3216.7, ups=0.19, wpb=17131.2, bsz=1024, num_updates=11600, lr=3.74109e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=74701
2024-11-10 07:30:12 - progress_bar.py[line:274] - INFO: epoch 030:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17155.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3176.6, ups=0.19, wpb=17155.9, bsz=1024, num_updates=11610, lr=3.73973e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=74755
2024-11-10 07:31:06 - progress_bar.py[line:274] - INFO: epoch 030:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17279, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3220.4, ups=0.19, wpb=17279, bsz=1024, num_updates=11620, lr=3.73837e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=74809
2024-11-10 07:31:58 - progress_bar.py[line:274] - INFO: epoch 030:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17135, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3246.5, ups=0.19, wpb=17135, bsz=1024, num_updates=11630, lr=3.73701e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=74861
2024-11-10 07:32:52 - progress_bar.py[line:274] - INFO: epoch 030:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17339.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3243.9, ups=0.19, wpb=17339.4, bsz=1024, num_updates=11640, lr=3.73565e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=74915
2024-11-10 07:33:45 - progress_bar.py[line:274] - INFO: epoch 030:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17246.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3225, ups=0.19, wpb=17246.8, bsz=1024, num_updates=11650, lr=3.73429e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=74968
2024-11-10 07:34:39 - progress_bar.py[line:274] - INFO: epoch 030:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17146.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3192.9, ups=0.19, wpb=17146.2, bsz=1024, num_updates=11660, lr=3.73293e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.6, wall=75022
2024-11-10 07:35:33 - progress_bar.py[line:274] - INFO: epoch 030:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=16985, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3176.9, ups=0.19, wpb=16985, bsz=1024, num_updates=11670, lr=3.73157e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75075
2024-11-10 07:36:26 - progress_bar.py[line:274] - INFO: epoch 030:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17151.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3238.6, ups=0.19, wpb=17151.5, bsz=1024, num_updates=11680, lr=3.73021e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=75128
2024-11-10 07:37:19 - progress_bar.py[line:274] - INFO: epoch 030:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17247.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3240.6, ups=0.19, wpb=17247.7, bsz=1024, num_updates=11690, lr=3.72885e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75182
2024-11-10 07:38:11 - progress_bar.py[line:274] - INFO: epoch 030:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17336.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3299.9, ups=0.19, wpb=17336.4, bsz=1024, num_updates=11700, lr=3.72749e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=75234
2024-11-10 07:39:03 - progress_bar.py[line:274] - INFO: epoch 030:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17247.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3364.3, ups=0.2, wpb=17247.5, bsz=1024, num_updates=11710, lr=3.72613e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=75285
2024-11-10 07:39:51 - progress_bar.py[line:274] - INFO: epoch 030:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=16581.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3447, ups=0.21, wpb=16581.2, bsz=985.6, num_updates=11720, lr=3.72476e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=75334
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-10 07:39:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 30 @ 11720 updates
2024-11-10 07:39:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 07:41:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
2024-11-10 07:43:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 30 @ 11720 updates, score 0) (writing took 222.24623726599384 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-10 07:44:28 - train.py[line:336] - INFO: end of epoch 30 (average epoch stats below)
2024-11-10 07:44:28 - progress_bar.py[line:282] - INFO: epoch 030 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.893 | ntokens 17196.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.43 | wps 2660.1 | ups 0.15 | wpb 17196.6 | bsz 1023 | num_updates 11720 | lr 3.72476e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1186 | gb_free 13.2 | wall 75611
2024-11-10 07:44:28 - trainer.py[line:639] - INFO: loading train data for epoch 31
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 07:47:10 - trainer.py[line:703] - INFO: begin training epoch 31
2024-11-10 07:47:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 07:48:06 - progress_bar.py[line:274] - INFO: epoch 031:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17310.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=349.5, ups=0.02, wpb=17310.2, bsz=1024, num_updates=11730, lr=3.7234e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75829
2024-11-10 07:48:59 - progress_bar.py[line:274] - INFO: epoch 031:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17012.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3181.5, ups=0.19, wpb=17012.1, bsz=1024, num_updates=11740, lr=3.72204e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75882
2024-11-10 07:49:53 - progress_bar.py[line:274] - INFO: epoch 031:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17213.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3237, ups=0.19, wpb=17213.8, bsz=1024, num_updates=11750, lr=3.72068e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=75936
2024-11-10 07:50:47 - progress_bar.py[line:274] - INFO: epoch 031:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17257.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3200.6, ups=0.19, wpb=17257.4, bsz=1024, num_updates=11760, lr=3.71932e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=75989
2024-11-10 07:51:41 - progress_bar.py[line:274] - INFO: epoch 031:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17138.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3148.6, ups=0.18, wpb=17138.1, bsz=1024, num_updates=11770, lr=3.71796e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=76044
2024-11-10 07:52:34 - progress_bar.py[line:274] - INFO: epoch 031:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17126.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3200.4, ups=0.19, wpb=17126.4, bsz=1024, num_updates=11780, lr=3.7166e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=76097
2024-11-10 07:53:28 - progress_bar.py[line:274] - INFO: epoch 031:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=16763.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3145.7, ups=0.19, wpb=16763.9, bsz=1024, num_updates=11790, lr=3.71524e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=76151
2024-11-10 07:54:21 - progress_bar.py[line:274] - INFO: epoch 031:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17207.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3217.4, ups=0.19, wpb=17207.4, bsz=1024, num_updates=11800, lr=3.71388e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=76204
2024-11-10 07:55:18 - progress_bar.py[line:274] - INFO: epoch 031:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17218.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3050.8, ups=0.18, wpb=17218.2, bsz=1024, num_updates=11810, lr=3.71252e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=76261
2024-11-10 07:56:12 - progress_bar.py[line:274] - INFO: epoch 031:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17305.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3193.2, ups=0.18, wpb=17305.7, bsz=1024, num_updates=11820, lr=3.71116e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76315
2024-11-10 07:57:06 - progress_bar.py[line:274] - INFO: epoch 031:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17121, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3173.7, ups=0.19, wpb=17121, bsz=1024, num_updates=11830, lr=3.7098e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76369
2024-11-10 07:58:00 - progress_bar.py[line:274] - INFO: epoch 031:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.962, ntokens=17468.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3230.6, ups=0.18, wpb=17468.1, bsz=1024, num_updates=11840, lr=3.70844e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=76423
2024-11-10 07:58:54 - progress_bar.py[line:274] - INFO: epoch 031:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17237.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3199.7, ups=0.19, wpb=17237.4, bsz=1024, num_updates=11850, lr=3.70708e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=76477
2024-11-10 07:59:47 - progress_bar.py[line:274] - INFO: epoch 031:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3204.4, ups=0.19, wpb=17104.2, bsz=1024, num_updates=11860, lr=3.70572e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=76530
2024-11-10 08:00:40 - progress_bar.py[line:274] - INFO: epoch 031:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17107.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3208.1, ups=0.19, wpb=17107.8, bsz=1024, num_updates=11870, lr=3.70436e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76583
2024-11-10 08:01:34 - progress_bar.py[line:274] - INFO: epoch 031:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17204.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3196.7, ups=0.19, wpb=17204.4, bsz=1024, num_updates=11880, lr=3.703e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=76637
2024-11-10 08:02:29 - progress_bar.py[line:274] - INFO: epoch 031:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17347, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3189.8, ups=0.18, wpb=17347, bsz=1024, num_updates=11890, lr=3.70164e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76692
2024-11-10 08:03:23 - progress_bar.py[line:274] - INFO: epoch 031:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17255, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3204.8, ups=0.19, wpb=17255, bsz=1024, num_updates=11900, lr=3.70028e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=76745
2024-11-10 08:04:16 - progress_bar.py[line:274] - INFO: epoch 031:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17148, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3199.9, ups=0.19, wpb=17148, bsz=1024, num_updates=11910, lr=3.69892e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=76799
2024-11-10 08:05:10 - progress_bar.py[line:274] - INFO: epoch 031:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17318.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3221.6, ups=0.19, wpb=17318.9, bsz=1024, num_updates=11920, lr=3.69756e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=76853
2024-11-10 08:06:03 - progress_bar.py[line:274] - INFO: epoch 031:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17169.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3211.2, ups=0.19, wpb=17169.2, bsz=1024, num_updates=11930, lr=3.6962e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=76906
2024-11-10 08:06:56 - progress_bar.py[line:274] - INFO: epoch 031:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17069.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3212.1, ups=0.19, wpb=17069.1, bsz=1024, num_updates=11940, lr=3.69484e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=76959
2024-11-10 08:07:50 - progress_bar.py[line:274] - INFO: epoch 031:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17062.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3168.7, ups=0.19, wpb=17062.5, bsz=1024, num_updates=11950, lr=3.69348e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=77013
2024-11-10 08:08:45 - progress_bar.py[line:274] - INFO: epoch 031:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17167.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3157.2, ups=0.18, wpb=17167.7, bsz=1024, num_updates=11960, lr=3.69212e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=77068
2024-11-10 08:09:39 - progress_bar.py[line:274] - INFO: epoch 031:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17364.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3183.2, ups=0.18, wpb=17364.8, bsz=1024, num_updates=11970, lr=3.69075e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=77122
2024-11-10 08:10:33 - progress_bar.py[line:274] - INFO: epoch 031:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=17140.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3214.9, ups=0.19, wpb=17140.5, bsz=1024, num_updates=11980, lr=3.68939e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=77175
2024-11-10 08:11:26 - progress_bar.py[line:274] - INFO: epoch 031:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17194.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3201.9, ups=0.19, wpb=17194.6, bsz=1024, num_updates=11990, lr=3.68803e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77229
2024-11-10 08:12:20 - progress_bar.py[line:274] - INFO: epoch 031:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17158.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3178.3, ups=0.19, wpb=17158.2, bsz=1024, num_updates=12000, lr=3.68667e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77283
2024-11-10 08:13:14 - progress_bar.py[line:274] - INFO: epoch 031:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17050.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3173.3, ups=0.19, wpb=17050.4, bsz=1024, num_updates=12010, lr=3.68531e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=12.8, wall=77337
2024-11-10 08:14:08 - progress_bar.py[line:274] - INFO: epoch 031:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17180, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3189.6, ups=0.19, wpb=17180, bsz=1024, num_updates=12020, lr=3.68395e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=77391
2024-11-10 08:15:01 - progress_bar.py[line:274] - INFO: epoch 031:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17142.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3202.4, ups=0.19, wpb=17142.4, bsz=1024, num_updates=12030, lr=3.68259e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=77444
2024-11-10 08:15:55 - progress_bar.py[line:274] - INFO: epoch 031:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17128.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3200.6, ups=0.19, wpb=17128.9, bsz=1024, num_updates=12040, lr=3.68123e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=77498
2024-11-10 08:16:48 - progress_bar.py[line:274] - INFO: epoch 031:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17315.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3239.2, ups=0.19, wpb=17315.6, bsz=1024, num_updates=12050, lr=3.67987e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=77551
2024-11-10 08:17:42 - progress_bar.py[line:274] - INFO: epoch 031:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17475.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3235.6, ups=0.19, wpb=17475.5, bsz=1024, num_updates=12060, lr=3.67851e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=77605
2024-11-10 08:18:36 - progress_bar.py[line:274] - INFO: epoch 031:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17396.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3222.3, ups=0.19, wpb=17396.4, bsz=1024, num_updates=12070, lr=3.67715e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=77659
2024-11-10 08:19:31 - progress_bar.py[line:274] - INFO: epoch 031:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17466.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3217.8, ups=0.18, wpb=17466.1, bsz=1024, num_updates=12080, lr=3.67579e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=77714
2024-11-10 08:20:24 - progress_bar.py[line:274] - INFO: epoch 031:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17200.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3225.7, ups=0.19, wpb=17200.8, bsz=1024, num_updates=12090, lr=3.67443e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=77767
2024-11-10 08:21:16 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 08:21:22 - progress_bar.py[line:274] - INFO: epoch 031:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17193.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=2981.4, ups=0.17, wpb=17193.6, bsz=1024, num_updates=12100, lr=3.67307e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=33, gb_free=12.9, wall=77825
2024-11-10 08:22:10 - progress_bar.py[line:274] - INFO: epoch 031:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=16457.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3406.5, ups=0.21, wpb=16457.6, bsz=985.6, num_updates=12110, lr=3.67171e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=29, gb_free=13.1, wall=77873
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt2024-11-10 08:22:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 31 @ 12110 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-10 08:22:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 08:24:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 08:25:53 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 31 @ 12110 updates, score 0) (writing took 223.44378487498034 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-10 08:26:49 - train.py[line:336] - INFO: end of epoch 31 (average epoch stats below)
2024-11-10 08:26:49 - progress_bar.py[line:282] - INFO: epoch 031 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.887 | ntokens 17184.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.4 | wps 2637.9 | ups 0.15 | wpb 17184.6 | bsz 1023 | num_updates 12110 | lr 3.67171e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1186 | gb_free 13.1 | wall 78152
2024-11-10 08:26:49 - trainer.py[line:639] - INFO: loading train data for epoch 32
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 08:29:29 - trainer.py[line:703] - INFO: begin training epoch 32
2024-11-10 08:29:29 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 08:30:25 - progress_bar.py[line:274] - INFO: epoch 032:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17142.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=346.4, ups=0.02, wpb=17142.1, bsz=1024, num_updates=12120, lr=3.67035e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=78368
2024-11-10 08:31:21 - progress_bar.py[line:274] - INFO: epoch 032:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=16938.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3014.9, ups=0.18, wpb=16938.6, bsz=1024, num_updates=12130, lr=3.66899e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=78424
2024-11-10 08:32:16 - progress_bar.py[line:274] - INFO: epoch 032:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17315.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3163.8, ups=0.18, wpb=17315.1, bsz=1024, num_updates=12140, lr=3.66763e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=78479
2024-11-10 08:33:08 - progress_bar.py[line:274] - INFO: epoch 032:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17084.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3301.3, ups=0.19, wpb=17084.5, bsz=1024, num_updates=12150, lr=3.66627e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=48, gb_free=13.4, wall=78530
2024-11-10 08:34:00 - progress_bar.py[line:274] - INFO: epoch 032:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17208.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3261.8, ups=0.19, wpb=17208.2, bsz=1024, num_updates=12160, lr=3.66491e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=78583
2024-11-10 08:34:54 - progress_bar.py[line:274] - INFO: epoch 032:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17075.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3174.2, ups=0.19, wpb=17075.1, bsz=1024, num_updates=12170, lr=3.66355e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=78637
2024-11-10 08:35:48 - progress_bar.py[line:274] - INFO: epoch 032:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=16967.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3170.6, ups=0.19, wpb=16967.9, bsz=1024, num_updates=12180, lr=3.66219e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=78690
2024-11-10 08:36:42 - progress_bar.py[line:274] - INFO: epoch 032:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17298.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3199.7, ups=0.18, wpb=17298.7, bsz=1024, num_updates=12190, lr=3.66083e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=78745
2024-11-10 08:37:35 - progress_bar.py[line:274] - INFO: epoch 032:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17397.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3235.8, ups=0.19, wpb=17397.4, bsz=1024, num_updates=12200, lr=3.65947e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=78798
2024-11-10 08:38:28 - progress_bar.py[line:274] - INFO: epoch 032:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=16924.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3207.2, ups=0.19, wpb=16924.3, bsz=1024, num_updates=12210, lr=3.65811e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=78851
2024-11-10 08:39:22 - progress_bar.py[line:274] - INFO: epoch 032:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17110.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3175.3, ups=0.19, wpb=17110.2, bsz=1024, num_updates=12220, lr=3.65674e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=78905
2024-11-10 08:40:15 - progress_bar.py[line:274] - INFO: epoch 032:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17110.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3206.1, ups=0.19, wpb=17110.7, bsz=1024, num_updates=12230, lr=3.65538e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=78958
2024-11-10 08:41:10 - progress_bar.py[line:274] - INFO: epoch 032:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17179.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3140, ups=0.18, wpb=17179.4, bsz=1024, num_updates=12240, lr=3.65402e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=79013
2024-11-10 08:42:07 - progress_bar.py[line:274] - INFO: epoch 032:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17144.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=2994.2, ups=0.17, wpb=17144.4, bsz=1024, num_updates=12250, lr=3.65266e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.2, wall=79070
2024-11-10 08:43:07 - progress_bar.py[line:274] - INFO: epoch 032:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17105.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=2885.9, ups=0.17, wpb=17105.7, bsz=1024, num_updates=12260, lr=3.6513e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=79130
2024-11-10 08:44:04 - progress_bar.py[line:274] - INFO: epoch 032:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17121.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3009.1, ups=0.18, wpb=17121.4, bsz=1024, num_updates=12270, lr=3.64994e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=12.7, wall=79186
2024-11-10 08:45:05 - progress_bar.py[line:274] - INFO: epoch 032:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.873, ntokens=17191.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=2794.8, ups=0.16, wpb=17191.3, bsz=1024, num_updates=12280, lr=3.64858e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=61, gb_free=13.4, wall=79248
2024-11-10 08:46:03 - progress_bar.py[line:274] - INFO: epoch 032:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17219.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=2963.4, ups=0.17, wpb=17219.9, bsz=1024, num_updates=12290, lr=3.64722e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=79306
2024-11-10 08:47:01 - progress_bar.py[line:274] - INFO: epoch 032:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17017.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=2953.1, ups=0.17, wpb=17017.2, bsz=1024, num_updates=12300, lr=3.64586e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=79364
2024-11-10 08:47:59 - progress_bar.py[line:274] - INFO: epoch 032:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17303.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=2955.4, ups=0.17, wpb=17303.9, bsz=1024, num_updates=12310, lr=3.6445e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=79422
2024-11-10 08:49:00 - progress_bar.py[line:274] - INFO: epoch 032:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=16910.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=2800.1, ups=0.17, wpb=16910.3, bsz=1024, num_updates=12320, lr=3.64314e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=60, gb_free=13.3, wall=79483
2024-11-10 08:50:01 - progress_bar.py[line:274] - INFO: epoch 032:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17168.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=2820.5, ups=0.16, wpb=17168.1, bsz=1024, num_updates=12330, lr=3.64178e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=61, gb_free=13.3, wall=79544
2024-11-10 08:51:00 - progress_bar.py[line:274] - INFO: epoch 032:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17178.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=2915.9, ups=0.17, wpb=17178.9, bsz=1024, num_updates=12340, lr=3.64042e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=79602
2024-11-10 08:52:02 - progress_bar.py[line:274] - INFO: epoch 032:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=16981.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=2740.8, ups=0.16, wpb=16981.4, bsz=1024, num_updates=12350, lr=3.63906e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=62, gb_free=13.4, wall=79664
2024-11-10 08:53:02 - progress_bar.py[line:274] - INFO: epoch 032:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17109.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=2827.8, ups=0.17, wpb=17109.2, bsz=1024, num_updates=12360, lr=3.6377e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=60, gb_free=13.2, wall=79725
2024-11-10 08:54:04 - progress_bar.py[line:274] - INFO: epoch 032:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17297.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=2808.6, ups=0.16, wpb=17297.2, bsz=1024, num_updates=12370, lr=3.63634e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=61, gb_free=13.3, wall=79787
2024-11-10 08:55:05 - progress_bar.py[line:274] - INFO: epoch 032:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17206.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=2805.9, ups=0.16, wpb=17206.1, bsz=1024, num_updates=12380, lr=3.63498e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=61, gb_free=13.5, wall=79848
2024-11-10 08:56:09 - progress_bar.py[line:274] - INFO: epoch 032:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=2688, ups=0.16, wpb=17245.1, bsz=1024, num_updates=12390, lr=3.63362e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=64, gb_free=13.3, wall=79912
2024-11-10 08:57:15 - progress_bar.py[line:274] - INFO: epoch 032:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=16973, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=2575, ups=0.15, wpb=16973, bsz=1024, num_updates=12400, lr=3.63226e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=66, gb_free=13.2, wall=79978
2024-11-10 08:58:21 - progress_bar.py[line:274] - INFO: epoch 032:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.905, ntokens=17460.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=2630.6, ups=0.15, wpb=17460.6, bsz=1024, num_updates=12410, lr=3.6309e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=66, gb_free=13.4, wall=80044
2024-11-10 08:59:25 - progress_bar.py[line:274] - INFO: epoch 032:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=17180.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=2692.6, ups=0.16, wpb=17180.5, bsz=1024, num_updates=12420, lr=3.62954e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=64, gb_free=13.3, wall=80108
2024-11-10 09:00:21 - progress_bar.py[line:274] - INFO: epoch 032:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17136.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3072.2, ups=0.18, wpb=17136.2, bsz=1024, num_updates=12430, lr=3.62818e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=49, gb_free=13.2, wall=80164
2024-11-10 09:01:03 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 09:01:18 - progress_bar.py[line:274] - INFO: epoch 032:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17091.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3014, ups=0.18, wpb=17091.1, bsz=1024, num_updates=12440, lr=3.62682e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=80221
2024-11-10 09:02:10 - progress_bar.py[line:274] - INFO: epoch 032:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17049.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3231.4, ups=0.19, wpb=17049.3, bsz=1024, num_updates=12450, lr=3.62546e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.4, wall=80273
2024-11-10 09:03:04 - progress_bar.py[line:274] - INFO: epoch 032:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17144.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3182.7, ups=0.19, wpb=17144.2, bsz=1024, num_updates=12460, lr=3.6241e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=80327
2024-11-10 09:03:59 - progress_bar.py[line:274] - INFO: epoch 032:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.883, ntokens=17266.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3177.5, ups=0.18, wpb=17266.5, bsz=1024, num_updates=12470, lr=3.62273e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=80382
2024-11-10 09:04:52 - progress_bar.py[line:274] - INFO: epoch 032:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17417.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3247.1, ups=0.19, wpb=17417.9, bsz=1024, num_updates=12480, lr=3.62137e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=80435
2024-11-10 09:05:45 - progress_bar.py[line:274] - INFO: epoch 032:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17323.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3312.1, ups=0.19, wpb=17323.4, bsz=1024, num_updates=12490, lr=3.62001e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=80488
2024-11-10 09:06:33 - progress_bar.py[line:274] - INFO: epoch 032:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=16261.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3361.9, ups=0.21, wpb=16261.4, bsz=985.6, num_updates=12500, lr=3.61865e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=29, gb_free=13.3, wall=80536
2024-11-10 09:06:33 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 32 @ 12500 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-10 09:06:33 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 09:08:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 09:10:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 32 @ 12500 updates, score 0) (writing took 224.8622757269768 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
2024-11-10 09:11:13 - train.py[line:336] - INFO: end of epoch 32 (average epoch stats below)
2024-11-10 09:11:13 - progress_bar.py[line:282] - INFO: epoch 032 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.868 | ntokens 17134.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.3 | wps 2507.7 | ups 0.15 | wpb 17134.8 | bsz 1023 | num_updates 12500 | lr 3.61865e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1801 | gb_free 13.3 | wall 80816
2024-11-10 09:11:13 - trainer.py[line:639] - INFO: loading train data for epoch 33
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 09:13:55 - trainer.py[line:703] - INFO: begin training epoch 33
2024-11-10 09:13:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 09:14:52 - progress_bar.py[line:274] - INFO: epoch 033:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17279.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=346.6, ups=0.02, wpb=17279.4, bsz=1024, num_updates=12510, lr=3.61729e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=81034
2024-11-10 09:15:46 - progress_bar.py[line:274] - INFO: epoch 033:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17195.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3159.9, ups=0.18, wpb=17195.9, bsz=1024, num_updates=12520, lr=3.61593e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81089
2024-11-10 09:16:40 - progress_bar.py[line:274] - INFO: epoch 033:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17096.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3170.4, ups=0.19, wpb=17096.4, bsz=1024, num_updates=12530, lr=3.61457e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=81143
2024-11-10 09:17:35 - progress_bar.py[line:274] - INFO: epoch 033:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3160.5, ups=0.18, wpb=17274.5, bsz=1024, num_updates=12540, lr=3.61321e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=81197
2024-11-10 09:18:28 - progress_bar.py[line:274] - INFO: epoch 033:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17154.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3189.1, ups=0.19, wpb=17154.4, bsz=1024, num_updates=12550, lr=3.61185e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=81251
2024-11-10 09:19:23 - progress_bar.py[line:274] - INFO: epoch 033:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17400, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3168, ups=0.18, wpb=17400, bsz=1024, num_updates=12560, lr=3.61049e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=81306
2024-11-10 09:20:18 - progress_bar.py[line:274] - INFO: epoch 033:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17110.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3141.2, ups=0.18, wpb=17110.4, bsz=1024, num_updates=12570, lr=3.60913e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=81361
2024-11-10 09:21:12 - progress_bar.py[line:274] - INFO: epoch 033:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17382.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3192.5, ups=0.18, wpb=17382.1, bsz=1024, num_updates=12580, lr=3.60777e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=81415
2024-11-10 09:22:07 - progress_bar.py[line:274] - INFO: epoch 033:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3164.1, ups=0.18, wpb=17291.2, bsz=1024, num_updates=12590, lr=3.60641e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=81470
2024-11-10 09:23:01 - progress_bar.py[line:274] - INFO: epoch 033:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17329.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3184.6, ups=0.18, wpb=17329.8, bsz=1024, num_updates=12600, lr=3.60505e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=81524
2024-11-10 09:23:57 - progress_bar.py[line:274] - INFO: epoch 033:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17263.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3087.9, ups=0.18, wpb=17263.4, bsz=1024, num_updates=12610, lr=3.60369e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=81580
2024-11-10 09:24:52 - progress_bar.py[line:274] - INFO: epoch 033:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17489.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3199.4, ups=0.18, wpb=17489.3, bsz=1024, num_updates=12620, lr=3.60233e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=81635
2024-11-10 09:25:46 - progress_bar.py[line:274] - INFO: epoch 033:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3171.8, ups=0.18, wpb=17323.2, bsz=1024, num_updates=12630, lr=3.60097e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=81689
2024-11-10 09:26:41 - progress_bar.py[line:274] - INFO: epoch 033:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3176.4, ups=0.18, wpb=17322.9, bsz=1024, num_updates=12640, lr=3.59961e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=81744
2024-11-10 09:27:37 - progress_bar.py[line:274] - INFO: epoch 033:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17146.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3082.9, ups=0.18, wpb=17146.3, bsz=1024, num_updates=12650, lr=3.59825e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=81799
2024-11-10 09:28:31 - progress_bar.py[line:274] - INFO: epoch 033:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17474.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3205.4, ups=0.18, wpb=17474.8, bsz=1024, num_updates=12660, lr=3.59689e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=81854
2024-11-10 09:29:26 - progress_bar.py[line:274] - INFO: epoch 033:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17215, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3162.9, ups=0.18, wpb=17215, bsz=1024, num_updates=12670, lr=3.59553e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=81908
2024-11-10 09:30:20 - progress_bar.py[line:274] - INFO: epoch 033:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3169.3, ups=0.18, wpb=17258.7, bsz=1024, num_updates=12680, lr=3.59417e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=81963
2024-11-10 09:31:15 - progress_bar.py[line:274] - INFO: epoch 033:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=16866.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3047.3, ups=0.18, wpb=16866.6, bsz=1024, num_updates=12690, lr=3.59281e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=82018
2024-11-10 09:32:10 - progress_bar.py[line:274] - INFO: epoch 033:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17333, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3180.9, ups=0.18, wpb=17333, bsz=1024, num_updates=12700, lr=3.59145e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=82073
2024-11-10 09:33:02 - progress_bar.py[line:274] - INFO: epoch 033:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17005.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3238.1, ups=0.19, wpb=17005.7, bsz=1024, num_updates=12710, lr=3.59009e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=45, gb_free=13.4, wall=82125
2024-11-10 09:33:55 - progress_bar.py[line:274] - INFO: epoch 033:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17005.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3207.5, ups=0.19, wpb=17005.2, bsz=1024, num_updates=12720, lr=3.58873e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=82178
2024-11-10 09:34:50 - progress_bar.py[line:274] - INFO: epoch 033:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17189.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3148.3, ups=0.18, wpb=17189.5, bsz=1024, num_updates=12730, lr=3.58736e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=82233
2024-11-10 09:35:45 - progress_bar.py[line:274] - INFO: epoch 033:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17159.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3134.8, ups=0.18, wpb=17159.4, bsz=1024, num_updates=12740, lr=3.586e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=82288
2024-11-10 09:36:39 - progress_bar.py[line:274] - INFO: epoch 033:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17679.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3260.3, ups=0.18, wpb=17679.1, bsz=1024, num_updates=12750, lr=3.58464e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=12.7, wall=82342
2024-11-10 09:37:33 - progress_bar.py[line:274] - INFO: epoch 033:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17234.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3175.2, ups=0.18, wpb=17234.3, bsz=1024, num_updates=12760, lr=3.58328e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=82396
2024-11-10 09:38:27 - progress_bar.py[line:274] - INFO: epoch 033:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17133.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3205.4, ups=0.19, wpb=17133.3, bsz=1024, num_updates=12770, lr=3.58192e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=82450
2024-11-10 09:39:21 - progress_bar.py[line:274] - INFO: epoch 033:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17082.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3171.2, ups=0.19, wpb=17082.5, bsz=1024, num_updates=12780, lr=3.58056e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=82503
2024-11-10 09:40:14 - progress_bar.py[line:274] - INFO: epoch 033:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=16784.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3132.3, ups=0.19, wpb=16784.4, bsz=1024, num_updates=12790, lr=3.5792e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=82557
2024-11-10 09:41:08 - progress_bar.py[line:274] - INFO: epoch 033:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17276.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3226, ups=0.19, wpb=17276.1, bsz=1024, num_updates=12800, lr=3.57784e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=82611
2024-11-10 09:42:01 - progress_bar.py[line:274] - INFO: epoch 033:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17067.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3170.8, ups=0.19, wpb=17067.6, bsz=1024, num_updates=12810, lr=3.57648e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=82664
2024-11-10 09:42:55 - progress_bar.py[line:274] - INFO: epoch 033:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17203, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3196.5, ups=0.19, wpb=17203, bsz=1024, num_updates=12820, lr=3.57512e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=82718
2024-11-10 09:43:50 - progress_bar.py[line:274] - INFO: epoch 033:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=16936, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3121.2, ups=0.18, wpb=16936, bsz=1024, num_updates=12830, lr=3.57376e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=35, gb_free=13.4, wall=82772
2024-11-10 09:44:43 - progress_bar.py[line:274] - INFO: epoch 033:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17150.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3207.3, ups=0.19, wpb=17150.9, bsz=1024, num_updates=12840, lr=3.5724e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=82826
2024-11-10 09:45:37 - progress_bar.py[line:274] - INFO: epoch 033:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17184, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3191.1, ups=0.19, wpb=17184, bsz=1024, num_updates=12850, lr=3.57104e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=82880
2024-11-10 09:46:31 - progress_bar.py[line:274] - INFO: epoch 033:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17139.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3162.9, ups=0.18, wpb=17139.9, bsz=1024, num_updates=12860, lr=3.56968e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=82934
2024-11-10 09:47:25 - progress_bar.py[line:274] - INFO: epoch 033:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=17368.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3196.3, ups=0.18, wpb=17368.2, bsz=1024, num_updates=12870, lr=3.56832e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=82988
2024-11-10 09:48:20 - progress_bar.py[line:274] - INFO: epoch 033:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17039.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3123.1, ups=0.18, wpb=17039.8, bsz=1024, num_updates=12880, lr=3.56696e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=47, gb_free=13.4, wall=83043
2024-11-10 09:49:15 - progress_bar.py[line:274] - INFO: epoch 033:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17114.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3114.1, ups=0.18, wpb=17114.4, bsz=1024, num_updates=12890, lr=3.5656e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=83098
2024-11-10 09:49:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 33 @ 12891 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
2024-11-10 09:49:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 09:51:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-10 09:53:01 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 33 @ 12891 updates, score 0) (writing took 224.52892684098333 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 09:53:56 - train.py[line:336] - INFO: end of epoch 33 (average epoch stats below)
2024-11-10 09:53:56 - progress_bar.py[line:282] - INFO: epoch 033 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.866 | ntokens 17186.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.29 | wps 2622.2 | ups 0.15 | wpb 17186.5 | bsz 1023 | num_updates 12891 | lr 3.56546e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1285 | gb_free 13.3 | wall 83379
2024-11-10 09:53:56 - trainer.py[line:639] - INFO: loading train data for epoch 34
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 09:56:38 - trainer.py[line:703] - INFO: begin training epoch 34
2024-11-10 09:56:38 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 09:57:28 - progress_bar.py[line:274] - INFO: epoch 034:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=16278.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=329.9, ups=0.02, wpb=16278.7, bsz=985.6, num_updates=12900, lr=3.56424e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=83591
2024-11-10 09:58:22 - progress_bar.py[line:274] - INFO: epoch 034:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17152.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3175, ups=0.19, wpb=17152.9, bsz=1024, num_updates=12910, lr=3.56288e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=83645
2024-11-10 09:59:17 - progress_bar.py[line:274] - INFO: epoch 034:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17311.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3167.3, ups=0.18, wpb=17311.8, bsz=1024, num_updates=12920, lr=3.56152e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=83700
2024-11-10 10:00:11 - progress_bar.py[line:274] - INFO: epoch 034:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17294, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3237.1, ups=0.19, wpb=17294, bsz=1024, num_updates=12930, lr=3.56016e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=83753
2024-11-10 10:01:04 - progress_bar.py[line:274] - INFO: epoch 034:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17066.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3186.1, ups=0.19, wpb=17066.2, bsz=1024, num_updates=12940, lr=3.5588e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=83807
2024-11-10 10:01:57 - progress_bar.py[line:274] - INFO: epoch 034:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17214.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3225.8, ups=0.19, wpb=17214.5, bsz=1024, num_updates=12950, lr=3.55744e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=83860
2024-11-10 10:02:51 - progress_bar.py[line:274] - INFO: epoch 034:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17040.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3176.4, ups=0.19, wpb=17040.9, bsz=1024, num_updates=12960, lr=3.55608e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=83914
2024-11-10 10:03:45 - progress_bar.py[line:274] - INFO: epoch 034:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17214.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3216.9, ups=0.19, wpb=17214.8, bsz=1024, num_updates=12970, lr=3.55472e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=83968
2024-11-10 10:04:38 - progress_bar.py[line:274] - INFO: epoch 034:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17147.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3204.3, ups=0.19, wpb=17147.8, bsz=1024, num_updates=12980, lr=3.55335e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=84021
2024-11-10 10:05:32 - progress_bar.py[line:274] - INFO: epoch 034:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17081, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3160.5, ups=0.19, wpb=17081, bsz=1024, num_updates=12990, lr=3.55199e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=84075
2024-11-10 10:06:26 - progress_bar.py[line:274] - INFO: epoch 034:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=17040.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3177.7, ups=0.19, wpb=17040.8, bsz=1024, num_updates=13000, lr=3.55063e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=84129
2024-11-10 10:07:20 - progress_bar.py[line:274] - INFO: epoch 034:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17216.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3157.2, ups=0.18, wpb=17216.3, bsz=1024, num_updates=13010, lr=3.54927e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84183
2024-11-10 10:08:15 - progress_bar.py[line:274] - INFO: epoch 034:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3177.4, ups=0.18, wpb=17219.7, bsz=1024, num_updates=13020, lr=3.54791e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84237
2024-11-10 10:09:09 - progress_bar.py[line:274] - INFO: epoch 034:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3221.2, ups=0.19, wpb=17393.3, bsz=1024, num_updates=13030, lr=3.54655e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=84291
2024-11-10 10:10:03 - progress_bar.py[line:274] - INFO: epoch 034:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17177.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3184.1, ups=0.19, wpb=17177.8, bsz=1024, num_updates=13040, lr=3.54519e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=84345
2024-11-10 10:10:56 - progress_bar.py[line:274] - INFO: epoch 034:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17248.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3214.2, ups=0.19, wpb=17248.3, bsz=1024, num_updates=13050, lr=3.54383e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=84399
2024-11-10 10:11:50 - progress_bar.py[line:274] - INFO: epoch 034:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=16899.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3149.2, ups=0.19, wpb=16899.3, bsz=1024, num_updates=13060, lr=3.54247e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=84453
2024-11-10 10:12:44 - progress_bar.py[line:274] - INFO: epoch 034:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17054.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3167.8, ups=0.19, wpb=17054.8, bsz=1024, num_updates=13070, lr=3.54111e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=84507
2024-11-10 10:13:37 - progress_bar.py[line:274] - INFO: epoch 034:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17161.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3222.7, ups=0.19, wpb=17161.9, bsz=1024, num_updates=13080, lr=3.53975e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=84560
2024-11-10 10:14:30 - progress_bar.py[line:274] - INFO: epoch 034:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17353.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3247.7, ups=0.19, wpb=17353.1, bsz=1024, num_updates=13090, lr=3.53839e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84613
2024-11-10 10:15:24 - progress_bar.py[line:274] - INFO: epoch 034:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17051.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3166.3, ups=0.19, wpb=17051.7, bsz=1024, num_updates=13100, lr=3.53703e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=84667
2024-11-10 10:16:19 - progress_bar.py[line:274] - INFO: epoch 034:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17213.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3134.8, ups=0.18, wpb=17213.3, bsz=1024, num_updates=13110, lr=3.53567e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=84722
2024-11-10 10:17:13 - progress_bar.py[line:274] - INFO: epoch 034:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=17286.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3227.2, ups=0.19, wpb=17286.5, bsz=1024, num_updates=13120, lr=3.53431e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84776
2024-11-10 10:18:07 - progress_bar.py[line:274] - INFO: epoch 034:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=16960.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3116.2, ups=0.18, wpb=16960.7, bsz=1024, num_updates=13130, lr=3.53295e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=84830
2024-11-10 10:19:01 - progress_bar.py[line:274] - INFO: epoch 034:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17137.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3193.7, ups=0.19, wpb=17137.5, bsz=1024, num_updates=13140, lr=3.53159e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84884
2024-11-10 10:19:54 - progress_bar.py[line:274] - INFO: epoch 034:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17272.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3222.8, ups=0.19, wpb=17272.8, bsz=1024, num_updates=13150, lr=3.53023e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=84937
2024-11-10 10:20:48 - progress_bar.py[line:274] - INFO: epoch 034:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17157.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3192.7, ups=0.19, wpb=17157.7, bsz=1024, num_updates=13160, lr=3.52887e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=84991
2024-11-10 10:21:42 - progress_bar.py[line:274] - INFO: epoch 034:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17099.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3183.1, ups=0.19, wpb=17099.9, bsz=1024, num_updates=13170, lr=3.52751e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=85045
2024-11-10 10:22:36 - progress_bar.py[line:274] - INFO: epoch 034:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17170.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3187.5, ups=0.19, wpb=17170.6, bsz=1024, num_updates=13180, lr=3.52615e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=85099
2024-11-10 10:23:30 - progress_bar.py[line:274] - INFO: epoch 034:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17396.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3201.2, ups=0.18, wpb=17396.4, bsz=1024, num_updates=13190, lr=3.52479e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=85153
2024-11-10 10:24:24 - progress_bar.py[line:274] - INFO: epoch 034:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17309.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3238.3, ups=0.19, wpb=17309.2, bsz=1024, num_updates=13200, lr=3.52343e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=85206
2024-11-10 10:25:17 - progress_bar.py[line:274] - INFO: epoch 034:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17038.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3173.1, ups=0.19, wpb=17038.9, bsz=1024, num_updates=13210, lr=3.52207e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=85260
2024-11-10 10:26:11 - progress_bar.py[line:274] - INFO: epoch 034:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17284.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3221, ups=0.19, wpb=17284.8, bsz=1024, num_updates=13220, lr=3.52071e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=85314
2024-11-10 10:27:05 - progress_bar.py[line:274] - INFO: epoch 034:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17244.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3215, ups=0.19, wpb=17244.8, bsz=1024, num_updates=13230, lr=3.51934e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=85367
2024-11-10 10:27:58 - progress_bar.py[line:274] - INFO: epoch 034:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17079, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3195.6, ups=0.19, wpb=17079, bsz=1024, num_updates=13240, lr=3.51798e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=85421
2024-11-10 10:28:52 - progress_bar.py[line:274] - INFO: epoch 034:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17310.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3202.9, ups=0.19, wpb=17310.9, bsz=1024, num_updates=13250, lr=3.51662e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=85475
2024-11-10 10:29:46 - progress_bar.py[line:274] - INFO: epoch 034:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17515.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3264.3, ups=0.19, wpb=17515.4, bsz=1024, num_updates=13260, lr=3.51526e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=85529
2024-11-10 10:30:38 - progress_bar.py[line:274] - INFO: epoch 034:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17257.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3299.1, ups=0.19, wpb=17257.8, bsz=1024, num_updates=13270, lr=3.5139e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=85581
2024-11-10 10:31:31 - progress_bar.py[line:274] - INFO: epoch 034:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=16933.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3170.3, ups=0.19, wpb=16933.1, bsz=1024, num_updates=13280, lr=3.51254e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=13.1, wall=85634
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
2024-11-10 10:31:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 34 @ 13282 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
2024-11-10 10:31:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 10:33:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-10 10:35:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 34 @ 13282 updates, score 0) (writing took 223.88102963601705 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-10 10:36:18 - train.py[line:336] - INFO: end of epoch 34 (average epoch stats below)
2024-11-10 10:36:18 - progress_bar.py[line:282] - INFO: epoch 034 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.847 | ntokens 17166 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.2 | wps 2641 | ups 0.15 | wpb 17166 | bsz 1023 | num_updates 13282 | lr 3.51227e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1207 | gb_free 13.3 | wall 85921
2024-11-10 10:36:18 - trainer.py[line:639] - INFO: loading train data for epoch 35
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 10:38:59 - trainer.py[line:703] - INFO: begin training epoch 35
2024-11-10 10:38:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 10:39:45 - progress_bar.py[line:274] - INFO: epoch 035:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=16676.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=337.8, ups=0.02, wpb=16676.3, bsz=985.6, num_updates=13290, lr=3.51118e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=86128
2024-11-10 10:40:39 - progress_bar.py[line:274] - INFO: epoch 035:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17281.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3173.1, ups=0.18, wpb=17281.3, bsz=1024, num_updates=13300, lr=3.50982e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=86182
2024-11-10 10:41:34 - progress_bar.py[line:274] - INFO: epoch 035:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=16951.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3097.1, ups=0.18, wpb=16951.7, bsz=1024, num_updates=13310, lr=3.50846e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=86237
2024-11-10 10:42:29 - progress_bar.py[line:274] - INFO: epoch 035:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=16990.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3112.9, ups=0.18, wpb=16990.5, bsz=1024, num_updates=13320, lr=3.5071e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=86292
2024-11-10 10:43:23 - progress_bar.py[line:274] - INFO: epoch 035:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17399.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3222.4, ups=0.19, wpb=17399.4, bsz=1024, num_updates=13330, lr=3.50574e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=86346
2024-11-10 10:44:17 - progress_bar.py[line:274] - INFO: epoch 035:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17384.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3176.6, ups=0.18, wpb=17384.6, bsz=1024, num_updates=13340, lr=3.50438e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=86400
2024-11-10 10:45:11 - progress_bar.py[line:274] - INFO: epoch 035:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=16835.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3128.6, ups=0.19, wpb=16835.3, bsz=1024, num_updates=13350, lr=3.50302e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=86454
2024-11-10 10:46:06 - progress_bar.py[line:274] - INFO: epoch 035:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17484.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3216.9, ups=0.18, wpb=17484.8, bsz=1024, num_updates=13360, lr=3.50166e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=86509
2024-11-10 10:47:00 - progress_bar.py[line:274] - INFO: epoch 035:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17319.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3187.5, ups=0.18, wpb=17319.4, bsz=1024, num_updates=13370, lr=3.5003e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=86563
2024-11-10 10:47:54 - progress_bar.py[line:274] - INFO: epoch 035:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17069.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3136.6, ups=0.18, wpb=17069.6, bsz=1024, num_updates=13380, lr=3.49894e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=86617
2024-11-10 10:48:49 - progress_bar.py[line:274] - INFO: epoch 035:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17070.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3117.7, ups=0.18, wpb=17070.5, bsz=1024, num_updates=13390, lr=3.49758e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=86672
2024-11-10 10:49:43 - progress_bar.py[line:274] - INFO: epoch 035:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17125.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3157.4, ups=0.18, wpb=17125.1, bsz=1024, num_updates=13400, lr=3.49622e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=86726
2024-11-10 10:50:37 - progress_bar.py[line:274] - INFO: epoch 035:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17217.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3182.9, ups=0.18, wpb=17217.6, bsz=1024, num_updates=13410, lr=3.49486e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=86780
2024-11-10 10:51:31 - progress_bar.py[line:274] - INFO: epoch 035:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17231.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3199.1, ups=0.19, wpb=17231.8, bsz=1024, num_updates=13420, lr=3.4935e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=86834
2024-11-10 10:52:26 - progress_bar.py[line:274] - INFO: epoch 035:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17048.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3138.7, ups=0.18, wpb=17048.6, bsz=1024, num_updates=13430, lr=3.49214e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=86889
2024-11-10 10:53:20 - progress_bar.py[line:274] - INFO: epoch 035:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17235, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3189.3, ups=0.19, wpb=17235, bsz=1024, num_updates=13440, lr=3.49078e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=86943
2024-11-10 10:54:14 - progress_bar.py[line:274] - INFO: epoch 035:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17106, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3141.2, ups=0.18, wpb=17106, bsz=1024, num_updates=13450, lr=3.48942e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=86997
2024-11-10 10:55:09 - progress_bar.py[line:274] - INFO: epoch 035:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17243.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3162.8, ups=0.18, wpb=17243.4, bsz=1024, num_updates=13460, lr=3.48806e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=87052
2024-11-10 10:56:03 - progress_bar.py[line:274] - INFO: epoch 035:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17026.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3120.6, ups=0.18, wpb=17026.1, bsz=1024, num_updates=13470, lr=3.4867e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=87106
2024-11-10 10:56:57 - progress_bar.py[line:274] - INFO: epoch 035:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17078, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3153.4, ups=0.18, wpb=17078, bsz=1024, num_updates=13480, lr=3.48533e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=87160
2024-11-10 10:57:52 - progress_bar.py[line:274] - INFO: epoch 035:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17152.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3121.5, ups=0.18, wpb=17152.6, bsz=1024, num_updates=13490, lr=3.48397e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=87215
2024-11-10 10:58:14 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 10:58:52 - progress_bar.py[line:274] - INFO: epoch 035:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=16995.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=2828.7, ups=0.17, wpb=16995.6, bsz=1024, num_updates=13500, lr=3.48261e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=39, gb_free=13.3, wall=87275
2024-11-10 10:59:47 - progress_bar.py[line:274] - INFO: epoch 035:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17416.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3203.6, ups=0.18, wpb=17416.2, bsz=1024, num_updates=13510, lr=3.48125e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=38, gb_free=12.9, wall=87330
2024-11-10 11:00:41 - progress_bar.py[line:274] - INFO: epoch 035:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17022, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3129.2, ups=0.18, wpb=17022, bsz=1024, num_updates=13520, lr=3.47989e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=35, gb_free=13.1, wall=87384
2024-11-10 11:01:36 - progress_bar.py[line:274] - INFO: epoch 035:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17197, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3160.6, ups=0.18, wpb=17197, bsz=1024, num_updates=13530, lr=3.47853e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=33, gb_free=13.1, wall=87439
2024-11-10 11:02:29 - progress_bar.py[line:274] - INFO: epoch 035:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17125.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3182.4, ups=0.19, wpb=17125.5, bsz=1024, num_updates=13540, lr=3.47717e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=87492
2024-11-10 11:03:24 - progress_bar.py[line:274] - INFO: epoch 035:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17152.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3165.3, ups=0.18, wpb=17152.2, bsz=1024, num_updates=13550, lr=3.47581e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=87547
2024-11-10 11:04:19 - progress_bar.py[line:274] - INFO: epoch 035:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17333.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3157.5, ups=0.18, wpb=17333.3, bsz=1024, num_updates=13560, lr=3.47445e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=87601
2024-11-10 11:05:13 - progress_bar.py[line:274] - INFO: epoch 035:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17133, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3166.4, ups=0.18, wpb=17133, bsz=1024, num_updates=13570, lr=3.47309e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=87656
2024-11-10 11:06:07 - progress_bar.py[line:274] - INFO: epoch 035:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17075.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3120.5, ups=0.18, wpb=17075.8, bsz=1024, num_updates=13580, lr=3.47173e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=87710
2024-11-10 11:07:02 - progress_bar.py[line:274] - INFO: epoch 035:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17047.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3139.6, ups=0.18, wpb=17047.8, bsz=1024, num_updates=13590, lr=3.47037e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=87765
2024-11-10 11:07:56 - progress_bar.py[line:274] - INFO: epoch 035:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17200.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3173.4, ups=0.18, wpb=17200.2, bsz=1024, num_updates=13600, lr=3.46901e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=87819
2024-11-10 11:08:50 - progress_bar.py[line:274] - INFO: epoch 035:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17399.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3198.5, ups=0.18, wpb=17399.1, bsz=1024, num_updates=13610, lr=3.46765e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=87873
2024-11-10 11:09:44 - progress_bar.py[line:274] - INFO: epoch 035:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17226.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3205.7, ups=0.19, wpb=17226.8, bsz=1024, num_updates=13620, lr=3.46629e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=87927
2024-11-10 11:10:38 - progress_bar.py[line:274] - INFO: epoch 035:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=16861.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3133.4, ups=0.19, wpb=16861.7, bsz=1024, num_updates=13630, lr=3.46493e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=87981
2024-11-10 11:11:33 - progress_bar.py[line:274] - INFO: epoch 035:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17454.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3173.1, ups=0.18, wpb=17454.6, bsz=1024, num_updates=13640, lr=3.46357e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=37, gb_free=13.4, wall=88036
2024-11-10 11:12:27 - progress_bar.py[line:274] - INFO: epoch 035:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17433.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3223.5, ups=0.18, wpb=17433.4, bsz=1024, num_updates=13650, lr=3.46221e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=45, gb_free=13.2, wall=88090
2024-11-10 11:13:23 - progress_bar.py[line:274] - INFO: epoch 035:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17590.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3160.5, ups=0.18, wpb=17590.1, bsz=1024, num_updates=13660, lr=3.46085e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=88145
2024-11-10 11:14:17 - progress_bar.py[line:274] - INFO: epoch 035:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17096.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3153, ups=0.18, wpb=17096.8, bsz=1024, num_updates=13670, lr=3.45949e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=88200
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt2024-11-10 11:14:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 35 @ 13672 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt

2024-11-10 11:14:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 11:16:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
2024-11-10 11:18:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 35 @ 13672 updates, score 0) (writing took 223.8038914289791 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
2024-11-10 11:19:03 - train.py[line:336] - INFO: end of epoch 35 (average epoch stats below)
2024-11-10 11:19:03 - progress_bar.py[line:282] - INFO: epoch 035 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.836 | ntokens 17167.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.14 | wps 2609.4 | ups 0.15 | wpb 17167.3 | bsz 1023 | num_updates 13672 | lr 3.45922e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1310 | gb_free 13.1 | wall 88486
2024-11-10 11:19:03 - trainer.py[line:639] - INFO: loading train data for epoch 36
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 11:21:44 - trainer.py[line:703] - INFO: begin training epoch 36
2024-11-10 11:21:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 11:22:30 - progress_bar.py[line:274] - INFO: epoch 036:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=16746.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=339.6, ups=0.02, wpb=16746.6, bsz=985.6, num_updates=13680, lr=3.45813e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=88693
2024-11-10 11:23:24 - progress_bar.py[line:274] - INFO: epoch 036:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17379, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3183.8, ups=0.18, wpb=17379, bsz=1024, num_updates=13690, lr=3.45677e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=88747
2024-11-10 11:24:19 - progress_bar.py[line:274] - INFO: epoch 036:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17193.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3144.2, ups=0.18, wpb=17193.2, bsz=1024, num_updates=13700, lr=3.45541e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=88802
2024-11-10 11:25:14 - progress_bar.py[line:274] - INFO: epoch 036:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17245.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3124.5, ups=0.18, wpb=17245.2, bsz=1024, num_updates=13710, lr=3.45405e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=88857
2024-11-10 11:26:09 - progress_bar.py[line:274] - INFO: epoch 036:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=16869.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3101, ups=0.18, wpb=16869.4, bsz=1024, num_updates=13720, lr=3.45269e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=88912
2024-11-10 11:27:04 - progress_bar.py[line:274] - INFO: epoch 036:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17210.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3121.2, ups=0.18, wpb=17210.6, bsz=1024, num_updates=13730, lr=3.45133e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=88967
2024-11-10 11:27:59 - progress_bar.py[line:274] - INFO: epoch 036:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=16785, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3047.1, ups=0.18, wpb=16785, bsz=1024, num_updates=13740, lr=3.44996e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=89022
2024-11-10 11:28:55 - progress_bar.py[line:274] - INFO: epoch 036:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17126.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3081, ups=0.18, wpb=17126.6, bsz=1024, num_updates=13750, lr=3.4486e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=89077
2024-11-10 11:29:50 - progress_bar.py[line:274] - INFO: epoch 036:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17242.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3132.9, ups=0.18, wpb=17242.4, bsz=1024, num_updates=13760, lr=3.44724e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=89132
2024-11-10 11:30:45 - progress_bar.py[line:274] - INFO: epoch 036:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17163.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3107.1, ups=0.18, wpb=17163.9, bsz=1024, num_updates=13770, lr=3.44588e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=89188
2024-11-10 11:31:40 - progress_bar.py[line:274] - INFO: epoch 036:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=16893.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3048.9, ups=0.18, wpb=16893.7, bsz=1024, num_updates=13780, lr=3.44452e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=89243
2024-11-10 11:32:35 - progress_bar.py[line:274] - INFO: epoch 036:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17142.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3145.3, ups=0.18, wpb=17142.2, bsz=1024, num_updates=13790, lr=3.44316e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=89298
2024-11-10 11:33:30 - progress_bar.py[line:274] - INFO: epoch 036:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17464.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3177.5, ups=0.18, wpb=17464.1, bsz=1024, num_updates=13800, lr=3.4418e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=89353
2024-11-10 11:34:25 - progress_bar.py[line:274] - INFO: epoch 036:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17150.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3100.2, ups=0.18, wpb=17150.1, bsz=1024, num_updates=13810, lr=3.44044e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89408
2024-11-10 11:35:20 - progress_bar.py[line:274] - INFO: epoch 036:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17072.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3095.7, ups=0.18, wpb=17072.9, bsz=1024, num_updates=13820, lr=3.43908e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=89463
2024-11-10 11:36:15 - progress_bar.py[line:274] - INFO: epoch 036:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17029.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3104, ups=0.18, wpb=17029.4, bsz=1024, num_updates=13830, lr=3.43772e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=89518
2024-11-10 11:37:10 - progress_bar.py[line:274] - INFO: epoch 036:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17126.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3096.8, ups=0.18, wpb=17126.4, bsz=1024, num_updates=13840, lr=3.43636e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=89573
2024-11-10 11:38:06 - progress_bar.py[line:274] - INFO: epoch 036:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17203.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3118, ups=0.18, wpb=17203.2, bsz=1024, num_updates=13850, lr=3.435e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=89628
2024-11-10 11:39:01 - progress_bar.py[line:274] - INFO: epoch 036:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17062.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3094.5, ups=0.18, wpb=17062.3, bsz=1024, num_updates=13860, lr=3.43364e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89684
2024-11-10 11:39:56 - progress_bar.py[line:274] - INFO: epoch 036:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17308.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3146.7, ups=0.18, wpb=17308.5, bsz=1024, num_updates=13870, lr=3.43228e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89739
2024-11-10 11:40:51 - progress_bar.py[line:274] - INFO: epoch 036:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17143.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3112.5, ups=0.18, wpb=17143.1, bsz=1024, num_updates=13880, lr=3.43092e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89794
2024-11-10 11:41:46 - progress_bar.py[line:274] - INFO: epoch 036:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=16990.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3077, ups=0.18, wpb=16990.2, bsz=1024, num_updates=13890, lr=3.42956e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=89849
2024-11-10 11:42:42 - progress_bar.py[line:274] - INFO: epoch 036:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17187.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3093.2, ups=0.18, wpb=17187.5, bsz=1024, num_updates=13900, lr=3.4282e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89904
2024-11-10 11:43:36 - progress_bar.py[line:274] - INFO: epoch 036:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17252.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3156.1, ups=0.18, wpb=17252.8, bsz=1024, num_updates=13910, lr=3.42684e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=89959
2024-11-10 11:44:32 - progress_bar.py[line:274] - INFO: epoch 036:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17366.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3137.5, ups=0.18, wpb=17366.3, bsz=1024, num_updates=13920, lr=3.42548e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=90014
2024-11-10 11:45:26 - progress_bar.py[line:274] - INFO: epoch 036:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17363.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3194.8, ups=0.18, wpb=17363.3, bsz=1024, num_updates=13930, lr=3.42412e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=90069
2024-11-10 11:46:21 - progress_bar.py[line:274] - INFO: epoch 036:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17369.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3156.1, ups=0.18, wpb=17369.6, bsz=1024, num_updates=13940, lr=3.42276e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=90124
2024-11-10 11:47:16 - progress_bar.py[line:274] - INFO: epoch 036:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17008.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3088.7, ups=0.18, wpb=17008.5, bsz=1024, num_updates=13950, lr=3.4214e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=90179
2024-11-10 11:48:11 - progress_bar.py[line:274] - INFO: epoch 036:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17036.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3123.1, ups=0.18, wpb=17036.9, bsz=1024, num_updates=13960, lr=3.42004e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=90233
2024-11-10 11:49:06 - progress_bar.py[line:274] - INFO: epoch 036:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17360.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3132.8, ups=0.18, wpb=17360.9, bsz=1024, num_updates=13970, lr=3.41868e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=90289
2024-11-10 11:50:01 - progress_bar.py[line:274] - INFO: epoch 036:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=16905.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3074.3, ups=0.18, wpb=16905.1, bsz=1024, num_updates=13980, lr=3.41732e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=90344
2024-11-10 11:50:57 - progress_bar.py[line:274] - INFO: epoch 036:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17109, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3052.2, ups=0.18, wpb=17109, bsz=1024, num_updates=13990, lr=3.41595e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=90400
2024-11-10 11:51:52 - progress_bar.py[line:274] - INFO: epoch 036:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17160.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3092.1, ups=0.18, wpb=17160.9, bsz=1024, num_updates=14000, lr=3.41459e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=90455
2024-11-10 11:52:47 - progress_bar.py[line:274] - INFO: epoch 036:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17277.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3168.3, ups=0.18, wpb=17277.4, bsz=1024, num_updates=14010, lr=3.41323e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=90510
2024-11-10 11:53:42 - progress_bar.py[line:274] - INFO: epoch 036:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17029.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3108.5, ups=0.18, wpb=17029.6, bsz=1024, num_updates=14020, lr=3.41187e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=90565
2024-11-10 11:54:36 - progress_bar.py[line:274] - INFO: epoch 036:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17279, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3189.4, ups=0.18, wpb=17279, bsz=1024, num_updates=14030, lr=3.41051e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=90619
2024-11-10 11:55:31 - progress_bar.py[line:274] - INFO: epoch 036:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17541.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3173.3, ups=0.18, wpb=17541.5, bsz=1024, num_updates=14040, lr=3.40915e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=90674
2024-11-10 11:56:25 - progress_bar.py[line:274] - INFO: epoch 036:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17538.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3285.4, ups=0.19, wpb=17538.9, bsz=1024, num_updates=14050, lr=3.40779e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=90728
2024-11-10 11:57:18 - progress_bar.py[line:274] - INFO: epoch 036:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17223.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3233.7, ups=0.19, wpb=17223.4, bsz=1024, num_updates=14060, lr=3.40643e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=90781
2024-11-10 11:57:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 36 @ 14063 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
2024-11-10 11:57:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 11:59:25 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 12:01:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 36 @ 14063 updates, score 0) (writing took 227.38148512598127 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-10 12:02:13 - train.py[line:336] - INFO: end of epoch 36 (average epoch stats below)
2024-11-10 12:02:13 - progress_bar.py[line:282] - INFO: epoch 036 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.838 | ntokens 17169.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.15 | wps 2592.2 | ups 0.15 | wpb 17169.9 | bsz 1023 | num_updates 14063 | lr 3.40602e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1196 | gb_free 13.4 | wall 91076
2024-11-10 12:02:13 - trainer.py[line:639] - INFO: loading train data for epoch 37
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 12:04:55 - trainer.py[line:703] - INFO: begin training epoch 37
2024-11-10 12:04:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 12:05:35 - progress_bar.py[line:274] - INFO: epoch 037:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=16508.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=332.3, ups=0.02, wpb=16508.7, bsz=985.6, num_updates=14070, lr=3.40507e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=29, gb_free=13.4, wall=91278
2024-11-10 12:06:30 - progress_bar.py[line:274] - INFO: epoch 037:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17386.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3163.4, ups=0.18, wpb=17386.4, bsz=1024, num_updates=14080, lr=3.40371e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=91333
2024-11-10 12:07:24 - progress_bar.py[line:274] - INFO: epoch 037:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17208.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3163.3, ups=0.18, wpb=17208.2, bsz=1024, num_updates=14090, lr=3.40235e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=91387
2024-11-10 12:08:19 - progress_bar.py[line:274] - INFO: epoch 037:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17196.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3150.5, ups=0.18, wpb=17196.9, bsz=1024, num_updates=14100, lr=3.40099e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=91442
2024-11-10 12:09:13 - progress_bar.py[line:274] - INFO: epoch 037:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17315.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3174.5, ups=0.18, wpb=17315.2, bsz=1024, num_updates=14110, lr=3.39963e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=12.9, wall=91496
2024-11-10 12:10:08 - progress_bar.py[line:274] - INFO: epoch 037:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3141.4, ups=0.18, wpb=17245.1, bsz=1024, num_updates=14120, lr=3.39827e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=91551
2024-11-10 12:10:24 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 12:11:08 - progress_bar.py[line:274] - INFO: epoch 037:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=16851.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2812.6, ups=0.17, wpb=16851.6, bsz=1024, num_updates=14130, lr=3.39691e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=91611
2024-11-10 12:12:03 - progress_bar.py[line:274] - INFO: epoch 037:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17256.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3142.2, ups=0.18, wpb=17256.7, bsz=1024, num_updates=14140, lr=3.39555e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=91666
2024-11-10 12:12:58 - progress_bar.py[line:274] - INFO: epoch 037:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17283.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3161.7, ups=0.18, wpb=17283.5, bsz=1024, num_updates=14150, lr=3.39419e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=91721
2024-11-10 12:13:53 - progress_bar.py[line:274] - INFO: epoch 037:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17203.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3123.4, ups=0.18, wpb=17203.5, bsz=1024, num_updates=14160, lr=3.39283e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=91776
2024-11-10 12:14:47 - progress_bar.py[line:274] - INFO: epoch 037:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17321.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3164.3, ups=0.18, wpb=17321.8, bsz=1024, num_updates=14170, lr=3.39147e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=91830
2024-11-10 12:15:42 - progress_bar.py[line:274] - INFO: epoch 037:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17363.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3171.7, ups=0.18, wpb=17363.3, bsz=1024, num_updates=14180, lr=3.39011e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=91885
2024-11-10 12:16:37 - progress_bar.py[line:274] - INFO: epoch 037:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17094.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3124, ups=0.18, wpb=17094.5, bsz=1024, num_updates=14190, lr=3.38875e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=91940
2024-11-10 12:17:31 - progress_bar.py[line:274] - INFO: epoch 037:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=16976.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3123.4, ups=0.18, wpb=16976.2, bsz=1024, num_updates=14200, lr=3.38739e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=91994
2024-11-10 12:18:26 - progress_bar.py[line:274] - INFO: epoch 037:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=16908.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3089.4, ups=0.18, wpb=16908.4, bsz=1024, num_updates=14210, lr=3.38603e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=92049
2024-11-10 12:19:21 - progress_bar.py[line:274] - INFO: epoch 037:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17089.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3108.7, ups=0.18, wpb=17089.4, bsz=1024, num_updates=14220, lr=3.38467e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92104
2024-11-10 12:20:16 - progress_bar.py[line:274] - INFO: epoch 037:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17295.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3157.2, ups=0.18, wpb=17295.4, bsz=1024, num_updates=14230, lr=3.38331e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=92159
2024-11-10 12:21:10 - progress_bar.py[line:274] - INFO: epoch 037:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17203.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3148, ups=0.18, wpb=17203.7, bsz=1024, num_updates=14240, lr=3.38194e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=92213
2024-11-10 12:22:05 - progress_bar.py[line:274] - INFO: epoch 037:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=16929.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3090.4, ups=0.18, wpb=16929.4, bsz=1024, num_updates=14250, lr=3.38058e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92268
2024-11-10 12:23:00 - progress_bar.py[line:274] - INFO: epoch 037:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17368.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3143.6, ups=0.18, wpb=17368.8, bsz=1024, num_updates=14260, lr=3.37922e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=92323
2024-11-10 12:23:55 - progress_bar.py[line:274] - INFO: epoch 037:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17118.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3132, ups=0.18, wpb=17118.3, bsz=1024, num_updates=14270, lr=3.37786e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=92378
2024-11-10 12:24:50 - progress_bar.py[line:274] - INFO: epoch 037:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=16908, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3101.5, ups=0.18, wpb=16908, bsz=1024, num_updates=14280, lr=3.3765e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=92432
2024-11-10 12:25:44 - progress_bar.py[line:274] - INFO: epoch 037:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17239.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3151.4, ups=0.18, wpb=17239.2, bsz=1024, num_updates=14290, lr=3.37514e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92487
2024-11-10 12:26:39 - progress_bar.py[line:274] - INFO: epoch 037:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=16996.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3106.3, ups=0.18, wpb=16996.8, bsz=1024, num_updates=14300, lr=3.37378e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=92542
2024-11-10 12:27:34 - progress_bar.py[line:274] - INFO: epoch 037:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17030.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3095.1, ups=0.18, wpb=17030.9, bsz=1024, num_updates=14310, lr=3.37242e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92597
2024-11-10 12:28:29 - progress_bar.py[line:274] - INFO: epoch 037:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17261.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3132.3, ups=0.18, wpb=17261.9, bsz=1024, num_updates=14320, lr=3.37106e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92652
2024-11-10 12:29:24 - progress_bar.py[line:274] - INFO: epoch 037:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17315.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3147.6, ups=0.18, wpb=17315.6, bsz=1024, num_updates=14330, lr=3.3697e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92707
2024-11-10 12:30:19 - progress_bar.py[line:274] - INFO: epoch 037:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17160.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3153, ups=0.18, wpb=17160.1, bsz=1024, num_updates=14340, lr=3.36834e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=92761
2024-11-10 12:31:13 - progress_bar.py[line:274] - INFO: epoch 037:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17179.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3168.3, ups=0.18, wpb=17179.8, bsz=1024, num_updates=14350, lr=3.36698e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=92816
2024-11-10 12:32:07 - progress_bar.py[line:274] - INFO: epoch 037:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17245.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3155.1, ups=0.18, wpb=17245.4, bsz=1024, num_updates=14360, lr=3.36562e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=92870
2024-11-10 12:33:02 - progress_bar.py[line:274] - INFO: epoch 037:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17162.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3170.8, ups=0.18, wpb=17162.9, bsz=1024, num_updates=14370, lr=3.36426e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=92925
2024-11-10 12:33:58 - progress_bar.py[line:274] - INFO: epoch 037:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17157.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3050.1, ups=0.18, wpb=17157.8, bsz=1024, num_updates=14380, lr=3.3629e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=92981
2024-11-10 12:34:57 - progress_bar.py[line:274] - INFO: epoch 037:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17059, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2905.1, ups=0.17, wpb=17059, bsz=1024, num_updates=14390, lr=3.36154e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=93039
2024-11-10 12:35:57 - progress_bar.py[line:274] - INFO: epoch 037:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17061.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=2802.6, ups=0.16, wpb=17061.3, bsz=1024, num_updates=14400, lr=3.36018e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=93100
2024-11-10 12:36:58 - progress_bar.py[line:274] - INFO: epoch 037:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17181.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=2854.7, ups=0.17, wpb=17181.7, bsz=1024, num_updates=14410, lr=3.35882e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=60, gb_free=13.4, wall=93161
2024-11-10 12:37:55 - progress_bar.py[line:274] - INFO: epoch 037:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17556.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3056.7, ups=0.17, wpb=17556.1, bsz=1024, num_updates=14420, lr=3.35746e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=93218
2024-11-10 12:38:56 - progress_bar.py[line:274] - INFO: epoch 037:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17483.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=2888.9, ups=0.17, wpb=17483.9, bsz=1024, num_updates=14430, lr=3.3561e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=60, gb_free=13.3, wall=93279
2024-11-10 12:39:56 - progress_bar.py[line:274] - INFO: epoch 037:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17359.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=2859.8, ups=0.16, wpb=17359.2, bsz=1024, num_updates=14440, lr=3.35474e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=61, gb_free=13.5, wall=93339
2024-11-10 12:40:56 - progress_bar.py[line:274] - INFO: epoch 037:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17180.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=2896.6, ups=0.17, wpb=17180.2, bsz=1024, num_updates=14450, lr=3.35338e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=59, gb_free=13.1, wall=93399
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
2024-11-10 12:41:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 37 @ 14453 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
2024-11-10 12:41:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 12:43:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 12:45:02 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 37 @ 14453 updates, score 0) (writing took 231.3605949729681 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-10 12:45:58 - train.py[line:336] - INFO: end of epoch 37 (average epoch stats below)
2024-11-10 12:45:58 - progress_bar.py[line:282] - INFO: epoch 037 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.818 | ntokens 17169.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.05 | wps 2551.5 | ups 0.15 | wpb 17169.5 | bsz 1023 | num_updates 14453 | lr 3.35297e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1386 | gb_free 13.2 | wall 93701
2024-11-10 12:45:58 - trainer.py[line:639] - INFO: loading train data for epoch 38
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 12:48:39 - trainer.py[line:703] - INFO: begin training epoch 38
2024-11-10 12:48:39 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 12:49:20 - progress_bar.py[line:274] - INFO: epoch 038:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=16601.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=329.2, ups=0.02, wpb=16601.4, bsz=985.6, num_updates=14460, lr=3.35202e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=93903
2024-11-10 12:50:14 - progress_bar.py[line:274] - INFO: epoch 038:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=16986.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3116.2, ups=0.18, wpb=16986.9, bsz=1024, num_updates=14470, lr=3.35066e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=93957
2024-11-10 12:51:09 - progress_bar.py[line:274] - INFO: epoch 038:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17230.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3126.4, ups=0.18, wpb=17230.5, bsz=1024, num_updates=14480, lr=3.3493e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=94012
2024-11-10 12:52:04 - progress_bar.py[line:274] - INFO: epoch 038:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17135.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3125.5, ups=0.18, wpb=17135.4, bsz=1024, num_updates=14490, lr=3.34793e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=94067
2024-11-10 12:52:59 - progress_bar.py[line:274] - INFO: epoch 038:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17189.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3127.5, ups=0.18, wpb=17189.3, bsz=1024, num_updates=14500, lr=3.34657e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=94122
2024-11-10 12:53:54 - progress_bar.py[line:274] - INFO: epoch 038:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17289.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3140.3, ups=0.18, wpb=17289.2, bsz=1024, num_updates=14510, lr=3.34521e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=94177
2024-11-10 12:54:50 - progress_bar.py[line:274] - INFO: epoch 038:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17104, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3091.5, ups=0.18, wpb=17104, bsz=1024, num_updates=14520, lr=3.34385e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=94233
2024-11-10 12:55:45 - progress_bar.py[line:274] - INFO: epoch 038:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17142.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3116.7, ups=0.18, wpb=17142.6, bsz=1024, num_updates=14530, lr=3.34249e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=94288
2024-11-10 12:56:40 - progress_bar.py[line:274] - INFO: epoch 038:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17291.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3123.2, ups=0.18, wpb=17291.6, bsz=1024, num_updates=14540, lr=3.34113e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=94343
2024-11-10 12:57:35 - progress_bar.py[line:274] - INFO: epoch 038:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17103.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3088, ups=0.18, wpb=17103.9, bsz=1024, num_updates=14550, lr=3.33977e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=94398
2024-11-10 12:58:31 - progress_bar.py[line:274] - INFO: epoch 038:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17209.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3098.9, ups=0.18, wpb=17209.2, bsz=1024, num_updates=14560, lr=3.33841e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=94454
2024-11-10 12:59:27 - progress_bar.py[line:274] - INFO: epoch 038:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17228.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3094.3, ups=0.18, wpb=17228.8, bsz=1024, num_updates=14570, lr=3.33705e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=94510
2024-11-10 13:00:22 - progress_bar.py[line:274] - INFO: epoch 038:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3119.4, ups=0.18, wpb=17251.2, bsz=1024, num_updates=14580, lr=3.33569e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=94565
2024-11-10 13:01:17 - progress_bar.py[line:274] - INFO: epoch 038:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17118.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3084.2, ups=0.18, wpb=17118.5, bsz=1024, num_updates=14590, lr=3.33433e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=94620
2024-11-10 13:02:13 - progress_bar.py[line:274] - INFO: epoch 038:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17072.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3075.7, ups=0.18, wpb=17072.5, bsz=1024, num_updates=14600, lr=3.33297e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=94676
2024-11-10 13:03:09 - progress_bar.py[line:274] - INFO: epoch 038:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17200.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3094.6, ups=0.18, wpb=17200.4, bsz=1024, num_updates=14610, lr=3.33161e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=94731
2024-11-10 13:04:04 - progress_bar.py[line:274] - INFO: epoch 038:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=16974.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3058, ups=0.18, wpb=16974.3, bsz=1024, num_updates=14620, lr=3.33025e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=39, gb_free=13.2, wall=94787
2024-11-10 13:04:59 - progress_bar.py[line:274] - INFO: epoch 038:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17457, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3204.6, ups=0.18, wpb=17457, bsz=1024, num_updates=14630, lr=3.32889e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=94841
2024-11-10 13:05:54 - progress_bar.py[line:274] - INFO: epoch 038:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17123.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3090.3, ups=0.18, wpb=17123.3, bsz=1024, num_updates=14640, lr=3.32753e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=94897
2024-11-10 13:06:49 - progress_bar.py[line:274] - INFO: epoch 038:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17014.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3064.4, ups=0.18, wpb=17014.4, bsz=1024, num_updates=14650, lr=3.32617e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=94952
2024-11-10 13:07:45 - progress_bar.py[line:274] - INFO: epoch 038:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17010.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3054.6, ups=0.18, wpb=17010.7, bsz=1024, num_updates=14660, lr=3.32481e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=95008
2024-11-10 13:08:40 - progress_bar.py[line:274] - INFO: epoch 038:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17189, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3112.2, ups=0.18, wpb=17189, bsz=1024, num_updates=14670, lr=3.32345e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=95063
2024-11-10 13:09:36 - progress_bar.py[line:274] - INFO: epoch 038:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17141, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3093, ups=0.18, wpb=17141, bsz=1024, num_updates=14680, lr=3.32209e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=95119
2024-11-10 13:10:31 - progress_bar.py[line:274] - INFO: epoch 038:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17100.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3082.9, ups=0.18, wpb=17100.7, bsz=1024, num_updates=14690, lr=3.32073e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=95174
2024-11-10 13:11:27 - progress_bar.py[line:274] - INFO: epoch 038:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17340, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3099.4, ups=0.18, wpb=17340, bsz=1024, num_updates=14700, lr=3.31937e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=95230
2024-11-10 13:12:22 - progress_bar.py[line:274] - INFO: epoch 038:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17162.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3109.1, ups=0.18, wpb=17162.4, bsz=1024, num_updates=14710, lr=3.31801e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=95285
2024-11-10 13:13:18 - progress_bar.py[line:274] - INFO: epoch 038:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17386.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3134, ups=0.18, wpb=17386.5, bsz=1024, num_updates=14720, lr=3.31665e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=95341
2024-11-10 13:14:13 - progress_bar.py[line:274] - INFO: epoch 038:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=16967.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3059.4, ups=0.18, wpb=16967.7, bsz=1024, num_updates=14730, lr=3.31529e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=95396
2024-11-10 13:15:08 - progress_bar.py[line:274] - INFO: epoch 038:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17205.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3132.7, ups=0.18, wpb=17205.7, bsz=1024, num_updates=14740, lr=3.31393e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=95451
2024-11-10 13:16:04 - progress_bar.py[line:274] - INFO: epoch 038:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17220.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3114.6, ups=0.18, wpb=17220.5, bsz=1024, num_updates=14750, lr=3.31256e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=95506
2024-11-10 13:16:59 - progress_bar.py[line:274] - INFO: epoch 038:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17045.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3077.6, ups=0.18, wpb=17045.8, bsz=1024, num_updates=14760, lr=3.3112e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=95562
2024-11-10 13:17:54 - progress_bar.py[line:274] - INFO: epoch 038:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17269.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3131.8, ups=0.18, wpb=17269.9, bsz=1024, num_updates=14770, lr=3.30984e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=95617
2024-11-10 13:18:49 - progress_bar.py[line:274] - INFO: epoch 038:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17288.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3156.8, ups=0.18, wpb=17288.7, bsz=1024, num_updates=14780, lr=3.30848e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=95672
2024-11-10 13:19:44 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 13:19:50 - progress_bar.py[line:274] - INFO: epoch 038:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17387.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=2844.7, ups=0.16, wpb=17387.6, bsz=1024, num_updates=14790, lr=3.30712e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=95733
2024-11-10 13:20:45 - progress_bar.py[line:274] - INFO: epoch 038:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=16918.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3070.2, ups=0.18, wpb=16918.3, bsz=1024, num_updates=14800, lr=3.30576e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=38, gb_free=13, wall=95788
2024-11-10 13:21:41 - progress_bar.py[line:274] - INFO: epoch 038:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17104.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3072.4, ups=0.18, wpb=17104.5, bsz=1024, num_updates=14810, lr=3.3044e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=95844
2024-11-10 13:22:36 - progress_bar.py[line:274] - INFO: epoch 038:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17307, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3160.3, ups=0.18, wpb=17307, bsz=1024, num_updates=14820, lr=3.30304e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=95898
2024-11-10 13:23:30 - progress_bar.py[line:274] - INFO: epoch 038:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3217.1, ups=0.18, wpb=17525.8, bsz=1024, num_updates=14830, lr=3.30168e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.1, wall=95953
2024-11-10 13:24:26 - progress_bar.py[line:274] - INFO: epoch 038:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17254.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3089.2, ups=0.18, wpb=17254.1, bsz=1024, num_updates=14840, lr=3.30032e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.1, wall=96009
2024-11-10 13:24:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 38 @ 14843 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
2024-11-10 13:24:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt': File exists: File exists
: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 13:26:24 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-10 13:28:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 38 @ 14843 updates, score 0) (writing took 218.89218316902407 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-10 13:29:14 - train.py[line:336] - INFO: end of epoch 38 (average epoch stats below)
2024-11-10 13:29:14 - progress_bar.py[line:282] - INFO: epoch 038 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.81 | ntokens 17168.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.01 | wps 2579.3 | ups 0.15 | wpb 17168.8 | bsz 1023 | num_updates 14843 | lr 3.29991e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1250 | gb_free 13.2 | wall 96297
2024-11-10 13:29:14 - trainer.py[line:639] - INFO: loading train data for epoch 39
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 13:31:55 - trainer.py[line:703] - INFO: begin training epoch 39
2024-11-10 13:31:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 13:32:37 - progress_bar.py[line:274] - INFO: epoch 039:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=16540.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=336.8, ups=0.02, wpb=16540.2, bsz=985.6, num_updates=14850, lr=3.29896e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=35, gb_free=13.4, wall=96500
2024-11-10 13:33:32 - progress_bar.py[line:274] - INFO: epoch 039:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17145.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3117.8, ups=0.18, wpb=17145.7, bsz=1024, num_updates=14860, lr=3.2976e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=96555
2024-11-10 13:34:28 - progress_bar.py[line:274] - INFO: epoch 039:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17310, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3113.7, ups=0.18, wpb=17310, bsz=1024, num_updates=14870, lr=3.29624e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=96610
2024-11-10 13:35:22 - progress_bar.py[line:274] - INFO: epoch 039:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=16922.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3102.6, ups=0.18, wpb=16922.9, bsz=1024, num_updates=14880, lr=3.29488e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=96665
2024-11-10 13:36:19 - progress_bar.py[line:274] - INFO: epoch 039:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17353.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3073, ups=0.18, wpb=17353.4, bsz=1024, num_updates=14890, lr=3.29352e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=96721
2024-11-10 13:37:12 - progress_bar.py[line:274] - INFO: epoch 039:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17220.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3198.4, ups=0.19, wpb=17220.4, bsz=1024, num_updates=14900, lr=3.29216e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=39, gb_free=13.5, wall=96775
2024-11-10 13:38:09 - progress_bar.py[line:274] - INFO: epoch 039:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=16983.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3017.6, ups=0.18, wpb=16983.4, bsz=1024, num_updates=14910, lr=3.2908e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=35, gb_free=13.4, wall=96832
2024-11-10 13:39:07 - progress_bar.py[line:274] - INFO: epoch 039:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17130.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2949.6, ups=0.17, wpb=17130.2, bsz=1024, num_updates=14920, lr=3.28944e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=96890
2024-11-10 13:40:05 - progress_bar.py[line:274] - INFO: epoch 039:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17477.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3013.3, ups=0.17, wpb=17477.8, bsz=1024, num_updates=14930, lr=3.28808e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=96948
2024-11-10 13:40:57 - progress_bar.py[line:274] - INFO: epoch 039:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17106.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3255.5, ups=0.19, wpb=17106.9, bsz=1024, num_updates=14940, lr=3.28672e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=48, gb_free=13.4, wall=97000
2024-11-10 13:41:54 - progress_bar.py[line:274] - INFO: epoch 039:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17319.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3052.3, ups=0.18, wpb=17319.5, bsz=1024, num_updates=14950, lr=3.28536e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=97057
2024-11-10 13:42:48 - progress_bar.py[line:274] - INFO: epoch 039:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17148.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3163.8, ups=0.18, wpb=17148.3, bsz=1024, num_updates=14960, lr=3.284e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=43, gb_free=13.3, wall=97111
2024-11-10 13:43:43 - progress_bar.py[line:274] - INFO: epoch 039:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3174.8, ups=0.18, wpb=17227.5, bsz=1024, num_updates=14970, lr=3.28264e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=46, gb_free=13.5, wall=97165
2024-11-10 13:44:39 - progress_bar.py[line:274] - INFO: epoch 039:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17154.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3040.9, ups=0.18, wpb=17154.3, bsz=1024, num_updates=14980, lr=3.28128e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=97222
2024-11-10 13:45:35 - progress_bar.py[line:274] - INFO: epoch 039:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=16922.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3014.4, ups=0.18, wpb=16922.6, bsz=1024, num_updates=14990, lr=3.27992e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=97278
2024-11-10 13:46:33 - progress_bar.py[line:274] - INFO: epoch 039:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17277.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3008, ups=0.17, wpb=17277.4, bsz=1024, num_updates=15000, lr=3.27855e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=97335
loss_reg: 0.007023179794912088 loss_cls: 0.003629629733040929
loss_reg: 0.005512257883783427 loss_cls: 0.0035782367922365665
loss_reg: 0.0069255412817573045 loss_cls: 0.0032331759575754404
loss_reg: 0.005481173432998107 loss_cls: 0.003571461420506239
loss_reg: 0.006677207846356644 loss_cls: 0.004230591002851725
loss_reg: 0.00601167666015773 loss_cls: 0.004216368775814772
loss_reg: 0.009434962146205341 loss_cls: 0.003015663241967559
loss_reg: 0.0053066348953595835 loss_cls: 0.003316928632557392
loss_reg: 0.0062563361559685995 loss_cls: 0.004680498503148556
loss_reg: 0.005298965900707914 loss_cls: 0.0036100244615226984
loss_reg: 0.0062089231056720534 loss_cls: 0.004216205794364214
loss_reg: 0.006266327383346355 loss_cls: 0.0051534646190702915
loss_reg: 0.007254490240879662 loss_cls: 0.0034965083468705416
loss_reg: 0.005289518079003017 loss_cls: 0.004162009339779615
loss_reg: 0.0073164319813634835 loss_cls: 0.0035590750630944967
loss_reg: 0.008289164508342894 loss_cls: 0.004098272882401943
loss_reg: 0.00739276849766299 loss_cls: 0.0028858839068561792
loss_reg: 0.006998892580536332 loss_cls: 0.00419811625033617
loss_reg: 0.007016176765493806 loss_cls: 0.003662561532109976
loss_reg: 0.007513011417314472 loss_cls: 0.0035427238326519728
loss_reg: 0.005863759058952199 loss_cls: 0.003809100715443492
loss_reg: 0.006620347574498571 loss_cls: 0.00344232190400362
loss_reg: 0.0068832603787328354 loss_cls: 0.003665613243356347
loss_reg: 0.0063332124022968525 loss_cls: 0.003004724159836769
loss_reg: 0.00859153358869868 loss_cls: 0.004606290720403194
loss_reg: 0.006582381299572749 loss_cls: 0.0036875808145850897
loss_reg: 0.006602025399046976 loss_cls: 0.003711378900334239
loss_reg: 0.005825220650085307 loss_cls: 0.003386622993275523
loss_reg: 0.006789971816141528 loss_cls: 0.0037632191088050604
loss_reg: 0.007570106299628846 loss_cls: 0.003344176337122917
loss_reg: 0.005355812705941948 loss_cls: 0.004202686715871096
loss_reg: 0.006486593871199715 loss_cls: 0.003549449611455202
loss_reg: 0.005898757900289383 loss_cls: 0.0031475552823394537
loss_reg: 0.007608839434966103 loss_cls: 0.00468306802213192
loss_reg: 0.0062160006516742495 loss_cls: 0.0028794656973332167
loss_reg: 0.006606676102884896 loss_cls: 0.003593302331864834
loss_reg: 0.007870323840978825 loss_cls: 0.00352097419090569
loss_reg: 0.007233156092542487 loss_cls: 0.0029056824278086424
loss_reg: 0.00602391448578753 loss_cls: 0.0033994761761277914
loss_reg: 0.006614753561424368 loss_cls: 0.003516720375046134
loss_reg: 0.006590263830332136 loss_cls: 0.0037160180509090424
loss_reg: 0.005925901305483339 loss_cls: 0.003362529445439577
loss_reg: 0.007593741273178239 loss_cls: 0.0038453892339020967
loss_reg: 0.009536457340522154 loss_cls: 0.0034358049742877483
loss_reg: 0.00884536133578352 loss_cls: 0.00390625512227416
loss_reg: 0.00671038739807604 loss_cls: 0.0036216231528669596
loss_reg: 0.007473468370854837 loss_cls: 0.0030313569586724043
loss_reg: 0.007354544430645957 loss_cls: 0.002891289070248604
loss_reg: 0.005955278143246327 loss_cls: 0.003866734681650996
loss_reg: 0.005213328226212408 loss_cls: 0.003373564686626196
loss_reg: 0.007427971339611179 loss_cls: 0.0036180473398417234
loss_reg: 0.004905907877345606 loss_cls: 0.004091257229447365
loss_reg: 0.008028002762299312 loss_cls: 0.003262932877987623
loss_reg: 0.006401081596956282 loss_cls: 0.0038767766673117876
loss_reg: 0.0048631394324571055 loss_cls: 0.003855467541143298
loss_reg: 0.0045539973212913275 loss_cls: 0.004735184833407402
loss_reg: 0.005737979102323289 loss_cls: 0.003537150099873543
loss_reg: 0.005343066951418227 loss_cls: 0.004313770681619644
loss_reg: 0.006289410109876355 loss_cls: 0.0036349298898130655
loss_reg: 0.006236453175229091 loss_cls: 0.0031626997515559196
loss_reg: 0.0067189797456555156 loss_cls: 0.002933039329946041
loss_reg: 0.006644297676689521 loss_cls: 0.004114109091460705
loss_reg: 0.009443089326514506 loss_cls: 0.0038773242849856615
loss_reg: 0.005089520608144255 loss_cls: 0.002937865909188986
2024-11-10 13:47:27 - progress_bar.py[line:274] - INFO: epoch 039:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17064.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3108.2, ups=0.18, wpb=17064.8, bsz=1024, num_updates=15010, lr=3.27719e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=97390
2024-11-10 13:48:21 - progress_bar.py[line:274] - INFO: epoch 039:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17019, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3205.6, ups=0.19, wpb=17019, bsz=1024, num_updates=15020, lr=3.27583e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=97443
2024-11-10 13:49:17 - progress_bar.py[line:274] - INFO: epoch 039:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17028.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3032.9, ups=0.18, wpb=17028.8, bsz=1024, num_updates=15030, lr=3.27447e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=97500
2024-11-10 13:50:12 - progress_bar.py[line:274] - INFO: epoch 039:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17016.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3101.8, ups=0.18, wpb=17016.9, bsz=1024, num_updates=15040, lr=3.27311e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=97554
2024-11-10 13:51:07 - progress_bar.py[line:274] - INFO: epoch 039:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17182.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3085.4, ups=0.18, wpb=17182.2, bsz=1024, num_updates=15050, lr=3.27175e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=97610
2024-11-10 13:52:03 - progress_bar.py[line:274] - INFO: epoch 039:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17066.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3055.9, ups=0.18, wpb=17066.4, bsz=1024, num_updates=15060, lr=3.27039e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=97666
2024-11-10 13:52:58 - progress_bar.py[line:274] - INFO: epoch 039:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17243.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3122.1, ups=0.18, wpb=17243.6, bsz=1024, num_updates=15070, lr=3.26903e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=97721
2024-11-10 13:53:54 - progress_bar.py[line:274] - INFO: epoch 039:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17094.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3082.8, ups=0.18, wpb=17094.2, bsz=1024, num_updates=15080, lr=3.26767e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=97777
2024-11-10 13:54:50 - progress_bar.py[line:274] - INFO: epoch 039:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17412.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3104.4, ups=0.18, wpb=17412.4, bsz=1024, num_updates=15090, lr=3.26631e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=97833
2024-11-10 13:55:45 - progress_bar.py[line:274] - INFO: epoch 039:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17400.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3171.7, ups=0.18, wpb=17400.2, bsz=1024, num_updates=15100, lr=3.26495e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=42, gb_free=12.7, wall=97888
2024-11-10 13:56:39 - progress_bar.py[line:274] - INFO: epoch 039:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17284.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3155.1, ups=0.18, wpb=17284.4, bsz=1024, num_updates=15110, lr=3.26359e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=97942
2024-11-10 13:57:36 - progress_bar.py[line:274] - INFO: epoch 039:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17080.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3018.7, ups=0.18, wpb=17080.3, bsz=1024, num_updates=15120, lr=3.26223e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=35, gb_free=13.1, wall=97999
2024-11-10 13:58:33 - progress_bar.py[line:274] - INFO: epoch 039:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17221.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3029, ups=0.18, wpb=17221.7, bsz=1024, num_updates=15130, lr=3.26087e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=54, gb_free=13.1, wall=98056
2024-11-10 13:59:25 - progress_bar.py[line:274] - INFO: epoch 039:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17294.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3292.7, ups=0.19, wpb=17294.3, bsz=1024, num_updates=15140, lr=3.25951e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=48, gb_free=13.2, wall=98108
2024-11-10 14:00:23 - progress_bar.py[line:274] - INFO: epoch 039:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3002.4, ups=0.17, wpb=17274.5, bsz=1024, num_updates=15150, lr=3.25815e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=13.5, wall=98166
2024-11-10 14:01:19 - progress_bar.py[line:274] - INFO: epoch 039:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17467.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3128.1, ups=0.18, wpb=17467.9, bsz=1024, num_updates=15160, lr=3.25679e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=98222
2024-11-10 14:02:14 - progress_bar.py[line:274] - INFO: epoch 039:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17093.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3097.7, ups=0.18, wpb=17093.2, bsz=1024, num_updates=15170, lr=3.25543e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=98277
2024-11-10 14:03:11 - progress_bar.py[line:274] - INFO: epoch 039:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17159.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3007.2, ups=0.18, wpb=17159.4, bsz=1024, num_updates=15180, lr=3.25407e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=98334
2024-11-10 14:04:08 - progress_bar.py[line:274] - INFO: epoch 039:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=16833.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2954.6, ups=0.18, wpb=16833.1, bsz=1024, num_updates=15190, lr=3.25271e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=98391
2024-11-10 14:05:01 - progress_bar.py[line:274] - INFO: epoch 039:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17099, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3210.9, ups=0.19, wpb=17099, bsz=1024, num_updates=15200, lr=3.25135e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=98444
2024-11-10 14:05:56 - progress_bar.py[line:274] - INFO: epoch 039:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17463.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3200.4, ups=0.18, wpb=17463.1, bsz=1024, num_updates=15210, lr=3.24999e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=40, gb_free=13.3, wall=98499
2024-11-10 14:06:53 - progress_bar.py[line:274] - INFO: epoch 039:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17415, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3048.8, ups=0.18, wpb=17415, bsz=1024, num_updates=15220, lr=3.24863e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=98556
2024-11-10 14:07:48 - progress_bar.py[line:274] - INFO: epoch 039:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17077.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3086.5, ups=0.18, wpb=17077.7, bsz=1024, num_updates=15230, lr=3.24727e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=98611
2024-11-10 14:08:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 39 @ 15234 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
2024-11-10 14:08:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt': File exists: File exists

: File exists
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 14:09:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 14:11:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 39 @ 15234 updates, score 0) (writing took 221.98660735500744 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-10 14:12:42 - train.py[line:336] - INFO: end of epoch 39 (average epoch stats below)
2024-11-10 14:12:42 - progress_bar.py[line:282] - INFO: epoch 039 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.798 | ntokens 17169.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.95 | wps 2573.3 | ups 0.15 | wpb 17169.3 | bsz 1023 | num_updates 15234 | lr 3.24672e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1691 | gb_free 13.3 | wall 98905
2024-11-10 14:12:42 - trainer.py[line:639] - INFO: loading train data for epoch 40
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 14:15:24 - trainer.py[line:703] - INFO: begin training epoch 40
2024-11-10 14:15:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 14:15:59 - progress_bar.py[line:274] - INFO: epoch 040:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=16779, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=342, ups=0.02, wpb=16779, bsz=985.6, num_updates=15240, lr=3.24591e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=13.4, wall=99102
2024-11-10 14:16:55 - progress_bar.py[line:274] - INFO: epoch 040:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17379.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3101.5, ups=0.18, wpb=17379.6, bsz=1024, num_updates=15250, lr=3.24454e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=99158
2024-11-10 14:17:51 - progress_bar.py[line:274] - INFO: epoch 040:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17172.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3076.3, ups=0.18, wpb=17172.7, bsz=1024, num_updates=15260, lr=3.24318e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=99214
2024-11-10 14:18:47 - progress_bar.py[line:274] - INFO: epoch 040:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17032.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3007.7, ups=0.18, wpb=17032.2, bsz=1024, num_updates=15270, lr=3.24182e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=99270
2024-11-10 14:19:41 - progress_bar.py[line:274] - INFO: epoch 040:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17287.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3201.8, ups=0.19, wpb=17287.5, bsz=1024, num_updates=15280, lr=3.24046e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=99324
2024-11-10 14:20:37 - progress_bar.py[line:274] - INFO: epoch 040:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3100.9, ups=0.18, wpb=17268.7, bsz=1024, num_updates=15290, lr=3.2391e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=99380
2024-11-10 14:21:34 - progress_bar.py[line:274] - INFO: epoch 040:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=16882.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2982.1, ups=0.18, wpb=16882.7, bsz=1024, num_updates=15300, lr=3.23774e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=99437
2024-11-10 14:22:30 - progress_bar.py[line:274] - INFO: epoch 040:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17201.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3033.2, ups=0.18, wpb=17201.6, bsz=1024, num_updates=15310, lr=3.23638e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=99493
2024-11-10 14:23:26 - progress_bar.py[line:274] - INFO: epoch 040:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17467.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3125.3, ups=0.18, wpb=17467.9, bsz=1024, num_updates=15320, lr=3.23502e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=35, gb_free=13.4, wall=99549
2024-11-10 14:24:23 - progress_bar.py[line:274] - INFO: epoch 040:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17087.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3029.6, ups=0.18, wpb=17087.5, bsz=1024, num_updates=15330, lr=3.23366e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.2, wall=99606
2024-11-10 14:25:20 - progress_bar.py[line:274] - INFO: epoch 040:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17442.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3028.2, ups=0.17, wpb=17442.4, bsz=1024, num_updates=15340, lr=3.2323e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=99663
2024-11-10 14:26:16 - progress_bar.py[line:274] - INFO: epoch 040:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17359.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3119.7, ups=0.18, wpb=17359.7, bsz=1024, num_updates=15350, lr=3.23094e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=44, gb_free=13.2, wall=99719
2024-11-10 14:27:12 - progress_bar.py[line:274] - INFO: epoch 040:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17417.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3095.3, ups=0.18, wpb=17417.8, bsz=1024, num_updates=15360, lr=3.22958e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=99775
2024-11-10 14:28:09 - progress_bar.py[line:274] - INFO: epoch 040:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17114.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3033, ups=0.18, wpb=17114.7, bsz=1024, num_updates=15370, lr=3.22822e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=99832
2024-11-10 14:29:02 - progress_bar.py[line:274] - INFO: epoch 040:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17010.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3197.8, ups=0.19, wpb=17010.9, bsz=1024, num_updates=15380, lr=3.22686e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=42, gb_free=13.1, wall=99885
2024-11-10 14:29:58 - progress_bar.py[line:274] - INFO: epoch 040:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17221.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3067.2, ups=0.18, wpb=17221.3, bsz=1024, num_updates=15390, lr=3.2255e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=34, gb_free=13.2, wall=99941
2024-11-10 14:30:53 - progress_bar.py[line:274] - INFO: epoch 040:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17148.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3149.2, ups=0.18, wpb=17148.1, bsz=1024, num_updates=15400, lr=3.22414e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=99995
2024-11-10 14:31:51 - progress_bar.py[line:274] - INFO: epoch 040:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17281.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2955.8, ups=0.17, wpb=17281.7, bsz=1024, num_updates=15410, lr=3.22278e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=44, gb_free=13.3, wall=100054
2024-11-10 14:32:49 - progress_bar.py[line:274] - INFO: epoch 040:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17111.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2959.6, ups=0.17, wpb=17111.1, bsz=1024, num_updates=15420, lr=3.22142e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=100112
2024-11-10 14:33:43 - progress_bar.py[line:274] - INFO: epoch 040:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17185.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3186.6, ups=0.19, wpb=17185.2, bsz=1024, num_updates=15430, lr=3.22006e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=100166
2024-11-10 14:34:38 - progress_bar.py[line:274] - INFO: epoch 040:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=16997, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3073.4, ups=0.18, wpb=16997, bsz=1024, num_updates=15440, lr=3.2187e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=49, gb_free=13.1, wall=100221
2024-11-10 14:35:35 - progress_bar.py[line:274] - INFO: epoch 040:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17181, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3002.9, ups=0.17, wpb=17181, bsz=1024, num_updates=15450, lr=3.21734e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=47, gb_free=13.3, wall=100278
2024-11-10 14:36:29 - progress_bar.py[line:274] - INFO: epoch 040:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17277.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3214.2, ups=0.19, wpb=17277.9, bsz=1024, num_updates=15460, lr=3.21598e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=40, gb_free=13.4, wall=100332
2024-11-10 14:37:27 - progress_bar.py[line:274] - INFO: epoch 040:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17335.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=2973.8, ups=0.17, wpb=17335.3, bsz=1024, num_updates=15470, lr=3.21462e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=50, gb_free=13.4, wall=100390
2024-11-10 14:38:25 - progress_bar.py[line:274] - INFO: epoch 040:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17238.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=2981.8, ups=0.17, wpb=17238.8, bsz=1024, num_updates=15480, lr=3.21326e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.1, wall=100448
2024-11-10 14:39:17 - progress_bar.py[line:274] - INFO: epoch 040:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17151.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3275.3, ups=0.19, wpb=17151.9, bsz=1024, num_updates=15490, lr=3.2119e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=44, gb_free=13.2, wall=100500
2024-11-10 14:40:15 - progress_bar.py[line:274] - INFO: epoch 040:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17241.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3015.5, ups=0.17, wpb=17241.3, bsz=1024, num_updates=15500, lr=3.21053e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=33, gb_free=13.3, wall=100558
2024-11-10 14:41:12 - progress_bar.py[line:274] - INFO: epoch 040:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=16961.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2964.8, ups=0.17, wpb=16961.7, bsz=1024, num_updates=15510, lr=3.20917e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=47, gb_free=13.3, wall=100615
2024-11-10 14:42:05 - progress_bar.py[line:274] - INFO: epoch 040:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17052.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3185.5, ups=0.19, wpb=17052.1, bsz=1024, num_updates=15520, lr=3.20781e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=38, gb_free=13.1, wall=100668
2024-11-10 14:43:03 - progress_bar.py[line:274] - INFO: epoch 040:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17140.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=2986.5, ups=0.17, wpb=17140.4, bsz=1024, num_updates=15530, lr=3.20645e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=42, gb_free=13.3, wall=100726
2024-11-10 14:44:00 - progress_bar.py[line:274] - INFO: epoch 040:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17098.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2980.7, ups=0.17, wpb=17098.9, bsz=1024, num_updates=15540, lr=3.20509e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=100783
2024-11-10 14:44:58 - progress_bar.py[line:274] - INFO: epoch 040:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=16916.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2948.6, ups=0.17, wpb=16916.8, bsz=1024, num_updates=15550, lr=3.20373e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=100840
2024-11-10 14:45:52 - progress_bar.py[line:274] - INFO: epoch 040:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=16986.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3110, ups=0.18, wpb=16986.8, bsz=1024, num_updates=15560, lr=3.20237e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=100895
2024-11-10 14:46:47 - progress_bar.py[line:274] - INFO: epoch 040:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17318, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3173.6, ups=0.18, wpb=17318, bsz=1024, num_updates=15570, lr=3.20101e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=38, gb_free=13.3, wall=100950
2024-11-10 14:47:44 - progress_bar.py[line:274] - INFO: epoch 040:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=16826.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2939.8, ups=0.17, wpb=16826.9, bsz=1024, num_updates=15580, lr=3.19965e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=51, gb_free=13.2, wall=101007
2024-11-10 14:48:37 - progress_bar.py[line:274] - INFO: epoch 040:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17368.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3245.6, ups=0.19, wpb=17368.6, bsz=1024, num_updates=15590, lr=3.19829e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=42, gb_free=13.4, wall=101060
2024-11-10 14:49:34 - progress_bar.py[line:274] - INFO: epoch 040:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17586.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3118.1, ups=0.18, wpb=17586.6, bsz=1024, num_updates=15600, lr=3.19693e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=101117
2024-11-10 14:50:31 - progress_bar.py[line:274] - INFO: epoch 040:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17213, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3007.4, ups=0.17, wpb=17213, bsz=1024, num_updates=15610, lr=3.19557e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=49, gb_free=13.4, wall=101174
2024-11-10 14:51:29 - progress_bar.py[line:274] - INFO: epoch 040:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17296.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=2966.8, ups=0.17, wpb=17296.9, bsz=1024, num_updates=15620, lr=3.19421e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=12.9, wall=101232
2024-11-10 14:51:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 40 @ 15625 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
2024-11-10 14:51:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 14:53:41 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 14:55:35 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 40 @ 15625 updates, score 0) (writing took 221.38232639600756 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-10 14:56:30 - train.py[line:336] - INFO: end of epoch 40 (average epoch stats below)
2024-11-10 14:56:30 - progress_bar.py[line:282] - INFO: epoch 040 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.789 | ntokens 17173.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.91 | wps 2555.5 | ups 0.15 | wpb 17173.4 | bsz 1023 | num_updates 15625 | lr 3.19353e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1678 | gb_free 13.2 | wall 101533
2024-11-10 14:56:30 - trainer.py[line:639] - INFO: loading train data for epoch 41
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 14:59:11 - trainer.py[line:703] - INFO: begin training epoch 41
2024-11-10 14:59:11 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 14:59:42 - progress_bar.py[line:274] - INFO: epoch 041:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=16497.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=335, ups=0.02, wpb=16497.1, bsz=985.6, num_updates=15630, lr=3.19285e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=39, gb_free=13.2, wall=101725
2024-11-10 15:00:38 - progress_bar.py[line:274] - INFO: epoch 041:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17342.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3108, ups=0.18, wpb=17342.8, bsz=1024, num_updates=15640, lr=3.19149e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101781
2024-11-10 15:01:34 - progress_bar.py[line:274] - INFO: epoch 041:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17293.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3078.8, ups=0.18, wpb=17293.1, bsz=1024, num_updates=15650, lr=3.19013e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=101837
2024-11-10 15:02:30 - progress_bar.py[line:274] - INFO: epoch 041:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17087.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3048.9, ups=0.18, wpb=17087.8, bsz=1024, num_updates=15660, lr=3.18877e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=101893
2024-11-10 15:03:25 - progress_bar.py[line:274] - INFO: epoch 041:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17215.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3105.5, ups=0.18, wpb=17215.1, bsz=1024, num_updates=15670, lr=3.18741e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=101948
2024-11-10 15:04:22 - progress_bar.py[line:274] - INFO: epoch 041:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17167.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3048.7, ups=0.18, wpb=17167.2, bsz=1024, num_updates=15680, lr=3.18605e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=102005
2024-11-10 15:05:18 - progress_bar.py[line:274] - INFO: epoch 041:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17044.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3048.3, ups=0.18, wpb=17044.8, bsz=1024, num_updates=15690, lr=3.18469e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=102061
2024-11-10 15:06:13 - progress_bar.py[line:274] - INFO: epoch 041:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=16960.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3060, ups=0.18, wpb=16960.7, bsz=1024, num_updates=15700, lr=3.18333e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=102116
2024-11-10 15:07:09 - progress_bar.py[line:274] - INFO: epoch 041:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17594.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3143.6, ups=0.18, wpb=17594.7, bsz=1024, num_updates=15710, lr=3.18197e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.2, wall=102172
2024-11-10 15:08:05 - progress_bar.py[line:274] - INFO: epoch 041:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17238.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3057, ups=0.18, wpb=17238.1, bsz=1024, num_updates=15720, lr=3.18061e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=102228
2024-11-10 15:09:03 - progress_bar.py[line:274] - INFO: epoch 041:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17197.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3008.2, ups=0.17, wpb=17197.4, bsz=1024, num_updates=15730, lr=3.17925e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=102285
2024-11-10 15:10:00 - progress_bar.py[line:274] - INFO: epoch 041:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17007.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2968.1, ups=0.17, wpb=17007.6, bsz=1024, num_updates=15740, lr=3.17789e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=102343
2024-11-10 15:10:58 - progress_bar.py[line:274] - INFO: epoch 041:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2981.5, ups=0.17, wpb=17226, bsz=1024, num_updates=15750, lr=3.17653e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=102401
2024-11-10 15:11:52 - progress_bar.py[line:274] - INFO: epoch 041:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17079.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3159.3, ups=0.18, wpb=17079.9, bsz=1024, num_updates=15760, lr=3.17516e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.2, wall=102455
2024-11-10 15:12:49 - progress_bar.py[line:274] - INFO: epoch 041:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17265.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3012.3, ups=0.17, wpb=17265.2, bsz=1024, num_updates=15770, lr=3.1738e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=57, gb_free=13, wall=102512
2024-11-10 15:13:44 - progress_bar.py[line:274] - INFO: epoch 041:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17343.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3162.8, ups=0.18, wpb=17343.5, bsz=1024, num_updates=15780, lr=3.17244e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=102567
2024-11-10 15:14:38 - progress_bar.py[line:274] - INFO: epoch 041:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17325.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3188.6, ups=0.18, wpb=17325.3, bsz=1024, num_updates=15790, lr=3.17108e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=102621
2024-11-10 15:15:35 - progress_bar.py[line:274] - INFO: epoch 041:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17022, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3011.6, ups=0.18, wpb=17022, bsz=1024, num_updates=15800, lr=3.16972e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=51, gb_free=13.4, wall=102678
2024-11-10 15:16:29 - progress_bar.py[line:274] - INFO: epoch 041:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=16977.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3125.5, ups=0.18, wpb=16977.3, bsz=1024, num_updates=15810, lr=3.16836e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=102732
2024-11-10 15:17:25 - progress_bar.py[line:274] - INFO: epoch 041:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=16865.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3013.2, ups=0.18, wpb=16865.1, bsz=1024, num_updates=15820, lr=3.167e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=102788
2024-11-10 15:18:22 - progress_bar.py[line:274] - INFO: epoch 041:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17208.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3044.2, ups=0.18, wpb=17208.7, bsz=1024, num_updates=15830, lr=3.16564e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=102844
2024-11-10 15:19:19 - progress_bar.py[line:274] - INFO: epoch 041:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=16967.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2948, ups=0.17, wpb=16967.4, bsz=1024, num_updates=15840, lr=3.16428e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=102902
2024-11-10 15:20:17 - progress_bar.py[line:274] - INFO: epoch 041:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17054.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=2943.2, ups=0.17, wpb=17054.1, bsz=1024, num_updates=15850, lr=3.16292e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=102960
2024-11-10 15:21:13 - progress_bar.py[line:274] - INFO: epoch 041:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17148, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3071, ups=0.18, wpb=17148, bsz=1024, num_updates=15860, lr=3.16156e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=103016
2024-11-10 15:21:39 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-10 15:22:12 - progress_bar.py[line:274] - INFO: epoch 041:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17310.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=2909.3, ups=0.17, wpb=17310.8, bsz=1024, num_updates=15870, lr=3.1602e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=12.9, wall=103075
2024-11-10 15:23:06 - progress_bar.py[line:274] - INFO: epoch 041:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17360.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3214.1, ups=0.19, wpb=17360.2, bsz=1024, num_updates=15880, lr=3.15884e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=43, gb_free=13.2, wall=103129
2024-11-10 15:24:02 - progress_bar.py[line:274] - INFO: epoch 041:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17304.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3116.3, ups=0.18, wpb=17304.4, bsz=1024, num_updates=15890, lr=3.15748e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.3, wall=103185
2024-11-10 15:24:57 - progress_bar.py[line:274] - INFO: epoch 041:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=16979.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3073.1, ups=0.18, wpb=16979.3, bsz=1024, num_updates=15900, lr=3.15612e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=38, gb_free=13.2, wall=103240
2024-11-10 15:25:56 - progress_bar.py[line:274] - INFO: epoch 041:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17207.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2936, ups=0.17, wpb=17207.5, bsz=1024, num_updates=15910, lr=3.15476e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=103299
2024-11-10 15:26:53 - progress_bar.py[line:274] - INFO: epoch 041:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17264.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3020.5, ups=0.17, wpb=17264.1, bsz=1024, num_updates=15920, lr=3.1534e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=103356
2024-11-10 15:27:50 - progress_bar.py[line:274] - INFO: epoch 041:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17222.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3031.7, ups=0.18, wpb=17222.4, bsz=1024, num_updates=15930, lr=3.15204e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.1, wall=103413
2024-11-10 15:28:44 - progress_bar.py[line:274] - INFO: epoch 041:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17016.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3118.8, ups=0.18, wpb=17016.9, bsz=1024, num_updates=15940, lr=3.15068e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=103467
2024-11-10 15:29:40 - progress_bar.py[line:274] - INFO: epoch 041:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17177.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3088.8, ups=0.18, wpb=17177.2, bsz=1024, num_updates=15950, lr=3.14932e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=103523
2024-11-10 15:30:35 - progress_bar.py[line:274] - INFO: epoch 041:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17260.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3132, ups=0.18, wpb=17260.3, bsz=1024, num_updates=15960, lr=3.14796e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=103578
2024-11-10 15:31:33 - progress_bar.py[line:274] - INFO: epoch 041:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17063.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2954.4, ups=0.17, wpb=17063.9, bsz=1024, num_updates=15970, lr=3.1466e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=103636
2024-11-10 15:32:30 - progress_bar.py[line:274] - INFO: epoch 041:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17164.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2996.6, ups=0.17, wpb=17164.8, bsz=1024, num_updates=15980, lr=3.14524e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=103693
2024-11-10 15:33:23 - progress_bar.py[line:274] - INFO: epoch 041:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17592.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3300.1, ups=0.19, wpb=17592.5, bsz=1024, num_updates=15990, lr=3.14388e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=103746
2024-11-10 15:34:21 - progress_bar.py[line:274] - INFO: epoch 041:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17413.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3021.3, ups=0.17, wpb=17413.9, bsz=1024, num_updates=16000, lr=3.14252e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=103804
2024-11-10 15:35:17 - progress_bar.py[line:274] - INFO: epoch 041:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17047.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3048.3, ups=0.18, wpb=17047.7, bsz=1024, num_updates=16010, lr=3.14115e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13, wall=103860
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
2024-11-10 15:35:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 41 @ 16015 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
2024-11-10 15:35:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt': File exists
: File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 15:37:31 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 15:39:24 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 41 @ 16015 updates, score 0) (writing took 222.14734003599733 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-10 15:40:20 - train.py[line:336] - INFO: end of epoch 41 (average epoch stats below)
2024-11-10 15:40:20 - progress_bar.py[line:282] - INFO: epoch 041 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.78 | ntokens 17167.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.87 | wps 2545.9 | ups 0.15 | wpb 17167.8 | bsz 1023 | num_updates 16015 | lr 3.14047e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 1907 | gb_free 13.1 | wall 104163
2024-11-10 15:40:20 - trainer.py[line:639] - INFO: loading train data for epoch 42
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 15:43:01 - trainer.py[line:703] - INFO: begin training epoch 42
2024-11-10 15:43:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 15:43:32 - progress_bar.py[line:274] - INFO: epoch 042:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=16389.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=331.2, ups=0.02, wpb=16389.8, bsz=985.6, num_updates=16020, lr=3.13979e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=40, gb_free=13, wall=104355
2024-11-10 15:44:28 - progress_bar.py[line:274] - INFO: epoch 042:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17378.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3072.5, ups=0.18, wpb=17378.5, bsz=1024, num_updates=16030, lr=3.13843e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=104411
2024-11-10 15:45:26 - progress_bar.py[line:274] - INFO: epoch 042:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17165.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=2975.3, ups=0.17, wpb=17165.7, bsz=1024, num_updates=16040, lr=3.13707e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=34, gb_free=13.3, wall=104469
2024-11-10 15:46:21 - progress_bar.py[line:274] - INFO: epoch 042:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=16989, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3084.9, ups=0.18, wpb=16989, bsz=1024, num_updates=16050, lr=3.13571e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=35, gb_free=13.5, wall=104524
2024-11-10 15:47:19 - progress_bar.py[line:274] - INFO: epoch 042:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17041.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2933.9, ups=0.17, wpb=17041.9, bsz=1024, num_updates=16060, lr=3.13435e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=104582
2024-11-10 15:48:15 - progress_bar.py[line:274] - INFO: epoch 042:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17136.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3067.8, ups=0.18, wpb=17136.7, bsz=1024, num_updates=16070, lr=3.13299e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=104638
2024-11-10 15:49:10 - progress_bar.py[line:274] - INFO: epoch 042:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17138.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3127.8, ups=0.18, wpb=17138.8, bsz=1024, num_updates=16080, lr=3.13163e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=41, gb_free=13.2, wall=104693
2024-11-10 15:50:07 - progress_bar.py[line:274] - INFO: epoch 042:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=16959.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2970.1, ups=0.18, wpb=16959.3, bsz=1024, num_updates=16090, lr=3.13027e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=46, gb_free=13.2, wall=104750
2024-11-10 15:51:01 - progress_bar.py[line:274] - INFO: epoch 042:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17376.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3217.3, ups=0.19, wpb=17376.2, bsz=1024, num_updates=16100, lr=3.12891e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=36, gb_free=13.4, wall=104804
2024-11-10 15:51:59 - progress_bar.py[line:274] - INFO: epoch 042:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17108.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2922.8, ups=0.17, wpb=17108.6, bsz=1024, num_updates=16110, lr=3.12755e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=47, gb_free=13.5, wall=104862
2024-11-10 15:52:55 - progress_bar.py[line:274] - INFO: epoch 042:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17524.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3171.9, ups=0.18, wpb=17524.7, bsz=1024, num_updates=16120, lr=3.12619e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.1, wall=104918
2024-11-10 15:53:49 - progress_bar.py[line:274] - INFO: epoch 042:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17078.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3141.4, ups=0.18, wpb=17078.6, bsz=1024, num_updates=16130, lr=3.12483e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=38, gb_free=13.4, wall=104972
2024-11-10 15:54:46 - progress_bar.py[line:274] - INFO: epoch 042:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17371.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3077.5, ups=0.18, wpb=17371.8, bsz=1024, num_updates=16140, lr=3.12347e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=105028
2024-11-10 15:55:37 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 15:55:48 - progress_bar.py[line:274] - INFO: epoch 042:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17123.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2749.7, ups=0.16, wpb=17123.4, bsz=1024, num_updates=16150, lr=3.12211e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.1, wall=105091
2024-11-10 15:56:45 - progress_bar.py[line:274] - INFO: epoch 042:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17083.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3009.1, ups=0.18, wpb=17083.6, bsz=1024, num_updates=16160, lr=3.12075e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=105147
2024-11-10 15:57:41 - progress_bar.py[line:274] - INFO: epoch 042:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17361.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3089.1, ups=0.18, wpb=17361.3, bsz=1024, num_updates=16170, lr=3.11939e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=105204
2024-11-10 15:58:37 - progress_bar.py[line:274] - INFO: epoch 042:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=16885.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2995.8, ups=0.18, wpb=16885.2, bsz=1024, num_updates=16180, lr=3.11803e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=105260
2024-11-10 15:59:33 - progress_bar.py[line:274] - INFO: epoch 042:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17269.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3072.9, ups=0.18, wpb=17269.1, bsz=1024, num_updates=16190, lr=3.11667e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=105316
2024-11-10 16:00:30 - progress_bar.py[line:274] - INFO: epoch 042:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17020.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3009.4, ups=0.18, wpb=17020.5, bsz=1024, num_updates=16200, lr=3.11531e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=105373
2024-11-10 16:01:27 - progress_bar.py[line:274] - INFO: epoch 042:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17204.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3004.4, ups=0.17, wpb=17204.5, bsz=1024, num_updates=16210, lr=3.11395e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=105430
2024-11-10 16:02:26 - progress_bar.py[line:274] - INFO: epoch 042:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17244, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2916.4, ups=0.17, wpb=17244, bsz=1024, num_updates=16220, lr=3.11259e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13, wall=105489
2024-11-10 16:03:22 - progress_bar.py[line:274] - INFO: epoch 042:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17133.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3102.9, ups=0.18, wpb=17133.5, bsz=1024, num_updates=16230, lr=3.11123e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=105544
2024-11-10 16:04:16 - progress_bar.py[line:274] - INFO: epoch 042:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=16912.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3093, ups=0.18, wpb=16912.2, bsz=1024, num_updates=16240, lr=3.10987e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=46, gb_free=13.3, wall=105599
2024-11-10 16:05:11 - progress_bar.py[line:274] - INFO: epoch 042:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17348.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3169.5, ups=0.18, wpb=17348.2, bsz=1024, num_updates=16250, lr=3.10851e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=105654
2024-11-10 16:06:08 - progress_bar.py[line:274] - INFO: epoch 042:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17097.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2984.6, ups=0.17, wpb=17097.5, bsz=1024, num_updates=16260, lr=3.10714e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=105711
2024-11-10 16:07:05 - progress_bar.py[line:274] - INFO: epoch 042:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17237.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3049.3, ups=0.18, wpb=17237.3, bsz=1024, num_updates=16270, lr=3.10578e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=46, gb_free=13.2, wall=105768
2024-11-10 16:08:01 - progress_bar.py[line:274] - INFO: epoch 042:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17321.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3056.4, ups=0.18, wpb=17321.7, bsz=1024, num_updates=16280, lr=3.10442e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.2, wall=105824
2024-11-10 16:08:56 - progress_bar.py[line:274] - INFO: epoch 042:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=16888.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3078.3, ups=0.18, wpb=16888.2, bsz=1024, num_updates=16290, lr=3.10306e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=35, gb_free=13.2, wall=105879
2024-11-10 16:09:53 - progress_bar.py[line:274] - INFO: epoch 042:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17121.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3026.4, ups=0.18, wpb=17121.5, bsz=1024, num_updates=16300, lr=3.1017e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=105936
2024-11-10 16:10:50 - progress_bar.py[line:274] - INFO: epoch 042:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17415.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3023.7, ups=0.17, wpb=17415.7, bsz=1024, num_updates=16310, lr=3.10034e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=105993
2024-11-10 16:11:47 - progress_bar.py[line:274] - INFO: epoch 042:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17406.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3095.6, ups=0.18, wpb=17406.3, bsz=1024, num_updates=16320, lr=3.09898e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=106050
2024-11-10 16:12:43 - progress_bar.py[line:274] - INFO: epoch 042:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17096, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3025.6, ups=0.18, wpb=17096, bsz=1024, num_updates=16330, lr=3.09762e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=106106
2024-11-10 16:13:41 - progress_bar.py[line:274] - INFO: epoch 042:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17169.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=2981.4, ups=0.17, wpb=17169.6, bsz=1024, num_updates=16340, lr=3.09626e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=106164
2024-11-10 16:14:37 - progress_bar.py[line:274] - INFO: epoch 042:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17033.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3051.1, ups=0.18, wpb=17033.7, bsz=1024, num_updates=16350, lr=3.0949e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=51, gb_free=13.2, wall=106220
2024-11-10 16:15:33 - progress_bar.py[line:274] - INFO: epoch 042:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17085.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3014, ups=0.18, wpb=17085.6, bsz=1024, num_updates=16360, lr=3.09354e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.1, wall=106276
2024-11-10 16:16:29 - progress_bar.py[line:274] - INFO: epoch 042:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17216.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3116.6, ups=0.18, wpb=17216.2, bsz=1024, num_updates=16370, lr=3.09218e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=106331
2024-11-10 16:17:24 - progress_bar.py[line:274] - INFO: epoch 042:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17460.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3136.2, ups=0.18, wpb=17460.5, bsz=1024, num_updates=16380, lr=3.09082e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=106387
2024-11-10 16:18:18 - progress_bar.py[line:274] - INFO: epoch 042:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17517.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3270.3, ups=0.19, wpb=17517.7, bsz=1024, num_updates=16390, lr=3.08946e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=106441
2024-11-10 16:19:15 - progress_bar.py[line:274] - INFO: epoch 042:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17118.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3001.4, ups=0.18, wpb=17118.9, bsz=1024, num_updates=16400, lr=3.0881e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=48, gb_free=13.2, wall=106498
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt2024-11-10 16:19:40 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 42 @ 16405 updates


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
2024-11-10 16:19:40 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 16:21:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-10 16:23:21 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 42 @ 16405 updates, score 0) (writing took 221.8764644699986 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
2024-11-10 16:24:17 - train.py[line:336] - INFO: end of epoch 42 (average epoch stats below)
2024-11-10 16:24:17 - progress_bar.py[line:282] - INFO: epoch 042 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.774 | ntokens 17168.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.84 | wps 2539.4 | ups 0.15 | wpb 17168.4 | bsz 1023 | num_updates 16405 | lr 3.08742e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1542 | gb_free 13.3 | wall 106800
2024-11-10 16:24:17 - trainer.py[line:639] - INFO: loading train data for epoch 43
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 16:26:59 - trainer.py[line:703] - INFO: begin training epoch 43
2024-11-10 16:26:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 16:27:29 - progress_bar.py[line:274] - INFO: epoch 043:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=16620.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=336.6, ups=0.02, wpb=16620.1, bsz=985.6, num_updates=16410, lr=3.08674e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=40, gb_free=13, wall=106992
2024-11-10 16:28:25 - progress_bar.py[line:274] - INFO: epoch 043:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17151.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3028, ups=0.18, wpb=17151.5, bsz=1024, num_updates=16420, lr=3.08538e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=107048
2024-11-10 16:29:21 - progress_bar.py[line:274] - INFO: epoch 043:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17276.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3086.1, ups=0.18, wpb=17276.9, bsz=1024, num_updates=16430, lr=3.08402e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=107104
2024-11-10 16:30:21 - progress_bar.py[line:274] - INFO: epoch 043:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17011.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2854.1, ups=0.17, wpb=17011.7, bsz=1024, num_updates=16440, lr=3.08266e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=48, gb_free=13.2, wall=107164
2024-11-10 16:31:15 - progress_bar.py[line:274] - INFO: epoch 043:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17263.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3190.6, ups=0.18, wpb=17263.7, bsz=1024, num_updates=16450, lr=3.0813e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=107218
2024-11-10 16:32:14 - progress_bar.py[line:274] - INFO: epoch 043:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17320.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=2922.5, ups=0.17, wpb=17320.1, bsz=1024, num_updates=16460, lr=3.07994e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=107277
2024-11-10 16:33:07 - progress_bar.py[line:274] - INFO: epoch 043:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17038.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3227.4, ups=0.19, wpb=17038.7, bsz=1024, num_updates=16470, lr=3.07858e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=47, gb_free=13.4, wall=107330
2024-11-10 16:34:03 - progress_bar.py[line:274] - INFO: epoch 043:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17099.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3053.8, ups=0.18, wpb=17099.1, bsz=1024, num_updates=16480, lr=3.07722e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=12.9, wall=107386
2024-11-10 16:35:00 - progress_bar.py[line:274] - INFO: epoch 043:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17470.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3070.8, ups=0.18, wpb=17470.4, bsz=1024, num_updates=16490, lr=3.07586e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=107443
2024-11-10 16:35:55 - progress_bar.py[line:274] - INFO: epoch 043:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17145.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3123.2, ups=0.18, wpb=17145.6, bsz=1024, num_updates=16500, lr=3.0745e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=107498
2024-11-10 16:36:51 - progress_bar.py[line:274] - INFO: epoch 043:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17183.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3080.5, ups=0.18, wpb=17183.5, bsz=1024, num_updates=16510, lr=3.07313e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=107554
2024-11-10 16:37:47 - progress_bar.py[line:274] - INFO: epoch 043:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=16880.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2970, ups=0.18, wpb=16880.7, bsz=1024, num_updates=16520, lr=3.07177e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=107610
2024-11-10 16:38:44 - progress_bar.py[line:274] - INFO: epoch 043:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17242.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3063.6, ups=0.18, wpb=17242.8, bsz=1024, num_updates=16530, lr=3.07041e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=107667
2024-11-10 16:39:40 - progress_bar.py[line:274] - INFO: epoch 043:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17207.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3038.6, ups=0.18, wpb=17207.9, bsz=1024, num_updates=16540, lr=3.06905e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=107723
2024-11-10 16:40:36 - progress_bar.py[line:274] - INFO: epoch 043:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17024, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3071.6, ups=0.18, wpb=17024, bsz=1024, num_updates=16550, lr=3.06769e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=32, gb_free=13.2, wall=107779
2024-11-10 16:41:32 - progress_bar.py[line:274] - INFO: epoch 043:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17205.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3035.6, ups=0.18, wpb=17205.3, bsz=1024, num_updates=16560, lr=3.06633e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=107835
2024-11-10 16:42:29 - progress_bar.py[line:274] - INFO: epoch 043:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17210.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3055.8, ups=0.18, wpb=17210.4, bsz=1024, num_updates=16570, lr=3.06497e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=107892
2024-11-10 16:43:25 - progress_bar.py[line:274] - INFO: epoch 043:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17081.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3053.3, ups=0.18, wpb=17081.4, bsz=1024, num_updates=16580, lr=3.06361e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=107948
2024-11-10 16:44:21 - progress_bar.py[line:274] - INFO: epoch 043:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=16998.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3016.1, ups=0.18, wpb=16998.6, bsz=1024, num_updates=16590, lr=3.06225e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=108004
2024-11-10 16:45:19 - progress_bar.py[line:274] - INFO: epoch 043:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17181.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2977.9, ups=0.17, wpb=17181.4, bsz=1024, num_updates=16600, lr=3.06089e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=108062
2024-11-10 16:46:14 - progress_bar.py[line:274] - INFO: epoch 043:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17144.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3101.7, ups=0.18, wpb=17144.6, bsz=1024, num_updates=16610, lr=3.05953e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=43, gb_free=13.2, wall=108117
2024-11-10 16:47:08 - progress_bar.py[line:274] - INFO: epoch 043:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=16929.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3121.8, ups=0.18, wpb=16929.5, bsz=1024, num_updates=16620, lr=3.05817e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=37, gb_free=13.1, wall=108171
2024-11-10 16:48:04 - progress_bar.py[line:274] - INFO: epoch 043:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17182.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3064.7, ups=0.18, wpb=17182.2, bsz=1024, num_updates=16630, lr=3.05681e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=108227
2024-11-10 16:49:01 - progress_bar.py[line:274] - INFO: epoch 043:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17141.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3025.4, ups=0.18, wpb=17141.3, bsz=1024, num_updates=16640, lr=3.05545e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=108284
2024-11-10 16:49:58 - progress_bar.py[line:274] - INFO: epoch 043:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17193.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3016.3, ups=0.18, wpb=17193.4, bsz=1024, num_updates=16650, lr=3.05409e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=108341
2024-11-10 16:50:57 - progress_bar.py[line:274] - INFO: epoch 043:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17194, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2934.5, ups=0.17, wpb=17194, bsz=1024, num_updates=16660, lr=3.05273e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=48, gb_free=13.3, wall=108400
2024-11-10 16:51:50 - progress_bar.py[line:274] - INFO: epoch 043:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17217.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3195.7, ups=0.19, wpb=17217.2, bsz=1024, num_updates=16670, lr=3.05137e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=108453
2024-11-10 16:52:48 - progress_bar.py[line:274] - INFO: epoch 043:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17016.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2939.7, ups=0.17, wpb=17016.2, bsz=1024, num_updates=16680, lr=3.05001e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=108511
2024-11-10 16:53:45 - progress_bar.py[line:274] - INFO: epoch 043:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=16806.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2967.1, ups=0.18, wpb=16806.3, bsz=1024, num_updates=16690, lr=3.04865e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=108568
2024-11-10 16:54:41 - progress_bar.py[line:274] - INFO: epoch 043:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17360.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3082.8, ups=0.18, wpb=17360.1, bsz=1024, num_updates=16700, lr=3.04729e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=47, gb_free=13.3, wall=108624
2024-11-10 16:55:40 - progress_bar.py[line:274] - INFO: epoch 043:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17196.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2927.9, ups=0.17, wpb=17196.9, bsz=1024, num_updates=16710, lr=3.04593e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=59, gb_free=13.4, wall=108683
2024-11-10 16:56:37 - progress_bar.py[line:274] - INFO: epoch 043:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17253.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3007.9, ups=0.17, wpb=17253.9, bsz=1024, num_updates=16720, lr=3.04457e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=12.9, wall=108740
2024-11-10 16:57:36 - progress_bar.py[line:274] - INFO: epoch 043:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17298.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=2950.4, ups=0.17, wpb=17298.1, bsz=1024, num_updates=16730, lr=3.04321e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=59, gb_free=13.5, wall=108799
2024-11-10 16:58:31 - progress_bar.py[line:274] - INFO: epoch 043:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17225.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3153.1, ups=0.18, wpb=17225.8, bsz=1024, num_updates=16740, lr=3.04185e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=108854
2024-11-10 16:59:26 - progress_bar.py[line:274] - INFO: epoch 043:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17204.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3132.7, ups=0.18, wpb=17204.6, bsz=1024, num_updates=16750, lr=3.04049e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=40, gb_free=13.4, wall=108909
2024-11-10 17:00:21 - progress_bar.py[line:274] - INFO: epoch 043:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17092.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3067.4, ups=0.18, wpb=17092.2, bsz=1024, num_updates=16760, lr=3.03912e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=32, gb_free=13.2, wall=108964
2024-11-10 17:01:18 - progress_bar.py[line:274] - INFO: epoch 043:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17100.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3030.5, ups=0.18, wpb=17100.2, bsz=1024, num_updates=16770, lr=3.03776e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=109021
2024-11-10 17:02:14 - progress_bar.py[line:274] - INFO: epoch 043:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17396.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3091.3, ups=0.18, wpb=17396.6, bsz=1024, num_updates=16780, lr=3.0364e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=12.9, wall=109077
2024-11-10 17:03:11 - progress_bar.py[line:274] - INFO: epoch 043:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17076.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3021.3, ups=0.18, wpb=17076.2, bsz=1024, num_updates=16790, lr=3.03504e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=45, gb_free=13, wall=109133
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

2024-11-10 17:03:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 43 @ 16796 updates
2024-11-10 17:03:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt': File exists
: File exists: File exists: File exists: File exists



local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 17:05:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-10 17:07:20 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 43 @ 16796 updates, score 0) (writing took 218.84155506204115 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-10 17:08:16 - train.py[line:336] - INFO: end of epoch 43 (average epoch stats below)
2024-11-10 17:08:16 - progress_bar.py[line:282] - INFO: epoch 043 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.761 | ntokens 17142.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.78 | wps 2539.8 | ups 0.15 | wpb 17142.6 | bsz 1023 | num_updates 16796 | lr 3.03423e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1575 | gb_free 13.3 | wall 109439
2024-11-10 17:08:16 - trainer.py[line:639] - INFO: loading train data for epoch 44
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 17:10:57 - trainer.py[line:703] - INFO: begin training epoch 44
2024-11-10 17:10:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 17:11:22 - progress_bar.py[line:274] - INFO: epoch 044:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=16511.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=336.1, ups=0.02, wpb=16511.6, bsz=985.6, num_updates=16800, lr=3.03368e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=43, gb_free=13.4, wall=109625
2024-11-10 17:12:18 - progress_bar.py[line:274] - INFO: epoch 044:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17072.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3051.1, ups=0.18, wpb=17072.2, bsz=1024, num_updates=16810, lr=3.03232e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=109681
2024-11-10 17:13:14 - progress_bar.py[line:274] - INFO: epoch 044:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17271.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3071.7, ups=0.18, wpb=17271.6, bsz=1024, num_updates=16820, lr=3.03096e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=109737
2024-11-10 17:14:12 - progress_bar.py[line:274] - INFO: epoch 044:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=16865.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2919.5, ups=0.17, wpb=16865.8, bsz=1024, num_updates=16830, lr=3.0296e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=45, gb_free=13.4, wall=109795
2024-11-10 17:15:10 - progress_bar.py[line:274] - INFO: epoch 044:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17509.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3011.2, ups=0.17, wpb=17509.2, bsz=1024, num_updates=16840, lr=3.02824e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=109853
2024-11-10 17:16:05 - progress_bar.py[line:274] - INFO: epoch 044:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17446.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3143.6, ups=0.18, wpb=17446.8, bsz=1024, num_updates=16850, lr=3.02688e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=109908
2024-11-10 17:17:00 - progress_bar.py[line:274] - INFO: epoch 044:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17152.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3113.7, ups=0.18, wpb=17152.4, bsz=1024, num_updates=16860, lr=3.02552e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=46, gb_free=13.1, wall=109963
2024-11-10 17:17:55 - progress_bar.py[line:274] - INFO: epoch 044:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17038, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3120.7, ups=0.18, wpb=17038, bsz=1024, num_updates=16870, lr=3.02416e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=110018
2024-11-10 17:18:51 - progress_bar.py[line:274] - INFO: epoch 044:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17428.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3106.9, ups=0.18, wpb=17428.5, bsz=1024, num_updates=16880, lr=3.0228e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=32, gb_free=13.3, wall=110074
2024-11-10 17:19:46 - progress_bar.py[line:274] - INFO: epoch 044:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17207.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3142.4, ups=0.18, wpb=17207.7, bsz=1024, num_updates=16890, lr=3.02144e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=110129
2024-11-10 17:20:41 - progress_bar.py[line:274] - INFO: epoch 044:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17011, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3080.1, ups=0.18, wpb=17011, bsz=1024, num_updates=16900, lr=3.02008e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=33, gb_free=13.5, wall=110184
2024-11-10 17:21:38 - progress_bar.py[line:274] - INFO: epoch 044:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17321.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3035.4, ups=0.18, wpb=17321.6, bsz=1024, num_updates=16910, lr=3.01872e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.2, wall=110241
2024-11-10 17:22:34 - progress_bar.py[line:274] - INFO: epoch 044:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17371, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3117.8, ups=0.18, wpb=17371, bsz=1024, num_updates=16920, lr=3.01736e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=110297
2024-11-10 17:23:29 - progress_bar.py[line:274] - INFO: epoch 044:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17200.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3105, ups=0.18, wpb=17200.6, bsz=1024, num_updates=16930, lr=3.016e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=110352
2024-11-10 17:24:27 - progress_bar.py[line:274] - INFO: epoch 044:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=16935.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2947.5, ups=0.17, wpb=16935.2, bsz=1024, num_updates=16940, lr=3.01464e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=110410
2024-11-10 17:25:24 - progress_bar.py[line:274] - INFO: epoch 044:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17251.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3010.5, ups=0.17, wpb=17251.8, bsz=1024, num_updates=16950, lr=3.01328e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=49, gb_free=12.9, wall=110467
2024-11-10 17:26:18 - progress_bar.py[line:274] - INFO: epoch 044:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17329.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3230.6, ups=0.19, wpb=17329.8, bsz=1024, num_updates=16960, lr=3.01192e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=38, gb_free=13.1, wall=110521
2024-11-10 17:27:14 - progress_bar.py[line:274] - INFO: epoch 044:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=16957.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3010.8, ups=0.18, wpb=16957.6, bsz=1024, num_updates=16970, lr=3.01056e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=110577
2024-11-10 17:28:11 - progress_bar.py[line:274] - INFO: epoch 044:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17079.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2982.5, ups=0.17, wpb=17079.7, bsz=1024, num_updates=16980, lr=3.0092e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=41, gb_free=13.2, wall=110634
2024-11-10 17:29:06 - progress_bar.py[line:274] - INFO: epoch 044:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17007.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3132.1, ups=0.18, wpb=17007.7, bsz=1024, num_updates=16990, lr=3.00784e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=35, gb_free=13.2, wall=110689
2024-11-10 17:30:03 - progress_bar.py[line:274] - INFO: epoch 044:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17042.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2984.2, ups=0.18, wpb=17042.3, bsz=1024, num_updates=17000, lr=3.00648e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=110746
2024-11-10 17:31:00 - progress_bar.py[line:274] - INFO: epoch 044:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17091.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3009.2, ups=0.18, wpb=17091.2, bsz=1024, num_updates=17010, lr=3.00512e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=110802
2024-11-10 17:31:57 - progress_bar.py[line:274] - INFO: epoch 044:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17087.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2998.1, ups=0.18, wpb=17087.3, bsz=1024, num_updates=17020, lr=3.00375e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=110859
2024-11-10 17:32:53 - progress_bar.py[line:274] - INFO: epoch 044:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17144, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3015.8, ups=0.18, wpb=17144, bsz=1024, num_updates=17030, lr=3.00239e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=35, gb_free=13.4, wall=110916
2024-11-10 17:33:51 - progress_bar.py[line:274] - INFO: epoch 044:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17228.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=2986.2, ups=0.17, wpb=17228.2, bsz=1024, num_updates=17040, lr=3.00103e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=110974
2024-11-10 17:34:47 - progress_bar.py[line:274] - INFO: epoch 044:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17268.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3103.4, ups=0.18, wpb=17268.6, bsz=1024, num_updates=17050, lr=2.99967e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13, wall=111030
2024-11-10 17:35:42 - progress_bar.py[line:274] - INFO: epoch 044:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17391.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3140.6, ups=0.18, wpb=17391.1, bsz=1024, num_updates=17060, lr=2.99831e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=48, gb_free=13.2, wall=111085
2024-11-10 17:36:40 - progress_bar.py[line:274] - INFO: epoch 044:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17115.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2938.4, ups=0.17, wpb=17115.8, bsz=1024, num_updates=17070, lr=2.99695e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.5, wall=111143
2024-11-10 17:37:39 - progress_bar.py[line:274] - INFO: epoch 044:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=16989.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2918.9, ups=0.17, wpb=16989.8, bsz=1024, num_updates=17080, lr=2.99559e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=111201
2024-11-10 17:38:35 - progress_bar.py[line:274] - INFO: epoch 044:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=16930.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3000.8, ups=0.18, wpb=16930.7, bsz=1024, num_updates=17090, lr=2.99423e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=111258
2024-11-10 17:39:30 - progress_bar.py[line:274] - INFO: epoch 044:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17356.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3170.7, ups=0.18, wpb=17356.9, bsz=1024, num_updates=17100, lr=2.99287e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=111313
2024-11-10 17:40:27 - progress_bar.py[line:274] - INFO: epoch 044:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=16946, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=2941.5, ups=0.17, wpb=16946, bsz=1024, num_updates=17110, lr=2.99151e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=111370
2024-11-10 17:41:25 - progress_bar.py[line:274] - INFO: epoch 044:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17032.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2951, ups=0.17, wpb=17032.7, bsz=1024, num_updates=17120, lr=2.99015e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.1, wall=111428
2024-11-10 17:42:21 - progress_bar.py[line:274] - INFO: epoch 044:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17518.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3110.7, ups=0.18, wpb=17518.3, bsz=1024, num_updates=17130, lr=2.98879e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=111484
2024-11-10 17:43:17 - progress_bar.py[line:274] - INFO: epoch 044:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=16690.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3016.2, ups=0.18, wpb=16690.7, bsz=1024, num_updates=17140, lr=2.98743e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=111540
2024-11-10 17:44:15 - progress_bar.py[line:274] - INFO: epoch 044:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17410.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3006.3, ups=0.17, wpb=17410.2, bsz=1024, num_updates=17150, lr=2.98607e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=111598
2024-11-10 17:45:08 - progress_bar.py[line:274] - INFO: epoch 044:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17188.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3240.3, ups=0.19, wpb=17188.2, bsz=1024, num_updates=17160, lr=2.98471e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=50, gb_free=13.4, wall=111651
2024-11-10 17:46:02 - progress_bar.py[line:274] - INFO: epoch 044:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3149.4, ups=0.18, wpb=17104.2, bsz=1024, num_updates=17170, lr=2.98335e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=34, gb_free=12.9, wall=111705
2024-11-10 17:47:00 - progress_bar.py[line:274] - INFO: epoch 044:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17356.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2980.3, ups=0.17, wpb=17356.9, bsz=1024, num_updates=17180, lr=2.98199e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=111763
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
2024-11-10 17:47:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 44 @ 17187 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
2024-11-10 17:47:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 17:49:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 17:51:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 44 @ 17187 updates, score 0) (writing took 225.6997914799722 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-10 17:52:17 - train.py[line:336] - INFO: end of epoch 44 (average epoch stats below)
2024-11-10 17:52:17 - progress_bar.py[line:282] - INFO: epoch 044 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.754 | ntokens 17146.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.75 | wps 2537.8 | ups 0.15 | wpb 17146.6 | bsz 1023 | num_updates 17187 | lr 2.98104e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1706 | gb_free 13.2 | wall 112080
2024-11-10 17:52:17 - trainer.py[line:639] - INFO: loading train data for epoch 45
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 17:54:59 - trainer.py[line:703] - INFO: begin training epoch 45
2024-11-10 17:54:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 17:55:18 - progress_bar.py[line:274] - INFO: epoch 045:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=16396.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=329.3, ups=0.02, wpb=16396.8, bsz=985.6, num_updates=17190, lr=2.98063e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=45, gb_free=13.4, wall=112261
2024-11-10 17:56:15 - progress_bar.py[line:274] - INFO: epoch 045:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17085.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3007.7, ups=0.18, wpb=17085.3, bsz=1024, num_updates=17200, lr=2.97927e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=112318
2024-11-10 17:57:13 - progress_bar.py[line:274] - INFO: epoch 045:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17337.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2994.2, ups=0.17, wpb=17337.3, bsz=1024, num_updates=17210, lr=2.97791e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=34, gb_free=13.3, wall=112376
2024-11-10 17:58:12 - progress_bar.py[line:274] - INFO: epoch 045:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17207.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2911, ups=0.17, wpb=17207.9, bsz=1024, num_updates=17220, lr=2.97655e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.1, wall=112435
2024-11-10 17:59:09 - progress_bar.py[line:274] - INFO: epoch 045:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17182.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=2983.1, ups=0.17, wpb=17182.8, bsz=1024, num_updates=17230, lr=2.97519e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=112492
2024-11-10 18:00:08 - progress_bar.py[line:274] - INFO: epoch 045:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17083.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2924.1, ups=0.17, wpb=17083.7, bsz=1024, num_updates=17240, lr=2.97383e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=12.7, wall=112551
2024-11-10 18:01:06 - progress_bar.py[line:274] - INFO: epoch 045:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17114.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2950.2, ups=0.17, wpb=17114.6, bsz=1024, num_updates=17250, lr=2.97247e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=112609
2024-11-10 18:01:59 - progress_bar.py[line:274] - INFO: epoch 045:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17096.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3197.5, ups=0.19, wpb=17096.1, bsz=1024, num_updates=17260, lr=2.97111e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=112662
2024-11-10 18:02:55 - progress_bar.py[line:274] - INFO: epoch 045:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17297.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3113.6, ups=0.18, wpb=17297.3, bsz=1024, num_updates=17270, lr=2.96974e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=32, gb_free=13.2, wall=112718
2024-11-10 18:03:52 - progress_bar.py[line:274] - INFO: epoch 045:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17109.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3016.3, ups=0.18, wpb=17109.2, bsz=1024, num_updates=17280, lr=2.96838e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=112775
2024-11-10 18:04:48 - progress_bar.py[line:274] - INFO: epoch 045:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17248, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3065, ups=0.18, wpb=17248, bsz=1024, num_updates=17290, lr=2.96702e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=112831
2024-11-10 18:05:44 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-10 18:05:50 - progress_bar.py[line:274] - INFO: epoch 045:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17141, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2755.5, ups=0.16, wpb=17141, bsz=1024, num_updates=17300, lr=2.96566e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=34, gb_free=13.2, wall=112893
2024-11-10 18:06:47 - progress_bar.py[line:274] - INFO: epoch 045:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17375, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3051.5, ups=0.18, wpb=17375, bsz=1024, num_updates=17310, lr=2.9643e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=112950
2024-11-10 18:07:43 - progress_bar.py[line:274] - INFO: epoch 045:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17151.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3050.7, ups=0.18, wpb=17151.8, bsz=1024, num_updates=17320, lr=2.96294e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=113006
2024-11-10 18:08:41 - progress_bar.py[line:274] - INFO: epoch 045:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=16930.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2913, ups=0.17, wpb=16930.7, bsz=1024, num_updates=17330, lr=2.96158e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=39, gb_free=13.4, wall=113064
2024-11-10 18:09:40 - progress_bar.py[line:274] - INFO: epoch 045:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17304.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2943.5, ups=0.17, wpb=17304.7, bsz=1024, num_updates=17340, lr=2.96022e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.1, wall=113123
2024-11-10 18:10:39 - progress_bar.py[line:274] - INFO: epoch 045:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17233.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2954, ups=0.17, wpb=17233.2, bsz=1024, num_updates=17350, lr=2.95886e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=113181
2024-11-10 18:11:37 - progress_bar.py[line:274] - INFO: epoch 045:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17199.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2944.1, ups=0.17, wpb=17199.6, bsz=1024, num_updates=17360, lr=2.9575e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=113240
2024-11-10 18:12:31 - progress_bar.py[line:274] - INFO: epoch 045:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=16963.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3127.8, ups=0.18, wpb=16963.9, bsz=1024, num_updates=17370, lr=2.95614e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=49, gb_free=13.3, wall=113294
2024-11-10 18:13:28 - progress_bar.py[line:274] - INFO: epoch 045:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17006.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3014.9, ups=0.18, wpb=17006.3, bsz=1024, num_updates=17380, lr=2.95478e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=53, gb_free=13.2, wall=113351
2024-11-10 18:14:24 - progress_bar.py[line:274] - INFO: epoch 045:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17428.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3119.1, ups=0.18, wpb=17428.2, bsz=1024, num_updates=17390, lr=2.95342e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=36, gb_free=13.5, wall=113406
2024-11-10 18:15:21 - progress_bar.py[line:274] - INFO: epoch 045:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=16984.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2971.8, ups=0.17, wpb=16984.3, bsz=1024, num_updates=17400, lr=2.95206e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=46, gb_free=13.5, wall=113464
2024-11-10 18:16:16 - progress_bar.py[line:274] - INFO: epoch 045:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=16903, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3038.5, ups=0.18, wpb=16903, bsz=1024, num_updates=17410, lr=2.9507e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=32, gb_free=13.3, wall=113519
2024-11-10 18:17:13 - progress_bar.py[line:274] - INFO: epoch 045:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17475.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3058.1, ups=0.17, wpb=17475.2, bsz=1024, num_updates=17420, lr=2.94934e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=113576
2024-11-10 18:18:10 - progress_bar.py[line:274] - INFO: epoch 045:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=16935.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2984.3, ups=0.18, wpb=16935.6, bsz=1024, num_updates=17430, lr=2.94798e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=113633
2024-11-10 18:19:07 - progress_bar.py[line:274] - INFO: epoch 045:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17130.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3013.9, ups=0.18, wpb=17130.3, bsz=1024, num_updates=17440, lr=2.94662e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=113690
2024-11-10 18:20:04 - progress_bar.py[line:274] - INFO: epoch 045:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17281.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3041.2, ups=0.18, wpb=17281.9, bsz=1024, num_updates=17450, lr=2.94526e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13, wall=113747
2024-11-10 18:20:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-10 18:21:08 - progress_bar.py[line:274] - INFO: epoch 045:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17131.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2667.9, ups=0.16, wpb=17131.3, bsz=1024, num_updates=17460, lr=2.9439e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=113811
2024-11-10 18:22:07 - progress_bar.py[line:274] - INFO: epoch 045:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17182.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2910.7, ups=0.17, wpb=17182.6, bsz=1024, num_updates=17470, lr=2.94254e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=113870
2024-11-10 18:23:03 - progress_bar.py[line:274] - INFO: epoch 045:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17088.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3069.7, ups=0.18, wpb=17088.8, bsz=1024, num_updates=17480, lr=2.94118e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=113926
2024-11-10 18:23:58 - progress_bar.py[line:274] - INFO: epoch 045:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17244.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3146.2, ups=0.18, wpb=17244.1, bsz=1024, num_updates=17490, lr=2.93982e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=113980
2024-11-10 18:24:54 - progress_bar.py[line:274] - INFO: epoch 045:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17136.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3050, ups=0.18, wpb=17136.6, bsz=1024, num_updates=17500, lr=2.93846e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=32, gb_free=13.1, wall=114037
2024-11-10 18:25:51 - progress_bar.py[line:274] - INFO: epoch 045:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=16955.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2964.7, ups=0.17, wpb=16955.2, bsz=1024, num_updates=17510, lr=2.9371e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114094
2024-11-10 18:26:48 - progress_bar.py[line:274] - INFO: epoch 045:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17041.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=2986.4, ups=0.18, wpb=17041.2, bsz=1024, num_updates=17520, lr=2.93573e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=114151
2024-11-10 18:27:45 - progress_bar.py[line:274] - INFO: epoch 045:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17032.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2995.5, ups=0.18, wpb=17032.8, bsz=1024, num_updates=17530, lr=2.93437e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=114208
2024-11-10 18:28:41 - progress_bar.py[line:274] - INFO: epoch 045:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17530, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3103.3, ups=0.18, wpb=17530, bsz=1024, num_updates=17540, lr=2.93301e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=114264
2024-11-10 18:29:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 18:29:44 - progress_bar.py[line:274] - INFO: epoch 045:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17475.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2793.8, ups=0.16, wpb=17475.5, bsz=1024, num_updates=17550, lr=2.93165e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=34, gb_free=13.2, wall=114327
2024-11-10 18:30:40 - progress_bar.py[line:274] - INFO: epoch 045:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17247.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3091.8, ups=0.18, wpb=17247.8, bsz=1024, num_updates=17560, lr=2.93029e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=114383
2024-11-10 18:31:35 - progress_bar.py[line:274] - INFO: epoch 045:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=16963.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3060, ups=0.18, wpb=16963.6, bsz=1024, num_updates=17570, lr=2.92893e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=114438
2024-11-10 18:31:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 45 @ 17575 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt

2024-11-10 18:31:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 18:33:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-10 18:35:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 45 @ 17575 updates, score 0) (writing took 224.45812880498124 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-10 18:36:38 - train.py[line:336] - INFO: end of epoch 45 (average epoch stats below)
2024-11-10 18:36:38 - progress_bar.py[line:282] - INFO: epoch 045 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.749 | ntokens 17154.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.72 | wps 2501.3 | ups 0.15 | wpb 17154.1 | bsz 1023 | num_updates 17575 | lr 2.92825e-05 | gnorm 0.005 | clip 0 | loss_scale 16384 | train_wall 1552 | gb_free 13.1 | wall 114741
2024-11-10 18:36:38 - trainer.py[line:639] - INFO: loading train data for epoch 46
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 18:39:20 - trainer.py[line:703] - INFO: begin training epoch 46
2024-11-10 18:39:20 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 18:39:50 - progress_bar.py[line:274] - INFO: epoch 046:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=16737.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=338.2, ups=0.02, wpb=16737.8, bsz=985.6, num_updates=17580, lr=2.92757e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=114933
2024-11-10 18:40:47 - progress_bar.py[line:274] - INFO: epoch 046:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17236.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3049, ups=0.18, wpb=17236.1, bsz=1024, num_updates=17590, lr=2.92621e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=114989
2024-11-10 18:41:43 - progress_bar.py[line:274] - INFO: epoch 046:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17386.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3087.2, ups=0.18, wpb=17386.9, bsz=1024, num_updates=17600, lr=2.92485e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=115046
2024-11-10 18:42:39 - progress_bar.py[line:274] - INFO: epoch 046:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17105.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3046.6, ups=0.18, wpb=17105.4, bsz=1024, num_updates=17610, lr=2.92349e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=115102
2024-11-10 18:43:36 - progress_bar.py[line:274] - INFO: epoch 046:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17122.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3011.8, ups=0.18, wpb=17122.2, bsz=1024, num_updates=17620, lr=2.92213e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=115159
2024-11-10 18:44:33 - progress_bar.py[line:274] - INFO: epoch 046:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17342.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3043, ups=0.18, wpb=17342.9, bsz=1024, num_updates=17630, lr=2.92077e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=115216
2024-11-10 18:45:29 - progress_bar.py[line:274] - INFO: epoch 046:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17113.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3067.7, ups=0.18, wpb=17113.4, bsz=1024, num_updates=17640, lr=2.91941e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=115272
2024-11-10 18:46:26 - progress_bar.py[line:274] - INFO: epoch 046:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17142, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3000.3, ups=0.18, wpb=17142, bsz=1024, num_updates=17650, lr=2.91805e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=115329
2024-11-10 18:47:23 - progress_bar.py[line:274] - INFO: epoch 046:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17455.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3041.6, ups=0.17, wpb=17455.5, bsz=1024, num_updates=17660, lr=2.91669e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=115386
2024-11-10 18:48:20 - progress_bar.py[line:274] - INFO: epoch 046:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17146.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3030.8, ups=0.18, wpb=17146.9, bsz=1024, num_updates=17670, lr=2.91533e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=115443
2024-11-10 18:49:17 - progress_bar.py[line:274] - INFO: epoch 046:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17324.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3016.6, ups=0.17, wpb=17324.5, bsz=1024, num_updates=17680, lr=2.91397e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=115500
2024-11-10 18:50:14 - progress_bar.py[line:274] - INFO: epoch 046:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17003.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2986.3, ups=0.18, wpb=17003.9, bsz=1024, num_updates=17690, lr=2.91261e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=115557
2024-11-10 18:51:12 - progress_bar.py[line:274] - INFO: epoch 046:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17482.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3025.9, ups=0.17, wpb=17482.8, bsz=1024, num_updates=17700, lr=2.91125e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=115615
2024-11-10 18:52:09 - progress_bar.py[line:274] - INFO: epoch 046:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17107, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3000.6, ups=0.18, wpb=17107, bsz=1024, num_updates=17710, lr=2.90989e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=115672
2024-11-10 18:53:05 - progress_bar.py[line:274] - INFO: epoch 046:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17158.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3060.7, ups=0.18, wpb=17158.8, bsz=1024, num_updates=17720, lr=2.90853e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=34, gb_free=12.7, wall=115728
2024-11-10 18:54:02 - progress_bar.py[line:274] - INFO: epoch 046:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17303.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3031.2, ups=0.18, wpb=17303.8, bsz=1024, num_updates=17730, lr=2.90717e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=115785
2024-11-10 18:54:58 - progress_bar.py[line:274] - INFO: epoch 046:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17140, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3056.7, ups=0.18, wpb=17140, bsz=1024, num_updates=17740, lr=2.90581e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=115841
2024-11-10 18:55:56 - progress_bar.py[line:274] - INFO: epoch 046:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17157.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2968.8, ups=0.17, wpb=17157.6, bsz=1024, num_updates=17750, lr=2.90445e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=115899
2024-11-10 18:56:52 - progress_bar.py[line:274] - INFO: epoch 046:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17382.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3119.3, ups=0.18, wpb=17382.3, bsz=1024, num_updates=17760, lr=2.90309e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=36, gb_free=12.8, wall=115955
2024-11-10 18:57:49 - progress_bar.py[line:274] - INFO: epoch 046:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17121.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3008.4, ups=0.18, wpb=17121.4, bsz=1024, num_updates=17770, lr=2.90172e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=116012
2024-11-10 18:58:48 - progress_bar.py[line:274] - INFO: epoch 046:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17218.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2916.7, ups=0.17, wpb=17218.5, bsz=1024, num_updates=17780, lr=2.90036e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=47, gb_free=13.2, wall=116071
2024-11-10 18:59:46 - progress_bar.py[line:274] - INFO: epoch 046:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=16976.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2927.9, ups=0.17, wpb=16976.2, bsz=1024, num_updates=17790, lr=2.899e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.1, wall=116129
2024-11-10 19:00:43 - progress_bar.py[line:274] - INFO: epoch 046:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17309.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2991.8, ups=0.17, wpb=17309.8, bsz=1024, num_updates=17800, lr=2.89764e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=116186
2024-11-10 19:01:42 - progress_bar.py[line:274] - INFO: epoch 046:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17189.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2954.4, ups=0.17, wpb=17189.2, bsz=1024, num_updates=17810, lr=2.89628e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=116245
2024-11-10 19:02:37 - progress_bar.py[line:274] - INFO: epoch 046:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17137.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3103.9, ups=0.18, wpb=17137.3, bsz=1024, num_updates=17820, lr=2.89492e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.2, wall=116300
2024-11-10 19:03:31 - progress_bar.py[line:274] - INFO: epoch 046:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17321, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3199.5, ups=0.18, wpb=17321, bsz=1024, num_updates=17830, lr=2.89356e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=47, gb_free=13.4, wall=116354
2024-11-10 19:04:29 - progress_bar.py[line:274] - INFO: epoch 046:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17131, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2944.1, ups=0.17, wpb=17131, bsz=1024, num_updates=17840, lr=2.8922e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=116412
2024-11-10 19:05:28 - progress_bar.py[line:274] - INFO: epoch 046:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=16937, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2903.1, ups=0.17, wpb=16937, bsz=1024, num_updates=17850, lr=2.89084e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=116470
2024-11-10 19:06:23 - progress_bar.py[line:274] - INFO: epoch 046:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17196.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3086.7, ups=0.18, wpb=17196.4, bsz=1024, num_updates=17860, lr=2.88948e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=52, gb_free=13.2, wall=116526
2024-11-10 19:07:20 - progress_bar.py[line:274] - INFO: epoch 046:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17197.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3027.8, ups=0.18, wpb=17197.7, bsz=1024, num_updates=17870, lr=2.88812e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=116583
2024-11-10 19:08:16 - progress_bar.py[line:274] - INFO: epoch 046:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17414.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3113.5, ups=0.18, wpb=17414.5, bsz=1024, num_updates=17880, lr=2.88676e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=37, gb_free=13.3, wall=116639
2024-11-10 19:09:13 - progress_bar.py[line:274] - INFO: epoch 046:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17233, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2997.4, ups=0.17, wpb=17233, bsz=1024, num_updates=17890, lr=2.8854e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=116696
2024-11-10 19:10:10 - progress_bar.py[line:274] - INFO: epoch 046:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17013.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2993.2, ups=0.18, wpb=17013.5, bsz=1024, num_updates=17900, lr=2.88404e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=116753
2024-11-10 19:11:07 - progress_bar.py[line:274] - INFO: epoch 046:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17266.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3041.2, ups=0.18, wpb=17266.3, bsz=1024, num_updates=17910, lr=2.88268e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=116810
2024-11-10 19:12:03 - progress_bar.py[line:274] - INFO: epoch 046:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=16960.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3014, ups=0.18, wpb=16960.6, bsz=1024, num_updates=17920, lr=2.88132e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=116866
2024-11-10 19:13:01 - progress_bar.py[line:274] - INFO: epoch 046:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17418.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3044.1, ups=0.17, wpb=17418.6, bsz=1024, num_updates=17930, lr=2.87996e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=116923
2024-11-10 19:13:58 - progress_bar.py[line:274] - INFO: epoch 046:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17217, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3009.8, ups=0.17, wpb=17217, bsz=1024, num_updates=17940, lr=2.8786e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=116981
2024-11-10 19:14:53 - progress_bar.py[line:274] - INFO: epoch 046:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17424.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3139.2, ups=0.18, wpb=17424.6, bsz=1024, num_updates=17950, lr=2.87724e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117036
2024-11-10 19:15:51 - progress_bar.py[line:274] - INFO: epoch 046:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17061.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2968, ups=0.17, wpb=17061.1, bsz=1024, num_updates=17960, lr=2.87588e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=47, gb_free=13.2, wall=117094
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt2024-11-10 19:16:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 46 @ 17966 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
2024-11-10 19:16:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 19:18:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-10 19:20:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 46 @ 17966 updates, score 0) (writing took 224.46412449504714 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-10 19:21:02 - train.py[line:336] - INFO: end of epoch 46 (average epoch stats below)
2024-11-10 19:21:02 - progress_bar.py[line:282] - INFO: epoch 046 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.751 | ntokens 17191.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.73 | wps 2523.6 | ups 0.15 | wpb 17191.3 | bsz 1023 | num_updates 17966 | lr 2.87506e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1444 | gb_free 13.2 | wall 117405
2024-11-10 19:21:02 - trainer.py[line:639] - INFO: loading train data for epoch 47
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 19:23:43 - trainer.py[line:703] - INFO: begin training epoch 47
2024-11-10 19:23:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 19:24:08 - progress_bar.py[line:274] - INFO: epoch 047:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=16592.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=334, ups=0.02, wpb=16592.9, bsz=985.6, num_updates=17970, lr=2.87452e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=43, gb_free=13.4, wall=117590
2024-11-10 19:25:04 - progress_bar.py[line:274] - INFO: epoch 047:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17058.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3030.6, ups=0.18, wpb=17058.7, bsz=1024, num_updates=17980, lr=2.87316e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=117647
2024-11-10 19:26:00 - progress_bar.py[line:274] - INFO: epoch 047:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17439.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3099.7, ups=0.18, wpb=17439.4, bsz=1024, num_updates=17990, lr=2.8718e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117703
2024-11-10 19:26:56 - progress_bar.py[line:274] - INFO: epoch 047:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17086.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3031.9, ups=0.18, wpb=17086.4, bsz=1024, num_updates=18000, lr=2.87044e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117759
2024-11-10 19:27:52 - progress_bar.py[line:274] - INFO: epoch 047:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17279.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3131.6, ups=0.18, wpb=17279.6, bsz=1024, num_updates=18010, lr=2.86908e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=117815
2024-11-10 19:28:48 - progress_bar.py[line:274] - INFO: epoch 047:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17002.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3018.4, ups=0.18, wpb=17002.6, bsz=1024, num_updates=18020, lr=2.86772e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=117871
2024-11-10 19:29:45 - progress_bar.py[line:274] - INFO: epoch 047:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=16929.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2987, ups=0.18, wpb=16929.5, bsz=1024, num_updates=18030, lr=2.86635e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=117928
2024-11-10 19:30:41 - progress_bar.py[line:274] - INFO: epoch 047:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17143.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3040.1, ups=0.18, wpb=17143.7, bsz=1024, num_updates=18040, lr=2.86499e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=117984
2024-11-10 19:31:38 - progress_bar.py[line:274] - INFO: epoch 047:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17154.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3016.7, ups=0.18, wpb=17154.6, bsz=1024, num_updates=18050, lr=2.86363e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=118041
2024-11-10 19:32:34 - progress_bar.py[line:274] - INFO: epoch 047:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17110.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3032.5, ups=0.18, wpb=17110.6, bsz=1024, num_updates=18060, lr=2.86227e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=118097
2024-11-10 19:33:31 - progress_bar.py[line:274] - INFO: epoch 047:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17389.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3065.3, ups=0.18, wpb=17389.4, bsz=1024, num_updates=18070, lr=2.86091e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=118154
2024-11-10 19:34:28 - progress_bar.py[line:274] - INFO: epoch 047:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17263.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3018.9, ups=0.17, wpb=17263.4, bsz=1024, num_updates=18080, lr=2.85955e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=118211
2024-11-10 19:35:25 - progress_bar.py[line:274] - INFO: epoch 047:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17300, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3024.4, ups=0.17, wpb=17300, bsz=1024, num_updates=18090, lr=2.85819e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=118268
2024-11-10 19:36:22 - progress_bar.py[line:274] - INFO: epoch 047:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17202.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3048.7, ups=0.18, wpb=17202.4, bsz=1024, num_updates=18100, lr=2.85683e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=118325
2024-11-10 19:37:19 - progress_bar.py[line:274] - INFO: epoch 047:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=16912.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2982.2, ups=0.18, wpb=16912.1, bsz=1024, num_updates=18110, lr=2.85547e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=118381
2024-11-10 19:38:16 - progress_bar.py[line:274] - INFO: epoch 047:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17265.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3023.6, ups=0.18, wpb=17265.6, bsz=1024, num_updates=18120, lr=2.85411e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=118439
2024-11-10 19:39:12 - progress_bar.py[line:274] - INFO: epoch 047:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17217.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3051, ups=0.18, wpb=17217.6, bsz=1024, num_updates=18130, lr=2.85275e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=118495
2024-11-10 19:40:08 - progress_bar.py[line:274] - INFO: epoch 047:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17066.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3030.8, ups=0.18, wpb=17066.5, bsz=1024, num_updates=18140, lr=2.85139e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=118551
2024-11-10 19:41:05 - progress_bar.py[line:274] - INFO: epoch 047:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17264.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3063.1, ups=0.18, wpb=17264.6, bsz=1024, num_updates=18150, lr=2.85003e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=118608
2024-11-10 19:42:01 - progress_bar.py[line:274] - INFO: epoch 047:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17006.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3020.4, ups=0.18, wpb=17006.1, bsz=1024, num_updates=18160, lr=2.84867e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=118664
2024-11-10 19:42:57 - progress_bar.py[line:274] - INFO: epoch 047:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17136.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3056.5, ups=0.18, wpb=17136.9, bsz=1024, num_updates=18170, lr=2.84731e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=118720
2024-11-10 19:43:54 - progress_bar.py[line:274] - INFO: epoch 047:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17141.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3012.5, ups=0.18, wpb=17141.8, bsz=1024, num_updates=18180, lr=2.84595e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=118777
2024-11-10 19:44:12 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 19:44:58 - progress_bar.py[line:274] - INFO: epoch 047:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17111.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2689.6, ups=0.16, wpb=17111.8, bsz=1024, num_updates=18190, lr=2.84459e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=59, gb_free=13.4, wall=118841
2024-11-10 19:45:56 - progress_bar.py[line:274] - INFO: epoch 047:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=16962.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2932, ups=0.17, wpb=16962.6, bsz=1024, num_updates=18200, lr=2.84323e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=118898
2024-11-10 19:46:49 - progress_bar.py[line:274] - INFO: epoch 047:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17379.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3245.9, ups=0.19, wpb=17379.1, bsz=1024, num_updates=18210, lr=2.84187e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=50, gb_free=13.3, wall=118952
2024-11-10 19:47:47 - progress_bar.py[line:274] - INFO: epoch 047:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17453.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3007.6, ups=0.17, wpb=17453.3, bsz=1024, num_updates=18220, lr=2.84051e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=49, gb_free=13.4, wall=119010
2024-11-10 19:48:45 - progress_bar.py[line:274] - INFO: epoch 047:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17209.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2996.6, ups=0.17, wpb=17209.6, bsz=1024, num_updates=18230, lr=2.83915e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=57, gb_free=13.3, wall=119067
2024-11-10 19:49:40 - progress_bar.py[line:274] - INFO: epoch 047:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17173.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3080.2, ups=0.18, wpb=17173.6, bsz=1024, num_updates=18240, lr=2.83779e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=119123
2024-11-10 19:50:33 - progress_bar.py[line:274] - INFO: epoch 047:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17122.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3224.7, ups=0.19, wpb=17122.1, bsz=1024, num_updates=18250, lr=2.83643e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=43, gb_free=13.5, wall=119176
2024-11-10 19:51:31 - progress_bar.py[line:274] - INFO: epoch 047:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17165.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2959.2, ups=0.17, wpb=17165.2, bsz=1024, num_updates=18260, lr=2.83507e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=45, gb_free=13.4, wall=119234
2024-11-10 19:52:30 - progress_bar.py[line:274] - INFO: epoch 047:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17138.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2915.2, ups=0.17, wpb=17138.8, bsz=1024, num_updates=18270, lr=2.83371e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=119293
2024-11-10 19:53:26 - progress_bar.py[line:274] - INFO: epoch 047:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17115.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3090.9, ups=0.18, wpb=17115.5, bsz=1024, num_updates=18280, lr=2.83234e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=119348
2024-11-10 19:54:21 - progress_bar.py[line:274] - INFO: epoch 047:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17173.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3078.1, ups=0.18, wpb=17173.2, bsz=1024, num_updates=18290, lr=2.83098e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=119404
2024-11-10 19:55:17 - progress_bar.py[line:274] - INFO: epoch 047:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17280.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3078, ups=0.18, wpb=17280.2, bsz=1024, num_updates=18300, lr=2.82962e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=119460
2024-11-10 19:56:14 - progress_bar.py[line:274] - INFO: epoch 047:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17083.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3000.5, ups=0.18, wpb=17083.3, bsz=1024, num_updates=18310, lr=2.82826e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=119517
2024-11-10 19:57:11 - progress_bar.py[line:274] - INFO: epoch 047:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17647.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3101.6, ups=0.18, wpb=17647.9, bsz=1024, num_updates=18320, lr=2.8269e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=119574
2024-11-10 19:58:08 - progress_bar.py[line:274] - INFO: epoch 047:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17677.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3110.9, ups=0.18, wpb=17677.7, bsz=1024, num_updates=18330, lr=2.82554e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=12.9, wall=119631
2024-11-10 19:59:04 - progress_bar.py[line:274] - INFO: epoch 047:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17612.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3131.9, ups=0.18, wpb=17612.3, bsz=1024, num_updates=18340, lr=2.82418e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=40, gb_free=12.9, wall=119687
2024-11-10 19:59:59 - progress_bar.py[line:274] - INFO: epoch 047:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17231.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3151.3, ups=0.18, wpb=17231.8, bsz=1024, num_updates=18350, lr=2.82282e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=35, gb_free=13, wall=119742
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
2024-11-10 20:00:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 47 @ 18356 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
2024-11-10 20:00:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 20:02:21 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 20:04:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 47 @ 18356 updates, score 0) (writing took 226.83550137397833 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-10 20:05:10 - train.py[line:336] - INFO: end of epoch 47 (average epoch stats below)
2024-11-10 20:05:10 - progress_bar.py[line:282] - INFO: epoch 047 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.748 | ntokens 17193.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.72 | wps 2532.3 | ups 0.15 | wpb 17193.4 | bsz 1023 | num_updates 18356 | lr 2.82201e-05 | gnorm 0.005 | clip 0 | loss_scale 16384 | train_wall 1461 | gb_free 13.1 | wall 120053
2024-11-10 20:05:10 - trainer.py[line:639] - INFO: loading train data for epoch 48
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 20:07:51 - trainer.py[line:703] - INFO: begin training epoch 48
2024-11-10 20:07:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 20:08:15 - progress_bar.py[line:274] - INFO: epoch 048:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=16552.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=333.6, ups=0.02, wpb=16552.7, bsz=985.6, num_updates=18360, lr=2.82146e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=120238
2024-11-10 20:09:12 - progress_bar.py[line:274] - INFO: epoch 048:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17152.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3019.3, ups=0.18, wpb=17152.7, bsz=1024, num_updates=18370, lr=2.8201e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=120295
2024-11-10 20:10:09 - progress_bar.py[line:274] - INFO: epoch 048:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17372.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3048.2, ups=0.18, wpb=17372.3, bsz=1024, num_updates=18380, lr=2.81874e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=120352
2024-11-10 20:11:06 - progress_bar.py[line:274] - INFO: epoch 048:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17250.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3032.5, ups=0.18, wpb=17250.4, bsz=1024, num_updates=18390, lr=2.81738e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=120409
2024-11-10 20:12:03 - progress_bar.py[line:274] - INFO: epoch 048:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17305.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3049.3, ups=0.18, wpb=17305.4, bsz=1024, num_updates=18400, lr=2.81602e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=120466
2024-11-10 20:12:59 - progress_bar.py[line:274] - INFO: epoch 048:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17221.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3031.4, ups=0.18, wpb=17221.4, bsz=1024, num_updates=18410, lr=2.81466e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=120522
2024-11-10 20:13:57 - progress_bar.py[line:274] - INFO: epoch 048:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17009.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=2967.8, ups=0.17, wpb=17009.7, bsz=1024, num_updates=18420, lr=2.8133e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=120580
2024-11-10 20:14:54 - progress_bar.py[line:274] - INFO: epoch 048:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17137.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2978.4, ups=0.17, wpb=17137.9, bsz=1024, num_updates=18430, lr=2.81194e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=35, gb_free=13.4, wall=120637
2024-11-10 20:15:50 - progress_bar.py[line:274] - INFO: epoch 048:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3083.9, ups=0.18, wpb=17102.7, bsz=1024, num_updates=18440, lr=2.81058e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.4, wall=120693
2024-11-10 20:16:47 - progress_bar.py[line:274] - INFO: epoch 048:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17141.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=2981.4, ups=0.17, wpb=17141.1, bsz=1024, num_updates=18450, lr=2.80922e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=120750
2024-11-10 20:17:45 - progress_bar.py[line:274] - INFO: epoch 048:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17082.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2954.7, ups=0.17, wpb=17082.1, bsz=1024, num_updates=18460, lr=2.80786e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=49, gb_free=13.5, wall=120808
2024-11-10 20:18:41 - progress_bar.py[line:274] - INFO: epoch 048:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=16871.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3000.5, ups=0.18, wpb=16871.2, bsz=1024, num_updates=18470, lr=2.8065e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=120864
2024-11-10 20:19:37 - progress_bar.py[line:274] - INFO: epoch 048:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17507.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3126.2, ups=0.18, wpb=17507.7, bsz=1024, num_updates=18480, lr=2.80514e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=36, gb_free=13.3, wall=120920
2024-11-10 20:20:34 - progress_bar.py[line:274] - INFO: epoch 048:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17252.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3035.4, ups=0.18, wpb=17252.3, bsz=1024, num_updates=18490, lr=2.80378e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=120977
2024-11-10 20:21:31 - progress_bar.py[line:274] - INFO: epoch 048:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17061.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2975.4, ups=0.17, wpb=17061.7, bsz=1024, num_updates=18500, lr=2.80242e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=121034
2024-11-10 20:22:28 - progress_bar.py[line:274] - INFO: epoch 048:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17320.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3059.1, ups=0.18, wpb=17320.6, bsz=1024, num_updates=18510, lr=2.80106e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=121091
2024-11-10 20:23:27 - progress_bar.py[line:274] - INFO: epoch 048:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17244.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2941.8, ups=0.17, wpb=17244.6, bsz=1024, num_updates=18520, lr=2.7997e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=41, gb_free=13.1, wall=121150
2024-11-10 20:24:22 - progress_bar.py[line:274] - INFO: epoch 048:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=17125.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3074.6, ups=0.18, wpb=17125.4, bsz=1024, num_updates=18530, lr=2.79833e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=121205
2024-11-10 20:25:19 - progress_bar.py[line:274] - INFO: epoch 048:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17090, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3001.8, ups=0.18, wpb=17090, bsz=1024, num_updates=18540, lr=2.79697e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=121262
2024-11-10 20:26:16 - progress_bar.py[line:274] - INFO: epoch 048:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17062.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2989.4, ups=0.18, wpb=17062.6, bsz=1024, num_updates=18550, lr=2.79561e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=121319
2024-11-10 20:27:13 - progress_bar.py[line:274] - INFO: epoch 048:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17250.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3037.4, ups=0.18, wpb=17250.7, bsz=1024, num_updates=18560, lr=2.79425e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=121376
2024-11-10 20:28:11 - progress_bar.py[line:274] - INFO: epoch 048:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=16966.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2959.9, ups=0.17, wpb=16966.5, bsz=1024, num_updates=18570, lr=2.79289e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=121433
2024-11-10 20:29:08 - progress_bar.py[line:274] - INFO: epoch 048:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17240.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3017.2, ups=0.18, wpb=17240.6, bsz=1024, num_updates=18580, lr=2.79153e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=121491
2024-11-10 20:30:05 - progress_bar.py[line:274] - INFO: epoch 048:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17186.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3006.8, ups=0.17, wpb=17186.2, bsz=1024, num_updates=18590, lr=2.79017e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=121548
2024-11-10 20:31:03 - progress_bar.py[line:274] - INFO: epoch 048:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17317.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2962.4, ups=0.17, wpb=17317.8, bsz=1024, num_updates=18600, lr=2.78881e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=36, gb_free=13.3, wall=121606
2024-11-10 20:32:02 - progress_bar.py[line:274] - INFO: epoch 048:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17288.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=2945.4, ups=0.17, wpb=17288.2, bsz=1024, num_updates=18610, lr=2.78745e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=121665
2024-11-10 20:33:00 - progress_bar.py[line:274] - INFO: epoch 048:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17288.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3000.6, ups=0.17, wpb=17288.2, bsz=1024, num_updates=18620, lr=2.78609e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=121723
2024-11-10 20:33:59 - progress_bar.py[line:274] - INFO: epoch 048:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17272.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=2926.7, ups=0.17, wpb=17272.1, bsz=1024, num_updates=18630, lr=2.78473e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=59, gb_free=13.4, wall=121782
2024-11-10 20:34:52 - progress_bar.py[line:274] - INFO: epoch 048:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=16999.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3174.3, ups=0.19, wpb=16999.4, bsz=1024, num_updates=18640, lr=2.78337e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=121835
2024-11-10 20:35:51 - progress_bar.py[line:274] - INFO: epoch 048:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17141, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2911.1, ups=0.17, wpb=17141, bsz=1024, num_updates=18650, lr=2.78201e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=45, gb_free=13.4, wall=121894
2024-11-10 20:36:49 - progress_bar.py[line:274] - INFO: epoch 048:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17261.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2973.8, ups=0.17, wpb=17261.2, bsz=1024, num_updates=18660, lr=2.78065e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=121952
2024-11-10 20:37:45 - progress_bar.py[line:274] - INFO: epoch 048:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17111.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3071.6, ups=0.18, wpb=17111.5, bsz=1024, num_updates=18670, lr=2.77929e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=122008
2024-11-10 20:38:43 - progress_bar.py[line:274] - INFO: epoch 048:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17278.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2951.4, ups=0.17, wpb=17278.9, bsz=1024, num_updates=18680, lr=2.77793e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=122066
2024-11-10 20:39:42 - progress_bar.py[line:274] - INFO: epoch 048:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=16995.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2908.9, ups=0.17, wpb=16995.2, bsz=1024, num_updates=18690, lr=2.77657e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=122125
2024-11-10 20:40:36 - progress_bar.py[line:274] - INFO: epoch 048:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=16904.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3101.7, ups=0.18, wpb=16904.6, bsz=1024, num_updates=18700, lr=2.77521e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=122179
2024-11-10 20:41:34 - progress_bar.py[line:274] - INFO: epoch 048:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17191.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3001.8, ups=0.17, wpb=17191.8, bsz=1024, num_updates=18710, lr=2.77385e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=122236
2024-11-10 20:42:29 - progress_bar.py[line:274] - INFO: epoch 048:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17224.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3124.7, ups=0.18, wpb=17224.8, bsz=1024, num_updates=18720, lr=2.77249e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=122292
2024-11-10 20:43:27 - progress_bar.py[line:274] - INFO: epoch 048:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17152.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2963.3, ups=0.17, wpb=17152.7, bsz=1024, num_updates=18730, lr=2.77113e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=122350
2024-11-10 20:44:26 - progress_bar.py[line:274] - INFO: epoch 048:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17129.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2898.2, ups=0.17, wpb=17129.6, bsz=1024, num_updates=18740, lr=2.76977e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=122409
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt2024-11-10 20:45:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 48 @ 18747 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
2024-11-10 20:45:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 20:46:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-10 20:48:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 48 @ 18747 updates, score 0) (writing took 224.26189319399418 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-10 20:49:42 - train.py[line:336] - INFO: end of epoch 48 (average epoch stats below)
2024-11-10 20:49:42 - progress_bar.py[line:282] - INFO: epoch 048 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.736 | ntokens 17149.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.66 | wps 2509 | ups 0.15 | wpb 17149.6 | bsz 1023 | num_updates 18747 | lr 2.76881e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1569 | gb_free 13.2 | wall 122725
2024-11-10 20:49:42 - trainer.py[line:639] - INFO: loading train data for epoch 49
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 20:52:21 - trainer.py[line:703] - INFO: begin training epoch 49
2024-11-10 20:52:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 20:52:40 - progress_bar.py[line:274] - INFO: epoch 049:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=16348.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=330.9, ups=0.02, wpb=16348.4, bsz=985.6, num_updates=18750, lr=2.76841e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=46, gb_free=13.3, wall=122903
2024-11-10 20:53:37 - progress_bar.py[line:274] - INFO: epoch 049:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=16998.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2982.7, ups=0.18, wpb=16998.1, bsz=1024, num_updates=18760, lr=2.76705e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=122960
2024-11-10 20:54:34 - progress_bar.py[line:274] - INFO: epoch 049:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17401.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3032.9, ups=0.17, wpb=17401.6, bsz=1024, num_updates=18770, lr=2.76569e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=123017
2024-11-10 20:55:30 - progress_bar.py[line:274] - INFO: epoch 049:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=16901.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3008.1, ups=0.18, wpb=16901.8, bsz=1024, num_updates=18780, lr=2.76432e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=123073
2024-11-10 20:55:41 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 20:56:34 - progress_bar.py[line:274] - INFO: epoch 049:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17067.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2684.4, ups=0.16, wpb=17067.6, bsz=1024, num_updates=18790, lr=2.76296e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=123137
2024-11-10 20:57:32 - progress_bar.py[line:274] - INFO: epoch 049:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17199.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2975.1, ups=0.17, wpb=17199.8, bsz=1024, num_updates=18800, lr=2.7616e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=123195
2024-11-10 20:58:25 - progress_bar.py[line:274] - INFO: epoch 049:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17291.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3224.2, ups=0.19, wpb=17291.2, bsz=1024, num_updates=18810, lr=2.76024e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=51, gb_free=13.2, wall=123248
2024-11-10 20:59:19 - progress_bar.py[line:274] - INFO: epoch 049:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17365.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3216.8, ups=0.19, wpb=17365.8, bsz=1024, num_updates=18820, lr=2.75888e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=34, gb_free=13.1, wall=123302
2024-11-10 21:00:17 - progress_bar.py[line:274] - INFO: epoch 049:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17118.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2978.6, ups=0.17, wpb=17118.6, bsz=1024, num_updates=18830, lr=2.75752e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=39, gb_free=13.4, wall=123360
2024-11-10 21:01:13 - progress_bar.py[line:274] - INFO: epoch 049:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17148.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3067.7, ups=0.18, wpb=17148.3, bsz=1024, num_updates=18840, lr=2.75616e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=123416
2024-11-10 21:02:06 - progress_bar.py[line:274] - INFO: epoch 049:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3234.7, ups=0.19, wpb=17245.1, bsz=1024, num_updates=18850, lr=2.7548e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=37, gb_free=13.4, wall=123469
2024-11-10 21:03:04 - progress_bar.py[line:274] - INFO: epoch 049:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17208.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2986.2, ups=0.17, wpb=17208.7, bsz=1024, num_updates=18860, lr=2.75344e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=45, gb_free=13.3, wall=123527
2024-11-10 21:04:00 - progress_bar.py[line:274] - INFO: epoch 049:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17268.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3059.1, ups=0.18, wpb=17268.8, bsz=1024, num_updates=18870, lr=2.75208e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=123583
2024-11-10 21:04:55 - progress_bar.py[line:274] - INFO: epoch 049:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17070.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3135.4, ups=0.18, wpb=17070.7, bsz=1024, num_updates=18880, lr=2.75072e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.5, wall=123637
2024-11-10 21:05:50 - progress_bar.py[line:274] - INFO: epoch 049:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17009.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3063.7, ups=0.18, wpb=17009.9, bsz=1024, num_updates=18890, lr=2.74936e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=123693
2024-11-10 21:06:46 - progress_bar.py[line:274] - INFO: epoch 049:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17285.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3117.6, ups=0.18, wpb=17285.6, bsz=1024, num_updates=18900, lr=2.748e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=123748
2024-11-10 21:07:41 - progress_bar.py[line:274] - INFO: epoch 049:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17169.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3099.5, ups=0.18, wpb=17169.6, bsz=1024, num_updates=18910, lr=2.74664e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=123804
2024-11-10 21:08:37 - progress_bar.py[line:274] - INFO: epoch 049:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17233.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3077.2, ups=0.18, wpb=17233.3, bsz=1024, num_updates=18920, lr=2.74528e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=123860
2024-11-10 21:09:33 - progress_bar.py[line:274] - INFO: epoch 049:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3060.4, ups=0.18, wpb=17226, bsz=1024, num_updates=18930, lr=2.74392e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=123916
2024-11-10 21:10:30 - progress_bar.py[line:274] - INFO: epoch 049:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17057.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2984.1, ups=0.17, wpb=17057.2, bsz=1024, num_updates=18940, lr=2.74256e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=41, gb_free=13.1, wall=123973
2024-11-10 21:11:25 - progress_bar.py[line:274] - INFO: epoch 049:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17258.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3188.8, ups=0.18, wpb=17258.1, bsz=1024, num_updates=18950, lr=2.7412e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=51, gb_free=13, wall=124027
2024-11-10 21:12:21 - progress_bar.py[line:274] - INFO: epoch 049:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17070.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3017.7, ups=0.18, wpb=17070.4, bsz=1024, num_updates=18960, lr=2.73984e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=35, gb_free=13.4, wall=124084
2024-11-10 21:13:19 - progress_bar.py[line:274] - INFO: epoch 049:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17077.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2953.4, ups=0.17, wpb=17077.3, bsz=1024, num_updates=18970, lr=2.73848e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=47, gb_free=13.4, wall=124142
2024-11-10 21:14:13 - progress_bar.py[line:274] - INFO: epoch 049:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17073.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3148.5, ups=0.18, wpb=17073.7, bsz=1024, num_updates=18980, lr=2.73712e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=124196
2024-11-10 21:15:08 - progress_bar.py[line:274] - INFO: epoch 049:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17306.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3178.7, ups=0.18, wpb=17306.4, bsz=1024, num_updates=18990, lr=2.73576e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=124250
2024-11-10 21:16:05 - progress_bar.py[line:274] - INFO: epoch 049:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17183.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3018.3, ups=0.18, wpb=17183.5, bsz=1024, num_updates=19000, lr=2.7344e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=35, gb_free=13.2, wall=124307
2024-11-10 21:17:03 - progress_bar.py[line:274] - INFO: epoch 049:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17487.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3004.4, ups=0.17, wpb=17487.3, bsz=1024, num_updates=19010, lr=2.73304e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=54, gb_free=13.2, wall=124366
2024-11-10 21:18:00 - progress_bar.py[line:274] - INFO: epoch 049:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17055.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2958.6, ups=0.17, wpb=17055.7, bsz=1024, num_updates=19020, lr=2.73168e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=124423
2024-11-10 21:18:55 - progress_bar.py[line:274] - INFO: epoch 049:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17219.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3147.6, ups=0.18, wpb=17219.8, bsz=1024, num_updates=19030, lr=2.73032e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=124478
2024-11-10 21:19:49 - progress_bar.py[line:274] - INFO: epoch 049:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17320.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3240.3, ups=0.19, wpb=17320.2, bsz=1024, num_updates=19040, lr=2.72895e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=43, gb_free=13.4, wall=124531
2024-11-10 21:20:45 - progress_bar.py[line:274] - INFO: epoch 049:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17135.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3044.1, ups=0.18, wpb=17135.4, bsz=1024, num_updates=19050, lr=2.72759e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=124588
2024-11-10 21:21:42 - progress_bar.py[line:274] - INFO: epoch 049:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17059.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3006.3, ups=0.18, wpb=17059.4, bsz=1024, num_updates=19060, lr=2.72623e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=124644
2024-11-10 21:22:39 - progress_bar.py[line:274] - INFO: epoch 049:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17146, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2966.6, ups=0.17, wpb=17146, bsz=1024, num_updates=19070, lr=2.72487e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=43, gb_free=13.2, wall=124702
2024-11-10 21:23:34 - progress_bar.py[line:274] - INFO: epoch 049:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17260.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3187.8, ups=0.18, wpb=17260.2, bsz=1024, num_updates=19080, lr=2.72351e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=49, gb_free=13.2, wall=124756
2024-11-10 21:24:30 - progress_bar.py[line:274] - INFO: epoch 049:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=16917.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2972.2, ups=0.18, wpb=16917.1, bsz=1024, num_updates=19090, lr=2.72215e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=124813
2024-11-10 21:25:28 - progress_bar.py[line:274] - INFO: epoch 049:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17219.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2984.7, ups=0.17, wpb=17219.1, bsz=1024, num_updates=19100, lr=2.72079e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=50, gb_free=13.5, wall=124871
2024-11-10 21:26:26 - progress_bar.py[line:274] - INFO: epoch 049:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17169.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2967.9, ups=0.17, wpb=17169.4, bsz=1024, num_updates=19110, lr=2.71943e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=124929
2024-11-10 21:27:24 - progress_bar.py[line:274] - INFO: epoch 049:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17661.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3063, ups=0.17, wpb=17661.2, bsz=1024, num_updates=19120, lr=2.71807e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=12.9, wall=124987
2024-11-10 21:28:21 - progress_bar.py[line:274] - INFO: epoch 049:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17145.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2978, ups=0.17, wpb=17145.5, bsz=1024, num_updates=19130, lr=2.71671e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13.2, wall=125044
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt2024-11-10 21:28:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 49 @ 19137 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
2024-11-10 21:28:54 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 21:30:48 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 21:32:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 49 @ 19137 updates, score 0) (writing took 227.30375374300638 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-10 21:33:37 - train.py[line:336] - INFO: end of epoch 49 (average epoch stats below)
2024-11-10 21:33:37 - progress_bar.py[line:282] - INFO: epoch 049 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.728 | ntokens 17170.7 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.63 | wps 2541.6 | ups 0.15 | wpb 17170.7 | bsz 1023 | num_updates 19137 | lr 2.71576e-05 | gnorm 0.005 | clip 0 | loss_scale 16384 | train_wall 1674 | gb_free 13.2 | wall 125360
2024-11-10 21:33:37 - trainer.py[line:639] - INFO: loading train data for epoch 50
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 21:36:19 - trainer.py[line:703] - INFO: begin training epoch 50
2024-11-10 21:36:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 21:36:38 - progress_bar.py[line:274] - INFO: epoch 050:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=16600.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=334.2, ups=0.02, wpb=16600.6, bsz=985.6, num_updates=19140, lr=2.71535e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=42, gb_free=13.1, wall=125541
2024-11-10 21:37:34 - progress_bar.py[line:274] - INFO: epoch 050:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=16961.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3003.3, ups=0.18, wpb=16961.9, bsz=1024, num_updates=19150, lr=2.71399e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=125597
2024-11-10 21:38:32 - progress_bar.py[line:274] - INFO: epoch 050:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17321.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2997.3, ups=0.17, wpb=17321.7, bsz=1024, num_updates=19160, lr=2.71263e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=125655
2024-11-10 21:39:29 - progress_bar.py[line:274] - INFO: epoch 050:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17257.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3042.3, ups=0.18, wpb=17257.8, bsz=1024, num_updates=19170, lr=2.71127e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=125712
2024-11-10 21:40:26 - progress_bar.py[line:274] - INFO: epoch 050:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17181.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3026.8, ups=0.18, wpb=17181.7, bsz=1024, num_updates=19180, lr=2.70991e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=125769
2024-11-10 21:41:23 - progress_bar.py[line:274] - INFO: epoch 050:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17147.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2989.3, ups=0.17, wpb=17147.9, bsz=1024, num_updates=19190, lr=2.70855e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=12.7, wall=125826
2024-11-10 21:42:19 - progress_bar.py[line:274] - INFO: epoch 050:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17065.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3026.6, ups=0.18, wpb=17065.6, bsz=1024, num_updates=19200, lr=2.70719e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=125882
2024-11-10 21:43:16 - progress_bar.py[line:274] - INFO: epoch 050:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17003.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2979.2, ups=0.18, wpb=17003.2, bsz=1024, num_updates=19210, lr=2.70583e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=125939
2024-11-10 21:44:13 - progress_bar.py[line:274] - INFO: epoch 050:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17169.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3036.6, ups=0.18, wpb=17169.8, bsz=1024, num_updates=19220, lr=2.70447e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=125996
2024-11-10 21:45:10 - progress_bar.py[line:274] - INFO: epoch 050:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17137, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3005.4, ups=0.18, wpb=17137, bsz=1024, num_updates=19230, lr=2.70311e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=126053
2024-11-10 21:46:08 - progress_bar.py[line:274] - INFO: epoch 050:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17299.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2990.5, ups=0.17, wpb=17299.4, bsz=1024, num_updates=19240, lr=2.70175e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=126111
2024-11-10 21:47:06 - progress_bar.py[line:274] - INFO: epoch 050:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17269.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2987.5, ups=0.17, wpb=17269.6, bsz=1024, num_updates=19250, lr=2.70039e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=126169
2024-11-10 21:48:03 - progress_bar.py[line:274] - INFO: epoch 050:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17052.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2967.1, ups=0.17, wpb=17052.4, bsz=1024, num_updates=19260, lr=2.69903e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=126226
2024-11-10 21:49:00 - progress_bar.py[line:274] - INFO: epoch 050:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17477.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3058.6, ups=0.17, wpb=17477.9, bsz=1024, num_updates=19270, lr=2.69767e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=126283
2024-11-10 21:49:57 - progress_bar.py[line:274] - INFO: epoch 050:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=16926.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2962.7, ups=0.18, wpb=16926.5, bsz=1024, num_updates=19280, lr=2.69631e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=126340
2024-11-10 21:50:54 - progress_bar.py[line:274] - INFO: epoch 050:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17423, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3075.2, ups=0.18, wpb=17423, bsz=1024, num_updates=19290, lr=2.69494e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=126397
2024-11-10 21:51:52 - progress_bar.py[line:274] - INFO: epoch 050:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=16950.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2952, ups=0.17, wpb=16950.9, bsz=1024, num_updates=19300, lr=2.69358e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=126454
2024-11-10 21:52:49 - progress_bar.py[line:274] - INFO: epoch 050:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=16903.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2954.7, ups=0.17, wpb=16903.8, bsz=1024, num_updates=19310, lr=2.69222e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=126512
2024-11-10 21:53:46 - progress_bar.py[line:274] - INFO: epoch 050:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=16848.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2948, ups=0.17, wpb=16848.3, bsz=1024, num_updates=19320, lr=2.69086e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.1, wall=126569
2024-11-10 21:54:42 - progress_bar.py[line:274] - INFO: epoch 050:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17279.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3064.2, ups=0.18, wpb=17279.8, bsz=1024, num_updates=19330, lr=2.6895e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=126625
2024-11-10 21:55:39 - progress_bar.py[line:274] - INFO: epoch 050:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17192.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3022.8, ups=0.18, wpb=17192.1, bsz=1024, num_updates=19340, lr=2.68814e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=126682
2024-11-10 21:56:36 - progress_bar.py[line:274] - INFO: epoch 050:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=16968.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2974.4, ups=0.18, wpb=16968.6, bsz=1024, num_updates=19350, lr=2.68678e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=126739
2024-11-10 21:57:33 - progress_bar.py[line:274] - INFO: epoch 050:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17172.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3008.7, ups=0.18, wpb=17172.7, bsz=1024, num_updates=19360, lr=2.68542e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=126796
2024-11-10 21:58:32 - progress_bar.py[line:274] - INFO: epoch 050:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17159.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2923.3, ups=0.17, wpb=17159.5, bsz=1024, num_updates=19370, lr=2.68406e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=126855
2024-11-10 21:59:27 - progress_bar.py[line:274] - INFO: epoch 050:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17017.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3110, ups=0.18, wpb=17017.1, bsz=1024, num_updates=19380, lr=2.6827e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.3, wall=126910
2024-11-10 22:00:25 - progress_bar.py[line:274] - INFO: epoch 050:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17620.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3043.5, ups=0.17, wpb=17620.1, bsz=1024, num_updates=19390, lr=2.68134e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=126967
2024-11-10 22:00:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-10 22:01:27 - progress_bar.py[line:274] - INFO: epoch 050:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17309.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=2795.3, ups=0.16, wpb=17309.5, bsz=1024, num_updates=19400, lr=2.67998e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=39, gb_free=13.1, wall=127029
2024-11-10 22:02:24 - progress_bar.py[line:274] - INFO: epoch 050:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=16997.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2981.6, ups=0.18, wpb=16997.9, bsz=1024, num_updates=19410, lr=2.67862e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=127086
2024-11-10 22:03:20 - progress_bar.py[line:274] - INFO: epoch 050:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17255.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3067.5, ups=0.18, wpb=17255.7, bsz=1024, num_updates=19420, lr=2.67726e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=127143
2024-11-10 22:04:17 - progress_bar.py[line:274] - INFO: epoch 050:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17409.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3031.9, ups=0.17, wpb=17409.8, bsz=1024, num_updates=19430, lr=2.6759e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=127200
2024-11-10 22:05:14 - progress_bar.py[line:274] - INFO: epoch 050:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17007.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2985.3, ups=0.18, wpb=17007.5, bsz=1024, num_updates=19440, lr=2.67454e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=127257
2024-11-10 22:06:11 - progress_bar.py[line:274] - INFO: epoch 050:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17025.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2980.1, ups=0.18, wpb=17025.9, bsz=1024, num_updates=19450, lr=2.67318e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=127314
2024-11-10 22:07:09 - progress_bar.py[line:274] - INFO: epoch 050:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17010.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2971.2, ups=0.17, wpb=17010.9, bsz=1024, num_updates=19460, lr=2.67182e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=127371
2024-11-10 22:08:08 - progress_bar.py[line:274] - INFO: epoch 050:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17300.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2931.4, ups=0.17, wpb=17300.2, bsz=1024, num_updates=19470, lr=2.67046e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=38, gb_free=13.2, wall=127430
2024-11-10 22:09:03 - progress_bar.py[line:274] - INFO: epoch 050:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17053.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3058.4, ups=0.18, wpb=17053.4, bsz=1024, num_updates=19480, lr=2.6691e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=43, gb_free=13.3, wall=127486
2024-11-10 22:10:01 - progress_bar.py[line:274] - INFO: epoch 050:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17131.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2967.2, ups=0.17, wpb=17131.1, bsz=1024, num_updates=19490, lr=2.66774e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=127544
2024-11-10 22:11:00 - progress_bar.py[line:274] - INFO: epoch 050:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=17360.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=2946.9, ups=0.17, wpb=17360.1, bsz=1024, num_updates=19500, lr=2.66638e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=50, gb_free=13.4, wall=127603
2024-11-10 22:11:57 - progress_bar.py[line:274] - INFO: epoch 050:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17166.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3003.6, ups=0.17, wpb=17166.9, bsz=1024, num_updates=19510, lr=2.66502e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=12.8, wall=127660
2024-11-10 22:12:55 - progress_bar.py[line:274] - INFO: epoch 050:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17107.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2957.9, ups=0.17, wpb=17107.7, bsz=1024, num_updates=19520, lr=2.66366e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=127718
2024-11-10 22:13:32 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 50 @ 19527 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
2024-11-10 22:13:32 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 22:15:25 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 22:17:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 50 @ 19527 updates, score 0) (writing took 226.28427218302386 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-10 22:18:14 - train.py[line:336] - INFO: end of epoch 50 (average epoch stats below)
2024-11-10 22:18:14 - progress_bar.py[line:282] - INFO: epoch 050 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.717 | ntokens 17135.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.57 | wps 2496.7 | ups 0.15 | wpb 17135.5 | bsz 1023 | num_updates 19527 | lr 2.6627e-05 | gnorm 0.005 | clip 0 | loss_scale 16384 | train_wall 1358 | gb_free 13.5 | wall 128037
2024-11-10 22:18:14 - trainer.py[line:639] - INFO: loading train data for epoch 51
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 22:20:55 - trainer.py[line:703] - INFO: begin training epoch 51
2024-11-10 22:20:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 22:21:15 - progress_bar.py[line:274] - INFO: epoch 051:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=16392.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=328.2, ups=0.02, wpb=16392.5, bsz=985.6, num_updates=19530, lr=2.6623e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=46, gb_free=12.9, wall=128217
2024-11-10 22:22:11 - progress_bar.py[line:274] - INFO: epoch 051:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17141.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3053, ups=0.18, wpb=17141.2, bsz=1024, num_updates=19540, lr=2.66093e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=128274
2024-11-10 22:23:08 - progress_bar.py[line:274] - INFO: epoch 051:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17385.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3035.9, ups=0.17, wpb=17385.4, bsz=1024, num_updates=19550, lr=2.65957e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=128331
2024-11-10 22:24:05 - progress_bar.py[line:274] - INFO: epoch 051:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17260.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3031.2, ups=0.18, wpb=17260.8, bsz=1024, num_updates=19560, lr=2.65821e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=128388
2024-11-10 22:25:02 - progress_bar.py[line:274] - INFO: epoch 051:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17312.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3049.8, ups=0.18, wpb=17312.4, bsz=1024, num_updates=19570, lr=2.65685e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=128445
2024-11-10 22:25:58 - progress_bar.py[line:274] - INFO: epoch 051:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17205.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3027.8, ups=0.18, wpb=17205.9, bsz=1024, num_updates=19580, lr=2.65549e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13, wall=128501
2024-11-10 22:26:55 - progress_bar.py[line:274] - INFO: epoch 051:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17090, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3030.3, ups=0.18, wpb=17090, bsz=1024, num_updates=19590, lr=2.65413e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=36, gb_free=13.3, wall=128558
2024-11-10 22:27:51 - progress_bar.py[line:274] - INFO: epoch 051:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=16958.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3026.9, ups=0.18, wpb=16958.4, bsz=1024, num_updates=19600, lr=2.65277e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=128614
2024-11-10 22:28:47 - progress_bar.py[line:274] - INFO: epoch 051:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17186.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3043.9, ups=0.18, wpb=17186.1, bsz=1024, num_updates=19610, lr=2.65141e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=128670
2024-11-10 22:29:45 - progress_bar.py[line:274] - INFO: epoch 051:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17205.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2991.5, ups=0.17, wpb=17205.9, bsz=1024, num_updates=19620, lr=2.65005e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=128728
2024-11-10 22:30:42 - progress_bar.py[line:274] - INFO: epoch 051:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17259.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3012.6, ups=0.17, wpb=17259.2, bsz=1024, num_updates=19630, lr=2.64869e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=128785
2024-11-10 22:31:40 - progress_bar.py[line:274] - INFO: epoch 051:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17064.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2951.2, ups=0.17, wpb=17064.8, bsz=1024, num_updates=19640, lr=2.64733e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=128843
2024-11-10 22:32:37 - progress_bar.py[line:274] - INFO: epoch 051:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17260.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3035.4, ups=0.18, wpb=17260.6, bsz=1024, num_updates=19650, lr=2.64597e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=128900
2024-11-10 22:33:34 - progress_bar.py[line:274] - INFO: epoch 051:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2977.9, ups=0.17, wpb=17102.7, bsz=1024, num_updates=19660, lr=2.64461e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=128957
2024-11-10 22:34:33 - progress_bar.py[line:274] - INFO: epoch 051:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=16930, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2898.6, ups=0.17, wpb=16930, bsz=1024, num_updates=19670, lr=2.64325e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=129016
2024-11-10 22:35:30 - progress_bar.py[line:274] - INFO: epoch 051:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17206.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3003.4, ups=0.17, wpb=17206.5, bsz=1024, num_updates=19680, lr=2.64189e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=129073
2024-11-10 22:36:27 - progress_bar.py[line:274] - INFO: epoch 051:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17075.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2973.2, ups=0.17, wpb=17075.3, bsz=1024, num_updates=19690, lr=2.64053e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=129130
2024-11-10 22:37:24 - progress_bar.py[line:274] - INFO: epoch 051:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17083, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2999.5, ups=0.18, wpb=17083, bsz=1024, num_updates=19700, lr=2.63917e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=129187
2024-11-10 22:38:22 - progress_bar.py[line:274] - INFO: epoch 051:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17032.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2961.4, ups=0.17, wpb=17032.2, bsz=1024, num_updates=19710, lr=2.63781e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=129245
2024-11-10 22:39:21 - progress_bar.py[line:274] - INFO: epoch 051:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17003.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=2887.6, ups=0.17, wpb=17003.1, bsz=1024, num_updates=19720, lr=2.63645e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=37, gb_free=13.3, wall=129304
2024-11-10 22:40:20 - progress_bar.py[line:274] - INFO: epoch 051:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17195.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2907.2, ups=0.17, wpb=17195.2, bsz=1024, num_updates=19730, lr=2.63509e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=50, gb_free=13.3, wall=129363
2024-11-10 22:41:14 - progress_bar.py[line:274] - INFO: epoch 051:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=16909.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3107.4, ups=0.18, wpb=16909.1, bsz=1024, num_updates=19740, lr=2.63373e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=42, gb_free=13.3, wall=129417
2024-11-10 22:42:12 - progress_bar.py[line:274] - INFO: epoch 051:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17344.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2995.2, ups=0.17, wpb=17344.8, bsz=1024, num_updates=19750, lr=2.63237e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=35, gb_free=13.5, wall=129475
2024-11-10 22:43:08 - progress_bar.py[line:274] - INFO: epoch 051:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17402.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3119.6, ups=0.18, wpb=17402.6, bsz=1024, num_updates=19760, lr=2.63101e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=38, gb_free=13.5, wall=129531
2024-11-10 22:44:06 - progress_bar.py[line:274] - INFO: epoch 051:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17014.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2952.8, ups=0.17, wpb=17014.7, bsz=1024, num_updates=19770, lr=2.62965e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=33, gb_free=13.2, wall=129589
2024-11-10 22:45:02 - progress_bar.py[line:274] - INFO: epoch 051:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3088.5, ups=0.18, wpb=17323.2, bsz=1024, num_updates=19780, lr=2.62829e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=129645
2024-11-10 22:45:59 - progress_bar.py[line:274] - INFO: epoch 051:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17164.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2976.3, ups=0.17, wpb=17164.1, bsz=1024, num_updates=19790, lr=2.62692e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=129702
2024-11-10 22:46:57 - progress_bar.py[line:274] - INFO: epoch 051:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=16959.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=2953.7, ups=0.17, wpb=16959.4, bsz=1024, num_updates=19800, lr=2.62556e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=129760
2024-11-10 22:47:54 - progress_bar.py[line:274] - INFO: epoch 051:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17356.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3051.3, ups=0.18, wpb=17356.9, bsz=1024, num_updates=19810, lr=2.6242e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=129817
2024-11-10 22:48:51 - progress_bar.py[line:274] - INFO: epoch 051:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17299.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3000.9, ups=0.17, wpb=17299.6, bsz=1024, num_updates=19820, lr=2.62284e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=129874
2024-11-10 22:49:49 - progress_bar.py[line:274] - INFO: epoch 051:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17449.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3020.8, ups=0.17, wpb=17449.6, bsz=1024, num_updates=19830, lr=2.62148e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=129932
2024-11-10 22:50:48 - progress_bar.py[line:274] - INFO: epoch 051:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=16928.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2865.8, ups=0.17, wpb=16928.5, bsz=1024, num_updates=19840, lr=2.62012e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=46, gb_free=13.5, wall=129991
2024-11-10 22:51:47 - progress_bar.py[line:274] - INFO: epoch 051:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17093, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2909.6, ups=0.17, wpb=17093, bsz=1024, num_updates=19850, lr=2.61876e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=58, gb_free=13.1, wall=130050
2024-11-10 22:52:45 - progress_bar.py[line:274] - INFO: epoch 051:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17078.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2916.6, ups=0.17, wpb=17078.4, bsz=1024, num_updates=19860, lr=2.6174e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=130108
2024-11-10 22:53:44 - progress_bar.py[line:274] - INFO: epoch 051:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17081.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2917.8, ups=0.17, wpb=17081.9, bsz=1024, num_updates=19870, lr=2.61604e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=130167
2024-11-10 22:54:43 - progress_bar.py[line:274] - INFO: epoch 051:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17311.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2940.1, ups=0.17, wpb=17311.2, bsz=1024, num_updates=19880, lr=2.61468e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=59, gb_free=13.4, wall=130226
2024-11-10 22:55:37 - progress_bar.py[line:274] - INFO: epoch 051:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17268, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3199.8, ups=0.19, wpb=17268, bsz=1024, num_updates=19890, lr=2.61332e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=49, gb_free=13.2, wall=130280
2024-11-10 22:56:35 - progress_bar.py[line:274] - INFO: epoch 051:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17400.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2984.4, ups=0.17, wpb=17400.3, bsz=1024, num_updates=19900, lr=2.61196e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13, wall=130338
2024-11-10 22:57:32 - progress_bar.py[line:274] - INFO: epoch 051:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17238.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3056.7, ups=0.18, wpb=17238.7, bsz=1024, num_updates=19910, lr=2.6106e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=130394
2024-11-10 22:58:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 51 @ 19918 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
2024-11-10 22:58:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt': File exists: File exists
: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 23:00:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-10 23:01:56 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 51 @ 19918 updates, score 0) (writing took 223.8179912850028 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-10 23:02:51 - train.py[line:336] - INFO: end of epoch 51 (average epoch stats below)
2024-11-10 23:02:51 - progress_bar.py[line:282] - INFO: epoch 051 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.709 | ntokens 17156.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.54 | wps 2505.5 | ups 0.15 | wpb 17156.7 | bsz 1023 | num_updates 19918 | lr 2.60951e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1478 | gb_free 13.2 | wall 130714
2024-11-10 23:02:51 - trainer.py[line:639] - INFO: loading train data for epoch 52
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 23:05:32 - trainer.py[line:703] - INFO: begin training epoch 52
2024-11-10 23:05:32 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 23:05:45 - progress_bar.py[line:274] - INFO: epoch 052:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.711, ntokens=16570, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=335.7, ups=0.02, wpb=16570, bsz=985.6, num_updates=19920, lr=2.60924e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=130888
2024-11-10 23:06:43 - progress_bar.py[line:274] - INFO: epoch 052:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17407.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3011.1, ups=0.17, wpb=17407.2, bsz=1024, num_updates=19930, lr=2.60788e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=130946
2024-11-10 23:07:40 - progress_bar.py[line:274] - INFO: epoch 052:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17363.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3043, ups=0.18, wpb=17363.2, bsz=1024, num_updates=19940, lr=2.60652e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=131003
2024-11-10 23:08:38 - progress_bar.py[line:274] - INFO: epoch 052:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17010.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2949.2, ups=0.17, wpb=17010.9, bsz=1024, num_updates=19950, lr=2.60516e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=131061
2024-11-10 23:09:35 - progress_bar.py[line:274] - INFO: epoch 052:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17571.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3046.6, ups=0.17, wpb=17571.7, bsz=1024, num_updates=19960, lr=2.6038e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=32, gb_free=13.2, wall=131118
2024-11-10 23:10:34 - progress_bar.py[line:274] - INFO: epoch 052:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17236.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2922.9, ups=0.17, wpb=17236.6, bsz=1024, num_updates=19970, lr=2.60244e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=47, gb_free=13, wall=131177
2024-11-10 23:11:29 - progress_bar.py[line:274] - INFO: epoch 052:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=16948.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3083.1, ups=0.18, wpb=16948.6, bsz=1024, num_updates=19980, lr=2.60108e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=131232
2024-11-10 23:12:28 - progress_bar.py[line:274] - INFO: epoch 052:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17187.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=2926, ups=0.17, wpb=17187.6, bsz=1024, num_updates=19990, lr=2.59972e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=131291
2024-11-10 23:13:27 - progress_bar.py[line:274] - INFO: epoch 052:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2923.3, ups=0.17, wpb=17323.6, bsz=1024, num_updates=20000, lr=2.59836e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=131350
loss_reg: 0.005577497188748702 loss_cls: 0.0032023736275732517
loss_reg: 0.008325703786041229 loss_cls: 0.0029163500294089317
loss_reg: 0.007846577212362225 loss_cls: 0.002904007211327553
loss_reg: 0.008985988808436587 loss_cls: 0.0032405478414148092
loss_reg: 0.007612248780788864 loss_cls: 0.0034250756725668907
loss_reg: 0.009169891818473736 loss_cls: 0.003053902182728052
loss_reg: 0.0058286516556046416 loss_cls: 0.0037272043991833925
loss_reg: 0.006871078012659906 loss_cls: 0.0029656931292265654
loss_reg: 0.006695008662048989 loss_cls: 0.0031717554666101933
loss_reg: 0.00856917489507549 loss_cls: 0.0030476644169539213
loss_reg: 0.0073891108564483774 loss_cls: 0.0030454739462584257
loss_reg: 0.00804193577279872 loss_cls: 0.0034674108028411865
loss_reg: 0.006706386597535654 loss_cls: 0.003955777268856764
loss_reg: 0.006503794823891477 loss_cls: 0.003792279865592718
loss_reg: 0.005271449694123318 loss_cls: 0.003937479108572006
loss_reg: 0.005235322145313469 loss_cls: 0.0031112581491470337
loss_reg: 0.005404386613158929 loss_cls: 0.003850390203297138
loss_reg: 0.004565337340289214 loss_cls: 0.003299886826425791
loss_reg: 0.005645843809379382 loss_cls: 0.0038458507042378187
loss_reg: 0.0050212627011629735 loss_cls: 0.0034568021073937416
loss_reg: 0.004774741059328991 loss_cls: 0.004070620518177748
loss_reg: 0.005511486430895609 loss_cls: 0.0038982483092695475
loss_reg: 0.005995140079226207 loss_cls: 0.003390510566532612
loss_reg: 0.004857483040808512 loss_cls: 0.0037018032744526863
loss_reg: 0.005262832318947726 loss_cls: 0.0033728282433003187
loss_reg: 0.0069469062637722715 loss_cls: 0.004282220266759396
loss_reg: 0.004381369879798943 loss_cls: 0.0032424326054751873
loss_reg: 0.005192398846092506 loss_cls: 0.0033766659907996655
loss_reg: 0.005659919942714506 loss_cls: 0.003911169245839119
loss_reg: 0.008124062560708183 loss_cls: 0.0030333076138049364
loss_reg: 0.005796918146061774 loss_cls: 0.004278027452528477
loss_reg: 0.00581622708100449 loss_cls: 0.004276384599506855
loss_reg: 0.006035093639314864 loss_cls: 0.003783151973038912
loss_reg: 0.006487232171752344 loss_cls: 0.0031176507472991943
loss_reg: 0.006608560674440078 loss_cls: 0.0026365674566477537
loss_reg: 0.007510020392213817 loss_cls: 0.0036369934678077698
loss_reg: 0.006388229428894878 loss_cls: 0.0029746764339506626
loss_reg: 0.006516079000951452 loss_cls: 0.004336298443377018
loss_reg: 0.006337253841556329 loss_cls: 0.004003858659416437
loss_reg: 0.007259747871194808 loss_cls: 0.0034470162354409695
loss_reg: 0.006030074347664414 loss_cls: 0.002982689766213298
loss_reg: 0.006238975029591234 loss_cls: 0.003140507498756051
loss_reg: 0.008205901024169848 loss_cls: 0.0025801388546824455
loss_reg: 0.006705418077752476 loss_cls: 0.003655589185655117
loss_reg: 0.005423666553974058 loss_cls: 0.003950541839003563
loss_reg: 0.0062049538040577015 loss_cls: 0.0032412034925073385
loss_reg: 0.007869947943658242 loss_cls: 0.004397122655063868
loss_reg: 0.0061633950054925425 loss_cls: 0.003285228507593274
loss_reg: 0.0063423672068111375 loss_cls: 0.004010949283838272
loss_reg: 0.005373896968366667 loss_cls: 0.0033469591289758682
loss_reg: 0.007266972364325761 loss_cls: 0.003247623797506094
loss_reg: 0.005665974226376465 loss_cls: 0.0032703406177461147
loss_reg: 0.007417544132109188 loss_cls: 0.003011680208146572
loss_reg: 0.007637205489359994 loss_cls: 0.003104092786088586
loss_reg: 0.006462183414395192 loss_cls: 0.0034668007865548134
loss_reg: 0.007345182676334793 loss_cls: 0.004417117219418287
loss_reg: 0.009440536465539207 loss_cls: 0.0032563067506998777
loss_reg: 0.0073526674610136095 loss_cls: 0.004187495447695255
loss_reg: 0.005275891628676595 loss_cls: 0.0036251521669328213
loss_reg: 0.004218486543260957 loss_cls: 0.0032392393331974745
loss_reg: 0.005074337757238032 loss_cls: 0.0035841166973114014
loss_reg: 0.005200666974750695 loss_cls: 0.003521932056173682
loss_reg: 0.005374257918628849 loss_cls: 0.0033754860050976276
loss_reg: 0.0067860889606947495 loss_cls: 0.004026399459689856
2024-11-10 23:14:26 - progress_bar.py[line:274] - INFO: epoch 052:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17149.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2903.7, ups=0.17, wpb=17149.8, bsz=1024, num_updates=20010, lr=2.597e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=131409
2024-11-10 23:15:25 - progress_bar.py[line:274] - INFO: epoch 052:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17439.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2974.8, ups=0.17, wpb=17439.1, bsz=1024, num_updates=20020, lr=2.59564e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=131468
2024-11-10 23:16:24 - progress_bar.py[line:274] - INFO: epoch 052:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=16848.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2869.2, ups=0.17, wpb=16848.7, bsz=1024, num_updates=20030, lr=2.59428e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=131527
2024-11-10 23:17:22 - progress_bar.py[line:274] - INFO: epoch 052:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17141.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2948.9, ups=0.17, wpb=17141.9, bsz=1024, num_updates=20040, lr=2.59292e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=131585
2024-11-10 23:18:21 - progress_bar.py[line:274] - INFO: epoch 052:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17087.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=2907, ups=0.17, wpb=17087.3, bsz=1024, num_updates=20050, lr=2.59155e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=131644
2024-11-10 23:19:15 - progress_bar.py[line:274] - INFO: epoch 052:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17141.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3131.4, ups=0.18, wpb=17141.8, bsz=1024, num_updates=20060, lr=2.59019e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=13.2, wall=131698
2024-11-10 23:20:15 - progress_bar.py[line:274] - INFO: epoch 052:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17179.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2870.2, ups=0.17, wpb=17179.8, bsz=1024, num_updates=20070, lr=2.58883e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=131758
2024-11-10 23:21:11 - progress_bar.py[line:274] - INFO: epoch 052:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17163.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3088.2, ups=0.18, wpb=17163.2, bsz=1024, num_updates=20080, lr=2.58747e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=131814
2024-11-10 23:22:08 - progress_bar.py[line:274] - INFO: epoch 052:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17122.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2982.5, ups=0.17, wpb=17122.4, bsz=1024, num_updates=20090, lr=2.58611e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=131871
2024-11-10 23:23:07 - progress_bar.py[line:274] - INFO: epoch 052:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=16993.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2885.5, ups=0.17, wpb=16993.6, bsz=1024, num_updates=20100, lr=2.58475e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=131930
2024-11-10 23:24:00 - progress_bar.py[line:274] - INFO: epoch 052:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17120.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3217.3, ups=0.19, wpb=17120.8, bsz=1024, num_updates=20110, lr=2.58339e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=48, gb_free=13.3, wall=131983
2024-11-10 23:24:59 - progress_bar.py[line:274] - INFO: epoch 052:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17132.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2925.3, ups=0.17, wpb=17132.6, bsz=1024, num_updates=20120, lr=2.58203e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=132042
2024-11-10 23:25:58 - progress_bar.py[line:274] - INFO: epoch 052:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=16925.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2878, ups=0.17, wpb=16925.9, bsz=1024, num_updates=20130, lr=2.58067e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=132101
2024-11-10 23:26:55 - progress_bar.py[line:274] - INFO: epoch 052:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17216.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3026.3, ups=0.18, wpb=17216.1, bsz=1024, num_updates=20140, lr=2.57931e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=132158
2024-11-10 23:27:52 - progress_bar.py[line:274] - INFO: epoch 052:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17166.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2998.3, ups=0.17, wpb=17166.8, bsz=1024, num_updates=20150, lr=2.57795e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=132215
2024-11-10 23:28:51 - progress_bar.py[line:274] - INFO: epoch 052:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2906.2, ups=0.17, wpb=17289.7, bsz=1024, num_updates=20160, lr=2.57659e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=132274
2024-11-10 23:29:50 - progress_bar.py[line:274] - INFO: epoch 052:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17563.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2990.1, ups=0.17, wpb=17563.5, bsz=1024, num_updates=20170, lr=2.57523e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=132333
2024-11-10 23:30:47 - progress_bar.py[line:274] - INFO: epoch 052:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17426.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3052.3, ups=0.18, wpb=17426.9, bsz=1024, num_updates=20180, lr=2.57387e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=12.9, wall=132390
2024-11-10 23:31:44 - progress_bar.py[line:274] - INFO: epoch 052:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17080, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3013.4, ups=0.18, wpb=17080, bsz=1024, num_updates=20190, lr=2.57251e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=132447
2024-11-10 23:32:43 - progress_bar.py[line:274] - INFO: epoch 052:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=16855.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2876.1, ups=0.17, wpb=16855.7, bsz=1024, num_updates=20200, lr=2.57115e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=132505
2024-11-10 23:33:41 - progress_bar.py[line:274] - INFO: epoch 052:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17348.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2946.5, ups=0.17, wpb=17348.5, bsz=1024, num_updates=20210, lr=2.56979e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=132564
2024-11-10 23:34:36 - progress_bar.py[line:274] - INFO: epoch 052:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17315.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3170.5, ups=0.18, wpb=17315.3, bsz=1024, num_updates=20220, lr=2.56843e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=53, gb_free=13, wall=132619
2024-11-10 23:35:34 - progress_bar.py[line:274] - INFO: epoch 052:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17185.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2960.3, ups=0.17, wpb=17185.1, bsz=1024, num_updates=20230, lr=2.56707e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=132677
2024-11-10 23:36:33 - progress_bar.py[line:274] - INFO: epoch 052:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17168.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2927.3, ups=0.17, wpb=17168.8, bsz=1024, num_updates=20240, lr=2.56571e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=132736
2024-11-10 23:37:31 - progress_bar.py[line:274] - INFO: epoch 052:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17254.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=2937.3, ups=0.17, wpb=17254.7, bsz=1024, num_updates=20250, lr=2.56435e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=132794
2024-11-10 23:38:30 - progress_bar.py[line:274] - INFO: epoch 052:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17325, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2934.4, ups=0.17, wpb=17325, bsz=1024, num_updates=20260, lr=2.56299e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=132853
2024-11-10 23:39:29 - progress_bar.py[line:274] - INFO: epoch 052:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17189.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2953.1, ups=0.17, wpb=17189.8, bsz=1024, num_updates=20270, lr=2.56163e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=132912
2024-11-10 23:40:28 - progress_bar.py[line:274] - INFO: epoch 052:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17260.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2910.4, ups=0.17, wpb=17260.9, bsz=1024, num_updates=20280, lr=2.56027e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=12.8, wall=132971
2024-11-10 23:41:24 - progress_bar.py[line:274] - INFO: epoch 052:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17432.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3138.3, ups=0.18, wpb=17432.4, bsz=1024, num_updates=20290, lr=2.55891e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=133026
2024-11-10 23:42:23 - progress_bar.py[line:274] - INFO: epoch 052:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17339.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2940.3, ups=0.17, wpb=17339.9, bsz=1024, num_updates=20300, lr=2.55754e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=133085
2024-11-10 23:43:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 52 @ 20309 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
2024-11-10 23:43:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 23:45:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
2024-11-10 23:46:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 52 @ 20309 updates, score 0) (writing took 225.7500115769799 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-10 23:47:53 - train.py[line:336] - INFO: end of epoch 52 (average epoch stats below)
2024-11-10 23:47:53 - progress_bar.py[line:282] - INFO: epoch 052 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.709 | ntokens 17191.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.54 | wps 2488.3 | ups 0.14 | wpb 17191.4 | bsz 1023 | num_updates 20309 | lr 2.55632e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1981 | gb_free 13.4 | wall 133416
2024-11-10 23:47:53 - trainer.py[line:639] - INFO: loading train data for epoch 53
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-10 23:50:34 - trainer.py[line:703] - INFO: begin training epoch 53
2024-11-10 23:50:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 23:50:42 - progress_bar.py[line:274] - INFO: epoch 053:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=16422.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=328.6, ups=0.02, wpb=16422.4, bsz=985.6, num_updates=20310, lr=2.55618e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=133585
2024-11-10 23:51:40 - progress_bar.py[line:274] - INFO: epoch 053:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17060.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=2979.7, ups=0.17, wpb=17060.3, bsz=1024, num_updates=20320, lr=2.55482e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=133642
2024-11-10 23:52:36 - progress_bar.py[line:274] - INFO: epoch 053:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17318.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3047.5, ups=0.18, wpb=17318.1, bsz=1024, num_updates=20330, lr=2.55346e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=133699
2024-11-10 23:53:33 - progress_bar.py[line:274] - INFO: epoch 053:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17109.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3030.3, ups=0.18, wpb=17109.6, bsz=1024, num_updates=20340, lr=2.5521e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=133756
2024-11-10 23:54:31 - progress_bar.py[line:274] - INFO: epoch 053:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17202.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2979.5, ups=0.17, wpb=17202.8, bsz=1024, num_updates=20350, lr=2.55074e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=133813
2024-11-10 23:55:26 - progress_bar.py[line:274] - INFO: epoch 053:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17153.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3097.5, ups=0.18, wpb=17153.4, bsz=1024, num_updates=20360, lr=2.54938e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=133869
2024-11-10 23:56:23 - progress_bar.py[line:274] - INFO: epoch 053:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17269.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3019.3, ups=0.17, wpb=17269.8, bsz=1024, num_updates=20370, lr=2.54802e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=133926
2024-11-10 23:57:20 - progress_bar.py[line:274] - INFO: epoch 053:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=16793, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=2928.2, ups=0.17, wpb=16793, bsz=1024, num_updates=20380, lr=2.54666e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=133983
2024-11-10 23:58:17 - progress_bar.py[line:274] - INFO: epoch 053:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17279.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3049.4, ups=0.18, wpb=17279.6, bsz=1024, num_updates=20390, lr=2.5453e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=49, gb_free=13.3, wall=134040
2024-11-10 23:59:13 - progress_bar.py[line:274] - INFO: epoch 053:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=16915.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3015.9, ups=0.18, wpb=16915.1, bsz=1024, num_updates=20400, lr=2.54394e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=134096
2024-11-11 00:00:11 - progress_bar.py[line:274] - INFO: epoch 053:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=17313.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3014.5, ups=0.17, wpb=17313.3, bsz=1024, num_updates=20410, lr=2.54258e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=36, gb_free=13.1, wall=134154
2024-11-11 00:01:07 - progress_bar.py[line:274] - INFO: epoch 053:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17259.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3050.3, ups=0.18, wpb=17259.9, bsz=1024, num_updates=20420, lr=2.54122e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=134210
2024-11-11 00:02:04 - progress_bar.py[line:274] - INFO: epoch 053:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17292.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3071.1, ups=0.18, wpb=17292.2, bsz=1024, num_updates=20430, lr=2.53986e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=134266
2024-11-11 00:03:00 - progress_bar.py[line:274] - INFO: epoch 053:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17439.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3082.9, ups=0.18, wpb=17439.1, bsz=1024, num_updates=20440, lr=2.5385e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=134323
2024-11-11 00:03:34 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 00:04:02 - progress_bar.py[line:274] - INFO: epoch 053:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17097, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=2762.3, ups=0.16, wpb=17097, bsz=1024, num_updates=20450, lr=2.53714e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.1, wall=134385
2024-11-11 00:04:59 - progress_bar.py[line:274] - INFO: epoch 053:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17264.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3032.4, ups=0.18, wpb=17264.5, bsz=1024, num_updates=20460, lr=2.53578e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=134442
2024-11-11 00:05:56 - progress_bar.py[line:274] - INFO: epoch 053:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=16987.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=2966, ups=0.17, wpb=16987.1, bsz=1024, num_updates=20470, lr=2.53442e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=134499
2024-11-11 00:06:54 - progress_bar.py[line:274] - INFO: epoch 053:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17291.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3019.7, ups=0.17, wpb=17291.6, bsz=1024, num_updates=20480, lr=2.53306e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.1, wall=134556
2024-11-11 00:07:51 - progress_bar.py[line:274] - INFO: epoch 053:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17036.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2979, ups=0.17, wpb=17036.8, bsz=1024, num_updates=20490, lr=2.5317e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=134614
2024-11-11 00:08:48 - progress_bar.py[line:274] - INFO: epoch 053:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=16999.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=2967.2, ups=0.17, wpb=16999.8, bsz=1024, num_updates=20500, lr=2.53034e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=134671
2024-11-11 00:09:44 - progress_bar.py[line:274] - INFO: epoch 053:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17051.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3028.9, ups=0.18, wpb=17051.7, bsz=1024, num_updates=20510, lr=2.52898e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=44, gb_free=13.3, wall=134727
2024-11-11 00:10:40 - progress_bar.py[line:274] - INFO: epoch 053:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17111.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3053.9, ups=0.18, wpb=17111.4, bsz=1024, num_updates=20520, lr=2.52762e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=134783
2024-11-11 00:11:37 - progress_bar.py[line:274] - INFO: epoch 053:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17041.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=2996.4, ups=0.18, wpb=17041.5, bsz=1024, num_updates=20530, lr=2.52626e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=34, gb_free=13.4, wall=134840
2024-11-11 00:12:35 - progress_bar.py[line:274] - INFO: epoch 053:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17344.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3020.1, ups=0.17, wpb=17344.6, bsz=1024, num_updates=20540, lr=2.5249e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=49, gb_free=13.3, wall=134898
2024-11-11 00:13:33 - progress_bar.py[line:274] - INFO: epoch 053:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17189.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2950.1, ups=0.17, wpb=17189.7, bsz=1024, num_updates=20550, lr=2.52353e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=134956
2024-11-11 00:14:30 - progress_bar.py[line:274] - INFO: epoch 053:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17056, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2975.8, ups=0.17, wpb=17056, bsz=1024, num_updates=20560, lr=2.52217e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=135013
2024-11-11 00:15:28 - progress_bar.py[line:274] - INFO: epoch 053:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17140.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2954.6, ups=0.17, wpb=17140.7, bsz=1024, num_updates=20570, lr=2.52081e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=135071
2024-11-11 00:16:22 - progress_bar.py[line:274] - INFO: epoch 053:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=16955.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3140.3, ups=0.19, wpb=16955.5, bsz=1024, num_updates=20580, lr=2.51945e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=135125
2024-11-11 00:17:21 - progress_bar.py[line:274] - INFO: epoch 053:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17271.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2955.2, ups=0.17, wpb=17271.3, bsz=1024, num_updates=20590, lr=2.51809e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=135184
2024-11-11 00:18:19 - progress_bar.py[line:274] - INFO: epoch 053:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17278.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2965.8, ups=0.17, wpb=17278.5, bsz=1024, num_updates=20600, lr=2.51673e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=135242
2024-11-11 00:19:18 - progress_bar.py[line:274] - INFO: epoch 053:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17237.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2938.9, ups=0.17, wpb=17237.6, bsz=1024, num_updates=20610, lr=2.51537e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13, wall=135300
2024-11-11 00:20:15 - progress_bar.py[line:274] - INFO: epoch 053:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17277.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2984.2, ups=0.17, wpb=17277.8, bsz=1024, num_updates=20620, lr=2.51401e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=135358
2024-11-11 00:21:13 - progress_bar.py[line:274] - INFO: epoch 053:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17024.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2935.7, ups=0.17, wpb=17024.7, bsz=1024, num_updates=20630, lr=2.51265e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=135416
2024-11-11 00:22:12 - progress_bar.py[line:274] - INFO: epoch 053:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17169.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2947.9, ups=0.17, wpb=17169.6, bsz=1024, num_updates=20640, lr=2.51129e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13, wall=135475
2024-11-11 00:23:09 - progress_bar.py[line:274] - INFO: epoch 053:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17205.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3005.8, ups=0.17, wpb=17205.6, bsz=1024, num_updates=20650, lr=2.50993e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=135532
2024-11-11 00:24:06 - progress_bar.py[line:274] - INFO: epoch 053:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17227.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3038.5, ups=0.18, wpb=17227.2, bsz=1024, num_updates=20660, lr=2.50857e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=135589
2024-11-11 00:25:04 - progress_bar.py[line:274] - INFO: epoch 053:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17329, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2955.8, ups=0.17, wpb=17329, bsz=1024, num_updates=20670, lr=2.50721e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=12.6, wall=135647
2024-11-11 00:26:02 - progress_bar.py[line:274] - INFO: epoch 053:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17335.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3014, ups=0.17, wpb=17335.5, bsz=1024, num_updates=20680, lr=2.50585e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=135705
2024-11-11 00:27:00 - progress_bar.py[line:274] - INFO: epoch 053:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17063.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2938.6, ups=0.17, wpb=17063.4, bsz=1024, num_updates=20690, lr=2.50449e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=135763
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt2024-11-11 00:27:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 53 @ 20699 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
2024-11-11 00:27:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 00:29:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-11 00:31:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 53 @ 20699 updates, score 0) (writing took 225.9711806580308 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-11 00:32:30 - train.py[line:336] - INFO: end of epoch 53 (average epoch stats below)
2024-11-11 00:32:30 - progress_bar.py[line:282] - INFO: epoch 053 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.7 | ntokens 17150.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.5 | wps 2498.5 | ups 0.15 | wpb 17150.2 | bsz 1023 | num_updates 20699 | lr 2.50326e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1697 | gb_free 13.4 | wall 136093
2024-11-11 00:32:30 - trainer.py[line:639] - INFO: loading train data for epoch 54
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 00:35:11 - trainer.py[line:703] - INFO: begin training epoch 54
2024-11-11 00:35:11 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 00:35:19 - progress_bar.py[line:274] - INFO: epoch 054:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=16532, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=331.4, ups=0.02, wpb=16532, bsz=985.6, num_updates=20700, lr=2.50313e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.4, wall=136262
2024-11-11 00:36:16 - progress_bar.py[line:274] - INFO: epoch 054:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17387.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3051.2, ups=0.18, wpb=17387.6, bsz=1024, num_updates=20710, lr=2.50177e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=136319
2024-11-11 00:37:13 - progress_bar.py[line:274] - INFO: epoch 054:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17217.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2977.8, ups=0.17, wpb=17217.7, bsz=1024, num_updates=20720, lr=2.50041e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=136376
2024-11-11 00:38:11 - progress_bar.py[line:274] - INFO: epoch 054:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17178, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2990.8, ups=0.17, wpb=17178, bsz=1024, num_updates=20730, lr=2.49905e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=136434
2024-11-11 00:39:10 - progress_bar.py[line:274] - INFO: epoch 054:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17189.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2916.9, ups=0.17, wpb=17189.6, bsz=1024, num_updates=20740, lr=2.49769e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=41, gb_free=13.4, wall=136493
2024-11-11 00:40:08 - progress_bar.py[line:274] - INFO: epoch 054:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17202, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2961.2, ups=0.17, wpb=17202, bsz=1024, num_updates=20750, lr=2.49633e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=136551
2024-11-11 00:41:05 - progress_bar.py[line:274] - INFO: epoch 054:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17212.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3002.7, ups=0.17, wpb=17212.3, bsz=1024, num_updates=20760, lr=2.49497e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=136608
2024-11-11 00:42:02 - progress_bar.py[line:274] - INFO: epoch 054:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17150.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3047.2, ups=0.18, wpb=17150.9, bsz=1024, num_updates=20770, lr=2.49361e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=136664
2024-11-11 00:43:00 - progress_bar.py[line:274] - INFO: epoch 054:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17559.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3003, ups=0.17, wpb=17559.7, bsz=1024, num_updates=20780, lr=2.49225e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=136723
2024-11-11 00:43:58 - progress_bar.py[line:274] - INFO: epoch 054:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17238, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2980.4, ups=0.17, wpb=17238, bsz=1024, num_updates=20790, lr=2.49089e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=136781
2024-11-11 00:44:57 - progress_bar.py[line:274] - INFO: epoch 054:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17452, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2944.6, ups=0.17, wpb=17452, bsz=1024, num_updates=20800, lr=2.48952e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=136840
2024-11-11 00:45:56 - progress_bar.py[line:274] - INFO: epoch 054:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17152, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=2899.7, ups=0.17, wpb=17152, bsz=1024, num_updates=20810, lr=2.48816e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.1, wall=136899
2024-11-11 00:46:54 - progress_bar.py[line:274] - INFO: epoch 054:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17372.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=2984.2, ups=0.17, wpb=17372.2, bsz=1024, num_updates=20820, lr=2.4868e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=136957
2024-11-11 00:47:52 - progress_bar.py[line:274] - INFO: epoch 054:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17220, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2984.2, ups=0.17, wpb=17220, bsz=1024, num_updates=20830, lr=2.48544e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=137015
2024-11-11 00:48:50 - progress_bar.py[line:274] - INFO: epoch 054:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17105.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2979.2, ups=0.17, wpb=17105.6, bsz=1024, num_updates=20840, lr=2.48408e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=137073
2024-11-11 00:49:49 - progress_bar.py[line:274] - INFO: epoch 054:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17199.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2910.7, ups=0.17, wpb=17199.9, bsz=1024, num_updates=20850, lr=2.48272e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=137132
2024-11-11 00:50:48 - progress_bar.py[line:274] - INFO: epoch 054:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17265.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2916.7, ups=0.17, wpb=17265.1, bsz=1024, num_updates=20860, lr=2.48136e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=137191
2024-11-11 00:51:47 - progress_bar.py[line:274] - INFO: epoch 054:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17280.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2939, ups=0.17, wpb=17280.8, bsz=1024, num_updates=20870, lr=2.48e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=137250
2024-11-11 00:52:46 - progress_bar.py[line:274] - INFO: epoch 054:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17340.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2939, ups=0.17, wpb=17340.1, bsz=1024, num_updates=20880, lr=2.47864e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=59, gb_free=12.9, wall=137309
2024-11-11 00:53:45 - progress_bar.py[line:274] - INFO: epoch 054:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=16921.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=2857, ups=0.17, wpb=16921.1, bsz=1024, num_updates=20890, lr=2.47728e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=12.9, wall=137368
2024-11-11 00:54:40 - progress_bar.py[line:274] - INFO: epoch 054:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17213.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3135.4, ups=0.18, wpb=17213.2, bsz=1024, num_updates=20900, lr=2.47592e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=137423
2024-11-11 00:55:36 - progress_bar.py[line:274] - INFO: epoch 054:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17041.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3021.3, ups=0.18, wpb=17041.8, bsz=1024, num_updates=20910, lr=2.47456e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=41, gb_free=13, wall=137479
2024-11-11 00:56:35 - progress_bar.py[line:274] - INFO: epoch 054:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17139.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2919.2, ups=0.17, wpb=17139.9, bsz=1024, num_updates=20920, lr=2.4732e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.2, wall=137538
2024-11-11 00:57:34 - progress_bar.py[line:274] - INFO: epoch 054:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17302.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=2927, ups=0.17, wpb=17302.8, bsz=1024, num_updates=20930, lr=2.47184e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=137597
2024-11-11 00:58:33 - progress_bar.py[line:274] - INFO: epoch 054:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17204.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2925.9, ups=0.17, wpb=17204.7, bsz=1024, num_updates=20940, lr=2.47048e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=137656
2024-11-11 00:59:31 - progress_bar.py[line:274] - INFO: epoch 054:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17076.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2933.1, ups=0.17, wpb=17076.9, bsz=1024, num_updates=20950, lr=2.46912e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=137714
2024-11-11 01:00:30 - progress_bar.py[line:274] - INFO: epoch 054:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17103.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2928, ups=0.17, wpb=17103.6, bsz=1024, num_updates=20960, lr=2.46776e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=58, gb_free=13.1, wall=137772
2024-11-11 01:01:28 - progress_bar.py[line:274] - INFO: epoch 054:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17312.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2946.6, ups=0.17, wpb=17312.8, bsz=1024, num_updates=20970, lr=2.4664e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=59, gb_free=12.9, wall=137831
2024-11-11 01:02:27 - progress_bar.py[line:274] - INFO: epoch 054:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17046.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=2902.7, ups=0.17, wpb=17046.8, bsz=1024, num_updates=20980, lr=2.46504e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=59, gb_free=13.2, wall=137890
2024-11-11 01:03:26 - progress_bar.py[line:274] - INFO: epoch 054:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17182.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2898.3, ups=0.17, wpb=17182.4, bsz=1024, num_updates=20990, lr=2.46368e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=59, gb_free=13.5, wall=137949
2024-11-11 01:04:24 - progress_bar.py[line:274] - INFO: epoch 054:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17171.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2954.1, ups=0.17, wpb=17171.4, bsz=1024, num_updates=21000, lr=2.46232e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=138007
2024-11-11 01:05:23 - progress_bar.py[line:274] - INFO: epoch 054:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17081, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2917.1, ups=0.17, wpb=17081, bsz=1024, num_updates=21010, lr=2.46096e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=138066
2024-11-11 01:06:22 - progress_bar.py[line:274] - INFO: epoch 054:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17262.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2904, ups=0.17, wpb=17262.7, bsz=1024, num_updates=21020, lr=2.4596e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=59, gb_free=13.4, wall=138125
2024-11-11 01:07:22 - progress_bar.py[line:274] - INFO: epoch 054:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17279, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2890, ups=0.17, wpb=17279, bsz=1024, num_updates=21030, lr=2.45824e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=60, gb_free=13.5, wall=138185
2024-11-11 01:08:22 - progress_bar.py[line:274] - INFO: epoch 054:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17442.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2938.1, ups=0.17, wpb=17442.6, bsz=1024, num_updates=21040, lr=2.45688e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=138244
2024-11-11 01:09:18 - progress_bar.py[line:274] - INFO: epoch 054:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17326.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3059.2, ups=0.18, wpb=17326.6, bsz=1024, num_updates=21050, lr=2.45552e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=138301
2024-11-11 01:10:15 - progress_bar.py[line:274] - INFO: epoch 054:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17144.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3037.8, ups=0.18, wpb=17144.8, bsz=1024, num_updates=21060, lr=2.45415e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=138358
2024-11-11 01:11:13 - progress_bar.py[line:274] - INFO: epoch 054:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17231.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2935.6, ups=0.17, wpb=17231.7, bsz=1024, num_updates=21070, lr=2.45279e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=138416
2024-11-11 01:12:09 - progress_bar.py[line:274] - INFO: epoch 054:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17164, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3076.6, ups=0.18, wpb=17164, bsz=1024, num_updates=21080, lr=2.45143e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13, wall=138472
2024-11-11 01:13:03 - progress_bar.py[line:274] - INFO: epoch 054:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=16555.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3083.5, ups=0.19, wpb=16555.7, bsz=985.6, num_updates=21090, lr=2.45007e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=138526
2024-11-11 01:13:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 54 @ 21090 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
2024-11-11 01:13:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt': File exists: File exists
: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 01:14:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-11 01:16:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 54 @ 21090 updates, score 0) (writing took 220.0308630769723 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 01:17:39 - train.py[line:336] - INFO: end of epoch 54 (average epoch stats below)
2024-11-11 01:17:39 - progress_bar.py[line:282] - INFO: epoch 054 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.697 | ntokens 17204 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.49 | wps 2483.2 | ups 0.14 | wpb 17204 | bsz 1023 | num_updates 21090 | lr 2.45007e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 2136 | gb_free 13.4 | wall 138802
2024-11-11 01:17:39 - trainer.py[line:639] - INFO: loading train data for epoch 55
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 01:20:20 - trainer.py[line:703] - INFO: begin training epoch 55
2024-11-11 01:20:20 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 01:21:20 - progress_bar.py[line:274] - INFO: epoch 055:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17055.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=343.1, ups=0.02, wpb=17055.4, bsz=1024, num_updates=21100, lr=2.44871e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=139023
2024-11-11 01:21:54 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 01:22:23 - progress_bar.py[line:274] - INFO: epoch 055:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=16993, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2708.3, ups=0.16, wpb=16993, bsz=1024, num_updates=21110, lr=2.44735e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=139086
2024-11-11 01:23:21 - progress_bar.py[line:274] - INFO: epoch 055:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17295.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=2951.4, ups=0.17, wpb=17295.5, bsz=1024, num_updates=21120, lr=2.44599e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=139144
2024-11-11 01:24:18 - progress_bar.py[line:274] - INFO: epoch 055:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17176.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3038.1, ups=0.18, wpb=17176.1, bsz=1024, num_updates=21130, lr=2.44463e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=139201
2024-11-11 01:25:15 - progress_bar.py[line:274] - INFO: epoch 055:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17243.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3025.1, ups=0.18, wpb=17243.6, bsz=1024, num_updates=21140, lr=2.44327e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=139258
2024-11-11 01:26:12 - progress_bar.py[line:274] - INFO: epoch 055:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17188, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3016.1, ups=0.18, wpb=17188, bsz=1024, num_updates=21150, lr=2.44191e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=139315
2024-11-11 01:27:10 - progress_bar.py[line:274] - INFO: epoch 055:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17100.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2934.2, ups=0.17, wpb=17100.5, bsz=1024, num_updates=21160, lr=2.44055e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=139373
2024-11-11 01:28:10 - progress_bar.py[line:274] - INFO: epoch 055:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17286.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2898.5, ups=0.17, wpb=17286.8, bsz=1024, num_updates=21170, lr=2.43919e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=48, gb_free=13.1, wall=139433
2024-11-11 01:29:06 - progress_bar.py[line:274] - INFO: epoch 055:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17127.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3070.6, ups=0.18, wpb=17127.7, bsz=1024, num_updates=21180, lr=2.43783e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=139488
2024-11-11 01:30:04 - progress_bar.py[line:274] - INFO: epoch 055:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17347.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=2967.8, ups=0.17, wpb=17347.1, bsz=1024, num_updates=21190, lr=2.43647e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=50, gb_free=13.2, wall=139547
2024-11-11 01:30:59 - progress_bar.py[line:274] - INFO: epoch 055:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17133.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3136.9, ups=0.18, wpb=17133.7, bsz=1024, num_updates=21200, lr=2.43511e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=47, gb_free=13.1, wall=139602
2024-11-11 01:31:57 - progress_bar.py[line:274] - INFO: epoch 055:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17187.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2961.1, ups=0.17, wpb=17187.2, bsz=1024, num_updates=21210, lr=2.43375e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=139660
2024-11-11 01:32:55 - progress_bar.py[line:274] - INFO: epoch 055:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17382.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2967.6, ups=0.17, wpb=17382.8, bsz=1024, num_updates=21220, lr=2.43239e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=139718
2024-11-11 01:33:54 - progress_bar.py[line:274] - INFO: epoch 055:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=16978, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=2904.6, ups=0.17, wpb=16978, bsz=1024, num_updates=21230, lr=2.43103e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=139777
2024-11-11 01:34:52 - progress_bar.py[line:274] - INFO: epoch 055:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17105.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=2924.5, ups=0.17, wpb=17105.5, bsz=1024, num_updates=21240, lr=2.42967e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=139835
2024-11-11 01:35:51 - progress_bar.py[line:274] - INFO: epoch 055:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17319.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2956.4, ups=0.17, wpb=17319.2, bsz=1024, num_updates=21250, lr=2.42831e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=139894
2024-11-11 01:36:49 - progress_bar.py[line:274] - INFO: epoch 055:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17257.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2962.9, ups=0.17, wpb=17257.7, bsz=1024, num_updates=21260, lr=2.42695e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=139952
2024-11-11 01:37:47 - progress_bar.py[line:274] - INFO: epoch 055:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17364.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2976, ups=0.17, wpb=17364.8, bsz=1024, num_updates=21270, lr=2.42559e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=140010
2024-11-11 01:38:43 - progress_bar.py[line:274] - INFO: epoch 055:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17193.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3069.1, ups=0.18, wpb=17193.4, bsz=1024, num_updates=21280, lr=2.42423e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.1, wall=140066
2024-11-11 01:39:40 - progress_bar.py[line:274] - INFO: epoch 055:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17441.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3092.6, ups=0.18, wpb=17441.2, bsz=1024, num_updates=21290, lr=2.42287e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=46, gb_free=13.2, wall=140123
2024-11-11 01:40:36 - progress_bar.py[line:274] - INFO: epoch 055:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=16951.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3015.4, ups=0.18, wpb=16951.8, bsz=1024, num_updates=21300, lr=2.42151e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=38, gb_free=13.2, wall=140179
2024-11-11 01:41:35 - progress_bar.py[line:274] - INFO: epoch 055:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17118.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=2920.7, ups=0.17, wpb=17118.5, bsz=1024, num_updates=21310, lr=2.42014e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=48, gb_free=13.3, wall=140238
2024-11-11 01:42:30 - progress_bar.py[line:274] - INFO: epoch 055:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17453.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3128.2, ups=0.18, wpb=17453.4, bsz=1024, num_updates=21320, lr=2.41878e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=140293
2024-11-11 01:43:29 - progress_bar.py[line:274] - INFO: epoch 055:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17011.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2912.2, ups=0.17, wpb=17011.6, bsz=1024, num_updates=21330, lr=2.41742e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=52, gb_free=13.3, wall=140352
2024-11-11 01:44:28 - progress_bar.py[line:274] - INFO: epoch 055:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17353.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=2944.6, ups=0.17, wpb=17353.9, bsz=1024, num_updates=21340, lr=2.41606e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=140411
2024-11-11 01:45:25 - progress_bar.py[line:274] - INFO: epoch 055:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=16949, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2964.5, ups=0.17, wpb=16949, bsz=1024, num_updates=21350, lr=2.4147e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=140468
2024-11-11 01:46:24 - progress_bar.py[line:274] - INFO: epoch 055:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17204.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2911.3, ups=0.17, wpb=17204.5, bsz=1024, num_updates=21360, lr=2.41334e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13, wall=140527
2024-11-11 01:47:22 - progress_bar.py[line:274] - INFO: epoch 055:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17343.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2978.1, ups=0.17, wpb=17343.6, bsz=1024, num_updates=21370, lr=2.41198e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=140585
2024-11-11 01:48:20 - progress_bar.py[line:274] - INFO: epoch 055:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17197.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2968.5, ups=0.17, wpb=17197.4, bsz=1024, num_updates=21380, lr=2.41062e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=140643
2024-11-11 01:49:19 - progress_bar.py[line:274] - INFO: epoch 055:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17146.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=2915.6, ups=0.17, wpb=17146.8, bsz=1024, num_updates=21390, lr=2.40926e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=140702
2024-11-11 01:50:16 - progress_bar.py[line:274] - INFO: epoch 055:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17144.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2985.1, ups=0.17, wpb=17144.8, bsz=1024, num_updates=21400, lr=2.4079e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=140759
2024-11-11 01:51:15 - progress_bar.py[line:274] - INFO: epoch 055:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17090.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2933.3, ups=0.17, wpb=17090.7, bsz=1024, num_updates=21410, lr=2.40654e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=140818
2024-11-11 01:52:13 - progress_bar.py[line:274] - INFO: epoch 055:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17331.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2948.6, ups=0.17, wpb=17331.8, bsz=1024, num_updates=21420, lr=2.40518e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=140876
2024-11-11 01:53:12 - progress_bar.py[line:274] - INFO: epoch 055:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17232.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2946.9, ups=0.17, wpb=17232.9, bsz=1024, num_updates=21430, lr=2.40382e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=140935
2024-11-11 01:54:11 - progress_bar.py[line:274] - INFO: epoch 055:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17185.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2889.5, ups=0.17, wpb=17185.3, bsz=1024, num_updates=21440, lr=2.40246e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=140994
2024-11-11 01:55:07 - progress_bar.py[line:274] - INFO: epoch 055:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17277.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3123.5, ups=0.18, wpb=17277.2, bsz=1024, num_updates=21450, lr=2.4011e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=141050
2024-11-11 01:56:06 - progress_bar.py[line:274] - INFO: epoch 055:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17293.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2935.1, ups=0.17, wpb=17293.7, bsz=1024, num_updates=21460, lr=2.39974e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=141109
2024-11-11 01:57:05 - progress_bar.py[line:274] - INFO: epoch 055:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17598.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2949.7, ups=0.17, wpb=17598.5, bsz=1024, num_updates=21470, lr=2.39838e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=60, gb_free=12.9, wall=141168
2024-11-11 01:57:56 - progress_bar.py[line:274] - INFO: epoch 055:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=16710.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3291.2, ups=0.2, wpb=16710.8, bsz=985.6, num_updates=21480, lr=2.39702e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=141219
2024-11-11 01:57:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 55 @ 21480 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
2024-11-11 01:57:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 01:59:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 02:01:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 55 @ 21480 updates, score 0) (writing took 227.271786141966 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
2024-11-11 02:02:39 - train.py[line:336] - INFO: end of epoch 55 (average epoch stats below)
2024-11-11 02:02:39 - progress_bar.py[line:282] - INFO: epoch 055 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.69 | ntokens 17199.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.45 | wps 2484.2 | ups 0.14 | wpb 17199.3 | bsz 1023 | num_updates 21480 | lr 2.39702e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 1946 | gb_free 13.3 | wall 141502
2024-11-11 02:02:39 - trainer.py[line:639] - INFO: loading train data for epoch 56
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 02:05:20 - trainer.py[line:703] - INFO: begin training epoch 56
2024-11-11 02:05:20 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 02:06:19 - progress_bar.py[line:274] - INFO: epoch 056:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17319.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=344.2, ups=0.02, wpb=17319.7, bsz=1024, num_updates=21490, lr=2.39566e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=141722
2024-11-11 02:07:17 - progress_bar.py[line:274] - INFO: epoch 056:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17139.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2989.1, ups=0.17, wpb=17139.8, bsz=1024, num_updates=21500, lr=2.3943e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=141780
2024-11-11 02:08:14 - progress_bar.py[line:274] - INFO: epoch 056:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17157, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3016.4, ups=0.18, wpb=17157, bsz=1024, num_updates=21510, lr=2.39294e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=141836
2024-11-11 02:09:11 - progress_bar.py[line:274] - INFO: epoch 056:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.68, ntokens=17174.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=2986.2, ups=0.17, wpb=17174.3, bsz=1024, num_updates=21520, lr=2.39158e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=141894
2024-11-11 02:10:10 - progress_bar.py[line:274] - INFO: epoch 056:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17230.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=2910.7, ups=0.17, wpb=17230.5, bsz=1024, num_updates=21530, lr=2.39022e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=45, gb_free=13.3, wall=141953
2024-11-11 02:11:09 - progress_bar.py[line:274] - INFO: epoch 056:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17017.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=2890.6, ups=0.17, wpb=17017.8, bsz=1024, num_updates=21540, lr=2.38886e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=142012
2024-11-11 02:12:07 - progress_bar.py[line:274] - INFO: epoch 056:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=16921, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2911.1, ups=0.17, wpb=16921, bsz=1024, num_updates=21550, lr=2.3875e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=142070
2024-11-11 02:13:06 - progress_bar.py[line:274] - INFO: epoch 056:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17330, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=2969.3, ups=0.17, wpb=17330, bsz=1024, num_updates=21560, lr=2.38613e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=142129
2024-11-11 02:14:04 - progress_bar.py[line:274] - INFO: epoch 056:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.702, ntokens=17384.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2953.5, ups=0.17, wpb=17384.3, bsz=1024, num_updates=21570, lr=2.38477e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=142187
2024-11-11 02:15:03 - progress_bar.py[line:274] - INFO: epoch 056:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17222.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2929.1, ups=0.17, wpb=17222.4, bsz=1024, num_updates=21580, lr=2.38341e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=142246
2024-11-11 02:16:01 - progress_bar.py[line:274] - INFO: epoch 056:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=16961.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2913.6, ups=0.17, wpb=16961.5, bsz=1024, num_updates=21590, lr=2.38205e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=142304
2024-11-11 02:17:00 - progress_bar.py[line:274] - INFO: epoch 056:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17136.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=2923.1, ups=0.17, wpb=17136.8, bsz=1024, num_updates=21600, lr=2.38069e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=142363
2024-11-11 02:17:59 - progress_bar.py[line:274] - INFO: epoch 056:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17093.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2913.9, ups=0.17, wpb=17093.7, bsz=1024, num_updates=21610, lr=2.37933e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=142422
2024-11-11 02:18:58 - progress_bar.py[line:274] - INFO: epoch 056:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17087.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2894.8, ups=0.17, wpb=17087.5, bsz=1024, num_updates=21620, lr=2.37797e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.2, wall=142481
2024-11-11 02:19:57 - progress_bar.py[line:274] - INFO: epoch 056:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=16869.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2868.6, ups=0.17, wpb=16869.3, bsz=1024, num_updates=21630, lr=2.37661e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=142540
2024-11-11 02:20:56 - progress_bar.py[line:274] - INFO: epoch 056:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17149.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=2906.5, ups=0.17, wpb=17149.3, bsz=1024, num_updates=21640, lr=2.37525e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=142599
2024-11-11 02:21:55 - progress_bar.py[line:274] - INFO: epoch 056:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17032.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2890.5, ups=0.17, wpb=17032.8, bsz=1024, num_updates=21650, lr=2.37389e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=59, gb_free=13.4, wall=142657
2024-11-11 02:22:51 - progress_bar.py[line:274] - INFO: epoch 056:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17229.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3078.1, ups=0.18, wpb=17229.1, bsz=1024, num_updates=21660, lr=2.37253e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=12.9, wall=142713
2024-11-11 02:23:49 - progress_bar.py[line:274] - INFO: epoch 056:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=16919.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=2874.6, ups=0.17, wpb=16919.8, bsz=1024, num_updates=21670, lr=2.37117e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=59, gb_free=13.2, wall=142772
2024-11-11 02:24:49 - progress_bar.py[line:274] - INFO: epoch 056:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17240.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=2906.5, ups=0.17, wpb=17240.4, bsz=1024, num_updates=21680, lr=2.36981e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=142832
2024-11-11 02:25:48 - progress_bar.py[line:274] - INFO: epoch 056:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=16950.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=2843.2, ups=0.17, wpb=16950.5, bsz=1024, num_updates=21690, lr=2.36845e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=60, gb_free=13.3, wall=142891
2024-11-11 02:26:48 - progress_bar.py[line:274] - INFO: epoch 056:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17196.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=2872.8, ups=0.17, wpb=17196.8, bsz=1024, num_updates=21700, lr=2.36709e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=60, gb_free=13.3, wall=142951
2024-11-11 02:27:43 - progress_bar.py[line:274] - INFO: epoch 056:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17271, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3135.7, ups=0.18, wpb=17271, bsz=1024, num_updates=21710, lr=2.36573e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=49, gb_free=13.3, wall=143006
2024-11-11 02:28:42 - progress_bar.py[line:274] - INFO: epoch 056:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17036.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2917.7, ups=0.17, wpb=17036.5, bsz=1024, num_updates=21720, lr=2.36437e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=143065
2024-11-11 02:29:05 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 02:29:46 - progress_bar.py[line:274] - INFO: epoch 056:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17186.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2668.6, ups=0.16, wpb=17186.3, bsz=1024, num_updates=21730, lr=2.36301e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=64, gb_free=13.5, wall=143129
2024-11-11 02:30:45 - progress_bar.py[line:274] - INFO: epoch 056:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17292.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2933.4, ups=0.17, wpb=17292.4, bsz=1024, num_updates=21740, lr=2.36165e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.2, wall=143188
2024-11-11 02:31:44 - progress_bar.py[line:274] - INFO: epoch 056:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17163.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=2914, ups=0.17, wpb=17163.5, bsz=1024, num_updates=21750, lr=2.36029e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=143247
2024-11-11 02:32:44 - progress_bar.py[line:274] - INFO: epoch 056:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17259.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2890.8, ups=0.17, wpb=17259.5, bsz=1024, num_updates=21760, lr=2.35893e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=60, gb_free=13.4, wall=143306
2024-11-11 02:33:38 - progress_bar.py[line:274] - INFO: epoch 056:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17084.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3112.4, ups=0.18, wpb=17084.2, bsz=1024, num_updates=21770, lr=2.35757e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=143361
2024-11-11 02:34:37 - progress_bar.py[line:274] - INFO: epoch 056:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17168.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=2937.4, ups=0.17, wpb=17168.7, bsz=1024, num_updates=21780, lr=2.35621e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=143420
2024-11-11 02:35:36 - progress_bar.py[line:274] - INFO: epoch 056:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17175.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=2922, ups=0.17, wpb=17175.4, bsz=1024, num_updates=21790, lr=2.35485e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=12.9, wall=143479
2024-11-11 02:36:36 - progress_bar.py[line:274] - INFO: epoch 056:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17328.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2878.9, ups=0.17, wpb=17328.2, bsz=1024, num_updates=21800, lr=2.35349e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=60, gb_free=13.1, wall=143539
2024-11-11 02:37:38 - progress_bar.py[line:274] - INFO: epoch 056:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17115.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=2773.8, ups=0.16, wpb=17115.5, bsz=1024, num_updates=21810, lr=2.35212e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=62, gb_free=13.5, wall=143601
2024-11-11 02:38:35 - progress_bar.py[line:274] - INFO: epoch 056:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17116.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2958.8, ups=0.17, wpb=17116.5, bsz=1024, num_updates=21820, lr=2.35076e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=143658
2024-11-11 02:39:37 - progress_bar.py[line:274] - INFO: epoch 056:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=16992, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2770.7, ups=0.16, wpb=16992, bsz=1024, num_updates=21830, lr=2.3494e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=61, gb_free=13.3, wall=143720
2024-11-11 02:40:38 - progress_bar.py[line:274] - INFO: epoch 056:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17272.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2814.6, ups=0.16, wpb=17272.7, bsz=1024, num_updates=21840, lr=2.34804e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=61, gb_free=13.4, wall=143781
2024-11-11 02:41:38 - progress_bar.py[line:274] - INFO: epoch 056:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17354.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=2883.1, ups=0.17, wpb=17354.6, bsz=1024, num_updates=21850, lr=2.34668e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=60, gb_free=13.2, wall=143841
2024-11-11 02:42:38 - progress_bar.py[line:274] - INFO: epoch 056:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17486.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2937.9, ups=0.17, wpb=17486.6, bsz=1024, num_updates=21860, lr=2.34532e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=59, gb_free=13.5, wall=143901
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
2024-11-11 02:43:36 - progress_bar.py[line:274] - INFO: epoch 056:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=16697.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2870.7, ups=0.17, wpb=16697.1, bsz=985.6, num_updates=21870, lr=2.34396e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=143959
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
2024-11-11 02:43:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 56 @ 21870 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
2024-11-11 02:43:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 02:45:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 02:47:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 56 @ 21870 updates, score 0) (writing took 226.61905502801528 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
2024-11-11 02:48:17 - train.py[line:336] - INFO: end of epoch 56 (average epoch stats below)
2024-11-11 02:48:17 - progress_bar.py[line:282] - INFO: epoch 056 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.681 | ntokens 17147.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.41 | wps 2441.9 | ups 0.14 | wpb 17147.8 | bsz 1023 | num_updates 21870 | lr 2.34396e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 2158 | gb_free 13.2 | wall 144240
2024-11-11 02:48:17 - trainer.py[line:639] - INFO: loading train data for epoch 57
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 02:51:01 - trainer.py[line:703] - INFO: begin training epoch 57
2024-11-11 02:51:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 02:51:57 - progress_bar.py[line:274] - INFO: epoch 057:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17374.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=346.5, ups=0.02, wpb=17374.7, bsz=1024, num_updates=21880, lr=2.3426e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=144460
2024-11-11 02:52:51 - progress_bar.py[line:274] - INFO: epoch 057:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17128.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3176.4, ups=0.19, wpb=17128.6, bsz=1024, num_updates=21890, lr=2.34124e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144514
2024-11-11 02:53:45 - progress_bar.py[line:274] - INFO: epoch 057:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17108.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3176, ups=0.19, wpb=17108.3, bsz=1024, num_updates=21900, lr=2.33988e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=144568
2024-11-11 02:54:39 - progress_bar.py[line:274] - INFO: epoch 057:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17237.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3203, ups=0.19, wpb=17237.7, bsz=1024, num_updates=21910, lr=2.33852e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144622
2024-11-11 02:55:33 - progress_bar.py[line:274] - INFO: epoch 057:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17175.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3207.3, ups=0.19, wpb=17175.1, bsz=1024, num_updates=21920, lr=2.33716e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144676
2024-11-11 02:56:27 - progress_bar.py[line:274] - INFO: epoch 057:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17252.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3182.2, ups=0.18, wpb=17252.8, bsz=1024, num_updates=21930, lr=2.3358e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144730
2024-11-11 02:57:21 - progress_bar.py[line:274] - INFO: epoch 057:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17044.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3174.2, ups=0.19, wpb=17044.2, bsz=1024, num_updates=21940, lr=2.33444e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=144783
2024-11-11 02:58:14 - progress_bar.py[line:274] - INFO: epoch 057:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=16980.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3159.4, ups=0.19, wpb=16980.7, bsz=1024, num_updates=21950, lr=2.33308e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144837
2024-11-11 02:59:09 - progress_bar.py[line:274] - INFO: epoch 057:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17413.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3211, ups=0.18, wpb=17413.6, bsz=1024, num_updates=21960, lr=2.33172e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144891
2024-11-11 03:00:03 - progress_bar.py[line:274] - INFO: epoch 057:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17278, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3202, ups=0.19, wpb=17278, bsz=1024, num_updates=21970, lr=2.33036e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=144945
2024-11-11 03:00:56 - progress_bar.py[line:274] - INFO: epoch 057:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17258.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3212.1, ups=0.19, wpb=17258.4, bsz=1024, num_updates=21980, lr=2.329e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=144999
2024-11-11 03:01:50 - progress_bar.py[line:274] - INFO: epoch 057:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17285.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3202.9, ups=0.19, wpb=17285.5, bsz=1024, num_updates=21990, lr=2.32764e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=145053
2024-11-11 03:02:45 - progress_bar.py[line:274] - INFO: epoch 057:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17193.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3147.3, ups=0.18, wpb=17193.6, bsz=1024, num_updates=22000, lr=2.32628e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=145108
2024-11-11 03:03:39 - progress_bar.py[line:274] - INFO: epoch 057:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17134.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3185.7, ups=0.19, wpb=17134.8, bsz=1024, num_updates=22010, lr=2.32492e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=145162
2024-11-11 03:04:32 - progress_bar.py[line:274] - INFO: epoch 057:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17098.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3200.4, ups=0.19, wpb=17098.9, bsz=1024, num_updates=22020, lr=2.32356e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=145215
2024-11-11 03:05:27 - progress_bar.py[line:274] - INFO: epoch 057:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17338.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3183.3, ups=0.18, wpb=17338.4, bsz=1024, num_updates=22030, lr=2.3222e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=145269
2024-11-11 03:06:20 - progress_bar.py[line:274] - INFO: epoch 057:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.691, ntokens=17109, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3179.5, ups=0.19, wpb=17109, bsz=1024, num_updates=22040, lr=2.32084e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=145323
2024-11-11 03:07:15 - progress_bar.py[line:274] - INFO: epoch 057:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17190.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3171.4, ups=0.18, wpb=17190.9, bsz=1024, num_updates=22050, lr=2.31948e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=145377
2024-11-11 03:08:09 - progress_bar.py[line:274] - INFO: epoch 057:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17024.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3120.2, ups=0.18, wpb=17024.4, bsz=1024, num_updates=22060, lr=2.31812e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=145432
2024-11-11 03:09:03 - progress_bar.py[line:274] - INFO: epoch 057:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17146.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3179.4, ups=0.19, wpb=17146.9, bsz=1024, num_updates=22070, lr=2.31675e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=145486
2024-11-11 03:09:57 - progress_bar.py[line:274] - INFO: epoch 057:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17073, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3187.6, ups=0.19, wpb=17073, bsz=1024, num_updates=22080, lr=2.31539e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=145539
2024-11-11 03:10:50 - progress_bar.py[line:274] - INFO: epoch 057:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=16863.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3138.9, ups=0.19, wpb=16863.9, bsz=1024, num_updates=22090, lr=2.31403e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=145593
2024-11-11 03:11:45 - progress_bar.py[line:274] - INFO: epoch 057:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17343, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3181.6, ups=0.18, wpb=17343, bsz=1024, num_updates=22100, lr=2.31267e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=145648
2024-11-11 03:12:38 - progress_bar.py[line:274] - INFO: epoch 057:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17086.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3202.7, ups=0.19, wpb=17086.2, bsz=1024, num_updates=22110, lr=2.31131e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=145701
2024-11-11 03:13:33 - progress_bar.py[line:274] - INFO: epoch 057:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17386.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3180.1, ups=0.18, wpb=17386.7, bsz=1024, num_updates=22120, lr=2.30995e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=12.5, wall=145756
2024-11-11 03:14:28 - progress_bar.py[line:274] - INFO: epoch 057:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17202.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3142.5, ups=0.18, wpb=17202.4, bsz=1024, num_updates=22130, lr=2.30859e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=145811
2024-11-11 03:15:22 - progress_bar.py[line:274] - INFO: epoch 057:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.687, ntokens=17300.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3196.3, ups=0.18, wpb=17300.8, bsz=1024, num_updates=22140, lr=2.30723e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=145865
2024-11-11 03:16:15 - progress_bar.py[line:274] - INFO: epoch 057:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17199.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3222.4, ups=0.19, wpb=17199.9, bsz=1024, num_updates=22150, lr=2.30587e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=145918
2024-11-11 03:17:09 - progress_bar.py[line:274] - INFO: epoch 057:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17115.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3181.1, ups=0.19, wpb=17115.7, bsz=1024, num_updates=22160, lr=2.30451e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=12.7, wall=145972
2024-11-11 03:18:03 - progress_bar.py[line:274] - INFO: epoch 057:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17368.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3211.3, ups=0.18, wpb=17368.7, bsz=1024, num_updates=22170, lr=2.30315e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=146026
2024-11-11 03:18:57 - progress_bar.py[line:274] - INFO: epoch 057:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17094.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3163.7, ups=0.19, wpb=17094.6, bsz=1024, num_updates=22180, lr=2.30179e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=146080
2024-11-11 03:19:51 - progress_bar.py[line:274] - INFO: epoch 057:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=16894.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3133.4, ups=0.19, wpb=16894.4, bsz=1024, num_updates=22190, lr=2.30043e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=146134
2024-11-11 03:20:45 - progress_bar.py[line:274] - INFO: epoch 057:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17278, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3198.9, ups=0.19, wpb=17278, bsz=1024, num_updates=22200, lr=2.29907e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=146188
2024-11-11 03:21:38 - progress_bar.py[line:274] - INFO: epoch 057:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=16966.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3191.4, ups=0.19, wpb=16966.6, bsz=1024, num_updates=22210, lr=2.29771e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=146241
2024-11-11 03:22:32 - progress_bar.py[line:274] - INFO: epoch 057:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17052.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3137, ups=0.18, wpb=17052.2, bsz=1024, num_updates=22220, lr=2.29635e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=146295
2024-11-11 03:23:26 - progress_bar.py[line:274] - INFO: epoch 057:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17341.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3223, ups=0.19, wpb=17341.6, bsz=1024, num_updates=22230, lr=2.29499e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=146349
2024-11-11 03:24:20 - progress_bar.py[line:274] - INFO: epoch 057:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17504.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3257.4, ups=0.19, wpb=17504.7, bsz=1024, num_updates=22240, lr=2.29363e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=146403
2024-11-11 03:25:14 - progress_bar.py[line:274] - INFO: epoch 057:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17218.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3181.8, ups=0.18, wpb=17218.8, bsz=1024, num_updates=22250, lr=2.29227e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=43, gb_free=13.3, wall=146457
2024-11-11 03:26:10 - progress_bar.py[line:274] - INFO: epoch 057:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17099.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3065.7, ups=0.18, wpb=17099.8, bsz=1024, num_updates=22260, lr=2.29091e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=146513
2024-11-11 03:26:12 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 57 @ 22261 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
2024-11-11 03:26:12 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

2024-11-11 03:28:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-11 03:29:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 57 @ 22261 updates, score 0) (writing took 224.96155966102378 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-11 03:30:52 - train.py[line:336] - INFO: end of epoch 57 (average epoch stats below)
2024-11-11 03:30:52 - progress_bar.py[line:282] - INFO: epoch 057 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.68 | ntokens 17167.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.41 | wps 2627.4 | ups 0.15 | wpb 17167.2 | bsz 1023 | num_updates 22261 | lr 2.29077e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 1224 | gb_free 13.4 | wall 146795
2024-11-11 03:30:52 - trainer.py[line:639] - INFO: loading train data for epoch 58
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 03:33:34 - trainer.py[line:703] - INFO: begin training epoch 58
2024-11-11 03:33:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 03:34:25 - progress_bar.py[line:274] - INFO: epoch 058:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=16773.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=338.8, ups=0.02, wpb=16773.1, bsz=985.6, num_updates=22270, lr=2.28955e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=29, gb_free=13.3, wall=147008
2024-11-11 03:35:18 - progress_bar.py[line:274] - INFO: epoch 058:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17323.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3260.1, ups=0.19, wpb=17323.7, bsz=1024, num_updates=22280, lr=2.28819e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=147061
2024-11-11 03:36:11 - progress_bar.py[line:274] - INFO: epoch 058:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=16895, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3193.9, ups=0.19, wpb=16895, bsz=1024, num_updates=22290, lr=2.28683e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=147114
2024-11-11 03:37:05 - progress_bar.py[line:274] - INFO: epoch 058:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17244.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3213.1, ups=0.19, wpb=17244.6, bsz=1024, num_updates=22300, lr=2.28547e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147168
2024-11-11 03:37:59 - progress_bar.py[line:274] - INFO: epoch 058:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17237.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3195.5, ups=0.19, wpb=17237.6, bsz=1024, num_updates=22310, lr=2.28411e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147222
2024-11-11 03:38:52 - progress_bar.py[line:274] - INFO: epoch 058:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17305.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3239.3, ups=0.19, wpb=17305.9, bsz=1024, num_updates=22320, lr=2.28274e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=147275
2024-11-11 03:39:46 - progress_bar.py[line:274] - INFO: epoch 058:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=16984.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3162.7, ups=0.19, wpb=16984.1, bsz=1024, num_updates=22330, lr=2.28138e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147329
2024-11-11 03:40:40 - progress_bar.py[line:274] - INFO: epoch 058:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17209, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3188, ups=0.19, wpb=17209, bsz=1024, num_updates=22340, lr=2.28002e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=147383
2024-11-11 03:41:33 - progress_bar.py[line:274] - INFO: epoch 058:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17427.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3240.6, ups=0.19, wpb=17427.8, bsz=1024, num_updates=22350, lr=2.27866e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=147436
2024-11-11 03:42:27 - progress_bar.py[line:274] - INFO: epoch 058:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17452.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3238.1, ups=0.19, wpb=17452.5, bsz=1024, num_updates=22360, lr=2.2773e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=147490
2024-11-11 03:43:21 - progress_bar.py[line:274] - INFO: epoch 058:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=16996.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3142.3, ups=0.18, wpb=16996.4, bsz=1024, num_updates=22370, lr=2.27594e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=147544
2024-11-11 03:44:15 - progress_bar.py[line:274] - INFO: epoch 058:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17159, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3206.3, ups=0.19, wpb=17159, bsz=1024, num_updates=22380, lr=2.27458e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147598
2024-11-11 03:45:08 - progress_bar.py[line:274] - INFO: epoch 058:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17248.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3242.9, ups=0.19, wpb=17248.8, bsz=1024, num_updates=22390, lr=2.27322e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=147651
2024-11-11 03:46:02 - progress_bar.py[line:274] - INFO: epoch 058:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17116.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3192.9, ups=0.19, wpb=17116.4, bsz=1024, num_updates=22400, lr=2.27186e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=147705
2024-11-11 03:46:56 - progress_bar.py[line:274] - INFO: epoch 058:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17126.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3187.6, ups=0.19, wpb=17126.5, bsz=1024, num_updates=22410, lr=2.2705e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147758
2024-11-11 03:47:49 - progress_bar.py[line:274] - INFO: epoch 058:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17221.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3238, ups=0.19, wpb=17221.4, bsz=1024, num_updates=22420, lr=2.26914e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=147812
2024-11-11 03:48:42 - progress_bar.py[line:274] - INFO: epoch 058:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17167.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3199.1, ups=0.19, wpb=17167.2, bsz=1024, num_updates=22430, lr=2.26778e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=147865
2024-11-11 03:49:36 - progress_bar.py[line:274] - INFO: epoch 058:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17121.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3196.4, ups=0.19, wpb=17121.2, bsz=1024, num_updates=22440, lr=2.26642e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=147919
2024-11-11 03:50:29 - progress_bar.py[line:274] - INFO: epoch 058:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=16866.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3155.7, ups=0.19, wpb=16866.6, bsz=1024, num_updates=22450, lr=2.26506e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=147972
2024-11-11 03:51:23 - progress_bar.py[line:274] - INFO: epoch 058:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17544.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3243.7, ups=0.18, wpb=17544.3, bsz=1024, num_updates=22460, lr=2.2637e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=148026
2024-11-11 03:52:18 - progress_bar.py[line:274] - INFO: epoch 058:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17180.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3170.5, ups=0.18, wpb=17180.7, bsz=1024, num_updates=22470, lr=2.26234e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=148081
2024-11-11 03:53:11 - progress_bar.py[line:274] - INFO: epoch 058:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17050.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3168.6, ups=0.19, wpb=17050.1, bsz=1024, num_updates=22480, lr=2.26098e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=148134
2024-11-11 03:54:10 - progress_bar.py[line:274] - INFO: epoch 058:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17297, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2955.2, ups=0.17, wpb=17297, bsz=1024, num_updates=22490, lr=2.25962e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=148193
2024-11-11 03:55:09 - progress_bar.py[line:274] - INFO: epoch 058:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17198.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2909.8, ups=0.17, wpb=17198.2, bsz=1024, num_updates=22500, lr=2.25826e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=148252
2024-11-11 03:56:06 - progress_bar.py[line:274] - INFO: epoch 058:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17384.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3065.4, ups=0.18, wpb=17384.1, bsz=1024, num_updates=22510, lr=2.2569e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=148309
2024-11-11 03:57:00 - progress_bar.py[line:274] - INFO: epoch 058:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17166.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3146.8, ups=0.18, wpb=17166.7, bsz=1024, num_updates=22520, lr=2.25554e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=148363
2024-11-11 03:57:54 - progress_bar.py[line:274] - INFO: epoch 058:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17242.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3223.2, ups=0.19, wpb=17242.8, bsz=1024, num_updates=22530, lr=2.25418e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=148417
2024-11-11 03:58:47 - progress_bar.py[line:274] - INFO: epoch 058:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17050.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3197.6, ups=0.19, wpb=17050.1, bsz=1024, num_updates=22540, lr=2.25282e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=148470
2024-11-11 03:59:41 - progress_bar.py[line:274] - INFO: epoch 058:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.689, ntokens=17242.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3221.7, ups=0.19, wpb=17242.3, bsz=1024, num_updates=22550, lr=2.25146e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=148524
2024-11-11 04:00:34 - progress_bar.py[line:274] - INFO: epoch 058:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17143.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3195.7, ups=0.19, wpb=17143.2, bsz=1024, num_updates=22560, lr=2.2501e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=148577
2024-11-11 04:01:28 - progress_bar.py[line:274] - INFO: epoch 058:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=16977.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3162, ups=0.19, wpb=16977.2, bsz=1024, num_updates=22570, lr=2.24873e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=148631
2024-11-11 04:02:22 - progress_bar.py[line:274] - INFO: epoch 058:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17196.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3172.6, ups=0.18, wpb=17196.5, bsz=1024, num_updates=22580, lr=2.24737e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=148685
2024-11-11 04:03:16 - progress_bar.py[line:274] - INFO: epoch 058:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17264, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3231.6, ups=0.19, wpb=17264, bsz=1024, num_updates=22590, lr=2.24601e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=148739
2024-11-11 04:04:10 - progress_bar.py[line:274] - INFO: epoch 058:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.684, ntokens=17292.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3160, ups=0.18, wpb=17292.2, bsz=1024, num_updates=22600, lr=2.24465e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=37, gb_free=13.2, wall=148793
2024-11-11 04:05:03 - progress_bar.py[line:274] - INFO: epoch 058:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17174, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3263, ups=0.19, wpb=17174, bsz=1024, num_updates=22610, lr=2.24329e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=42, gb_free=13.3, wall=148846
2024-11-11 04:05:57 - progress_bar.py[line:274] - INFO: epoch 058:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3231.9, ups=0.19, wpb=17298.6, bsz=1024, num_updates=22620, lr=2.24193e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=148899
2024-11-11 04:06:50 - progress_bar.py[line:274] - INFO: epoch 058:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17519.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3290.9, ups=0.19, wpb=17519.4, bsz=1024, num_updates=22630, lr=2.24057e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=148953
2024-11-11 04:07:42 - progress_bar.py[line:274] - INFO: epoch 058:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17364.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3308.3, ups=0.19, wpb=17364.5, bsz=1024, num_updates=22640, lr=2.23921e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=149005
2024-11-11 04:08:35 - progress_bar.py[line:274] - INFO: epoch 058:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17097, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3238.9, ups=0.19, wpb=17097, bsz=1024, num_updates=22650, lr=2.23785e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=149058
2024-11-11 04:08:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 58 @ 22652 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
2024-11-11 04:08:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 04:10:36 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 04:12:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 58 @ 22652 updates, score 0) (writing took 226.82925037899986 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-11 04:13:25 - train.py[line:336] - INFO: end of epoch 58 (average epoch stats below)
2024-11-11 04:13:25 - progress_bar.py[line:282] - INFO: epoch 058 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.679 | ntokens 17192.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.4 | wps 2633.7 | ups 0.15 | wpb 17192.8 | bsz 1023 | num_updates 22652 | lr 2.23758e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 1203 | gb_free 13.3 | wall 149347
2024-11-11 04:13:25 - trainer.py[line:639] - INFO: loading train data for epoch 59
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 04:16:07 - trainer.py[line:703] - INFO: begin training epoch 59
2024-11-11 04:16:07 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 04:16:52 - progress_bar.py[line:274] - INFO: epoch 059:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=16589.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=334, ups=0.02, wpb=16589.8, bsz=985.6, num_updates=22660, lr=2.23649e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=149555
2024-11-11 04:17:45 - progress_bar.py[line:274] - INFO: epoch 059:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.701, ntokens=17432.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3251.3, ups=0.19, wpb=17432.9, bsz=1024, num_updates=22670, lr=2.23513e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=149608
2024-11-11 04:18:40 - progress_bar.py[line:274] - INFO: epoch 059:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17121.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3141.7, ups=0.18, wpb=17121.3, bsz=1024, num_updates=22680, lr=2.23377e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=149663
2024-11-11 04:19:34 - progress_bar.py[line:274] - INFO: epoch 059:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=16921, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3150.4, ups=0.19, wpb=16921, bsz=1024, num_updates=22690, lr=2.23241e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=149716
2024-11-11 04:20:28 - progress_bar.py[line:274] - INFO: epoch 059:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17147.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3171.4, ups=0.18, wpb=17147.9, bsz=1024, num_updates=22700, lr=2.23105e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=149771
2024-11-11 04:21:21 - progress_bar.py[line:274] - INFO: epoch 059:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17071.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3175.3, ups=0.19, wpb=17071.8, bsz=1024, num_updates=22710, lr=2.22969e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=149824
2024-11-11 04:22:15 - progress_bar.py[line:274] - INFO: epoch 059:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=16893.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3164.2, ups=0.19, wpb=16893.4, bsz=1024, num_updates=22720, lr=2.22833e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=149878
2024-11-11 04:23:08 - progress_bar.py[line:274] - INFO: epoch 059:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17232.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3221.7, ups=0.19, wpb=17232.6, bsz=1024, num_updates=22730, lr=2.22697e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=149931
2024-11-11 04:24:02 - progress_bar.py[line:274] - INFO: epoch 059:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17161.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3192.4, ups=0.19, wpb=17161.3, bsz=1024, num_updates=22740, lr=2.22561e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=149985
2024-11-11 04:24:55 - progress_bar.py[line:274] - INFO: epoch 059:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=17332.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=3253.4, ups=0.19, wpb=17332.6, bsz=1024, num_updates=22750, lr=2.22425e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=150038
2024-11-11 04:25:49 - progress_bar.py[line:274] - INFO: epoch 059:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17133.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3170.3, ups=0.19, wpb=17133.2, bsz=1024, num_updates=22760, lr=2.22289e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=12.9, wall=150092
2024-11-11 04:26:24 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-11 04:26:53 - progress_bar.py[line:274] - INFO: epoch 059:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17160.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=2692.7, ups=0.16, wpb=17160.1, bsz=1024, num_updates=22770, lr=2.22153e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=150156
2024-11-11 04:27:47 - progress_bar.py[line:274] - INFO: epoch 059:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17217.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3200.3, ups=0.19, wpb=17217.8, bsz=1024, num_updates=22780, lr=2.22017e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=150210
2024-11-11 04:28:40 - progress_bar.py[line:274] - INFO: epoch 059:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17035, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3184, ups=0.19, wpb=17035, bsz=1024, num_updates=22790, lr=2.21881e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=150263
2024-11-11 04:29:34 - progress_bar.py[line:274] - INFO: epoch 059:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17328.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3214, ups=0.19, wpb=17328.8, bsz=1024, num_updates=22800, lr=2.21745e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=150317
2024-11-11 04:30:28 - progress_bar.py[line:274] - INFO: epoch 059:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17241.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3225.3, ups=0.19, wpb=17241.9, bsz=1024, num_updates=22810, lr=2.21609e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=150371
2024-11-11 04:31:22 - progress_bar.py[line:274] - INFO: epoch 059:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17082.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3155.9, ups=0.18, wpb=17082.6, bsz=1024, num_updates=22820, lr=2.21472e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=150425
2024-11-11 04:32:19 - progress_bar.py[line:274] - INFO: epoch 059:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17130.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3004.8, ups=0.18, wpb=17130.7, bsz=1024, num_updates=22830, lr=2.21336e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=150482
2024-11-11 04:33:13 - progress_bar.py[line:274] - INFO: epoch 059:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=16945, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3126, ups=0.18, wpb=16945, bsz=1024, num_updates=22840, lr=2.212e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=150536
2024-11-11 04:34:11 - progress_bar.py[line:274] - INFO: epoch 059:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17545.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3040.4, ups=0.17, wpb=17545.9, bsz=1024, num_updates=22850, lr=2.21064e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=150594
2024-11-11 04:35:05 - progress_bar.py[line:274] - INFO: epoch 059:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=16993.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3113.6, ups=0.18, wpb=16993.3, bsz=1024, num_updates=22860, lr=2.20928e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=150648
2024-11-11 04:36:02 - progress_bar.py[line:274] - INFO: epoch 059:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17041.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3027, ups=0.18, wpb=17041.1, bsz=1024, num_updates=22870, lr=2.20792e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=150705
2024-11-11 04:36:55 - progress_bar.py[line:274] - INFO: epoch 059:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17100.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3184.7, ups=0.19, wpb=17100.7, bsz=1024, num_updates=22880, lr=2.20656e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=12.8, wall=150758
2024-11-11 04:37:50 - progress_bar.py[line:274] - INFO: epoch 059:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=16997.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3135, ups=0.18, wpb=16997.5, bsz=1024, num_updates=22890, lr=2.2052e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=150813
2024-11-11 04:38:44 - progress_bar.py[line:274] - INFO: epoch 059:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17145.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3169.4, ups=0.18, wpb=17145.7, bsz=1024, num_updates=22900, lr=2.20384e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=150867
2024-11-11 04:39:38 - progress_bar.py[line:274] - INFO: epoch 059:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17149.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3179.3, ups=0.19, wpb=17149.9, bsz=1024, num_updates=22910, lr=2.20248e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=150921
2024-11-11 04:40:32 - progress_bar.py[line:274] - INFO: epoch 059:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3211.8, ups=0.19, wpb=17332.3, bsz=1024, num_updates=22920, lr=2.20112e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=150975
2024-11-11 04:41:26 - progress_bar.py[line:274] - INFO: epoch 059:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17282, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3203.4, ups=0.19, wpb=17282, bsz=1024, num_updates=22930, lr=2.19976e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=151028
2024-11-11 04:42:20 - progress_bar.py[line:274] - INFO: epoch 059:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17240.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3178.1, ups=0.18, wpb=17240.2, bsz=1024, num_updates=22940, lr=2.1984e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=151083
2024-11-11 04:43:14 - progress_bar.py[line:274] - INFO: epoch 059:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3193.5, ups=0.18, wpb=17372.7, bsz=1024, num_updates=22950, lr=2.19704e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=151137
2024-11-11 04:44:08 - progress_bar.py[line:274] - INFO: epoch 059:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17243.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3188, ups=0.18, wpb=17243.5, bsz=1024, num_updates=22960, lr=2.19568e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=151191
2024-11-11 04:45:03 - progress_bar.py[line:274] - INFO: epoch 059:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17022, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3106.4, ups=0.18, wpb=17022, bsz=1024, num_updates=22970, lr=2.19432e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=151246
2024-11-11 04:45:58 - progress_bar.py[line:274] - INFO: epoch 059:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3160.1, ups=0.18, wpb=17277.5, bsz=1024, num_updates=22980, lr=2.19296e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=151301
2024-11-11 04:46:53 - progress_bar.py[line:274] - INFO: epoch 059:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17271.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3153.2, ups=0.18, wpb=17271.4, bsz=1024, num_updates=22990, lr=2.1916e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=151355
2024-11-11 04:47:48 - progress_bar.py[line:274] - INFO: epoch 059:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17076.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3090.3, ups=0.18, wpb=17076.6, bsz=1024, num_updates=23000, lr=2.19024e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=151411
2024-11-11 04:48:43 - progress_bar.py[line:274] - INFO: epoch 059:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17395.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3172.8, ups=0.18, wpb=17395.6, bsz=1024, num_updates=23010, lr=2.18888e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=151466
2024-11-11 04:49:37 - progress_bar.py[line:274] - INFO: epoch 059:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17294.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3200.9, ups=0.19, wpb=17294.6, bsz=1024, num_updates=23020, lr=2.18752e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=151520
2024-11-11 04:50:30 - progress_bar.py[line:274] - INFO: epoch 059:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17510.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3304.9, ups=0.19, wpb=17510.5, bsz=1024, num_updates=23030, lr=2.18616e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=151573
2024-11-11 04:51:22 - progress_bar.py[line:274] - INFO: epoch 059:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=16869.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3202.7, ups=0.19, wpb=16869.1, bsz=1024, num_updates=23040, lr=2.1848e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=151625
2024-11-11 04:51:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 59 @ 23042 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
2024-11-11 04:51:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 04:53:23 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-11 04:55:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 59 @ 23042 updates, score 0) (writing took 226.2208417749498 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 04:56:11 - train.py[line:336] - INFO: end of epoch 59 (average epoch stats below)
2024-11-11 04:56:11 - progress_bar.py[line:282] - INFO: epoch 059 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.667 | ntokens 17165.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.35 | wps 2608.6 | ups 0.15 | wpb 17165.6 | bsz 1023 | num_updates 23042 | lr 2.18452e-05 | gnorm 0.004 | clip 0 | loss_scale 65536 | train_wall 1185 | gb_free 13.1 | wall 151914
2024-11-11 04:56:11 - trainer.py[line:639] - INFO: loading train data for epoch 60
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 04:58:52 - trainer.py[line:703] - INFO: begin training epoch 60
2024-11-11 04:58:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 04:59:38 - progress_bar.py[line:274] - INFO: epoch 060:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=16725.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=337.6, ups=0.02, wpb=16725.7, bsz=985.6, num_updates=23050, lr=2.18344e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=29, gb_free=13.5, wall=152121
2024-11-11 05:00:32 - progress_bar.py[line:274] - INFO: epoch 060:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17124.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3149.4, ups=0.18, wpb=17124.6, bsz=1024, num_updates=23060, lr=2.18208e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=152175
2024-11-11 05:01:27 - progress_bar.py[line:274] - INFO: epoch 060:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17230.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3147.2, ups=0.18, wpb=17230.4, bsz=1024, num_updates=23070, lr=2.18072e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=33, gb_free=13.1, wall=152230
2024-11-11 05:02:23 - progress_bar.py[line:274] - INFO: epoch 060:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17085.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3046.5, ups=0.18, wpb=17085.9, bsz=1024, num_updates=23080, lr=2.17935e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.1, wall=152286
2024-11-11 05:03:19 - progress_bar.py[line:274] - INFO: epoch 060:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17127.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3043.7, ups=0.18, wpb=17127.9, bsz=1024, num_updates=23090, lr=2.17799e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=152342
2024-11-11 05:04:15 - progress_bar.py[line:274] - INFO: epoch 060:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17211.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3079, ups=0.18, wpb=17211.5, bsz=1024, num_updates=23100, lr=2.17663e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=152398
2024-11-11 05:05:11 - progress_bar.py[line:274] - INFO: epoch 060:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17037.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3041, ups=0.18, wpb=17037.8, bsz=1024, num_updates=23110, lr=2.17527e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=152454
2024-11-11 05:06:07 - progress_bar.py[line:274] - INFO: epoch 060:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17111.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3043.9, ups=0.18, wpb=17111.7, bsz=1024, num_updates=23120, lr=2.17391e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=152510
2024-11-11 05:07:03 - progress_bar.py[line:274] - INFO: epoch 060:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17397, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3120.2, ups=0.18, wpb=17397, bsz=1024, num_updates=23130, lr=2.17255e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=152566
2024-11-11 05:07:59 - progress_bar.py[line:274] - INFO: epoch 060:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17279.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3097.4, ups=0.18, wpb=17279.1, bsz=1024, num_updates=23140, lr=2.17119e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=152622
2024-11-11 05:08:55 - progress_bar.py[line:274] - INFO: epoch 060:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3082.4, ups=0.18, wpb=17269.4, bsz=1024, num_updates=23150, lr=2.16983e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13, wall=152678
2024-11-11 05:09:51 - progress_bar.py[line:274] - INFO: epoch 060:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.677, ntokens=17325.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3094.3, ups=0.18, wpb=17325.2, bsz=1024, num_updates=23160, lr=2.16847e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=152734
2024-11-11 05:10:14 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 05:10:53 - progress_bar.py[line:274] - INFO: epoch 060:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17102.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2752.3, ups=0.16, wpb=17102.3, bsz=1024, num_updates=23170, lr=2.16711e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=62, gb_free=13.3, wall=152796
2024-11-11 05:11:50 - progress_bar.py[line:274] - INFO: epoch 060:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17001.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3013.3, ups=0.18, wpb=17001.1, bsz=1024, num_updates=23180, lr=2.16575e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=152852
2024-11-11 05:12:34 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 05:12:51 - progress_bar.py[line:274] - INFO: epoch 060:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.668, ntokens=17117.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2775, ups=0.16, wpb=17117.5, bsz=1024, num_updates=23190, lr=2.16439e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=62, gb_free=13.4, wall=152914
2024-11-11 05:13:47 - progress_bar.py[line:274] - INFO: epoch 060:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.672, ntokens=17247.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3071.3, ups=0.18, wpb=17247.4, bsz=1024, num_updates=23200, lr=2.16303e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=12.9, wall=152970
2024-11-11 05:14:43 - progress_bar.py[line:274] - INFO: epoch 060:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=16967.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3061.5, ups=0.18, wpb=16967.2, bsz=1024, num_updates=23210, lr=2.16167e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=153026
2024-11-11 05:15:39 - progress_bar.py[line:274] - INFO: epoch 060:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17226.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3041.5, ups=0.18, wpb=17226.3, bsz=1024, num_updates=23220, lr=2.16031e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=57, gb_free=13, wall=153082
2024-11-11 05:16:35 - progress_bar.py[line:274] - INFO: epoch 060:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=16953.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3048.6, ups=0.18, wpb=16953.4, bsz=1024, num_updates=23230, lr=2.15895e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=153138
2024-11-11 05:17:31 - progress_bar.py[line:274] - INFO: epoch 060:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.696, ntokens=17468.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3129.6, ups=0.18, wpb=17468.4, bsz=1024, num_updates=23240, lr=2.15759e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=153194
2024-11-11 05:18:27 - progress_bar.py[line:274] - INFO: epoch 060:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17095.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3022, ups=0.18, wpb=17095.3, bsz=1024, num_updates=23250, lr=2.15623e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=153250
2024-11-11 05:19:23 - progress_bar.py[line:274] - INFO: epoch 060:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17212.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3087.3, ups=0.18, wpb=17212.5, bsz=1024, num_updates=23260, lr=2.15487e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=153306
2024-11-11 05:20:19 - progress_bar.py[line:274] - INFO: epoch 060:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.679, ntokens=17301.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3081.9, ups=0.18, wpb=17301.1, bsz=1024, num_updates=23270, lr=2.15351e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=153362
2024-11-11 05:21:16 - progress_bar.py[line:274] - INFO: epoch 060:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17122.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3040.3, ups=0.18, wpb=17122.5, bsz=1024, num_updates=23280, lr=2.15215e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=153419
2024-11-11 05:22:12 - progress_bar.py[line:274] - INFO: epoch 060:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17429, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3085.7, ups=0.18, wpb=17429, bsz=1024, num_updates=23290, lr=2.15079e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=153475
2024-11-11 05:23:08 - progress_bar.py[line:274] - INFO: epoch 060:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17098.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3048.3, ups=0.18, wpb=17098.2, bsz=1024, num_updates=23300, lr=2.14943e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=153531
2024-11-11 05:24:04 - progress_bar.py[line:274] - INFO: epoch 060:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17353.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3095, ups=0.18, wpb=17353.6, bsz=1024, num_updates=23310, lr=2.14807e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=153587
2024-11-11 05:25:01 - progress_bar.py[line:274] - INFO: epoch 060:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17277.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3069.4, ups=0.18, wpb=17277.2, bsz=1024, num_updates=23320, lr=2.14671e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=153643
2024-11-11 05:25:57 - progress_bar.py[line:274] - INFO: epoch 060:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17368.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3093.7, ups=0.18, wpb=17368.8, bsz=1024, num_updates=23330, lr=2.14534e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=56, gb_free=12.4, wall=153700
2024-11-11 05:26:53 - progress_bar.py[line:274] - INFO: epoch 060:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17188.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3060.1, ups=0.18, wpb=17188.6, bsz=1024, num_updates=23340, lr=2.14398e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=153756
2024-11-11 05:27:50 - progress_bar.py[line:274] - INFO: epoch 060:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17190.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3026.6, ups=0.18, wpb=17190.2, bsz=1024, num_updates=23350, lr=2.14262e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=57, gb_free=13.2, wall=153813
2024-11-11 05:28:46 - progress_bar.py[line:274] - INFO: epoch 060:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17088.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3038.4, ups=0.18, wpb=17088.1, bsz=1024, num_updates=23360, lr=2.14126e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13, wall=153869
2024-11-11 05:29:42 - progress_bar.py[line:274] - INFO: epoch 060:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17132.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3066.2, ups=0.18, wpb=17132.8, bsz=1024, num_updates=23370, lr=2.1399e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=153925
2024-11-11 05:30:38 - progress_bar.py[line:274] - INFO: epoch 060:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17441.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3111.7, ups=0.18, wpb=17441.4, bsz=1024, num_updates=23380, lr=2.13854e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=153981
2024-11-11 05:31:35 - progress_bar.py[line:274] - INFO: epoch 060:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17124.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3018.1, ups=0.18, wpb=17124.9, bsz=1024, num_updates=23390, lr=2.13718e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=154037
2024-11-11 05:32:31 - progress_bar.py[line:274] - INFO: epoch 060:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17228.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3079.4, ups=0.18, wpb=17228.3, bsz=1024, num_updates=23400, lr=2.13582e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=154093
2024-11-11 05:33:27 - progress_bar.py[line:274] - INFO: epoch 060:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3068.8, ups=0.18, wpb=17332.3, bsz=1024, num_updates=23410, lr=2.13446e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=154150
2024-11-11 05:34:23 - progress_bar.py[line:274] - INFO: epoch 060:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17186.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3065.5, ups=0.18, wpb=17186.3, bsz=1024, num_updates=23420, lr=2.1331e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=154206
2024-11-11 05:35:20 - progress_bar.py[line:274] - INFO: epoch 060:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17188.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3041.1, ups=0.18, wpb=17188.1, bsz=1024, num_updates=23430, lr=2.13174e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=12.8, wall=154263
2024-11-11 05:35:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 60 @ 23431 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt

2024-11-11 05:35:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 05:37:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 05:39:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 60 @ 23431 updates, score 0) (writing took 224.4739284819807 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-11 05:40:01 - train.py[line:336] - INFO: end of epoch 60 (average epoch stats below)
2024-11-11 05:40:01 - progress_bar.py[line:282] - INFO: epoch 060 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.665 | ntokens 17187.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.34 | wps 2541.7 | ups 0.15 | wpb 17187.5 | bsz 1023 | num_updates 23431 | lr 2.1316e-05 | gnorm 0.005 | clip 0 | loss_scale 16384 | train_wall 2115 | gb_free 13.2 | wall 154544
2024-11-11 05:40:01 - trainer.py[line:639] - INFO: loading train data for epoch 61
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 05:42:44 - trainer.py[line:703] - INFO: begin training epoch 61
2024-11-11 05:42:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 05:43:35 - progress_bar.py[line:274] - INFO: epoch 061:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.692, ntokens=16745.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.46, wps=338, ups=0.02, wpb=16745.4, bsz=985.6, num_updates=23440, lr=2.13038e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=29, gb_free=13.3, wall=154758
2024-11-11 05:44:30 - progress_bar.py[line:274] - INFO: epoch 061:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17249.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3163, ups=0.18, wpb=17249.2, bsz=1024, num_updates=23450, lr=2.12902e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=154813
2024-11-11 05:45:24 - progress_bar.py[line:274] - INFO: epoch 061:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=16993.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3146.7, ups=0.19, wpb=16993.2, bsz=1024, num_updates=23460, lr=2.12766e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=154867
2024-11-11 05:46:19 - progress_bar.py[line:274] - INFO: epoch 061:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=16898, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3078.2, ups=0.18, wpb=16898, bsz=1024, num_updates=23470, lr=2.1263e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=154921
2024-11-11 05:47:15 - progress_bar.py[line:274] - INFO: epoch 061:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17239.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3043.1, ups=0.18, wpb=17239.9, bsz=1024, num_updates=23480, lr=2.12494e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=43, gb_free=13.4, wall=154978
2024-11-11 05:48:12 - progress_bar.py[line:274] - INFO: epoch 061:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17129.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3035.5, ups=0.18, wpb=17129.5, bsz=1024, num_updates=23490, lr=2.12358e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=155035
2024-11-11 05:49:08 - progress_bar.py[line:274] - INFO: epoch 061:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17217.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3041.3, ups=0.18, wpb=17217.7, bsz=1024, num_updates=23500, lr=2.12222e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13.2, wall=155091
2024-11-11 05:50:05 - progress_bar.py[line:274] - INFO: epoch 061:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17233.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3047.4, ups=0.18, wpb=17233.5, bsz=1024, num_updates=23510, lr=2.12086e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=155148
2024-11-11 05:51:02 - progress_bar.py[line:274] - INFO: epoch 061:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17189.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3026.9, ups=0.18, wpb=17189.4, bsz=1024, num_updates=23520, lr=2.1195e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=57, gb_free=13, wall=155204
2024-11-11 05:51:56 - progress_bar.py[line:274] - INFO: epoch 061:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17089.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3155.7, ups=0.18, wpb=17089.2, bsz=1024, num_updates=23530, lr=2.11814e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=54, gb_free=13, wall=155259
2024-11-11 05:52:52 - progress_bar.py[line:274] - INFO: epoch 061:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17157, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3073.1, ups=0.18, wpb=17157, bsz=1024, num_updates=23540, lr=2.11678e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=155314
2024-11-11 05:53:46 - progress_bar.py[line:274] - INFO: epoch 061:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17186.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3153.9, ups=0.18, wpb=17186.7, bsz=1024, num_updates=23550, lr=2.11542e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=155369
2024-11-11 05:54:42 - progress_bar.py[line:274] - INFO: epoch 061:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17136.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3056.6, ups=0.18, wpb=17136.7, bsz=1024, num_updates=23560, lr=2.11406e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=155425
2024-11-11 05:55:38 - progress_bar.py[line:274] - INFO: epoch 061:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17048.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3041.9, ups=0.18, wpb=17048.1, bsz=1024, num_updates=23570, lr=2.1127e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=155481
2024-11-11 05:56:34 - progress_bar.py[line:274] - INFO: epoch 061:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17205.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3063.2, ups=0.18, wpb=17205.9, bsz=1024, num_updates=23580, lr=2.11133e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=155537
2024-11-11 05:57:30 - progress_bar.py[line:274] - INFO: epoch 061:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17264.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3091.8, ups=0.18, wpb=17264.5, bsz=1024, num_updates=23590, lr=2.10997e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.1, wall=155593
2024-11-11 05:58:26 - progress_bar.py[line:274] - INFO: epoch 061:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17064.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3076, ups=0.18, wpb=17064.8, bsz=1024, num_updates=23600, lr=2.10861e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=13.2, wall=155649
2024-11-11 05:59:22 - progress_bar.py[line:274] - INFO: epoch 061:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17043.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3030.9, ups=0.18, wpb=17043.1, bsz=1024, num_updates=23610, lr=2.10725e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=155705
2024-11-11 06:00:18 - progress_bar.py[line:274] - INFO: epoch 061:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=16976.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3030.7, ups=0.18, wpb=16976.3, bsz=1024, num_updates=23620, lr=2.10589e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=155761
2024-11-11 06:01:14 - progress_bar.py[line:274] - INFO: epoch 061:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17341.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3099.2, ups=0.18, wpb=17341.3, bsz=1024, num_updates=23630, lr=2.10453e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.2, wall=155817
2024-11-11 06:02:10 - progress_bar.py[line:274] - INFO: epoch 061:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17336.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3074.5, ups=0.18, wpb=17336.3, bsz=1024, num_updates=23640, lr=2.10317e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=155873
2024-11-11 06:03:06 - progress_bar.py[line:274] - INFO: epoch 061:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17116.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3046.7, ups=0.18, wpb=17116.7, bsz=1024, num_updates=23650, lr=2.10181e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=155929
2024-11-11 06:04:03 - progress_bar.py[line:274] - INFO: epoch 061:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17324.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3070.7, ups=0.18, wpb=17324.2, bsz=1024, num_updates=23660, lr=2.10045e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13, wall=155986
2024-11-11 06:05:00 - progress_bar.py[line:274] - INFO: epoch 061:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17113.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=2998.9, ups=0.18, wpb=17113.2, bsz=1024, num_updates=23670, lr=2.09909e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=57, gb_free=13.2, wall=156043
2024-11-11 06:05:57 - progress_bar.py[line:274] - INFO: epoch 061:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17238.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3022.5, ups=0.18, wpb=17238.9, bsz=1024, num_updates=23680, lr=2.09773e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13.3, wall=156100
2024-11-11 06:06:54 - progress_bar.py[line:274] - INFO: epoch 061:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=16918.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2988, ups=0.18, wpb=16918.6, bsz=1024, num_updates=23690, lr=2.09637e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13.3, wall=156156
2024-11-11 06:07:50 - progress_bar.py[line:274] - INFO: epoch 061:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3127.7, ups=0.18, wpb=17589.3, bsz=1024, num_updates=23700, lr=2.09501e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=156213
2024-11-11 06:08:46 - progress_bar.py[line:274] - INFO: epoch 061:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17018.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3041.3, ups=0.18, wpb=17018.7, bsz=1024, num_updates=23710, lr=2.09365e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=156269
2024-11-11 06:09:41 - progress_bar.py[line:274] - INFO: epoch 061:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17025.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3078.6, ups=0.18, wpb=17025.8, bsz=1024, num_updates=23720, lr=2.09229e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=156324
2024-11-11 06:10:38 - progress_bar.py[line:274] - INFO: epoch 061:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.683, ntokens=17350.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3037, ups=0.18, wpb=17350.3, bsz=1024, num_updates=23730, lr=2.09093e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=156381
2024-11-11 06:11:34 - progress_bar.py[line:274] - INFO: epoch 061:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=16969, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3027.9, ups=0.18, wpb=16969, bsz=1024, num_updates=23740, lr=2.08957e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=156437
2024-11-11 06:12:31 - progress_bar.py[line:274] - INFO: epoch 061:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=16979.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2993.8, ups=0.18, wpb=16979.3, bsz=1024, num_updates=23750, lr=2.08821e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.1, wall=156494
2024-11-11 06:13:27 - progress_bar.py[line:274] - INFO: epoch 061:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17080.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3020.4, ups=0.18, wpb=17080.1, bsz=1024, num_updates=23760, lr=2.08685e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=156550
2024-11-11 06:14:24 - progress_bar.py[line:274] - INFO: epoch 061:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17222.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3050.6, ups=0.18, wpb=17222.4, bsz=1024, num_updates=23770, lr=2.08549e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.1, wall=156607
2024-11-11 06:15:20 - progress_bar.py[line:274] - INFO: epoch 061:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17158.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3063.2, ups=0.18, wpb=17158.2, bsz=1024, num_updates=23780, lr=2.08413e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=156663
2024-11-11 06:16:17 - progress_bar.py[line:274] - INFO: epoch 061:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17346.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3034.5, ups=0.17, wpb=17346.1, bsz=1024, num_updates=23790, lr=2.08277e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=156720
2024-11-11 06:17:14 - progress_bar.py[line:274] - INFO: epoch 061:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17351.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3063.4, ups=0.18, wpb=17351.8, bsz=1024, num_updates=23800, lr=2.08141e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=156777
2024-11-11 06:18:08 - progress_bar.py[line:274] - INFO: epoch 061:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17157, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3169.7, ups=0.18, wpb=17157, bsz=1024, num_updates=23810, lr=2.08005e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=156831
2024-11-11 06:19:04 - progress_bar.py[line:274] - INFO: epoch 061:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=16889.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3037.2, ups=0.18, wpb=16889.6, bsz=1024, num_updates=23820, lr=2.07869e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=156886
2024-11-11 06:19:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 61 @ 23822 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
2024-11-11 06:19:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 06:21:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-11 06:22:55 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 61 @ 23822 updates, score 0) (writing took 223.69447904499248 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 06:23:50 - train.py[line:336] - INFO: end of epoch 61 (average epoch stats below)
2024-11-11 06:23:50 - progress_bar.py[line:282] - INFO: epoch 061 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.653 | ntokens 17144.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.29 | wps 2550 | ups 0.15 | wpb 17144.2 | bsz 1023 | num_updates 23822 | lr 2.07841e-05 | gnorm 0.005 | clip 0 | loss_scale 32768 | train_wall 2074 | gb_free 13.5 | wall 157173
2024-11-11 06:23:50 - trainer.py[line:639] - INFO: loading train data for epoch 62
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 06:26:32 - trainer.py[line:703] - INFO: begin training epoch 62
2024-11-11 06:26:32 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 06:27:17 - progress_bar.py[line:274] - INFO: epoch 062:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=16567.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=335.7, ups=0.02, wpb=16567.5, bsz=985.6, num_updates=23830, lr=2.07732e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=157380
2024-11-11 06:28:11 - progress_bar.py[line:274] - INFO: epoch 062:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17286.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3211.5, ups=0.19, wpb=17286.7, bsz=1024, num_updates=23840, lr=2.07596e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=157434
2024-11-11 06:29:06 - progress_bar.py[line:274] - INFO: epoch 062:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17226.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3117.5, ups=0.18, wpb=17226.9, bsz=1024, num_updates=23850, lr=2.0746e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=157489
2024-11-11 06:30:03 - progress_bar.py[line:274] - INFO: epoch 062:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17024.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2989, ups=0.18, wpb=17024.5, bsz=1024, num_updates=23860, lr=2.07324e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=157546
2024-11-11 06:31:00 - progress_bar.py[line:274] - INFO: epoch 062:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17140, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3029.3, ups=0.18, wpb=17140, bsz=1024, num_updates=23870, lr=2.07188e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=157603
2024-11-11 06:31:57 - progress_bar.py[line:274] - INFO: epoch 062:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17233.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3011.7, ups=0.17, wpb=17233.3, bsz=1024, num_updates=23880, lr=2.07052e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=157660
2024-11-11 06:32:54 - progress_bar.py[line:274] - INFO: epoch 062:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=16791.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2943.4, ups=0.18, wpb=16791.9, bsz=1024, num_updates=23890, lr=2.06916e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=157717
2024-11-11 06:33:51 - progress_bar.py[line:274] - INFO: epoch 062:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17029.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3005, ups=0.18, wpb=17029.2, bsz=1024, num_updates=23900, lr=2.0678e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=157774
2024-11-11 06:34:48 - progress_bar.py[line:274] - INFO: epoch 062:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17165, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3018, ups=0.18, wpb=17165, bsz=1024, num_updates=23910, lr=2.06644e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=157830
2024-11-11 06:35:43 - progress_bar.py[line:274] - INFO: epoch 062:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17196.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3113.6, ups=0.18, wpb=17196.5, bsz=1024, num_updates=23920, lr=2.06508e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=157886
2024-11-11 06:36:39 - progress_bar.py[line:274] - INFO: epoch 062:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17180.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3053.7, ups=0.18, wpb=17180.4, bsz=1024, num_updates=23930, lr=2.06372e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=157942
2024-11-11 06:37:36 - progress_bar.py[line:274] - INFO: epoch 062:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17079.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=2994.2, ups=0.18, wpb=17079.4, bsz=1024, num_updates=23940, lr=2.06236e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13, wall=157999
2024-11-11 06:38:33 - progress_bar.py[line:274] - INFO: epoch 062:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17221.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3045.5, ups=0.18, wpb=17221.3, bsz=1024, num_updates=23950, lr=2.061e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=158056
2024-11-11 06:39:29 - progress_bar.py[line:274] - INFO: epoch 062:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17218.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3028.8, ups=0.18, wpb=17218.6, bsz=1024, num_updates=23960, lr=2.05964e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=158112
2024-11-11 06:40:26 - progress_bar.py[line:274] - INFO: epoch 062:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17068.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3002.8, ups=0.18, wpb=17068.6, bsz=1024, num_updates=23970, lr=2.05828e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=158169
2024-11-11 06:41:21 - progress_bar.py[line:274] - INFO: epoch 062:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17376.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3198.3, ups=0.18, wpb=17376.6, bsz=1024, num_updates=23980, lr=2.05692e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=158224
2024-11-11 06:42:14 - progress_bar.py[line:274] - INFO: epoch 062:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17122.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3198.4, ups=0.19, wpb=17122.3, bsz=1024, num_updates=23990, lr=2.05556e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=53, gb_free=13.3, wall=158277
2024-11-11 06:43:08 - progress_bar.py[line:274] - INFO: epoch 062:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17113.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3202, ups=0.19, wpb=17113.4, bsz=1024, num_updates=24000, lr=2.0542e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=45, gb_free=13.4, wall=158331
2024-11-11 06:44:04 - progress_bar.py[line:274] - INFO: epoch 062:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17102.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3037.5, ups=0.18, wpb=17102.5, bsz=1024, num_updates=24010, lr=2.05284e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=47, gb_free=13.4, wall=158387
2024-11-11 06:45:00 - progress_bar.py[line:274] - INFO: epoch 062:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17307, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3069.3, ups=0.18, wpb=17307, bsz=1024, num_updates=24020, lr=2.05148e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=158443
2024-11-11 06:45:57 - progress_bar.py[line:274] - INFO: epoch 062:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17015.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3002.9, ups=0.18, wpb=17015.3, bsz=1024, num_updates=24030, lr=2.05012e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=158500
2024-11-11 06:46:54 - progress_bar.py[line:274] - INFO: epoch 062:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=16959.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2967.9, ups=0.18, wpb=16959.2, bsz=1024, num_updates=24040, lr=2.04876e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=158557
2024-11-11 06:47:52 - progress_bar.py[line:274] - INFO: epoch 062:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17482.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3028.4, ups=0.17, wpb=17482.7, bsz=1024, num_updates=24050, lr=2.0474e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=158615
2024-11-11 06:48:49 - progress_bar.py[line:274] - INFO: epoch 062:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17259.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3008.3, ups=0.17, wpb=17259.7, bsz=1024, num_updates=24060, lr=2.04604e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=158672
2024-11-11 06:49:46 - progress_bar.py[line:274] - INFO: epoch 062:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17309.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3043, ups=0.18, wpb=17309.6, bsz=1024, num_updates=24070, lr=2.04468e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.1, wall=158729
2024-11-11 06:50:43 - progress_bar.py[line:274] - INFO: epoch 062:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17376.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3053.2, ups=0.18, wpb=17376.8, bsz=1024, num_updates=24080, lr=2.04332e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=158786
2024-11-11 06:51:40 - progress_bar.py[line:274] - INFO: epoch 062:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17246.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3027.2, ups=0.18, wpb=17246.6, bsz=1024, num_updates=24090, lr=2.04195e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.6, wall=158843
2024-11-11 06:52:36 - progress_bar.py[line:274] - INFO: epoch 062:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17172.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3084.1, ups=0.18, wpb=17172.5, bsz=1024, num_updates=24100, lr=2.04059e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.1, wall=158899
2024-11-11 06:53:32 - progress_bar.py[line:274] - INFO: epoch 062:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.659, ntokens=17187, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3066, ups=0.18, wpb=17187, bsz=1024, num_updates=24110, lr=2.03923e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=158955
2024-11-11 06:54:28 - progress_bar.py[line:274] - INFO: epoch 062:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17231.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3045, ups=0.18, wpb=17231.1, bsz=1024, num_updates=24120, lr=2.03787e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.1, wall=159011
2024-11-11 06:55:25 - progress_bar.py[line:274] - INFO: epoch 062:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=16905, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3004.4, ups=0.18, wpb=16905, bsz=1024, num_updates=24130, lr=2.03651e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=159067
2024-11-11 06:56:21 - progress_bar.py[line:274] - INFO: epoch 062:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17326.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3087.9, ups=0.18, wpb=17326.8, bsz=1024, num_updates=24140, lr=2.03515e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=159124
2024-11-11 06:57:17 - progress_bar.py[line:274] - INFO: epoch 062:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17188.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3044.6, ups=0.18, wpb=17188.7, bsz=1024, num_updates=24150, lr=2.03379e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=159180
2024-11-11 06:58:14 - progress_bar.py[line:274] - INFO: epoch 062:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17147, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3042.5, ups=0.18, wpb=17147, bsz=1024, num_updates=24160, lr=2.03243e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=159236
2024-11-11 06:59:11 - progress_bar.py[line:274] - INFO: epoch 062:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17059.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2990, ups=0.18, wpb=17059.5, bsz=1024, num_updates=24170, lr=2.03107e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13, wall=159293
2024-11-11 07:00:08 - progress_bar.py[line:274] - INFO: epoch 062:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.67, ntokens=17271, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=3004.5, ups=0.17, wpb=17271, bsz=1024, num_updates=24180, lr=2.02971e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=159351
2024-11-11 07:01:05 - progress_bar.py[line:274] - INFO: epoch 062:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3026, ups=0.17, wpb=17322.9, bsz=1024, num_updates=24190, lr=2.02835e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=159408
2024-11-11 07:02:01 - progress_bar.py[line:274] - INFO: epoch 062:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17672.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3148.8, ups=0.18, wpb=17672.5, bsz=1024, num_updates=24200, lr=2.02699e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=159464
2024-11-11 07:02:58 - progress_bar.py[line:274] - INFO: epoch 062:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17030.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3019.7, ups=0.18, wpb=17030.7, bsz=1024, num_updates=24210, lr=2.02563e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=159521
2024-11-11 07:03:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 62 @ 24213 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
2024-11-11 07:03:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 07:05:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 07:06:56 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 62 @ 24213 updates, score 0) (writing took 225.5382258699974 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-11 07:07:52 - train.py[line:336] - INFO: end of epoch 62 (average epoch stats below)
2024-11-11 07:07:52 - progress_bar.py[line:282] - INFO: epoch 062 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.653 | ntokens 17167.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.29 | wps 2541 | ups 0.15 | wpb 17167.4 | bsz 1023 | num_updates 24213 | lr 2.02522e-05 | gnorm 0.004 | clip 0 | loss_scale 65536 | train_wall 2111 | gb_free 13.2 | wall 159815
2024-11-11 07:07:52 - trainer.py[line:639] - INFO: loading train data for epoch 63
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 07:10:33 - trainer.py[line:703] - INFO: begin training epoch 63
2024-11-11 07:10:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 07:11:14 - progress_bar.py[line:274] - INFO: epoch 063:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=16604.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=334.6, ups=0.02, wpb=16604.3, bsz=985.6, num_updates=24220, lr=2.02427e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=34, gb_free=13.3, wall=160017
2024-11-11 07:12:09 - progress_bar.py[line:274] - INFO: epoch 063:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17375.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3164.8, ups=0.18, wpb=17375.7, bsz=1024, num_updates=24230, lr=2.02291e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=160072
2024-11-11 07:13:06 - progress_bar.py[line:274] - INFO: epoch 063:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=16896.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2957.8, ups=0.18, wpb=16896.7, bsz=1024, num_updates=24240, lr=2.02155e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=47, gb_free=13.3, wall=160129
2024-11-11 07:13:59 - progress_bar.py[line:274] - INFO: epoch 063:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=16977.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3188.4, ups=0.19, wpb=16977.3, bsz=1024, num_updates=24250, lr=2.02019e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=43, gb_free=13.5, wall=160182
2024-11-11 07:14:57 - progress_bar.py[line:274] - INFO: epoch 063:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17100.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2983.3, ups=0.17, wpb=17100.9, bsz=1024, num_updates=24260, lr=2.01883e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13, wall=160240
2024-11-11 07:15:54 - progress_bar.py[line:274] - INFO: epoch 063:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17274.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3012.8, ups=0.17, wpb=17274.7, bsz=1024, num_updates=24270, lr=2.01747e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=160297
2024-11-11 07:16:51 - progress_bar.py[line:274] - INFO: epoch 063:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3032, ups=0.18, wpb=17226, bsz=1024, num_updates=24280, lr=2.01611e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=160354
2024-11-11 07:17:48 - progress_bar.py[line:274] - INFO: epoch 063:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17029.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2998.3, ups=0.18, wpb=17029.1, bsz=1024, num_updates=24290, lr=2.01475e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=160411
2024-11-11 07:18:46 - progress_bar.py[line:274] - INFO: epoch 063:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17401.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2997.6, ups=0.17, wpb=17401.1, bsz=1024, num_updates=24300, lr=2.01339e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=160469
2024-11-11 07:19:43 - progress_bar.py[line:274] - INFO: epoch 063:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17001.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2974.1, ups=0.17, wpb=17001.7, bsz=1024, num_updates=24310, lr=2.01203e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=160526
2024-11-11 07:20:40 - progress_bar.py[line:274] - INFO: epoch 063:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.682, ntokens=17342.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.42, wps=3019.9, ups=0.17, wpb=17342.4, bsz=1024, num_updates=24320, lr=2.01067e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=160583
2024-11-11 07:21:38 - progress_bar.py[line:274] - INFO: epoch 063:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.663, ntokens=17238, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3006.9, ups=0.17, wpb=17238, bsz=1024, num_updates=24330, lr=2.00931e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=160641
2024-11-11 07:22:35 - progress_bar.py[line:274] - INFO: epoch 063:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17285.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3034.7, ups=0.18, wpb=17285.4, bsz=1024, num_updates=24340, lr=2.00794e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=160697
2024-11-11 07:23:33 - progress_bar.py[line:274] - INFO: epoch 063:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17049.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2940, ups=0.17, wpb=17049.5, bsz=1024, num_updates=24350, lr=2.00658e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=160755
2024-11-11 07:24:27 - progress_bar.py[line:274] - INFO: epoch 063:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17016.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3122.9, ups=0.18, wpb=17016.3, bsz=1024, num_updates=24360, lr=2.00522e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=160810
2024-11-11 07:25:25 - progress_bar.py[line:274] - INFO: epoch 063:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.685, ntokens=17472.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.43, wps=3022.5, ups=0.17, wpb=17472.3, bsz=1024, num_updates=24370, lr=2.00386e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=160868
2024-11-11 07:26:22 - progress_bar.py[line:274] - INFO: epoch 063:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17231.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3015.3, ups=0.17, wpb=17231.5, bsz=1024, num_updates=24380, lr=2.0025e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=160925
2024-11-11 07:27:19 - progress_bar.py[line:274] - INFO: epoch 063:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17227.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3011.6, ups=0.17, wpb=17227.6, bsz=1024, num_updates=24390, lr=2.00114e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=160982
2024-11-11 07:28:16 - progress_bar.py[line:274] - INFO: epoch 063:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17113.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2997.8, ups=0.18, wpb=17113.2, bsz=1024, num_updates=24400, lr=1.99978e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=161039
2024-11-11 07:29:14 - progress_bar.py[line:274] - INFO: epoch 063:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17333.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=2990.5, ups=0.17, wpb=17333.7, bsz=1024, num_updates=24410, lr=1.99842e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=161097
2024-11-11 07:30:11 - progress_bar.py[line:274] - INFO: epoch 063:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17254.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3025.1, ups=0.18, wpb=17254.1, bsz=1024, num_updates=24420, lr=1.99706e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=161154
2024-11-11 07:31:09 - progress_bar.py[line:274] - INFO: epoch 063:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=16945.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2946, ups=0.17, wpb=16945.2, bsz=1024, num_updates=24430, lr=1.9957e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=161212
2024-11-11 07:32:07 - progress_bar.py[line:274] - INFO: epoch 063:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17316.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2993.9, ups=0.17, wpb=17316.9, bsz=1024, num_updates=24440, lr=1.99434e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=58, gb_free=13.1, wall=161270
2024-11-11 07:33:05 - progress_bar.py[line:274] - INFO: epoch 063:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17017.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2931.7, ups=0.17, wpb=17017.4, bsz=1024, num_updates=24450, lr=1.99298e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.2, wall=161328
2024-11-11 07:34:00 - progress_bar.py[line:274] - INFO: epoch 063:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17357.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3124.4, ups=0.18, wpb=17357.7, bsz=1024, num_updates=24460, lr=1.99162e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=161383
2024-11-11 07:34:56 - progress_bar.py[line:274] - INFO: epoch 063:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17094, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3077.5, ups=0.18, wpb=17094, bsz=1024, num_updates=24470, lr=1.99026e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13, wall=161439
2024-11-11 07:35:54 - progress_bar.py[line:274] - INFO: epoch 063:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17295.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2974.5, ups=0.17, wpb=17295.8, bsz=1024, num_updates=24480, lr=1.9889e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=161497
2024-11-11 07:36:51 - progress_bar.py[line:274] - INFO: epoch 063:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17069.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3014.6, ups=0.18, wpb=17069.2, bsz=1024, num_updates=24490, lr=1.98754e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.1, wall=161553
2024-11-11 07:37:46 - progress_bar.py[line:274] - INFO: epoch 063:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17108.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3101.2, ups=0.18, wpb=17108.4, bsz=1024, num_updates=24500, lr=1.98618e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=161609
2024-11-11 07:38:43 - progress_bar.py[line:274] - INFO: epoch 063:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17236.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2999.2, ups=0.17, wpb=17236.8, bsz=1024, num_updates=24510, lr=1.98482e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.1, wall=161666
2024-11-11 07:39:40 - progress_bar.py[line:274] - INFO: epoch 063:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17239.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3026, ups=0.18, wpb=17239.7, bsz=1024, num_updates=24520, lr=1.98346e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=161723
2024-11-11 07:40:35 - progress_bar.py[line:274] - INFO: epoch 063:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17297.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3166.7, ups=0.18, wpb=17297.9, bsz=1024, num_updates=24530, lr=1.9821e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=161778
2024-11-11 07:41:31 - progress_bar.py[line:274] - INFO: epoch 063:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17129.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3022.1, ups=0.18, wpb=17129.2, bsz=1024, num_updates=24540, lr=1.98074e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=161834
2024-11-11 07:42:30 - progress_bar.py[line:274] - INFO: epoch 063:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17274.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=2968.1, ups=0.17, wpb=17274.8, bsz=1024, num_updates=24550, lr=1.97938e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.2, wall=161893
2024-11-11 07:43:23 - progress_bar.py[line:274] - INFO: epoch 063:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17102.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3200, ups=0.19, wpb=17102.5, bsz=1024, num_updates=24560, lr=1.97802e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=161946
2024-11-11 07:44:18 - progress_bar.py[line:274] - INFO: epoch 063:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17272.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3121.4, ups=0.18, wpb=17272.1, bsz=1024, num_updates=24570, lr=1.97666e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=37, gb_free=13.3, wall=162001
2024-11-11 07:45:15 - progress_bar.py[line:274] - INFO: epoch 063:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.66, ntokens=17369.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3052.9, ups=0.18, wpb=17369.3, bsz=1024, num_updates=24580, lr=1.9753e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=48, gb_free=13.4, wall=162058
2024-11-11 07:46:07 - progress_bar.py[line:274] - INFO: epoch 063:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17173.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3335, ups=0.19, wpb=17173.7, bsz=1024, num_updates=24590, lr=1.97393e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=48, gb_free=13.5, wall=162110
2024-11-11 07:47:02 - progress_bar.py[line:274] - INFO: epoch 063:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17226.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3103.3, ups=0.18, wpb=17226.7, bsz=1024, num_updates=24600, lr=1.97257e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=45, gb_free=13.4, wall=162165
2024-11-11 07:47:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 63 @ 24604 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
2024-11-11 07:47:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 07:49:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-11 07:51:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 63 @ 24604 updates, score 0) (writing took 226.01841984904604 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-11 07:52:02 - train.py[line:336] - INFO: end of epoch 63 (average epoch stats below)
2024-11-11 07:52:02 - progress_bar.py[line:282] - INFO: epoch 063 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.649 | ntokens 17178 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.27 | wps 2534.7 | ups 0.15 | wpb 17178 | bsz 1023 | num_updates 24604 | lr 1.97203e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 2094 | gb_free 13.4 | wall 162465
2024-11-11 07:52:02 - trainer.py[line:639] - INFO: loading train data for epoch 64
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 07:54:43 - trainer.py[line:703] - INFO: begin training epoch 64
2024-11-11 07:54:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 07:55:19 - progress_bar.py[line:274] - INFO: epoch 064:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=16559.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=333.6, ups=0.02, wpb=16559.2, bsz=985.6, num_updates=24610, lr=1.97121e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=162662
2024-11-11 07:56:15 - progress_bar.py[line:274] - INFO: epoch 064:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17275.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3096.7, ups=0.18, wpb=17275.3, bsz=1024, num_updates=24620, lr=1.96985e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=162717
2024-11-11 07:57:11 - progress_bar.py[line:274] - INFO: epoch 064:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17282.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3081.2, ups=0.18, wpb=17282.1, bsz=1024, num_updates=24630, lr=1.96849e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=32, gb_free=13.3, wall=162774
2024-11-11 07:58:06 - progress_bar.py[line:274] - INFO: epoch 064:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3110.5, ups=0.18, wpb=17090.1, bsz=1024, num_updates=24640, lr=1.96713e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.5, wall=162829
2024-11-11 07:59:01 - progress_bar.py[line:274] - INFO: epoch 064:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17269.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3116.2, ups=0.18, wpb=17269.3, bsz=1024, num_updates=24650, lr=1.96577e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=12.9, wall=162884
2024-11-11 07:59:58 - progress_bar.py[line:274] - INFO: epoch 064:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17262.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3011.1, ups=0.17, wpb=17262.5, bsz=1024, num_updates=24660, lr=1.96441e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=48, gb_free=13.4, wall=162941
2024-11-11 08:00:57 - progress_bar.py[line:274] - INFO: epoch 064:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17098.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2935.1, ups=0.17, wpb=17098.7, bsz=1024, num_updates=24670, lr=1.96305e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.2, wall=163000
2024-11-11 08:01:54 - progress_bar.py[line:274] - INFO: epoch 064:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17166.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2968.7, ups=0.17, wpb=17166.3, bsz=1024, num_updates=24680, lr=1.96169e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=163057
2024-11-11 08:02:53 - progress_bar.py[line:274] - INFO: epoch 064:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17490.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3008.8, ups=0.17, wpb=17490.2, bsz=1024, num_updates=24690, lr=1.96033e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=163115
2024-11-11 08:03:50 - progress_bar.py[line:274] - INFO: epoch 064:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17014.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2969.5, ups=0.17, wpb=17014.4, bsz=1024, num_updates=24700, lr=1.95897e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=163173
2024-11-11 08:04:47 - progress_bar.py[line:274] - INFO: epoch 064:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17190.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3029.9, ups=0.18, wpb=17190.5, bsz=1024, num_updates=24710, lr=1.95761e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=163230
2024-11-11 08:05:44 - progress_bar.py[line:274] - INFO: epoch 064:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.673, ntokens=17228.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3023.6, ups=0.18, wpb=17228.2, bsz=1024, num_updates=24720, lr=1.95625e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=163286
2024-11-11 08:06:41 - progress_bar.py[line:274] - INFO: epoch 064:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17283.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3000.5, ups=0.17, wpb=17283.9, bsz=1024, num_updates=24730, lr=1.95489e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=163344
2024-11-11 08:07:40 - progress_bar.py[line:274] - INFO: epoch 064:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17127.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2937, ups=0.17, wpb=17127.5, bsz=1024, num_updates=24740, lr=1.95353e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=163402
2024-11-11 08:08:37 - progress_bar.py[line:274] - INFO: epoch 064:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=16981.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2952.3, ups=0.17, wpb=16981.6, bsz=1024, num_updates=24750, lr=1.95217e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=163460
2024-11-11 08:09:35 - progress_bar.py[line:274] - INFO: epoch 064:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17279.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3001.8, ups=0.17, wpb=17279.8, bsz=1024, num_updates=24760, lr=1.95081e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=163518
2024-11-11 08:10:32 - progress_bar.py[line:274] - INFO: epoch 064:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17223.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2985.7, ups=0.17, wpb=17223.8, bsz=1024, num_updates=24770, lr=1.94945e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=163575
2024-11-11 08:11:29 - progress_bar.py[line:274] - INFO: epoch 064:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17050.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3008.7, ups=0.18, wpb=17050.3, bsz=1024, num_updates=24780, lr=1.94809e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=163632
2024-11-11 08:12:26 - progress_bar.py[line:274] - INFO: epoch 064:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=16954.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2951.8, ups=0.17, wpb=16954.1, bsz=1024, num_updates=24790, lr=1.94673e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=163689
2024-11-11 08:13:24 - progress_bar.py[line:274] - INFO: epoch 064:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17145.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2998.1, ups=0.17, wpb=17145.5, bsz=1024, num_updates=24800, lr=1.94537e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=163746
2024-11-11 08:14:21 - progress_bar.py[line:274] - INFO: epoch 064:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17273.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=2984.3, ups=0.17, wpb=17273.7, bsz=1024, num_updates=24810, lr=1.94401e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=163804
2024-11-11 08:15:19 - progress_bar.py[line:274] - INFO: epoch 064:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17172.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2997.4, ups=0.17, wpb=17172.2, bsz=1024, num_updates=24820, lr=1.94265e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=163862
2024-11-11 08:16:16 - progress_bar.py[line:274] - INFO: epoch 064:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17488.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3038.1, ups=0.17, wpb=17488.1, bsz=1024, num_updates=24830, lr=1.94129e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=163919
2024-11-11 08:17:14 - progress_bar.py[line:274] - INFO: epoch 064:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17149.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2997.4, ups=0.17, wpb=17149.7, bsz=1024, num_updates=24840, lr=1.93992e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=163976
2024-11-11 08:18:11 - progress_bar.py[line:274] - INFO: epoch 064:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17102.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2961.4, ups=0.17, wpb=17102.3, bsz=1024, num_updates=24850, lr=1.93856e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=164034
2024-11-11 08:19:05 - progress_bar.py[line:274] - INFO: epoch 064:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17309.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3216.8, ups=0.19, wpb=17309.8, bsz=1024, num_updates=24860, lr=1.9372e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=49, gb_free=13.4, wall=164088
2024-11-11 08:20:04 - progress_bar.py[line:274] - INFO: epoch 064:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17281.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2954, ups=0.17, wpb=17281.1, bsz=1024, num_updates=24870, lr=1.93584e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.1, wall=164147
2024-11-11 08:21:02 - progress_bar.py[line:274] - INFO: epoch 064:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17062, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2924.5, ups=0.17, wpb=17062, bsz=1024, num_updates=24880, lr=1.93448e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=164205
2024-11-11 08:22:00 - progress_bar.py[line:274] - INFO: epoch 064:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17152.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2968.5, ups=0.17, wpb=17152.3, bsz=1024, num_updates=24890, lr=1.93312e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=164263
2024-11-11 08:22:58 - progress_bar.py[line:274] - INFO: epoch 064:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17181, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2956.6, ups=0.17, wpb=17181, bsz=1024, num_updates=24900, lr=1.93176e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=164321
2024-11-11 08:23:56 - progress_bar.py[line:274] - INFO: epoch 064:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17073.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2953.9, ups=0.17, wpb=17073.8, bsz=1024, num_updates=24910, lr=1.9304e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=164379
2024-11-11 08:24:54 - progress_bar.py[line:274] - INFO: epoch 064:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=16882.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2897, ups=0.17, wpb=16882.9, bsz=1024, num_updates=24920, lr=1.92904e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=164437
2024-11-11 08:25:51 - progress_bar.py[line:274] - INFO: epoch 064:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17064.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2970.8, ups=0.17, wpb=17064.1, bsz=1024, num_updates=24930, lr=1.92768e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=164494
2024-11-11 08:26:49 - progress_bar.py[line:274] - INFO: epoch 064:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17197.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2977, ups=0.17, wpb=17197.5, bsz=1024, num_updates=24940, lr=1.92632e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=164552
2024-11-11 08:27:47 - progress_bar.py[line:274] - INFO: epoch 064:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=16896.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2921.4, ups=0.17, wpb=16896.6, bsz=1024, num_updates=24950, lr=1.92496e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=164610
2024-11-11 08:28:45 - progress_bar.py[line:274] - INFO: epoch 064:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17156.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2947.4, ups=0.17, wpb=17156.7, bsz=1024, num_updates=24960, lr=1.9236e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=164668
2024-11-11 08:29:43 - progress_bar.py[line:274] - INFO: epoch 064:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17357.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3009.7, ups=0.17, wpb=17357.2, bsz=1024, num_updates=24970, lr=1.92224e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=164726
2024-11-11 08:30:41 - progress_bar.py[line:274] - INFO: epoch 064:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17227.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2983.6, ups=0.17, wpb=17227.8, bsz=1024, num_updates=24980, lr=1.92088e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=164783
2024-11-11 08:31:38 - progress_bar.py[line:274] - INFO: epoch 064:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=16969.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2938.1, ups=0.17, wpb=16969.4, bsz=1024, num_updates=24990, lr=1.91952e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=164841
2024-11-11 08:32:04 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 64 @ 24995 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
2024-11-11 08:32:04 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 08:33:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-11 08:35:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 64 @ 24995 updates, score 0) (writing took 226.0510436249897 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000

slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-11 08:36:45 - train.py[line:336] - INFO: end of epoch 64 (average epoch stats below)
2024-11-11 08:36:45 - progress_bar.py[line:282] - INFO: epoch 064 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.64 | ntokens 17152.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.23 | wps 2499.7 | ups 0.15 | wpb 17152.6 | bsz 1023 | num_updates 24995 | lr 1.91884e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2107 | gb_free 13.2 | wall 165148
2024-11-11 08:36:45 - trainer.py[line:639] - INFO: loading train data for epoch 65
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 08:39:27 - trainer.py[line:703] - INFO: begin training epoch 65
2024-11-11 08:39:27 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 08:39:56 - progress_bar.py[line:274] - INFO: epoch 065:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=16429.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=329.8, ups=0.02, wpb=16429.5, bsz=985.6, num_updates=25000, lr=1.91816e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=40, gb_free=12.9, wall=165339
loss_reg: 0.00700253659070194 loss_cls: 0.003641815623268485
loss_reg: 0.006190000231426199 loss_cls: 0.004355056211352348
loss_reg: 0.005812532529154448 loss_cls: 0.0030965530313551426
loss_reg: 0.006110224385524128 loss_cls: 0.004018509294837713
loss_reg: 0.004449481572422753 loss_cls: 0.0032731753308326006
loss_reg: 0.003832172392893975 loss_cls: 0.0026597471442073584
loss_reg: 0.007171454236333658 loss_cls: 0.00362945138476789
loss_reg: 0.0056722784809808136 loss_cls: 0.0034940920304507017
loss_reg: 0.004338166754037217 loss_cls: 0.0038236610125750303
loss_reg: 0.005039313798174917 loss_cls: 0.004126535728573799
loss_reg: 0.004801706565189427 loss_cls: 0.0035959628876298666loss_reg: 0.005815579263199148 loss_cls: 0.004317477345466614

loss_reg: 0.0057438477860649265 loss_cls: 0.004067266825586557
loss_reg: 0.005166374758010051 loss_cls: 0.003738313214853406
loss_reg: 0.006286697138896017 loss_cls: 0.0035857646726071835
loss_reg: 0.005630788377144697 loss_cls: 0.003791696159169078
loss_reg: 0.005664730292835917 loss_cls: 0.003179460298269987
loss_reg: 0.004602442950645792 loss_cls: 0.003834296017885208
loss_reg: 0.005367793274202717 loss_cls: 0.0037666712887585163
loss_reg: 0.004404660660418653 loss_cls: 0.0035364311188459396
loss_reg: 0.0064587046000909665 loss_cls: 0.004030317068099976
loss_reg: 0.005380850482211913 loss_cls: 0.0030413682106882334
loss_reg: 0.004442514121802532 loss_cls: 0.004447318147867918
loss_reg: 0.004318264645657606 loss_cls: 0.003630015067756176
loss_reg: 0.005414047542909001 loss_cls: 0.004958078730851412
loss_reg: 0.00501652787619923 loss_cls: 0.005101997405290604
loss_reg: 0.006222237417245882 loss_cls: 0.004103784915059805
loss_reg: 0.00428442044216241 loss_cls: 0.003264424856752157
loss_reg: 0.006799073852356296 loss_cls: 0.002843277994543314
loss_reg: 0.004942565830861578 loss_cls: 0.0032358109019696712
loss_reg: 0.007559201879621567 loss_cls: 0.0031207725405693054
loss_reg: 0.004960702990750489 loss_cls: 0.0035699144937098026
loss_reg: 0.007314745070684391 loss_cls: 0.0030180811882019043
loss_reg: 0.005531844158136138 loss_cls: 0.004013034049421549
loss_reg: 0.005917383315079123 loss_cls: 0.0040644253604114056
loss_reg: 0.004689522548791087 loss_cls: 0.003457876853644848
loss_reg: 0.005295029290079234 loss_cls: 0.004340942017734051
loss_reg: 0.005028957249377708 loss_cls: 0.0038529126904904842
loss_reg: 0.005753051239859492 loss_cls: 0.003513667266815901
loss_reg: 0.0054685895180354455 loss_cls: 0.003623400582000613
loss_reg: 0.005396015180283258 loss_cls: 0.003630904946476221
loss_reg: 0.006133949508643741 loss_cls: 0.00327814812771976
loss_reg: 0.007005245824571786 loss_cls: 0.0034343262668699026
loss_reg: 0.005186363570172033 loss_cls: 0.0028541069477796555
loss_reg: 0.007212323756327326 loss_cls: 0.003756298217922449
loss_reg: 0.006555455341338797 loss_cls: 0.004221220500767231
loss_reg: 0.008182993340241775 loss_cls: 0.002580146538093686
loss_reg: 0.008227013943447017 loss_cls: 0.003175213932991028
loss_reg: 0.007374441116972648 loss_cls: 0.0031979884952306747
loss_reg: 0.005195818842025952 loss_cls: 0.0035042818635702133
loss_reg: 0.0054755777946942 loss_cls: 0.0038707086350768805
loss_reg: 0.00550197925819516 loss_cls: 0.0034499403554946184
loss_reg: 0.004936441676172467 loss_cls: 0.004094919189810753
loss_reg: 0.0048547351649515045 loss_cls: 0.004418014083057642
loss_reg: 0.005054033607920854 loss_cls: 0.0038451377768069506
loss_reg: 0.005412731152106389 loss_cls: 0.0034597034100443125
loss_reg: 0.004833360016033147 loss_cls: 0.0036113921087235212
loss_reg: 0.005977668335037119 loss_cls: 0.004017699509859085
loss_reg: 0.0055489983988415165 loss_cls: 0.0028627589344978333
loss_reg: 0.005061968800766763 loss_cls: 0.004537335596978664
loss_reg: 0.0065986599362967266 loss_cls: 0.0034884114284068346
loss_reg: 0.005598046481759059 loss_cls: 0.0027666655369102955
loss_reg: 0.007829924725117343 loss_cls: 0.0030986126512289047
loss_reg: 0.005313192182206214 loss_cls: 0.0037970563862472773
2024-11-11 08:40:52 - progress_bar.py[line:274] - INFO: epoch 065:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17264.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3134.2, ups=0.18, wpb=17264.6, bsz=1024, num_updates=25010, lr=1.9168e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=165394
2024-11-11 08:41:47 - progress_bar.py[line:274] - INFO: epoch 065:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17170.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3094.5, ups=0.18, wpb=17170.1, bsz=1024, num_updates=25020, lr=1.91544e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=165450
2024-11-11 08:42:42 - progress_bar.py[line:274] - INFO: epoch 065:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17049.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3102, ups=0.18, wpb=17049.8, bsz=1024, num_updates=25030, lr=1.91408e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=165505
2024-11-11 08:43:37 - progress_bar.py[line:274] - INFO: epoch 065:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17167.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3093.2, ups=0.18, wpb=17167.4, bsz=1024, num_updates=25040, lr=1.91272e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=165560
2024-11-11 08:44:33 - progress_bar.py[line:274] - INFO: epoch 065:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17088.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3082.1, ups=0.18, wpb=17088.8, bsz=1024, num_updates=25050, lr=1.91136e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=165616
2024-11-11 08:45:30 - progress_bar.py[line:274] - INFO: epoch 065:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17241.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3017.2, ups=0.17, wpb=17241.9, bsz=1024, num_updates=25060, lr=1.91e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=41, gb_free=13.3, wall=165673
2024-11-11 08:46:27 - progress_bar.py[line:274] - INFO: epoch 065:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17201.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3003.3, ups=0.17, wpb=17201.1, bsz=1024, num_updates=25070, lr=1.90864e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=165730
2024-11-11 08:47:25 - progress_bar.py[line:274] - INFO: epoch 065:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17428.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.32, wps=3034, ups=0.17, wpb=17428.9, bsz=1024, num_updates=25080, lr=1.90728e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=165788
2024-11-11 08:48:22 - progress_bar.py[line:274] - INFO: epoch 065:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17047.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2977.9, ups=0.17, wpb=17047.1, bsz=1024, num_updates=25090, lr=1.90592e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=165845
2024-11-11 08:49:20 - progress_bar.py[line:274] - INFO: epoch 065:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17257.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3001.7, ups=0.17, wpb=17257.6, bsz=1024, num_updates=25100, lr=1.90455e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=165902
2024-11-11 08:50:16 - progress_bar.py[line:274] - INFO: epoch 065:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17137.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3014.3, ups=0.18, wpb=17137.9, bsz=1024, num_updates=25110, lr=1.90319e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=165959
2024-11-11 08:51:13 - progress_bar.py[line:274] - INFO: epoch 065:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17284.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3041.5, ups=0.18, wpb=17284.1, bsz=1024, num_updates=25120, lr=1.90183e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=166016
2024-11-11 08:51:53 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-11 08:52:16 - progress_bar.py[line:274] - INFO: epoch 065:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17133.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=2737, ups=0.16, wpb=17133.1, bsz=1024, num_updates=25130, lr=1.90047e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=62, gb_free=13.1, wall=166079
2024-11-11 08:53:13 - progress_bar.py[line:274] - INFO: epoch 065:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17148.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3008, ups=0.18, wpb=17148.4, bsz=1024, num_updates=25140, lr=1.89911e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=166136
2024-11-11 08:54:06 - progress_bar.py[line:274] - INFO: epoch 065:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17196.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3206.1, ups=0.19, wpb=17196.6, bsz=1024, num_updates=25150, lr=1.89775e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=166189
2024-11-11 08:55:04 - progress_bar.py[line:274] - INFO: epoch 065:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=16893.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2922.2, ups=0.17, wpb=16893.1, bsz=1024, num_updates=25160, lr=1.89639e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=166247
2024-11-11 08:56:02 - progress_bar.py[line:274] - INFO: epoch 065:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17286.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=2979.6, ups=0.17, wpb=17286.1, bsz=1024, num_updates=25170, lr=1.89503e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=166305
2024-11-11 08:56:59 - progress_bar.py[line:274] - INFO: epoch 065:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=16989.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3001.1, ups=0.18, wpb=16989.4, bsz=1024, num_updates=25180, lr=1.89367e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=166362
2024-11-11 08:57:51 - progress_bar.py[line:274] - INFO: epoch 065:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17230.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3312.3, ups=0.19, wpb=17230.1, bsz=1024, num_updates=25190, lr=1.89231e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=44, gb_free=13.5, wall=166414
2024-11-11 08:58:46 - progress_bar.py[line:274] - INFO: epoch 065:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17070.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3103.7, ups=0.18, wpb=17070.6, bsz=1024, num_updates=25200, lr=1.89095e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=166469
2024-11-11 08:59:42 - progress_bar.py[line:274] - INFO: epoch 065:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=16815.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2990.7, ups=0.18, wpb=16815.1, bsz=1024, num_updates=25210, lr=1.88959e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=166525
2024-11-11 09:00:39 - progress_bar.py[line:274] - INFO: epoch 065:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=16993.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2964.5, ups=0.17, wpb=16993.2, bsz=1024, num_updates=25220, lr=1.88823e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=46, gb_free=13.5, wall=166582
2024-11-11 09:01:36 - progress_bar.py[line:274] - INFO: epoch 065:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17159.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3024.8, ups=0.18, wpb=17159.1, bsz=1024, num_updates=25230, lr=1.88687e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=166639
2024-11-11 09:02:34 - progress_bar.py[line:274] - INFO: epoch 065:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17354, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3009.8, ups=0.17, wpb=17354, bsz=1024, num_updates=25240, lr=1.88551e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=166697
2024-11-11 09:03:31 - progress_bar.py[line:274] - INFO: epoch 065:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17223.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3018.8, ups=0.18, wpb=17223.3, bsz=1024, num_updates=25250, lr=1.88415e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=166754
2024-11-11 09:03:53 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 09:04:34 - progress_bar.py[line:274] - INFO: epoch 065:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17082.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2718.7, ups=0.16, wpb=17082.9, bsz=1024, num_updates=25260, lr=1.88279e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=63, gb_free=13.4, wall=166817
2024-11-11 09:05:30 - progress_bar.py[line:274] - INFO: epoch 065:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17059.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3023.3, ups=0.18, wpb=17059.4, bsz=1024, num_updates=25270, lr=1.88143e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=166873
2024-11-11 09:06:28 - progress_bar.py[line:274] - INFO: epoch 065:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17180.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2974.1, ups=0.17, wpb=17180.9, bsz=1024, num_updates=25280, lr=1.88007e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=166931
2024-11-11 09:07:26 - progress_bar.py[line:274] - INFO: epoch 065:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17348.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3010, ups=0.17, wpb=17348.5, bsz=1024, num_updates=25290, lr=1.87871e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13, wall=166988
2024-11-11 09:08:23 - progress_bar.py[line:274] - INFO: epoch 065:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17337.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=2998, ups=0.17, wpb=17337.2, bsz=1024, num_updates=25300, lr=1.87735e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=167046
2024-11-11 09:09:20 - progress_bar.py[line:274] - INFO: epoch 065:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17179.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3027.8, ups=0.18, wpb=17179.5, bsz=1024, num_updates=25310, lr=1.87599e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=167103
2024-11-11 09:10:17 - progress_bar.py[line:274] - INFO: epoch 065:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17154.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2994.7, ups=0.17, wpb=17154.6, bsz=1024, num_updates=25320, lr=1.87463e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=167160
2024-11-11 09:11:14 - progress_bar.py[line:274] - INFO: epoch 065:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17314, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3047, ups=0.18, wpb=17314, bsz=1024, num_updates=25330, lr=1.87327e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=167217
2024-11-11 09:12:07 - progress_bar.py[line:274] - INFO: epoch 065:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.632, ntokens=17117.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3219.2, ups=0.19, wpb=17117.4, bsz=1024, num_updates=25340, lr=1.87191e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=51, gb_free=13.1, wall=167270
2024-11-11 09:13:01 - progress_bar.py[line:274] - INFO: epoch 065:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17193.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3200.3, ups=0.19, wpb=17193.9, bsz=1024, num_updates=25350, lr=1.87054e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=37, gb_free=13.2, wall=167324
2024-11-11 09:13:57 - progress_bar.py[line:274] - INFO: epoch 065:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17504.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3132.2, ups=0.18, wpb=17504.1, bsz=1024, num_updates=25360, lr=1.86918e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.2, wall=167380
2024-11-11 09:14:51 - progress_bar.py[line:274] - INFO: epoch 065:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.661, ntokens=17246.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3187.6, ups=0.18, wpb=17246.4, bsz=1024, num_updates=25370, lr=1.86782e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=167434
2024-11-11 09:15:46 - progress_bar.py[line:274] - INFO: epoch 065:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17050.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3119.5, ups=0.18, wpb=17050.1, bsz=1024, num_updates=25380, lr=1.86646e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=36, gb_free=13.5, wall=167489
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
2024-11-11 09:16:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 65 @ 25384 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
2024-11-11 09:16:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 09:17:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 09:19:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 65 @ 25384 updates, score 0) (writing took 227.11589588201605 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 09:20:48 - train.py[line:336] - INFO: end of epoch 65 (average epoch stats below)
2024-11-11 09:20:48 - progress_bar.py[line:282] - INFO: epoch 065 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.639 | ntokens 17156 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.23 | wps 2524.9 | ups 0.15 | wpb 17156 | bsz 1023 | num_updates 25384 | lr 1.86592e-05 | gnorm 0.004 | clip 0 | loss_scale 32768 | train_wall 1899 | gb_free 13.3 | wall 167791
2024-11-11 09:20:48 - trainer.py[line:639] - INFO: loading train data for epoch 66
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 09:23:30 - trainer.py[line:703] - INFO: begin training epoch 66
2024-11-11 09:23:30 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 09:24:05 - progress_bar.py[line:274] - INFO: epoch 066:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=16510, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=330.4, ups=0.02, wpb=16510, bsz=985.6, num_updates=25390, lr=1.8651e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=167988
2024-11-11 09:25:02 - progress_bar.py[line:274] - INFO: epoch 066:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3073.8, ups=0.18, wpb=17298.6, bsz=1024, num_updates=25400, lr=1.86374e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=168045
2024-11-11 09:25:58 - progress_bar.py[line:274] - INFO: epoch 066:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17351.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3096.4, ups=0.18, wpb=17351.5, bsz=1024, num_updates=25410, lr=1.86238e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=168101
2024-11-11 09:26:54 - progress_bar.py[line:274] - INFO: epoch 066:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17015.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3018.8, ups=0.18, wpb=17015.7, bsz=1024, num_updates=25420, lr=1.86102e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=168157
2024-11-11 09:27:51 - progress_bar.py[line:274] - INFO: epoch 066:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.675, ntokens=17328, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3069.7, ups=0.18, wpb=17328, bsz=1024, num_updates=25430, lr=1.85966e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=168214
2024-11-11 09:28:48 - progress_bar.py[line:274] - INFO: epoch 066:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17105, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2960.7, ups=0.17, wpb=17105, bsz=1024, num_updates=25440, lr=1.8583e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=46, gb_free=13.4, wall=168271
2024-11-11 09:29:46 - progress_bar.py[line:274] - INFO: epoch 066:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=16737.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2927.8, ups=0.17, wpb=16737.4, bsz=1024, num_updates=25450, lr=1.85694e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.5, wall=168328
2024-11-11 09:30:44 - progress_bar.py[line:274] - INFO: epoch 066:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17024.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2924.5, ups=0.17, wpb=17024.7, bsz=1024, num_updates=25460, lr=1.85558e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=168387
2024-11-11 09:31:41 - progress_bar.py[line:274] - INFO: epoch 066:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.681, ntokens=17523.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.41, wps=3042, ups=0.17, wpb=17523.3, bsz=1024, num_updates=25470, lr=1.85422e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=168444
2024-11-11 09:32:39 - progress_bar.py[line:274] - INFO: epoch 066:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=16995.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2931.7, ups=0.17, wpb=16995.1, bsz=1024, num_updates=25480, lr=1.85286e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=168502
2024-11-11 09:33:36 - progress_bar.py[line:274] - INFO: epoch 066:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17314.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3032.8, ups=0.18, wpb=17314.8, bsz=1024, num_updates=25490, lr=1.8515e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=168559
2024-11-11 09:34:33 - progress_bar.py[line:274] - INFO: epoch 066:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17166.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3029.8, ups=0.18, wpb=17166.6, bsz=1024, num_updates=25500, lr=1.85014e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=168616
2024-11-11 09:35:31 - progress_bar.py[line:274] - INFO: epoch 066:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17317.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3009.4, ups=0.17, wpb=17317.8, bsz=1024, num_updates=25510, lr=1.84878e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.1, wall=168674
2024-11-11 09:36:28 - progress_bar.py[line:274] - INFO: epoch 066:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17126.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2964.5, ups=0.17, wpb=17126.2, bsz=1024, num_updates=25520, lr=1.84742e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=168731
2024-11-11 09:37:27 - progress_bar.py[line:274] - INFO: epoch 066:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17082.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2937.7, ups=0.17, wpb=17082.8, bsz=1024, num_updates=25530, lr=1.84606e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=168789
2024-11-11 09:38:25 - progress_bar.py[line:274] - INFO: epoch 066:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17425.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2961.3, ups=0.17, wpb=17425.1, bsz=1024, num_updates=25540, lr=1.8447e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=168848
2024-11-11 09:39:23 - progress_bar.py[line:274] - INFO: epoch 066:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17197.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2987.6, ups=0.17, wpb=17197.8, bsz=1024, num_updates=25550, lr=1.84334e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=168906
2024-11-11 09:40:21 - progress_bar.py[line:274] - INFO: epoch 066:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17220.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2982.6, ups=0.17, wpb=17220.5, bsz=1024, num_updates=25560, lr=1.84198e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=168964
2024-11-11 09:41:19 - progress_bar.py[line:274] - INFO: epoch 066:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=16855.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2904.8, ups=0.17, wpb=16855.7, bsz=1024, num_updates=25570, lr=1.84062e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=169022
2024-11-11 09:42:15 - progress_bar.py[line:274] - INFO: epoch 066:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17015.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3047.4, ups=0.18, wpb=17015.7, bsz=1024, num_updates=25580, lr=1.83926e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=169077
2024-11-11 09:43:09 - progress_bar.py[line:274] - INFO: epoch 066:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17232.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3141.1, ups=0.18, wpb=17232.4, bsz=1024, num_updates=25590, lr=1.8379e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=46, gb_free=13.3, wall=169132
2024-11-11 09:44:07 - progress_bar.py[line:274] - INFO: epoch 066:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17223.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2983.3, ups=0.17, wpb=17223.1, bsz=1024, num_updates=25600, lr=1.83653e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=169190
2024-11-11 09:45:04 - progress_bar.py[line:274] - INFO: epoch 066:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17132.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2990.6, ups=0.17, wpb=17132.6, bsz=1024, num_updates=25610, lr=1.83517e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=169247
2024-11-11 09:45:59 - progress_bar.py[line:274] - INFO: epoch 066:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=16896.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3076.2, ups=0.18, wpb=16896.1, bsz=1024, num_updates=25620, lr=1.83381e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=13.3, wall=169302
2024-11-11 09:46:58 - progress_bar.py[line:274] - INFO: epoch 066:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17225.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=2927.6, ups=0.17, wpb=17225.8, bsz=1024, num_updates=25630, lr=1.83245e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=169361
2024-11-11 09:47:56 - progress_bar.py[line:274] - INFO: epoch 066:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17224.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2972.2, ups=0.17, wpb=17224.2, bsz=1024, num_updates=25640, lr=1.83109e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=169419
2024-11-11 09:48:54 - progress_bar.py[line:274] - INFO: epoch 066:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17164.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2962.9, ups=0.17, wpb=17164.7, bsz=1024, num_updates=25650, lr=1.82973e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=169477
2024-11-11 09:49:53 - progress_bar.py[line:274] - INFO: epoch 066:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17178.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2941.1, ups=0.17, wpb=17178.2, bsz=1024, num_updates=25660, lr=1.82837e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=169535
2024-11-11 09:50:50 - progress_bar.py[line:274] - INFO: epoch 066:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17298.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3012, ups=0.17, wpb=17298.5, bsz=1024, num_updates=25670, lr=1.82701e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.1, wall=169593
2024-11-11 09:51:48 - progress_bar.py[line:274] - INFO: epoch 066:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17239.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2958.5, ups=0.17, wpb=17239.3, bsz=1024, num_updates=25680, lr=1.82565e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=169651
2024-11-11 09:52:46 - progress_bar.py[line:274] - INFO: epoch 066:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17187.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=2950.9, ups=0.17, wpb=17187.3, bsz=1024, num_updates=25690, lr=1.82429e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=169709
2024-11-11 09:53:45 - progress_bar.py[line:274] - INFO: epoch 066:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=16967.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2920.2, ups=0.17, wpb=16967.2, bsz=1024, num_updates=25700, lr=1.82293e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=169767
2024-11-11 09:54:43 - progress_bar.py[line:274] - INFO: epoch 066:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17143.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2943.1, ups=0.17, wpb=17143.7, bsz=1024, num_updates=25710, lr=1.82157e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=169826
2024-11-11 09:55:41 - progress_bar.py[line:274] - INFO: epoch 066:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17429.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=2993.9, ups=0.17, wpb=17429.9, bsz=1024, num_updates=25720, lr=1.82021e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=169884
2024-11-11 09:56:39 - progress_bar.py[line:274] - INFO: epoch 066:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17177, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2949.5, ups=0.17, wpb=17177, bsz=1024, num_updates=25730, lr=1.81885e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=169942
2024-11-11 09:57:37 - progress_bar.py[line:274] - INFO: epoch 066:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17436.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3012.6, ups=0.17, wpb=17436.8, bsz=1024, num_updates=25740, lr=1.81749e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=170000
2024-11-11 09:58:35 - progress_bar.py[line:274] - INFO: epoch 066:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17353.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2982, ups=0.17, wpb=17353.2, bsz=1024, num_updates=25750, lr=1.81613e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=170058
2024-11-11 09:59:33 - progress_bar.py[line:274] - INFO: epoch 066:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17246.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3011.7, ups=0.17, wpb=17246.4, bsz=1024, num_updates=25760, lr=1.81477e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=170116
2024-11-11 10:00:30 - progress_bar.py[line:274] - INFO: epoch 066:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.69, ntokens=17350.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.45, wps=3018.1, ups=0.17, wpb=17350.3, bsz=1024, num_updates=25770, lr=1.81341e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=170173
2024-11-11 10:00:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 66 @ 25775 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
2024-11-11 10:00:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 10:02:48 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-11 10:04:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 66 @ 25775 updates, score 0) (writing took 225.95373915100936 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-11 10:05:36 - train.py[line:336] - INFO: end of epoch 66 (average epoch stats below)
2024-11-11 10:05:36 - progress_bar.py[line:282] - INFO: epoch 066 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.638 | ntokens 17172.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.23 | wps 2497.6 | ups 0.15 | wpb 17172.1 | bsz 1023 | num_updates 25775 | lr 1.81273e-05 | gnorm 0.005 | clip 0 | loss_scale 65536 | train_wall 2088 | gb_free 13.2 | wall 170479
2024-11-11 10:05:36 - trainer.py[line:639] - INFO: loading train data for epoch 67
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 10:08:18 - trainer.py[line:703] - INFO: begin training epoch 67
2024-11-11 10:08:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 10:08:48 - progress_bar.py[line:274] - INFO: epoch 067:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=16359.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=328.3, ups=0.02, wpb=16359.6, bsz=985.6, num_updates=25780, lr=1.81205e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=40, gb_free=13.3, wall=170671
2024-11-11 10:09:44 - progress_bar.py[line:274] - INFO: epoch 067:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17226.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3113.8, ups=0.18, wpb=17226.1, bsz=1024, num_updates=25790, lr=1.81069e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=170727
2024-11-11 10:10:40 - progress_bar.py[line:274] - INFO: epoch 067:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17410.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3110.8, ups=0.18, wpb=17410.1, bsz=1024, num_updates=25800, lr=1.80933e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.2, wall=170783
2024-11-11 10:11:36 - progress_bar.py[line:274] - INFO: epoch 067:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17131.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3039.9, ups=0.18, wpb=17131.8, bsz=1024, num_updates=25810, lr=1.80797e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=170839
2024-11-11 10:12:32 - progress_bar.py[line:274] - INFO: epoch 067:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17271.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3068.9, ups=0.18, wpb=17271.3, bsz=1024, num_updates=25820, lr=1.80661e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=170895
2024-11-11 10:12:54 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 10:13:33 - progress_bar.py[line:274] - INFO: epoch 067:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17403.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2859.3, ups=0.16, wpb=17403.6, bsz=1024, num_updates=25830, lr=1.80525e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=170956
2024-11-11 10:14:28 - progress_bar.py[line:274] - INFO: epoch 067:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17003.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3091, ups=0.18, wpb=17003.4, bsz=1024, num_updates=25840, lr=1.80389e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=171011
2024-11-11 10:15:25 - progress_bar.py[line:274] - INFO: epoch 067:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.654, ntokens=17299.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3066.8, ups=0.18, wpb=17299.6, bsz=1024, num_updates=25850, lr=1.80252e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=171067
2024-11-11 10:16:21 - progress_bar.py[line:274] - INFO: epoch 067:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.642, ntokens=17276.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3070.6, ups=0.18, wpb=17276.6, bsz=1024, num_updates=25860, lr=1.80116e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=171124
2024-11-11 10:17:17 - progress_bar.py[line:274] - INFO: epoch 067:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17074.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3023.4, ups=0.18, wpb=17074.6, bsz=1024, num_updates=25870, lr=1.7998e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=171180
2024-11-11 10:18:14 - progress_bar.py[line:274] - INFO: epoch 067:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17175.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3041.8, ups=0.18, wpb=17175.2, bsz=1024, num_updates=25880, lr=1.79844e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=171237
2024-11-11 10:19:12 - progress_bar.py[line:274] - INFO: epoch 067:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=16966.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2932.7, ups=0.17, wpb=16966.5, bsz=1024, num_updates=25890, lr=1.79708e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=37, gb_free=13.5, wall=171295
2024-11-11 10:20:07 - progress_bar.py[line:274] - INFO: epoch 067:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17346.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3121.2, ups=0.18, wpb=17346.2, bsz=1024, num_updates=25900, lr=1.79572e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=171350
2024-11-11 10:21:03 - progress_bar.py[line:274] - INFO: epoch 067:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17133.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3044.5, ups=0.18, wpb=17133.9, bsz=1024, num_updates=25910, lr=1.79436e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=171406
2024-11-11 10:22:01 - progress_bar.py[line:274] - INFO: epoch 067:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17102.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2977.6, ups=0.17, wpb=17102.4, bsz=1024, num_updates=25920, lr=1.793e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=171464
2024-11-11 10:22:59 - progress_bar.py[line:274] - INFO: epoch 067:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17286.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2983.1, ups=0.17, wpb=17286.5, bsz=1024, num_updates=25930, lr=1.79164e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=171522
2024-11-11 10:23:56 - progress_bar.py[line:274] - INFO: epoch 067:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17054.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2969.4, ups=0.17, wpb=17054.1, bsz=1024, num_updates=25940, lr=1.79028e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=171579
2024-11-11 10:24:54 - progress_bar.py[line:274] - INFO: epoch 067:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17109.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2965.5, ups=0.17, wpb=17109.1, bsz=1024, num_updates=25950, lr=1.78892e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=171637
2024-11-11 10:25:51 - progress_bar.py[line:274] - INFO: epoch 067:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=16811.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2931.6, ups=0.17, wpb=16811.6, bsz=1024, num_updates=25960, lr=1.78756e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=171694
2024-11-11 10:26:50 - progress_bar.py[line:274] - INFO: epoch 067:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17374.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2970, ups=0.17, wpb=17374.7, bsz=1024, num_updates=25970, lr=1.7862e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=171753
2024-11-11 10:27:48 - progress_bar.py[line:274] - INFO: epoch 067:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.666, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=2946.5, ups=0.17, wpb=17165.4, bsz=1024, num_updates=25980, lr=1.78484e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=12.8, wall=171811
2024-11-11 10:28:47 - progress_bar.py[line:274] - INFO: epoch 067:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17172.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2930.1, ups=0.17, wpb=17172.6, bsz=1024, num_updates=25990, lr=1.78348e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=171870
2024-11-11 10:29:45 - progress_bar.py[line:274] - INFO: epoch 067:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=16984, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2923.5, ups=0.17, wpb=16984, bsz=1024, num_updates=26000, lr=1.78212e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=171928
2024-11-11 10:30:43 - progress_bar.py[line:274] - INFO: epoch 067:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=16994, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2923.7, ups=0.17, wpb=16994, bsz=1024, num_updates=26010, lr=1.78076e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=171986
2024-11-11 10:31:41 - progress_bar.py[line:274] - INFO: epoch 067:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17110.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2940.6, ups=0.17, wpb=17110.2, bsz=1024, num_updates=26020, lr=1.7794e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=12.8, wall=172044
2024-11-11 10:32:38 - progress_bar.py[line:274] - INFO: epoch 067:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17089.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2987.5, ups=0.17, wpb=17089.5, bsz=1024, num_updates=26030, lr=1.77804e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=172101
2024-11-11 10:33:37 - progress_bar.py[line:274] - INFO: epoch 067:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.655, ntokens=17335.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=2956.6, ups=0.17, wpb=17335.4, bsz=1024, num_updates=26040, lr=1.77668e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.1, wall=172160
2024-11-11 10:34:32 - progress_bar.py[line:274] - INFO: epoch 067:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17241.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3146.1, ups=0.18, wpb=17241.8, bsz=1024, num_updates=26050, lr=1.77532e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=172215
2024-11-11 10:35:27 - progress_bar.py[line:274] - INFO: epoch 067:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17095.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3092.3, ups=0.18, wpb=17095.1, bsz=1024, num_updates=26060, lr=1.77396e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=47, gb_free=13.3, wall=172270
2024-11-11 10:36:24 - progress_bar.py[line:274] - INFO: epoch 067:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.656, ntokens=17293.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.3, wps=3011.9, ups=0.17, wpb=17293.2, bsz=1024, num_updates=26070, lr=1.7726e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=172327
2024-11-11 10:37:22 - progress_bar.py[line:274] - INFO: epoch 067:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17118.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2953.4, ups=0.17, wpb=17118.2, bsz=1024, num_updates=26080, lr=1.77124e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=172385
2024-11-11 10:38:21 - progress_bar.py[line:274] - INFO: epoch 067:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17036.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2906.2, ups=0.17, wpb=17036.6, bsz=1024, num_updates=26090, lr=1.76988e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13, wall=172444
2024-11-11 10:39:19 - progress_bar.py[line:274] - INFO: epoch 067:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17190.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2975.3, ups=0.17, wpb=17190.7, bsz=1024, num_updates=26100, lr=1.76851e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=172502
2024-11-11 10:40:17 - progress_bar.py[line:274] - INFO: epoch 067:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.667, ntokens=17450.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.35, wps=3014.7, ups=0.17, wpb=17450.1, bsz=1024, num_updates=26110, lr=1.76715e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=172560
2024-11-11 10:41:14 - progress_bar.py[line:274] - INFO: epoch 067:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17190.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3018.7, ups=0.18, wpb=17190.6, bsz=1024, num_updates=26120, lr=1.76579e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.2, wall=172617
2024-11-11 10:42:12 - progress_bar.py[line:274] - INFO: epoch 067:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=16964.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2886.2, ups=0.17, wpb=16964.3, bsz=1024, num_updates=26130, lr=1.76443e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=172675
2024-11-11 10:43:10 - progress_bar.py[line:274] - INFO: epoch 067:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17539.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3021.5, ups=0.17, wpb=17539.2, bsz=1024, num_updates=26140, lr=1.76307e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=172733
2024-11-11 10:44:10 - progress_bar.py[line:274] - INFO: epoch 067:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.651, ntokens=17410.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2941.1, ups=0.17, wpb=17410.8, bsz=1024, num_updates=26150, lr=1.76171e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=172793
2024-11-11 10:45:07 - progress_bar.py[line:274] - INFO: epoch 067:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=16991.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2948.6, ups=0.17, wpb=16991.8, bsz=1024, num_updates=26160, lr=1.76035e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=172850
2024-11-11 10:45:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 67 @ 26165 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt


2024-11-11 10:45:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 10:47:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 10:49:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 67 @ 26165 updates, score 0) (writing took 223.73818635899806 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 10:50:10 - train.py[line:336] - INFO: end of epoch 67 (average epoch stats below)
2024-11-11 10:50:10 - progress_bar.py[line:282] - INFO: epoch 067 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.633 | ntokens 17161 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.2 | wps 2502.9 | ups 0.15 | wpb 17161 | bsz 1023 | num_updates 26165 | lr 1.75967e-05 | gnorm 0.004 | clip 0 | loss_scale 32768 | train_wall 1836 | gb_free 13.1 | wall 173153
2024-11-11 10:50:10 - trainer.py[line:639] - INFO: loading train data for epoch 68
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 10:52:52 - trainer.py[line:703] - INFO: begin training epoch 68
2024-11-11 10:52:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 10:53:22 - progress_bar.py[line:274] - INFO: epoch 068:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=16527.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=334.1, ups=0.02, wpb=16527.7, bsz=985.6, num_updates=26170, lr=1.75899e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=39, gb_free=13.2, wall=173345
2024-11-11 10:54:18 - progress_bar.py[line:274] - INFO: epoch 068:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.678, ntokens=17447.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.4, wps=3109.3, ups=0.18, wpb=17447.2, bsz=1024, num_updates=26180, lr=1.75763e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=173401
2024-11-11 10:55:13 - progress_bar.py[line:274] - INFO: epoch 068:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17223.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3118.4, ups=0.18, wpb=17223.5, bsz=1024, num_updates=26190, lr=1.75627e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=173456
2024-11-11 10:56:09 - progress_bar.py[line:274] - INFO: epoch 068:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17248.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3095.3, ups=0.18, wpb=17248.3, bsz=1024, num_updates=26200, lr=1.75491e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=173512
2024-11-11 10:57:06 - progress_bar.py[line:274] - INFO: epoch 068:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=16984.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2994.5, ups=0.18, wpb=16984.1, bsz=1024, num_updates=26210, lr=1.75355e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=33, gb_free=13.4, wall=173569
2024-11-11 10:58:04 - progress_bar.py[line:274] - INFO: epoch 068:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17186.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2940.8, ups=0.17, wpb=17186.6, bsz=1024, num_updates=26220, lr=1.75219e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=40, gb_free=13.3, wall=173627
2024-11-11 10:59:00 - progress_bar.py[line:274] - INFO: epoch 068:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17030.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3066.1, ups=0.18, wpb=17030.3, bsz=1024, num_updates=26230, lr=1.75083e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=50, gb_free=13.3, wall=173683
2024-11-11 10:59:57 - progress_bar.py[line:274] - INFO: epoch 068:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=16985.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2971.5, ups=0.17, wpb=16985.7, bsz=1024, num_updates=26240, lr=1.74947e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=173740
2024-11-11 11:00:54 - progress_bar.py[line:274] - INFO: epoch 068:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17385.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3024.9, ups=0.17, wpb=17385.7, bsz=1024, num_updates=26250, lr=1.74811e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=173797
2024-11-11 11:01:52 - progress_bar.py[line:274] - INFO: epoch 068:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17159.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2969.8, ups=0.17, wpb=17159.1, bsz=1024, num_updates=26260, lr=1.74675e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=173855
2024-11-11 11:02:51 - progress_bar.py[line:274] - INFO: epoch 068:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17353.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2961.1, ups=0.17, wpb=17353.8, bsz=1024, num_updates=26270, lr=1.74539e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=173914
2024-11-11 11:03:48 - progress_bar.py[line:274] - INFO: epoch 068:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17141.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3010.8, ups=0.18, wpb=17141.9, bsz=1024, num_updates=26280, lr=1.74403e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=173971
2024-11-11 11:04:45 - progress_bar.py[line:274] - INFO: epoch 068:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.665, ntokens=17496.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3045.6, ups=0.17, wpb=17496.5, bsz=1024, num_updates=26290, lr=1.74267e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=174028
2024-11-11 11:05:41 - progress_bar.py[line:274] - INFO: epoch 068:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17299.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3095.6, ups=0.18, wpb=17299.6, bsz=1024, num_updates=26300, lr=1.74131e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=174084
2024-11-11 11:06:35 - progress_bar.py[line:274] - INFO: epoch 068:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=16760.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3129.2, ups=0.19, wpb=16760.4, bsz=1024, num_updates=26310, lr=1.73995e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=12.9, wall=174137
2024-11-11 11:07:30 - progress_bar.py[line:274] - INFO: epoch 068:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17095.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3067, ups=0.18, wpb=17095.1, bsz=1024, num_updates=26320, lr=1.73859e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=174193
2024-11-11 11:08:27 - progress_bar.py[line:274] - INFO: epoch 068:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17026.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3024.4, ups=0.18, wpb=17026.2, bsz=1024, num_updates=26330, lr=1.73723e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=174250
2024-11-11 11:09:22 - progress_bar.py[line:274] - INFO: epoch 068:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17018.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3045.8, ups=0.18, wpb=17018.9, bsz=1024, num_updates=26340, lr=1.73587e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=32, gb_free=13.3, wall=174305
2024-11-11 11:10:19 - progress_bar.py[line:274] - INFO: epoch 068:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17209, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3063.5, ups=0.18, wpb=17209, bsz=1024, num_updates=26350, lr=1.73451e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=12.8, wall=174362
2024-11-11 11:11:16 - progress_bar.py[line:274] - INFO: epoch 068:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17092.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2984.4, ups=0.17, wpb=17092.4, bsz=1024, num_updates=26360, lr=1.73314e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=33, gb_free=13.3, wall=174419
2024-11-11 11:12:14 - progress_bar.py[line:274] - INFO: epoch 068:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2943.1, ups=0.17, wpb=17102.7, bsz=1024, num_updates=26370, lr=1.73178e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=174477
2024-11-11 11:13:13 - progress_bar.py[line:274] - INFO: epoch 068:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=16953, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2897.1, ups=0.17, wpb=16953, bsz=1024, num_updates=26380, lr=1.73042e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=174535
2024-11-11 11:14:11 - progress_bar.py[line:274] - INFO: epoch 068:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17091.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2921.5, ups=0.17, wpb=17091.8, bsz=1024, num_updates=26390, lr=1.72906e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=174594
2024-11-11 11:15:09 - progress_bar.py[line:274] - INFO: epoch 068:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17277.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2960.7, ups=0.17, wpb=17277.3, bsz=1024, num_updates=26400, lr=1.7277e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.2, wall=174652
2024-11-11 11:16:07 - progress_bar.py[line:274] - INFO: epoch 068:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2979.5, ups=0.17, wpb=17165.4, bsz=1024, num_updates=26410, lr=1.72634e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=174710
2024-11-11 11:17:05 - progress_bar.py[line:274] - INFO: epoch 068:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17390, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3004.7, ups=0.17, wpb=17390, bsz=1024, num_updates=26420, lr=1.72498e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=174768
2024-11-11 11:18:03 - progress_bar.py[line:274] - INFO: epoch 068:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17292.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=2979.7, ups=0.17, wpb=17292.1, bsz=1024, num_updates=26430, lr=1.72362e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=174826
2024-11-11 11:19:01 - progress_bar.py[line:274] - INFO: epoch 068:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17029, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2921.9, ups=0.17, wpb=17029, bsz=1024, num_updates=26440, lr=1.72226e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=174884
2024-11-11 11:19:59 - progress_bar.py[line:274] - INFO: epoch 068:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17114.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2949.3, ups=0.17, wpb=17114.2, bsz=1024, num_updates=26450, lr=1.7209e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=174942
2024-11-11 11:20:58 - progress_bar.py[line:274] - INFO: epoch 068:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17176, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2945.2, ups=0.17, wpb=17176, bsz=1024, num_updates=26460, lr=1.71954e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=175000
2024-11-11 11:21:53 - progress_bar.py[line:274] - INFO: epoch 068:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17285.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3118.6, ups=0.18, wpb=17285.6, bsz=1024, num_updates=26470, lr=1.71818e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=175056
2024-11-11 11:22:52 - progress_bar.py[line:274] - INFO: epoch 068:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17223.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2930.4, ups=0.17, wpb=17223.8, bsz=1024, num_updates=26480, lr=1.71682e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=175115
2024-11-11 11:23:48 - progress_bar.py[line:274] - INFO: epoch 068:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17221.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3036.5, ups=0.18, wpb=17221.4, bsz=1024, num_updates=26490, lr=1.71546e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.6, wall=175171
2024-11-11 11:24:41 - progress_bar.py[line:274] - INFO: epoch 068:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17143.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3277.4, ups=0.19, wpb=17143.7, bsz=1024, num_updates=26500, lr=1.7141e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=41, gb_free=13.2, wall=175224
2024-11-11 11:25:38 - progress_bar.py[line:274] - INFO: epoch 068:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17079.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3009.9, ups=0.18, wpb=17079.8, bsz=1024, num_updates=26510, lr=1.71274e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=12.9, wall=175280
2024-11-11 11:26:35 - progress_bar.py[line:274] - INFO: epoch 068:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17103.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2982.3, ups=0.17, wpb=17103.6, bsz=1024, num_updates=26520, lr=1.71138e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=175338
2024-11-11 11:27:32 - progress_bar.py[line:274] - INFO: epoch 068:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17595.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=3062.7, ups=0.17, wpb=17595.6, bsz=1024, num_updates=26530, lr=1.71002e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=175395
2024-11-11 11:28:31 - progress_bar.py[line:274] - INFO: epoch 068:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17403.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=2986.4, ups=0.17, wpb=17403.3, bsz=1024, num_updates=26540, lr=1.70866e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=175454
2024-11-11 11:29:29 - progress_bar.py[line:274] - INFO: epoch 068:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17391.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=2958, ups=0.17, wpb=17391.6, bsz=1024, num_updates=26550, lr=1.7073e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.5, wall=175512
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt

2024-11-11 11:30:00 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 68 @ 26556 updates
2024-11-11 11:30:00 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 11:31:55 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 11:33:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 68 @ 26556 updates, score 0) (writing took 228.20491794700501 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
2024-11-11 11:34:44 - train.py[line:336] - INFO: end of epoch 68 (average epoch stats below)
2024-11-11 11:34:44 - progress_bar.py[line:282] - INFO: epoch 068 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.63 | ntokens 17173.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.19 | wps 2511.3 | ups 0.15 | wpb 17173.7 | bsz 1023 | num_updates 26556 | lr 1.70648e-05 | gnorm 0.004 | clip 0 | loss_scale 65536 | train_wall 1894 | gb_free 13.3 | wall 175827
2024-11-11 11:34:44 - trainer.py[line:639] - INFO: loading train data for epoch 69
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 11:37:26 - trainer.py[line:703] - INFO: begin training epoch 69
2024-11-11 11:37:26 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 11:37:51 - progress_bar.py[line:274] - INFO: epoch 069:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=16652.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=332.3, ups=0.02, wpb=16652.5, bsz=985.6, num_updates=26560, lr=1.70594e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=43, gb_free=13.3, wall=176013
2024-11-11 11:38:47 - progress_bar.py[line:274] - INFO: epoch 069:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17251.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3077.1, ups=0.18, wpb=17251.1, bsz=1024, num_updates=26570, lr=1.70458e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=176069
2024-11-11 11:39:42 - progress_bar.py[line:274] - INFO: epoch 069:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17299, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3101.7, ups=0.18, wpb=17299, bsz=1024, num_updates=26580, lr=1.70322e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=176125
2024-11-11 11:40:38 - progress_bar.py[line:274] - INFO: epoch 069:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17145.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3078.1, ups=0.18, wpb=17145.2, bsz=1024, num_updates=26590, lr=1.70186e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=176181
2024-11-11 11:41:34 - progress_bar.py[line:274] - INFO: epoch 069:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.664, ntokens=17386.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.34, wps=3104.9, ups=0.18, wpb=17386.4, bsz=1024, num_updates=26600, lr=1.7005e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=176237
2024-11-11 11:42:31 - progress_bar.py[line:274] - INFO: epoch 069:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17064.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2972.8, ups=0.17, wpb=17064.5, bsz=1024, num_updates=26610, lr=1.69913e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=36, gb_free=13.1, wall=176294
2024-11-11 11:43:29 - progress_bar.py[line:274] - INFO: epoch 069:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17010, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2935.4, ups=0.17, wpb=17010, bsz=1024, num_updates=26620, lr=1.69777e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=48, gb_free=13.3, wall=176352
2024-11-11 11:44:27 - progress_bar.py[line:274] - INFO: epoch 069:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17144, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2989.5, ups=0.17, wpb=17144, bsz=1024, num_updates=26630, lr=1.69641e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176410
2024-11-11 11:45:24 - progress_bar.py[line:274] - INFO: epoch 069:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17247.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3004.1, ups=0.17, wpb=17247.1, bsz=1024, num_updates=26640, lr=1.69505e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176467
2024-11-11 11:46:22 - progress_bar.py[line:274] - INFO: epoch 069:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17236.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2998.3, ups=0.17, wpb=17236.7, bsz=1024, num_updates=26650, lr=1.69369e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176525
2024-11-11 11:47:19 - progress_bar.py[line:274] - INFO: epoch 069:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17304, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3006.8, ups=0.17, wpb=17304, bsz=1024, num_updates=26660, lr=1.69233e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176582
2024-11-11 11:48:16 - progress_bar.py[line:274] - INFO: epoch 069:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17198.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3014.4, ups=0.18, wpb=17198.9, bsz=1024, num_updates=26670, lr=1.69097e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176639
2024-11-11 11:49:13 - progress_bar.py[line:274] - INFO: epoch 069:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.649, ntokens=17380.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3046.1, ups=0.18, wpb=17380.1, bsz=1024, num_updates=26680, lr=1.68961e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176696
2024-11-11 11:50:10 - progress_bar.py[line:274] - INFO: epoch 069:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17156.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3003.3, ups=0.18, wpb=17156.6, bsz=1024, num_updates=26690, lr=1.68825e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=176753
2024-11-11 11:51:08 - progress_bar.py[line:274] - INFO: epoch 069:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=16807.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2926.4, ups=0.17, wpb=16807.8, bsz=1024, num_updates=26700, lr=1.68689e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=176811
2024-11-11 11:52:04 - progress_bar.py[line:274] - INFO: epoch 069:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17186.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3080.4, ups=0.18, wpb=17186.9, bsz=1024, num_updates=26710, lr=1.68553e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.1, wall=176867
2024-11-11 11:52:59 - progress_bar.py[line:274] - INFO: epoch 069:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17049.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3058, ups=0.18, wpb=17049.6, bsz=1024, num_updates=26720, lr=1.68417e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=51, gb_free=13.1, wall=176922
2024-11-11 11:53:56 - progress_bar.py[line:274] - INFO: epoch 069:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17102.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3035.5, ups=0.18, wpb=17102.8, bsz=1024, num_updates=26730, lr=1.68281e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=176979
2024-11-11 11:54:53 - progress_bar.py[line:274] - INFO: epoch 069:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.647, ntokens=17314.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3032.9, ups=0.18, wpb=17314.9, bsz=1024, num_updates=26740, lr=1.68145e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=177036
2024-11-11 11:55:50 - progress_bar.py[line:274] - INFO: epoch 069:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17074.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2965.1, ups=0.17, wpb=17074.7, bsz=1024, num_updates=26750, lr=1.68009e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=177093
2024-11-11 11:56:47 - progress_bar.py[line:274] - INFO: epoch 069:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.671, ntokens=17390.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.37, wps=3050.8, ups=0.18, wpb=17390.1, bsz=1024, num_updates=26760, lr=1.67873e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=177150
2024-11-11 11:57:44 - progress_bar.py[line:274] - INFO: epoch 069:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=16887, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3006.1, ups=0.18, wpb=16887, bsz=1024, num_updates=26770, lr=1.67737e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=177207
2024-11-11 11:58:39 - progress_bar.py[line:274] - INFO: epoch 069:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17002.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3069.6, ups=0.18, wpb=17002.5, bsz=1024, num_updates=26780, lr=1.67601e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=177262
2024-11-11 11:58:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 11:59:39 - progress_bar.py[line:274] - INFO: epoch 069:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17073.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2855.5, ups=0.17, wpb=17073.8, bsz=1024, num_updates=26790, lr=1.67465e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=49, gb_free=13.3, wall=177322
2024-11-11 12:00:37 - progress_bar.py[line:274] - INFO: epoch 069:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17113.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2956.9, ups=0.17, wpb=17113.6, bsz=1024, num_updates=26800, lr=1.67329e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=177380
2024-11-11 12:01:34 - progress_bar.py[line:274] - INFO: epoch 069:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.644, ntokens=17349.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3018.4, ups=0.17, wpb=17349.7, bsz=1024, num_updates=26810, lr=1.67193e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=177437
2024-11-11 12:02:29 - progress_bar.py[line:274] - INFO: epoch 069:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17311.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3177.7, ups=0.18, wpb=17311.3, bsz=1024, num_updates=26820, lr=1.67057e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=177492
2024-11-11 12:03:23 - progress_bar.py[line:274] - INFO: epoch 069:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17094.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3162.9, ups=0.19, wpb=17094.5, bsz=1024, num_updates=26830, lr=1.66921e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=51, gb_free=13.3, wall=177546
2024-11-11 12:04:18 - progress_bar.py[line:274] - INFO: epoch 069:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17031.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3105.3, ups=0.18, wpb=17031.7, bsz=1024, num_updates=26840, lr=1.66785e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=177600
2024-11-11 12:05:14 - progress_bar.py[line:274] - INFO: epoch 069:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17265.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3083.3, ups=0.18, wpb=17265.1, bsz=1024, num_updates=26850, lr=1.66649e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=177656
2024-11-11 12:06:09 - progress_bar.py[line:274] - INFO: epoch 069:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17156.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3072.6, ups=0.18, wpb=17156.2, bsz=1024, num_updates=26860, lr=1.66512e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=177712
2024-11-11 12:07:05 - progress_bar.py[line:274] - INFO: epoch 069:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17224.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3084.8, ups=0.18, wpb=17224.3, bsz=1024, num_updates=26870, lr=1.66376e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=177768
2024-11-11 12:07:44 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 12:08:08 - progress_bar.py[line:274] - INFO: epoch 069:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=16967.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2706.9, ups=0.16, wpb=16967.8, bsz=1024, num_updates=26880, lr=1.6624e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=39, gb_free=13.4, wall=177831
2024-11-11 12:09:03 - progress_bar.py[line:274] - INFO: epoch 069:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17245.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3143, ups=0.18, wpb=17245.7, bsz=1024, num_updates=26890, lr=1.66104e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=45, gb_free=13.3, wall=177886
2024-11-11 12:09:58 - progress_bar.py[line:274] - INFO: epoch 069:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17290.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3111.2, ups=0.18, wpb=17290.2, bsz=1024, num_updates=26900, lr=1.65968e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=177941
2024-11-11 12:10:57 - progress_bar.py[line:274] - INFO: epoch 069:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17361.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2966, ups=0.17, wpb=17361.7, bsz=1024, num_updates=26910, lr=1.65832e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=43, gb_free=13.4, wall=178000
2024-11-11 12:11:54 - progress_bar.py[line:274] - INFO: epoch 069:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.653, ntokens=17478.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3053.1, ups=0.17, wpb=17478.9, bsz=1024, num_updates=26920, lr=1.65696e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=178057
2024-11-11 12:12:48 - progress_bar.py[line:274] - INFO: epoch 069:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17206.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3177.5, ups=0.18, wpb=17206.9, bsz=1024, num_updates=26930, lr=1.6556e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=178111
2024-11-11 12:13:42 - progress_bar.py[line:274] - INFO: epoch 069:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17126, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3170.4, ups=0.19, wpb=17126, bsz=1024, num_updates=26940, lr=1.65424e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=50, gb_free=13, wall=178165
2024-11-11 12:14:07 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 69 @ 26945 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt

2024-11-11 12:14:07 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt': File exists
: File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 12:15:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
2024-11-11 12:17:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 69 @ 26945 updates, score 0) (writing took 222.37457884900505 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-11 12:18:45 - train.py[line:336] - INFO: end of epoch 69 (average epoch stats below)
2024-11-11 12:18:45 - progress_bar.py[line:282] - INFO: epoch 069 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.623 | ntokens 17164.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.16 | wps 2528.1 | ups 0.15 | wpb 17164.4 | bsz 1023 | num_updates 26945 | lr 1.65356e-05 | gnorm 0.004 | clip 0 | loss_scale 16384 | train_wall 1854 | gb_free 13.3 | wall 178468
2024-11-11 12:18:45 - trainer.py[line:639] - INFO: loading train data for epoch 70
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 12:21:26 - trainer.py[line:703] - INFO: begin training epoch 70
2024-11-11 12:21:26 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 12:21:56 - progress_bar.py[line:274] - INFO: epoch 070:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=16486.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=333.7, ups=0.02, wpb=16486.1, bsz=985.6, num_updates=26950, lr=1.65288e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=40, gb_free=13.2, wall=178659
2024-11-11 12:22:52 - progress_bar.py[line:274] - INFO: epoch 070:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3097.1, ups=0.18, wpb=17333.1, bsz=1024, num_updates=26960, lr=1.65152e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=178715
2024-11-11 12:23:48 - progress_bar.py[line:274] - INFO: epoch 070:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17446.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.29, wps=3112, ups=0.18, wpb=17446.7, bsz=1024, num_updates=26970, lr=1.65016e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=178771
2024-11-11 12:24:45 - progress_bar.py[line:274] - INFO: epoch 070:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=16963.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3024.1, ups=0.18, wpb=16963.8, bsz=1024, num_updates=26980, lr=1.6488e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=178827
2024-11-11 12:25:42 - progress_bar.py[line:274] - INFO: epoch 070:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17176.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2974.2, ups=0.17, wpb=17176.2, bsz=1024, num_updates=26990, lr=1.64744e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=37, gb_free=13.5, wall=178885
2024-11-11 12:26:39 - progress_bar.py[line:274] - INFO: epoch 070:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17154.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3029.1, ups=0.18, wpb=17154.5, bsz=1024, num_updates=27000, lr=1.64608e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=178942
2024-11-11 12:27:35 - progress_bar.py[line:274] - INFO: epoch 070:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=16976.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3020.6, ups=0.18, wpb=16976.2, bsz=1024, num_updates=27010, lr=1.64472e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=40, gb_free=13.3, wall=178998
2024-11-11 12:28:33 - progress_bar.py[line:274] - INFO: epoch 070:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=16877.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2893, ups=0.17, wpb=16877.1, bsz=1024, num_updates=27020, lr=1.64336e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=179056
2024-11-11 12:29:32 - progress_bar.py[line:274] - INFO: epoch 070:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17091.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2941.4, ups=0.17, wpb=17091.7, bsz=1024, num_updates=27030, lr=1.642e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=179114
2024-11-11 12:30:30 - progress_bar.py[line:274] - INFO: epoch 070:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17104, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2934.2, ups=0.17, wpb=17104, bsz=1024, num_updates=27040, lr=1.64064e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=179173
2024-11-11 12:31:27 - progress_bar.py[line:274] - INFO: epoch 070:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3006.1, ups=0.17, wpb=17274.5, bsz=1024, num_updates=27050, lr=1.63928e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=57, gb_free=13, wall=179230
2024-11-11 12:32:26 - progress_bar.py[line:274] - INFO: epoch 070:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17017.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2915.1, ups=0.17, wpb=17017.5, bsz=1024, num_updates=27060, lr=1.63792e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=179289
2024-11-11 12:33:24 - progress_bar.py[line:274] - INFO: epoch 070:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17140.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2956.2, ups=0.17, wpb=17140.1, bsz=1024, num_updates=27070, lr=1.63656e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=179347
2024-11-11 12:34:22 - progress_bar.py[line:274] - INFO: epoch 070:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17276.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2965.9, ups=0.17, wpb=17276.4, bsz=1024, num_updates=27080, lr=1.6352e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=179405
2024-11-11 12:35:21 - progress_bar.py[line:274] - INFO: epoch 070:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=16955.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2882.1, ups=0.17, wpb=16955.4, bsz=1024, num_updates=27090, lr=1.63384e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=59, gb_free=13, wall=179464
2024-11-11 12:36:19 - progress_bar.py[line:274] - INFO: epoch 070:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17283.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2969.1, ups=0.17, wpb=17283.4, bsz=1024, num_updates=27100, lr=1.63248e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=179522
2024-11-11 12:37:15 - progress_bar.py[line:274] - INFO: epoch 070:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17211, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3059, ups=0.18, wpb=17211, bsz=1024, num_updates=27110, lr=1.63111e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=56, gb_free=13.4, wall=179578
2024-11-11 12:38:13 - progress_bar.py[line:274] - INFO: epoch 070:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17203.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2979.6, ups=0.17, wpb=17203.7, bsz=1024, num_updates=27120, lr=1.62975e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=179636
2024-11-11 12:39:12 - progress_bar.py[line:274] - INFO: epoch 070:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=16964, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2888.6, ups=0.17, wpb=16964, bsz=1024, num_updates=27130, lr=1.62839e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=59, gb_free=13.3, wall=179695
2024-11-11 12:40:08 - progress_bar.py[line:274] - INFO: epoch 070:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=16889.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3011.3, ups=0.18, wpb=16889.5, bsz=1024, num_updates=27140, lr=1.62703e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=56, gb_free=13.3, wall=179751
2024-11-11 12:41:04 - progress_bar.py[line:274] - INFO: epoch 070:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17225.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3074.8, ups=0.18, wpb=17225.2, bsz=1024, num_updates=27150, lr=1.62567e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=54, gb_free=13.5, wall=179807
2024-11-11 12:42:01 - progress_bar.py[line:274] - INFO: epoch 070:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17126.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2971.3, ups=0.17, wpb=17126.4, bsz=1024, num_updates=27160, lr=1.62431e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=179864
2024-11-11 12:42:56 - progress_bar.py[line:274] - INFO: epoch 070:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17232, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3154.1, ups=0.18, wpb=17232, bsz=1024, num_updates=27170, lr=1.62295e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=179919
2024-11-11 12:43:54 - progress_bar.py[line:274] - INFO: epoch 070:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.658, ntokens=17399.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2981.8, ups=0.17, wpb=17399.6, bsz=1024, num_updates=27180, lr=1.62159e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=179977
2024-11-11 12:44:52 - progress_bar.py[line:274] - INFO: epoch 070:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17153.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2971.4, ups=0.17, wpb=17153.2, bsz=1024, num_updates=27190, lr=1.62023e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=180035
2024-11-11 12:45:51 - progress_bar.py[line:274] - INFO: epoch 070:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17258.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2917.1, ups=0.17, wpb=17258.1, bsz=1024, num_updates=27200, lr=1.61887e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=59, gb_free=13.5, wall=180094
2024-11-11 12:46:50 - progress_bar.py[line:274] - INFO: epoch 070:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=16970.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2876.8, ups=0.17, wpb=16970.6, bsz=1024, num_updates=27210, lr=1.61751e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=59, gb_free=13.2, wall=180153
2024-11-11 12:47:49 - progress_bar.py[line:274] - INFO: epoch 070:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17098.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2934.1, ups=0.17, wpb=17098.5, bsz=1024, num_updates=27220, lr=1.61615e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=180211
2024-11-11 12:48:46 - progress_bar.py[line:274] - INFO: epoch 070:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17111.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2977.9, ups=0.17, wpb=17111.7, bsz=1024, num_updates=27230, lr=1.61479e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=180269
2024-11-11 12:49:44 - progress_bar.py[line:274] - INFO: epoch 070:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17287.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2988.2, ups=0.17, wpb=17287.8, bsz=1024, num_updates=27240, lr=1.61343e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=180327
2024-11-11 12:50:42 - progress_bar.py[line:274] - INFO: epoch 070:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17373.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2997.1, ups=0.17, wpb=17373.3, bsz=1024, num_updates=27250, lr=1.61207e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=180385
2024-11-11 12:51:36 - progress_bar.py[line:274] - INFO: epoch 070:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3148.7, ups=0.18, wpb=17165.4, bsz=1024, num_updates=27260, lr=1.61071e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=180439
2024-11-11 12:52:35 - progress_bar.py[line:274] - INFO: epoch 070:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17243.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=2966.7, ups=0.17, wpb=17243.1, bsz=1024, num_updates=27270, lr=1.60935e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=57, gb_free=13.4, wall=180497
2024-11-11 12:53:33 - progress_bar.py[line:274] - INFO: epoch 070:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17132.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2923, ups=0.17, wpb=17132.7, bsz=1024, num_updates=27280, lr=1.60799e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=59, gb_free=13.4, wall=180556
2024-11-11 12:54:29 - progress_bar.py[line:274] - INFO: epoch 070:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17060.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3073.7, ups=0.18, wpb=17060.2, bsz=1024, num_updates=27290, lr=1.60663e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=55, gb_free=12.9, wall=180612
2024-11-11 12:55:22 - progress_bar.py[line:274] - INFO: epoch 070:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17207.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3198.3, ups=0.19, wpb=17207.3, bsz=1024, num_updates=27300, lr=1.60527e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=37, gb_free=13.1, wall=180665
2024-11-11 12:56:19 - progress_bar.py[line:274] - INFO: epoch 070:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17421, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3067.9, ups=0.18, wpb=17421, bsz=1024, num_updates=27310, lr=1.60391e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=12.9, wall=180722
2024-11-11 12:57:16 - progress_bar.py[line:274] - INFO: epoch 070:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17227.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3031.6, ups=0.18, wpb=17227.2, bsz=1024, num_updates=27320, lr=1.60255e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=40, gb_free=13.3, wall=180779
2024-11-11 12:58:13 - progress_bar.py[line:274] - INFO: epoch 070:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17204.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3010.1, ups=0.17, wpb=17204.5, bsz=1024, num_updates=27330, lr=1.60119e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=180836
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt2024-11-11 12:58:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 70 @ 27336 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
2024-11-11 12:58:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 13:00:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
2024-11-11 13:02:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 70 @ 27336 updates, score 0) (writing took 222.89782219502376 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 13:03:23 - train.py[line:336] - INFO: end of epoch 70 (average epoch stats below)
2024-11-11 13:03:23 - progress_bar.py[line:282] - INFO: epoch 070 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.618 | ntokens 17145.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.14 | wps 2503.3 | ups 0.15 | wpb 17145.2 | bsz 1023 | num_updates 27336 | lr 1.60037e-05 | gnorm 0.004 | clip 0 | loss_scale 16384 | train_wall 2025 | gb_free 13.3 | wall 181146
2024-11-11 13:03:23 - trainer.py[line:639] - INFO: loading train data for epoch 71
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 13:06:05 - trainer.py[line:703] - INFO: begin training epoch 71
2024-11-11 13:06:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 13:06:29 - progress_bar.py[line:274] - INFO: epoch 071:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=16374.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=330.1, ups=0.02, wpb=16374.1, bsz=985.6, num_updates=27340, lr=1.59983e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=44, gb_free=13.4, wall=181332
2024-11-11 13:07:26 - progress_bar.py[line:274] - INFO: epoch 071:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17255.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3048.6, ups=0.18, wpb=17255.4, bsz=1024, num_updates=27350, lr=1.59847e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=181389
2024-11-11 13:08:22 - progress_bar.py[line:274] - INFO: epoch 071:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17026.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3015.2, ups=0.18, wpb=17026.8, bsz=1024, num_updates=27360, lr=1.59711e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=181445
2024-11-11 13:09:19 - progress_bar.py[line:274] - INFO: epoch 071:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=16921.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2998.1, ups=0.18, wpb=16921.4, bsz=1024, num_updates=27370, lr=1.59574e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=181502
2024-11-11 13:10:14 - progress_bar.py[line:274] - INFO: epoch 071:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17144, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3077.8, ups=0.18, wpb=17144, bsz=1024, num_updates=27380, lr=1.59438e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=181557
2024-11-11 13:11:11 - progress_bar.py[line:274] - INFO: epoch 071:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17323, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3048.8, ups=0.18, wpb=17323, bsz=1024, num_updates=27390, lr=1.59302e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=34, gb_free=13.2, wall=181614
2024-11-11 13:12:08 - progress_bar.py[line:274] - INFO: epoch 071:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=16938, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2972.8, ups=0.18, wpb=16938, bsz=1024, num_updates=27400, lr=1.59166e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.1, wall=181671
2024-11-11 13:13:06 - progress_bar.py[line:274] - INFO: epoch 071:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=16963.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2937.9, ups=0.17, wpb=16963.8, bsz=1024, num_updates=27410, lr=1.5903e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=181729
2024-11-11 13:13:59 - progress_bar.py[line:274] - INFO: epoch 071:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17310, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3254.6, ups=0.19, wpb=17310, bsz=1024, num_updates=27420, lr=1.58894e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=49, gb_free=13.4, wall=181782
2024-11-11 13:14:53 - progress_bar.py[line:274] - INFO: epoch 071:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17047.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3143.1, ups=0.18, wpb=17047.8, bsz=1024, num_updates=27430, lr=1.58758e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=181836
2024-11-11 13:15:49 - progress_bar.py[line:274] - INFO: epoch 071:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17295.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3088.4, ups=0.18, wpb=17295.3, bsz=1024, num_updates=27440, lr=1.58622e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=181892
2024-11-11 13:16:47 - progress_bar.py[line:274] - INFO: epoch 071:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17093.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2992.5, ups=0.18, wpb=17093.4, bsz=1024, num_updates=27450, lr=1.58486e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=36, gb_free=13.3, wall=181949
2024-11-11 13:17:44 - progress_bar.py[line:274] - INFO: epoch 071:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17347.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3016.2, ups=0.17, wpb=17347.4, bsz=1024, num_updates=27460, lr=1.5835e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=182007
2024-11-11 13:18:42 - progress_bar.py[line:274] - INFO: epoch 071:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.662, ntokens=17489.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.33, wps=3020.6, ups=0.17, wpb=17489.9, bsz=1024, num_updates=27470, lr=1.58214e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182065
2024-11-11 13:19:40 - progress_bar.py[line:274] - INFO: epoch 071:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17023.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2936.1, ups=0.17, wpb=17023.8, bsz=1024, num_updates=27480, lr=1.58078e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182123
2024-11-11 13:20:36 - progress_bar.py[line:274] - INFO: epoch 071:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17271, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3058.4, ups=0.18, wpb=17271, bsz=1024, num_updates=27490, lr=1.57942e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13, wall=182179
2024-11-11 13:21:33 - progress_bar.py[line:274] - INFO: epoch 071:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.627, ntokens=17175.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3047.1, ups=0.18, wpb=17175.7, bsz=1024, num_updates=27500, lr=1.57806e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=182236
2024-11-11 13:22:31 - progress_bar.py[line:274] - INFO: epoch 071:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17287.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2975.3, ups=0.17, wpb=17287.8, bsz=1024, num_updates=27510, lr=1.5767e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182294
2024-11-11 13:23:29 - progress_bar.py[line:274] - INFO: epoch 071:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17001.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2914.5, ups=0.17, wpb=17001.4, bsz=1024, num_updates=27520, lr=1.57534e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182352
2024-11-11 13:24:27 - progress_bar.py[line:274] - INFO: epoch 071:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17149, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2960, ups=0.17, wpb=17149, bsz=1024, num_updates=27530, lr=1.57398e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182410
2024-11-11 13:25:25 - progress_bar.py[line:274] - INFO: epoch 071:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17091.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=2936.5, ups=0.17, wpb=17091.3, bsz=1024, num_updates=27540, lr=1.57262e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=182468
2024-11-11 13:26:23 - progress_bar.py[line:274] - INFO: epoch 071:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17135.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2964.4, ups=0.17, wpb=17135.6, bsz=1024, num_updates=27550, lr=1.57126e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=182526
2024-11-11 13:27:19 - progress_bar.py[line:274] - INFO: epoch 071:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17001.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3064.5, ups=0.18, wpb=17001.5, bsz=1024, num_updates=27560, lr=1.5699e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=182582
2024-11-11 13:28:15 - progress_bar.py[line:274] - INFO: epoch 071:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17274.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3084.8, ups=0.18, wpb=17274.6, bsz=1024, num_updates=27570, lr=1.56854e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=182638
2024-11-11 13:29:13 - progress_bar.py[line:274] - INFO: epoch 071:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17282.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2960.8, ups=0.17, wpb=17282.5, bsz=1024, num_updates=27580, lr=1.56718e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=182696
2024-11-11 13:30:10 - progress_bar.py[line:274] - INFO: epoch 071:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17394, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3043.2, ups=0.17, wpb=17394, bsz=1024, num_updates=27590, lr=1.56582e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=182753
2024-11-11 13:31:08 - progress_bar.py[line:274] - INFO: epoch 071:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17410.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3015.6, ups=0.17, wpb=17410.3, bsz=1024, num_updates=27600, lr=1.56446e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=182811
2024-11-11 13:32:06 - progress_bar.py[line:274] - INFO: epoch 071:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=16966.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2933.7, ups=0.17, wpb=16966.6, bsz=1024, num_updates=27610, lr=1.5631e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=182869
2024-11-11 13:33:03 - progress_bar.py[line:274] - INFO: epoch 071:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=16961.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2978.7, ups=0.18, wpb=16961.1, bsz=1024, num_updates=27620, lr=1.56173e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=182926
2024-11-11 13:33:59 - progress_bar.py[line:274] - INFO: epoch 071:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17141.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3034.1, ups=0.18, wpb=17141.5, bsz=1024, num_updates=27630, lr=1.56037e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=182982
2024-11-11 13:34:56 - progress_bar.py[line:274] - INFO: epoch 071:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17265.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3022.3, ups=0.18, wpb=17265.8, bsz=1024, num_updates=27640, lr=1.55901e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=183039
2024-11-11 13:35:55 - progress_bar.py[line:274] - INFO: epoch 071:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17028.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2911.9, ups=0.17, wpb=17028.4, bsz=1024, num_updates=27650, lr=1.55765e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=183098
2024-11-11 13:36:52 - progress_bar.py[line:274] - INFO: epoch 071:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=16933.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2980.3, ups=0.18, wpb=16933.3, bsz=1024, num_updates=27660, lr=1.55629e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.4, wall=183155
2024-11-11 13:37:47 - progress_bar.py[line:274] - INFO: epoch 071:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17228.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3105, ups=0.18, wpb=17228.9, bsz=1024, num_updates=27670, lr=1.55493e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=183210
2024-11-11 13:38:45 - progress_bar.py[line:274] - INFO: epoch 071:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2993.3, ups=0.17, wpb=17239.6, bsz=1024, num_updates=27680, lr=1.55357e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=183268
2024-11-11 13:39:39 - progress_bar.py[line:274] - INFO: epoch 071:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.628, ntokens=17304.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3188.3, ups=0.18, wpb=17304.5, bsz=1024, num_updates=27690, lr=1.55221e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=183322
2024-11-11 13:40:34 - progress_bar.py[line:274] - INFO: epoch 071:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17247.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3108.4, ups=0.18, wpb=17247.2, bsz=1024, num_updates=27700, lr=1.55085e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=183377
2024-11-11 13:41:30 - progress_bar.py[line:274] - INFO: epoch 071:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17170.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3099.7, ups=0.18, wpb=17170.6, bsz=1024, num_updates=27710, lr=1.54949e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=183433
2024-11-11 13:42:25 - progress_bar.py[line:274] - INFO: epoch 071:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.65, ntokens=17432.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=3156.7, ups=0.18, wpb=17432.3, bsz=1024, num_updates=27720, lr=1.54813e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.1, wall=183488
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt2024-11-11 13:43:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 71 @ 27727 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt

2024-11-11 13:43:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 13:44:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
2024-11-11 13:46:46 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 71 @ 27727 updates, score 0) (writing took 225.214814110077 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 13:47:42 - train.py[line:336] - INFO: end of epoch 71 (average epoch stats below)
2024-11-11 13:47:42 - progress_bar.py[line:282] - INFO: epoch 071 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.617 | ntokens 17151.6 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.14 | wps 2522.2 | ups 0.15 | wpb 17151.6 | bsz 1023 | num_updates 27727 | lr 1.54718e-05 | gnorm 0.004 | clip 0 | loss_scale 32768 | train_wall 1981 | gb_free 13.3 | wall 183805
2024-11-11 13:47:42 - trainer.py[line:639] - INFO: loading train data for epoch 72
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 13:50:23 - trainer.py[line:703] - INFO: begin training epoch 72
2024-11-11 13:50:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 13:50:42 - progress_bar.py[line:274] - INFO: epoch 072:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=16367.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=329, ups=0.02, wpb=16367.2, bsz=985.6, num_updates=27730, lr=1.54677e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=45, gb_free=13.2, wall=183985
2024-11-11 13:51:40 - progress_bar.py[line:274] - INFO: epoch 072:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17002.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2979.3, ups=0.18, wpb=17002.6, bsz=1024, num_updates=27740, lr=1.54541e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=184042
2024-11-11 13:52:37 - progress_bar.py[line:274] - INFO: epoch 072:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17339.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3024, ups=0.17, wpb=17339.8, bsz=1024, num_updates=27750, lr=1.54405e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=184100
2024-11-11 13:53:36 - progress_bar.py[line:274] - INFO: epoch 072:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17284.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2929.9, ups=0.17, wpb=17284.6, bsz=1024, num_updates=27760, lr=1.54269e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=184159
2024-11-11 13:54:35 - progress_bar.py[line:274] - INFO: epoch 072:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17279.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2926, ups=0.17, wpb=17279.8, bsz=1024, num_updates=27770, lr=1.54133e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=184218
2024-11-11 13:55:33 - progress_bar.py[line:274] - INFO: epoch 072:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17253.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2950.8, ups=0.17, wpb=17253.7, bsz=1024, num_updates=27780, lr=1.53997e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=58, gb_free=13, wall=184276
2024-11-11 13:56:30 - progress_bar.py[line:274] - INFO: epoch 072:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17092.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3048.3, ups=0.18, wpb=17092.4, bsz=1024, num_updates=27790, lr=1.53861e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=184332
2024-11-11 13:57:25 - progress_bar.py[line:274] - INFO: epoch 072:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.646, ntokens=17398.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.26, wps=3130.8, ups=0.18, wpb=17398.3, bsz=1024, num_updates=27800, lr=1.53725e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=48, gb_free=13.2, wall=184388
2024-11-11 13:58:20 - progress_bar.py[line:274] - INFO: epoch 072:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17146.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3115.5, ups=0.18, wpb=17146.9, bsz=1024, num_updates=27810, lr=1.53589e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=184443
2024-11-11 13:59:18 - progress_bar.py[line:274] - INFO: epoch 072:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17040.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2957, ups=0.17, wpb=17040.4, bsz=1024, num_updates=27820, lr=1.53453e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=184501
2024-11-11 14:00:15 - progress_bar.py[line:274] - INFO: epoch 072:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=17362.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3048.2, ups=0.18, wpb=17362.5, bsz=1024, num_updates=27830, lr=1.53317e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=38, gb_free=13.3, wall=184558
2024-11-11 14:01:12 - progress_bar.py[line:274] - INFO: epoch 072:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17048.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2975.1, ups=0.17, wpb=17048.8, bsz=1024, num_updates=27840, lr=1.53181e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=184615
2024-11-11 14:02:08 - progress_bar.py[line:274] - INFO: epoch 072:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.633, ntokens=17352.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=3072.9, ups=0.18, wpb=17352.2, bsz=1024, num_updates=27850, lr=1.53045e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=184671
2024-11-11 14:03:06 - progress_bar.py[line:274] - INFO: epoch 072:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17290.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3021.2, ups=0.17, wpb=17290.2, bsz=1024, num_updates=27860, lr=1.52909e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=184729
2024-11-11 14:04:03 - progress_bar.py[line:274] - INFO: epoch 072:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17078.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2981.2, ups=0.17, wpb=17078.5, bsz=1024, num_updates=27870, lr=1.52772e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=184786
2024-11-11 14:05:00 - progress_bar.py[line:274] - INFO: epoch 072:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17153.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3006.5, ups=0.18, wpb=17153.1, bsz=1024, num_updates=27880, lr=1.52636e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=184843
2024-11-11 14:05:57 - progress_bar.py[line:274] - INFO: epoch 072:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=16994.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2985, ups=0.18, wpb=16994.5, bsz=1024, num_updates=27890, lr=1.525e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=184900
2024-11-11 14:06:56 - progress_bar.py[line:274] - INFO: epoch 072:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17312.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2953.2, ups=0.17, wpb=17312.7, bsz=1024, num_updates=27900, lr=1.52364e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=39, gb_free=13.4, wall=184959
2024-11-11 14:07:53 - progress_bar.py[line:274] - INFO: epoch 072:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=16904.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2937, ups=0.17, wpb=16904.4, bsz=1024, num_updates=27910, lr=1.52228e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=185016
2024-11-11 14:08:52 - progress_bar.py[line:274] - INFO: epoch 072:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17013.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2891.4, ups=0.17, wpb=17013.3, bsz=1024, num_updates=27920, lr=1.52092e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=185075
2024-11-11 14:09:51 - progress_bar.py[line:274] - INFO: epoch 072:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.652, ntokens=17312.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.28, wps=2947.8, ups=0.17, wpb=17312.1, bsz=1024, num_updates=27930, lr=1.51956e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13, wall=185134
2024-11-11 14:10:45 - progress_bar.py[line:274] - INFO: epoch 072:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=16997.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3135.3, ups=0.18, wpb=16997.5, bsz=1024, num_updates=27940, lr=1.5182e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=48, gb_free=13.3, wall=185188
2024-11-11 14:11:42 - progress_bar.py[line:274] - INFO: epoch 072:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17048.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2994.8, ups=0.18, wpb=17048.9, bsz=1024, num_updates=27950, lr=1.51684e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=54, gb_free=13.6, wall=185245
2024-11-11 14:12:37 - progress_bar.py[line:274] - INFO: epoch 072:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.64, ntokens=17444.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3160.5, ups=0.18, wpb=17444.8, bsz=1024, num_updates=27960, lr=1.51548e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=40, gb_free=13.3, wall=185300
2024-11-11 14:13:37 - progress_bar.py[line:274] - INFO: epoch 072:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17083.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2866.6, ups=0.17, wpb=17083.9, bsz=1024, num_updates=27970, lr=1.51412e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=49, gb_free=13.1, wall=185360
2024-11-11 14:14:34 - progress_bar.py[line:274] - INFO: epoch 072:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.674, ntokens=17523.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.38, wps=3081.4, ups=0.18, wpb=17523.2, bsz=1024, num_updates=27980, lr=1.51276e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=185416
2024-11-11 14:15:30 - progress_bar.py[line:274] - INFO: epoch 072:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17148.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3039.5, ups=0.18, wpb=17148.1, bsz=1024, num_updates=27990, lr=1.5114e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=185473
2024-11-11 14:16:29 - progress_bar.py[line:274] - INFO: epoch 072:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17081.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2915.7, ups=0.17, wpb=17081.3, bsz=1024, num_updates=28000, lr=1.51004e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=185531
2024-11-11 14:17:27 - progress_bar.py[line:274] - INFO: epoch 072:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17049, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2932.9, ups=0.17, wpb=17049, bsz=1024, num_updates=28010, lr=1.50868e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=185590
2024-11-11 14:18:26 - progress_bar.py[line:274] - INFO: epoch 072:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17171.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2907.8, ups=0.17, wpb=17171.6, bsz=1024, num_updates=28020, lr=1.50732e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=59, gb_free=13.5, wall=185649
2024-11-11 14:19:24 - progress_bar.py[line:274] - INFO: epoch 072:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17222.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2965.8, ups=0.17, wpb=17222.2, bsz=1024, num_updates=28030, lr=1.50596e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.5, wall=185707
2024-11-11 14:20:22 - progress_bar.py[line:274] - INFO: epoch 072:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17112.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2940.1, ups=0.17, wpb=17112.4, bsz=1024, num_updates=28040, lr=1.5046e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=13.5, wall=185765
2024-11-11 14:21:17 - progress_bar.py[line:274] - INFO: epoch 072:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17144.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3127.8, ups=0.18, wpb=17144.5, bsz=1024, num_updates=28050, lr=1.50324e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13, wall=185820
2024-11-11 14:22:14 - progress_bar.py[line:274] - INFO: epoch 072:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=16977.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2947, ups=0.17, wpb=16977.8, bsz=1024, num_updates=28060, lr=1.50188e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=50, gb_free=13.2, wall=185877
2024-11-11 14:23:11 - progress_bar.py[line:274] - INFO: epoch 072:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17143, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3054.5, ups=0.18, wpb=17143, bsz=1024, num_updates=28070, lr=1.50052e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=46, gb_free=13.4, wall=185933
2024-11-11 14:24:09 - progress_bar.py[line:274] - INFO: epoch 072:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17192.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2939.4, ups=0.17, wpb=17192.2, bsz=1024, num_updates=28080, lr=1.49916e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=58, gb_free=12.8, wall=185992
2024-11-11 14:25:03 - progress_bar.py[line:274] - INFO: epoch 072:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17274.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3174, ups=0.18, wpb=17274.2, bsz=1024, num_updates=28090, lr=1.4978e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=49, gb_free=13.3, wall=186046
2024-11-11 14:26:02 - progress_bar.py[line:274] - INFO: epoch 072:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17203, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2963.8, ups=0.17, wpb=17203, bsz=1024, num_updates=28100, lr=1.49644e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=186104
2024-11-11 14:26:58 - progress_bar.py[line:274] - INFO: epoch 072:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17044.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3000.6, ups=0.18, wpb=17044.3, bsz=1024, num_updates=28110, lr=1.49508e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=186161
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt2024-11-11 14:27:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 72 @ 28118 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
2024-11-11 14:27:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 14:29:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
2024-11-11 14:31:26 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 72 @ 28118 updates, score 0) (writing took 225.0233207771089 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_72.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
2024-11-11 14:32:22 - train.py[line:336] - INFO: end of epoch 72 (average epoch stats below)
2024-11-11 14:32:22 - progress_bar.py[line:282] - INFO: epoch 072 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.614 | ntokens 17153.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.12 | wps 2503.3 | ups 0.15 | wpb 17153.7 | bsz 1023 | num_updates 28118 | lr 1.49399e-05 | gnorm 0.004 | clip 0 | loss_scale 65536 | train_wall 1838 | gb_free 13.3 | wall 186484
2024-11-11 14:32:22 - trainer.py[line:639] - INFO: loading train data for epoch 73
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 14:35:03 - trainer.py[line:703] - INFO: begin training epoch 73
2024-11-11 14:35:03 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 14:35:17 - progress_bar.py[line:274] - INFO: epoch 073:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=16408.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=329.3, ups=0.02, wpb=16408.5, bsz=985.6, num_updates=28120, lr=1.49371e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=48, gb_free=13.3, wall=186660
2024-11-11 14:35:39 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 14:36:19 - progress_bar.py[line:274] - INFO: epoch 073:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17070.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2717.5, ups=0.16, wpb=17070.5, bsz=1024, num_updates=28130, lr=1.49235e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=186722
2024-11-11 14:37:17 - progress_bar.py[line:274] - INFO: epoch 073:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17236.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3005.4, ups=0.17, wpb=17236.1, bsz=1024, num_updates=28140, lr=1.49099e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=33, gb_free=13.3, wall=186780
2024-11-11 14:38:16 - progress_bar.py[line:274] - INFO: epoch 073:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17041.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2867, ups=0.17, wpb=17041.5, bsz=1024, num_updates=28150, lr=1.48963e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=56, gb_free=13.2, wall=186839
2024-11-11 14:39:12 - progress_bar.py[line:274] - INFO: epoch 073:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17126.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3093, ups=0.18, wpb=17126.7, bsz=1024, num_updates=28160, lr=1.48827e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=50, gb_free=13.2, wall=186894
2024-11-11 14:40:10 - progress_bar.py[line:274] - INFO: epoch 073:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17163.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2922.4, ups=0.17, wpb=17163.3, bsz=1024, num_updates=28170, lr=1.48691e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=12.7, wall=186953
2024-11-11 14:41:09 - progress_bar.py[line:274] - INFO: epoch 073:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17151.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2929.4, ups=0.17, wpb=17151.8, bsz=1024, num_updates=28180, lr=1.48555e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=187012
2024-11-11 14:42:08 - progress_bar.py[line:274] - INFO: epoch 073:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17261.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2941.6, ups=0.17, wpb=17261.5, bsz=1024, num_updates=28190, lr=1.48419e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=187070
2024-11-11 14:43:07 - progress_bar.py[line:274] - INFO: epoch 073:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=16906.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2863.1, ups=0.17, wpb=16906.5, bsz=1024, num_updates=28200, lr=1.48283e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=187130
2024-11-11 14:44:02 - progress_bar.py[line:274] - INFO: epoch 073:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17310.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3137.7, ups=0.18, wpb=17310.5, bsz=1024, num_updates=28210, lr=1.48147e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=187185
2024-11-11 14:45:00 - progress_bar.py[line:274] - INFO: epoch 073:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.657, ntokens=17496.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.31, wps=2999.3, ups=0.17, wpb=17496.5, bsz=1024, num_updates=28220, lr=1.48011e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=187243
2024-11-11 14:45:59 - progress_bar.py[line:274] - INFO: epoch 073:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17071.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2916.9, ups=0.17, wpb=17071.6, bsz=1024, num_updates=28230, lr=1.47875e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=187302
2024-11-11 14:46:57 - progress_bar.py[line:274] - INFO: epoch 073:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17195.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2970.9, ups=0.17, wpb=17195.1, bsz=1024, num_updates=28240, lr=1.47739e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=187359
2024-11-11 14:47:53 - progress_bar.py[line:274] - INFO: epoch 073:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17316.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3058.8, ups=0.18, wpb=17316.5, bsz=1024, num_updates=28250, lr=1.47603e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=57, gb_free=13.5, wall=187416
2024-11-11 14:48:52 - progress_bar.py[line:274] - INFO: epoch 073:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17104.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2902.7, ups=0.17, wpb=17104.1, bsz=1024, num_updates=28260, lr=1.47467e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=187475
2024-11-11 14:49:51 - progress_bar.py[line:274] - INFO: epoch 073:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17220.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2925.6, ups=0.17, wpb=17220.8, bsz=1024, num_updates=28270, lr=1.47331e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=187534
2024-11-11 14:50:50 - progress_bar.py[line:274] - INFO: epoch 073:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17315.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2936.1, ups=0.17, wpb=17315.5, bsz=1024, num_updates=28280, lr=1.47195e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13, wall=187593
2024-11-11 14:51:48 - progress_bar.py[line:274] - INFO: epoch 073:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17402.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2984.9, ups=0.17, wpb=17402.6, bsz=1024, num_updates=28290, lr=1.47059e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=187651
2024-11-11 14:52:46 - progress_bar.py[line:274] - INFO: epoch 073:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17057.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2954.7, ups=0.17, wpb=17057.6, bsz=1024, num_updates=28300, lr=1.46923e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=187709
2024-11-11 14:53:45 - progress_bar.py[line:274] - INFO: epoch 073:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17071.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2885.5, ups=0.17, wpb=17071.8, bsz=1024, num_updates=28310, lr=1.46787e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=187768
2024-11-11 14:54:44 - progress_bar.py[line:274] - INFO: epoch 073:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17335.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=2958.7, ups=0.17, wpb=17335.3, bsz=1024, num_updates=28320, lr=1.46651e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=187827
2024-11-11 14:55:43 - progress_bar.py[line:274] - INFO: epoch 073:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17120.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2897.4, ups=0.17, wpb=17120.2, bsz=1024, num_updates=28330, lr=1.46515e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=187886
2024-11-11 14:56:41 - progress_bar.py[line:274] - INFO: epoch 073:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17080.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2916.3, ups=0.17, wpb=17080.7, bsz=1024, num_updates=28340, lr=1.46379e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=187944
2024-11-11 14:57:36 - progress_bar.py[line:274] - INFO: epoch 073:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17229.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3141.3, ups=0.18, wpb=17229.6, bsz=1024, num_updates=28350, lr=1.46243e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=54, gb_free=13.4, wall=187999
2024-11-11 14:58:34 - progress_bar.py[line:274] - INFO: epoch 073:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17387.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2998.6, ups=0.17, wpb=17387.2, bsz=1024, num_updates=28360, lr=1.46107e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=45, gb_free=13.1, wall=188057
2024-11-11 14:59:30 - progress_bar.py[line:274] - INFO: epoch 073:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3080.6, ups=0.18, wpb=17274.5, bsz=1024, num_updates=28370, lr=1.45971e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=45, gb_free=13.4, wall=188113
2024-11-11 15:00:27 - progress_bar.py[line:274] - INFO: epoch 073:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=16966.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3005.8, ups=0.18, wpb=16966.2, bsz=1024, num_updates=28380, lr=1.45834e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=188170
2024-11-11 15:01:24 - progress_bar.py[line:274] - INFO: epoch 073:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17047, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2994.7, ups=0.18, wpb=17047, bsz=1024, num_updates=28390, lr=1.45698e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=35, gb_free=13, wall=188227
2024-11-11 15:02:21 - progress_bar.py[line:274] - INFO: epoch 073:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17258.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3028.3, ups=0.18, wpb=17258.1, bsz=1024, num_updates=28400, lr=1.45562e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=188284
2024-11-11 15:03:19 - progress_bar.py[line:274] - INFO: epoch 073:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17377.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2999, ups=0.17, wpb=17377.3, bsz=1024, num_updates=28410, lr=1.45426e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=34, gb_free=13.2, wall=188341
2024-11-11 15:04:15 - progress_bar.py[line:274] - INFO: epoch 073:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17160.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3024.9, ups=0.18, wpb=17160.7, bsz=1024, num_updates=28420, lr=1.4529e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=47, gb_free=13.4, wall=188398
2024-11-11 15:05:11 - progress_bar.py[line:274] - INFO: epoch 073:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17187.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3064.4, ups=0.18, wpb=17187.9, bsz=1024, num_updates=28430, lr=1.45154e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=32, gb_free=13.5, wall=188454
2024-11-11 15:06:09 - progress_bar.py[line:274] - INFO: epoch 073:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17001.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2956.4, ups=0.17, wpb=17001.9, bsz=1024, num_updates=28440, lr=1.45018e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=36, gb_free=13.3, wall=188512
2024-11-11 15:07:07 - progress_bar.py[line:274] - INFO: epoch 073:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=16986.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2915.5, ups=0.17, wpb=16986.9, bsz=1024, num_updates=28450, lr=1.44882e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=40, gb_free=13.2, wall=188570
2024-11-11 15:08:04 - progress_bar.py[line:274] - INFO: epoch 073:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17079.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2993.6, ups=0.18, wpb=17079.5, bsz=1024, num_updates=28460, lr=1.44746e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=188627
2024-11-11 15:09:01 - progress_bar.py[line:274] - INFO: epoch 073:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17421.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3040.5, ups=0.17, wpb=17421.5, bsz=1024, num_updates=28470, lr=1.4461e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=12.9, wall=188684
2024-11-11 15:10:00 - progress_bar.py[line:274] - INFO: epoch 073:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17414.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2967.6, ups=0.17, wpb=17414.1, bsz=1024, num_updates=28480, lr=1.44474e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=52, gb_free=13.2, wall=188743
2024-11-11 15:10:59 - progress_bar.py[line:274] - INFO: epoch 073:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17332.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2962, ups=0.17, wpb=17332.9, bsz=1024, num_updates=28490, lr=1.44338e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.1, wall=188802
2024-11-11 15:11:57 - progress_bar.py[line:274] - INFO: epoch 073:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17304, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2967.7, ups=0.17, wpb=17304, bsz=1024, num_updates=28500, lr=1.44202e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=188860
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
2024-11-11 15:12:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 73 @ 28508 updates


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
2024-11-11 15:12:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 15:14:25 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
2024-11-11 15:16:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 73 @ 28508 updates, score 0) (writing took 223.9874972179532 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_73.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-11 15:17:15 - train.py[line:336] - INFO: end of epoch 73 (average epoch stats below)
2024-11-11 15:17:15 - progress_bar.py[line:282] - INFO: epoch 073 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.613 | ntokens 17184.2 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.12 | wps 2488.6 | ups 0.14 | wpb 17184.2 | bsz 1023 | num_updates 28508 | lr 1.44093e-05 | gnorm 0.004 | clip 0 | loss_scale 32768 | train_wall 1946 | gb_free 13.2 | wall 189177
2024-11-11 15:17:15 - trainer.py[line:639] - INFO: loading train data for epoch 74
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 15:19:57 - trainer.py[line:703] - INFO: begin training epoch 74
2024-11-11 15:19:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 15:20:10 - progress_bar.py[line:274] - INFO: epoch 074:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.637, ntokens=16759.8, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=340.1, ups=0.02, wpb=16759.8, bsz=985.6, num_updates=28510, lr=1.44066e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=189353
2024-11-11 15:21:07 - progress_bar.py[line:274] - INFO: epoch 074:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17064.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2996.3, ups=0.18, wpb=17064.7, bsz=1024, num_updates=28520, lr=1.4393e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=189410
2024-11-11 15:22:04 - progress_bar.py[line:274] - INFO: epoch 074:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17282.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2993.5, ups=0.17, wpb=17282.5, bsz=1024, num_updates=28530, lr=1.43794e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=189467
2024-11-11 15:23:02 - progress_bar.py[line:274] - INFO: epoch 074:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17044.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2985.3, ups=0.18, wpb=17044.1, bsz=1024, num_updates=28540, lr=1.43658e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=189524
2024-11-11 15:23:59 - progress_bar.py[line:274] - INFO: epoch 074:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17186.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2982.3, ups=0.17, wpb=17186.9, bsz=1024, num_updates=28550, lr=1.43522e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=189582
2024-11-11 15:24:56 - progress_bar.py[line:274] - INFO: epoch 074:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17271.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3029.8, ups=0.18, wpb=17271.4, bsz=1024, num_updates=28560, lr=1.43386e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=189639
2024-11-11 15:25:54 - progress_bar.py[line:274] - INFO: epoch 074:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17120.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2951.3, ups=0.17, wpb=17120.1, bsz=1024, num_updates=28570, lr=1.4325e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=189697
2024-11-11 15:26:52 - progress_bar.py[line:274] - INFO: epoch 074:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17096.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2984.2, ups=0.17, wpb=17096.8, bsz=1024, num_updates=28580, lr=1.43114e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=189754
2024-11-11 15:27:50 - progress_bar.py[line:274] - INFO: epoch 074:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17316.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2963, ups=0.17, wpb=17316.1, bsz=1024, num_updates=28590, lr=1.42978e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=37, gb_free=13.3, wall=189813
2024-11-11 15:28:48 - progress_bar.py[line:274] - INFO: epoch 074:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17110.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2944.7, ups=0.17, wpb=17110.9, bsz=1024, num_updates=28600, lr=1.42842e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=50, gb_free=13, wall=189871
2024-11-11 15:29:47 - progress_bar.py[line:274] - INFO: epoch 074:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17387.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2926, ups=0.17, wpb=17387.2, bsz=1024, num_updates=28610, lr=1.42706e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=189930
2024-11-11 15:30:47 - progress_bar.py[line:274] - INFO: epoch 074:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17010.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2880.8, ups=0.17, wpb=17010.1, bsz=1024, num_updates=28620, lr=1.4257e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.3, wall=189989
2024-11-11 15:31:40 - progress_bar.py[line:274] - INFO: epoch 074:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17422.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3229.8, ups=0.19, wpb=17422.1, bsz=1024, num_updates=28630, lr=1.42433e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=51, gb_free=13.2, wall=190043
2024-11-11 15:32:37 - progress_bar.py[line:274] - INFO: epoch 074:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17142.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3056.9, ups=0.18, wpb=17142.9, bsz=1024, num_updates=28640, lr=1.42297e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=190099
2024-11-11 15:33:34 - progress_bar.py[line:274] - INFO: epoch 074:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=16992, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2972.8, ups=0.17, wpb=16992, bsz=1024, num_updates=28650, lr=1.42161e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=190157
2024-11-11 15:34:31 - progress_bar.py[line:274] - INFO: epoch 074:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17365.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3042.6, ups=0.18, wpb=17365.5, bsz=1024, num_updates=28660, lr=1.42025e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=190214
2024-11-11 15:35:27 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 15:35:33 - progress_bar.py[line:274] - INFO: epoch 074:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17305.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2769.6, ups=0.16, wpb=17305.5, bsz=1024, num_updates=28670, lr=1.41889e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=35, gb_free=13, wall=190276
2024-11-11 15:36:32 - progress_bar.py[line:274] - INFO: epoch 074:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17038.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2913.7, ups=0.17, wpb=17038.4, bsz=1024, num_updates=28680, lr=1.41753e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=41, gb_free=13.4, wall=190335
2024-11-11 15:37:30 - progress_bar.py[line:274] - INFO: epoch 074:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17166.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2961.6, ups=0.17, wpb=17166.2, bsz=1024, num_updates=28690, lr=1.41617e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.2, wall=190393
2024-11-11 15:38:28 - progress_bar.py[line:274] - INFO: epoch 074:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17016.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2921.8, ups=0.17, wpb=17016.4, bsz=1024, num_updates=28700, lr=1.41481e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=190451
2024-11-11 15:39:27 - progress_bar.py[line:274] - INFO: epoch 074:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17094.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2917.6, ups=0.17, wpb=17094.8, bsz=1024, num_updates=28710, lr=1.41345e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=190509
2024-11-11 15:40:22 - progress_bar.py[line:274] - INFO: epoch 074:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17038.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3079.5, ups=0.18, wpb=17038.8, bsz=1024, num_updates=28720, lr=1.41209e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=190565
2024-11-11 15:41:17 - progress_bar.py[line:274] - INFO: epoch 074:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17161.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3090.7, ups=0.18, wpb=17161.4, bsz=1024, num_updates=28730, lr=1.41073e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=190620
2024-11-11 15:42:16 - progress_bar.py[line:274] - INFO: epoch 074:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17338.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2982.8, ups=0.17, wpb=17338.4, bsz=1024, num_updates=28740, lr=1.40937e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.2, wall=190678
2024-11-11 15:43:13 - progress_bar.py[line:274] - INFO: epoch 074:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17152.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2991.5, ups=0.17, wpb=17152.1, bsz=1024, num_updates=28750, lr=1.40801e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13, wall=190736
2024-11-11 15:44:07 - progress_bar.py[line:274] - INFO: epoch 074:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17421.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3224.3, ups=0.19, wpb=17421.2, bsz=1024, num_updates=28760, lr=1.40665e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=190790
2024-11-11 15:45:04 - progress_bar.py[line:274] - INFO: epoch 074:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17335.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3026.2, ups=0.17, wpb=17335.9, bsz=1024, num_updates=28770, lr=1.40529e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=40, gb_free=13.4, wall=190847
2024-11-11 15:46:03 - progress_bar.py[line:274] - INFO: epoch 074:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=16998.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2882.6, ups=0.17, wpb=16998.4, bsz=1024, num_updates=28780, lr=1.40393e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=190906
2024-11-11 15:46:58 - progress_bar.py[line:274] - INFO: epoch 074:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17092.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3104, ups=0.18, wpb=17092.5, bsz=1024, num_updates=28790, lr=1.40257e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.1, wall=190961
2024-11-11 15:47:54 - progress_bar.py[line:274] - INFO: epoch 074:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17015, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3032.2, ups=0.18, wpb=17015, bsz=1024, num_updates=28800, lr=1.40121e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=46, gb_free=13.1, wall=191017
2024-11-11 15:48:52 - progress_bar.py[line:274] - INFO: epoch 074:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17201.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2974.5, ups=0.17, wpb=17201.5, bsz=1024, num_updates=28810, lr=1.39985e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=191075
2024-11-11 15:49:50 - progress_bar.py[line:274] - INFO: epoch 074:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17209.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2957.8, ups=0.17, wpb=17209.6, bsz=1024, num_updates=28820, lr=1.39849e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=191133
2024-11-11 15:50:48 - progress_bar.py[line:274] - INFO: epoch 074:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17295.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2979.9, ups=0.17, wpb=17295.9, bsz=1024, num_updates=28830, lr=1.39713e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=58, gb_free=13.4, wall=191191
2024-11-11 15:51:43 - progress_bar.py[line:274] - INFO: epoch 074:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17368.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3163.2, ups=0.18, wpb=17368.4, bsz=1024, num_updates=28840, lr=1.39577e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13.4, wall=191246
2024-11-11 15:52:41 - progress_bar.py[line:274] - INFO: epoch 074:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17211, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3008, ups=0.17, wpb=17211, bsz=1024, num_updates=28850, lr=1.39441e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=51, gb_free=13.5, wall=191303
2024-11-11 15:53:38 - progress_bar.py[line:274] - INFO: epoch 074:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17167.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3000.3, ups=0.17, wpb=17167.7, bsz=1024, num_updates=28860, lr=1.39305e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=55, gb_free=13, wall=191361
2024-11-11 15:54:36 - progress_bar.py[line:274] - INFO: epoch 074:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17376.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3006.7, ups=0.17, wpb=17376.1, bsz=1024, num_updates=28870, lr=1.39169e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=13.5, wall=191418
2024-11-11 15:55:33 - progress_bar.py[line:274] - INFO: epoch 074:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17434.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3025.7, ups=0.17, wpb=17434.6, bsz=1024, num_updates=28880, lr=1.39032e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=58, gb_free=12.9, wall=191476
2024-11-11 15:56:27 - progress_bar.py[line:274] - INFO: epoch 074:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17354.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3253, ups=0.19, wpb=17354.5, bsz=1024, num_updates=28890, lr=1.38896e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=53, gb_free=13.4, wall=191529
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt2024-11-11 15:57:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 74 @ 28898 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt
2024-11-11 15:57:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt': File exists: File exists: File exists
: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 15:58:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-11 16:00:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 74 @ 28898 updates, score 0) (writing took 222.40203191991895 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_74.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 16:01:44 - train.py[line:336] - INFO: end of epoch 74 (average epoch stats below)
2024-11-11 16:01:44 - progress_bar.py[line:282] - INFO: epoch 074 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.609 | ntokens 17181.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.1 | wps 2510.5 | ups 0.15 | wpb 17181.5 | bsz 1023 | num_updates 28898 | lr 1.38788e-05 | gnorm 0.004 | clip 0 | loss_scale 32768 | train_wall 1824 | gb_free 13.4 | wall 191846
2024-11-11 16:01:44 - trainer.py[line:639] - INFO: loading train data for epoch 75
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 16:04:26 - trainer.py[line:703] - INFO: begin training epoch 75
2024-11-11 16:04:26 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 16:04:39 - progress_bar.py[line:274] - INFO: epoch 075:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=16521.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=335.3, ups=0.02, wpb=16521.6, bsz=985.6, num_updates=28900, lr=1.3876e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=44, gb_free=13.2, wall=192022
2024-11-11 16:05:37 - progress_bar.py[line:274] - INFO: epoch 075:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17335.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3010.9, ups=0.17, wpb=17335.4, bsz=1024, num_updates=28910, lr=1.38624e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=192080
2024-11-11 16:06:34 - progress_bar.py[line:274] - INFO: epoch 075:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.636, ntokens=17395.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=3016.8, ups=0.17, wpb=17395.2, bsz=1024, num_updates=28920, lr=1.38488e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=192137
2024-11-11 16:07:32 - progress_bar.py[line:274] - INFO: epoch 075:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17143.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3004.4, ups=0.18, wpb=17143.7, bsz=1024, num_updates=28930, lr=1.38352e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=192194
2024-11-11 16:08:29 - progress_bar.py[line:274] - INFO: epoch 075:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.635, ntokens=17430.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=3039.8, ups=0.17, wpb=17430.6, bsz=1024, num_updates=28940, lr=1.38216e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=192252
2024-11-11 16:08:57 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 16:09:32 - progress_bar.py[line:274] - INFO: epoch 075:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=16884, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2668.7, ups=0.16, wpb=16884, bsz=1024, num_updates=28950, lr=1.3808e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=36, gb_free=12.7, wall=192315
2024-11-11 16:10:30 - progress_bar.py[line:274] - INFO: epoch 075:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=16978, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=2943.2, ups=0.17, wpb=16978, bsz=1024, num_updates=28960, lr=1.37944e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=192373
2024-11-11 16:11:27 - progress_bar.py[line:274] - INFO: epoch 075:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=16990.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2989.2, ups=0.18, wpb=16990.3, bsz=1024, num_updates=28970, lr=1.37808e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=192430
2024-11-11 16:12:22 - progress_bar.py[line:274] - INFO: epoch 075:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17115.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3110.5, ups=0.18, wpb=17115.7, bsz=1024, num_updates=28980, lr=1.37672e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=37, gb_free=13.2, wall=192485
2024-11-11 16:13:19 - progress_bar.py[line:274] - INFO: epoch 075:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17148.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3012.2, ups=0.18, wpb=17148.4, bsz=1024, num_updates=28990, lr=1.37536e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=37, gb_free=13.2, wall=192542
2024-11-11 16:14:17 - progress_bar.py[line:274] - INFO: epoch 075:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17233.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2958, ups=0.17, wpb=17233.9, bsz=1024, num_updates=29000, lr=1.374e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=192600
2024-11-11 16:15:15 - progress_bar.py[line:274] - INFO: epoch 075:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17190.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2950.2, ups=0.17, wpb=17190.1, bsz=1024, num_updates=29010, lr=1.37264e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=192658
2024-11-11 16:16:13 - progress_bar.py[line:274] - INFO: epoch 075:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17331.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2979.6, ups=0.17, wpb=17331.1, bsz=1024, num_updates=29020, lr=1.37128e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13, wall=192716
2024-11-11 16:17:12 - progress_bar.py[line:274] - INFO: epoch 075:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17237.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2952.8, ups=0.17, wpb=17237.1, bsz=1024, num_updates=29030, lr=1.36992e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=48, gb_free=13.4, wall=192775
2024-11-11 16:18:07 - progress_bar.py[line:274] - INFO: epoch 075:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17101.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3077.1, ups=0.18, wpb=17101.3, bsz=1024, num_updates=29040, lr=1.36856e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=192830
2024-11-11 16:19:04 - progress_bar.py[line:274] - INFO: epoch 075:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17421.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3046.6, ups=0.17, wpb=17421.7, bsz=1024, num_updates=29050, lr=1.3672e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=192887
2024-11-11 16:20:02 - progress_bar.py[line:274] - INFO: epoch 075:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.648, ntokens=17456.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.27, wps=3026.3, ups=0.17, wpb=17456.4, bsz=1024, num_updates=29060, lr=1.36584e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=192945
2024-11-11 16:21:01 - progress_bar.py[line:274] - INFO: epoch 075:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17171.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2918.5, ups=0.17, wpb=17171.4, bsz=1024, num_updates=29070, lr=1.36448e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=35, gb_free=13.5, wall=193004
2024-11-11 16:21:57 - progress_bar.py[line:274] - INFO: epoch 075:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17058.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3022.9, ups=0.18, wpb=17058.1, bsz=1024, num_updates=29080, lr=1.36312e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=193060
2024-11-11 16:22:55 - progress_bar.py[line:274] - INFO: epoch 075:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17127.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2963.4, ups=0.17, wpb=17127.9, bsz=1024, num_updates=29090, lr=1.36176e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=193118
2024-11-11 16:23:53 - progress_bar.py[line:274] - INFO: epoch 075:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17117.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2958.5, ups=0.17, wpb=17117.8, bsz=1024, num_updates=29100, lr=1.3604e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=193176
2024-11-11 16:24:51 - progress_bar.py[line:274] - INFO: epoch 075:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17015.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2961.3, ups=0.17, wpb=17015.1, bsz=1024, num_updates=29110, lr=1.35904e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=193233
2024-11-11 16:25:48 - progress_bar.py[line:274] - INFO: epoch 075:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17128.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2988.1, ups=0.17, wpb=17128.8, bsz=1024, num_updates=29120, lr=1.35768e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=193291
2024-11-11 16:26:45 - progress_bar.py[line:274] - INFO: epoch 075:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17315.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3003.5, ups=0.17, wpb=17315.2, bsz=1024, num_updates=29130, lr=1.35631e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=193348
2024-11-11 16:27:44 - progress_bar.py[line:274] - INFO: epoch 075:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17322.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.22, wps=2984.2, ups=0.17, wpb=17322.2, bsz=1024, num_updates=29140, lr=1.35495e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=193406
2024-11-11 16:28:41 - progress_bar.py[line:274] - INFO: epoch 075:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17124.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2956.4, ups=0.17, wpb=17124.3, bsz=1024, num_updates=29150, lr=1.35359e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=193464
2024-11-11 16:29:40 - progress_bar.py[line:274] - INFO: epoch 075:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17431.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2996.9, ups=0.17, wpb=17431.3, bsz=1024, num_updates=29160, lr=1.35223e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=193523
2024-11-11 16:30:37 - progress_bar.py[line:274] - INFO: epoch 075:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17208.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2993, ups=0.17, wpb=17208.1, bsz=1024, num_updates=29170, lr=1.35087e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=193580
2024-11-11 16:31:36 - progress_bar.py[line:274] - INFO: epoch 075:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=16934.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2869.4, ups=0.17, wpb=16934.9, bsz=1024, num_updates=29180, lr=1.34951e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=45, gb_free=12.9, wall=193639
2024-11-11 16:32:31 - progress_bar.py[line:274] - INFO: epoch 075:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.643, ntokens=17433.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3154, ups=0.18, wpb=17433.8, bsz=1024, num_updates=29190, lr=1.34815e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=45, gb_free=13, wall=193694
2024-11-11 16:33:29 - progress_bar.py[line:274] - INFO: epoch 075:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17224.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2981.6, ups=0.17, wpb=17224.1, bsz=1024, num_updates=29200, lr=1.34679e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=193752
2024-11-11 16:34:27 - progress_bar.py[line:274] - INFO: epoch 075:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17161.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2965.3, ups=0.17, wpb=17161.2, bsz=1024, num_updates=29210, lr=1.34543e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=193810
2024-11-11 16:35:25 - progress_bar.py[line:274] - INFO: epoch 075:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=16921.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2941.3, ups=0.17, wpb=16921.9, bsz=1024, num_updates=29220, lr=1.34407e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=193867
2024-11-11 16:36:22 - progress_bar.py[line:274] - INFO: epoch 075:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17362.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3017, ups=0.17, wpb=17362.4, bsz=1024, num_updates=29230, lr=1.34271e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=193925
2024-11-11 16:37:21 - progress_bar.py[line:274] - INFO: epoch 075:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17025.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2900, ups=0.17, wpb=17025.8, bsz=1024, num_updates=29240, lr=1.34135e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=193984
2024-11-11 16:38:19 - progress_bar.py[line:274] - INFO: epoch 075:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17048.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2915.4, ups=0.17, wpb=17048.2, bsz=1024, num_updates=29250, lr=1.33999e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=46, gb_free=13, wall=194042
2024-11-11 16:39:17 - progress_bar.py[line:274] - INFO: epoch 075:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17491.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=3033, ups=0.17, wpb=17491.5, bsz=1024, num_updates=29260, lr=1.33863e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=49, gb_free=13.5, wall=194100
2024-11-11 16:40:12 - progress_bar.py[line:274] - INFO: epoch 075:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17370.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3156.6, ups=0.18, wpb=17370.3, bsz=1024, num_updates=29270, lr=1.33727e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=37, gb_free=13.1, wall=194155
2024-11-11 16:41:09 - progress_bar.py[line:274] - INFO: epoch 075:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=16974.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2983.2, ups=0.18, wpb=16974.3, bsz=1024, num_updates=29280, lr=1.33591e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=194212
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt2024-11-11 16:41:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 75 @ 29288 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt
2024-11-11 16:41:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 16:43:39 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-11 16:45:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 75 @ 29288 updates, score 0) (writing took 223.2764590139268 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_75.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 16:46:29 - train.py[line:336] - INFO: end of epoch 75 (average epoch stats below)
2024-11-11 16:46:29 - progress_bar.py[line:282] - INFO: epoch 075 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.606 | ntokens 17175.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.09 | wps 2494.4 | ups 0.15 | wpb 17175.8 | bsz 1023 | num_updates 29288 | lr 1.33482e-05 | gnorm 0.003 | clip 0 | loss_scale 16384 | train_wall 1393 | gb_free 13.4 | wall 194532
2024-11-11 16:46:29 - trainer.py[line:639] - INFO: loading train data for epoch 76
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 16:49:10 - trainer.py[line:703] - INFO: begin training epoch 76
2024-11-11 16:49:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 16:49:24 - progress_bar.py[line:274] - INFO: epoch 076:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=16458, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=332.6, ups=0.02, wpb=16458, bsz=985.6, num_updates=29290, lr=1.33455e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=44, gb_free=13.3, wall=194707
2024-11-11 16:50:22 - progress_bar.py[line:274] - INFO: epoch 076:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2984.7, ups=0.17, wpb=17227.5, bsz=1024, num_updates=29300, lr=1.33319e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=194764
2024-11-11 16:51:20 - progress_bar.py[line:274] - INFO: epoch 076:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17355.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2983.4, ups=0.17, wpb=17355.2, bsz=1024, num_updates=29310, lr=1.33183e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=194823
2024-11-11 16:52:17 - progress_bar.py[line:274] - INFO: epoch 076:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17005.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2945.7, ups=0.17, wpb=17005.3, bsz=1024, num_updates=29320, lr=1.33047e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=194880
2024-11-11 16:53:15 - progress_bar.py[line:274] - INFO: epoch 076:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17065.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2951.6, ups=0.17, wpb=17065.3, bsz=1024, num_updates=29330, lr=1.32911e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=194938
2024-11-11 16:54:13 - progress_bar.py[line:274] - INFO: epoch 076:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17202.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2966.1, ups=0.17, wpb=17202.9, bsz=1024, num_updates=29340, lr=1.32775e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=12.8, wall=194996
2024-11-11 16:55:12 - progress_bar.py[line:274] - INFO: epoch 076:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17080.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2921.4, ups=0.17, wpb=17080.7, bsz=1024, num_updates=29350, lr=1.32639e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=195055
2024-11-11 16:56:09 - progress_bar.py[line:274] - INFO: epoch 076:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17131.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3001.7, ups=0.18, wpb=17131.8, bsz=1024, num_updates=29360, lr=1.32503e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=195112
2024-11-11 16:57:07 - progress_bar.py[line:274] - INFO: epoch 076:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17318.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2997.8, ups=0.17, wpb=17318.9, bsz=1024, num_updates=29370, lr=1.32367e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=195169
2024-11-11 16:58:05 - progress_bar.py[line:274] - INFO: epoch 076:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=16978.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2891, ups=0.17, wpb=16978.5, bsz=1024, num_updates=29380, lr=1.32231e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=35, gb_free=13, wall=195228
2024-11-11 16:59:04 - progress_bar.py[line:274] - INFO: epoch 076:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17291.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2920.1, ups=0.17, wpb=17291.8, bsz=1024, num_updates=29390, lr=1.32094e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=50, gb_free=13.4, wall=195287
2024-11-11 17:00:00 - progress_bar.py[line:274] - INFO: epoch 076:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17106.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3083.2, ups=0.18, wpb=17106.2, bsz=1024, num_updates=29400, lr=1.31958e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=46, gb_free=13.3, wall=195343
2024-11-11 17:00:59 - progress_bar.py[line:274] - INFO: epoch 076:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17232, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2909.8, ups=0.17, wpb=17232, bsz=1024, num_updates=29410, lr=1.31822e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=195402
2024-11-11 17:01:58 - progress_bar.py[line:274] - INFO: epoch 076:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17235.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2925.8, ups=0.17, wpb=17235.5, bsz=1024, num_updates=29420, lr=1.31686e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=195461
2024-11-11 17:02:56 - progress_bar.py[line:274] - INFO: epoch 076:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=16972, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2911.6, ups=0.17, wpb=16972, bsz=1024, num_updates=29430, lr=1.3155e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=54, gb_free=13.3, wall=195519
2024-11-11 17:03:54 - progress_bar.py[line:274] - INFO: epoch 076:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17213.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2979.7, ups=0.17, wpb=17213.3, bsz=1024, num_updates=29440, lr=1.31414e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=195577
2024-11-11 17:04:49 - progress_bar.py[line:274] - INFO: epoch 076:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17093.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3092.3, ups=0.18, wpb=17093.1, bsz=1024, num_updates=29450, lr=1.31278e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=45, gb_free=13.3, wall=195632
2024-11-11 17:05:48 - progress_bar.py[line:274] - INFO: epoch 076:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17142.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2913.3, ups=0.17, wpb=17142.6, bsz=1024, num_updates=29460, lr=1.31142e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=43, gb_free=13.1, wall=195691
2024-11-11 17:06:47 - progress_bar.py[line:274] - INFO: epoch 076:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17104.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2915.1, ups=0.17, wpb=17104.1, bsz=1024, num_updates=29470, lr=1.31006e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=54, gb_free=13.2, wall=195750
2024-11-11 17:07:46 - progress_bar.py[line:274] - INFO: epoch 076:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=16950.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2873.6, ups=0.17, wpb=16950.3, bsz=1024, num_updates=29480, lr=1.3087e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=195809
2024-11-11 17:08:42 - progress_bar.py[line:274] - INFO: epoch 076:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.645, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.25, wps=3096, ups=0.18, wpb=17478.4, bsz=1024, num_updates=29490, lr=1.30734e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=195865
2024-11-11 17:09:39 - progress_bar.py[line:274] - INFO: epoch 076:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17046.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3031.8, ups=0.18, wpb=17046.2, bsz=1024, num_updates=29500, lr=1.30598e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=55, gb_free=13.3, wall=195922
2024-11-11 17:10:36 - progress_bar.py[line:274] - INFO: epoch 076:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17113.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2996, ups=0.18, wpb=17113.9, bsz=1024, num_updates=29510, lr=1.30462e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=35, gb_free=13.4, wall=195979
2024-11-11 17:11:33 - progress_bar.py[line:274] - INFO: epoch 076:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17021.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2992, ups=0.18, wpb=17021.7, bsz=1024, num_updates=29520, lr=1.30326e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=196036
2024-11-11 17:12:30 - progress_bar.py[line:274] - INFO: epoch 076:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17139.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2979.2, ups=0.17, wpb=17139.5, bsz=1024, num_updates=29530, lr=1.3019e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=196093
2024-11-11 17:13:28 - progress_bar.py[line:274] - INFO: epoch 076:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17268, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3007.3, ups=0.17, wpb=17268, bsz=1024, num_updates=29540, lr=1.30054e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=196150
2024-11-11 17:14:26 - progress_bar.py[line:274] - INFO: epoch 076:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17307, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2972.8, ups=0.17, wpb=17307, bsz=1024, num_updates=29550, lr=1.29918e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=34, gb_free=12.8, wall=196209
2024-11-11 17:15:23 - progress_bar.py[line:274] - INFO: epoch 076:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=16879.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2964, ups=0.18, wpb=16879.9, bsz=1024, num_updates=29560, lr=1.29782e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=196266
2024-11-11 17:16:20 - progress_bar.py[line:274] - INFO: epoch 076:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17012.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2973.5, ups=0.17, wpb=17012.9, bsz=1024, num_updates=29570, lr=1.29646e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=196323
2024-11-11 17:17:18 - progress_bar.py[line:274] - INFO: epoch 076:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17177.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2977.3, ups=0.17, wpb=17177.6, bsz=1024, num_updates=29580, lr=1.2951e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=196381
2024-11-11 17:18:15 - progress_bar.py[line:274] - INFO: epoch 076:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.621, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3026.4, ups=0.17, wpb=17420.4, bsz=1024, num_updates=29590, lr=1.29374e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=196438
2024-11-11 17:19:13 - progress_bar.py[line:274] - INFO: epoch 076:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17187.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2990.1, ups=0.17, wpb=17187.4, bsz=1024, num_updates=29600, lr=1.29238e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=196496
2024-11-11 17:20:11 - progress_bar.py[line:274] - INFO: epoch 076:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17074.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2943.1, ups=0.17, wpb=17074.1, bsz=1024, num_updates=29610, lr=1.29102e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=196554
2024-11-11 17:21:09 - progress_bar.py[line:274] - INFO: epoch 076:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17245.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2959.1, ups=0.17, wpb=17245.7, bsz=1024, num_updates=29620, lr=1.28966e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=196612
2024-11-11 17:22:06 - progress_bar.py[line:274] - INFO: epoch 076:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17251.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3010.8, ups=0.17, wpb=17251.4, bsz=1024, num_updates=29630, lr=1.2883e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=196669
2024-11-11 17:23:04 - progress_bar.py[line:274] - INFO: epoch 076:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17154.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2974.5, ups=0.17, wpb=17154.4, bsz=1024, num_updates=29640, lr=1.28693e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=196727
2024-11-11 17:24:02 - progress_bar.py[line:274] - INFO: epoch 076:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17187.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2974.3, ups=0.17, wpb=17187.9, bsz=1024, num_updates=29650, lr=1.28557e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=196785
2024-11-11 17:24:54 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 17:25:05 - progress_bar.py[line:274] - INFO: epoch 076:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17251.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2736.7, ups=0.16, wpb=17251.9, bsz=1024, num_updates=29660, lr=1.28421e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13.1, wall=196848
2024-11-11 17:26:02 - progress_bar.py[line:274] - INFO: epoch 076:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17183.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2993, ups=0.17, wpb=17183.1, bsz=1024, num_updates=29670, lr=1.28285e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=196905
2024-11-11 17:26:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 76 @ 29678 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt




cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt
2024-11-11 17:26:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt': File exists: File exists
: File exists
: File exists

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 17:28:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-11 17:30:27 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 76 @ 29678 updates, score 0) (writing took 222.0389929349767 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_76.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 17:31:23 - train.py[line:336] - INFO: end of epoch 76 (average epoch stats below)
2024-11-11 17:31:23 - progress_bar.py[line:282] - INFO: epoch 076 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.597 | ntokens 17143.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.05 | wps 2481.9 | ups 0.14 | wpb 17143.8 | bsz 1023 | num_updates 29678 | lr 1.28177e-05 | gnorm 0.004 | clip 0 | loss_scale 16384 | train_wall 1480 | gb_free 13.2 | wall 197226
2024-11-11 17:31:23 - trainer.py[line:639] - INFO: loading train data for epoch 77
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 17:34:04 - trainer.py[line:703] - INFO: begin training epoch 77
2024-11-11 17:34:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 17:34:18 - progress_bar.py[line:274] - INFO: epoch 077:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=16601.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=335.2, ups=0.02, wpb=16601.1, bsz=985.6, num_updates=29680, lr=1.28149e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=48, gb_free=13.3, wall=197400
2024-11-11 17:35:16 - progress_bar.py[line:274] - INFO: epoch 077:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17026.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2935, ups=0.17, wpb=17026.2, bsz=1024, num_updates=29690, lr=1.28013e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=197458
2024-11-11 17:36:13 - progress_bar.py[line:274] - INFO: epoch 077:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17232.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2988.6, ups=0.17, wpb=17232.8, bsz=1024, num_updates=29700, lr=1.27877e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=197516
2024-11-11 17:37:10 - progress_bar.py[line:274] - INFO: epoch 077:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17118, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3011.7, ups=0.18, wpb=17118, bsz=1024, num_updates=29710, lr=1.27741e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=197573
2024-11-11 17:38:07 - progress_bar.py[line:274] - INFO: epoch 077:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17038.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2977.3, ups=0.17, wpb=17038.4, bsz=1024, num_updates=29720, lr=1.27605e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=197630
2024-11-11 17:39:04 - progress_bar.py[line:274] - INFO: epoch 077:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17022.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2998, ups=0.18, wpb=17022.7, bsz=1024, num_updates=29730, lr=1.27469e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=197687
2024-11-11 17:40:01 - progress_bar.py[line:274] - INFO: epoch 077:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17091, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3001.7, ups=0.18, wpb=17091, bsz=1024, num_updates=29740, lr=1.27333e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=197744
2024-11-11 17:40:59 - progress_bar.py[line:274] - INFO: epoch 077:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=16942.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2943.1, ups=0.17, wpb=16942.9, bsz=1024, num_updates=29750, lr=1.27197e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=197801
2024-11-11 17:41:56 - progress_bar.py[line:274] - INFO: epoch 077:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17106.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2975.7, ups=0.17, wpb=17106.7, bsz=1024, num_updates=29760, lr=1.27061e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=197859
2024-11-11 17:42:53 - progress_bar.py[line:274] - INFO: epoch 077:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17325.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3030.7, ups=0.17, wpb=17325.5, bsz=1024, num_updates=29770, lr=1.26925e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=197916
2024-11-11 17:43:50 - progress_bar.py[line:274] - INFO: epoch 077:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17301.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3024.2, ups=0.17, wpb=17301.3, bsz=1024, num_updates=29780, lr=1.26789e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=197973
2024-11-11 17:44:47 - progress_bar.py[line:274] - INFO: epoch 077:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3039.1, ups=0.18, wpb=17227.5, bsz=1024, num_updates=29790, lr=1.26653e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=33, gb_free=13.5, wall=198030
2024-11-11 17:45:44 - progress_bar.py[line:274] - INFO: epoch 077:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17341, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=3058.1, ups=0.18, wpb=17341, bsz=1024, num_updates=29800, lr=1.26517e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13.3, wall=198087
2024-11-11 17:46:42 - progress_bar.py[line:274] - INFO: epoch 077:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17208.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2969.7, ups=0.17, wpb=17208.6, bsz=1024, num_updates=29810, lr=1.26381e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=36, gb_free=13.4, wall=198145
2024-11-11 17:47:38 - progress_bar.py[line:274] - INFO: epoch 077:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=16997.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3028.3, ups=0.18, wpb=16997.5, bsz=1024, num_updates=29820, lr=1.26245e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=38, gb_free=13.2, wall=198201
2024-11-11 17:48:35 - progress_bar.py[line:274] - INFO: epoch 077:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17324.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3042.1, ups=0.18, wpb=17324.2, bsz=1024, num_updates=29830, lr=1.26109e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=198258
2024-11-11 17:49:32 - progress_bar.py[line:274] - INFO: epoch 077:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17309.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=3035, ups=0.18, wpb=17309.8, bsz=1024, num_updates=29840, lr=1.25973e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=198315
2024-11-11 17:50:28 - progress_bar.py[line:274] - INFO: epoch 077:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17150.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3049.4, ups=0.18, wpb=17150.3, bsz=1024, num_updates=29850, lr=1.25837e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=198371
2024-11-11 17:51:26 - progress_bar.py[line:274] - INFO: epoch 077:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17095.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2937.1, ups=0.17, wpb=17095.8, bsz=1024, num_updates=29860, lr=1.25701e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=33, gb_free=13.3, wall=198429
2024-11-11 17:52:23 - progress_bar.py[line:274] - INFO: epoch 077:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=16949.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2970.3, ups=0.18, wpb=16949.4, bsz=1024, num_updates=29870, lr=1.25565e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=198486
2024-11-11 17:53:21 - progress_bar.py[line:274] - INFO: epoch 077:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17303.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=3026.2, ups=0.17, wpb=17303.8, bsz=1024, num_updates=29880, lr=1.25429e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=198543
2024-11-11 17:54:18 - progress_bar.py[line:274] - INFO: epoch 077:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=16959.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2930.7, ups=0.17, wpb=16959.8, bsz=1024, num_updates=29890, lr=1.25292e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=198601
2024-11-11 17:55:17 - progress_bar.py[line:274] - INFO: epoch 077:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17150.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2938.8, ups=0.17, wpb=17150.4, bsz=1024, num_updates=29900, lr=1.25156e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=198660
2024-11-11 17:56:14 - progress_bar.py[line:274] - INFO: epoch 077:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17168.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2977.5, ups=0.17, wpb=17168.4, bsz=1024, num_updates=29910, lr=1.2502e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=198717
2024-11-11 17:57:13 - progress_bar.py[line:274] - INFO: epoch 077:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17206.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2962.4, ups=0.17, wpb=17206.4, bsz=1024, num_updates=29920, lr=1.24884e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=198775
2024-11-11 17:58:10 - progress_bar.py[line:274] - INFO: epoch 077:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17351.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3007.7, ups=0.17, wpb=17351.5, bsz=1024, num_updates=29930, lr=1.24748e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=198833
2024-11-11 17:59:08 - progress_bar.py[line:274] - INFO: epoch 077:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17073.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2950.4, ups=0.17, wpb=17073.8, bsz=1024, num_updates=29940, lr=1.24612e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=198891
2024-11-11 18:00:07 - progress_bar.py[line:274] - INFO: epoch 077:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=16890.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2854.2, ups=0.17, wpb=16890.6, bsz=1024, num_updates=29950, lr=1.24476e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=46, gb_free=13.3, wall=198950
2024-11-11 18:01:05 - progress_bar.py[line:274] - INFO: epoch 077:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17084.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2950.9, ups=0.17, wpb=17084.5, bsz=1024, num_updates=29960, lr=1.2434e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=199008
2024-11-11 18:02:03 - progress_bar.py[line:274] - INFO: epoch 077:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17365.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3003.7, ups=0.17, wpb=17365.2, bsz=1024, num_updates=29970, lr=1.24204e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=199066
2024-11-11 18:03:01 - progress_bar.py[line:274] - INFO: epoch 077:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17207.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2965, ups=0.17, wpb=17207.4, bsz=1024, num_updates=29980, lr=1.24068e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=12.7, wall=199124
2024-11-11 18:03:59 - progress_bar.py[line:274] - INFO: epoch 077:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17122.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2944.1, ups=0.17, wpb=17122.5, bsz=1024, num_updates=29990, lr=1.23932e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=199182
2024-11-11 18:04:57 - progress_bar.py[line:274] - INFO: epoch 077:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17238, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2967, ups=0.17, wpb=17238, bsz=1024, num_updates=30000, lr=1.23796e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=58, gb_free=13.3, wall=199240
loss_reg: 0.00382149579689362 loss_cls: 0.0045735640451312065
loss_reg: 0.004012056793076663 loss_cls: 0.0034042273182421923
loss_reg: 0.004107731267501197 loss_cls: 0.0031877593137323856
loss_reg: 0.004573991134048145 loss_cls: 0.004192523658275604
loss_reg: 0.004980375643975483 loss_cls: 0.005007155239582062
loss_reg: 0.004666074197044088 loss_cls: 0.0032900653313845396
loss_reg: 0.004584298859462604 loss_cls: 0.0029450112488120794
loss_reg: 0.0035741544484067626 loss_cls: 0.003539502853527665
loss_reg: 0.005132460722325282 loss_cls: 0.003305330639705062
loss_reg: 0.004795540005911404 loss_cls: 0.004823209252208471
loss_reg: 0.005087568180435075 loss_cls: 0.003960088826715946
loss_reg: 0.004392527544775102 loss_cls: 0.004354184493422508
loss_reg: 0.0057676131712935145 loss_cls: 0.002933457726612687
loss_reg: 0.004224742707596734 loss_cls: 0.003764340654015541
loss_reg: 0.004104421854067501 loss_cls: 0.0036278965417295694
loss_reg: 0.005908385095465422 loss_cls: 0.0033009767066687346
loss_reg: 0.005052841691665692 loss_cls: 0.0035852533765137196
loss_reg: 0.004965993326000247 loss_cls: 0.0032698214054107666
loss_reg: 0.003882594443397869 loss_cls: 0.003803993109613657
loss_reg: 0.005654710933151005 loss_cls: 0.004167561884969473
loss_reg: 0.005014789921631152 loss_cls: 0.0040998090989887714
loss_reg: 0.006241325767049031 loss_cls: 0.0026004351675510406
loss_reg: 0.006953770936305762 loss_cls: 0.003057420253753662
loss_reg: 0.005865953238884861 loss_cls: 0.0032360560726374388
loss_reg: 0.004747807086214472 loss_cls: 0.003155596787109971
loss_reg: 0.006407876428891562 loss_cls: 0.0037866723723709583
loss_reg: 0.008889441564051574 loss_cls: 0.0036302462685853243
loss_reg: 0.0068431841795325325 loss_cls: 0.0033934605307877064
loss_reg: 0.005157442829507247 loss_cls: 0.00344383274205029
loss_reg: 0.006251113924377474 loss_cls: 0.003707476891577244
loss_reg: 0.005198887992786842 loss_cls: 0.0035211609210819006
loss_reg: 0.006372088142115217 loss_cls: 0.004568417556583881
loss_reg: 0.00601442471818196 loss_cls: 0.003188861533999443
loss_reg: 0.005616373748699693 loss_cls: 0.004763265606015921
loss_reg: 0.0047467037584980505 loss_cls: 0.004881237167865038
loss_reg: 0.0057422624988969235 loss_cls: 0.0041871452704072
loss_reg: 0.006482054633254501 loss_cls: 0.003760885912925005
loss_reg: 0.004737851300315679 loss_cls: 0.003915159963071346
loss_reg: 0.006991655597753818 loss_cls: 0.004182873293757439
loss_reg: 0.006332611310986617 loss_cls: 0.0037623359821736813
loss_reg: 0.005628019233006298 loss_cls: 0.00337044196203351
loss_reg: 0.005024683601565669 loss_cls: 0.0042357235215604305
loss_reg: 0.004738727833093259 loss_cls: 0.004301936365664005
loss_reg: 0.004213285653434971 loss_cls: 0.0037962456699460745
loss_reg: 0.004965477993248415 loss_cls: 0.004643216263502836
loss_reg: 0.0040406852206571215 loss_cls: 0.0034433670807629824
loss_reg: 0.004752126507990657 loss_cls: 0.005605108104646206
loss_reg: 0.005172240941449671 loss_cls: 0.003774509998038411
loss_reg: 0.004817503170958251 loss_cls: 0.004458225332200527
loss_reg: 0.005019681972476819 loss_cls: 0.003987557720392942
loss_reg: 0.005889736989028579 loss_cls: 0.00457893218845129
loss_reg: 0.006153518611604197 loss_cls: 0.004474198445677757
loss_reg: 0.006024812206988847 loss_cls: 0.0029533442575484514
loss_reg: 0.005129271245934169 loss_cls: 0.0032906574197113514
loss_reg: 0.00660317095569787 loss_cls: 0.00303097371943295
loss_reg: 0.005606696127219802 loss_cls: 0.004503301810473204
loss_reg: 0.0050801064705116505 loss_cls: 0.003142057918012142
loss_reg: 0.004308833487740423 loss_cls: 0.0034197685308754444
loss_reg: 0.005128971636538959 loss_cls: 0.004768063314259052
loss_reg: 0.0060922641493804715 loss_cls: 0.0027832388877868652
loss_reg: 0.004441989773952275 loss_cls: 0.0036261461209505796
loss_reg: 0.007506500406246023 loss_cls: 0.0035311130341142416
loss_reg: 0.004486913434693915 loss_cls: 0.0033838122617453337
loss_reg: 0.006801151205115559 loss_cls: 0.0034443093463778496
2024-11-11 18:05:55 - progress_bar.py[line:274] - INFO: epoch 077:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17004.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2944.8, ups=0.17, wpb=17004.8, bsz=1024, num_updates=30010, lr=1.2366e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=58, gb_free=13.2, wall=199298
2024-11-11 18:06:53 - progress_bar.py[line:274] - INFO: epoch 077:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17308.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2967.4, ups=0.17, wpb=17308.7, bsz=1024, num_updates=30020, lr=1.23524e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.4, wall=199356
2024-11-11 18:07:51 - progress_bar.py[line:274] - INFO: epoch 077:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17228.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2966.1, ups=0.17, wpb=17228.2, bsz=1024, num_updates=30030, lr=1.23388e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=58, gb_free=13.5, wall=199414
2024-11-11 18:08:50 - progress_bar.py[line:274] - INFO: epoch 077:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17494.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2961.9, ups=0.17, wpb=17494.9, bsz=1024, num_updates=30040, lr=1.23252e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=59, gb_free=12.7, wall=199473
2024-11-11 18:09:50 - progress_bar.py[line:274] - INFO: epoch 077:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17154, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2903.7, ups=0.17, wpb=17154, bsz=1024, num_updates=30050, lr=1.23116e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=59, gb_free=13.1, wall=199532
2024-11-11 18:10:48 - progress_bar.py[line:274] - INFO: epoch 077:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17111.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2912.8, ups=0.17, wpb=17111.1, bsz=1024, num_updates=30060, lr=1.2298e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=59, gb_free=13.3, wall=199591
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt2024-11-11 18:11:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 77 @ 30069 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt
2024-11-11 18:11:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 18:13:23 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-11 18:15:17 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 77 @ 30069 updates, score 0) (writing took 222.33037100802176 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_77.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
2024-11-11 18:16:12 - train.py[line:336] - INFO: end of epoch 77 (average epoch stats below)
2024-11-11 18:16:12 - progress_bar.py[line:282] - INFO: epoch 077 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.594 | ntokens 17149.8 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.04 | wps 2493.8 | ups 0.15 | wpb 17149.8 | bsz 1023 | num_updates 30069 | lr 1.22857e-05 | gnorm 0.004 | clip 0 | loss_scale 16384 | train_wall 1561 | gb_free 13.2 | wall 199915
2024-11-11 18:16:12 - trainer.py[line:639] - INFO: loading train data for epoch 78
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 18:18:53 - trainer.py[line:703] - INFO: begin training epoch 78
2024-11-11 18:18:53 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 18:19:01 - progress_bar.py[line:274] - INFO: epoch 078:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=16521.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=335.3, ups=0.02, wpb=16521.5, bsz=985.6, num_updates=30070, lr=1.22844e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=49, gb_free=13.3, wall=200084
2024-11-11 18:19:59 - progress_bar.py[line:274] - INFO: epoch 078:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17200.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2954.9, ups=0.17, wpb=17200.6, bsz=1024, num_updates=30080, lr=1.22708e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=200142
2024-11-11 18:20:58 - progress_bar.py[line:274] - INFO: epoch 078:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17175.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2936.5, ups=0.17, wpb=17175.4, bsz=1024, num_updates=30090, lr=1.22572e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=200201
2024-11-11 18:21:56 - progress_bar.py[line:274] - INFO: epoch 078:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17081.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2920.2, ups=0.17, wpb=17081.2, bsz=1024, num_updates=30100, lr=1.22436e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=200259
2024-11-11 18:22:54 - progress_bar.py[line:274] - INFO: epoch 078:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17136, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2948.8, ups=0.17, wpb=17136, bsz=1024, num_updates=30110, lr=1.223e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=200317
2024-11-11 18:23:52 - progress_bar.py[line:274] - INFO: epoch 078:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=16998.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2965.3, ups=0.17, wpb=16998.1, bsz=1024, num_updates=30120, lr=1.22164e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=200375
2024-11-11 18:24:49 - progress_bar.py[line:274] - INFO: epoch 078:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17110.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2974, ups=0.17, wpb=17110.4, bsz=1024, num_updates=30130, lr=1.22028e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=200432
2024-11-11 18:25:46 - progress_bar.py[line:274] - INFO: epoch 078:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17048, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2982.9, ups=0.17, wpb=17048, bsz=1024, num_updates=30140, lr=1.21891e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=200489
2024-11-11 18:26:44 - progress_bar.py[line:274] - INFO: epoch 078:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.622, ntokens=17409.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=3012.3, ups=0.17, wpb=17409.1, bsz=1024, num_updates=30150, lr=1.21755e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=200547
2024-11-11 18:27:42 - progress_bar.py[line:274] - INFO: epoch 078:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17162.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2956.7, ups=0.17, wpb=17162.6, bsz=1024, num_updates=30160, lr=1.21619e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=200605
2024-11-11 18:28:39 - progress_bar.py[line:274] - INFO: epoch 078:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17291.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3019.4, ups=0.17, wpb=17291.4, bsz=1024, num_updates=30170, lr=1.21483e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=200662
2024-11-11 18:29:37 - progress_bar.py[line:274] - INFO: epoch 078:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=16994.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2944.3, ups=0.17, wpb=16994.4, bsz=1024, num_updates=30180, lr=1.21347e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=200720
2024-11-11 18:30:35 - progress_bar.py[line:274] - INFO: epoch 078:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17234.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2971.5, ups=0.17, wpb=17234.7, bsz=1024, num_updates=30190, lr=1.21211e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=200778
2024-11-11 18:31:33 - progress_bar.py[line:274] - INFO: epoch 078:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17183.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2994.2, ups=0.17, wpb=17183.1, bsz=1024, num_updates=30200, lr=1.21075e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=200836
2024-11-11 18:32:30 - progress_bar.py[line:274] - INFO: epoch 078:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=16775.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2899.3, ups=0.17, wpb=16775.8, bsz=1024, num_updates=30210, lr=1.20939e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=200893
2024-11-11 18:33:28 - progress_bar.py[line:274] - INFO: epoch 078:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17141.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2975.5, ups=0.17, wpb=17141.5, bsz=1024, num_updates=30220, lr=1.20803e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=200951
2024-11-11 18:34:26 - progress_bar.py[line:274] - INFO: epoch 078:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17100.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2973.2, ups=0.17, wpb=17100.4, bsz=1024, num_updates=30230, lr=1.20667e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=201008
2024-11-11 18:35:24 - progress_bar.py[line:274] - INFO: epoch 078:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17028.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2927.2, ups=0.17, wpb=17028.6, bsz=1024, num_updates=30240, lr=1.20531e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=201067
2024-11-11 18:36:22 - progress_bar.py[line:274] - INFO: epoch 078:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17120.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2950.3, ups=0.17, wpb=17120.5, bsz=1024, num_updates=30250, lr=1.20395e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=201125
2024-11-11 18:37:19 - progress_bar.py[line:274] - INFO: epoch 078:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=16914.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=2948.7, ups=0.17, wpb=16914.4, bsz=1024, num_updates=30260, lr=1.20259e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=12.8, wall=201182
2024-11-11 18:38:17 - progress_bar.py[line:274] - INFO: epoch 078:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17410.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2992.6, ups=0.17, wpb=17410.6, bsz=1024, num_updates=30270, lr=1.20123e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=201240
2024-11-11 18:39:15 - progress_bar.py[line:274] - INFO: epoch 078:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17157.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2963.9, ups=0.17, wpb=17157.9, bsz=1024, num_updates=30280, lr=1.19987e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=201298
2024-11-11 18:40:13 - progress_bar.py[line:274] - INFO: epoch 078:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17040.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2964.1, ups=0.17, wpb=17040.9, bsz=1024, num_updates=30290, lr=1.19851e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=201356
2024-11-11 18:41:10 - progress_bar.py[line:274] - INFO: epoch 078:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2984.5, ups=0.17, wpb=17239.6, bsz=1024, num_updates=30300, lr=1.19715e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=201413
2024-11-11 18:42:09 - progress_bar.py[line:274] - INFO: epoch 078:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17143.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2931.6, ups=0.17, wpb=17143.9, bsz=1024, num_updates=30310, lr=1.19579e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=201472
2024-11-11 18:43:07 - progress_bar.py[line:274] - INFO: epoch 078:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17152.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2956.4, ups=0.17, wpb=17152.2, bsz=1024, num_updates=30320, lr=1.19443e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=201530
2024-11-11 18:43:13 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 18:44:11 - progress_bar.py[line:274] - INFO: epoch 078:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17194.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2687, ups=0.16, wpb=17194.3, bsz=1024, num_updates=30330, lr=1.19307e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=12.7, wall=201594
2024-11-11 18:45:09 - progress_bar.py[line:274] - INFO: epoch 078:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2967.5, ups=0.17, wpb=17165.4, bsz=1024, num_updates=30340, lr=1.19171e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=201652
2024-11-11 18:46:07 - progress_bar.py[line:274] - INFO: epoch 078:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17078.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2945.8, ups=0.17, wpb=17078.2, bsz=1024, num_updates=30350, lr=1.19035e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=201710
2024-11-11 18:47:05 - progress_bar.py[line:274] - INFO: epoch 078:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17013.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2938.1, ups=0.17, wpb=17013.5, bsz=1024, num_updates=30360, lr=1.18899e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=201768
2024-11-11 18:48:03 - progress_bar.py[line:274] - INFO: epoch 078:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17268, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2956.5, ups=0.17, wpb=17268, bsz=1024, num_updates=30370, lr=1.18763e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=12.9, wall=201826
2024-11-11 18:49:01 - progress_bar.py[line:274] - INFO: epoch 078:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17074.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2947.7, ups=0.17, wpb=17074.6, bsz=1024, num_updates=30380, lr=1.18627e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=201884
2024-11-11 18:49:58 - progress_bar.py[line:274] - INFO: epoch 078:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17200.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3005.4, ups=0.17, wpb=17200.3, bsz=1024, num_updates=30390, lr=1.18491e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=201941
2024-11-11 18:50:56 - progress_bar.py[line:274] - INFO: epoch 078:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17175.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2973.7, ups=0.17, wpb=17175.5, bsz=1024, num_updates=30400, lr=1.18354e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=201999
2024-11-11 18:51:54 - progress_bar.py[line:274] - INFO: epoch 078:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17381.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3005.9, ups=0.17, wpb=17381.9, bsz=1024, num_updates=30410, lr=1.18218e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=202057
2024-11-11 18:52:51 - progress_bar.py[line:274] - INFO: epoch 078:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17223.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3008.5, ups=0.17, wpb=17223.2, bsz=1024, num_updates=30420, lr=1.18082e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=202114
2024-11-11 18:53:49 - progress_bar.py[line:274] - INFO: epoch 078:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17167.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2965.9, ups=0.17, wpb=17167.2, bsz=1024, num_updates=30430, lr=1.17946e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=202172
2024-11-11 18:54:47 - progress_bar.py[line:274] - INFO: epoch 078:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=17322.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3008.1, ups=0.17, wpb=17322.8, bsz=1024, num_updates=30440, lr=1.1781e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=202229
2024-11-11 18:55:44 - progress_bar.py[line:274] - INFO: epoch 078:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17346.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3040, ups=0.18, wpb=17346.9, bsz=1024, num_updates=30450, lr=1.17674e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=43, gb_free=13.4, wall=202287
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt
2024-11-11 18:56:32 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 78 @ 30459 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt

2024-11-11 18:56:32 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 18:58:21 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-11 19:00:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 78 @ 30459 updates, score 0) (writing took 222.5841604199959 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_78.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 19:01:11 - train.py[line:336] - INFO: end of epoch 78 (average epoch stats below)
2024-11-11 19:01:11 - progress_bar.py[line:282] - INFO: epoch 078 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.589 | ntokens 17140.5 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.02 | wps 2476.6 | ups 0.14 | wpb 17140.5 | bsz 1023 | num_updates 30459 | lr 1.17552e-05 | gnorm 0.003 | clip 0 | loss_scale 16384 | train_wall 1243 | gb_free 13.4 | wall 202614
2024-11-11 19:01:11 - trainer.py[line:639] - INFO: loading train data for epoch 79
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 19:03:52 - trainer.py[line:703] - INFO: begin training epoch 79
2024-11-11 19:03:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 19:04:00 - progress_bar.py[line:274] - INFO: epoch 079:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=16590.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=334.4, ups=0.02, wpb=16590.7, bsz=985.6, num_updates=30460, lr=1.17538e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=50, gb_free=13.3, wall=202783
2024-11-11 19:04:58 - progress_bar.py[line:274] - INFO: epoch 079:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17164.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2948.7, ups=0.17, wpb=17164.9, bsz=1024, num_updates=30470, lr=1.17402e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=202841
2024-11-11 19:05:56 - progress_bar.py[line:274] - INFO: epoch 079:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17387.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2977.6, ups=0.17, wpb=17387.3, bsz=1024, num_updates=30480, lr=1.17266e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=202899
2024-11-11 19:06:55 - progress_bar.py[line:274] - INFO: epoch 079:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17055.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2926.5, ups=0.17, wpb=17055.4, bsz=1024, num_updates=30490, lr=1.1713e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=202958
2024-11-11 19:07:54 - progress_bar.py[line:274] - INFO: epoch 079:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17246.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2931.3, ups=0.17, wpb=17246.5, bsz=1024, num_updates=30500, lr=1.16994e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=203016
2024-11-11 19:08:52 - progress_bar.py[line:274] - INFO: epoch 079:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17329.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2967.6, ups=0.17, wpb=17329.1, bsz=1024, num_updates=30510, lr=1.16858e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=203075
2024-11-11 19:09:50 - progress_bar.py[line:274] - INFO: epoch 079:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17169.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2939.3, ups=0.17, wpb=17169.4, bsz=1024, num_updates=30520, lr=1.16722e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=203133
2024-11-11 19:10:49 - progress_bar.py[line:274] - INFO: epoch 079:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=16944.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2908.2, ups=0.17, wpb=16944.7, bsz=1024, num_updates=30530, lr=1.16586e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203192
2024-11-11 19:11:46 - progress_bar.py[line:274] - INFO: epoch 079:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2982.6, ups=0.17, wpb=17258.7, bsz=1024, num_updates=30540, lr=1.1645e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203249
2024-11-11 19:12:44 - progress_bar.py[line:274] - INFO: epoch 079:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17245.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2976.9, ups=0.17, wpb=17245.4, bsz=1024, num_updates=30550, lr=1.16314e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=203307
2024-11-11 19:13:43 - progress_bar.py[line:274] - INFO: epoch 079:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17126.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2929.7, ups=0.17, wpb=17126.5, bsz=1024, num_updates=30560, lr=1.16178e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=203366
2024-11-11 19:14:42 - progress_bar.py[line:274] - INFO: epoch 079:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=16962.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2879.8, ups=0.17, wpb=16962.5, bsz=1024, num_updates=30570, lr=1.16042e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203425
2024-11-11 19:15:40 - progress_bar.py[line:274] - INFO: epoch 079:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.634, ntokens=17461.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.21, wps=2976.1, ups=0.17, wpb=17461.9, bsz=1024, num_updates=30580, lr=1.15906e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=203483
2024-11-11 19:16:39 - progress_bar.py[line:274] - INFO: epoch 079:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17217.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2949.3, ups=0.17, wpb=17217.6, bsz=1024, num_updates=30590, lr=1.1577e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=203542
2024-11-11 19:17:38 - progress_bar.py[line:274] - INFO: epoch 079:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=16855.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2867.6, ups=0.17, wpb=16855.5, bsz=1024, num_updates=30600, lr=1.15634e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203601
2024-11-11 19:18:37 - progress_bar.py[line:274] - INFO: epoch 079:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17255.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2918.1, ups=0.17, wpb=17255.9, bsz=1024, num_updates=30610, lr=1.15498e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=203660
2024-11-11 19:19:35 - progress_bar.py[line:274] - INFO: epoch 079:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17073, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2933, ups=0.17, wpb=17073, bsz=1024, num_updates=30620, lr=1.15362e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203718
2024-11-11 19:20:33 - progress_bar.py[line:274] - INFO: epoch 079:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=16957, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2899.8, ups=0.17, wpb=16957, bsz=1024, num_updates=30630, lr=1.15226e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203776
2024-11-11 19:21:32 - progress_bar.py[line:274] - INFO: epoch 079:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17199.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2945.6, ups=0.17, wpb=17199.2, bsz=1024, num_updates=30640, lr=1.1509e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=203835
2024-11-11 19:22:30 - progress_bar.py[line:274] - INFO: epoch 079:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=16966.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2893.9, ups=0.17, wpb=16966.1, bsz=1024, num_updates=30650, lr=1.14953e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=12.8, wall=203893
2024-11-11 19:23:29 - progress_bar.py[line:274] - INFO: epoch 079:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17325.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2954.9, ups=0.17, wpb=17325.8, bsz=1024, num_updates=30660, lr=1.14817e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=203952
2024-11-11 19:24:28 - progress_bar.py[line:274] - INFO: epoch 079:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=16966.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2904.2, ups=0.17, wpb=16966.5, bsz=1024, num_updates=30670, lr=1.14681e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=204010
2024-11-11 19:25:25 - progress_bar.py[line:274] - INFO: epoch 079:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17141.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2966.4, ups=0.17, wpb=17141.7, bsz=1024, num_updates=30680, lr=1.14545e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=204068
2024-11-11 19:26:23 - progress_bar.py[line:274] - INFO: epoch 079:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17175.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2966.3, ups=0.17, wpb=17175.9, bsz=1024, num_updates=30690, lr=1.14409e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=204126
2024-11-11 19:27:21 - progress_bar.py[line:274] - INFO: epoch 079:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17042.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2936.7, ups=0.17, wpb=17042.7, bsz=1024, num_updates=30700, lr=1.14273e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=204184
2024-11-11 19:28:20 - progress_bar.py[line:274] - INFO: epoch 079:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17107.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2932.2, ups=0.17, wpb=17107.4, bsz=1024, num_updates=30710, lr=1.14137e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=204242
2024-11-11 19:29:18 - progress_bar.py[line:274] - INFO: epoch 079:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17096.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2932.8, ups=0.17, wpb=17096.5, bsz=1024, num_updates=30720, lr=1.14001e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=204301
2024-11-11 19:30:16 - progress_bar.py[line:274] - INFO: epoch 079:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17156, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2938.7, ups=0.17, wpb=17156, bsz=1024, num_updates=30730, lr=1.13865e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=204359
2024-11-11 19:31:15 - progress_bar.py[line:274] - INFO: epoch 079:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17292.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2953.5, ups=0.17, wpb=17292.7, bsz=1024, num_updates=30740, lr=1.13729e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=204418
2024-11-11 19:32:13 - progress_bar.py[line:274] - INFO: epoch 079:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17131.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2943.9, ups=0.17, wpb=17131.8, bsz=1024, num_updates=30750, lr=1.13593e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=204476
2024-11-11 19:33:11 - progress_bar.py[line:274] - INFO: epoch 079:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17316.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2961.9, ups=0.17, wpb=17316.6, bsz=1024, num_updates=30760, lr=1.13457e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=204534
2024-11-11 19:34:10 - progress_bar.py[line:274] - INFO: epoch 079:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=16970.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2917.4, ups=0.17, wpb=16970.6, bsz=1024, num_updates=30770, lr=1.13321e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=204593
2024-11-11 19:35:08 - progress_bar.py[line:274] - INFO: epoch 079:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17021.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2936.5, ups=0.17, wpb=17021.9, bsz=1024, num_updates=30780, lr=1.13185e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=204651
2024-11-11 19:36:06 - progress_bar.py[line:274] - INFO: epoch 079:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17159, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2941.7, ups=0.17, wpb=17159, bsz=1024, num_updates=30790, lr=1.13049e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=204709
2024-11-11 19:37:05 - progress_bar.py[line:274] - INFO: epoch 079:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17121.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2921.3, ups=0.17, wpb=17121.8, bsz=1024, num_updates=30800, lr=1.12913e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=204767
2024-11-11 19:38:03 - progress_bar.py[line:274] - INFO: epoch 079:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17311.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2967.7, ups=0.17, wpb=17311.5, bsz=1024, num_updates=30810, lr=1.12777e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=204826
2024-11-11 19:39:01 - progress_bar.py[line:274] - INFO: epoch 079:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17244.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2952.4, ups=0.17, wpb=17244.1, bsz=1024, num_updates=30820, lr=1.12641e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=204884
2024-11-11 19:39:59 - progress_bar.py[line:274] - INFO: epoch 079:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17385.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3006.1, ups=0.17, wpb=17385.6, bsz=1024, num_updates=30830, lr=1.12505e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=32, gb_free=13.1, wall=204942
2024-11-11 19:40:57 - progress_bar.py[line:274] - INFO: epoch 079:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.625, ntokens=17467, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3019.3, ups=0.17, wpb=17467, bsz=1024, num_updates=30840, lr=1.12369e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=42, gb_free=13.4, wall=205000
2024-11-11 19:41:49 - progress_bar.py[line:274] - INFO: epoch 079:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=16477.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3194.4, ups=0.19, wpb=16477.5, bsz=985.6, num_updates=30850, lr=1.12233e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=33, gb_free=13.2, wall=205051
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt
2024-11-11 19:41:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 79 @ 30850 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt
2024-11-11 19:41:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 19:43:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 19:45:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 79 @ 30850 updates, score 0) (writing took 227.95147948898375 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_79.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-11 19:46:31 - train.py[line:336] - INFO: end of epoch 79 (average epoch stats below)
2024-11-11 19:46:31 - progress_bar.py[line:282] - INFO: epoch 079 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.588 | ntokens 17149.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.01 | wps 2464.9 | ups 0.14 | wpb 17149.3 | bsz 1023 | num_updates 30850 | lr 1.12233e-05 | gnorm 0.003 | clip 0 | loss_scale 32768 | train_wall 1224 | gb_free 13.2 | wall 205334
2024-11-11 19:46:31 - trainer.py[line:639] - INFO: loading train data for epoch 80
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 19:49:10 - trainer.py[line:703] - INFO: begin training epoch 80
2024-11-11 19:49:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 19:50:10 - progress_bar.py[line:274] - INFO: epoch 080:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17160.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=342.4, ups=0.02, wpb=17160.3, bsz=1024, num_updates=30860, lr=1.12097e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=205553
2024-11-11 19:51:08 - progress_bar.py[line:274] - INFO: epoch 080:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.63, ntokens=17470.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.19, wps=2996.6, ups=0.17, wpb=17470.3, bsz=1024, num_updates=30870, lr=1.11961e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=205611
2024-11-11 19:52:07 - progress_bar.py[line:274] - INFO: epoch 080:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17385.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2963.4, ups=0.17, wpb=17385.5, bsz=1024, num_updates=30880, lr=1.11825e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=205670
2024-11-11 19:53:05 - progress_bar.py[line:274] - INFO: epoch 080:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=16900.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=2897.6, ups=0.17, wpb=16900.2, bsz=1024, num_updates=30890, lr=1.11689e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=205728
2024-11-11 19:54:04 - progress_bar.py[line:274] - INFO: epoch 080:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17295.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2946.2, ups=0.17, wpb=17295.5, bsz=1024, num_updates=30900, lr=1.11552e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=205787
2024-11-11 19:55:03 - progress_bar.py[line:274] - INFO: epoch 080:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17400.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2954.6, ups=0.17, wpb=17400.5, bsz=1024, num_updates=30910, lr=1.11416e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=205846
2024-11-11 19:56:02 - progress_bar.py[line:274] - INFO: epoch 080:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=16887.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2861.7, ups=0.17, wpb=16887.1, bsz=1024, num_updates=30920, lr=1.1128e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=205905
2024-11-11 19:57:00 - progress_bar.py[line:274] - INFO: epoch 080:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17364.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2950, ups=0.17, wpb=17364.6, bsz=1024, num_updates=30930, lr=1.11144e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=205963
2024-11-11 19:58:00 - progress_bar.py[line:274] - INFO: epoch 080:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17049.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2877.5, ups=0.17, wpb=17049.6, bsz=1024, num_updates=30940, lr=1.11008e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=206023
2024-11-11 19:58:23 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-11 19:59:05 - progress_bar.py[line:274] - INFO: epoch 080:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17047.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2621.7, ups=0.15, wpb=17047.3, bsz=1024, num_updates=30950, lr=1.10872e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=34, gb_free=12.9, wall=206088
2024-11-11 20:00:04 - progress_bar.py[line:274] - INFO: epoch 080:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17161.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2897.6, ups=0.17, wpb=17161.9, bsz=1024, num_updates=30960, lr=1.10736e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=206147
2024-11-11 20:01:03 - progress_bar.py[line:274] - INFO: epoch 080:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17426.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=2931, ups=0.17, wpb=17426.6, bsz=1024, num_updates=30970, lr=1.106e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=206206
2024-11-11 20:02:02 - progress_bar.py[line:274] - INFO: epoch 080:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17140, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2913.8, ups=0.17, wpb=17140, bsz=1024, num_updates=30980, lr=1.10464e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206265
2024-11-11 20:03:01 - progress_bar.py[line:274] - INFO: epoch 080:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17151.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2915, ups=0.17, wpb=17151.9, bsz=1024, num_updates=30990, lr=1.10328e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206324
2024-11-11 20:04:00 - progress_bar.py[line:274] - INFO: epoch 080:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17274.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2940, ups=0.17, wpb=17274.9, bsz=1024, num_updates=31000, lr=1.10192e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=206383
2024-11-11 20:04:59 - progress_bar.py[line:274] - INFO: epoch 080:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.62, ntokens=17460.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.15, wps=2970.4, ups=0.17, wpb=17460.1, bsz=1024, num_updates=31010, lr=1.10056e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206442
2024-11-11 20:05:58 - progress_bar.py[line:274] - INFO: epoch 080:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=16904.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2859.7, ups=0.17, wpb=16904.3, bsz=1024, num_updates=31020, lr=1.0992e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206501
2024-11-11 20:06:56 - progress_bar.py[line:274] - INFO: epoch 080:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17139.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2926.8, ups=0.17, wpb=17139.3, bsz=1024, num_updates=31030, lr=1.09784e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206559
2024-11-11 20:07:55 - progress_bar.py[line:274] - INFO: epoch 080:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=16959.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2883, ups=0.17, wpb=16959.5, bsz=1024, num_updates=31040, lr=1.09648e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=206618
2024-11-11 20:08:55 - progress_bar.py[line:274] - INFO: epoch 080:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.619, ntokens=17500.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=2931.3, ups=0.17, wpb=17500.4, bsz=1024, num_updates=31050, lr=1.09512e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=206678
2024-11-11 20:09:54 - progress_bar.py[line:274] - INFO: epoch 080:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17027.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2863.6, ups=0.17, wpb=17027.8, bsz=1024, num_updates=31060, lr=1.09376e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=206737
2024-11-11 20:10:53 - progress_bar.py[line:274] - INFO: epoch 080:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17066.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2911.5, ups=0.17, wpb=17066.3, bsz=1024, num_updates=31070, lr=1.0924e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=206796
2024-11-11 20:11:52 - progress_bar.py[line:274] - INFO: epoch 080:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17259.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2916, ups=0.17, wpb=17259.4, bsz=1024, num_updates=31080, lr=1.09104e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206855
2024-11-11 20:12:50 - progress_bar.py[line:274] - INFO: epoch 080:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=16950.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2905.2, ups=0.17, wpb=16950.1, bsz=1024, num_updates=31090, lr=1.08968e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=206913
2024-11-11 20:13:47 - progress_bar.py[line:274] - INFO: epoch 080:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17159.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3034, ups=0.18, wpb=17159.3, bsz=1024, num_updates=31100, lr=1.08832e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=206970
2024-11-11 20:14:46 - progress_bar.py[line:274] - INFO: epoch 080:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17126, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2899.7, ups=0.17, wpb=17126, bsz=1024, num_updates=31110, lr=1.08696e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=207029
2024-11-11 20:15:45 - progress_bar.py[line:274] - INFO: epoch 080:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17050.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2871.3, ups=0.17, wpb=17050.9, bsz=1024, num_updates=31120, lr=1.0856e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=207088
2024-11-11 20:16:44 - progress_bar.py[line:274] - INFO: epoch 080:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17233.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2925.7, ups=0.17, wpb=17233.1, bsz=1024, num_updates=31130, lr=1.08424e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=207147
2024-11-11 20:17:44 - progress_bar.py[line:274] - INFO: epoch 080:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17393.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2940.9, ups=0.17, wpb=17393.6, bsz=1024, num_updates=31140, lr=1.08288e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=207206
2024-11-11 20:18:42 - progress_bar.py[line:274] - INFO: epoch 080:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17002.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2897.4, ups=0.17, wpb=17002.5, bsz=1024, num_updates=31150, lr=1.08151e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=207265
2024-11-11 20:19:41 - progress_bar.py[line:274] - INFO: epoch 080:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.641, ntokens=17526.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.24, wps=2981, ups=0.17, wpb=17526.6, bsz=1024, num_updates=31160, lr=1.08015e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=12.6, wall=207324
2024-11-11 20:20:39 - progress_bar.py[line:274] - INFO: epoch 080:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17204.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2941, ups=0.17, wpb=17204.3, bsz=1024, num_updates=31170, lr=1.07879e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=207382
2024-11-11 20:21:39 - progress_bar.py[line:274] - INFO: epoch 080:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17051.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2877.3, ups=0.17, wpb=17051.1, bsz=1024, num_updates=31180, lr=1.07743e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=207442
2024-11-11 20:22:38 - progress_bar.py[line:274] - INFO: epoch 080:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.623, ntokens=17271, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2934.3, ups=0.17, wpb=17271, bsz=1024, num_updates=31190, lr=1.07607e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=207501
2024-11-11 20:23:37 - progress_bar.py[line:274] - INFO: epoch 080:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17144.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2884.9, ups=0.17, wpb=17144.9, bsz=1024, num_updates=31200, lr=1.07471e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=207560
2024-11-11 20:24:36 - progress_bar.py[line:274] - INFO: epoch 080:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17149.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2904.3, ups=0.17, wpb=17149.2, bsz=1024, num_updates=31210, lr=1.07335e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=207619
2024-11-11 20:25:34 - progress_bar.py[line:274] - INFO: epoch 080:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17498.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3028.8, ups=0.17, wpb=17498.3, bsz=1024, num_updates=31220, lr=1.07199e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=207677
2024-11-11 20:26:31 - progress_bar.py[line:274] - INFO: epoch 080:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17298.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3024.5, ups=0.17, wpb=17298.9, bsz=1024, num_updates=31230, lr=1.07063e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=207734
2024-11-11 20:27:25 - progress_bar.py[line:274] - INFO: epoch 080:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.61, ntokens=16502.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3071.6, ups=0.19, wpb=16502.5, bsz=985.6, num_updates=31240, lr=1.06927e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=207788
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt2024-11-11 20:27:25 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 80 @ 31240 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt
2024-11-11 20:27:25 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt': File exists: File exists

: File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 20:29:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-11 20:31:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 80 @ 31240 updates, score 0) (writing took 223.0382025790168 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_80.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-11 20:32:04 - train.py[line:336] - INFO: end of epoch 80 (average epoch stats below)
2024-11-11 20:32:04 - progress_bar.py[line:282] - INFO: epoch 080 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.591 | ntokens 17179.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.03 | wps 2451.8 | ups 0.14 | wpb 17179.4 | bsz 1023 | num_updates 31240 | lr 1.06927e-05 | gnorm 0.004 | clip 0 | loss_scale 16384 | train_wall 1211 | gb_free 13.2 | wall 208067
2024-11-11 20:32:04 - trainer.py[line:639] - INFO: loading train data for epoch 81
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 20:34:45 - trainer.py[line:703] - INFO: begin training epoch 81
2024-11-11 20:34:45 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 20:35:47 - progress_bar.py[line:274] - INFO: epoch 081:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.639, ntokens=17516.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=349, ups=0.02, wpb=17516.3, bsz=1024, num_updates=31250, lr=1.06791e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=208290
2024-11-11 20:36:46 - progress_bar.py[line:274] - INFO: epoch 081:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17158, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2886.1, ups=0.17, wpb=17158, bsz=1024, num_updates=31260, lr=1.06655e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=208349
2024-11-11 20:37:45 - progress_bar.py[line:274] - INFO: epoch 081:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17011.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2873.4, ups=0.17, wpb=17011.4, bsz=1024, num_updates=31270, lr=1.06519e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=208408
2024-11-11 20:38:45 - progress_bar.py[line:274] - INFO: epoch 081:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17176.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2893.3, ups=0.17, wpb=17176.6, bsz=1024, num_updates=31280, lr=1.06383e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=208468
2024-11-11 20:39:44 - progress_bar.py[line:274] - INFO: epoch 081:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.631, ntokens=17403.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.2, wps=2939.2, ups=0.17, wpb=17403.7, bsz=1024, num_updates=31290, lr=1.06247e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=208527
2024-11-11 20:40:43 - progress_bar.py[line:274] - INFO: epoch 081:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17258.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2925.6, ups=0.17, wpb=17258.6, bsz=1024, num_updates=31300, lr=1.06111e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=208586
2024-11-11 20:41:42 - progress_bar.py[line:274] - INFO: epoch 081:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17104.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2890.5, ups=0.17, wpb=17104.2, bsz=1024, num_updates=31310, lr=1.05975e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=208645
2024-11-11 20:42:41 - progress_bar.py[line:274] - INFO: epoch 081:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.624, ntokens=17447.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.16, wps=2960.2, ups=0.17, wpb=17447.9, bsz=1024, num_updates=31320, lr=1.05839e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=208704
2024-11-11 20:43:40 - progress_bar.py[line:274] - INFO: epoch 081:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17034.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2883, ups=0.17, wpb=17034.9, bsz=1024, num_updates=31330, lr=1.05703e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=208763
2024-11-11 20:44:39 - progress_bar.py[line:274] - INFO: epoch 081:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17199.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2916, ups=0.17, wpb=17199.8, bsz=1024, num_updates=31340, lr=1.05567e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=208822
2024-11-11 20:45:38 - progress_bar.py[line:274] - INFO: epoch 081:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17189.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2940.4, ups=0.17, wpb=17189.4, bsz=1024, num_updates=31350, lr=1.05431e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=208881
2024-11-11 20:46:37 - progress_bar.py[line:274] - INFO: epoch 081:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.617, ntokens=17322.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2904, ups=0.17, wpb=17322.8, bsz=1024, num_updates=31360, lr=1.05295e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=208940
2024-11-11 20:47:37 - progress_bar.py[line:274] - INFO: epoch 081:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17333.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2910.5, ups=0.17, wpb=17333.7, bsz=1024, num_updates=31370, lr=1.05159e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=209000
2024-11-11 20:48:36 - progress_bar.py[line:274] - INFO: epoch 081:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17244.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2896, ups=0.17, wpb=17244.2, bsz=1024, num_updates=31380, lr=1.05023e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=209059
2024-11-11 20:49:35 - progress_bar.py[line:274] - INFO: epoch 081:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17172.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2916.1, ups=0.17, wpb=17172.4, bsz=1024, num_updates=31390, lr=1.04887e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=209118
2024-11-11 20:50:34 - progress_bar.py[line:274] - INFO: epoch 081:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17083.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2886.5, ups=0.17, wpb=17083.5, bsz=1024, num_updates=31400, lr=1.04751e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=209177
2024-11-11 20:51:34 - progress_bar.py[line:274] - INFO: epoch 081:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17144.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2886.8, ups=0.17, wpb=17144.2, bsz=1024, num_updates=31410, lr=1.04614e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=209237
2024-11-11 20:52:33 - progress_bar.py[line:274] - INFO: epoch 081:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17154.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2916.7, ups=0.17, wpb=17154.1, bsz=1024, num_updates=31420, lr=1.04478e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13, wall=209296
2024-11-11 20:53:32 - progress_bar.py[line:274] - INFO: epoch 081:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=16971.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2880.9, ups=0.17, wpb=16971.8, bsz=1024, num_updates=31430, lr=1.04342e-05, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=209354
2024-11-11 20:54:30 - progress_bar.py[line:274] - INFO: epoch 081:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17316.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=2981.3, ups=0.17, wpb=17316.9, bsz=1024, num_updates=31440, lr=1.04206e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=209413
2024-11-11 20:55:29 - progress_bar.py[line:274] - INFO: epoch 081:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17102.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2873.9, ups=0.17, wpb=17102.6, bsz=1024, num_updates=31450, lr=1.0407e-05, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.1, wall=209472
2024-11-11 20:56:28 - progress_bar.py[line:274] - INFO: epoch 081:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17146, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2893, ups=0.17, wpb=17146, bsz=1024, num_updates=31460, lr=1.03934e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=209531
2024-11-11 20:57:28 - progress_bar.py[line:274] - INFO: epoch 081:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17297.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2909.4, ups=0.17, wpb=17297.1, bsz=1024, num_updates=31470, lr=1.03798e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=209591
2024-11-11 20:58:26 - progress_bar.py[line:274] - INFO: epoch 081:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17007.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2925.5, ups=0.17, wpb=17007.3, bsz=1024, num_updates=31480, lr=1.03662e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=209649
2024-11-11 20:59:25 - progress_bar.py[line:274] - INFO: epoch 081:    250 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17266.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2913.7, ups=0.17, wpb=17266.7, bsz=1024, num_updates=31490, lr=1.03526e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=209708
2024-11-11 21:00:25 - progress_bar.py[line:274] - INFO: epoch 081:    260 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17246.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2884.5, ups=0.17, wpb=17246.3, bsz=1024, num_updates=31500, lr=1.0339e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=209768
2024-11-11 21:01:24 - progress_bar.py[line:274] - INFO: epoch 081:    270 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.614, ntokens=17352.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2925.1, ups=0.17, wpb=17352.9, bsz=1024, num_updates=31510, lr=1.03254e-05, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=209827
2024-11-11 21:02:24 - progress_bar.py[line:274] - INFO: epoch 081:    280 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17185.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2871, ups=0.17, wpb=17185.3, bsz=1024, num_updates=31520, lr=1.03118e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=209887
2024-11-11 21:03:24 - progress_bar.py[line:274] - INFO: epoch 081:    290 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17048.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2865.7, ups=0.17, wpb=17048.2, bsz=1024, num_updates=31530, lr=1.02982e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=209947
2024-11-11 21:04:23 - progress_bar.py[line:274] - INFO: epoch 081:    300 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17117.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2873.1, ups=0.17, wpb=17117.2, bsz=1024, num_updates=31540, lr=1.02846e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=210006
2024-11-11 21:05:23 - progress_bar.py[line:274] - INFO: epoch 081:    310 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17024.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2875.5, ups=0.17, wpb=17024.4, bsz=1024, num_updates=31550, lr=1.0271e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=210065
2024-11-11 21:06:22 - progress_bar.py[line:274] - INFO: epoch 081:    320 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17091.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2871.4, ups=0.17, wpb=17091.9, bsz=1024, num_updates=31560, lr=1.02574e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=210125
2024-11-11 21:07:21 - progress_bar.py[line:274] - INFO: epoch 081:    330 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17061.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2903.9, ups=0.17, wpb=17061.5, bsz=1024, num_updates=31570, lr=1.02438e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=210184
2024-11-11 21:08:19 - progress_bar.py[line:274] - INFO: epoch 081:    340 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17045.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2908.7, ups=0.17, wpb=17045.5, bsz=1024, num_updates=31580, lr=1.02302e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=210242
2024-11-11 21:09:18 - progress_bar.py[line:274] - INFO: epoch 081:    350 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17041.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2889, ups=0.17, wpb=17041.5, bsz=1024, num_updates=31590, lr=1.02166e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=210301
2024-11-11 21:10:18 - progress_bar.py[line:274] - INFO: epoch 081:    360 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17355.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2918.8, ups=0.17, wpb=17355.8, bsz=1024, num_updates=31600, lr=1.0203e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=210361
2024-11-11 21:11:17 - progress_bar.py[line:274] - INFO: epoch 081:    370 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.616, ntokens=17494.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=2973.6, ups=0.17, wpb=17494.3, bsz=1024, num_updates=31610, lr=1.01894e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=210420
2024-11-11 21:12:14 - progress_bar.py[line:274] - INFO: epoch 081:    380 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17281.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3013.8, ups=0.17, wpb=17281.3, bsz=1024, num_updates=31620, lr=1.01758e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=210477
2024-11-11 21:13:11 - progress_bar.py[line:274] - INFO: epoch 081:    390 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17043.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2968.9, ups=0.17, wpb=17043.2, bsz=1024, num_updates=31630, lr=1.01622e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=12.8, wall=210534
2024-11-11 21:13:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 81 @ 31631 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
2024-11-11 21:13:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt': File exists
: File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 21:15:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-11 21:16:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 81 @ 31631 updates, score 0) (writing took 222.86230668600183 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_81.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-11 21:17:53 - train.py[line:336] - INFO: end of epoch 81 (average epoch stats below)
2024-11-11 21:17:53 - progress_bar.py[line:282] - INFO: epoch 081 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.59 | ntokens 17175.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.02 | wps 2443.1 | ups 0.14 | wpb 17175.1 | bsz 1023 | num_updates 31631 | lr 1.01608e-05 | gnorm 0.003 | clip 0 | loss_scale 32768 | train_wall 1210 | gb_free 13.4 | wall 210816
2024-11-11 21:17:53 - trainer.py[line:639] - INFO: loading train data for epoch 82
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 21:20:33 - trainer.py[line:703] - INFO: begin training epoch 82
2024-11-11 21:20:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 21:21:27 - progress_bar.py[line:274] - INFO: epoch 082:      9 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=16466.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=332, ups=0.02, wpb=16466.9, bsz=985.6, num_updates=31640, lr=1.01486e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=211030
2024-11-11 21:22:25 - progress_bar.py[line:274] - INFO: epoch 082:     19 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17221.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2975.9, ups=0.17, wpb=17221.4, bsz=1024, num_updates=31650, lr=1.0135e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=211088
2024-11-11 21:23:24 - progress_bar.py[line:274] - INFO: epoch 082:     29 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17296.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2952.3, ups=0.17, wpb=17296.8, bsz=1024, num_updates=31660, lr=1.01213e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=211147
2024-11-11 21:24:23 - progress_bar.py[line:274] - INFO: epoch 082:     39 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17016.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2867, ups=0.17, wpb=17016.8, bsz=1024, num_updates=31670, lr=1.01077e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=59, gb_free=13.4, wall=211206
2024-11-11 21:25:21 - progress_bar.py[line:274] - INFO: epoch 082:     49 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17357.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3010.6, ups=0.17, wpb=17357.5, bsz=1024, num_updates=31680, lr=1.00941e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=58, gb_free=13.3, wall=211264
2024-11-11 21:26:16 - progress_bar.py[line:274] - INFO: epoch 082:     59 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17018.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3063.6, ups=0.18, wpb=17018.4, bsz=1024, num_updates=31690, lr=1.00805e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=211319
2024-11-11 21:27:14 - progress_bar.py[line:274] - INFO: epoch 082:     69 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17068.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2951, ups=0.17, wpb=17068.8, bsz=1024, num_updates=31700, lr=1.00669e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=36, gb_free=13.2, wall=211377
2024-11-11 21:28:13 - progress_bar.py[line:274] - INFO: epoch 082:     79 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17068, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2909.9, ups=0.17, wpb=17068, bsz=1024, num_updates=31710, lr=1.00533e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=32, gb_free=13.3, wall=211436
2024-11-11 21:29:12 - progress_bar.py[line:274] - INFO: epoch 082:     89 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17174, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2901.5, ups=0.17, wpb=17174, bsz=1024, num_updates=31720, lr=1.00397e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=12.8, wall=211495
2024-11-11 21:30:12 - progress_bar.py[line:274] - INFO: epoch 082:     99 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.599, ntokens=17349.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2919.7, ups=0.17, wpb=17349.3, bsz=1024, num_updates=31730, lr=1.00261e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=12.8, wall=211554
2024-11-11 21:31:11 - progress_bar.py[line:274] - INFO: epoch 082:    109 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17127, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2882.4, ups=0.17, wpb=17127, bsz=1024, num_updates=31740, lr=1.00125e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=211614
2024-11-11 21:32:10 - progress_bar.py[line:274] - INFO: epoch 082:    119 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17165.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2893.1, ups=0.17, wpb=17165.2, bsz=1024, num_updates=31750, lr=9.99891e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=211673
2024-11-11 21:33:09 - progress_bar.py[line:274] - INFO: epoch 082:    129 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17374.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2952.7, ups=0.17, wpb=17374.5, bsz=1024, num_updates=31760, lr=9.98531e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=211732
2024-11-11 21:34:07 - progress_bar.py[line:274] - INFO: epoch 082:    139 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17161.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=2945.4, ups=0.17, wpb=17161.5, bsz=1024, num_updates=31770, lr=9.9717e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=211790
2024-11-11 21:35:06 - progress_bar.py[line:274] - INFO: epoch 082:    149 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17070.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2906.9, ups=0.17, wpb=17070.5, bsz=1024, num_updates=31780, lr=9.9581e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=211849
2024-11-11 21:36:06 - progress_bar.py[line:274] - INFO: epoch 082:    159 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17161.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2878.7, ups=0.17, wpb=17161.5, bsz=1024, num_updates=31790, lr=9.9445e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=211909
2024-11-11 21:37:05 - progress_bar.py[line:274] - INFO: epoch 082:    169 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17153, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2894.7, ups=0.17, wpb=17153, bsz=1024, num_updates=31800, lr=9.93089e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=211968
2024-11-11 21:38:03 - progress_bar.py[line:274] - INFO: epoch 082:    179 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17185.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2957.4, ups=0.17, wpb=17185.9, bsz=1024, num_updates=31810, lr=9.91729e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=212026
2024-11-11 21:39:00 - progress_bar.py[line:274] - INFO: epoch 082:    189 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=16990.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2987.5, ups=0.18, wpb=16990.5, bsz=1024, num_updates=31820, lr=9.90368e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212083
2024-11-11 21:39:59 - progress_bar.py[line:274] - INFO: epoch 082:    199 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17380.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2945.4, ups=0.17, wpb=17380.6, bsz=1024, num_updates=31830, lr=9.89008e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=212142
2024-11-11 21:40:59 - progress_bar.py[line:274] - INFO: epoch 082:    209 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17055.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2862.9, ups=0.17, wpb=17055.3, bsz=1024, num_updates=31840, lr=9.87648e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=212201
2024-11-11 21:41:57 - progress_bar.py[line:274] - INFO: epoch 082:    219 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17299, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2944.6, ups=0.17, wpb=17299, bsz=1024, num_updates=31850, lr=9.86287e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=212260
2024-11-11 21:42:56 - progress_bar.py[line:274] - INFO: epoch 082:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17118.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2919.3, ups=0.17, wpb=17118.6, bsz=1024, num_updates=31860, lr=9.84927e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=12.7, wall=212319
2024-11-11 21:43:55 - progress_bar.py[line:274] - INFO: epoch 082:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17142.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2898.9, ups=0.17, wpb=17142.5, bsz=1024, num_updates=31870, lr=9.83566e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212378
2024-11-11 21:44:55 - progress_bar.py[line:274] - INFO: epoch 082:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17224.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2876, ups=0.17, wpb=17224.1, bsz=1024, num_updates=31880, lr=9.82206e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=212438
2024-11-11 21:45:54 - progress_bar.py[line:274] - INFO: epoch 082:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17005.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2902.9, ups=0.17, wpb=17005.9, bsz=1024, num_updates=31890, lr=9.80846e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=212496
2024-11-11 21:46:53 - progress_bar.py[line:274] - INFO: epoch 082:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17388.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=2926, ups=0.17, wpb=17388.8, bsz=1024, num_updates=31900, lr=9.79485e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=212556
2024-11-11 21:47:52 - progress_bar.py[line:274] - INFO: epoch 082:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17335.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2944.2, ups=0.17, wpb=17335.5, bsz=1024, num_updates=31910, lr=9.78125e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212615
2024-11-11 21:48:51 - progress_bar.py[line:274] - INFO: epoch 082:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17145.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2900.2, ups=0.17, wpb=17145.5, bsz=1024, num_updates=31920, lr=9.76764e-06, gnorm=0.005, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212674
2024-11-11 21:49:50 - progress_bar.py[line:274] - INFO: epoch 082:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17274.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2933.8, ups=0.17, wpb=17274.1, bsz=1024, num_updates=31930, lr=9.75404e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212733
2024-11-11 21:50:49 - progress_bar.py[line:274] - INFO: epoch 082:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17196, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2893.5, ups=0.17, wpb=17196, bsz=1024, num_updates=31940, lr=9.74044e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212792
2024-11-11 21:51:48 - progress_bar.py[line:274] - INFO: epoch 082:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17157.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2906.3, ups=0.17, wpb=17157.2, bsz=1024, num_updates=31950, lr=9.72683e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212851
2024-11-11 21:52:48 - progress_bar.py[line:274] - INFO: epoch 082:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17257.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2905.4, ups=0.17, wpb=17257.7, bsz=1024, num_updates=31960, lr=9.71323e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=212911
2024-11-11 21:53:47 - progress_bar.py[line:274] - INFO: epoch 082:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17189.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2923.6, ups=0.17, wpb=17189.2, bsz=1024, num_updates=31970, lr=9.69962e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=212969
2024-11-11 21:54:45 - progress_bar.py[line:274] - INFO: epoch 082:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=16967.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2882, ups=0.17, wpb=16967.7, bsz=1024, num_updates=31980, lr=9.68602e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=213028
2024-11-11 21:55:44 - progress_bar.py[line:274] - INFO: epoch 082:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17024, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2881.7, ups=0.17, wpb=17024, bsz=1024, num_updates=31990, lr=9.67242e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=213087
2024-11-11 21:56:43 - progress_bar.py[line:274] - INFO: epoch 082:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17270.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2934.7, ups=0.17, wpb=17270.9, bsz=1024, num_updates=32000, lr=9.65881e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=213146
2024-11-11 21:57:40 - progress_bar.py[line:274] - INFO: epoch 082:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17255.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3050.4, ups=0.18, wpb=17255.7, bsz=1024, num_updates=32010, lr=9.64521e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=213203
2024-11-11 21:58:37 - progress_bar.py[line:274] - INFO: epoch 082:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17078.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=2977.3, ups=0.17, wpb=17078.7, bsz=1024, num_updates=32020, lr=9.6316e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=213260
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
2024-11-11 21:58:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 82 @ 32022 updates
2024-11-11 21:58:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 22:00:35 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
2024-11-11 22:02:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 82 @ 32022 updates, score 0) (writing took 223.99296979000792 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_82.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-11 22:03:25 - train.py[line:336] - INFO: end of epoch 82 (average epoch stats below)
2024-11-11 22:03:25 - progress_bar.py[line:282] - INFO: epoch 082 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.582 | ntokens 17160.7 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.99 | wps 2455.9 | ups 0.14 | wpb 17160.7 | bsz 1023 | num_updates 32022 | lr 9.62888e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 1297 | gb_free 13.1 | wall 213548
2024-11-11 22:03:25 - trainer.py[line:639] - INFO: loading train data for epoch 83
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 22:06:06 - trainer.py[line:703] - INFO: begin training epoch 83
2024-11-11 22:06:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 22:06:56 - progress_bar.py[line:274] - INFO: epoch 083:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=16706.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=335.1, ups=0.02, wpb=16706.2, bsz=985.6, num_updates=32030, lr=9.618e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=213759
2024-11-11 22:07:55 - progress_bar.py[line:274] - INFO: epoch 083:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17230, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2910.3, ups=0.17, wpb=17230, bsz=1024, num_updates=32040, lr=9.6044e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=213818
2024-11-11 22:08:54 - progress_bar.py[line:274] - INFO: epoch 083:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17094.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2915.2, ups=0.17, wpb=17094.2, bsz=1024, num_updates=32050, lr=9.59079e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=213877
2024-11-11 22:09:53 - progress_bar.py[line:274] - INFO: epoch 083:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17043.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2856.2, ups=0.17, wpb=17043.5, bsz=1024, num_updates=32060, lr=9.57719e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=213936
2024-11-11 22:10:51 - progress_bar.py[line:274] - INFO: epoch 083:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17172.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2974.6, ups=0.17, wpb=17172.4, bsz=1024, num_updates=32070, lr=9.56358e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=213994
2024-11-11 22:11:50 - progress_bar.py[line:274] - INFO: epoch 083:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17299.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2941.1, ups=0.17, wpb=17299.2, bsz=1024, num_updates=32080, lr=9.54998e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214053
2024-11-11 22:12:48 - progress_bar.py[line:274] - INFO: epoch 083:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17171.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2942.1, ups=0.17, wpb=17171.1, bsz=1024, num_updates=32090, lr=9.53638e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214111
2024-11-11 22:13:45 - progress_bar.py[line:274] - INFO: epoch 083:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17269.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3044, ups=0.18, wpb=17269.7, bsz=1024, num_updates=32100, lr=9.52277e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214168
2024-11-11 22:14:44 - progress_bar.py[line:274] - INFO: epoch 083:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17214.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2895.3, ups=0.17, wpb=17214.6, bsz=1024, num_updates=32110, lr=9.50917e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=214227
2024-11-11 22:15:43 - progress_bar.py[line:274] - INFO: epoch 083:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17302.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2944.2, ups=0.17, wpb=17302.9, bsz=1024, num_updates=32120, lr=9.49557e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214286
2024-11-11 22:16:42 - progress_bar.py[line:274] - INFO: epoch 083:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17118, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2905.7, ups=0.17, wpb=17118, bsz=1024, num_updates=32130, lr=9.48196e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=214345
2024-11-11 22:17:42 - progress_bar.py[line:274] - INFO: epoch 083:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17045.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2862.6, ups=0.17, wpb=17045.7, bsz=1024, num_updates=32140, lr=9.46836e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214405
2024-11-11 22:18:41 - progress_bar.py[line:274] - INFO: epoch 083:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17198.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2914.1, ups=0.17, wpb=17198.7, bsz=1024, num_updates=32150, lr=9.45475e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=214464
2024-11-11 22:19:41 - progress_bar.py[line:274] - INFO: epoch 083:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17385.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2904.4, ups=0.17, wpb=17385.3, bsz=1024, num_updates=32160, lr=9.44115e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214523
2024-11-11 22:20:39 - progress_bar.py[line:274] - INFO: epoch 083:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17182.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2913.8, ups=0.17, wpb=17182.1, bsz=1024, num_updates=32170, lr=9.42755e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214582
2024-11-11 22:21:39 - progress_bar.py[line:274] - INFO: epoch 083:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17350.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2932.2, ups=0.17, wpb=17350.2, bsz=1024, num_updates=32180, lr=9.41394e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214642
2024-11-11 22:22:38 - progress_bar.py[line:274] - INFO: epoch 083:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=16988.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2860.5, ups=0.17, wpb=16988.4, bsz=1024, num_updates=32190, lr=9.40034e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=214701
2024-11-11 22:23:37 - progress_bar.py[line:274] - INFO: epoch 083:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2945.1, ups=0.17, wpb=17245.1, bsz=1024, num_updates=32200, lr=9.38673e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=214760
2024-11-11 22:24:36 - progress_bar.py[line:274] - INFO: epoch 083:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=16971.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2869.7, ups=0.17, wpb=16971.9, bsz=1024, num_updates=32210, lr=9.37313e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214819
2024-11-11 22:25:35 - progress_bar.py[line:274] - INFO: epoch 083:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17127, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2886.8, ups=0.17, wpb=17127, bsz=1024, num_updates=32220, lr=9.35953e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214878
2024-11-11 22:26:34 - progress_bar.py[line:274] - INFO: epoch 083:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17270.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2915.6, ups=0.17, wpb=17270.1, bsz=1024, num_updates=32230, lr=9.34592e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214937
2024-11-11 22:27:33 - progress_bar.py[line:274] - INFO: epoch 083:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17191, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2905.5, ups=0.17, wpb=17191, bsz=1024, num_updates=32240, lr=9.33232e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=214996
2024-11-11 22:28:27 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-11 22:28:39 - progress_bar.py[line:274] - INFO: epoch 083:    229 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17257.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2653.2, ups=0.15, wpb=17257.9, bsz=1024, num_updates=32250, lr=9.31871e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=34, gb_free=13, wall=215061
2024-11-11 22:29:38 - progress_bar.py[line:274] - INFO: epoch 083:    239 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17214.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2916.1, ups=0.17, wpb=17214.7, bsz=1024, num_updates=32260, lr=9.30511e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215120
2024-11-11 22:30:37 - progress_bar.py[line:274] - INFO: epoch 083:    249 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2926.1, ups=0.17, wpb=17280.7, bsz=1024, num_updates=32270, lr=9.29151e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215180
2024-11-11 22:31:36 - progress_bar.py[line:274] - INFO: epoch 083:    259 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17147.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2882.5, ups=0.17, wpb=17147.4, bsz=1024, num_updates=32280, lr=9.2779e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215239
2024-11-11 22:32:34 - progress_bar.py[line:274] - INFO: epoch 083:    269 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17457.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3010.1, ups=0.17, wpb=17457.4, bsz=1024, num_updates=32290, lr=9.2643e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=215297
2024-11-11 22:33:33 - progress_bar.py[line:274] - INFO: epoch 083:    279 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17280.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2949.5, ups=0.17, wpb=17280.3, bsz=1024, num_updates=32300, lr=9.25069e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215356
2024-11-11 22:34:32 - progress_bar.py[line:274] - INFO: epoch 083:    289 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=16956.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2873.5, ups=0.17, wpb=16956.4, bsz=1024, num_updates=32310, lr=9.23709e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=215415
2024-11-11 22:35:31 - progress_bar.py[line:274] - INFO: epoch 083:    299 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17064.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2883.5, ups=0.17, wpb=17064.8, bsz=1024, num_updates=32320, lr=9.22349e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=215474
2024-11-11 22:36:30 - progress_bar.py[line:274] - INFO: epoch 083:    309 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17224.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2919, ups=0.17, wpb=17224.9, bsz=1024, num_updates=32330, lr=9.20988e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215533
2024-11-11 22:37:30 - progress_bar.py[line:274] - INFO: epoch 083:    319 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17157.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2875.7, ups=0.17, wpb=17157.5, bsz=1024, num_updates=32340, lr=9.19628e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=215592
2024-11-11 22:38:29 - progress_bar.py[line:274] - INFO: epoch 083:    329 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17076.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2887.2, ups=0.17, wpb=17076.3, bsz=1024, num_updates=32350, lr=9.18267e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215652
2024-11-11 22:39:28 - progress_bar.py[line:274] - INFO: epoch 083:    339 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17106.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2884.9, ups=0.17, wpb=17106.3, bsz=1024, num_updates=32360, lr=9.16907e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=215711
2024-11-11 22:40:27 - progress_bar.py[line:274] - INFO: epoch 083:    349 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17103.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2922.2, ups=0.17, wpb=17103.2, bsz=1024, num_updates=32370, lr=9.15547e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215769
2024-11-11 22:41:26 - progress_bar.py[line:274] - INFO: epoch 083:    359 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17290.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2929.9, ups=0.17, wpb=17290.3, bsz=1024, num_updates=32380, lr=9.14186e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=215828
2024-11-11 22:42:24 - progress_bar.py[line:274] - INFO: epoch 083:    369 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17159.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2951.8, ups=0.17, wpb=17159.7, bsz=1024, num_updates=32390, lr=9.12826e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=215887
2024-11-11 22:43:21 - progress_bar.py[line:274] - INFO: epoch 083:    379 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17285.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3025.2, ups=0.18, wpb=17285.6, bsz=1024, num_updates=32400, lr=9.11465e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=215944
2024-11-11 22:44:18 - progress_bar.py[line:274] - INFO: epoch 083:    389 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=16948.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2957, ups=0.17, wpb=16948.7, bsz=1024, num_updates=32410, lr=9.10105e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=216001
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt

2024-11-11 22:44:26 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 83 @ 32412 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
2024-11-11 22:44:26 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt': File exists: File exists
: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 22:46:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
2024-11-11 22:48:16 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 83 @ 32412 updates, score 0) (writing took 230.03530708292965 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_83.pt
2024-11-11 22:49:11 - train.py[line:336] - INFO: end of epoch 83 (average epoch stats below)
2024-11-11 22:49:11 - progress_bar.py[line:282] - INFO: epoch 083 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.58 | ntokens 17168.8 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.98 | wps 2438.1 | ups 0.14 | wpb 17168.8 | bsz 1023 | num_updates 32412 | lr 9.09833e-06 | gnorm 0.003 | clip 0 | loss_scale 32768 | train_wall 1209 | gb_free 13.2 | wall 216294
2024-11-11 22:49:11 - trainer.py[line:639] - INFO: loading train data for epoch 84
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-11 22:51:53 - trainer.py[line:703] - INFO: begin training epoch 84
2024-11-11 22:51:53 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 22:52:42 - progress_bar.py[line:274] - INFO: epoch 084:      8 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=16810.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=333.7, ups=0.02, wpb=16810.6, bsz=985.6, num_updates=32420, lr=9.08745e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=216505
2024-11-11 22:53:41 - progress_bar.py[line:274] - INFO: epoch 084:     18 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17199.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2888.9, ups=0.17, wpb=17199.3, bsz=1024, num_updates=32430, lr=9.07384e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=216564
2024-11-11 22:54:41 - progress_bar.py[line:274] - INFO: epoch 084:     28 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17207.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2910.9, ups=0.17, wpb=17207.7, bsz=1024, num_updates=32440, lr=9.06024e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=216623
2024-11-11 22:55:40 - progress_bar.py[line:274] - INFO: epoch 084:     38 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17100.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2873.1, ups=0.17, wpb=17100.6, bsz=1024, num_updates=32450, lr=9.04663e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=216683
2024-11-11 22:56:39 - progress_bar.py[line:274] - INFO: epoch 084:     48 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17232.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2929.3, ups=0.17, wpb=17232.7, bsz=1024, num_updates=32460, lr=9.03303e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=216742
2024-11-11 22:57:38 - progress_bar.py[line:274] - INFO: epoch 084:     58 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17133, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2886, ups=0.17, wpb=17133, bsz=1024, num_updates=32470, lr=9.01943e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=216801
2024-11-11 22:58:38 - progress_bar.py[line:274] - INFO: epoch 084:     68 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17042.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2864.6, ups=0.17, wpb=17042.3, bsz=1024, num_updates=32480, lr=9.00582e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=216861
2024-11-11 22:59:38 - progress_bar.py[line:274] - INFO: epoch 084:     78 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17181.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2871.9, ups=0.17, wpb=17181.2, bsz=1024, num_updates=32490, lr=8.99222e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=216921
2024-11-11 23:00:36 - progress_bar.py[line:274] - INFO: epoch 084:     88 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17315, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2958.4, ups=0.17, wpb=17315, bsz=1024, num_updates=32500, lr=8.97861e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=216979
2024-11-11 23:01:35 - progress_bar.py[line:274] - INFO: epoch 084:     98 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17315.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=2949.8, ups=0.17, wpb=17315.6, bsz=1024, num_updates=32510, lr=8.96501e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=217038
2024-11-11 23:02:34 - progress_bar.py[line:274] - INFO: epoch 084:    108 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17302.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2938.1, ups=0.17, wpb=17302.4, bsz=1024, num_updates=32520, lr=8.95141e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=217097
2024-11-11 23:03:33 - progress_bar.py[line:274] - INFO: epoch 084:    118 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17456.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=2949.4, ups=0.17, wpb=17456.3, bsz=1024, num_updates=32530, lr=8.9378e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217156
2024-11-11 23:04:32 - progress_bar.py[line:274] - INFO: epoch 084:    128 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17196.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2909.3, ups=0.17, wpb=17196.9, bsz=1024, num_updates=32540, lr=8.9242e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217215
2024-11-11 23:05:31 - progress_bar.py[line:274] - INFO: epoch 084:    138 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17025.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2884, ups=0.17, wpb=17025.1, bsz=1024, num_updates=32550, lr=8.91059e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217274
2024-11-11 23:06:29 - progress_bar.py[line:274] - INFO: epoch 084:    148 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=16971.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2908.5, ups=0.17, wpb=16971.6, bsz=1024, num_updates=32560, lr=8.89699e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217332
2024-11-11 23:07:28 - progress_bar.py[line:274] - INFO: epoch 084:    158 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17109.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2912.8, ups=0.17, wpb=17109.9, bsz=1024, num_updates=32570, lr=8.88339e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217391
2024-11-11 23:08:27 - progress_bar.py[line:274] - INFO: epoch 084:    168 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17215.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2922.9, ups=0.17, wpb=17215.7, bsz=1024, num_updates=32580, lr=8.86978e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217450
2024-11-11 23:09:27 - progress_bar.py[line:274] - INFO: epoch 084:    178 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17251.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2898.3, ups=0.17, wpb=17251.5, bsz=1024, num_updates=32590, lr=8.85618e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=217509
2024-11-11 23:10:26 - progress_bar.py[line:274] - INFO: epoch 084:    188 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17162.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2895.6, ups=0.17, wpb=17162.7, bsz=1024, num_updates=32600, lr=8.84257e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=217569
2024-11-11 23:11:25 - progress_bar.py[line:274] - INFO: epoch 084:    198 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17104.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2890.7, ups=0.17, wpb=17104.9, bsz=1024, num_updates=32610, lr=8.82897e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217628
2024-11-11 23:12:24 - progress_bar.py[line:274] - INFO: epoch 084:    208 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17258.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=2924.5, ups=0.17, wpb=17258.2, bsz=1024, num_updates=32620, lr=8.81537e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217687
2024-11-11 23:13:23 - progress_bar.py[line:274] - INFO: epoch 084:    218 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=16949.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=2884.9, ups=0.17, wpb=16949.8, bsz=1024, num_updates=32630, lr=8.80176e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=217746
2024-11-11 23:14:22 - progress_bar.py[line:274] - INFO: epoch 084:    228 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17128.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2909, ups=0.17, wpb=17128.3, bsz=1024, num_updates=32640, lr=8.78816e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=217805
2024-11-11 23:15:21 - progress_bar.py[line:274] - INFO: epoch 084:    238 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=16940.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2867.7, ups=0.17, wpb=16940.9, bsz=1024, num_updates=32650, lr=8.77456e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=217864
2024-11-11 23:16:20 - progress_bar.py[line:274] - INFO: epoch 084:    248 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17160.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2903.7, ups=0.17, wpb=17160.9, bsz=1024, num_updates=32660, lr=8.76095e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=217923
2024-11-11 23:17:18 - progress_bar.py[line:274] - INFO: epoch 084:    258 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=16956.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=2932.4, ups=0.17, wpb=16956.6, bsz=1024, num_updates=32670, lr=8.74735e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=217981
2024-11-11 23:18:16 - progress_bar.py[line:274] - INFO: epoch 084:    268 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17078.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2927.2, ups=0.17, wpb=17078.6, bsz=1024, num_updates=32680, lr=8.73374e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=218039
2024-11-11 23:19:15 - progress_bar.py[line:274] - INFO: epoch 084:    278 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17079.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2881, ups=0.17, wpb=17079.4, bsz=1024, num_updates=32690, lr=8.72014e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13, wall=218098
2024-11-11 23:20:15 - progress_bar.py[line:274] - INFO: epoch 084:    288 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2856, ups=0.17, wpb=17040.3, bsz=1024, num_updates=32700, lr=8.70654e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=218158
2024-11-11 23:21:14 - progress_bar.py[line:274] - INFO: epoch 084:    298 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17217.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2911.8, ups=0.17, wpb=17217.7, bsz=1024, num_updates=32710, lr=8.69293e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=218217
2024-11-11 23:22:14 - progress_bar.py[line:274] - INFO: epoch 084:    308 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17265.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2890.4, ups=0.17, wpb=17265.7, bsz=1024, num_updates=32720, lr=8.67933e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=218277
2024-11-11 23:23:14 - progress_bar.py[line:274] - INFO: epoch 084:    318 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=16885.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2829.9, ups=0.17, wpb=16885.8, bsz=1024, num_updates=32730, lr=8.66572e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=218336
2024-11-11 23:24:13 - progress_bar.py[line:274] - INFO: epoch 084:    328 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=16909.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=2818.9, ups=0.17, wpb=16909.3, bsz=1024, num_updates=32740, lr=8.65212e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=218396
2024-11-11 23:25:14 - progress_bar.py[line:274] - INFO: epoch 084:    338 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17304.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2875.4, ups=0.17, wpb=17304.5, bsz=1024, num_updates=32750, lr=8.63852e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=218457
2024-11-11 23:26:12 - progress_bar.py[line:274] - INFO: epoch 084:    348 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17145.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2916, ups=0.17, wpb=17145.7, bsz=1024, num_updates=32760, lr=8.62491e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=218515
2024-11-11 23:27:11 - progress_bar.py[line:274] - INFO: epoch 084:    358 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17235.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2926.6, ups=0.17, wpb=17235.2, bsz=1024, num_updates=32770, lr=8.61131e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=218574
2024-11-11 23:28:11 - progress_bar.py[line:274] - INFO: epoch 084:    368 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17177.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2879.5, ups=0.17, wpb=17177.7, bsz=1024, num_updates=32780, lr=8.5977e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=218634
2024-11-11 23:29:08 - progress_bar.py[line:274] - INFO: epoch 084:    378 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17199.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2994.3, ups=0.17, wpb=17199.4, bsz=1024, num_updates=32790, lr=8.5841e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=218691
2024-11-11 23:30:06 - progress_bar.py[line:274] - INFO: epoch 084:    388 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17092.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2982.7, ups=0.17, wpb=17092.9, bsz=1024, num_updates=32800, lr=8.5705e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=218749
2024-11-11 23:30:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 84 @ 32803 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt
2024-11-11 23:30:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 23:32:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 23:34:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 84 @ 32803 updates, score 0) (writing took 238.72010227502324 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_84.pt
2024-11-11 23:35:18 - train.py[line:336] - INFO: end of epoch 84 (average epoch stats below)
2024-11-11 23:35:18 - progress_bar.py[line:282] - INFO: epoch 084 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.571 | ntokens 17132.4 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.94 | wps 2420.8 | ups 0.14 | wpb 17132.4 | bsz 1023 | num_updates 32803 | lr 8.56641e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 1211 | gb_free 13.3 | wall 219061
2024-11-11 23:35:18 - trainer.py[line:639] - INFO: loading train data for epoch 85
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 0 seek offset 0
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-11 23:42:19 - trainer.py[line:703] - INFO: begin training epoch 85
2024-11-11 23:42:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 23:43:03 - progress_bar.py[line:274] - INFO: epoch 085:      7 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=16470.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=211.8, ups=0.01, wpb=16470.7, bsz=985.6, num_updates=32810, lr=8.55689e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=219526
2024-11-11 23:44:02 - progress_bar.py[line:274] - INFO: epoch 085:     17 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.613, ntokens=17386.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.12, wps=2976.9, ups=0.17, wpb=17386.2, bsz=1024, num_updates=32820, lr=8.54329e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=58, gb_free=13.2, wall=219585
2024-11-11 23:45:00 - progress_bar.py[line:274] - INFO: epoch 085:     27 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17145.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2932.6, ups=0.17, wpb=17145.3, bsz=1024, num_updates=32830, lr=8.52968e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=219643
2024-11-11 23:45:59 - progress_bar.py[line:274] - INFO: epoch 085:     37 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17081.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2923.7, ups=0.17, wpb=17081.2, bsz=1024, num_updates=32840, lr=8.51608e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=219702
2024-11-11 23:46:57 - progress_bar.py[line:274] - INFO: epoch 085:     47 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17205.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2963.5, ups=0.17, wpb=17205.3, bsz=1024, num_updates=32850, lr=8.50248e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=58, gb_free=13.1, wall=219760
2024-11-11 23:47:51 - progress_bar.py[line:274] - INFO: epoch 085:     57 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17340.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3214.7, ups=0.19, wpb=17340.1, bsz=1024, num_updates=32860, lr=8.48887e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=54, gb_free=13.1, wall=219814
2024-11-11 23:48:44 - progress_bar.py[line:274] - INFO: epoch 085:     67 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17037.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3196.9, ups=0.19, wpb=17037.5, bsz=1024, num_updates=32870, lr=8.47527e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=219867
2024-11-11 23:49:39 - progress_bar.py[line:274] - INFO: epoch 085:     77 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17168.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3094.7, ups=0.18, wpb=17168.2, bsz=1024, num_updates=32880, lr=8.46166e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=219922
2024-11-11 23:50:36 - progress_bar.py[line:274] - INFO: epoch 085:     87 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17384.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3089.7, ups=0.18, wpb=17384.3, bsz=1024, num_updates=32890, lr=8.44806e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13, wall=219979
2024-11-11 23:51:32 - progress_bar.py[line:274] - INFO: epoch 085:     97 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17123.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3026.2, ups=0.18, wpb=17123.3, bsz=1024, num_updates=32900, lr=8.43446e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220035
2024-11-11 23:52:28 - progress_bar.py[line:274] - INFO: epoch 085:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17080.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3064.5, ups=0.18, wpb=17080.3, bsz=1024, num_updates=32910, lr=8.42085e-06, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=220091
2024-11-11 23:53:25 - progress_bar.py[line:274] - INFO: epoch 085:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17293.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3052.5, ups=0.18, wpb=17293.6, bsz=1024, num_updates=32920, lr=8.40725e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=220148
2024-11-11 23:54:21 - progress_bar.py[line:274] - INFO: epoch 085:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17338.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3089.4, ups=0.18, wpb=17338.9, bsz=1024, num_updates=32930, lr=8.39364e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=220204
2024-11-11 23:55:17 - progress_bar.py[line:274] - INFO: epoch 085:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17350.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3078.7, ups=0.18, wpb=17350.9, bsz=1024, num_updates=32940, lr=8.38004e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220260
2024-11-11 23:56:14 - progress_bar.py[line:274] - INFO: epoch 085:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17099.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3028.3, ups=0.18, wpb=17099.8, bsz=1024, num_updates=32950, lr=8.36644e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220317
2024-11-11 23:57:10 - progress_bar.py[line:274] - INFO: epoch 085:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17205.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3052, ups=0.18, wpb=17205.7, bsz=1024, num_updates=32960, lr=8.35283e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220373
2024-11-11 23:58:06 - progress_bar.py[line:274] - INFO: epoch 085:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17255, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3056.8, ups=0.18, wpb=17255, bsz=1024, num_updates=32970, lr=8.33923e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=220429
2024-11-11 23:59:03 - progress_bar.py[line:274] - INFO: epoch 085:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17026.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3035.7, ups=0.18, wpb=17026.4, bsz=1024, num_updates=32980, lr=8.32562e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220485
2024-11-11 23:59:58 - progress_bar.py[line:274] - INFO: epoch 085:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17239.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3081, ups=0.18, wpb=17239.2, bsz=1024, num_updates=32990, lr=8.31202e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220541
2024-11-12 00:00:55 - progress_bar.py[line:274] - INFO: epoch 085:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17107, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3039.6, ups=0.18, wpb=17107, bsz=1024, num_updates=33000, lr=8.29842e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=220598
2024-11-12 00:01:51 - progress_bar.py[line:274] - INFO: epoch 085:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17212.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3056.6, ups=0.18, wpb=17212.1, bsz=1024, num_updates=33010, lr=8.28481e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.1, wall=220654
2024-11-12 00:02:47 - progress_bar.py[line:274] - INFO: epoch 085:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17002.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3023.4, ups=0.18, wpb=17002.8, bsz=1024, num_updates=33020, lr=8.27121e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220710
2024-11-12 00:03:43 - progress_bar.py[line:274] - INFO: epoch 085:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=16934.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3057.4, ups=0.18, wpb=16934.4, bsz=1024, num_updates=33030, lr=8.2576e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=220766
2024-11-12 00:04:38 - progress_bar.py[line:274] - INFO: epoch 085:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=16884.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3053.6, ups=0.18, wpb=16884.8, bsz=1024, num_updates=33040, lr=8.244e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=220821
2024-11-12 00:05:34 - progress_bar.py[line:274] - INFO: epoch 085:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17341.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3086.6, ups=0.18, wpb=17341.9, bsz=1024, num_updates=33050, lr=8.2304e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220877
2024-11-12 00:06:30 - progress_bar.py[line:274] - INFO: epoch 085:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=16942.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3027.1, ups=0.18, wpb=16942.6, bsz=1024, num_updates=33060, lr=8.21679e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=12.5, wall=220933
2024-11-12 00:07:27 - progress_bar.py[line:274] - INFO: epoch 085:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17365.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3069.5, ups=0.18, wpb=17365.4, bsz=1024, num_updates=33070, lr=8.20319e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=220990
2024-11-12 00:08:23 - progress_bar.py[line:274] - INFO: epoch 085:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17155.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3037.8, ups=0.18, wpb=17155.3, bsz=1024, num_updates=33080, lr=8.18958e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=221046
2024-11-12 00:09:19 - progress_bar.py[line:274] - INFO: epoch 085:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=16891.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3002.2, ups=0.18, wpb=16891.9, bsz=1024, num_updates=33090, lr=8.17598e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=221102
2024-11-12 00:10:15 - progress_bar.py[line:274] - INFO: epoch 085:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17105.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3062, ups=0.18, wpb=17105.1, bsz=1024, num_updates=33100, lr=8.16238e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.1, wall=221158
2024-11-12 00:11:11 - progress_bar.py[line:274] - INFO: epoch 085:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17203.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3080.6, ups=0.18, wpb=17203.4, bsz=1024, num_updates=33110, lr=8.14877e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=221214
2024-11-12 00:12:07 - progress_bar.py[line:274] - INFO: epoch 085:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=16869.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3023.5, ups=0.18, wpb=16869.3, bsz=1024, num_updates=33120, lr=8.13517e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=221270
2024-11-12 00:13:03 - progress_bar.py[line:274] - INFO: epoch 085:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=17049.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3021.5, ups=0.18, wpb=17049.5, bsz=1024, num_updates=33130, lr=8.12156e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=221326
2024-11-12 00:13:59 - progress_bar.py[line:274] - INFO: epoch 085:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17363.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3107.3, ups=0.18, wpb=17363.5, bsz=1024, num_updates=33140, lr=8.10796e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=221382
2024-11-12 00:14:55 - progress_bar.py[line:274] - INFO: epoch 085:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17000, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3035.7, ups=0.18, wpb=17000, bsz=1024, num_updates=33150, lr=8.09436e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.1, wall=221438
2024-11-12 00:15:51 - progress_bar.py[line:274] - INFO: epoch 085:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17360.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3104.6, ups=0.18, wpb=17360.7, bsz=1024, num_updates=33160, lr=8.08075e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=221494
2024-11-12 00:16:48 - progress_bar.py[line:274] - INFO: epoch 085:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17418.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3087, ups=0.18, wpb=17418.2, bsz=1024, num_updates=33170, lr=8.06715e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=39, gb_free=13.3, wall=221551
2024-11-12 00:17:43 - progress_bar.py[line:274] - INFO: epoch 085:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.626, ntokens=17597.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.17, wps=3155.8, ups=0.18, wpb=17597.4, bsz=1024, num_updates=33180, lr=8.05355e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=221606
2024-11-12 00:18:39 - progress_bar.py[line:274] - INFO: epoch 085:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17072.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3042.9, ups=0.18, wpb=17072.6, bsz=1024, num_updates=33190, lr=8.03994e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=221662
2024-11-12 00:18:58 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 85 @ 33194 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
2024-11-12 00:18:58 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 00:20:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 00:22:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 85 @ 33194 updates, score 0) (writing took 224.58905757195316 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_85.pt
2024-11-12 00:23:38 - train.py[line:336] - INFO: end of epoch 85 (average epoch stats below)
2024-11-12 00:23:38 - progress_bar.py[line:282] - INFO: epoch 085 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.573 | ntokens 17157.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.95 | wps 2313.9 | ups 0.13 | wpb 17157.5 | bsz 1023 | num_updates 33194 | lr 8.0345e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 2158 | gb_free 13.3 | wall 221960
2024-11-12 00:23:38 - trainer.py[line:639] - INFO: loading train data for epoch 86
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000

slice_id 5 seek offset 250000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 00:26:20 - trainer.py[line:703] - INFO: begin training epoch 86
2024-11-12 00:26:20 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 00:26:57 - progress_bar.py[line:274] - INFO: epoch 086:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=16441.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=330.6, ups=0.02, wpb=16441.1, bsz=985.6, num_updates=33200, lr=8.02634e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=222160
2024-11-12 00:27:52 - progress_bar.py[line:274] - INFO: epoch 086:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17170.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3129.6, ups=0.18, wpb=17170.7, bsz=1024, num_updates=33210, lr=8.01273e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=222215
2024-11-12 00:28:48 - progress_bar.py[line:274] - INFO: epoch 086:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17252.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3038.4, ups=0.18, wpb=17252.5, bsz=1024, num_updates=33220, lr=7.99913e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=40, gb_free=13.4, wall=222271
2024-11-12 00:29:45 - progress_bar.py[line:274] - INFO: epoch 086:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17075.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3034.4, ups=0.18, wpb=17075.2, bsz=1024, num_updates=33230, lr=7.98553e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=41, gb_free=13.5, wall=222328
2024-11-12 00:30:43 - progress_bar.py[line:274] - INFO: epoch 086:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17156.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2939.6, ups=0.17, wpb=17156.5, bsz=1024, num_updates=33240, lr=7.97192e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=222386
2024-11-12 00:31:39 - progress_bar.py[line:274] - INFO: epoch 086:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17289, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3091.3, ups=0.18, wpb=17289, bsz=1024, num_updates=33250, lr=7.95832e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=222442
2024-11-12 00:32:34 - progress_bar.py[line:274] - INFO: epoch 086:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17131.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3100.8, ups=0.18, wpb=17131.4, bsz=1024, num_updates=33260, lr=7.94471e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=222497
2024-11-12 00:33:31 - progress_bar.py[line:274] - INFO: epoch 086:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17194, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3014.2, ups=0.18, wpb=17194, bsz=1024, num_updates=33270, lr=7.93111e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=38, gb_free=13.3, wall=222554
2024-11-12 00:34:29 - progress_bar.py[line:274] - INFO: epoch 086:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17477.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3049.6, ups=0.17, wpb=17477.8, bsz=1024, num_updates=33280, lr=7.91751e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=222612
2024-11-12 00:35:26 - progress_bar.py[line:274] - INFO: epoch 086:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17120, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2969.5, ups=0.17, wpb=17120, bsz=1024, num_updates=33290, lr=7.9039e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=222669
2024-11-12 00:36:23 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-12 00:36:29 - progress_bar.py[line:274] - INFO: epoch 086:    107 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17380.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=2766.6, ups=0.16, wpb=17380.2, bsz=1024, num_updates=33300, lr=7.8903e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=63, gb_free=13.3, wall=222732
2024-11-12 00:37:27 - progress_bar.py[line:274] - INFO: epoch 086:    117 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17139.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2976.9, ups=0.17, wpb=17139.9, bsz=1024, num_updates=33310, lr=7.87669e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=222790
2024-11-12 00:38:22 - progress_bar.py[line:274] - INFO: epoch 086:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17123.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3087.2, ups=0.18, wpb=17123.6, bsz=1024, num_updates=33320, lr=7.86309e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=222845
2024-11-12 00:39:20 - progress_bar.py[line:274] - INFO: epoch 086:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17317.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3009.5, ups=0.17, wpb=17317.4, bsz=1024, num_updates=33330, lr=7.84949e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.1, wall=222903
2024-11-12 00:40:14 - progress_bar.py[line:274] - INFO: epoch 086:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17097.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3157.1, ups=0.18, wpb=17097.6, bsz=1024, num_updates=33340, lr=7.83588e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=222957
2024-11-12 00:41:10 - progress_bar.py[line:274] - INFO: epoch 086:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17334.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3103.7, ups=0.18, wpb=17334.1, bsz=1024, num_updates=33350, lr=7.82228e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=223013
2024-11-12 00:42:07 - progress_bar.py[line:274] - INFO: epoch 086:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=16965.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2960.7, ups=0.17, wpb=16965.8, bsz=1024, num_updates=33360, lr=7.80867e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=223070
2024-11-12 00:43:04 - progress_bar.py[line:274] - INFO: epoch 086:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17246, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3051.7, ups=0.18, wpb=17246, bsz=1024, num_updates=33370, lr=7.79507e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=223126
2024-11-12 00:43:58 - progress_bar.py[line:274] - INFO: epoch 086:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17056.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3107.4, ups=0.18, wpb=17056.6, bsz=1024, num_updates=33380, lr=7.78147e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=223181
2024-11-12 00:44:56 - progress_bar.py[line:274] - INFO: epoch 086:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17121.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2997.4, ups=0.18, wpb=17121.7, bsz=1024, num_updates=33390, lr=7.76786e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=34, gb_free=13.3, wall=223238
2024-11-12 00:45:51 - progress_bar.py[line:274] - INFO: epoch 086:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17240, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3117.9, ups=0.18, wpb=17240, bsz=1024, num_updates=33400, lr=7.75426e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=223294
2024-11-12 00:46:47 - progress_bar.py[line:274] - INFO: epoch 086:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=16951.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3044.6, ups=0.18, wpb=16951.5, bsz=1024, num_updates=33410, lr=7.74065e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=223349
2024-11-12 00:47:44 - progress_bar.py[line:274] - INFO: epoch 086:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17256, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=2990.4, ups=0.17, wpb=17256, bsz=1024, num_updates=33420, lr=7.72705e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=223407
2024-11-12 00:48:40 - progress_bar.py[line:274] - INFO: epoch 086:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17112.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3066.7, ups=0.18, wpb=17112.2, bsz=1024, num_updates=33430, lr=7.71345e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=223463
2024-11-12 00:49:39 - progress_bar.py[line:274] - INFO: epoch 086:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17145.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2914.4, ups=0.17, wpb=17145.4, bsz=1024, num_updates=33440, lr=7.69984e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=223522
2024-11-12 00:50:37 - progress_bar.py[line:274] - INFO: epoch 086:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2954.2, ups=0.17, wpb=17227.5, bsz=1024, num_updates=33450, lr=7.68624e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=223580
2024-11-12 00:51:34 - progress_bar.py[line:274] - INFO: epoch 086:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.603, ntokens=17433.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3087, ups=0.18, wpb=17433.3, bsz=1024, num_updates=33460, lr=7.67263e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=223637
2024-11-12 00:52:29 - progress_bar.py[line:274] - INFO: epoch 086:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17070.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3074.8, ups=0.18, wpb=17070.1, bsz=1024, num_updates=33470, lr=7.65903e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=223692
2024-11-12 00:53:25 - progress_bar.py[line:274] - INFO: epoch 086:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=16989.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3054.8, ups=0.18, wpb=16989.7, bsz=1024, num_updates=33480, lr=7.64543e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=223748
2024-11-12 00:54:20 - progress_bar.py[line:274] - INFO: epoch 086:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17135.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3083.6, ups=0.18, wpb=17135.7, bsz=1024, num_updates=33490, lr=7.63182e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=223803
2024-11-12 00:55:17 - progress_bar.py[line:274] - INFO: epoch 086:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17436.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3101.6, ups=0.18, wpb=17436.2, bsz=1024, num_updates=33500, lr=7.61822e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=40, gb_free=13.4, wall=223859
2024-11-12 00:56:13 - progress_bar.py[line:274] - INFO: epoch 086:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=17391.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3079.4, ups=0.18, wpb=17391.2, bsz=1024, num_updates=33510, lr=7.60461e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=223916
2024-11-12 00:57:10 - progress_bar.py[line:274] - INFO: epoch 086:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=16915.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=2971.1, ups=0.18, wpb=16915.3, bsz=1024, num_updates=33520, lr=7.59101e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=223973
2024-11-12 00:58:07 - progress_bar.py[line:274] - INFO: epoch 086:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17572.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3084.5, ups=0.18, wpb=17572.6, bsz=1024, num_updates=33530, lr=7.57741e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=224030
2024-11-12 00:59:03 - progress_bar.py[line:274] - INFO: epoch 086:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=16923.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3006.9, ups=0.18, wpb=16923.1, bsz=1024, num_updates=33540, lr=7.5638e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=224086
2024-11-12 00:59:58 - progress_bar.py[line:274] - INFO: epoch 086:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17194.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3112, ups=0.18, wpb=17194.9, bsz=1024, num_updates=33550, lr=7.5502e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=224141
2024-11-12 01:00:55 - progress_bar.py[line:274] - INFO: epoch 086:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17189.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3064.2, ups=0.18, wpb=17189.5, bsz=1024, num_updates=33560, lr=7.53659e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=224197
2024-11-12 01:01:50 - progress_bar.py[line:274] - INFO: epoch 086:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.638, ntokens=17583.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.23, wps=3166.5, ups=0.18, wpb=17583.2, bsz=1024, num_updates=33570, lr=7.52299e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=224253
2024-11-12 01:02:46 - progress_bar.py[line:274] - INFO: epoch 086:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17068.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3056.8, ups=0.18, wpb=17068.5, bsz=1024, num_updates=33580, lr=7.50939e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=224309
2024-11-12 01:03:04 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 86 @ 33584 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
2024-11-12 01:03:04 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 01:04:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-12 01:06:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 86 @ 33584 updates, score 0) (writing took 224.84344462794252 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_86.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-12 01:07:44 - train.py[line:336] - INFO: end of epoch 86 (average epoch stats below)
2024-11-12 01:07:44 - progress_bar.py[line:282] - INFO: epoch 086 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.576 | ntokens 17179 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.96 | wps 2531.8 | ups 0.15 | wpb 17179 | bsz 1023 | num_updates 33584 | lr 7.50395e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 1707 | gb_free 13.1 | wall 224607
2024-11-12 01:07:44 - trainer.py[line:639] - INFO: loading train data for epoch 87
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 01:10:23 - trainer.py[line:703] - INFO: begin training epoch 87
2024-11-12 01:10:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 01:10:58 - progress_bar.py[line:274] - INFO: epoch 087:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=16498.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=335.1, ups=0.02, wpb=16498.6, bsz=985.6, num_updates=33590, lr=7.49578e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=224801
2024-11-12 01:11:57 - progress_bar.py[line:274] - INFO: epoch 087:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17158.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2909.9, ups=0.17, wpb=17158.7, bsz=1024, num_updates=33600, lr=7.48218e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=224860
2024-11-12 01:12:56 - progress_bar.py[line:274] - INFO: epoch 087:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17145.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2902, ups=0.17, wpb=17145.4, bsz=1024, num_updates=33610, lr=7.46857e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=224919
2024-11-12 01:13:57 - progress_bar.py[line:274] - INFO: epoch 087:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17127.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2838.4, ups=0.17, wpb=17127.4, bsz=1024, num_updates=33620, lr=7.45497e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=224980
2024-11-12 01:14:51 - progress_bar.py[line:274] - INFO: epoch 087:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17275.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3162.8, ups=0.18, wpb=17275.3, bsz=1024, num_updates=33630, lr=7.44137e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=225034
2024-11-12 01:15:45 - progress_bar.py[line:274] - INFO: epoch 087:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17065.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3178.5, ups=0.19, wpb=17065.2, bsz=1024, num_updates=33640, lr=7.42776e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=225088
2024-11-12 01:16:42 - progress_bar.py[line:274] - INFO: epoch 087:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=16999.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3010.8, ups=0.18, wpb=16999.9, bsz=1024, num_updates=33650, lr=7.41416e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=47, gb_free=13.1, wall=225144
2024-11-12 01:17:38 - progress_bar.py[line:274] - INFO: epoch 087:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17194.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3030.3, ups=0.18, wpb=17194.9, bsz=1024, num_updates=33660, lr=7.40056e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=225201
2024-11-12 01:18:35 - progress_bar.py[line:274] - INFO: epoch 087:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17145, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2997.6, ups=0.17, wpb=17145, bsz=1024, num_updates=33670, lr=7.38695e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=225258
2024-11-12 01:19:32 - progress_bar.py[line:274] - INFO: epoch 087:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17144.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3017.1, ups=0.18, wpb=17144.6, bsz=1024, num_updates=33680, lr=7.37335e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=225315
2024-11-12 01:20:29 - progress_bar.py[line:274] - INFO: epoch 087:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3041.4, ups=0.18, wpb=17219.7, bsz=1024, num_updates=33690, lr=7.35974e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=225372
2024-11-12 01:21:25 - progress_bar.py[line:274] - INFO: epoch 087:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17330.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3072.3, ups=0.18, wpb=17330.2, bsz=1024, num_updates=33700, lr=7.34614e-06, gnorm=0.004, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=225428
2024-11-12 01:22:19 - progress_bar.py[line:274] - INFO: epoch 087:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17345.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3204.2, ups=0.18, wpb=17345.3, bsz=1024, num_updates=33710, lr=7.33254e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=54, gb_free=13.5, wall=225482
2024-11-12 01:23:16 - progress_bar.py[line:274] - INFO: epoch 087:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3067, ups=0.18, wpb=17323.2, bsz=1024, num_updates=33720, lr=7.31893e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=225539
2024-11-12 01:24:14 - progress_bar.py[line:274] - INFO: epoch 087:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=16968.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2944.9, ups=0.17, wpb=16968.5, bsz=1024, num_updates=33730, lr=7.30533e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=58, gb_free=13.3, wall=225596
2024-11-12 01:25:08 - progress_bar.py[line:274] - INFO: epoch 087:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17307.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3191.3, ups=0.18, wpb=17307.7, bsz=1024, num_updates=33740, lr=7.29172e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=225651
2024-11-12 01:26:04 - progress_bar.py[line:274] - INFO: epoch 087:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=16945.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3000.9, ups=0.18, wpb=16945.7, bsz=1024, num_updates=33750, lr=7.27812e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=225707
2024-11-12 01:27:02 - progress_bar.py[line:274] - INFO: epoch 087:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17468.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3042.8, ups=0.17, wpb=17468.1, bsz=1024, num_updates=33760, lr=7.26452e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=225765
2024-11-12 01:27:59 - progress_bar.py[line:274] - INFO: epoch 087:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=16918.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=2961.6, ups=0.18, wpb=16918.5, bsz=1024, num_updates=33770, lr=7.25091e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.3, wall=225822
2024-11-12 01:28:55 - progress_bar.py[line:274] - INFO: epoch 087:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17014.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3020.9, ups=0.18, wpb=17014.1, bsz=1024, num_updates=33780, lr=7.23731e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=35, gb_free=13.4, wall=225878
2024-11-12 01:29:52 - progress_bar.py[line:274] - INFO: epoch 087:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.609, ntokens=17327.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3029.6, ups=0.17, wpb=17327.8, bsz=1024, num_updates=33790, lr=7.2237e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=225935
2024-11-12 01:30:50 - progress_bar.py[line:274] - INFO: epoch 087:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=16948.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2950.7, ups=0.17, wpb=16948.1, bsz=1024, num_updates=33800, lr=7.2101e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=225993
2024-11-12 01:31:48 - progress_bar.py[line:274] - INFO: epoch 087:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17125.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2949.2, ups=0.17, wpb=17125.6, bsz=1024, num_updates=33810, lr=7.1965e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=226051
2024-11-12 01:32:46 - progress_bar.py[line:274] - INFO: epoch 087:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17105.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2926.6, ups=0.17, wpb=17105.6, bsz=1024, num_updates=33820, lr=7.18289e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226109
2024-11-12 01:33:42 - progress_bar.py[line:274] - INFO: epoch 087:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17013.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3039.6, ups=0.18, wpb=17013.3, bsz=1024, num_updates=33830, lr=7.16929e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=226165
2024-11-12 01:34:39 - progress_bar.py[line:274] - INFO: epoch 087:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=16966, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2973.1, ups=0.18, wpb=16966, bsz=1024, num_updates=33840, lr=7.15568e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=226222
2024-11-12 01:35:36 - progress_bar.py[line:274] - INFO: epoch 087:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17364.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3036.2, ups=0.17, wpb=17364.8, bsz=1024, num_updates=33850, lr=7.14208e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.1, wall=226279
2024-11-12 01:36:34 - progress_bar.py[line:274] - INFO: epoch 087:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=16957.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2923.3, ups=0.17, wpb=16957.1, bsz=1024, num_updates=33860, lr=7.12848e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226337
2024-11-12 01:37:32 - progress_bar.py[line:274] - INFO: epoch 087:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=16880.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=2946.6, ups=0.17, wpb=16880.3, bsz=1024, num_updates=33870, lr=7.11487e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226395
2024-11-12 01:38:30 - progress_bar.py[line:274] - INFO: epoch 087:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17220.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2977.2, ups=0.17, wpb=17220.5, bsz=1024, num_updates=33880, lr=7.10127e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=226453
2024-11-12 01:39:27 - progress_bar.py[line:274] - INFO: epoch 087:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17163.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2983.2, ups=0.17, wpb=17163.8, bsz=1024, num_updates=33890, lr=7.08766e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=226510
2024-11-12 01:40:25 - progress_bar.py[line:274] - INFO: epoch 087:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17007.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2958.5, ups=0.17, wpb=17007.8, bsz=1024, num_updates=33900, lr=7.07406e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=226568
2024-11-12 01:41:23 - progress_bar.py[line:274] - INFO: epoch 087:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17207.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2966.5, ups=0.17, wpb=17207.3, bsz=1024, num_updates=33910, lr=7.06046e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=226626
2024-11-12 01:42:20 - progress_bar.py[line:274] - INFO: epoch 087:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17273.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3009.2, ups=0.17, wpb=17273.4, bsz=1024, num_updates=33920, lr=7.04685e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226683
2024-11-12 01:43:18 - progress_bar.py[line:274] - INFO: epoch 087:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17112, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=2974, ups=0.17, wpb=17112, bsz=1024, num_updates=33930, lr=7.03325e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226740
2024-11-12 01:44:15 - progress_bar.py[line:274] - INFO: epoch 087:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17255.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3011.5, ups=0.17, wpb=17255.4, bsz=1024, num_updates=33940, lr=7.01964e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=226798
2024-11-12 01:45:12 - progress_bar.py[line:274] - INFO: epoch 087:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17340.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3012.3, ups=0.17, wpb=17340.6, bsz=1024, num_updates=33950, lr=7.00604e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=226855
2024-11-12 01:46:09 - progress_bar.py[line:274] - INFO: epoch 087:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17217.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3051.7, ups=0.18, wpb=17217.1, bsz=1024, num_updates=33960, lr=6.99244e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=226912
2024-11-12 01:47:05 - progress_bar.py[line:274] - INFO: epoch 087:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.618, ntokens=17424.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.14, wps=3131.2, ups=0.18, wpb=17424.9, bsz=1024, num_updates=33970, lr=6.97883e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=12.9, wall=226967
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt2024-11-12 01:47:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 87 @ 33975 updates

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt
2024-11-12 01:47:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 01:49:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 01:51:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 87 @ 33975 updates, score 0) (writing took 224.14642440201715 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_87.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
2024-11-12 01:52:08 - train.py[line:336] - INFO: end of epoch 87 (average epoch stats below)
2024-11-12 01:52:08 - progress_bar.py[line:282] - INFO: epoch 087 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.567 | ntokens 17141.2 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.93 | wps 2516 | ups 0.15 | wpb 17141.2 | bsz 1023 | num_updates 33975 | lr 6.97203e-06 | gnorm 0.003 | clip 0 | loss_scale 131072 | train_wall 1530 | gb_free 13.3 | wall 227271
2024-11-12 01:52:08 - trainer.py[line:639] - INFO: loading train data for epoch 88
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 01:54:50 - trainer.py[line:703] - INFO: begin training epoch 88
2024-11-12 01:54:50 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 01:55:21 - progress_bar.py[line:274] - INFO: epoch 088:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=16486.1, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=332, ups=0.02, wpb=16486.1, bsz=985.6, num_updates=33980, lr=6.96523e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=29, gb_free=13.1, wall=227464
2024-11-12 01:56:16 - progress_bar.py[line:274] - INFO: epoch 088:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17274.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3133.2, ups=0.18, wpb=17274.7, bsz=1024, num_updates=33990, lr=6.95162e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=227519
2024-11-12 01:57:12 - progress_bar.py[line:274] - INFO: epoch 088:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17535, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3135.2, ups=0.18, wpb=17535, bsz=1024, num_updates=34000, lr=6.93802e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=227575
2024-11-12 01:58:08 - progress_bar.py[line:274] - INFO: epoch 088:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17197.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3063.2, ups=0.18, wpb=17197.9, bsz=1024, num_updates=34010, lr=6.92442e-06, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=227631
2024-11-12 01:59:04 - progress_bar.py[line:274] - INFO: epoch 088:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17141.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3101.7, ups=0.18, wpb=17141.2, bsz=1024, num_updates=34020, lr=6.91081e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=227686
2024-11-12 02:00:01 - progress_bar.py[line:274] - INFO: epoch 088:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17178.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3002.6, ups=0.17, wpb=17178.9, bsz=1024, num_updates=34030, lr=6.89721e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=227744
2024-11-12 02:00:59 - progress_bar.py[line:274] - INFO: epoch 088:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17153.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=2940.9, ups=0.17, wpb=17153.2, bsz=1024, num_updates=34040, lr=6.8836e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=227802
2024-11-12 02:01:57 - progress_bar.py[line:274] - INFO: epoch 088:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17121.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2969.6, ups=0.17, wpb=17121.5, bsz=1024, num_updates=34050, lr=6.87e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13, wall=227860
2024-11-12 02:02:54 - progress_bar.py[line:274] - INFO: epoch 088:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3003.5, ups=0.17, wpb=17226, bsz=1024, num_updates=34060, lr=6.8564e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=227917
2024-11-12 02:03:52 - progress_bar.py[line:274] - INFO: epoch 088:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17085.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2939.9, ups=0.17, wpb=17085.1, bsz=1024, num_updates=34070, lr=6.84279e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=227975
2024-11-12 02:04:51 - progress_bar.py[line:274] - INFO: epoch 088:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2987.7, ups=0.17, wpb=17424.2, bsz=1024, num_updates=34080, lr=6.82919e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228033
2024-11-12 02:05:48 - progress_bar.py[line:274] - INFO: epoch 088:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17113.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2959.9, ups=0.17, wpb=17113.8, bsz=1024, num_updates=34090, lr=6.81558e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=228091
2024-11-12 02:06:46 - progress_bar.py[line:274] - INFO: epoch 088:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17334.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3011.1, ups=0.17, wpb=17334.9, bsz=1024, num_updates=34100, lr=6.80198e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228149
2024-11-12 02:07:44 - progress_bar.py[line:274] - INFO: epoch 088:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17192.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2959.5, ups=0.17, wpb=17192.3, bsz=1024, num_updates=34110, lr=6.78838e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228207
2024-11-12 02:08:40 - progress_bar.py[line:274] - INFO: epoch 088:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=16983.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3019.6, ups=0.18, wpb=16983.4, bsz=1024, num_updates=34120, lr=6.77477e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=228263
2024-11-12 02:09:36 - progress_bar.py[line:274] - INFO: epoch 088:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17479.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3133.5, ups=0.18, wpb=17479.6, bsz=1024, num_updates=34130, lr=6.76117e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228319
2024-11-12 02:10:32 - progress_bar.py[line:274] - INFO: epoch 088:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17275.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3075.5, ups=0.18, wpb=17275.1, bsz=1024, num_updates=34140, lr=6.74756e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=228375
2024-11-12 02:11:32 - progress_bar.py[line:274] - INFO: epoch 088:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17143.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2873.5, ups=0.17, wpb=17143.4, bsz=1024, num_updates=34150, lr=6.73396e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228435
2024-11-12 02:12:30 - progress_bar.py[line:274] - INFO: epoch 088:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=16903.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=2893.6, ups=0.17, wpb=16903.4, bsz=1024, num_updates=34160, lr=6.72036e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13, wall=228493
2024-11-12 02:13:29 - progress_bar.py[line:274] - INFO: epoch 088:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17060.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=2901.8, ups=0.17, wpb=17060.4, bsz=1024, num_updates=34170, lr=6.70675e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=228552
2024-11-12 02:14:26 - progress_bar.py[line:274] - INFO: epoch 088:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17070.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=2988.5, ups=0.18, wpb=17070.4, bsz=1024, num_updates=34180, lr=6.69315e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228609
2024-11-12 02:15:25 - progress_bar.py[line:274] - INFO: epoch 088:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16924.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=2879, ups=0.17, wpb=16924.1, bsz=1024, num_updates=34190, lr=6.67955e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228668
2024-11-12 02:16:21 - progress_bar.py[line:274] - INFO: epoch 088:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17075.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3030.5, ups=0.18, wpb=17075.4, bsz=1024, num_updates=34200, lr=6.66594e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=228724
2024-11-12 02:17:16 - progress_bar.py[line:274] - INFO: epoch 088:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.608, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.1, wps=3190.1, ups=0.18, wpb=17420.4, bsz=1024, num_updates=34210, lr=6.65234e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=228779
2024-11-12 02:18:11 - progress_bar.py[line:274] - INFO: epoch 088:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=16936.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3053, ups=0.18, wpb=16936.9, bsz=1024, num_updates=34220, lr=6.63873e-06, gnorm=0.003, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=228834
2024-11-12 02:18:51 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-12 02:19:13 - progress_bar.py[line:274] - INFO: epoch 088:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17156, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=2795.7, ups=0.16, wpb=17156, bsz=1024, num_updates=34230, lr=6.62513e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=228896
2024-11-12 02:20:09 - progress_bar.py[line:274] - INFO: epoch 088:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17632.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3113.8, ups=0.18, wpb=17632.1, bsz=1024, num_updates=34240, lr=6.61153e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=228952
2024-11-12 02:21:06 - progress_bar.py[line:274] - INFO: epoch 088:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17065.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3034.1, ups=0.18, wpb=17065.8, bsz=1024, num_updates=34250, lr=6.59792e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=44, gb_free=13.2, wall=229009
2024-11-12 02:22:04 - progress_bar.py[line:274] - INFO: epoch 088:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17065.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2906.2, ups=0.17, wpb=17065.2, bsz=1024, num_updates=34260, lr=6.58432e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=229067
2024-11-12 02:23:01 - progress_bar.py[line:274] - INFO: epoch 088:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17302.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3050.3, ups=0.18, wpb=17302.3, bsz=1024, num_updates=34270, lr=6.57071e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=229124
2024-11-12 02:23:58 - progress_bar.py[line:274] - INFO: epoch 088:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17237.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3026.4, ups=0.18, wpb=17237.5, bsz=1024, num_updates=34280, lr=6.55711e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=229181
2024-11-12 02:24:56 - progress_bar.py[line:274] - INFO: epoch 088:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17216.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=2961.9, ups=0.17, wpb=17216.8, bsz=1024, num_updates=34290, lr=6.54351e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=31, gb_free=13.1, wall=229239
2024-11-12 02:25:54 - progress_bar.py[line:274] - INFO: epoch 088:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17093, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2948.7, ups=0.17, wpb=17093, bsz=1024, num_updates=34300, lr=6.5299e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=229297
2024-11-12 02:26:52 - progress_bar.py[line:274] - INFO: epoch 088:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17309.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2977.8, ups=0.17, wpb=17309.3, bsz=1024, num_updates=34310, lr=6.5163e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=229355
2024-11-12 02:27:49 - progress_bar.py[line:274] - INFO: epoch 088:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17077.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3010.2, ups=0.18, wpb=17077.3, bsz=1024, num_updates=34320, lr=6.50269e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=229412
2024-11-12 02:28:46 - progress_bar.py[line:274] - INFO: epoch 088:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17223.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3003.8, ups=0.17, wpb=17223.6, bsz=1024, num_updates=34330, lr=6.48909e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=229469
2024-11-12 02:29:44 - progress_bar.py[line:274] - INFO: epoch 088:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17256, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3014.8, ups=0.17, wpb=17256, bsz=1024, num_updates=34340, lr=6.47549e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=229526
2024-11-12 02:30:40 - progress_bar.py[line:274] - INFO: epoch 088:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17360.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3060.3, ups=0.18, wpb=17360.7, bsz=1024, num_updates=34350, lr=6.46188e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=229583
2024-11-12 02:31:36 - progress_bar.py[line:274] - INFO: epoch 088:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17289.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3111.2, ups=0.18, wpb=17289.3, bsz=1024, num_updates=34360, lr=6.44828e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=229639
2024-11-12 02:32:00 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 88 @ 34365 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
2024-11-12 02:32:00 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 02:33:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
2024-11-12 02:35:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 88 @ 34365 updates, score 0) (writing took 224.13379608897958 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_88.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-12 02:36:39 - train.py[line:336] - INFO: end of epoch 88 (average epoch stats below)
2024-11-12 02:36:39 - progress_bar.py[line:282] - INFO: epoch 088 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.571 | ntokens 17179.3 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.94 | wps 2508.1 | ups 0.15 | wpb 17179.3 | bsz 1023 | num_updates 34365 | lr 6.44148e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 1265 | gb_free 13.3 | wall 229942
2024-11-12 02:36:39 - trainer.py[line:639] - INFO: loading train data for epoch 89
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 02:39:22 - trainer.py[line:703] - INFO: begin training epoch 89
2024-11-12 02:39:22 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 02:39:52 - progress_bar.py[line:274] - INFO: epoch 089:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=16523.2, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=332.9, ups=0.02, wpb=16523.2, bsz=985.6, num_updates=34370, lr=6.43467e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=29, gb_free=13.2, wall=230135
2024-11-12 02:40:48 - progress_bar.py[line:274] - INFO: epoch 089:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17156.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3057.1, ups=0.18, wpb=17156.5, bsz=1024, num_updates=34380, lr=6.42107e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=230191
2024-11-12 02:41:00 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-12 02:41:51 - progress_bar.py[line:274] - INFO: epoch 089:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17168.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2740.2, ups=0.16, wpb=17168.4, bsz=1024, num_updates=34390, lr=6.40747e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=34, gb_free=13.5, wall=230254
2024-11-12 02:42:47 - progress_bar.py[line:274] - INFO: epoch 089:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17079.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3035.2, ups=0.18, wpb=17079.4, bsz=1024, num_updates=34400, lr=6.39386e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=230310
2024-11-12 02:43:42 - progress_bar.py[line:274] - INFO: epoch 089:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17182.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3116.6, ups=0.18, wpb=17182.4, bsz=1024, num_updates=34410, lr=6.38026e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=230365
2024-11-12 02:44:36 - progress_bar.py[line:274] - INFO: epoch 089:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17286.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3210.9, ups=0.19, wpb=17286.4, bsz=1024, num_updates=34420, lr=6.36665e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=230419
2024-11-12 02:45:31 - progress_bar.py[line:274] - INFO: epoch 089:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17020.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3113.8, ups=0.18, wpb=17020.5, bsz=1024, num_updates=34430, lr=6.35305e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=230474
2024-11-12 02:46:26 - progress_bar.py[line:274] - INFO: epoch 089:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.602, ntokens=17336.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3176.9, ups=0.18, wpb=17336.6, bsz=1024, num_updates=34440, lr=6.33945e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=230528
2024-11-12 02:47:20 - progress_bar.py[line:274] - INFO: epoch 089:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.596, ntokens=17436.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3197.9, ups=0.18, wpb=17436.4, bsz=1024, num_updates=34450, lr=6.32584e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=230583
2024-11-12 02:48:15 - progress_bar.py[line:274] - INFO: epoch 089:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=16951.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3099.5, ups=0.18, wpb=16951.3, bsz=1024, num_updates=34460, lr=6.31224e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=230638
2024-11-12 02:49:09 - progress_bar.py[line:274] - INFO: epoch 089:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17100.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3134.1, ups=0.18, wpb=17100.6, bsz=1024, num_updates=34470, lr=6.29863e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=230692
2024-11-12 02:50:04 - progress_bar.py[line:274] - INFO: epoch 089:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17139.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3109.9, ups=0.18, wpb=17139.8, bsz=1024, num_updates=34480, lr=6.28503e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=38, gb_free=13.4, wall=230747
2024-11-12 02:50:43 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-12 02:51:05 - progress_bar.py[line:274] - INFO: epoch 089:    127 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.607, ntokens=17466.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=2887, ups=0.17, wpb=17466.7, bsz=1024, num_updates=34490, lr=6.27143e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=51, gb_free=13.4, wall=230808
2024-11-12 02:52:00 - progress_bar.py[line:274] - INFO: epoch 089:    137 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17138.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3107.3, ups=0.18, wpb=17138.6, bsz=1024, num_updates=34500, lr=6.25782e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=230863
2024-11-12 02:52:56 - progress_bar.py[line:274] - INFO: epoch 089:    147 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17041.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3073.5, ups=0.18, wpb=17041.5, bsz=1024, num_updates=34510, lr=6.24422e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=230918
2024-11-12 02:53:51 - progress_bar.py[line:274] - INFO: epoch 089:    157 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17274.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3136.7, ups=0.18, wpb=17274.6, bsz=1024, num_updates=34520, lr=6.23061e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=230973
2024-11-12 02:54:45 - progress_bar.py[line:274] - INFO: epoch 089:    167 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17174.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3128.8, ups=0.18, wpb=17174.7, bsz=1024, num_updates=34530, lr=6.21701e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231028
2024-11-12 02:55:40 - progress_bar.py[line:274] - INFO: epoch 089:    177 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17357.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3173.5, ups=0.18, wpb=17357.8, bsz=1024, num_updates=34540, lr=6.20341e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231083
2024-11-12 02:56:35 - progress_bar.py[line:274] - INFO: epoch 089:    187 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17111.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3114.1, ups=0.18, wpb=17111.2, bsz=1024, num_updates=34550, lr=6.1898e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231138
2024-11-12 02:57:31 - progress_bar.py[line:274] - INFO: epoch 089:    197 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=17019.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3053, ups=0.18, wpb=17019.3, bsz=1024, num_updates=34560, lr=6.1762e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=56, gb_free=13, wall=231194
2024-11-12 02:58:25 - progress_bar.py[line:274] - INFO: epoch 089:    207 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17138.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3138.7, ups=0.18, wpb=17138.3, bsz=1024, num_updates=34570, lr=6.16259e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231248
2024-11-12 02:59:21 - progress_bar.py[line:274] - INFO: epoch 089:    217 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17153.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3111.7, ups=0.18, wpb=17153.9, bsz=1024, num_updates=34580, lr=6.14899e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=231304
2024-11-12 03:00:16 - progress_bar.py[line:274] - INFO: epoch 089:    227 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=16980.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3071.9, ups=0.18, wpb=16980.2, bsz=1024, num_updates=34590, lr=6.13539e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.1, wall=231359
2024-11-12 03:01:11 - progress_bar.py[line:274] - INFO: epoch 089:    237 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17129.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3121.1, ups=0.18, wpb=17129.9, bsz=1024, num_updates=34600, lr=6.12178e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231414
2024-11-12 03:02:06 - progress_bar.py[line:274] - INFO: epoch 089:    247 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17148.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3089.1, ups=0.18, wpb=17148.9, bsz=1024, num_updates=34610, lr=6.10818e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=231469
2024-11-12 03:03:01 - progress_bar.py[line:274] - INFO: epoch 089:    257 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17284.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3130.4, ups=0.18, wpb=17284.1, bsz=1024, num_updates=34620, lr=6.09457e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231524
2024-11-12 03:03:57 - progress_bar.py[line:274] - INFO: epoch 089:    267 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17161.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3091.4, ups=0.18, wpb=17161.5, bsz=1024, num_updates=34630, lr=6.08097e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=231580
2024-11-12 03:04:52 - progress_bar.py[line:274] - INFO: epoch 089:    277 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17162.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3128, ups=0.18, wpb=17162.2, bsz=1024, num_updates=34640, lr=6.06737e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.5, wall=231635
2024-11-12 03:05:47 - progress_bar.py[line:274] - INFO: epoch 089:    287 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17121.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3120.9, ups=0.18, wpb=17121.9, bsz=1024, num_updates=34650, lr=6.05376e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=231690
2024-11-12 03:06:41 - progress_bar.py[line:274] - INFO: epoch 089:    297 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.601, ntokens=17420.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.07, wps=3183.3, ups=0.18, wpb=17420.8, bsz=1024, num_updates=34660, lr=6.04016e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=231744
2024-11-12 03:07:36 - progress_bar.py[line:274] - INFO: epoch 089:    307 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17291.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3168.2, ups=0.18, wpb=17291.6, bsz=1024, num_updates=34670, lr=6.02655e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=231799
2024-11-12 03:08:31 - progress_bar.py[line:274] - INFO: epoch 089:    317 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17339.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3140.6, ups=0.18, wpb=17339.6, bsz=1024, num_updates=34680, lr=6.01295e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=231854
2024-11-12 03:09:25 - progress_bar.py[line:274] - INFO: epoch 089:    327 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17091, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3185.6, ups=0.19, wpb=17091, bsz=1024, num_updates=34690, lr=5.99935e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=54, gb_free=13.4, wall=231908
2024-11-12 03:10:18 - progress_bar.py[line:274] - INFO: epoch 089:    337 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17408.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3283.5, ups=0.19, wpb=17408.6, bsz=1024, num_updates=34700, lr=5.98574e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=53, gb_free=13.3, wall=231961
2024-11-12 03:11:11 - progress_bar.py[line:274] - INFO: epoch 089:    347 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17059.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3234.8, ups=0.19, wpb=17059.4, bsz=1024, num_updates=34710, lr=5.97214e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=45, gb_free=13.3, wall=232014
2024-11-12 03:12:05 - progress_bar.py[line:274] - INFO: epoch 089:    357 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17400.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3190.1, ups=0.18, wpb=17400.9, bsz=1024, num_updates=34720, lr=5.95854e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=44, gb_free=13.3, wall=232068
2024-11-12 03:13:00 - progress_bar.py[line:274] - INFO: epoch 089:    367 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17350.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3164.7, ups=0.18, wpb=17350.2, bsz=1024, num_updates=34730, lr=5.94493e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=232123
2024-11-12 03:13:57 - progress_bar.py[line:274] - INFO: epoch 089:    377 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.591, ntokens=17435.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3065.8, ups=0.18, wpb=17435.3, bsz=1024, num_updates=34740, lr=5.93133e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=56, gb_free=13.5, wall=232180
2024-11-12 03:14:51 - progress_bar.py[line:274] - INFO: epoch 089:    387 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=16972.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3109.4, ups=0.18, wpb=16972.8, bsz=1024, num_updates=34750, lr=5.91772e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=55, gb_free=13.4, wall=232234
2024-11-12 03:15:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 89 @ 34754 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt
2024-11-12 03:15:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 03:17:01 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-12 03:18:54 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 89 @ 34754 updates, score 0) (writing took 223.91152754693758 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_89.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
2024-11-12 03:19:49 - train.py[line:336] - INFO: end of epoch 89 (average epoch stats below)
2024-11-12 03:19:49 - progress_bar.py[line:282] - INFO: epoch 089 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.569 | ntokens 17183.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.93 | wps 2581 | ups 0.15 | wpb 17183.6 | bsz 1023 | num_updates 34754 | lr 5.91228e-06 | gnorm 0.003 | clip 0 | loss_scale 16384 | train_wall 1819 | gb_free 13.2 | wall 232532
2024-11-12 03:19:49 - trainer.py[line:639] - INFO: loading train data for epoch 90
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 03:22:32 - trainer.py[line:703] - INFO: begin training epoch 90
2024-11-12 03:22:32 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 03:23:06 - progress_bar.py[line:274] - INFO: epoch 090:      6 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=16721.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=337.9, ups=0.02, wpb=16721.7, bsz=985.6, num_updates=34760, lr=5.90412e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=37, gb_free=13.4, wall=232729
2024-11-12 03:24:01 - progress_bar.py[line:274] - INFO: epoch 090:     16 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.594, ntokens=17331.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3185.7, ups=0.18, wpb=17331.2, bsz=1024, num_updates=34770, lr=5.89052e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=232784
2024-11-12 03:24:55 - progress_bar.py[line:274] - INFO: epoch 090:     26 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17350.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3193.6, ups=0.18, wpb=17350.7, bsz=1024, num_updates=34780, lr=5.87691e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=232838
2024-11-12 03:25:49 - progress_bar.py[line:274] - INFO: epoch 090:     36 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17084.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3146.4, ups=0.18, wpb=17084.4, bsz=1024, num_updates=34790, lr=5.86331e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=232892
2024-11-12 03:26:43 - progress_bar.py[line:274] - INFO: epoch 090:     46 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17057, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3197.2, ups=0.19, wpb=17057, bsz=1024, num_updates=34800, lr=5.8497e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=232946
2024-11-12 03:27:38 - progress_bar.py[line:274] - INFO: epoch 090:     56 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17364.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3155.3, ups=0.18, wpb=17364.7, bsz=1024, num_updates=34810, lr=5.8361e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233001
2024-11-12 03:28:36 - progress_bar.py[line:274] - INFO: epoch 090:     66 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17153.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2927.9, ups=0.17, wpb=17153.4, bsz=1024, num_updates=34820, lr=5.8225e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=233059
2024-11-12 03:29:35 - progress_bar.py[line:274] - INFO: epoch 090:     76 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17082.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2899.6, ups=0.17, wpb=17082.2, bsz=1024, num_updates=34830, lr=5.80889e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233118
2024-11-12 03:30:29 - progress_bar.py[line:274] - INFO: epoch 090:     86 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17389.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3215.1, ups=0.18, wpb=17389.4, bsz=1024, num_updates=34840, lr=5.79529e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=233172
2024-11-12 03:31:23 - progress_bar.py[line:274] - INFO: epoch 090:     96 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17056.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3171.9, ups=0.19, wpb=17056.4, bsz=1024, num_updates=34850, lr=5.78168e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=233226
2024-11-12 03:32:17 - progress_bar.py[line:274] - INFO: epoch 090:    106 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17425.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3221.2, ups=0.18, wpb=17425.4, bsz=1024, num_updates=34860, lr=5.76808e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=233280
2024-11-12 03:33:11 - progress_bar.py[line:274] - INFO: epoch 090:    116 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=16841.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3110.2, ups=0.18, wpb=16841.3, bsz=1024, num_updates=34870, lr=5.75448e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233334
2024-11-12 03:34:06 - progress_bar.py[line:274] - INFO: epoch 090:    126 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17283.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3168.4, ups=0.18, wpb=17283.8, bsz=1024, num_updates=34880, lr=5.74087e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=233389
2024-11-12 03:35:00 - progress_bar.py[line:274] - INFO: epoch 090:    136 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17281.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3186.5, ups=0.18, wpb=17281.3, bsz=1024, num_updates=34890, lr=5.72727e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233443
2024-11-12 03:35:55 - progress_bar.py[line:274] - INFO: epoch 090:    146 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17036, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3092.2, ups=0.18, wpb=17036, bsz=1024, num_updates=34900, lr=5.71366e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=233498
2024-11-12 03:36:49 - progress_bar.py[line:274] - INFO: epoch 090:    156 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.612, ntokens=17474.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3223.8, ups=0.18, wpb=17474.2, bsz=1024, num_updates=34910, lr=5.70006e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233552
2024-11-12 03:37:45 - progress_bar.py[line:274] - INFO: epoch 090:    166 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17054.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3082.7, ups=0.18, wpb=17054.3, bsz=1024, num_updates=34920, lr=5.68646e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=36, gb_free=13.3, wall=233608
2024-11-12 03:38:41 - progress_bar.py[line:274] - INFO: epoch 090:    176 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17175.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3027.5, ups=0.18, wpb=17175.8, bsz=1024, num_updates=34930, lr=5.67285e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=55, gb_free=13.3, wall=233664
2024-11-12 03:39:34 - progress_bar.py[line:274] - INFO: epoch 090:    186 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17182.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3297.3, ups=0.19, wpb=17182.5, bsz=1024, num_updates=34940, lr=5.65925e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=233716
2024-11-12 03:40:26 - progress_bar.py[line:274] - INFO: epoch 090:    196 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17269.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3293.6, ups=0.19, wpb=17269.1, bsz=1024, num_updates=34950, lr=5.64564e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=38, gb_free=13.3, wall=233769
2024-11-12 03:41:21 - progress_bar.py[line:274] - INFO: epoch 090:    206 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17295.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3164, ups=0.18, wpb=17295.9, bsz=1024, num_updates=34960, lr=5.63204e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233824
2024-11-12 03:42:15 - progress_bar.py[line:274] - INFO: epoch 090:    216 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17088.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3154.9, ups=0.18, wpb=17088.3, bsz=1024, num_updates=34970, lr=5.61844e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=233878
2024-11-12 03:43:10 - progress_bar.py[line:274] - INFO: epoch 090:    226 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3114.8, ups=0.18, wpb=17090.1, bsz=1024, num_updates=34980, lr=5.60483e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=233933
2024-11-12 03:44:04 - progress_bar.py[line:274] - INFO: epoch 090:    236 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17194.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3175.4, ups=0.18, wpb=17194.4, bsz=1024, num_updates=34990, lr=5.59123e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=233987
2024-11-12 03:44:59 - progress_bar.py[line:274] - INFO: epoch 090:    246 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17294.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3144.1, ups=0.18, wpb=17294.2, bsz=1024, num_updates=35000, lr=5.57762e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=234042
loss_reg: 0.00419023204808933 loss_cls: 0.004113144241273403
loss_reg: 0.0050116649319151855 loss_cls: 0.00428679259493947
loss_reg: 0.003713323599672292 loss_cls: 0.0035489744041115046
loss_reg: 0.005375026116342897 loss_cls: 0.004881619475781918
loss_reg: 0.003993976089200471 loss_cls: 0.0031832095701247454
loss_reg: 0.003790201786298183 loss_cls: 0.003130907891318202
loss_reg: 0.003069572500540816 loss_cls: 0.003016125876456499
loss_reg: 0.003993515619485227 loss_cls: 0.004190284758806229
loss_reg: 0.0037765615855369647 loss_cls: 0.004396175965666771
loss_reg: 0.00590898289144279 loss_cls: 0.0031878638546913862
loss_reg: 0.004074594274203691 loss_cls: 0.0034268354065716267
loss_reg: 0.00619145660276292 loss_cls: 0.0034157424233853817
loss_reg: 0.0060584786873609355 loss_cls: 0.003472874639555812
loss_reg: 0.005402342290440903 loss_cls: 0.005596371367573738
loss_reg: 0.00421285460718325 loss_cls: 0.0030002552084624767
loss_reg: 0.006597469722659891 loss_cls: 0.0032454091124236584
loss_reg: 0.00499527900496028 loss_cls: 0.00264310697093606
loss_reg: 0.005810560408190693 loss_cls: 0.003493557684123516
loss_reg: 0.004965082259350821 loss_cls: 0.0038659386336803436
loss_reg: 0.005780694282163505 loss_cls: 0.0028982229996472597
loss_reg: 0.004499701447887009 loss_cls: 0.003012207103893161
loss_reg: 0.0038116520254766876 loss_cls: 0.003544141538441181
loss_reg: 0.0042178632514544324 loss_cls: 0.0034827871713787317
loss_reg: 0.005000806448425488 loss_cls: 0.0037413265090435743
loss_reg: 0.006189772202938176 loss_cls: 0.003867373103275895
loss_reg: 0.004766909034413243 loss_cls: 0.0034519401378929615
loss_reg: 0.004664264113718032 loss_cls: 0.0052246772684156895
loss_reg: 0.005875610545762037 loss_cls: 0.004452903755009174
loss_reg: 0.005366080678720516 loss_cls: 0.003960807807743549
loss_reg: 0.005751817906824447 loss_cls: 0.0033555724658071995
loss_reg: 0.005206144064828618 loss_cls: 0.0037617103662341833
loss_reg: 0.004766652441441586 loss_cls: 0.0032297975849360228
loss_reg: 0.004432864117803283 loss_cls: 0.0027627707459032536
loss_reg: 0.005632584172758166 loss_cls: 0.0032143581192940474
loss_reg: 0.004668427155111128 loss_cls: 0.003555609844624996
loss_reg: 0.004116172426167747 loss_cls: 0.0032356034498661757
loss_reg: 0.004365145884738265 loss_cls: 0.0035655696410685778
loss_reg: 0.0036590019620387168 loss_cls: 0.0028310329653322697
loss_reg: 0.0045159132628483185 loss_cls: 0.004117592703551054
loss_reg: 0.004951486033322519 loss_cls: 0.004091887269169092
loss_reg: 0.004167245717199348 loss_cls: 0.0037331997882574797
loss_reg: 0.005503628362000686 loss_cls: 0.0038093719631433487
loss_reg: 0.004754122867763498 loss_cls: 0.0038953316397964954
loss_reg: 0.0035222849791247592 loss_cls: 0.0046958825550973415
loss_reg: 0.005135860842710067 loss_cls: 0.003380746114999056
loss_reg: 0.0037640497164604836 loss_cls: 0.003777529811486602
loss_reg: 0.004118914165272159 loss_cls: 0.003963494207710028
loss_reg: 0.004489690905422901 loss_cls: 0.004113167058676481
loss_reg: 0.0038767457634325203 loss_cls: 0.004019841086119413
loss_reg: 0.0063420747875275775 loss_cls: 0.004019077867269516
loss_reg: 0.007903278101568554 loss_cls: 0.003304819343611598
loss_reg: 0.004160967100181548 loss_cls: 0.0036394719500094652
loss_reg: 0.006208623220989832 loss_cls: 0.0037255901843309402
loss_reg: 0.006286897888826647 loss_cls: 0.003684718394652009
loss_reg: 0.006145324613583585 loss_cls: 0.0044541428796947
loss_reg: 0.006048674050799397 loss_cls: 0.0038968687877058983
loss_reg: 0.005497372574790571 loss_cls: 0.0041204518638551235
loss_reg: 0.004323257322742337 loss_cls: 0.0032376281451433897
loss_reg: 0.006813534030126045 loss_cls: 0.0032302620820701122
loss_reg: 0.00453264644598719 loss_cls: 0.0038144849240779877
loss_reg: 0.00436926284417503 loss_cls: 0.003429163945838809
loss_reg: 0.004837862040421819 loss_cls: 0.0040240962989628315
loss_reg: 0.003737011863098 loss_cls: 0.003258724696934223
loss_reg: 0.004952945547103191 loss_cls: 0.0032571994233876467
2024-11-12 03:45:54 - progress_bar.py[line:274] - INFO: epoch 090:    256 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17238.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3146.5, ups=0.18, wpb=17238.2, bsz=1024, num_updates=35010, lr=5.56402e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=234097
2024-11-12 03:46:47 - progress_bar.py[line:274] - INFO: epoch 090:    266 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17302.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3215.4, ups=0.19, wpb=17302.1, bsz=1024, num_updates=35020, lr=5.55042e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=234150
2024-11-12 03:47:42 - progress_bar.py[line:274] - INFO: epoch 090:    276 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17103.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3152.9, ups=0.18, wpb=17103.7, bsz=1024, num_updates=35030, lr=5.53681e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=234205
2024-11-12 03:48:35 - progress_bar.py[line:274] - INFO: epoch 090:    286 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17288.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3224.9, ups=0.19, wpb=17288.1, bsz=1024, num_updates=35040, lr=5.52321e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=234258
2024-11-12 03:49:30 - progress_bar.py[line:274] - INFO: epoch 090:    296 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.615, ntokens=17520.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.13, wps=3221.9, ups=0.18, wpb=17520.8, bsz=1024, num_updates=35050, lr=5.5096e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=234313
2024-11-12 03:50:25 - progress_bar.py[line:274] - INFO: epoch 090:    306 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17121.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3095.8, ups=0.18, wpb=17121.3, bsz=1024, num_updates=35060, lr=5.496e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=234368
2024-11-12 03:51:20 - progress_bar.py[line:274] - INFO: epoch 090:    316 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=16953, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3103.2, ups=0.18, wpb=16953, bsz=1024, num_updates=35070, lr=5.4824e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=234423
2024-11-12 03:52:14 - progress_bar.py[line:274] - INFO: epoch 090:    326 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17094.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3159.7, ups=0.18, wpb=17094.6, bsz=1024, num_updates=35080, lr=5.46879e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=234477
2024-11-12 03:53:08 - progress_bar.py[line:274] - INFO: epoch 090:    336 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3192.7, ups=0.18, wpb=17333.1, bsz=1024, num_updates=35090, lr=5.45519e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=234531
2024-11-12 03:54:02 - progress_bar.py[line:274] - INFO: epoch 090:    346 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17218.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3168.2, ups=0.18, wpb=17218.3, bsz=1024, num_updates=35100, lr=5.44158e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=234585
2024-11-12 03:54:56 - progress_bar.py[line:274] - INFO: epoch 090:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17060.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3154.5, ups=0.18, wpb=17060.2, bsz=1024, num_updates=35110, lr=5.42798e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=234639
2024-11-12 03:55:54 - progress_bar.py[line:274] - INFO: epoch 090:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17442.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3041.2, ups=0.17, wpb=17442.7, bsz=1024, num_updates=35120, lr=5.41438e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=234697
2024-11-12 03:56:47 - progress_bar.py[line:274] - INFO: epoch 090:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17500.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3307.5, ups=0.19, wpb=17500.4, bsz=1024, num_updates=35130, lr=5.40077e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=234750
2024-11-12 03:57:39 - progress_bar.py[line:274] - INFO: epoch 090:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17122.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3247.1, ups=0.19, wpb=17122.6, bsz=1024, num_updates=35140, lr=5.38717e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=234802
2024-11-12 03:58:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 90 @ 35145 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt
2024-11-12 03:58:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 03:59:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
2024-11-12 04:01:46 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 90 @ 35145 updates, score 0) (writing took 223.5907385450555 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_90.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-12 04:02:41 - train.py[line:336] - INFO: end of epoch 90 (average epoch stats below)
2024-11-12 04:02:41 - progress_bar.py[line:282] - INFO: epoch 090 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.569 | ntokens 17198 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.93 | wps 2614.4 | ups 0.15 | wpb 17198 | bsz 1023 | num_updates 35145 | lr 5.38037e-06 | gnorm 0.002 | clip 0 | loss_scale 32768 | train_wall 1252 | gb_free 13.3 | wall 235104
2024-11-12 04:02:41 - trainer.py[line:639] - INFO: loading train data for epoch 91
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 04:05:24 - trainer.py[line:703] - INFO: begin training epoch 91
2024-11-12 04:05:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 04:05:53 - progress_bar.py[line:274] - INFO: epoch 091:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=16240.9, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=329.1, ups=0.02, wpb=16240.9, bsz=985.6, num_updates=35150, lr=5.37356e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=235296
2024-11-12 04:06:47 - progress_bar.py[line:274] - INFO: epoch 091:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17358.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3223.3, ups=0.19, wpb=17358.7, bsz=1024, num_updates=35160, lr=5.35996e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=235350
2024-11-12 04:07:40 - progress_bar.py[line:274] - INFO: epoch 091:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17472, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3254.5, ups=0.19, wpb=17472, bsz=1024, num_updates=35170, lr=5.34636e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=235403
2024-11-12 04:08:35 - progress_bar.py[line:274] - INFO: epoch 091:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17074.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3159.9, ups=0.19, wpb=17074.8, bsz=1024, num_updates=35180, lr=5.33275e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=235457
2024-11-12 04:09:29 - progress_bar.py[line:274] - INFO: epoch 091:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17150.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3132.9, ups=0.18, wpb=17150.8, bsz=1024, num_updates=35190, lr=5.31915e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=235512
2024-11-12 04:10:24 - progress_bar.py[line:274] - INFO: epoch 091:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17112.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3132.6, ups=0.18, wpb=17112.1, bsz=1024, num_updates=35200, lr=5.30554e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=235567
2024-11-12 04:11:18 - progress_bar.py[line:274] - INFO: epoch 091:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17281.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3184.3, ups=0.18, wpb=17281.1, bsz=1024, num_updates=35210, lr=5.29194e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=235621
2024-11-12 04:12:12 - progress_bar.py[line:274] - INFO: epoch 091:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17293.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3218.6, ups=0.19, wpb=17293.4, bsz=1024, num_updates=35220, lr=5.27834e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=235675
2024-11-12 04:13:06 - progress_bar.py[line:274] - INFO: epoch 091:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17325.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3191.4, ups=0.18, wpb=17325.4, bsz=1024, num_updates=35230, lr=5.26473e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=235729
2024-11-12 04:14:00 - progress_bar.py[line:274] - INFO: epoch 091:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17254.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3218.8, ups=0.19, wpb=17254.5, bsz=1024, num_updates=35240, lr=5.25113e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=235783
2024-11-12 04:14:54 - progress_bar.py[line:274] - INFO: epoch 091:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17298, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3191, ups=0.18, wpb=17298, bsz=1024, num_updates=35250, lr=5.23753e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=235837
2024-11-12 04:15:49 - progress_bar.py[line:274] - INFO: epoch 091:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17321.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3160.8, ups=0.18, wpb=17321.7, bsz=1024, num_updates=35260, lr=5.22392e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=235892
2024-11-12 04:16:43 - progress_bar.py[line:274] - INFO: epoch 091:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.611, ntokens=17474.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.11, wps=3234.1, ups=0.19, wpb=17474.6, bsz=1024, num_updates=35270, lr=5.21032e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=235946
2024-11-12 04:17:39 - progress_bar.py[line:274] - INFO: epoch 091:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17233.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3086.3, ups=0.18, wpb=17233.7, bsz=1024, num_updates=35280, lr=5.19671e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.2, wall=236002
2024-11-12 04:18:33 - progress_bar.py[line:274] - INFO: epoch 091:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=16926.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3133.5, ups=0.19, wpb=16926.6, bsz=1024, num_updates=35290, lr=5.18311e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=236056
2024-11-12 04:19:27 - progress_bar.py[line:274] - INFO: epoch 091:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17170.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3166.1, ups=0.18, wpb=17170.7, bsz=1024, num_updates=35300, lr=5.16951e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=236110
2024-11-12 04:20:22 - progress_bar.py[line:274] - INFO: epoch 091:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17285.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3156, ups=0.18, wpb=17285.9, bsz=1024, num_updates=35310, lr=5.1559e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=236165
2024-11-12 04:21:16 - progress_bar.py[line:274] - INFO: epoch 091:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17359.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3196.6, ups=0.18, wpb=17359.6, bsz=1024, num_updates=35320, lr=5.1423e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=236219
2024-11-12 04:22:11 - progress_bar.py[line:274] - INFO: epoch 091:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17180.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3125.1, ups=0.18, wpb=17180.2, bsz=1024, num_updates=35330, lr=5.12869e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=236274
2024-11-12 04:23:09 - progress_bar.py[line:274] - INFO: epoch 091:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17111.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2926.4, ups=0.17, wpb=17111.1, bsz=1024, num_updates=35340, lr=5.11509e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=236332
2024-11-12 04:24:08 - progress_bar.py[line:274] - INFO: epoch 091:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.629, ntokens=17536.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.18, wps=3019, ups=0.17, wpb=17536.2, bsz=1024, num_updates=35350, lr=5.10149e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=236390
2024-11-12 04:25:05 - progress_bar.py[line:274] - INFO: epoch 091:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17189.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2971.6, ups=0.17, wpb=17189.5, bsz=1024, num_updates=35360, lr=5.08788e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=42, gb_free=13.2, wall=236448
2024-11-12 04:26:02 - progress_bar.py[line:274] - INFO: epoch 091:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17459.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3065.1, ups=0.18, wpb=17459.1, bsz=1024, num_updates=35370, lr=5.07428e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=236505
2024-11-12 04:27:01 - progress_bar.py[line:274] - INFO: epoch 091:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17290.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=2960.6, ups=0.17, wpb=17290.5, bsz=1024, num_updates=35380, lr=5.06067e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=236564
2024-11-12 04:27:59 - progress_bar.py[line:274] - INFO: epoch 091:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17062.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=2922.6, ups=0.17, wpb=17062.8, bsz=1024, num_updates=35390, lr=5.04707e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=46, gb_free=13.2, wall=236622
2024-11-12 04:28:57 - progress_bar.py[line:274] - INFO: epoch 091:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17254.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2975.5, ups=0.17, wpb=17254.6, bsz=1024, num_updates=35400, lr=5.03347e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=55, gb_free=13.5, wall=236680
2024-11-12 04:29:54 - progress_bar.py[line:274] - INFO: epoch 091:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17207, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3011.1, ups=0.17, wpb=17207, bsz=1024, num_updates=35410, lr=5.01986e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=44, gb_free=13.3, wall=236737
2024-11-12 04:30:52 - progress_bar.py[line:274] - INFO: epoch 091:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=16998.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=2966.7, ups=0.17, wpb=16998.5, bsz=1024, num_updates=35420, lr=5.00626e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=42, gb_free=13.3, wall=236794
2024-11-12 04:31:58 - progress_bar.py[line:274] - INFO: epoch 091:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=16869.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=2529.9, ups=0.15, wpb=16869.9, bsz=1024, num_updates=35430, lr=4.99265e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=65, gb_free=13.2, wall=236861
2024-11-12 04:33:04 - progress_bar.py[line:274] - INFO: epoch 091:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17139.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2600.3, ups=0.15, wpb=17139.2, bsz=1024, num_updates=35440, lr=4.97905e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=66, gb_free=13.3, wall=236927
2024-11-12 04:34:00 - progress_bar.py[line:274] - INFO: epoch 091:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17401.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3102.9, ups=0.18, wpb=17401.7, bsz=1024, num_updates=35450, lr=4.96545e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=46, gb_free=13.2, wall=236983
2024-11-12 04:34:55 - progress_bar.py[line:274] - INFO: epoch 091:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17196.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3129.3, ups=0.18, wpb=17196.3, bsz=1024, num_updates=35460, lr=4.95184e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=34, gb_free=13.3, wall=237038
2024-11-12 04:35:49 - progress_bar.py[line:274] - INFO: epoch 091:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.503, ntokens=16809.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.67, wps=3109, ups=0.18, wpb=16809.7, bsz=1024, num_updates=35470, lr=4.93824e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=237092
2024-11-12 04:36:43 - progress_bar.py[line:274] - INFO: epoch 091:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17222, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3197.6, ups=0.19, wpb=17222, bsz=1024, num_updates=35480, lr=4.92463e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=237146
2024-11-12 04:37:38 - progress_bar.py[line:274] - INFO: epoch 091:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17160.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3112.1, ups=0.18, wpb=17160.5, bsz=1024, num_updates=35490, lr=4.91103e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=237201
2024-11-12 04:38:35 - progress_bar.py[line:274] - INFO: epoch 091:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17234, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3038.1, ups=0.18, wpb=17234, bsz=1024, num_updates=35500, lr=4.89743e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=41, gb_free=13.3, wall=237258
2024-11-12 04:39:32 - progress_bar.py[line:274] - INFO: epoch 091:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17461.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3054.3, ups=0.17, wpb=17461.2, bsz=1024, num_updates=35510, lr=4.88382e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=46, gb_free=13.1, wall=237315
2024-11-12 04:40:30 - progress_bar.py[line:274] - INFO: epoch 091:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17284, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2981.2, ups=0.17, wpb=17284, bsz=1024, num_updates=35520, lr=4.87022e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13, wall=237373
2024-11-12 04:41:29 - progress_bar.py[line:274] - INFO: epoch 091:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17046.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=2903.7, ups=0.17, wpb=17046.5, bsz=1024, num_updates=35530, lr=4.85661e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=59, gb_free=13.2, wall=237432
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
2024-11-12 04:42:00 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 91 @ 35536 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
2024-11-12 04:42:00 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 04:43:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 04:45:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 91 @ 35536 updates, score 0) (writing took 225.1360233440064 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_91.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-12 04:46:40 - train.py[line:336] - INFO: end of epoch 91 (average epoch stats below)
2024-11-12 04:46:40 - progress_bar.py[line:282] - INFO: epoch 091 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.566 | ntokens 17202.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.92 | wps 2548.5 | ups 0.15 | wpb 17202.1 | bsz 1023 | num_updates 35536 | lr 4.84845e-06 | gnorm 0.003 | clip 0 | loss_scale 65536 | train_wall 1495 | gb_free 13.1 | wall 237743
2024-11-12 04:46:40 - trainer.py[line:639] - INFO: loading train data for epoch 92
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 04:49:21 - trainer.py[line:703] - INFO: begin training epoch 92
2024-11-12 04:49:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 04:49:45 - progress_bar.py[line:274] - INFO: epoch 092:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=16637.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=335.4, ups=0.02, wpb=16637.5, bsz=985.6, num_updates=35540, lr=4.84301e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=44, gb_free=13.4, wall=237928
2024-11-12 04:50:01 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-12 04:50:44 - progress_bar.py[line:274] - INFO: epoch 092:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2907.2, ups=0.17, wpb=17268.7, bsz=1024, num_updates=35550, lr=4.82941e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=34, gb_free=13.6, wall=237987
2024-11-12 04:51:38 - progress_bar.py[line:274] - INFO: epoch 092:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17164.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3184.1, ups=0.19, wpb=17164.3, bsz=1024, num_updates=35560, lr=4.8158e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=238041
2024-11-12 04:52:32 - progress_bar.py[line:274] - INFO: epoch 092:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17063.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3144.9, ups=0.18, wpb=17063.7, bsz=1024, num_updates=35570, lr=4.8022e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=238095
2024-11-12 04:53:27 - progress_bar.py[line:274] - INFO: epoch 092:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17049.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3153.2, ups=0.18, wpb=17049.7, bsz=1024, num_updates=35580, lr=4.78859e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=238149
2024-11-12 04:54:20 - progress_bar.py[line:274] - INFO: epoch 092:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17212.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3234.6, ups=0.19, wpb=17212.4, bsz=1024, num_updates=35590, lr=4.77499e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=238203
2024-11-12 04:55:14 - progress_bar.py[line:274] - INFO: epoch 092:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=16950.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3130.2, ups=0.18, wpb=16950.8, bsz=1024, num_updates=35600, lr=4.76139e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=238257
2024-11-12 04:56:07 - progress_bar.py[line:274] - INFO: epoch 092:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17197.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3207.2, ups=0.19, wpb=17197.8, bsz=1024, num_updates=35610, lr=4.74778e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=12.9, wall=238310
2024-11-12 04:57:01 - progress_bar.py[line:274] - INFO: epoch 092:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17385.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3242, ups=0.19, wpb=17385.5, bsz=1024, num_updates=35620, lr=4.73418e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=238364
2024-11-12 04:57:55 - progress_bar.py[line:274] - INFO: epoch 092:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17249.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3200.6, ups=0.19, wpb=17249.6, bsz=1024, num_updates=35630, lr=4.72057e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=238418
2024-11-12 04:58:49 - progress_bar.py[line:274] - INFO: epoch 092:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3211.9, ups=0.19, wpb=17274.5, bsz=1024, num_updates=35640, lr=4.70697e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=238472
2024-11-12 04:59:42 - progress_bar.py[line:274] - INFO: epoch 092:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17004.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3167.5, ups=0.19, wpb=17004.7, bsz=1024, num_updates=35650, lr=4.69337e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=238525
2024-11-12 05:00:36 - progress_bar.py[line:274] - INFO: epoch 092:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17354.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3252.9, ups=0.19, wpb=17354.3, bsz=1024, num_updates=35660, lr=4.67976e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=238579
2024-11-12 05:01:29 - progress_bar.py[line:274] - INFO: epoch 092:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17258.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3234.5, ups=0.19, wpb=17258.7, bsz=1024, num_updates=35670, lr=4.66616e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=238632
2024-11-12 05:02:23 - progress_bar.py[line:274] - INFO: epoch 092:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17182.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3214.4, ups=0.19, wpb=17182.1, bsz=1024, num_updates=35680, lr=4.65255e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=238686
2024-11-12 05:03:16 - progress_bar.py[line:274] - INFO: epoch 092:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17136.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3209.9, ups=0.19, wpb=17136.6, bsz=1024, num_updates=35690, lr=4.63895e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=238739
2024-11-12 05:04:09 - progress_bar.py[line:274] - INFO: epoch 092:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.598, ntokens=17420.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3276.4, ups=0.19, wpb=17420.2, bsz=1024, num_updates=35700, lr=4.62535e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=238792
2024-11-12 05:05:02 - progress_bar.py[line:274] - INFO: epoch 092:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17095.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3222.9, ups=0.19, wpb=17095.7, bsz=1024, num_updates=35710, lr=4.61174e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=238845
2024-11-12 05:05:56 - progress_bar.py[line:274] - INFO: epoch 092:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17129.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3213.4, ups=0.19, wpb=17129.1, bsz=1024, num_updates=35720, lr=4.59814e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=12.8, wall=238898
2024-11-12 05:06:50 - progress_bar.py[line:274] - INFO: epoch 092:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17057.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3155.6, ups=0.18, wpb=17057.9, bsz=1024, num_updates=35730, lr=4.58454e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=238953
2024-11-12 05:07:43 - progress_bar.py[line:274] - INFO: epoch 092:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17248.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3211.2, ups=0.19, wpb=17248.4, bsz=1024, num_updates=35740, lr=4.57093e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=239006
2024-11-12 05:08:38 - progress_bar.py[line:274] - INFO: epoch 092:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17064.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3120.7, ups=0.18, wpb=17064.9, bsz=1024, num_updates=35750, lr=4.55733e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=239061
2024-11-12 05:09:36 - progress_bar.py[line:274] - INFO: epoch 092:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17098.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=2954.7, ups=0.17, wpb=17098.2, bsz=1024, num_updates=35760, lr=4.54372e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=239119
2024-11-12 05:10:35 - progress_bar.py[line:274] - INFO: epoch 092:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.595, ntokens=17320.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=2940.5, ups=0.17, wpb=17320.7, bsz=1024, num_updates=35770, lr=4.53012e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=239178
2024-11-12 05:11:30 - progress_bar.py[line:274] - INFO: epoch 092:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17255.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3134.8, ups=0.18, wpb=17255.2, bsz=1024, num_updates=35780, lr=4.51652e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239233
2024-11-12 05:12:24 - progress_bar.py[line:274] - INFO: epoch 092:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17132, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3184, ups=0.19, wpb=17132, bsz=1024, num_updates=35790, lr=4.50291e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=239287
2024-11-12 05:13:18 - progress_bar.py[line:274] - INFO: epoch 092:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17321, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3182.2, ups=0.18, wpb=17321, bsz=1024, num_updates=35800, lr=4.48931e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239341
2024-11-12 05:14:13 - progress_bar.py[line:274] - INFO: epoch 092:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=17337, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3151.3, ups=0.18, wpb=17337, bsz=1024, num_updates=35810, lr=4.4757e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=35, gb_free=13.3, wall=239396
2024-11-12 05:15:07 - progress_bar.py[line:274] - INFO: epoch 092:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17317.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3195.7, ups=0.18, wpb=17317.3, bsz=1024, num_updates=35820, lr=4.4621e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=52, gb_free=13.4, wall=239450
2024-11-12 05:15:59 - progress_bar.py[line:274] - INFO: epoch 092:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17076.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3323.4, ups=0.19, wpb=17076.6, bsz=1024, num_updates=35830, lr=4.4485e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=44, gb_free=13.4, wall=239502
2024-11-12 05:16:52 - progress_bar.py[line:274] - INFO: epoch 092:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17249.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3244.3, ups=0.19, wpb=17249.7, bsz=1024, num_updates=35840, lr=4.43489e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239555
2024-11-12 05:17:45 - progress_bar.py[line:274] - INFO: epoch 092:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=16774.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.71, wps=3144.9, ups=0.19, wpb=16774.9, bsz=1024, num_updates=35850, lr=4.42129e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239608
2024-11-12 05:18:39 - progress_bar.py[line:274] - INFO: epoch 092:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17268, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3210.7, ups=0.19, wpb=17268, bsz=1024, num_updates=35860, lr=4.40768e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239662
2024-11-12 05:19:33 - progress_bar.py[line:274] - INFO: epoch 092:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3207.6, ups=0.18, wpb=17370.2, bsz=1024, num_updates=35870, lr=4.39408e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=239716
2024-11-12 05:20:27 - progress_bar.py[line:274] - INFO: epoch 092:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17095.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3189.6, ups=0.19, wpb=17095.1, bsz=1024, num_updates=35880, lr=4.38048e-06, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=239770
2024-11-12 05:20:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16384.0
2024-11-12 05:21:26 - progress_bar.py[line:274] - INFO: epoch 092:    356 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17346.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2934, ups=0.17, wpb=17346.9, bsz=1024, num_updates=35890, lr=4.36687e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=33, gb_free=13.3, wall=239829
2024-11-12 05:22:20 - progress_bar.py[line:274] - INFO: epoch 092:    366 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17343.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3203.1, ups=0.18, wpb=17343.5, bsz=1024, num_updates=35900, lr=4.35327e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=239883
2024-11-12 05:23:12 - progress_bar.py[line:274] - INFO: epoch 092:    376 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17340.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3326.1, ups=0.19, wpb=17340.5, bsz=1024, num_updates=35910, lr=4.33966e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=239935
2024-11-12 05:24:04 - progress_bar.py[line:274] - INFO: epoch 092:    386 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17283.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3342, ups=0.19, wpb=17283.3, bsz=1024, num_updates=35920, lr=4.32606e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=239987
2024-11-12 05:24:26 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 92 @ 35925 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
2024-11-12 05:24:26 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 05:26:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-12 05:28:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 92 @ 35925 updates, score 0) (writing took 219.9117687260732 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_92.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000

slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
2024-11-12 05:29:01 - train.py[line:336] - INFO: end of epoch 92 (average epoch stats below)
2024-11-12 05:29:01 - progress_bar.py[line:282] - INFO: epoch 092 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.564 | ntokens 17183.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.92 | wps 2630.7 | ups 0.15 | wpb 17183.4 | bsz 1023 | num_updates 35925 | lr 4.31926e-06 | gnorm 0.003 | clip 0 | loss_scale 16384 | train_wall 1228 | gb_free 13.4 | wall 240284
2024-11-12 05:29:01 - trainer.py[line:639] - INFO: loading train data for epoch 93
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 05:31:43 - trainer.py[line:703] - INFO: begin training epoch 93
2024-11-12 05:31:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 05:32:12 - progress_bar.py[line:274] - INFO: epoch 093:      5 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=16224.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=332.4, ups=0.02, wpb=16224.3, bsz=985.6, num_updates=35930, lr=4.31246e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=29, gb_free=13.1, wall=240475
2024-11-12 05:33:06 - progress_bar.py[line:274] - INFO: epoch 093:     15 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17222.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3168.1, ups=0.18, wpb=17222.6, bsz=1024, num_updates=35940, lr=4.29885e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=240529
2024-11-12 05:34:00 - progress_bar.py[line:274] - INFO: epoch 093:     25 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17511.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3238.8, ups=0.18, wpb=17511.9, bsz=1024, num_updates=35950, lr=4.28525e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=240583
2024-11-12 05:34:54 - progress_bar.py[line:274] - INFO: epoch 093:     35 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17172.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3176.8, ups=0.18, wpb=17172.9, bsz=1024, num_updates=35960, lr=4.27164e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=240637
2024-11-12 05:35:48 - progress_bar.py[line:274] - INFO: epoch 093:     45 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17071.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3209.4, ups=0.19, wpb=17071.9, bsz=1024, num_updates=35970, lr=4.25804e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=240691
2024-11-12 05:36:41 - progress_bar.py[line:274] - INFO: epoch 093:     55 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17229.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3231, ups=0.19, wpb=17229.6, bsz=1024, num_updates=35980, lr=4.24444e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=240744
2024-11-12 05:37:34 - progress_bar.py[line:274] - INFO: epoch 093:     65 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17038.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3211.3, ups=0.19, wpb=17038.1, bsz=1024, num_updates=35990, lr=4.23083e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=240797
2024-11-12 05:38:27 - progress_bar.py[line:274] - INFO: epoch 093:     75 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=17074.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3201.1, ups=0.19, wpb=17074.7, bsz=1024, num_updates=36000, lr=4.21723e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=240850
2024-11-12 05:39:21 - progress_bar.py[line:274] - INFO: epoch 093:     85 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17271.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3243.2, ups=0.19, wpb=17271.5, bsz=1024, num_updates=36010, lr=4.20362e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=240904
2024-11-12 05:40:15 - progress_bar.py[line:274] - INFO: epoch 093:     95 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17188.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3188.8, ups=0.19, wpb=17188.3, bsz=1024, num_updates=36020, lr=4.19002e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=240957
2024-11-12 05:41:09 - progress_bar.py[line:274] - INFO: epoch 093:    105 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17121.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3123.3, ups=0.18, wpb=17121.2, bsz=1024, num_updates=36030, lr=4.17642e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=241012
2024-11-12 05:42:03 - progress_bar.py[line:274] - INFO: epoch 093:    115 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17162.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3184.4, ups=0.19, wpb=17162.6, bsz=1024, num_updates=36040, lr=4.16281e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=241066
2024-11-12 05:42:57 - progress_bar.py[line:274] - INFO: epoch 093:    125 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17243.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3220.4, ups=0.19, wpb=17243.9, bsz=1024, num_updates=36050, lr=4.14921e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=241120
2024-11-12 05:43:50 - progress_bar.py[line:274] - INFO: epoch 093:    135 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17126.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3204.6, ups=0.19, wpb=17126.5, bsz=1024, num_updates=36060, lr=4.1356e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=241173
2024-11-12 05:44:44 - progress_bar.py[line:274] - INFO: epoch 093:    145 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17042.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3168.8, ups=0.19, wpb=17042.2, bsz=1024, num_updates=36070, lr=4.122e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=241227
2024-11-12 05:45:38 - progress_bar.py[line:274] - INFO: epoch 093:    155 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17153.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3161.6, ups=0.18, wpb=17153.9, bsz=1024, num_updates=36080, lr=4.1084e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=32, gb_free=13.3, wall=241281
2024-11-12 05:46:32 - progress_bar.py[line:274] - INFO: epoch 093:    165 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16946.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3178, ups=0.19, wpb=16946.3, bsz=1024, num_updates=36090, lr=4.09479e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=42, gb_free=13.5, wall=241334
2024-11-12 05:47:26 - progress_bar.py[line:274] - INFO: epoch 093:    175 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=16927.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3132.9, ups=0.19, wpb=16927.8, bsz=1024, num_updates=36100, lr=4.08119e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=32, gb_free=13.4, wall=241389
2024-11-12 05:48:19 - progress_bar.py[line:274] - INFO: epoch 093:    185 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17220.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3235.3, ups=0.19, wpb=17220.8, bsz=1024, num_updates=36110, lr=4.06758e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=33, gb_free=12.9, wall=241442
2024-11-12 05:49:13 - progress_bar.py[line:274] - INFO: epoch 093:    195 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17036, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3173.1, ups=0.19, wpb=17036, bsz=1024, num_updates=36120, lr=4.05398e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=241495
2024-11-12 05:50:06 - progress_bar.py[line:274] - INFO: epoch 093:    205 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17113.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3194.1, ups=0.19, wpb=17113.1, bsz=1024, num_updates=36130, lr=4.04038e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=241549
2024-11-12 05:50:59 - progress_bar.py[line:274] - INFO: epoch 093:    215 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17037, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3222.9, ups=0.19, wpb=17037, bsz=1024, num_updates=36140, lr=4.02677e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=241602
2024-11-12 05:51:52 - progress_bar.py[line:274] - INFO: epoch 093:    225 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17139.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3208.9, ups=0.19, wpb=17139.4, bsz=1024, num_updates=36150, lr=4.01317e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=241655
2024-11-12 05:52:46 - progress_bar.py[line:274] - INFO: epoch 093:    235 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3190.1, ups=0.19, wpb=17239.6, bsz=1024, num_updates=36160, lr=3.99956e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=241709
2024-11-12 05:53:40 - progress_bar.py[line:274] - INFO: epoch 093:    245 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17143.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3189.6, ups=0.19, wpb=17143.6, bsz=1024, num_updates=36170, lr=3.98596e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=241763
2024-11-12 05:54:34 - progress_bar.py[line:274] - INFO: epoch 093:    255 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17255.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3210.2, ups=0.19, wpb=17255.2, bsz=1024, num_updates=36180, lr=3.97236e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=241817
2024-11-12 05:55:28 - progress_bar.py[line:274] - INFO: epoch 093:    265 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17008.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3150.9, ups=0.19, wpb=17008.4, bsz=1024, num_updates=36190, lr=3.95875e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=241871
2024-11-12 05:56:22 - progress_bar.py[line:274] - INFO: epoch 093:    275 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17185.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3189.9, ups=0.19, wpb=17185.2, bsz=1024, num_updates=36200, lr=3.94515e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.4, wall=241925
2024-11-12 05:57:16 - progress_bar.py[line:274] - INFO: epoch 093:    285 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17226.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3168.7, ups=0.18, wpb=17226.6, bsz=1024, num_updates=36210, lr=3.93154e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=241979
2024-11-12 05:58:10 - progress_bar.py[line:274] - INFO: epoch 093:    295 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17272.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3194.1, ups=0.18, wpb=17272.6, bsz=1024, num_updates=36220, lr=3.91794e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=242033
2024-11-12 05:59:04 - progress_bar.py[line:274] - INFO: epoch 093:    305 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17214.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3175.6, ups=0.18, wpb=17214.7, bsz=1024, num_updates=36230, lr=3.90434e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=242087
2024-11-12 05:59:58 - progress_bar.py[line:274] - INFO: epoch 093:    315 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=16996.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3153, ups=0.19, wpb=16996.2, bsz=1024, num_updates=36240, lr=3.89073e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=242141
2024-11-12 06:00:53 - progress_bar.py[line:274] - INFO: epoch 093:    325 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17050.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3132.9, ups=0.18, wpb=17050.4, bsz=1024, num_updates=36250, lr=3.87713e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=242196
2024-11-12 06:01:47 - progress_bar.py[line:274] - INFO: epoch 093:    335 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17170.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3184.8, ups=0.19, wpb=17170.7, bsz=1024, num_updates=36260, lr=3.86353e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=242250
2024-11-12 06:02:40 - progress_bar.py[line:274] - INFO: epoch 093:    345 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.515, ntokens=16922.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3173.9, ups=0.19, wpb=16922.9, bsz=1024, num_updates=36270, lr=3.84992e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=242303
2024-11-12 06:03:34 - progress_bar.py[line:274] - INFO: epoch 093:    355 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.597, ntokens=17452.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.05, wps=3230.1, ups=0.19, wpb=17452.9, bsz=1024, num_updates=36280, lr=3.83632e-06, gnorm=0.003, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=242357
2024-11-12 06:04:27 - progress_bar.py[line:274] - INFO: epoch 093:    365 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17565.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3306.2, ups=0.19, wpb=17565.9, bsz=1024, num_updates=36290, lr=3.82271e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.1, wall=242410
2024-11-12 06:05:19 - progress_bar.py[line:274] - INFO: epoch 093:    375 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17263, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3302, ups=0.19, wpb=17263, bsz=1024, num_updates=36300, lr=3.80911e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=242462
2024-11-12 06:06:11 - progress_bar.py[line:274] - INFO: epoch 093:    385 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.606, ntokens=17432.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=3391.5, ups=0.19, wpb=17432.2, bsz=1024, num_updates=36310, lr=3.79551e-06, gnorm=0.001, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=242514
2024-11-12 06:06:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 93 @ 36316 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
2024-11-12 06:06:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt': File exists: File exists
: File exists: File exists


local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 06:08:25 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
2024-11-12 06:10:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 93 @ 36316 updates, score 0) (writing took 218.96391001401935 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_93.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-12 06:11:12 - train.py[line:336] - INFO: end of epoch 93 (average epoch stats below)
2024-11-12 06:11:12 - progress_bar.py[line:282] - INFO: epoch 093 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.558 | ntokens 17144.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.89 | wps 2648.3 | ups 0.15 | wpb 17144.9 | bsz 1023 | num_updates 36316 | lr 3.78734e-06 | gnorm 0.002 | clip 0 | loss_scale 16384 | train_wall 1205 | gb_free 13.1 | wall 242815
2024-11-12 06:11:12 - trainer.py[line:639] - INFO: loading train data for epoch 94
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 06:13:53 - trainer.py[line:703] - INFO: begin training epoch 94
2024-11-12 06:13:53 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 06:14:17 - progress_bar.py[line:274] - INFO: epoch 094:      4 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=16439, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=338.2, ups=0.02, wpb=16439, bsz=985.6, num_updates=36320, lr=3.7819e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=29, gb_free=13.4, wall=243000
2024-11-12 06:15:12 - progress_bar.py[line:274] - INFO: epoch 094:     14 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17198.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3115, ups=0.18, wpb=17198.6, bsz=1024, num_updates=36330, lr=3.7683e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=243055
2024-11-12 06:16:06 - progress_bar.py[line:274] - INFO: epoch 094:     24 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17284, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3209.9, ups=0.19, wpb=17284, bsz=1024, num_updates=36340, lr=3.75469e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=243109
2024-11-12 06:16:59 - progress_bar.py[line:274] - INFO: epoch 094:     34 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17060.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3190.6, ups=0.19, wpb=17060.1, bsz=1024, num_updates=36350, lr=3.74109e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=243162
2024-11-12 06:17:54 - progress_bar.py[line:274] - INFO: epoch 094:     44 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16905.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3119.9, ups=0.18, wpb=16905.7, bsz=1024, num_updates=36360, lr=3.72749e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=243217
2024-11-12 06:18:47 - progress_bar.py[line:274] - INFO: epoch 094:     54 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17232.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3213.8, ups=0.19, wpb=17232.3, bsz=1024, num_updates=36370, lr=3.71388e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=37, gb_free=13.2, wall=243270
2024-11-12 06:19:41 - progress_bar.py[line:274] - INFO: epoch 094:     64 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17108.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3202.3, ups=0.19, wpb=17108.4, bsz=1024, num_updates=36380, lr=3.70028e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=243324
2024-11-12 06:20:34 - progress_bar.py[line:274] - INFO: epoch 094:     74 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17136.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3201, ups=0.19, wpb=17136.9, bsz=1024, num_updates=36390, lr=3.68667e-06, gnorm=0.002, clip=0, loss_scale=16384, train_wall=30, gb_free=13, wall=243377
2024-11-12 06:21:28 - progress_bar.py[line:274] - INFO: epoch 094:     84 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17263.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3218.5, ups=0.19, wpb=17263.7, bsz=1024, num_updates=36400, lr=3.67307e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=243431
2024-11-12 06:22:21 - progress_bar.py[line:274] - INFO: epoch 094:     94 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=16959.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3187.5, ups=0.19, wpb=16959.8, bsz=1024, num_updates=36410, lr=3.65947e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=243484
2024-11-12 06:23:16 - progress_bar.py[line:274] - INFO: epoch 094:    104 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17154, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3150.2, ups=0.18, wpb=17154, bsz=1024, num_updates=36420, lr=3.64586e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=243538
2024-11-12 06:24:10 - progress_bar.py[line:274] - INFO: epoch 094:    114 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=16928.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3119.8, ups=0.18, wpb=16928.2, bsz=1024, num_updates=36430, lr=3.63226e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=243593
2024-11-12 06:25:04 - progress_bar.py[line:274] - INFO: epoch 094:    124 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17071.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3174.6, ups=0.19, wpb=17071.1, bsz=1024, num_updates=36440, lr=3.61865e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=243647
2024-11-12 06:25:57 - progress_bar.py[line:274] - INFO: epoch 094:    134 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17088, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3187.3, ups=0.19, wpb=17088, bsz=1024, num_updates=36450, lr=3.60505e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=243700
2024-11-12 06:26:51 - progress_bar.py[line:274] - INFO: epoch 094:    144 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=16951.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3132.4, ups=0.18, wpb=16951.1, bsz=1024, num_updates=36460, lr=3.59145e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=243754
2024-11-12 06:27:45 - progress_bar.py[line:274] - INFO: epoch 094:    154 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.585, ntokens=17414.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3237.8, ups=0.19, wpb=17414.5, bsz=1024, num_updates=36470, lr=3.57784e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=243808
2024-11-12 06:28:40 - progress_bar.py[line:274] - INFO: epoch 094:    164 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17167.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3156.5, ups=0.18, wpb=17167.9, bsz=1024, num_updates=36480, lr=3.56424e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=243862
2024-11-12 06:29:35 - progress_bar.py[line:274] - INFO: epoch 094:    174 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17003.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3082.8, ups=0.18, wpb=17003.5, bsz=1024, num_updates=36490, lr=3.55063e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=243918
2024-11-12 06:30:30 - progress_bar.py[line:274] - INFO: epoch 094:    184 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17147.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3094.3, ups=0.18, wpb=17147.8, bsz=1024, num_updates=36500, lr=3.53703e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=243973
2024-11-12 06:31:24 - progress_bar.py[line:274] - INFO: epoch 094:    194 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17261.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3192.8, ups=0.18, wpb=17261.8, bsz=1024, num_updates=36510, lr=3.52343e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.1, wall=244027
2024-11-12 06:32:18 - progress_bar.py[line:274] - INFO: epoch 094:    204 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17199.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3172.7, ups=0.18, wpb=17199.9, bsz=1024, num_updates=36520, lr=3.50982e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=244081
2024-11-12 06:33:13 - progress_bar.py[line:274] - INFO: epoch 094:    214 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17199.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3137.6, ups=0.18, wpb=17199.7, bsz=1024, num_updates=36530, lr=3.49622e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=32, gb_free=13.4, wall=244136
2024-11-12 06:34:10 - progress_bar.py[line:274] - INFO: epoch 094:    224 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17220, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3036.6, ups=0.18, wpb=17220, bsz=1024, num_updates=36540, lr=3.48261e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=53, gb_free=13.5, wall=244193
2024-11-12 06:35:06 - progress_bar.py[line:274] - INFO: epoch 094:    234 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17196.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3040.6, ups=0.18, wpb=17196.3, bsz=1024, num_updates=36550, lr=3.46901e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=244249
2024-11-12 06:36:03 - progress_bar.py[line:274] - INFO: epoch 094:    244 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17050.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3006.5, ups=0.18, wpb=17050.5, bsz=1024, num_updates=36560, lr=3.45541e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=57, gb_free=13.3, wall=244306
2024-11-12 06:36:58 - progress_bar.py[line:274] - INFO: epoch 094:    254 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17220.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3160.5, ups=0.18, wpb=17220.3, bsz=1024, num_updates=36570, lr=3.4418e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=54, gb_free=13.3, wall=244361
2024-11-12 06:37:50 - progress_bar.py[line:274] - INFO: epoch 094:    264 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17325.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3332.3, ups=0.19, wpb=17325.3, bsz=1024, num_updates=36580, lr=3.4282e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=52, gb_free=12.9, wall=244413
2024-11-12 06:38:42 - progress_bar.py[line:274] - INFO: epoch 094:    274 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3273.1, ups=0.19, wpb=17165.4, bsz=1024, num_updates=36590, lr=3.41459e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=45, gb_free=13.4, wall=244465
2024-11-12 06:39:35 - progress_bar.py[line:274] - INFO: epoch 094:    284 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=16997.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3214.1, ups=0.19, wpb=16997.3, bsz=1024, num_updates=36600, lr=3.40099e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=36, gb_free=13.4, wall=244518
2024-11-12 06:40:30 - progress_bar.py[line:274] - INFO: epoch 094:    294 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=16985.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3113.8, ups=0.18, wpb=16985.5, bsz=1024, num_updates=36610, lr=3.38739e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=244572
2024-11-12 06:41:29 - progress_bar.py[line:274] - INFO: epoch 094:    304 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17403.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2904.8, ups=0.17, wpb=17403.5, bsz=1024, num_updates=36620, lr=3.37378e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=244632
2024-11-12 06:42:25 - progress_bar.py[line:274] - INFO: epoch 094:    314 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17060, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3079.4, ups=0.18, wpb=17060, bsz=1024, num_updates=36630, lr=3.36018e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=244688
2024-11-12 06:43:19 - progress_bar.py[line:274] - INFO: epoch 094:    324 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17191.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3163.3, ups=0.18, wpb=17191.8, bsz=1024, num_updates=36640, lr=3.34657e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=244742
2024-11-12 06:44:13 - progress_bar.py[line:274] - INFO: epoch 094:    334 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.536, ntokens=17088.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3156.6, ups=0.18, wpb=17088.3, bsz=1024, num_updates=36650, lr=3.33297e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=244796
2024-11-12 06:45:08 - progress_bar.py[line:274] - INFO: epoch 094:    344 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17038.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3138.9, ups=0.18, wpb=17038.1, bsz=1024, num_updates=36660, lr=3.31937e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=244850
2024-11-12 06:46:02 - progress_bar.py[line:274] - INFO: epoch 094:    354 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17299.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3207.3, ups=0.19, wpb=17299.8, bsz=1024, num_updates=36670, lr=3.30576e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=244904
2024-11-12 06:46:56 - progress_bar.py[line:274] - INFO: epoch 094:    364 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17249.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3194.7, ups=0.19, wpb=17249.9, bsz=1024, num_updates=36680, lr=3.29216e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=244958
2024-11-12 06:47:48 - progress_bar.py[line:274] - INFO: epoch 094:    374 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17342.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3287.1, ups=0.19, wpb=17342.8, bsz=1024, num_updates=36690, lr=3.27855e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=245011
2024-11-12 06:48:44 - progress_bar.py[line:274] - INFO: epoch 094:    384 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17231.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3084.5, ups=0.18, wpb=17231.6, bsz=1024, num_updates=36700, lr=3.26495e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=245067
2024-11-12 06:49:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 94 @ 36707 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt
2024-11-12 06:49:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 06:51:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000


slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-12 06:53:01 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 94 @ 36707 updates, score 0) (writing took 223.37444248597603 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_94.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
2024-11-12 06:53:55 - train.py[line:336] - INFO: end of epoch 94 (average epoch stats below)
2024-11-12 06:53:55 - progress_bar.py[line:282] - INFO: epoch 094 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.555 | ntokens 17138.1 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.88 | wps 2614.4 | ups 0.15 | wpb 17138.1 | bsz 1023 | num_updates 36707 | lr 3.25543e-06 | gnorm 0.002 | clip 0 | loss_scale 32768 | train_wall 1338 | gb_free 13.2 | wall 245378
2024-11-12 06:53:55 - trainer.py[line:639] - INFO: loading train data for epoch 95
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 06:56:36 - trainer.py[line:703] - INFO: begin training epoch 95
2024-11-12 06:56:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 06:56:54 - progress_bar.py[line:274] - INFO: epoch 095:      3 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=16651.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=339.7, ups=0.02, wpb=16651.7, bsz=985.6, num_updates=36710, lr=3.25135e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=29, gb_free=13.2, wall=245557
2024-11-12 06:57:49 - progress_bar.py[line:274] - INFO: epoch 095:     13 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17247.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3167.4, ups=0.18, wpb=17247.2, bsz=1024, num_updates=36720, lr=3.23774e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=245612
2024-11-12 06:58:43 - progress_bar.py[line:274] - INFO: epoch 095:     23 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3204.2, ups=0.18, wpb=17323.6, bsz=1024, num_updates=36730, lr=3.22414e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.1, wall=245666
2024-11-12 06:59:37 - progress_bar.py[line:274] - INFO: epoch 095:     33 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17317.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3176.5, ups=0.18, wpb=17317.5, bsz=1024, num_updates=36740, lr=3.21053e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=245720
2024-11-12 07:00:31 - progress_bar.py[line:274] - INFO: epoch 095:     43 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17033.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3192.7, ups=0.19, wpb=17033.8, bsz=1024, num_updates=36750, lr=3.19693e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=245774
2024-11-12 07:01:25 - progress_bar.py[line:274] - INFO: epoch 095:     53 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17029.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3118.3, ups=0.18, wpb=17029.5, bsz=1024, num_updates=36760, lr=3.18333e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=12.6, wall=245828
2024-11-12 07:02:20 - progress_bar.py[line:274] - INFO: epoch 095:     63 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17170.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3154.5, ups=0.18, wpb=17170.3, bsz=1024, num_updates=36770, lr=3.16972e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=245883
2024-11-12 07:03:14 - progress_bar.py[line:274] - INFO: epoch 095:     73 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17227.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3169.5, ups=0.18, wpb=17227.5, bsz=1024, num_updates=36780, lr=3.15612e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=245937
2024-11-12 07:04:08 - progress_bar.py[line:274] - INFO: epoch 095:     83 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17122.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3194.2, ups=0.19, wpb=17122.4, bsz=1024, num_updates=36790, lr=3.14252e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=245991
2024-11-12 07:05:02 - progress_bar.py[line:274] - INFO: epoch 095:     93 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17008.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3157.9, ups=0.19, wpb=17008.7, bsz=1024, num_updates=36800, lr=3.12891e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.3, wall=246044
2024-11-12 07:05:55 - progress_bar.py[line:274] - INFO: epoch 095:    103 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.589, ntokens=17454.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3244.3, ups=0.19, wpb=17454.2, bsz=1024, num_updates=36810, lr=3.11531e-06, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=246098
2024-11-12 07:06:49 - progress_bar.py[line:274] - INFO: epoch 095:    113 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17020.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3159, ups=0.19, wpb=17020.7, bsz=1024, num_updates=36820, lr=3.1017e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=246152
2024-11-12 07:07:42 - progress_bar.py[line:274] - INFO: epoch 095:    123 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17060.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3202.1, ups=0.19, wpb=17060.1, bsz=1024, num_updates=36830, lr=3.0881e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13, wall=246205
2024-11-12 07:08:39 - progress_bar.py[line:274] - INFO: epoch 095:    133 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17087.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3017, ups=0.18, wpb=17087.7, bsz=1024, num_updates=36840, lr=3.0745e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=246262
2024-11-12 07:09:35 - progress_bar.py[line:274] - INFO: epoch 095:    143 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17093.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3045.2, ups=0.18, wpb=17093.9, bsz=1024, num_updates=36850, lr=3.06089e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=246318
2024-11-12 07:10:28 - progress_bar.py[line:274] - INFO: epoch 095:    153 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17303.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3299, ups=0.19, wpb=17303.7, bsz=1024, num_updates=36860, lr=3.04729e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=246371
2024-11-12 07:11:19 - progress_bar.py[line:274] - INFO: epoch 095:    163 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17206.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3350.6, ups=0.19, wpb=17206.5, bsz=1024, num_updates=36870, lr=3.03368e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=45, gb_free=13.1, wall=246422
2024-11-12 07:12:13 - progress_bar.py[line:274] - INFO: epoch 095:    173 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17039.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3171.5, ups=0.19, wpb=17039.7, bsz=1024, num_updates=36880, lr=3.02008e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=246476
2024-11-12 07:13:07 - progress_bar.py[line:274] - INFO: epoch 095:    183 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17396.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3196.8, ups=0.18, wpb=17396.6, bsz=1024, num_updates=36890, lr=3.00648e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=246530
2024-11-12 07:14:00 - progress_bar.py[line:274] - INFO: epoch 095:    193 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17133.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3226.6, ups=0.19, wpb=17133.8, bsz=1024, num_updates=36900, lr=2.99287e-06, gnorm=0.002, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=246583
2024-11-12 07:14:53 - progress_bar.py[line:274] - INFO: epoch 095:    203 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17100.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3229.1, ups=0.19, wpb=17100.8, bsz=1024, num_updates=36910, lr=2.97927e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=246636
2024-11-12 07:15:46 - progress_bar.py[line:274] - INFO: epoch 095:    213 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17023.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3204.7, ups=0.19, wpb=17023.6, bsz=1024, num_updates=36920, lr=2.96566e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=246689
2024-11-12 07:16:40 - progress_bar.py[line:274] - INFO: epoch 095:    223 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17226.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3214, ups=0.19, wpb=17226.9, bsz=1024, num_updates=36930, lr=2.95206e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=246743
2024-11-12 07:17:35 - progress_bar.py[line:274] - INFO: epoch 095:    233 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17362.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3175.7, ups=0.18, wpb=17362.6, bsz=1024, num_updates=36940, lr=2.93846e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=246798
2024-11-12 07:18:28 - progress_bar.py[line:274] - INFO: epoch 095:    243 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17247.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3231.3, ups=0.19, wpb=17247.7, bsz=1024, num_updates=36950, lr=2.92485e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=246851
2024-11-12 07:19:22 - progress_bar.py[line:274] - INFO: epoch 095:    253 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17264.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3218.1, ups=0.19, wpb=17264.3, bsz=1024, num_updates=36960, lr=2.91125e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=246905
2024-11-12 07:20:16 - progress_bar.py[line:274] - INFO: epoch 095:    263 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17253.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3198.7, ups=0.19, wpb=17253.4, bsz=1024, num_updates=36970, lr=2.89764e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=246959
2024-11-12 07:21:09 - progress_bar.py[line:274] - INFO: epoch 095:    273 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17163.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3203.2, ups=0.19, wpb=17163.9, bsz=1024, num_updates=36980, lr=2.88404e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=35, gb_free=13.4, wall=247012
2024-11-12 07:22:03 - progress_bar.py[line:274] - INFO: epoch 095:    283 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17238, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3207.8, ups=0.19, wpb=17238, bsz=1024, num_updates=36990, lr=2.87044e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=12.8, wall=247066
2024-11-12 07:22:58 - progress_bar.py[line:274] - INFO: epoch 095:    293 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17343.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3165.3, ups=0.18, wpb=17343.4, bsz=1024, num_updates=37000, lr=2.85683e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=247121
2024-11-12 07:23:52 - progress_bar.py[line:274] - INFO: epoch 095:    303 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17131.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3175.1, ups=0.19, wpb=17131.2, bsz=1024, num_updates=37010, lr=2.84323e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=247175
2024-11-12 07:24:45 - progress_bar.py[line:274] - INFO: epoch 095:    313 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=16868.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3139.9, ups=0.19, wpb=16868.6, bsz=1024, num_updates=37020, lr=2.82962e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=247228
2024-11-12 07:25:39 - progress_bar.py[line:274] - INFO: epoch 095:    323 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17121.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3208.9, ups=0.19, wpb=17121.1, bsz=1024, num_updates=37030, lr=2.81602e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=247282
2024-11-12 07:26:32 - progress_bar.py[line:274] - INFO: epoch 095:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3220.3, ups=0.19, wpb=17277.5, bsz=1024, num_updates=37040, lr=2.80242e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=247335
2024-11-12 07:27:26 - progress_bar.py[line:274] - INFO: epoch 095:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17187.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3189.1, ups=0.19, wpb=17187.6, bsz=1024, num_updates=37050, lr=2.78881e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=247389
2024-11-12 07:28:20 - progress_bar.py[line:274] - INFO: epoch 095:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17343.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3239.5, ups=0.19, wpb=17343.9, bsz=1024, num_updates=37060, lr=2.77521e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=247443
2024-11-12 07:29:13 - progress_bar.py[line:274] - INFO: epoch 095:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17371.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3261.9, ups=0.19, wpb=17371.3, bsz=1024, num_updates=37070, lr=2.7616e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=247496
2024-11-12 07:30:06 - progress_bar.py[line:274] - INFO: epoch 095:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17429.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3289.6, ups=0.19, wpb=17429.1, bsz=1024, num_updates=37080, lr=2.748e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=247549
2024-11-12 07:30:59 - progress_bar.py[line:274] - INFO: epoch 095:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3253.9, ups=0.19, wpb=17323.6, bsz=1024, num_updates=37090, lr=2.7344e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=36, gb_free=13.3, wall=247602
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt2024-11-12 07:31:41 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 95 @ 37098 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt


cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt
2024-11-12 07:31:41 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 07:33:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
2024-11-12 07:35:24 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 95 @ 37098 updates, score 0) (writing took 223.01858186302707 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_95.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-12 07:36:18 - train.py[line:336] - INFO: end of epoch 95 (average epoch stats below)
2024-11-12 07:36:18 - progress_bar.py[line:282] - INFO: epoch 095 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.561 | ntokens 17185.5 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.9 | wps 2642.2 | ups 0.15 | wpb 17185.5 | bsz 1023 | num_updates 37098 | lr 2.72351e-06 | gnorm 0.002 | clip 0 | loss_scale 65536 | train_wall 1290 | gb_free 13.1 | wall 247921
2024-11-12 07:36:18 - trainer.py[line:639] - INFO: loading train data for epoch 96
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 07:39:00 - trainer.py[line:703] - INFO: begin training epoch 96
2024-11-12 07:39:00 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 07:39:13 - progress_bar.py[line:274] - INFO: epoch 096:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=16620.6, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=336.5, ups=0.02, wpb=16620.6, bsz=985.6, num_updates=37100, lr=2.72079e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=46, gb_free=13.3, wall=248096
2024-11-12 07:40:07 - progress_bar.py[line:274] - INFO: epoch 096:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17137, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3167.5, ups=0.18, wpb=17137, bsz=1024, num_updates=37110, lr=2.70719e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=248150
2024-11-12 07:41:01 - progress_bar.py[line:274] - INFO: epoch 096:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17165.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3200.8, ups=0.19, wpb=17165.8, bsz=1024, num_updates=37120, lr=2.69358e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=248204
2024-11-12 07:41:54 - progress_bar.py[line:274] - INFO: epoch 096:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17181, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3228.1, ups=0.19, wpb=17181, bsz=1024, num_updates=37130, lr=2.67998e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=248257
2024-11-12 07:42:48 - progress_bar.py[line:274] - INFO: epoch 096:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17010.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3186.3, ups=0.19, wpb=17010.8, bsz=1024, num_updates=37140, lr=2.66638e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=248311
2024-11-12 07:43:41 - progress_bar.py[line:274] - INFO: epoch 096:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17096.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3217.5, ups=0.19, wpb=17096.2, bsz=1024, num_updates=37150, lr=2.65277e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13, wall=248364
2024-11-12 07:44:35 - progress_bar.py[line:274] - INFO: epoch 096:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17156.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3191.5, ups=0.19, wpb=17156.2, bsz=1024, num_updates=37160, lr=2.63917e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=248417
2024-11-12 07:45:28 - progress_bar.py[line:274] - INFO: epoch 096:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17119.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3198.9, ups=0.19, wpb=17119.7, bsz=1024, num_updates=37170, lr=2.62556e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=248471
2024-11-12 07:46:22 - progress_bar.py[line:274] - INFO: epoch 096:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17236.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3182.2, ups=0.18, wpb=17236.6, bsz=1024, num_updates=37180, lr=2.61196e-06, gnorm=0.003, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=248525
2024-11-12 07:47:15 - progress_bar.py[line:274] - INFO: epoch 096:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17088, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3212, ups=0.19, wpb=17088, bsz=1024, num_updates=37190, lr=2.59836e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=248578
2024-11-12 07:48:09 - progress_bar.py[line:274] - INFO: epoch 096:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17295.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3239.4, ups=0.19, wpb=17295.5, bsz=1024, num_updates=37200, lr=2.58475e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=248632
2024-11-12 07:49:02 - progress_bar.py[line:274] - INFO: epoch 096:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17186.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3203.7, ups=0.19, wpb=17186.9, bsz=1024, num_updates=37210, lr=2.57115e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=248685
2024-11-12 07:49:56 - progress_bar.py[line:274] - INFO: epoch 096:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17371.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3258.4, ups=0.19, wpb=17371.8, bsz=1024, num_updates=37220, lr=2.55754e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=248739
2024-11-12 07:50:49 - progress_bar.py[line:274] - INFO: epoch 096:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17333.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3234.2, ups=0.19, wpb=17333.2, bsz=1024, num_updates=37230, lr=2.54394e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=248792
2024-11-12 07:51:48 - progress_bar.py[line:274] - INFO: epoch 096:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17080.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2910, ups=0.17, wpb=17080.3, bsz=1024, num_updates=37240, lr=2.53034e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=248851
2024-11-12 07:52:45 - progress_bar.py[line:274] - INFO: epoch 096:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17387.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3040.7, ups=0.17, wpb=17387.4, bsz=1024, num_updates=37250, lr=2.51673e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=248908
2024-11-12 07:53:39 - progress_bar.py[line:274] - INFO: epoch 096:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17160.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3201.8, ups=0.19, wpb=17160.3, bsz=1024, num_updates=37260, lr=2.50313e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=248962
2024-11-12 07:54:33 - progress_bar.py[line:274] - INFO: epoch 096:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17146.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3176, ups=0.19, wpb=17146.9, bsz=1024, num_updates=37270, lr=2.48952e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=249016
2024-11-12 07:55:27 - progress_bar.py[line:274] - INFO: epoch 096:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17162.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3153.2, ups=0.18, wpb=17162.9, bsz=1024, num_updates=37280, lr=2.47592e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=249070
2024-11-12 07:56:21 - progress_bar.py[line:274] - INFO: epoch 096:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17261.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3204.9, ups=0.19, wpb=17261.2, bsz=1024, num_updates=37290, lr=2.46232e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=249124
2024-11-12 07:57:15 - progress_bar.py[line:274] - INFO: epoch 096:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17222.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3219.2, ups=0.19, wpb=17222.1, bsz=1024, num_updates=37300, lr=2.44871e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249178
2024-11-12 07:58:09 - progress_bar.py[line:274] - INFO: epoch 096:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=16844.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3124.8, ups=0.19, wpb=16844.6, bsz=1024, num_updates=37310, lr=2.43511e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249231
2024-11-12 07:59:02 - progress_bar.py[line:274] - INFO: epoch 096:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=17142.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3197.1, ups=0.19, wpb=17142.7, bsz=1024, num_updates=37320, lr=2.42151e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=249285
2024-11-12 07:59:56 - progress_bar.py[line:274] - INFO: epoch 096:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17386.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3236.6, ups=0.19, wpb=17386.7, bsz=1024, num_updates=37330, lr=2.4079e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249339
2024-11-12 08:00:50 - progress_bar.py[line:274] - INFO: epoch 096:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17097.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3185, ups=0.19, wpb=17097.3, bsz=1024, num_updates=37340, lr=2.3943e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=249392
2024-11-12 08:01:44 - progress_bar.py[line:274] - INFO: epoch 096:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17188.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3173.4, ups=0.18, wpb=17188.8, bsz=1024, num_updates=37350, lr=2.38069e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=249447
2024-11-12 08:02:37 - progress_bar.py[line:274] - INFO: epoch 096:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.604, ntokens=17499.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.08, wps=3260.2, ups=0.19, wpb=17499.4, bsz=1024, num_updates=37360, lr=2.36709e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=249500
2024-11-12 08:03:31 - progress_bar.py[line:274] - INFO: epoch 096:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17111.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3171, ups=0.19, wpb=17111.8, bsz=1024, num_updates=37370, lr=2.35349e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249554
2024-11-12 08:04:25 - progress_bar.py[line:274] - INFO: epoch 096:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17299.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3216.2, ups=0.19, wpb=17299.8, bsz=1024, num_updates=37380, lr=2.33988e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249608
2024-11-12 08:05:18 - progress_bar.py[line:274] - INFO: epoch 096:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17233.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3254.3, ups=0.19, wpb=17233.3, bsz=1024, num_updates=37390, lr=2.32628e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=249661
2024-11-12 08:06:11 - progress_bar.py[line:274] - INFO: epoch 096:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17275.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3238.3, ups=0.19, wpb=17275.1, bsz=1024, num_updates=37400, lr=2.31267e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=12.7, wall=249714
2024-11-12 08:07:06 - progress_bar.py[line:274] - INFO: epoch 096:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17217.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3176.9, ups=0.18, wpb=17217.6, bsz=1024, num_updates=37410, lr=2.29907e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249769
2024-11-12 08:08:00 - progress_bar.py[line:274] - INFO: epoch 096:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17227.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3187, ups=0.18, wpb=17227.3, bsz=1024, num_updates=37420, lr=2.28547e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=249823
2024-11-12 08:08:16 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-12 08:08:59 - progress_bar.py[line:274] - INFO: epoch 096:    333 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17427.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2962.1, ups=0.17, wpb=17427.9, bsz=1024, num_updates=37430, lr=2.27186e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=33, gb_free=13.3, wall=249881
2024-11-12 08:09:52 - progress_bar.py[line:274] - INFO: epoch 096:    343 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17372.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3249.4, ups=0.19, wpb=17372.9, bsz=1024, num_updates=37440, lr=2.25826e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=249935
2024-11-12 08:10:46 - progress_bar.py[line:274] - INFO: epoch 096:    353 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=16958.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3151.8, ups=0.19, wpb=16958.7, bsz=1024, num_updates=37450, lr=2.24465e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=249989
2024-11-12 08:11:41 - progress_bar.py[line:274] - INFO: epoch 096:    363 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17313.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3112.2, ups=0.18, wpb=17313.3, bsz=1024, num_updates=37460, lr=2.23105e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=250044
2024-11-12 08:12:36 - progress_bar.py[line:274] - INFO: epoch 096:    373 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.573, ntokens=17385.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3202.4, ups=0.18, wpb=17385.4, bsz=1024, num_updates=37470, lr=2.21745e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=250099
2024-11-12 08:13:28 - progress_bar.py[line:274] - INFO: epoch 096:    383 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17241.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3314.2, ups=0.19, wpb=17241.6, bsz=1024, num_updates=37480, lr=2.20384e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=250151
2024-11-12 08:14:06 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 96 @ 37488 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
2024-11-12 08:14:06 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 08:15:58 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
2024-11-12 08:17:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 96 @ 37488 updates, score 0) (writing took 223.57566164899617 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_96.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 7 seek offset 350000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
2024-11-12 08:18:45 - train.py[line:336] - INFO: end of epoch 96 (average epoch stats below)
2024-11-12 08:18:45 - progress_bar.py[line:282] - INFO: epoch 096 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.56 | ntokens 17194.4 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.9 | wps 2633.7 | ups 0.15 | wpb 17194.4 | bsz 1023 | num_updates 37488 | lr 2.19296e-06 | gnorm 0.002 | clip 0 | loss_scale 65536 | train_wall 1188 | gb_free 13.3 | wall 250468
2024-11-12 08:18:45 - trainer.py[line:639] - INFO: loading train data for epoch 97
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 08:21:24 - trainer.py[line:703] - INFO: begin training epoch 97
2024-11-12 08:21:24 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 08:21:36 - progress_bar.py[line:274] - INFO: epoch 097:      2 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=16590.7, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=339.5, ups=0.02, wpb=16590.7, bsz=985.6, num_updates=37490, lr=2.19024e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=250639
2024-11-12 08:22:30 - progress_bar.py[line:274] - INFO: epoch 097:     12 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17021.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3192.8, ups=0.19, wpb=17021.2, bsz=1024, num_updates=37500, lr=2.17663e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=250693
2024-11-12 08:23:23 - progress_bar.py[line:274] - INFO: epoch 097:     22 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17172.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3196.5, ups=0.19, wpb=17172.1, bsz=1024, num_updates=37510, lr=2.16303e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=250746
2024-11-12 08:24:17 - progress_bar.py[line:274] - INFO: epoch 097:     32 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17204, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3226.6, ups=0.19, wpb=17204, bsz=1024, num_updates=37520, lr=2.14943e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=250800
2024-11-12 08:25:11 - progress_bar.py[line:274] - INFO: epoch 097:     42 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17224.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3195.6, ups=0.19, wpb=17224.4, bsz=1024, num_updates=37530, lr=2.13582e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=250854
2024-11-12 08:26:07 - progress_bar.py[line:274] - INFO: epoch 097:     52 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17192.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3043.1, ups=0.18, wpb=17192.8, bsz=1024, num_updates=37540, lr=2.12222e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=12.9, wall=250910
2024-11-12 08:27:06 - progress_bar.py[line:274] - INFO: epoch 097:     62 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.506, ntokens=17000.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=2899.4, ups=0.17, wpb=17000.7, bsz=1024, num_updates=37550, lr=2.10861e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=250969
2024-11-12 08:28:04 - progress_bar.py[line:274] - INFO: epoch 097:     72 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.518, ntokens=16918.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=2892.1, ups=0.17, wpb=16918.4, bsz=1024, num_updates=37560, lr=2.09501e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=251027
2024-11-12 08:29:03 - progress_bar.py[line:274] - INFO: epoch 097:     82 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17387, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=2970.7, ups=0.17, wpb=17387, bsz=1024, num_updates=37570, lr=2.08141e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=251086
2024-11-12 08:30:00 - progress_bar.py[line:274] - INFO: epoch 097:     92 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.524, ntokens=16972.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=2974, ups=0.18, wpb=16972.5, bsz=1024, num_updates=37580, lr=2.0678e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=251143
2024-11-12 08:30:53 - progress_bar.py[line:274] - INFO: epoch 097:    102 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.569, ntokens=17347, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3280.9, ups=0.19, wpb=17347, bsz=1024, num_updates=37590, lr=2.0542e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=251196
2024-11-12 08:31:46 - progress_bar.py[line:274] - INFO: epoch 097:    112 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17004.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3170.4, ups=0.19, wpb=17004.8, bsz=1024, num_updates=37600, lr=2.04059e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=251249
2024-11-12 08:32:40 - progress_bar.py[line:274] - INFO: epoch 097:    122 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17261.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3247.5, ups=0.19, wpb=17261.5, bsz=1024, num_updates=37610, lr=2.02699e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=251302
2024-11-12 08:33:33 - progress_bar.py[line:274] - INFO: epoch 097:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17362.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3243.9, ups=0.19, wpb=17362.5, bsz=1024, num_updates=37620, lr=2.01339e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=251356
2024-11-12 08:34:27 - progress_bar.py[line:274] - INFO: epoch 097:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=16973.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3144, ups=0.19, wpb=16973.1, bsz=1024, num_updates=37630, lr=1.99978e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=251410
2024-11-12 08:35:21 - progress_bar.py[line:274] - INFO: epoch 097:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17199.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3207, ups=0.19, wpb=17199.3, bsz=1024, num_updates=37640, lr=1.98618e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=251464
2024-11-12 08:36:15 - progress_bar.py[line:274] - INFO: epoch 097:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.593, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.04, wps=3225.7, ups=0.19, wpb=17422.9, bsz=1024, num_updates=37650, lr=1.97257e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.3, wall=251518
2024-11-12 08:37:11 - progress_bar.py[line:274] - INFO: epoch 097:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=16978.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3032.1, ups=0.18, wpb=16978.6, bsz=1024, num_updates=37660, lr=1.95897e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=42, gb_free=13.6, wall=251574
2024-11-12 08:38:07 - progress_bar.py[line:274] - INFO: epoch 097:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17226.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3043.4, ups=0.18, wpb=17226.4, bsz=1024, num_updates=37670, lr=1.94537e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=57, gb_free=13.2, wall=251630
2024-11-12 08:39:01 - progress_bar.py[line:274] - INFO: epoch 097:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17249.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3221, ups=0.19, wpb=17249.1, bsz=1024, num_updates=37680, lr=1.93176e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=251684
2024-11-12 08:39:55 - progress_bar.py[line:274] - INFO: epoch 097:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17113.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3136.1, ups=0.18, wpb=17113.7, bsz=1024, num_updates=37690, lr=1.91816e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=251738
2024-11-12 08:40:52 - progress_bar.py[line:274] - INFO: epoch 097:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=16954.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3008.8, ups=0.18, wpb=16954.8, bsz=1024, num_updates=37700, lr=1.90455e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=251795
2024-11-12 08:41:48 - progress_bar.py[line:274] - INFO: epoch 097:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.526, ntokens=17070.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3037.1, ups=0.18, wpb=17070.1, bsz=1024, num_updates=37710, lr=1.89095e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.3, wall=251851
2024-11-12 08:42:45 - progress_bar.py[line:274] - INFO: epoch 097:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17183.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3037.5, ups=0.18, wpb=17183.1, bsz=1024, num_updates=37720, lr=1.87735e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=43, gb_free=13.4, wall=251907
2024-11-12 08:43:40 - progress_bar.py[line:274] - INFO: epoch 097:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.6, ntokens=17451.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.06, wps=3148.5, ups=0.18, wpb=17451.5, bsz=1024, num_updates=37730, lr=1.86374e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=38, gb_free=13.3, wall=251963
2024-11-12 08:44:36 - progress_bar.py[line:274] - INFO: epoch 097:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=16981, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3007.7, ups=0.18, wpb=16981, bsz=1024, num_updates=37740, lr=1.85014e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=252019
2024-11-12 08:45:30 - progress_bar.py[line:274] - INFO: epoch 097:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.583, ntokens=17405.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3269.4, ups=0.19, wpb=17405.9, bsz=1024, num_updates=37750, lr=1.83653e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=53, gb_free=12.9, wall=252073
2024-11-12 08:46:22 - progress_bar.py[line:274] - INFO: epoch 097:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17378.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3353.7, ups=0.19, wpb=17378.9, bsz=1024, num_updates=37760, lr=1.82293e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=47, gb_free=13.3, wall=252124
2024-11-12 08:47:14 - progress_bar.py[line:274] - INFO: epoch 097:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17041.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3242.6, ups=0.19, wpb=17041.9, bsz=1024, num_updates=37770, lr=1.80933e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=252177
2024-11-12 08:48:08 - progress_bar.py[line:274] - INFO: epoch 097:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=17088.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3184.7, ups=0.19, wpb=17088.5, bsz=1024, num_updates=37780, lr=1.79572e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=252231
2024-11-12 08:49:01 - progress_bar.py[line:274] - INFO: epoch 097:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17094, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3189.7, ups=0.19, wpb=17094, bsz=1024, num_updates=37790, lr=1.78212e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=12.7, wall=252284
2024-11-12 08:49:55 - progress_bar.py[line:274] - INFO: epoch 097:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=17247.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3212.6, ups=0.19, wpb=17247.5, bsz=1024, num_updates=37800, lr=1.76851e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=252338
2024-11-12 08:50:49 - progress_bar.py[line:274] - INFO: epoch 097:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17012, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3161.8, ups=0.19, wpb=17012, bsz=1024, num_updates=37810, lr=1.75491e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=252392
2024-11-12 08:51:43 - progress_bar.py[line:274] - INFO: epoch 097:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17107.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3160.4, ups=0.18, wpb=17107.1, bsz=1024, num_updates=37820, lr=1.74131e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=252446
2024-11-12 08:52:37 - progress_bar.py[line:274] - INFO: epoch 097:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17116.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3189.9, ups=0.19, wpb=17116.1, bsz=1024, num_updates=37830, lr=1.7277e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=252500
2024-11-12 08:53:31 - progress_bar.py[line:274] - INFO: epoch 097:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17125.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3160.4, ups=0.18, wpb=17125.8, bsz=1024, num_updates=37840, lr=1.7141e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=252554
2024-11-12 08:54:25 - progress_bar.py[line:274] - INFO: epoch 097:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17299, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3202.1, ups=0.19, wpb=17299, bsz=1024, num_updates=37850, lr=1.7005e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=252608
2024-11-12 08:55:18 - progress_bar.py[line:274] - INFO: epoch 097:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.584, ntokens=17358.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3251.8, ups=0.19, wpb=17358.9, bsz=1024, num_updates=37860, lr=1.68689e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=252661
2024-11-12 08:56:10 - progress_bar.py[line:274] - INFO: epoch 097:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17160.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3308.8, ups=0.19, wpb=17160.2, bsz=1024, num_updates=37870, lr=1.67329e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=252713
2024-11-12 08:56:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 97 @ 37879 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
2024-11-12 08:56:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 08:58:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-12 09:00:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 97 @ 37879 updates, score 0) (writing took 223.84557232400402 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_97.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-12 09:01:32 - train.py[line:336] - INFO: end of epoch 97 (average epoch stats below)
2024-11-12 09:01:32 - progress_bar.py[line:282] - INFO: epoch 097 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.554 | ntokens 17156.9 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.87 | wps 2613.1 | ups 0.15 | wpb 17156.9 | bsz 1023 | num_updates 37879 | lr 1.66104e-06 | gnorm 0.002 | clip 0 | loss_scale 65536 | train_wall 1410 | gb_free 13.3 | wall 253035
2024-11-12 09:01:32 - trainer.py[line:639] - INFO: loading train data for epoch 98
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 09:04:14 - trainer.py[line:703] - INFO: begin training epoch 98
2024-11-12 09:04:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 09:04:22 - progress_bar.py[line:274] - INFO: epoch 098:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.605, ntokens=16763.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.09, wps=340.8, ups=0.02, wpb=16763.5, bsz=985.6, num_updates=37880, lr=1.65968e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=29, gb_free=13.4, wall=253205
2024-11-12 09:05:17 - progress_bar.py[line:274] - INFO: epoch 098:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17179, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3130.9, ups=0.18, wpb=17179, bsz=1024, num_updates=37890, lr=1.64608e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=253260
2024-11-12 09:06:10 - progress_bar.py[line:274] - INFO: epoch 098:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17053.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3204.6, ups=0.19, wpb=17053.9, bsz=1024, num_updates=37900, lr=1.63248e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=253313
2024-11-12 09:07:04 - progress_bar.py[line:274] - INFO: epoch 098:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17279.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3202.1, ups=0.19, wpb=17279.2, bsz=1024, num_updates=37910, lr=1.61887e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=253367
2024-11-12 09:07:58 - progress_bar.py[line:274] - INFO: epoch 098:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17205, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3208.8, ups=0.19, wpb=17205, bsz=1024, num_updates=37920, lr=1.60527e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=253420
2024-11-12 09:08:51 - progress_bar.py[line:274] - INFO: epoch 098:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.546, ntokens=17078.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3197.8, ups=0.19, wpb=17078.2, bsz=1024, num_updates=37930, lr=1.59166e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=253474
2024-11-12 09:09:45 - progress_bar.py[line:274] - INFO: epoch 098:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17274, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3213.2, ups=0.19, wpb=17274, bsz=1024, num_updates=37940, lr=1.57806e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=253528
2024-11-12 09:10:38 - progress_bar.py[line:274] - INFO: epoch 098:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.507, ntokens=16796.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.68, wps=3153.3, ups=0.19, wpb=16796.8, bsz=1024, num_updates=37950, lr=1.56446e-06, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=253581
2024-11-12 09:11:32 - progress_bar.py[line:274] - INFO: epoch 098:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17221.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3196.2, ups=0.19, wpb=17221.7, bsz=1024, num_updates=37960, lr=1.55085e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=253635
2024-11-12 09:12:26 - progress_bar.py[line:274] - INFO: epoch 098:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17251.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3217.3, ups=0.19, wpb=17251.9, bsz=1024, num_updates=37970, lr=1.53725e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=253688
2024-11-12 09:13:19 - progress_bar.py[line:274] - INFO: epoch 098:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17355.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3249.7, ups=0.19, wpb=17355.1, bsz=1024, num_updates=37980, lr=1.52364e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=253742
2024-11-12 09:14:13 - progress_bar.py[line:274] - INFO: epoch 098:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17009.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3163.7, ups=0.19, wpb=17009.5, bsz=1024, num_updates=37990, lr=1.51004e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=253796
2024-11-12 09:15:06 - progress_bar.py[line:274] - INFO: epoch 098:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.586, ntokens=17416, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6, wps=3240.4, ups=0.19, wpb=17416, bsz=1024, num_updates=38000, lr=1.49644e-06, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=253849
2024-11-12 09:15:49 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-12 09:16:06 - progress_bar.py[line:274] - INFO: epoch 098:    132 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17333.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=2917.9, ups=0.17, wpb=17333.2, bsz=1024, num_updates=38010, lr=1.48283e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=34, gb_free=13.4, wall=253909
2024-11-12 09:16:59 - progress_bar.py[line:274] - INFO: epoch 098:    142 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=16937.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3157.6, ups=0.19, wpb=16937.8, bsz=1024, num_updates=38020, lr=1.46923e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=253962
2024-11-12 09:17:53 - progress_bar.py[line:274] - INFO: epoch 098:    152 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17099.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3167.7, ups=0.19, wpb=17099.8, bsz=1024, num_updates=38030, lr=1.45562e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=254016
2024-11-12 09:18:47 - progress_bar.py[line:274] - INFO: epoch 098:    162 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=16999.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3187.7, ups=0.19, wpb=16999.9, bsz=1024, num_updates=38040, lr=1.44202e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=254070
2024-11-12 09:19:41 - progress_bar.py[line:274] - INFO: epoch 098:    172 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=17138.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3170.9, ups=0.19, wpb=17138.3, bsz=1024, num_updates=38050, lr=1.42842e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=254124
2024-11-12 09:20:36 - progress_bar.py[line:274] - INFO: epoch 098:    182 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.53, ntokens=17023.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3070.2, ups=0.18, wpb=17023.2, bsz=1024, num_updates=38060, lr=1.41481e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=254179
2024-11-12 09:21:29 - progress_bar.py[line:274] - INFO: epoch 098:    192 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17039, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3207, ups=0.19, wpb=17039, bsz=1024, num_updates=38070, lr=1.40121e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=254232
2024-11-12 09:22:23 - progress_bar.py[line:274] - INFO: epoch 098:    202 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17235.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3224.7, ups=0.19, wpb=17235.1, bsz=1024, num_updates=38080, lr=1.3876e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=254286
2024-11-12 09:23:16 - progress_bar.py[line:274] - INFO: epoch 098:    212 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=16993, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3187.1, ups=0.19, wpb=16993, bsz=1024, num_updates=38090, lr=1.374e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=34, gb_free=13.2, wall=254339
2024-11-12 09:24:09 - progress_bar.py[line:274] - INFO: epoch 098:    222 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17047.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3225.9, ups=0.19, wpb=17047.3, bsz=1024, num_updates=38100, lr=1.3604e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=254392
2024-11-12 09:25:03 - progress_bar.py[line:274] - INFO: epoch 098:    232 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17016.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3174.5, ups=0.19, wpb=17016.8, bsz=1024, num_updates=38110, lr=1.34679e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=254446
2024-11-12 09:25:56 - progress_bar.py[line:274] - INFO: epoch 098:    242 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17011.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3194.4, ups=0.19, wpb=17011.1, bsz=1024, num_updates=38120, lr=1.33319e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=254499
2024-11-12 09:26:50 - progress_bar.py[line:274] - INFO: epoch 098:    252 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17218.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3208.7, ups=0.19, wpb=17218.5, bsz=1024, num_updates=38130, lr=1.31958e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=254552
2024-11-12 09:27:43 - progress_bar.py[line:274] - INFO: epoch 098:    262 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17381.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3248.1, ups=0.19, wpb=17381.9, bsz=1024, num_updates=38140, lr=1.30598e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=12.8, wall=254606
2024-11-12 09:28:39 - progress_bar.py[line:274] - INFO: epoch 098:    272 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17095.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3040.3, ups=0.18, wpb=17095.8, bsz=1024, num_updates=38150, lr=1.29238e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=44, gb_free=13.3, wall=254662
2024-11-12 09:29:34 - progress_bar.py[line:274] - INFO: epoch 098:    282 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17146.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=3150.7, ups=0.18, wpb=17146.6, bsz=1024, num_updates=38160, lr=1.27877e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=254717
2024-11-12 09:30:26 - progress_bar.py[line:274] - INFO: epoch 098:    292 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17190.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3297.9, ups=0.19, wpb=17190.5, bsz=1024, num_updates=38170, lr=1.26517e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=52, gb_free=13.2, wall=254769
2024-11-12 09:31:20 - progress_bar.py[line:274] - INFO: epoch 098:    302 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17204.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3198.2, ups=0.19, wpb=17204.5, bsz=1024, num_updates=38180, lr=1.25156e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=51, gb_free=13.3, wall=254823
2024-11-12 09:32:12 - progress_bar.py[line:274] - INFO: epoch 098:    312 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17192.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3298.1, ups=0.19, wpb=17192.2, bsz=1024, num_updates=38190, lr=1.23796e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=39, gb_free=13.4, wall=254875
2024-11-12 09:33:04 - progress_bar.py[line:274] - INFO: epoch 098:    322 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=16930.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3218, ups=0.19, wpb=16930.8, bsz=1024, num_updates=38200, lr=1.22436e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=35, gb_free=13.2, wall=254927
2024-11-12 09:34:01 - progress_bar.py[line:274] - INFO: epoch 098:    332 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17261, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3022.6, ups=0.18, wpb=17261, bsz=1024, num_updates=38210, lr=1.21075e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=31, gb_free=13, wall=254984
2024-11-12 09:34:56 - progress_bar.py[line:274] - INFO: epoch 098:    342 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.519, ntokens=16997.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3123.5, ups=0.18, wpb=16997.1, bsz=1024, num_updates=38220, lr=1.19715e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=255039
2024-11-12 09:35:49 - progress_bar.py[line:274] - INFO: epoch 098:    352 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.532, ntokens=17026.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3207.1, ups=0.19, wpb=17026.9, bsz=1024, num_updates=38230, lr=1.18354e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=255092
2024-11-12 09:36:43 - progress_bar.py[line:274] - INFO: epoch 098:    362 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17334.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3205.7, ups=0.18, wpb=17334.2, bsz=1024, num_updates=38240, lr=1.16994e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=12.8, wall=255146
2024-11-12 09:37:36 - progress_bar.py[line:274] - INFO: epoch 098:    372 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.544, ntokens=17097.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3210.6, ups=0.19, wpb=17097.7, bsz=1024, num_updates=38250, lr=1.15634e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=255199
2024-11-12 09:38:29 - progress_bar.py[line:274] - INFO: epoch 098:    382 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17299.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3270.1, ups=0.19, wpb=17299.7, bsz=1024, num_updates=38260, lr=1.14273e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=255252
2024-11-12 09:39:13 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 98 @ 38269 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
2024-11-12 09:39:13 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt': File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 09:41:36 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 4 seek offset 200000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 1 seek offset 50000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
2024-11-12 09:44:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 98 @ 38269 updates, score 0) (writing took 327.7499666630756 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_98.pt
2024-11-12 09:46:12 - train.py[line:336] - INFO: end of epoch 98 (average epoch stats below)
2024-11-12 09:46:12 - progress_bar.py[line:282] - INFO: epoch 098 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.549 | ntokens 17126.6 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.85 | wps 2492.2 | ups 0.15 | wpb 17126.6 | bsz 1023 | num_updates 38269 | lr 1.13049e-06 | gnorm 0.002 | clip 0 | loss_scale 65536 | train_wall 1283 | gb_free 13.3 | wall 255715
2024-11-12 09:46:12 - trainer.py[line:639] - INFO: loading train data for epoch 99
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 09:48:55 - trainer.py[line:703] - INFO: begin training epoch 99
2024-11-12 09:48:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 09:49:03 - progress_bar.py[line:274] - INFO: epoch 099:      1 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.576, ntokens=16535.3, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=260.9, ups=0.02, wpb=16535.3, bsz=985.6, num_updates=38270, lr=1.12913e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=29, gb_free=13.3, wall=255886
2024-11-12 09:49:58 - progress_bar.py[line:274] - INFO: epoch 099:     11 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17417.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3147.3, ups=0.18, wpb=17417.1, bsz=1024, num_updates=38280, lr=1.11552e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=33, gb_free=13.4, wall=255941
2024-11-12 09:50:55 - progress_bar.py[line:274] - INFO: epoch 099:     21 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17303.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3080.5, ups=0.18, wpb=17303.4, bsz=1024, num_updates=38290, lr=1.10192e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=37, gb_free=13.4, wall=255997
2024-11-12 09:51:54 - progress_bar.py[line:274] - INFO: epoch 099:     31 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17161.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2904.5, ups=0.17, wpb=17161.2, bsz=1024, num_updates=38300, lr=1.08832e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=256057
2024-11-12 09:52:48 - progress_bar.py[line:274] - INFO: epoch 099:     41 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17232.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3148.1, ups=0.18, wpb=17232.4, bsz=1024, num_updates=38310, lr=1.07471e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.3, wall=256111
2024-11-12 09:53:44 - progress_bar.py[line:274] - INFO: epoch 099:     51 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17340.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3110.4, ups=0.18, wpb=17340.7, bsz=1024, num_updates=38320, lr=1.06111e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.2, wall=256167
2024-11-12 09:54:43 - progress_bar.py[line:274] - INFO: epoch 099:     61 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.542, ntokens=17164.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=2904.9, ups=0.17, wpb=17164.2, bsz=1024, num_updates=38330, lr=1.04751e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=59, gb_free=13.5, wall=256226
2024-11-12 09:55:43 - progress_bar.py[line:274] - INFO: epoch 099:     71 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.552, ntokens=17114.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=2880.6, ups=0.17, wpb=17114.3, bsz=1024, num_updates=38340, lr=1.0339e-06, gnorm=0.001, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=256286
2024-11-12 09:56:39 - progress_bar.py[line:274] - INFO: epoch 099:     81 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.567, ntokens=17261.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3061.7, ups=0.18, wpb=17261.4, bsz=1024, num_updates=38350, lr=1.0203e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=256342
2024-11-12 09:57:34 - progress_bar.py[line:274] - INFO: epoch 099:     91 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.572, ntokens=17394.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.95, wps=3143.5, ups=0.18, wpb=17394.2, bsz=1024, num_updates=38360, lr=1.00669e-06, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.2, wall=256397
2024-11-12 09:58:33 - progress_bar.py[line:274] - INFO: epoch 099:    101 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17264.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=2955.3, ups=0.17, wpb=17264.6, bsz=1024, num_updates=38370, lr=9.93089e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=58, gb_free=13, wall=256456
2024-11-12 09:59:28 - progress_bar.py[line:274] - INFO: epoch 099:    111 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.541, ntokens=16944.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3055.2, ups=0.18, wpb=16944.9, bsz=1024, num_updates=38380, lr=9.79485e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=256511
2024-11-12 10:00:23 - progress_bar.py[line:274] - INFO: epoch 099:    121 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.592, ntokens=17448.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.03, wps=3202.2, ups=0.18, wpb=17448.3, bsz=1024, num_updates=38390, lr=9.65881e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=256566
2024-11-12 10:01:18 - progress_bar.py[line:274] - INFO: epoch 099:    131 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.555, ntokens=17209.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3124.1, ups=0.18, wpb=17209.6, bsz=1024, num_updates=38400, lr=9.52277e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=256621
2024-11-12 10:02:15 - progress_bar.py[line:274] - INFO: epoch 099:    141 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.557, ntokens=17042.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=2993.5, ups=0.18, wpb=17042.3, bsz=1024, num_updates=38410, lr=9.38673e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=57, gb_free=13.4, wall=256678
2024-11-12 10:03:09 - progress_bar.py[line:274] - INFO: epoch 099:    151 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.578, ntokens=17420, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=3206.1, ups=0.18, wpb=17420, bsz=1024, num_updates=38420, lr=9.25069e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=256732
2024-11-12 10:04:08 - progress_bar.py[line:274] - INFO: epoch 099:    161 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.577, ntokens=17367, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=2936.2, ups=0.17, wpb=17367, bsz=1024, num_updates=38430, lr=9.11465e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=58, gb_free=13.4, wall=256791
2024-11-12 10:05:07 - progress_bar.py[line:274] - INFO: epoch 099:    171 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.575, ntokens=17366.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=2941.2, ups=0.17, wpb=17366.3, bsz=1024, num_updates=38440, lr=8.97861e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=59, gb_free=13.3, wall=256850
2024-11-12 10:06:08 - progress_bar.py[line:274] - INFO: epoch 099:    181 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.531, ntokens=17015.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.78, wps=2799.9, ups=0.16, wpb=17015.5, bsz=1024, num_updates=38450, lr=8.84257e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=61, gb_free=13.4, wall=256911
2024-11-12 10:07:09 - progress_bar.py[line:274] - INFO: epoch 099:    191 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=17062.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=2781.3, ups=0.16, wpb=17062.6, bsz=1024, num_updates=38460, lr=8.70654e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=61, gb_free=13.3, wall=256972
2024-11-12 10:08:16 - progress_bar.py[line:274] - INFO: epoch 099:    201 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.582, ntokens=17390.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=2606.4, ups=0.15, wpb=17390.2, bsz=1024, num_updates=38470, lr=8.5705e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=67, gb_free=13.2, wall=257039
2024-11-12 10:09:18 - progress_bar.py[line:274] - INFO: epoch 099:    211 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.528, ntokens=17032.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=2775.3, ups=0.16, wpb=17032.8, bsz=1024, num_updates=38480, lr=8.43446e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=61, gb_free=13.3, wall=257100
2024-11-12 10:10:17 - progress_bar.py[line:274] - INFO: epoch 099:    221 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.538, ntokens=17185.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=2908.9, ups=0.17, wpb=17185.3, bsz=1024, num_updates=38490, lr=8.29842e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=59, gb_free=13.1, wall=257159
2024-11-12 10:11:12 - progress_bar.py[line:274] - INFO: epoch 099:    231 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.58, ntokens=17444.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.98, wps=3153.1, ups=0.18, wpb=17444.8, bsz=1024, num_updates=38500, lr=8.16238e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=55, gb_free=13.4, wall=257215
2024-11-12 10:12:08 - progress_bar.py[line:274] - INFO: epoch 099:    241 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.535, ntokens=16959.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3037, ups=0.18, wpb=16959.3, bsz=1024, num_updates=38510, lr=8.02634e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=45, gb_free=13.5, wall=257271
2024-11-12 10:13:04 - progress_bar.py[line:274] - INFO: epoch 099:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17074.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3046.2, ups=0.18, wpb=17074.5, bsz=1024, num_updates=38520, lr=7.8903e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=42, gb_free=13.4, wall=257327
2024-11-12 10:13:59 - progress_bar.py[line:274] - INFO: epoch 099:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=16995.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3053.6, ups=0.18, wpb=16995.7, bsz=1024, num_updates=38530, lr=7.75426e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=42, gb_free=13.2, wall=257382
2024-11-12 10:14:56 - progress_bar.py[line:274] - INFO: epoch 099:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17092.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3034.1, ups=0.18, wpb=17092.1, bsz=1024, num_updates=38540, lr=7.61822e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=42, gb_free=13.3, wall=257439
2024-11-12 10:15:55 - progress_bar.py[line:274] - INFO: epoch 099:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.558, ntokens=17241.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=2897.8, ups=0.17, wpb=17241.4, bsz=1024, num_updates=38550, lr=7.48218e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=47, gb_free=13.2, wall=257498
2024-11-12 10:17:01 - progress_bar.py[line:274] - INFO: epoch 099:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.56, ntokens=17164.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=2603, ups=0.15, wpb=17164.3, bsz=1024, num_updates=38560, lr=7.34614e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=66, gb_free=13.2, wall=257564
2024-11-12 10:17:59 - progress_bar.py[line:274] - INFO: epoch 099:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.57, ntokens=17295.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3021.1, ups=0.17, wpb=17295.4, bsz=1024, num_updates=38570, lr=7.2101e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=49, gb_free=13.3, wall=257621
2024-11-12 10:18:52 - progress_bar.py[line:274] - INFO: epoch 099:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17144.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3182.4, ups=0.19, wpb=17144.4, bsz=1024, num_updates=38580, lr=7.07406e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=42, gb_free=12.8, wall=257675
2024-11-12 10:19:46 - progress_bar.py[line:274] - INFO: epoch 099:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17049.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3179.3, ups=0.19, wpb=17049.7, bsz=1024, num_updates=38590, lr=6.93802e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=257729
2024-11-12 10:20:40 - progress_bar.py[line:274] - INFO: epoch 099:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.527, ntokens=17040.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.76, wps=3147.5, ups=0.18, wpb=17040.3, bsz=1024, num_updates=38600, lr=6.80198e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=36, gb_free=13.5, wall=257783
2024-11-12 10:21:35 - progress_bar.py[line:274] - INFO: epoch 099:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17305.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3151.6, ups=0.18, wpb=17305.8, bsz=1024, num_updates=38610, lr=6.66594e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=42, gb_free=13.3, wall=257838
2024-11-12 10:22:30 - progress_bar.py[line:274] - INFO: epoch 099:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.534, ntokens=17030.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3089, ups=0.18, wpb=17030.1, bsz=1024, num_updates=38620, lr=6.5299e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=257893
2024-11-12 10:23:25 - progress_bar.py[line:274] - INFO: epoch 099:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.581, ntokens=17524.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.99, wps=3169.3, ups=0.18, wpb=17524.5, bsz=1024, num_updates=38630, lr=6.39386e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=257948
2024-11-12 10:24:21 - progress_bar.py[line:274] - INFO: epoch 099:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17233.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3104.1, ups=0.18, wpb=17233.3, bsz=1024, num_updates=38640, lr=6.25782e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=258004
2024-11-12 10:25:13 - progress_bar.py[line:274] - INFO: epoch 099:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.561, ntokens=17228.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3296.4, ups=0.19, wpb=17228.9, bsz=1024, num_updates=38650, lr=6.12178e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=52, gb_free=12.7, wall=258056
2024-11-12 10:26:01 - progress_bar.py[line:274] - INFO: epoch 099:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.54, ntokens=16346.4, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=5.82, wps=3449.2, ups=0.21, wpb=16346.4, bsz=985.6, num_updates=38660, lr=5.98574e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=47, gb_free=13.5, wall=258104
2024-11-12 10:26:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 99 @ 38660 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt
2024-11-12 10:26:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 10:27:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
2024-11-12 10:29:42 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 99 @ 38660 updates, score 0) (writing took 220.87424756702967 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_99.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
2024-11-12 10:30:36 - train.py[line:336] - INFO: end of epoch 99 (average epoch stats below)
2024-11-12 10:30:36 - progress_bar.py[line:282] - INFO: epoch 099 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.557 | ntokens 17188.3 | nsentences 1023.02 | sample_size 1023.02 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.88 | wps 2522.3 | ups 0.15 | wpb 17188.3 | bsz 1023 | num_updates 38660 | lr 5.98574e-07 | gnorm 0.002 | clip 0 | loss_scale 131072 | train_wall 2030 | gb_free 13.5 | wall 258379
2024-11-12 10:30:36 - trainer.py[line:639] - INFO: loading train data for epoch 100
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 10:33:17 - trainer.py[line:703] - INFO: begin training epoch 100
2024-11-12 10:33:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-12 10:34:13 - progress_bar.py[line:274] - INFO: epoch 100:     10 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.579, ntokens=17389.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.97, wps=353.2, ups=0.02, wpb=17389.5, bsz=1024, num_updates=38670, lr=5.8497e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=258596
2024-11-12 10:35:06 - progress_bar.py[line:274] - INFO: epoch 100:     20 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17283.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3244.6, ups=0.19, wpb=17283.6, bsz=1024, num_updates=38680, lr=5.71366e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=258649
2024-11-12 10:36:01 - progress_bar.py[line:274] - INFO: epoch 100:     30 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.551, ntokens=17107.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3152.4, ups=0.18, wpb=17107.9, bsz=1024, num_updates=38690, lr=5.57762e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=258703
2024-11-12 10:36:55 - progress_bar.py[line:274] - INFO: epoch 100:     40 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.554, ntokens=17209.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3186.3, ups=0.19, wpb=17209.3, bsz=1024, num_updates=38700, lr=5.44158e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=258757
2024-11-12 10:37:48 - progress_bar.py[line:274] - INFO: epoch 100:     50 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17279.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3248.7, ups=0.19, wpb=17279.9, bsz=1024, num_updates=38710, lr=5.30554e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=258811
2024-11-12 10:38:41 - progress_bar.py[line:274] - INFO: epoch 100:     60 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17324, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3260.4, ups=0.19, wpb=17324, bsz=1024, num_updates=38720, lr=5.16951e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=258864
2024-11-12 10:39:34 - progress_bar.py[line:274] - INFO: epoch 100:     70 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.517, ntokens=16877.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.72, wps=3151.3, ups=0.19, wpb=16877.5, bsz=1024, num_updates=38730, lr=5.03347e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=258917
2024-11-12 10:40:28 - progress_bar.py[line:274] - INFO: epoch 100:     80 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.574, ntokens=17316.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.96, wps=3217.3, ups=0.19, wpb=17316.7, bsz=1024, num_updates=38740, lr=4.89743e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=258971
2024-11-12 10:41:22 - progress_bar.py[line:274] - INFO: epoch 100:     90 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.566, ntokens=17273.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3199.4, ups=0.19, wpb=17273.8, bsz=1024, num_updates=38750, lr=4.76139e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=259025
2024-11-12 10:42:16 - progress_bar.py[line:274] - INFO: epoch 100:    100 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.588, ntokens=17480.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3261.7, ups=0.19, wpb=17480.6, bsz=1024, num_updates=38760, lr=4.62535e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=259079
2024-11-12 10:43:10 - progress_bar.py[line:274] - INFO: epoch 100:    110 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.548, ntokens=17039.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3157.6, ups=0.19, wpb=17039.5, bsz=1024, num_updates=38770, lr=4.48931e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=259133
2024-11-12 10:44:03 - progress_bar.py[line:274] - INFO: epoch 100:    120 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.549, ntokens=17171.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.85, wps=3217.9, ups=0.19, wpb=17171.9, bsz=1024, num_updates=38780, lr=4.35327e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=259186
2024-11-12 10:44:56 - progress_bar.py[line:274] - INFO: epoch 100:    130 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.55, ntokens=17255.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.86, wps=3238.7, ups=0.19, wpb=17255.9, bsz=1024, num_updates=38790, lr=4.21723e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13, wall=259239
2024-11-12 10:45:50 - progress_bar.py[line:274] - INFO: epoch 100:    140 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17106.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=3177.1, ups=0.19, wpb=17106.3, bsz=1024, num_updates=38800, lr=4.08119e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=259293
2024-11-12 10:46:45 - progress_bar.py[line:274] - INFO: epoch 100:    150 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.547, ntokens=17206.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3172.2, ups=0.18, wpb=17206.9, bsz=1024, num_updates=38810, lr=3.94515e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=259347
2024-11-12 10:47:38 - progress_bar.py[line:274] - INFO: epoch 100:    160 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.529, ntokens=17004.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.77, wps=3179.2, ups=0.19, wpb=17004.7, bsz=1024, num_updates=38820, lr=3.80911e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=12.9, wall=259401
2024-11-12 10:48:31 - progress_bar.py[line:274] - INFO: epoch 100:    170 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17024.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3220.2, ups=0.19, wpb=17024.1, bsz=1024, num_updates=38830, lr=3.67307e-07, gnorm=0.002, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=259454
2024-11-12 10:49:24 - progress_bar.py[line:274] - INFO: epoch 100:    180 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.533, ntokens=17119.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.79, wps=3201.9, ups=0.19, wpb=17119.6, bsz=1024, num_updates=38840, lr=3.53703e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=259507
2024-11-12 10:50:18 - progress_bar.py[line:274] - INFO: epoch 100:    190 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.521, ntokens=16901.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.74, wps=3156.8, ups=0.19, wpb=16901.8, bsz=1024, num_updates=38850, lr=3.40099e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=259561
2024-11-12 10:51:12 - progress_bar.py[line:274] - INFO: epoch 100:    200 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.587, ntokens=17353.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.01, wps=3209.8, ups=0.18, wpb=17353.9, bsz=1024, num_updates=38860, lr=3.26495e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13, wall=259615
2024-11-12 10:52:05 - progress_bar.py[line:274] - INFO: epoch 100:    210 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.562, ntokens=17190.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.9, wps=3214.7, ups=0.19, wpb=17190.5, bsz=1024, num_updates=38870, lr=3.12891e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=259668
2024-11-12 10:52:59 - progress_bar.py[line:274] - INFO: epoch 100:    220 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.523, ntokens=17007.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.75, wps=3160.9, ups=0.19, wpb=17007.3, bsz=1024, num_updates=38880, lr=2.99287e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=259722
2024-11-12 10:53:53 - progress_bar.py[line:274] - INFO: epoch 100:    230 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.568, ntokens=17354.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.93, wps=3226.9, ups=0.19, wpb=17354.8, bsz=1024, num_updates=38890, lr=2.85683e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=259776
2024-11-12 10:54:46 - progress_bar.py[line:274] - INFO: epoch 100:    240 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17125.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3207.8, ups=0.19, wpb=17125.6, bsz=1024, num_updates=38900, lr=2.72079e-07, gnorm=0.001, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=259829
2024-11-12 10:55:18 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 65536.0
2024-11-12 10:55:45 - progress_bar.py[line:274] - INFO: epoch 100:    251 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.563, ntokens=17278.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.91, wps=2936.2, ups=0.17, wpb=17278.7, bsz=1024, num_updates=38910, lr=2.58475e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=34, gb_free=13.2, wall=259888
2024-11-12 10:56:40 - progress_bar.py[line:274] - INFO: epoch 100:    261 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17061, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3125.4, ups=0.18, wpb=17061, bsz=1024, num_updates=38920, lr=2.44871e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=259943
2024-11-12 10:57:34 - progress_bar.py[line:274] - INFO: epoch 100:    271 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.559, ntokens=17256.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.89, wps=3176.5, ups=0.18, wpb=17256.7, bsz=1024, num_updates=38930, lr=2.31267e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=259997
2024-11-12 10:58:29 - progress_bar.py[line:274] - INFO: epoch 100:    281 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.537, ntokens=17079.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.8, wps=3144.8, ups=0.18, wpb=17079.4, bsz=1024, num_updates=38940, lr=2.17663e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=260051
2024-11-12 10:59:22 - progress_bar.py[line:274] - INFO: epoch 100:    291 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.556, ntokens=17172.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.88, wps=3189.1, ups=0.19, wpb=17172.3, bsz=1024, num_updates=38950, lr=2.04059e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=260105
2024-11-12 11:00:16 - progress_bar.py[line:274] - INFO: epoch 100:    301 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.543, ntokens=17124.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3200.9, ups=0.19, wpb=17124.8, bsz=1024, num_updates=38960, lr=1.90455e-07, gnorm=0.002, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=260159
2024-11-12 11:01:09 - progress_bar.py[line:274] - INFO: epoch 100:    311 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.564, ntokens=17191.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3211.1, ups=0.19, wpb=17191.7, bsz=1024, num_updates=38970, lr=1.76851e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=260212
2024-11-12 11:02:03 - progress_bar.py[line:274] - INFO: epoch 100:    321 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.539, ntokens=17059.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.81, wps=3163.4, ups=0.19, wpb=17059.5, bsz=1024, num_updates=38980, lr=1.63248e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=260266
2024-11-12 11:02:57 - progress_bar.py[line:274] - INFO: epoch 100:    331 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17189.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.84, wps=3192.4, ups=0.19, wpb=17189.9, bsz=1024, num_updates=38990, lr=1.49644e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=260320
2024-11-12 11:03:51 - progress_bar.py[line:274] - INFO: epoch 100:    341 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.553, ntokens=17218.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.87, wps=3192.3, ups=0.19, wpb=17218.1, bsz=1024, num_updates=39000, lr=1.3604e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=31, gb_free=13.2, wall=260374
2024-11-12 11:04:46 - progress_bar.py[line:274] - INFO: epoch 100:    351 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.52, ntokens=17037.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.73, wps=3104.2, ups=0.18, wpb=17037.7, bsz=1024, num_updates=39010, lr=1.22436e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=260429
2024-11-12 11:05:40 - progress_bar.py[line:274] - INFO: epoch 100:    361 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.545, ntokens=17230.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.83, wps=3184.6, ups=0.18, wpb=17230.2, bsz=1024, num_updates=39020, lr=1.08832e-07, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=260483
2024-11-12 11:06:33 - progress_bar.py[line:274] - INFO: epoch 100:    371 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.571, ntokens=17377.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.94, wps=3285, ups=0.19, wpb=17377.5, bsz=1024, num_updates=39030, lr=9.52277e-08, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=260536
2024-11-12 11:07:25 - progress_bar.py[line:274] - INFO: epoch 100:    381 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.565, ntokens=17329, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=5.92, wps=3338.5, ups=0.19, wpb=17329, bsz=1024, num_updates=39040, lr=8.16238e-08, gnorm=0.001, clip=0, loss_scale=65536, train_wall=30, gb_free=13.1, wall=260588
2024-11-12 11:08:14 - progress_bar.py[line:274] - INFO: epoch 100:    391 / 391 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.59, ntokens=16698.5, nsentences=985.6, sample_size=985.6, sample_size_v1=0, sample_size_v2=0, ppl=6.02, wps=3419.3, ups=0.2, wpb=16698.5, bsz=985.6, num_updates=39050, lr=6.80198e-08, gnorm=0.001, clip=0, loss_scale=65536, train_wall=29, gb_free=13.1, wall=260637
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.ptcp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt

cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
2024-11-12 11:08:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 100 @ 39050 updates
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
2024-11-12 11:08:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt'cannot create regular file './polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-12 11:09:58 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 7 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
2024-11-12 11:11:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 100 @ 39050 updates, score 0) (writing took 216.4796200490091 seconds)
cp ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_manufact_80_uniq_checkpoints/100_5e-5_512/checkpoint_epoch_100.pt
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 6 row count 50000 total row count 400000
slice_id 6 seek offset 300000
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 3 row count 50000 total row count 400000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-12 11:12:46 - train.py[line:336] - INFO: end of epoch 100 (average epoch stats below)
2024-11-12 11:12:46 - progress_bar.py[line:282] - INFO: epoch 100 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.553 | ntokens 17172.1 | nsentences 1023.01 | sample_size 1023.01 | sample_size_v1 0 | sample_size_v2 0 | ppl 5.87 | wps 2647 | ups 0.15 | wpb 17172.1 | bsz 1023 | num_updates 39050 | lr 6.80198e-08 | gnorm 0.001 | clip 0 | loss_scale 65536 | train_wall 1190 | gb_free 13.1 | wall 260909
2024-11-12 11:12:46 - trainer.py[line:639] - INFO: loading train data for epoch 101
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_manufact_bbox_fix/aihub_manufact_train.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-12 11:15:28 - train.py[line:206] - INFO: done training in 260894.9 seconds
