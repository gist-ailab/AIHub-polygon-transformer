/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:46 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-09 06:52:48 - utils.py[line:261] - INFO: Start init
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-09 06:52:48 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 1
single-machine distributed training is initialized.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 5
single-machine distributed training is initialized.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 4
single-machine distributed training is initialized.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 3
single-machine distributed training is initialized.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 7
single-machine distributed training is initialized.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 2
single-machine distributed training is initialized.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 0
single-machine distributed training is initialized.
2024-11-09 06:52:48 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 6
single-machine distributed training is initialized.
2024-11-09 06:52:52 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 16, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 16, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 100, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512', 'restore_file': '../pretrain/polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint.best_score_0.6740.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0005, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=0.1, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=100, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../pretrain/polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint.best_score_0.6740.pt', sample_patch_num=196, save_dir='./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512', save_interval=1, save_interval_updates=500, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,5,6,2,4,3,7', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=500, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco', 'data': '../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv,../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv', 'selected_cols': '0,5,6,2,4,3,7', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 0.1, 'cls_weight': 0.0005, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-09 06:52:52 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-09 06:52:52 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 06:53:03 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-09 06:53:03 - train.py[line:102] - INFO: task: RefcocoTask
2024-11-09 06:53:03 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-09 06:53:03 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-09 06:53:03 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-09 06:53:03 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 2 row count 10034 total row count 80273
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 0 row count 10035 total row count 80273
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 7 row count 10034 total row count 80273file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 6 row count 10034 total row count 80273file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 5 row count 10034 total row count 80273
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 1 row count 10034 total row count 80273


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 3 row count 10034 total row count 80273
2024-11-09 06:53:38 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_val.tsv slice_id 4 row count 10034 total row count 80273
2024-11-09 06:53:40 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-09 06:53:40 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-09 06:53:42 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-09 06:53:42 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-09 06:53:42 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-09 06:53:42 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 16
2024-11-09 06:53:42 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../pretrain/polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint.best_score_0.6740.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 06:53:53 - trainer.py[line:619] - INFO: Loaded checkpoint ../pretrain/polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint.best_score_0.6740.pt (epoch 18 @ 0 updates)
2024-11-09 06:53:53 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 2 seek offset 93612
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 0 seek offset 0
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
2024-11-09 06:56:22 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-09 06:56:22 - train.py[line:297] - INFO: Start iterating over samples
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping





file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
slice_id 4 seek offset 187222
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
Total steps 36600, warmup steps 2196, warmup_factor 0.0004553734061930783
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.08891190362722705 loss_cls: 0.011055405251681805
loss_reg: 0.08830201955016709 loss_cls: 0.009576166048645973
loss_reg: 0.091735569336538 loss_cls: 0.009453251026570797
loss_reg: 0.12858483420975828 loss_cls: 0.0075304387137293816
loss_reg: 0.10047378985033241 loss_cls: 0.011716432869434357
loss_reg: 0.08784111223613815 loss_cls: 0.0088748037815094
loss_reg: 0.10317141601124159 loss_cls: 0.00901105348020792
loss_reg: 0.08135505163959235 loss_cls: 0.010439961217343807
loss_reg: 0.11543984140217775 loss_cls: 0.011524206027388573
loss_reg: 0.09839752109270802 loss_cls: 0.00925560761243105
loss_reg: 0.08273834631270731 loss_cls: 0.009038001298904419
loss_reg: 0.11258425232095969 loss_cls: 0.008463754318654537
loss_reg: 0.10923595323357622 loss_cls: 0.007535538636147976
loss_reg: 0.08649877329341207 loss_cls: 0.009487717412412167
loss_reg: 0.09975440485941045 loss_cls: 0.012124304659664631
loss_reg: 0.09119006682636069 loss_cls: 0.008349967189133167
loss_reg: 0.08617719792549544 loss_cls: 0.010724449530243874
loss_reg: 0.10024328143547219 loss_cls: 0.010767685249447823
loss_reg: 0.08637813469282209 loss_cls: 0.008498371578752995
loss_reg: 0.10359715989633617 loss_cls: 0.010433254763484001
loss_reg: 0.08699358202824523 loss_cls: 0.00689522223547101
loss_reg: 0.1048359772886086 loss_cls: 0.017534982413053513
loss_reg: 0.1449274865458341 loss_cls: 0.010383682325482368
loss_reg: 0.09729642456434168 loss_cls: 0.010808020830154419
loss_reg: 0.10401122628016761 loss_cls: 0.010816733352839947
loss_reg: 0.08360911308003045 loss_cls: 0.010424383915960789
loss_reg: 0.08993146880290526 loss_cls: 0.009825672954320908
loss_reg: 0.11787568609402088 loss_cls: 0.014153353869915009
loss_reg: 0.06715551806817381 loss_cls: 0.009287971071898937
loss_reg: 0.10435441809804484 loss_cls: 0.014591162092983723
loss_reg: 0.0869549596887866 loss_cls: 0.009555201046168804
loss_reg: 0.1084739929650681 loss_cls: 0.009960989467799664
loss_reg: 0.09593331907695178 loss_cls: 0.01025792770087719
loss_reg: 0.08072303256763129 loss_cls: 0.010017714463174343
loss_reg: 0.10351099114516524 loss_cls: 0.00930902548134327
loss_reg: 0.08181827410650092 loss_cls: 0.009166063740849495
loss_reg: 0.05641470441839738 loss_cls: 0.007629192899912596
loss_reg: 0.0973702051423669 loss_cls: 0.009204290807247162
loss_reg: 0.08396546492567432 loss_cls: 0.01269463449716568
loss_reg: 0.09818263376804176 loss_cls: 0.010982275009155273
loss_reg: 0.11803477472889896 loss_cls: 0.0077538155019283295
loss_reg: 0.10391717991853663 loss_cls: 0.01072330866008997
loss_reg: 0.10681780286948282 loss_cls: 0.010882333852350712
loss_reg: 0.10235614976705193 loss_cls: 0.010503223165869713
loss_reg: 0.08649417103871546 loss_cls: 0.009329749271273613
loss_reg: 0.08932860357213439 loss_cls: 0.011575598269701004
loss_reg: 0.12457198295876905 loss_cls: 0.00892939418554306
loss_reg: 0.0826672636997749 loss_cls: 0.010162520222365856
loss_reg: 0.133328816244186 loss_cls: 0.015165966935455799
loss_reg: 0.10145686135547927 loss_cls: 0.007158185355365276
loss_reg: 0.11741667319918284 loss_cls: 0.01057979092001915
loss_reg: 0.07074722652129904 loss_cls: 0.007239147089421749
loss_reg: 0.08120832885318004 loss_cls: 0.0081894900649786
loss_reg: 0.0900305379209163 loss_cls: 0.009836225770413876
loss_reg: 0.07534892346755542 loss_cls: 0.009249445982277393
loss_reg: 0.09498498250223535 loss_cls: 0.008190319873392582
loss_reg: 0.07736939627297616 loss_cls: 0.00904928706586361
loss_reg: 0.10024490916065917 loss_cls: 0.010601348243653774
loss_reg: 0.07145051325669118 loss_cls: 0.0059399656020104885
loss_reg: 0.07976068082641546 loss_cls: 0.010261337272822857
loss_reg: 0.1014461956672995 loss_cls: 0.010210688225924969
loss_reg: 0.08811896294844308 loss_cls: 0.009803757071495056
loss_reg: 0.09531765173621226 loss_cls: 0.01128736324608326
loss_reg: 0.10084006678528594 loss_cls: 0.009341547265648842
2024-11-09 06:57:27 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 366 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=20.102, ntokens=17405.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=1.12513e+06, wps=3200.7, ups=0.18, wpb=17405.4, bsz=1024, num_updates=10, lr=2.27687e-07, gnorm=0.074, clip=0, loss_scale=128, train_wall=44, gb_free=13.3, wall=225
2024-11-09 06:58:20 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 366 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=19.996, ntokens=17297.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=1.04538e+06, wps=3283.5, ups=0.19, wpb=17297.6, bsz=1024, num_updates=20, lr=4.55373e-07, gnorm=0.072, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=278
2024-11-09 06:59:13 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 366 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=19.63, ntokens=17074.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=811476, wps=3227.7, ups=0.19, wpb=17074.8, bsz=1015.4, num_updates=30, lr=6.8306e-07, gnorm=0.062, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=331
2024-11-09 07:00:06 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 366 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=19.145, ntokens=17466.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=579905, wps=3242.8, ups=0.19, wpb=17466.5, bsz=1024, num_updates=40, lr=9.10747e-07, gnorm=0.04, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=385
2024-11-09 07:01:00 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 366 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=17.411, ntokens=17539.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=174301, wps=3262.2, ups=0.19, wpb=17539.3, bsz=1024, num_updates=50, lr=1.13843e-06, gnorm=0.018, clip=0, loss_scale=128, train_wall=31, gb_free=13.1, wall=438
2024-11-09 07:01:54 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=14.618, ntokens=17517.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25137.9, wps=3272.4, ups=0.19, wpb=17517.9, bsz=1024, num_updates=60, lr=1.36612e-06, gnorm=0.009, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=492
2024-11-09 07:02:47 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=11.581, ntokens=17528.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=3062.55, wps=3305.1, ups=0.19, wpb=17528.6, bsz=1024, num_updates=70, lr=1.59381e-06, gnorm=0.008, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=545
2024-11-09 07:03:40 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=9.031, ntokens=17225.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=523.17, wps=3231.4, ups=0.19, wpb=17225.3, bsz=1024, num_updates=80, lr=1.82149e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.6, wall=598
2024-11-09 07:04:33 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=7.492, ntokens=17554.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=180.04, wps=3286.6, ups=0.19, wpb=17554.4, bsz=1024, num_updates=90, lr=2.04918e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=652
2024-11-09 07:05:27 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=6.346, ntokens=17365.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=81.33, wps=3265.2, ups=0.19, wpb=17365.3, bsz=1024, num_updates=100, lr=2.27687e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=705
2024-11-09 07:06:20 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.891, ntokens=17589.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=59.34, wps=3280.1, ups=0.19, wpb=17589.8, bsz=1024, num_updates=110, lr=2.50455e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=32, gb_free=13.2, wall=758
2024-11-09 07:07:14 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.577, ntokens=17627, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=47.72, wps=3305.2, ups=0.19, wpb=17627, bsz=1024, num_updates=120, lr=2.73224e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=812
2024-11-09 07:08:07 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.322, ntokens=17431.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=39.99, wps=3243.4, ups=0.19, wpb=17431.9, bsz=1024, num_updates=130, lr=2.95993e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=866
2024-11-09 07:09:01 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.233, ntokens=17280.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=37.62, wps=3206.6, ups=0.19, wpb=17280.5, bsz=1024, num_updates=140, lr=3.18761e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=919
2024-11-09 07:09:55 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.2, ntokens=17294.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=36.75, wps=3237.5, ups=0.19, wpb=17294.4, bsz=1024, num_updates=150, lr=3.4153e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=973
2024-11-09 07:10:48 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.197, ntokens=17416, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=36.69, wps=3268.4, ups=0.19, wpb=17416, bsz=1024, num_updates=160, lr=3.64299e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1026
2024-11-09 07:11:41 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.167, ntokens=17448.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=35.93, wps=3296.2, ups=0.19, wpb=17448.5, bsz=1024, num_updates=170, lr=3.87067e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1079
2024-11-09 07:12:34 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.17, ntokens=17459.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=35.99, wps=3288.5, ups=0.19, wpb=17459.1, bsz=1024, num_updates=180, lr=4.09836e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1132
2024-11-09 07:13:27 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.088, ntokens=17319.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.01, wps=3275.5, ups=0.19, wpb=17319.2, bsz=1024, num_updates=190, lr=4.32605e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1185
2024-11-09 07:14:20 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.1, ntokens=17396.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=34.3, wps=3275.4, ups=0.19, wpb=17396.1, bsz=1024, num_updates=200, lr=4.55373e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.4, wall=1238
2024-11-09 07:15:13 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.04, ntokens=17392.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=32.9, wps=3257.5, ups=0.19, wpb=17392.1, bsz=1024, num_updates=210, lr=4.78142e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=1292
2024-11-09 07:16:06 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=4.996, ntokens=17271.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=31.92, wps=3259.8, ups=0.19, wpb=17271.7, bsz=1024, num_updates=220, lr=5.00911e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=1345
2024-11-09 07:16:59 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.003, ntokens=17428.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=32.07, wps=3294.4, ups=0.19, wpb=17428.8, bsz=1024, num_updates=230, lr=5.23679e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1397
2024-11-09 07:17:53 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 366 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=5.027, ntokens=17848.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=32.61, wps=3311.7, ups=0.19, wpb=17848.5, bsz=1024, num_updates=240, lr=5.46448e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.3, wall=1451
2024-11-09 07:18:46 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.883, ntokens=17200.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.5, wps=3238.8, ups=0.19, wpb=17200.3, bsz=1024, num_updates=250, lr=5.69217e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1504
2024-11-09 07:19:40 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.915, ntokens=17416.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=30.18, wps=3240.7, ups=0.19, wpb=17416.3, bsz=1024, num_updates=260, lr=5.91985e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1558
2024-11-09 07:20:34 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.859, ntokens=17133.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.02, wps=3170.2, ups=0.19, wpb=17133.2, bsz=1024, num_updates=270, lr=6.14754e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1612
2024-11-09 07:21:28 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.894, ntokens=17418.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.74, wps=3249.8, ups=0.19, wpb=17418.6, bsz=1024, num_updates=280, lr=6.37523e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1666
2024-11-09 07:22:21 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.848, ntokens=17404.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.8, wps=3277.9, ups=0.19, wpb=17404.3, bsz=1024, num_updates=290, lr=6.60291e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1719
2024-11-09 07:23:14 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.825, ntokens=17287.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.35, wps=3262, ups=0.19, wpb=17287.3, bsz=1024, num_updates=300, lr=6.8306e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1772
2024-11-09 07:24:06 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.876, ntokens=17739.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.37, wps=3375.7, ups=0.19, wpb=17739.3, bsz=1024, num_updates=310, lr=7.05829e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1824
2024-11-09 07:24:58 - progress_bar.py[line:274] - INFO: epoch 001:    320 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.89, ntokens=17760.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.66, wps=3406, ups=0.19, wpb=17760.8, bsz=1024, num_updates=320, lr=7.28597e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=1877
2024-11-09 07:25:50 - progress_bar.py[line:274] - INFO: epoch 001:    330 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.808, ntokens=17632.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.02, wps=3388.8, ups=0.19, wpb=17632.1, bsz=1024, num_updates=330, lr=7.51366e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=1929
2024-11-09 07:26:42 - progress_bar.py[line:274] - INFO: epoch 001:    340 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.875, ntokens=17825, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=29.35, wps=3427.7, ups=0.19, wpb=17825, bsz=1024, num_updates=340, lr=7.74135e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=1981
2024-11-09 07:27:34 - progress_bar.py[line:274] - INFO: epoch 001:    350 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.797, ntokens=17545.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.79, wps=3397.1, ups=0.19, wpb=17545.6, bsz=1024, num_updates=350, lr=7.96903e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2032
2024-11-09 07:28:27 - progress_bar.py[line:274] - INFO: epoch 001:    360 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.832, ntokens=17874.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=28.49, wps=3409.7, ups=0.19, wpb=17874.1, bsz=1024, num_updates=360, lr=8.19672e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=31, gb_free=13.5, wall=2085
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt2024-11-09 07:28:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 366 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-09 07:28:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
cp: cp: cp: cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt'cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
: No such file or directory: No such file or directory

cp: cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
cp: cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
cp: cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt': No such file or directory
cp: cannot stat './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt'local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
: No such file or directory
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 07:29:07 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 07:29:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 1 @ 366 updates, score 0) (writing took 22.236207999987528 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_1.pt
2024-11-09 07:29:23 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-09 07:29:23 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 7.627 | ntokens 17447.5 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 197.71 | wps 3240.9 | ups 0.19 | wpb 17447.5 | bsz 1023.1 | num_updates 366 | lr 8.33333e-06 | gnorm 0.01 | clip 0 | loss_scale 128 | train_wall 1135 | gb_free 13.4 | wall 2141
2024-11-09 07:29:23 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442


slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 07:31:55 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-09 07:31:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 07:32:18 - progress_bar.py[line:274] - INFO: epoch 002:      4 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.763, ntokens=17171.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=27.16, wps=741.1, ups=0.04, wpb=17171.5, bsz=998.4, num_updates=370, lr=8.42441e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=13.5, wall=2316
2024-11-09 07:33:10 - progress_bar.py[line:274] - INFO: epoch 002:     14 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.721, ntokens=17276.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.37, wps=3324.1, ups=0.19, wpb=17276.8, bsz=1024, num_updates=380, lr=8.65209e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=2368
2024-11-09 07:34:03 - progress_bar.py[line:274] - INFO: epoch 002:     24 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.787, ntokens=17550.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=27.61, wps=3346.3, ups=0.19, wpb=17550.6, bsz=1024, num_updates=390, lr=8.87978e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.6, wall=2421
2024-11-09 07:34:56 - progress_bar.py[line:274] - INFO: epoch 002:     34 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.7, ntokens=17533, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.99, wps=3305.1, ups=0.19, wpb=17533, bsz=1024, num_updates=400, lr=9.10747e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.2, wall=2474
2024-11-09 07:35:48 - progress_bar.py[line:274] - INFO: epoch 002:     44 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.707, ntokens=17467.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=26.12, wps=3325.7, ups=0.19, wpb=17467.7, bsz=1024, num_updates=410, lr=9.33515e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2526
2024-11-09 07:36:41 - progress_bar.py[line:274] - INFO: epoch 002:     54 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.694, ntokens=17446.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.89, wps=3332.2, ups=0.19, wpb=17446.6, bsz=1024, num_updates=420, lr=9.56284e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.1, wall=2579
2024-11-09 07:37:33 - progress_bar.py[line:274] - INFO: epoch 002:     64 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.666, ntokens=17466.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.39, wps=3340.5, ups=0.19, wpb=17466.1, bsz=1024, num_updates=430, lr=9.79053e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2631
2024-11-09 07:38:26 - progress_bar.py[line:274] - INFO: epoch 002:     74 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.658, ntokens=17551.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.25, wps=3313.8, ups=0.19, wpb=17551.2, bsz=1024, num_updates=440, lr=1.00182e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2684
2024-11-09 07:39:19 - progress_bar.py[line:274] - INFO: epoch 002:     84 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.655, ntokens=17492.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=25.19, wps=3303.3, ups=0.19, wpb=17492.7, bsz=1024, num_updates=450, lr=1.02459e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2737
2024-11-09 07:40:11 - progress_bar.py[line:274] - INFO: epoch 002:     94 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.644, ntokens=17572.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.99, wps=3339.7, ups=0.19, wpb=17572.9, bsz=1024, num_updates=460, lr=1.04736e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.3, wall=2790
2024-11-09 07:41:04 - progress_bar.py[line:274] - INFO: epoch 002:    104 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.623, ntokens=17468.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.65, wps=3307.9, ups=0.19, wpb=17468.7, bsz=1024, num_updates=470, lr=1.07013e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2842
2024-11-09 07:41:57 - progress_bar.py[line:274] - INFO: epoch 002:    114 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.643, ntokens=17672.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.99, wps=3349.2, ups=0.19, wpb=17672.2, bsz=1024, num_updates=480, lr=1.0929e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=2895
2024-11-09 07:42:50 - progress_bar.py[line:274] - INFO: epoch 002:    124 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.588, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=24.06, wps=3310.7, ups=0.19, wpb=17424.2, bsz=1024, num_updates=490, lr=1.11566e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=30, gb_free=13.5, wall=2948
2024-11-09 07:43:42 - progress_bar.py[line:274] - INFO: epoch 002:    134 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.56, ntokens=17313, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.59, wps=3306, ups=0.19, wpb=17313, bsz=1024, num_updates=500, lr=1.13843e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=3000
2024-11-09 07:44:34 - progress_bar.py[line:274] - INFO: epoch 002:    144 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.562, ntokens=17520.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.63, wps=3366, ups=0.19, wpb=17520.1, bsz=1024, num_updates=510, lr=1.1612e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=30, gb_free=13.4, wall=3052
2024-11-09 07:45:27 - progress_bar.py[line:274] - INFO: epoch 002:    154 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.581, ntokens=17647.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=23.94, wps=3341.5, ups=0.19, wpb=17647.7, bsz=1024, num_updates=520, lr=1.18397e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=3105
2024-11-09 07:46:20 - progress_bar.py[line:274] - INFO: epoch 002:    164 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.499, ntokens=17170.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.61, wps=3226.9, ups=0.19, wpb=17170.9, bsz=1024, num_updates=530, lr=1.20674e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3158
2024-11-09 07:47:12 - progress_bar.py[line:274] - INFO: epoch 002:    174 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.522, ntokens=17321.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=22.97, wps=3321.8, ups=0.19, wpb=17321.9, bsz=1015.4, num_updates=540, lr=1.22951e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3210
2024-11-09 07:48:05 - progress_bar.py[line:274] - INFO: epoch 002:    184 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.512, ntokens=17509.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.82, wps=3342.3, ups=0.19, wpb=17509.8, bsz=1024, num_updates=550, lr=1.25228e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.4, wall=3263
2024-11-09 07:48:57 - progress_bar.py[line:274] - INFO: epoch 002:    194 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.471, ntokens=17214.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.18, wps=3265.8, ups=0.19, wpb=17214.3, bsz=1024, num_updates=560, lr=1.27505e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3316
2024-11-09 07:49:50 - progress_bar.py[line:274] - INFO: epoch 002:    204 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.475, ntokens=17416.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.24, wps=3311.7, ups=0.19, wpb=17416.4, bsz=1024, num_updates=570, lr=1.29781e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3368
2024-11-09 07:50:43 - progress_bar.py[line:274] - INFO: epoch 002:    214 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.414, ntokens=17242.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.32, wps=3252.5, ups=0.19, wpb=17242.1, bsz=1024, num_updates=580, lr=1.32058e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.2, wall=3421
2024-11-09 07:51:35 - progress_bar.py[line:274] - INFO: epoch 002:    224 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.479, ntokens=17668.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=22.29, wps=3388, ups=0.19, wpb=17668.7, bsz=1024, num_updates=590, lr=1.34335e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3473
2024-11-09 07:52:27 - progress_bar.py[line:274] - INFO: epoch 002:    234 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.413, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.3, wps=3314.5, ups=0.19, wpb=17372.7, bsz=1024, num_updates=600, lr=1.36612e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=3526
2024-11-09 07:53:20 - progress_bar.py[line:274] - INFO: epoch 002:    244 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.436, ntokens=17427.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.64, wps=3306.1, ups=0.19, wpb=17427.7, bsz=1024, num_updates=610, lr=1.38889e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3578
2024-11-09 07:54:13 - progress_bar.py[line:274] - INFO: epoch 002:    254 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.361, ntokens=17235.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.55, wps=3267.6, ups=0.19, wpb=17235.9, bsz=1024, num_updates=620, lr=1.41166e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=3631
2024-11-09 07:55:05 - progress_bar.py[line:274] - INFO: epoch 002:    264 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.402, ntokens=17311.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=21.14, wps=3312.3, ups=0.19, wpb=17311.6, bsz=1024, num_updates=630, lr=1.43443e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3683
2024-11-09 07:55:58 - progress_bar.py[line:274] - INFO: epoch 002:    274 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.366, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.63, wps=3303.8, ups=0.19, wpb=17400.1, bsz=1024, num_updates=640, lr=1.45719e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.3, wall=3736
2024-11-09 07:56:50 - progress_bar.py[line:274] - INFO: epoch 002:    284 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.322, ntokens=17065.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20, wps=3270.7, ups=0.19, wpb=17065.9, bsz=1024, num_updates=650, lr=1.47996e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=3788
2024-11-09 07:57:43 - progress_bar.py[line:274] - INFO: epoch 002:    294 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.331, ntokens=17271.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.13, wps=3293.3, ups=0.19, wpb=17271.7, bsz=1024, num_updates=660, lr=1.50273e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=31, gb_free=13.6, wall=3841
2024-11-09 07:58:35 - progress_bar.py[line:274] - INFO: epoch 002:    304 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.364, ntokens=17618.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.59, wps=3361.6, ups=0.19, wpb=17618.4, bsz=1024, num_updates=670, lr=1.5255e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=32, gb_free=13.3, wall=3893
2024-11-09 07:59:28 - progress_bar.py[line:274] - INFO: epoch 002:    314 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.284, ntokens=17342.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.48, wps=3287.5, ups=0.19, wpb=17342.4, bsz=1024, num_updates=680, lr=1.54827e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=43, gb_free=13.4, wall=3946
2024-11-09 08:00:20 - progress_bar.py[line:274] - INFO: epoch 002:    324 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.321, ntokens=17701, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.99, wps=3399.2, ups=0.19, wpb=17701, bsz=1024, num_updates=690, lr=1.57104e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=51, gb_free=13.3, wall=3998
2024-11-09 08:01:12 - progress_bar.py[line:274] - INFO: epoch 002:    334 / 366 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=4.339, ntokens=17715.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=20.23, wps=3395.7, ups=0.19, wpb=17715.2, bsz=1024, num_updates=700, lr=1.59381e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=40, gb_free=13.1, wall=4050
2024-11-09 08:02:04 - progress_bar.py[line:274] - INFO: epoch 002:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.31, ntokens=17681.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.83, wps=3385.9, ups=0.19, wpb=17681.7, bsz=1024, num_updates=710, lr=1.61658e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=43, gb_free=13.3, wall=4102
2024-11-09 08:02:56 - progress_bar.py[line:274] - INFO: epoch 002:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.297, ntokens=17555.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.66, wps=3380, ups=0.19, wpb=17555.3, bsz=1024, num_updates=720, lr=1.63934e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=47, gb_free=13.2, wall=4154
2024-11-09 08:03:48 - progress_bar.py[line:274] - INFO: epoch 002:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.257, ntokens=17542, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.12, wps=3362.8, ups=0.19, wpb=17542, bsz=1024, num_updates=730, lr=1.66211e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=50, gb_free=13.4, wall=4206
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 08:03:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 732 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
2024-11-09 08:03:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 08:05:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 08:07:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 2 @ 732 updates, score 0) (writing took 222.27931232203264 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_2.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442

slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-09 08:08:33 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-09 08:08:33 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 4.501 | ntokens 17439 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 22.65 | wps 2715.9 | ups 0.16 | wpb 17439 | bsz 1023.1 | num_updates 732 | lr 1.66667e-05 | gnorm 0.004 | clip 0 | loss_scale 256 | train_wall 1206 | gb_free 13.4 | wall 4491
2024-11-09 08:08:33 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 08:11:01 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-09 08:11:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 08:11:45 - progress_bar.py[line:274] - INFO: epoch 003:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.247, ntokens=17038.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=18.99, wps=357.4, ups=0.02, wpb=17038.7, bsz=998.4, num_updates=740, lr=1.68488e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=32, gb_free=13.5, wall=4683
2024-11-09 08:12:37 - progress_bar.py[line:274] - INFO: epoch 003:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.25, ntokens=17349.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=19.03, wps=3321.1, ups=0.19, wpb=17349.6, bsz=1024, num_updates=750, lr=1.70765e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4735
2024-11-09 08:13:30 - progress_bar.py[line:274] - INFO: epoch 003:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.231, ntokens=17432.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.78, wps=3318.1, ups=0.19, wpb=17432.1, bsz=1024, num_updates=760, lr=1.73042e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=4788
2024-11-09 08:14:23 - progress_bar.py[line:274] - INFO: epoch 003:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.24, ntokens=17425.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.89, wps=3299.1, ups=0.19, wpb=17425.6, bsz=1024, num_updates=770, lr=1.75319e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=4841
2024-11-09 08:15:15 - progress_bar.py[line:274] - INFO: epoch 003:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.19, ntokens=17323.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.25, wps=3294.7, ups=0.19, wpb=17323.7, bsz=1024, num_updates=780, lr=1.77596e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=4893
2024-11-09 08:16:07 - progress_bar.py[line:274] - INFO: epoch 003:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.214, ntokens=17267, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.56, wps=3310.6, ups=0.19, wpb=17267, bsz=1024, num_updates=790, lr=1.79872e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=4946
2024-11-09 08:17:00 - progress_bar.py[line:274] - INFO: epoch 003:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.153, ntokens=17278.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.79, wps=3284.4, ups=0.19, wpb=17278.2, bsz=1024, num_updates=800, lr=1.82149e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=4998
2024-11-09 08:17:52 - progress_bar.py[line:274] - INFO: epoch 003:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.191, ntokens=17289.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=18.27, wps=3326.1, ups=0.19, wpb=17289.6, bsz=1015.4, num_updates=810, lr=1.84426e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5050
2024-11-09 08:18:44 - progress_bar.py[line:274] - INFO: epoch 003:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.206, ntokens=17533.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.46, wps=3352.7, ups=0.19, wpb=17533.4, bsz=1024, num_updates=820, lr=1.86703e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=5102
2024-11-09 08:19:36 - progress_bar.py[line:274] - INFO: epoch 003:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.205, ntokens=17506, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.44, wps=3348.1, ups=0.19, wpb=17506, bsz=1024, num_updates=830, lr=1.8898e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5155
2024-11-09 08:20:29 - progress_bar.py[line:274] - INFO: epoch 003:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.174, ntokens=17445.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=18.06, wps=3316.2, ups=0.19, wpb=17445.1, bsz=1024, num_updates=840, lr=1.91257e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5207
2024-11-09 08:21:21 - progress_bar.py[line:274] - INFO: epoch 003:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.129, ntokens=17343.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.5, wps=3327.2, ups=0.19, wpb=17343.2, bsz=1024, num_updates=850, lr=1.93534e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5259
2024-11-09 08:22:14 - progress_bar.py[line:274] - INFO: epoch 003:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.157, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.84, wps=3250.8, ups=0.19, wpb=17269.4, bsz=1024, num_updates=860, lr=1.95811e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5313
2024-11-09 08:23:07 - progress_bar.py[line:274] - INFO: epoch 003:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.129, ntokens=17251, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.5, wps=3281.6, ups=0.19, wpb=17251, bsz=1024, num_updates=870, lr=1.98087e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5365
2024-11-09 08:23:59 - progress_bar.py[line:274] - INFO: epoch 003:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.133, ntokens=17382.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.55, wps=3328.1, ups=0.19, wpb=17382.5, bsz=1024, num_updates=880, lr=2.00364e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5417
2024-11-09 08:24:52 - progress_bar.py[line:274] - INFO: epoch 003:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.141, ntokens=17525.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.65, wps=3322.8, ups=0.19, wpb=17525.8, bsz=1024, num_updates=890, lr=2.02641e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.1, wall=5470
2024-11-09 08:25:44 - progress_bar.py[line:274] - INFO: epoch 003:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.106, ntokens=17485.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.22, wps=3341.9, ups=0.19, wpb=17485.3, bsz=1024, num_updates=900, lr=2.04918e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=31, gb_free=13.5, wall=5522
2024-11-09 08:26:36 - progress_bar.py[line:274] - INFO: epoch 003:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.13, ntokens=17432.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.51, wps=3334.2, ups=0.19, wpb=17432.2, bsz=1024, num_updates=910, lr=2.07195e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5575
2024-11-09 08:27:30 - progress_bar.py[line:274] - INFO: epoch 003:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.078, ntokens=17009.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.89, wps=3174.5, ups=0.19, wpb=17009.1, bsz=1024, num_updates=920, lr=2.09472e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5628
2024-11-09 08:28:24 - progress_bar.py[line:274] - INFO: epoch 003:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.108, ntokens=17408.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.25, wps=3238.1, ups=0.19, wpb=17408.9, bsz=1024, num_updates=930, lr=2.11749e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5682
2024-11-09 08:29:16 - progress_bar.py[line:274] - INFO: epoch 003:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.098, ntokens=17576.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=17.12, wps=3386.4, ups=0.19, wpb=17576.9, bsz=1024, num_updates=940, lr=2.14026e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5734
2024-11-09 08:30:09 - progress_bar.py[line:274] - INFO: epoch 003:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.085, ntokens=17387.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.97, wps=3290.3, ups=0.19, wpb=17387.5, bsz=1024, num_updates=950, lr=2.16302e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5787
2024-11-09 08:31:02 - progress_bar.py[line:274] - INFO: epoch 003:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.06, ntokens=17293.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.68, wps=3260.4, ups=0.19, wpb=17293.8, bsz=1024, num_updates=960, lr=2.18579e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=5840
2024-11-09 08:31:55 - progress_bar.py[line:274] - INFO: epoch 003:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.071, ntokens=17393, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.81, wps=3249.6, ups=0.19, wpb=17393, bsz=1024, num_updates=970, lr=2.20856e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.3, wall=5893
2024-11-09 08:32:48 - progress_bar.py[line:274] - INFO: epoch 003:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.055, ntokens=17201.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.63, wps=3229.3, ups=0.19, wpb=17201.7, bsz=1024, num_updates=980, lr=2.23133e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=5947
2024-11-09 08:33:41 - progress_bar.py[line:274] - INFO: epoch 003:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.038, ntokens=17274.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.42, wps=3300.8, ups=0.19, wpb=17274.9, bsz=1024, num_updates=990, lr=2.2541e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.6, wall=5999
2024-11-09 08:34:34 - progress_bar.py[line:274] - INFO: epoch 003:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.019, ntokens=17093.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.22, wps=3233.1, ups=0.19, wpb=17093.5, bsz=1024, num_updates=1000, lr=2.27687e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.5, wall=6052
2024-11-09 08:35:26 - progress_bar.py[line:274] - INFO: epoch 003:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.045, ntokens=17373.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.5, wps=3323.4, ups=0.19, wpb=17373.1, bsz=1024, num_updates=1010, lr=2.29964e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=6104
2024-11-09 08:36:19 - progress_bar.py[line:274] - INFO: epoch 003:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.029, ntokens=17298.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.33, wps=3283.1, ups=0.19, wpb=17298.6, bsz=1024, num_updates=1020, lr=2.3224e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=30, gb_free=13.4, wall=6157
2024-11-09 08:37:11 - progress_bar.py[line:274] - INFO: epoch 003:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.051, ntokens=17401.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.58, wps=3330.8, ups=0.19, wpb=17401.7, bsz=1024, num_updates=1030, lr=2.34517e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6209
2024-11-09 08:38:02 - progress_bar.py[line:274] - INFO: epoch 003:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.984, ntokens=17327.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.82, wps=3383.7, ups=0.2, wpb=17327.7, bsz=1024, num_updates=1040, lr=2.36794e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6260
2024-11-09 08:38:54 - progress_bar.py[line:274] - INFO: epoch 003:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.04, ntokens=17740.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.46, wps=3383.5, ups=0.19, wpb=17740.1, bsz=1024, num_updates=1050, lr=2.39071e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6313
2024-11-09 08:39:49 - progress_bar.py[line:274] - INFO: epoch 003:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.043, ntokens=17709.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.49, wps=3220.9, ups=0.18, wpb=17709.5, bsz=1024, num_updates=1060, lr=2.41348e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6368
2024-11-09 08:40:44 - progress_bar.py[line:274] - INFO: epoch 003:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.974, ntokens=17336.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.72, wps=3197.8, ups=0.18, wpb=17336.2, bsz=1024, num_updates=1070, lr=2.43625e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=6422
2024-11-09 08:41:38 - progress_bar.py[line:274] - INFO: epoch 003:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.058, ntokens=17808, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.66, wps=3270.1, ups=0.18, wpb=17808, bsz=1024, num_updates=1080, lr=2.45902e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=6476
2024-11-09 08:42:30 - progress_bar.py[line:274] - INFO: epoch 003:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.044, ntokens=17640.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.49, wps=3373.3, ups=0.19, wpb=17640.3, bsz=1024, num_updates=1090, lr=2.48179e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=6529
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-09 08:43:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 1098 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
2024-11-09 08:43:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 08:45:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 2 seek offset 93612
2024-11-09 08:46:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 3 @ 1098 updates, score 0) (writing took 222.13760666403687 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_3.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 08:47:45 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-09 08:47:45 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 4.11 | ntokens 17384.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 17.27 | wps 2704.9 | ups 0.16 | wpb 17384.7 | bsz 1023.1 | num_updates 1098 | lr 2.5e-05 | gnorm 0.004 | clip 0 | loss_scale 512 | train_wall 1106 | gb_free 13.5 | wall 6844
2024-11-09 08:47:45 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 08:50:18 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-09 08:50:18 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 08:50:31 - progress_bar.py[line:274] - INFO: epoch 004:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.98, ntokens=17054.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=15.78, wps=355.2, ups=0.02, wpb=17054.8, bsz=998.4, num_updates=1100, lr=2.50455e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=29, gb_free=13.4, wall=7009
2024-11-09 08:51:23 - progress_bar.py[line:274] - INFO: epoch 004:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.979, ntokens=17260.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.76, wps=3306.8, ups=0.19, wpb=17260.2, bsz=1024, num_updates=1110, lr=2.52732e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.5, wall=7061
2024-11-09 08:52:15 - progress_bar.py[line:274] - INFO: epoch 004:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.05, ntokens=17719.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.56, wps=3362.2, ups=0.19, wpb=17719.6, bsz=1024, num_updates=1120, lr=2.55009e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7114
2024-11-09 08:53:08 - progress_bar.py[line:274] - INFO: epoch 004:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.979, ntokens=17328.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.77, wps=3284.6, ups=0.19, wpb=17328.8, bsz=1024, num_updates=1130, lr=2.57286e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7166
2024-11-09 08:54:00 - progress_bar.py[line:274] - INFO: epoch 004:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.979, ntokens=17540.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.77, wps=3361.9, ups=0.19, wpb=17540.2, bsz=1024, num_updates=1140, lr=2.59563e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7219
2024-11-09 08:54:53 - progress_bar.py[line:274] - INFO: epoch 004:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4, ntokens=17241, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16, wps=3293.7, ups=0.19, wpb=17241, bsz=1024, num_updates=1150, lr=2.6184e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7271
2024-11-09 08:55:45 - progress_bar.py[line:274] - INFO: epoch 004:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.93, ntokens=17289.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.24, wps=3291.1, ups=0.19, wpb=17289.1, bsz=1024, num_updates=1160, lr=2.64117e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7324
2024-11-09 08:56:38 - progress_bar.py[line:274] - INFO: epoch 004:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.958, ntokens=17301.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.54, wps=3303.4, ups=0.19, wpb=17301.2, bsz=1024, num_updates=1170, lr=2.66393e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7376
2024-11-09 08:57:31 - progress_bar.py[line:274] - INFO: epoch 004:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.953, ntokens=17497.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.49, wps=3304.5, ups=0.19, wpb=17497.2, bsz=1024, num_updates=1180, lr=2.6867e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7429
2024-11-09 08:58:23 - progress_bar.py[line:274] - INFO: epoch 004:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=4.012, ntokens=17667.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=16.14, wps=3361.6, ups=0.19, wpb=17667.4, bsz=1024, num_updates=1190, lr=2.70947e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7481
2024-11-09 08:59:16 - progress_bar.py[line:274] - INFO: epoch 004:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.928, ntokens=17358.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.23, wps=3287.7, ups=0.19, wpb=17358.1, bsz=1024, num_updates=1200, lr=2.73224e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7534
2024-11-09 09:00:09 - progress_bar.py[line:274] - INFO: epoch 004:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.992, ntokens=17615, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.91, wps=3341.6, ups=0.19, wpb=17615, bsz=1024, num_updates=1210, lr=2.75501e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7587
2024-11-09 09:01:01 - progress_bar.py[line:274] - INFO: epoch 004:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.966, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.62, wps=3309.5, ups=0.19, wpb=17422.9, bsz=1024, num_updates=1220, lr=2.77778e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7640
2024-11-09 09:01:54 - progress_bar.py[line:274] - INFO: epoch 004:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.937, ntokens=17386.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.32, wps=3318.5, ups=0.19, wpb=17386.4, bsz=1024, num_updates=1230, lr=2.80055e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7692
2024-11-09 09:02:47 - progress_bar.py[line:274] - INFO: epoch 004:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.938, ntokens=17358.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.32, wps=3287.5, ups=0.19, wpb=17358.5, bsz=1024, num_updates=1240, lr=2.82332e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7745
2024-11-09 09:03:40 - progress_bar.py[line:274] - INFO: epoch 004:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.926, ntokens=17250.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.2, wps=3255.1, ups=0.19, wpb=17250.8, bsz=1024, num_updates=1250, lr=2.84608e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7798
2024-11-09 09:04:33 - progress_bar.py[line:274] - INFO: epoch 004:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.949, ntokens=17313.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.44, wps=3247.6, ups=0.19, wpb=17313.2, bsz=1024, num_updates=1260, lr=2.86885e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=7851
2024-11-09 09:05:26 - progress_bar.py[line:274] - INFO: epoch 004:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.924, ntokens=17526.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.17, wps=3297.9, ups=0.19, wpb=17526.1, bsz=1024, num_updates=1270, lr=2.89162e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=7904
2024-11-09 09:06:19 - progress_bar.py[line:274] - INFO: epoch 004:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.93, ntokens=17366.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.25, wps=3283.6, ups=0.19, wpb=17366.7, bsz=1024, num_updates=1280, lr=2.91439e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=7957
2024-11-09 09:07:11 - progress_bar.py[line:274] - INFO: epoch 004:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.961, ntokens=17359.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=15.57, wps=3333.2, ups=0.19, wpb=17359.6, bsz=1015.4, num_updates=1290, lr=2.93716e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8009
2024-11-09 09:08:03 - progress_bar.py[line:274] - INFO: epoch 004:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.929, ntokens=17534.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.23, wps=3337.5, ups=0.19, wpb=17534.9, bsz=1024, num_updates=1300, lr=2.95993e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8062
2024-11-09 09:08:56 - progress_bar.py[line:274] - INFO: epoch 004:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.892, ntokens=17246.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.85, wps=3283.6, ups=0.19, wpb=17246.5, bsz=1024, num_updates=1310, lr=2.9827e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8114
2024-11-09 09:09:49 - progress_bar.py[line:274] - INFO: epoch 004:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.921, ntokens=17481.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.14, wps=3325.5, ups=0.19, wpb=17481.2, bsz=1024, num_updates=1320, lr=3.00546e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8167
2024-11-09 09:10:41 - progress_bar.py[line:274] - INFO: epoch 004:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.902, ntokens=17414, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.95, wps=3309, ups=0.19, wpb=17414, bsz=1024, num_updates=1330, lr=3.02823e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8219
2024-11-09 09:11:34 - progress_bar.py[line:274] - INFO: epoch 004:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.95, ntokens=17615.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.46, wps=3345.2, ups=0.19, wpb=17615.2, bsz=1024, num_updates=1340, lr=3.051e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.1, wall=8272
2024-11-09 09:12:26 - progress_bar.py[line:274] - INFO: epoch 004:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.878, ntokens=17118.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.7, wps=3254.7, ups=0.19, wpb=17118.3, bsz=1024, num_updates=1350, lr=3.07377e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8325
2024-11-09 09:13:20 - progress_bar.py[line:274] - INFO: epoch 004:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.91, ntokens=17490.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=15.04, wps=3296.9, ups=0.19, wpb=17490.3, bsz=1024, num_updates=1360, lr=3.09654e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8378
2024-11-09 09:14:13 - progress_bar.py[line:274] - INFO: epoch 004:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.901, ntokens=17425.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.94, wps=3280.7, ups=0.19, wpb=17425.7, bsz=1024, num_updates=1370, lr=3.11931e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.2, wall=8431
2024-11-09 09:15:06 - progress_bar.py[line:274] - INFO: epoch 004:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.873, ntokens=17250.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.65, wps=3256.9, ups=0.19, wpb=17250.5, bsz=1024, num_updates=1380, lr=3.14208e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8484
2024-11-09 09:15:58 - progress_bar.py[line:274] - INFO: epoch 004:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.887, ntokens=17360.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.79, wps=3338.4, ups=0.19, wpb=17360.6, bsz=1024, num_updates=1390, lr=3.16485e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8536
2024-11-09 09:16:50 - progress_bar.py[line:274] - INFO: epoch 004:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.829, ntokens=17209, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.21, wps=3299.1, ups=0.19, wpb=17209, bsz=1024, num_updates=1400, lr=3.18761e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=8588
2024-11-09 09:17:41 - progress_bar.py[line:274] - INFO: epoch 004:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.873, ntokens=17523.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.65, wps=3408.1, ups=0.19, wpb=17523.7, bsz=1024, num_updates=1410, lr=3.21038e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=31, gb_free=13.4, wall=8639
2024-11-09 09:18:33 - progress_bar.py[line:274] - INFO: epoch 004:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.855, ntokens=17427.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.47, wps=3392.8, ups=0.19, wpb=17427.5, bsz=1024, num_updates=1420, lr=3.23315e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8691
2024-11-09 09:19:25 - progress_bar.py[line:274] - INFO: epoch 004:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.83, ntokens=17341.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.22, wps=3335.1, ups=0.19, wpb=17341.7, bsz=1024, num_updates=1430, lr=3.25592e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8743
2024-11-09 09:20:17 - progress_bar.py[line:274] - INFO: epoch 004:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.819, ntokens=17348.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.11, wps=3318.8, ups=0.19, wpb=17348.6, bsz=1024, num_updates=1440, lr=3.27869e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.5, wall=8795
2024-11-09 09:21:08 - progress_bar.py[line:274] - INFO: epoch 004:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.866, ntokens=17533.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.58, wps=3409.1, ups=0.19, wpb=17533.2, bsz=1024, num_updates=1450, lr=3.30146e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.3, wall=8846
2024-11-09 09:22:00 - progress_bar.py[line:274] - INFO: epoch 004:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.88, ntokens=17584.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.72, wps=3401.9, ups=0.19, wpb=17584.7, bsz=1024, num_updates=1460, lr=3.32423e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=8898
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 09:22:18 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1464 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
2024-11-09 09:22:18 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 09:24:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-09 09:25:59 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 4 @ 1464 updates, score 0) (writing took 220.99298945895862 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_4.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-09 09:26:54 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-09 09:26:54 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.925 | ntokens 17403.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 15.19 | wps 2712.5 | ups 0.16 | wpb 17403.2 | bsz 1023.1 | num_updates 1464 | lr 3.33333e-05 | gnorm 0.005 | clip 0 | loss_scale 512 | train_wall 1107 | gb_free 13.5 | wall 9192
2024-11-09 09:26:54 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 09:29:22 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-09 09:29:22 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 09:29:55 - progress_bar.py[line:274] - INFO: epoch 005:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.871, ntokens=16921.7, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=14.64, wps=356.3, ups=0.02, wpb=16921.7, bsz=989.8, num_updates=1470, lr=3.34699e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=29, gb_free=13.5, wall=9373
2024-11-09 09:30:47 - progress_bar.py[line:274] - INFO: epoch 005:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.89, ntokens=17498.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.82, wps=3331.8, ups=0.19, wpb=17498.9, bsz=1024, num_updates=1480, lr=3.36976e-05, gnorm=0.008, clip=0, loss_scale=512, train_wall=30, gb_free=13.6, wall=9426
2024-11-09 09:31:40 - progress_bar.py[line:274] - INFO: epoch 005:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.825, ntokens=17281.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.18, wps=3313.5, ups=0.19, wpb=17281.5, bsz=1024, num_updates=1490, lr=3.39253e-05, gnorm=0.007, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9478
2024-11-09 09:32:32 - progress_bar.py[line:274] - INFO: epoch 005:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.823, ntokens=17268.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.16, wps=3294, ups=0.19, wpb=17268.4, bsz=1024, num_updates=1500, lr=3.4153e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9530
2024-11-09 09:33:25 - progress_bar.py[line:274] - INFO: epoch 005:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.844, ntokens=17476.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.36, wps=3309.3, ups=0.19, wpb=17476.7, bsz=1024, num_updates=1510, lr=3.43807e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9583
2024-11-09 09:34:18 - progress_bar.py[line:274] - INFO: epoch 005:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.865, ntokens=17560, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.57, wps=3314.8, ups=0.19, wpb=17560, bsz=1024, num_updates=1520, lr=3.46084e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=30, gb_free=13.4, wall=9636
2024-11-09 09:35:10 - progress_bar.py[line:274] - INFO: epoch 005:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.863, ntokens=17576.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.56, wps=3362.7, ups=0.19, wpb=17576.3, bsz=1024, num_updates=1530, lr=3.48361e-05, gnorm=0.006, clip=0, loss_scale=512, train_wall=31, gb_free=13.3, wall=9688
2024-11-09 09:36:03 - progress_bar.py[line:274] - INFO: epoch 005:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.8, ntokens=17231.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.93, wps=3270.6, ups=0.19, wpb=17231.9, bsz=1024, num_updates=1540, lr=3.50638e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=9741
2024-11-09 09:36:55 - progress_bar.py[line:274] - INFO: epoch 005:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.859, ntokens=17724.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.51, wps=3410.6, ups=0.19, wpb=17724.9, bsz=1024, num_updates=1550, lr=3.52914e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=9793
2024-11-09 09:37:47 - progress_bar.py[line:274] - INFO: epoch 005:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.857, ntokens=17588.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.49, wps=3351.6, ups=0.19, wpb=17588.8, bsz=1024, num_updates=1560, lr=3.55191e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=9845
2024-11-09 09:38:40 - progress_bar.py[line:274] - INFO: epoch 005:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.837, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.29, wps=3302.1, ups=0.19, wpb=17400.1, bsz=1024, num_updates=1570, lr=3.57468e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=9898
2024-11-09 09:39:32 - progress_bar.py[line:274] - INFO: epoch 005:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.836, ntokens=17530.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.28, wps=3355.8, ups=0.19, wpb=17530.2, bsz=1024, num_updates=1580, lr=3.59745e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=9950
2024-11-09 09:40:24 - progress_bar.py[line:274] - INFO: epoch 005:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.866, ntokens=17566.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.58, wps=3375.8, ups=0.19, wpb=17566.6, bsz=1024, num_updates=1590, lr=3.62022e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10002
2024-11-09 09:41:17 - progress_bar.py[line:274] - INFO: epoch 005:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.807, ntokens=17491.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14, wps=3338.3, ups=0.19, wpb=17491.2, bsz=1024, num_updates=1600, lr=3.64299e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10055
2024-11-09 09:42:09 - progress_bar.py[line:274] - INFO: epoch 005:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.831, ntokens=17519.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.23, wps=3353.7, ups=0.19, wpb=17519.6, bsz=1024, num_updates=1610, lr=3.66576e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10107
2024-11-09 09:43:01 - progress_bar.py[line:274] - INFO: epoch 005:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.777, ntokens=17190.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.71, wps=3280.3, ups=0.19, wpb=17190.7, bsz=1024, num_updates=1620, lr=3.68852e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10159
2024-11-09 09:43:54 - progress_bar.py[line:274] - INFO: epoch 005:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.782, ntokens=17237, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.75, wps=3274.3, ups=0.19, wpb=17237, bsz=1024, num_updates=1630, lr=3.71129e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.2, wall=10212
2024-11-09 09:44:46 - progress_bar.py[line:274] - INFO: epoch 005:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=17229.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.63, wps=3271.7, ups=0.19, wpb=17229.3, bsz=1024, num_updates=1640, lr=3.73406e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10265
2024-11-09 09:45:39 - progress_bar.py[line:274] - INFO: epoch 005:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.792, ntokens=17279.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.85, wps=3299.8, ups=0.19, wpb=17279.5, bsz=1024, num_updates=1650, lr=3.75683e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10317
2024-11-09 09:46:31 - progress_bar.py[line:274] - INFO: epoch 005:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.816, ntokens=17347.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.09, wps=3330.7, ups=0.19, wpb=17347.6, bsz=1024, num_updates=1660, lr=3.7796e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=10369
2024-11-09 09:47:23 - progress_bar.py[line:274] - INFO: epoch 005:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.753, ntokens=17330.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.48, wps=3301.7, ups=0.19, wpb=17330.9, bsz=1024, num_updates=1670, lr=3.80237e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13, wall=10422
2024-11-09 09:48:16 - progress_bar.py[line:274] - INFO: epoch 005:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.78, ntokens=17372, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.74, wps=3283.2, ups=0.19, wpb=17372, bsz=1024, num_updates=1680, lr=3.82514e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=10475
2024-11-09 09:49:09 - progress_bar.py[line:274] - INFO: epoch 005:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.779, ntokens=17506, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.73, wps=3355.7, ups=0.19, wpb=17506, bsz=1024, num_updates=1690, lr=3.84791e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10527
2024-11-09 09:50:01 - progress_bar.py[line:274] - INFO: epoch 005:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.818, ntokens=17475.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=14.11, wps=3322, ups=0.19, wpb=17475.1, bsz=1024, num_updates=1700, lr=3.87067e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10579
2024-11-09 09:50:53 - progress_bar.py[line:274] - INFO: epoch 005:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.766, ntokens=17306, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.61, wps=3315.8, ups=0.19, wpb=17306, bsz=1024, num_updates=1710, lr=3.89344e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10632
2024-11-09 09:51:46 - progress_bar.py[line:274] - INFO: epoch 005:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.76, ntokens=17232.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.54, wps=3267.7, ups=0.19, wpb=17232.7, bsz=1024, num_updates=1720, lr=3.91621e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10684
2024-11-09 09:52:39 - progress_bar.py[line:274] - INFO: epoch 005:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.772, ntokens=17336.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.66, wps=3277.8, ups=0.19, wpb=17336.4, bsz=1024, num_updates=1730, lr=3.93898e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10737
2024-11-09 09:53:32 - progress_bar.py[line:274] - INFO: epoch 005:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=17328.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=3294.4, ups=0.19, wpb=17328.9, bsz=1024, num_updates=1740, lr=3.96175e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10790
2024-11-09 09:54:24 - progress_bar.py[line:274] - INFO: epoch 005:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.766, ntokens=17206, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.6, wps=3302.4, ups=0.19, wpb=17206, bsz=1024, num_updates=1750, lr=3.98452e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=31, gb_free=13.5, wall=10842
2024-11-09 09:55:16 - progress_bar.py[line:274] - INFO: epoch 005:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.765, ntokens=17473.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.59, wps=3343.6, ups=0.19, wpb=17473.1, bsz=1024, num_updates=1760, lr=4.00729e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=10894
2024-11-09 09:56:07 - progress_bar.py[line:274] - INFO: epoch 005:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.738, ntokens=17505.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.34, wps=3399.8, ups=0.19, wpb=17505.9, bsz=1024, num_updates=1770, lr=4.03005e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10946
2024-11-09 09:56:59 - progress_bar.py[line:274] - INFO: epoch 005:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.786, ntokens=17692.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.79, wps=3458.6, ups=0.2, wpb=17692.6, bsz=1024, num_updates=1780, lr=4.05282e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=10997
2024-11-09 09:57:51 - progress_bar.py[line:274] - INFO: epoch 005:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.75, ntokens=17691.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.45, wps=3398.7, ups=0.19, wpb=17691.5, bsz=1024, num_updates=1790, lr=4.07559e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11049
2024-11-09 09:58:43 - progress_bar.py[line:274] - INFO: epoch 005:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.736, ntokens=17422.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.32, wps=3346.8, ups=0.19, wpb=17422.2, bsz=1024, num_updates=1800, lr=4.09836e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=39, gb_free=13.2, wall=11101
2024-11-09 09:59:34 - progress_bar.py[line:274] - INFO: epoch 005:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=17643.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.84, wps=3407.7, ups=0.19, wpb=17643.8, bsz=1024, num_updates=1810, lr=4.12113e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=41, gb_free=13.3, wall=11153
2024-11-09 10:00:26 - progress_bar.py[line:274] - INFO: epoch 005:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=17689.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.62, wps=3421.2, ups=0.19, wpb=17689.5, bsz=1024, num_updates=1820, lr=4.1439e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=48, gb_free=13.2, wall=11204
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 10:01:16 - progress_bar.py[line:274] - INFO: epoch 005:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.702, ntokens=16890.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=13.02, wps=3417.9, ups=0.2, wpb=16890.1, bsz=998.4, num_updates=1830, lr=4.16667e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=49, gb_free=13.5, wall=11254
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt2024-11-09 10:01:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1830 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt


2024-11-09 10:01:16 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 10:03:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
2024-11-09 10:04:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 5 @ 1830 updates, score 0) (writing took 221.71508579398505 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_5.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442


slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 10:05:52 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-09 10:05:52 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.799 | ntokens 17413.3 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.92 | wps 2725.7 | ups 0.16 | wpb 17413.3 | bsz 1023.1 | num_updates 1830 | lr 4.16667e-05 | gnorm 0.006 | clip 0 | loss_scale 1024 | train_wall 1163 | gb_free 13.5 | wall 11530
2024-11-09 10:05:52 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 10:08:19 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-09 10:08:19 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 10:09:14 - progress_bar.py[line:274] - INFO: epoch 006:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=17296.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=361.7, ups=0.02, wpb=17296.5, bsz=1024, num_updates=1840, lr=4.18944e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.2, wall=11732
2024-11-09 10:10:06 - progress_bar.py[line:274] - INFO: epoch 006:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.724, ntokens=17399.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.21, wps=3315.7, ups=0.19, wpb=17399.4, bsz=1024, num_updates=1850, lr=4.2122e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11784
2024-11-09 10:10:59 - progress_bar.py[line:274] - INFO: epoch 006:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.677, ntokens=17116, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.79, wps=3243, ups=0.19, wpb=17116, bsz=1024, num_updates=1860, lr=4.23497e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=11837
2024-11-09 10:11:51 - progress_bar.py[line:274] - INFO: epoch 006:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.754, ntokens=17727.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.49, wps=3383.3, ups=0.19, wpb=17727.4, bsz=1024, num_updates=1870, lr=4.25774e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11890
2024-11-09 10:12:44 - progress_bar.py[line:274] - INFO: epoch 006:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.732, ntokens=17271.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.29, wps=3273.6, ups=0.19, wpb=17271.3, bsz=1024, num_updates=1880, lr=4.28051e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.3, wall=11942
2024-11-09 10:13:37 - progress_bar.py[line:274] - INFO: epoch 006:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.681, ntokens=17184.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.83, wps=3265.8, ups=0.19, wpb=17184.8, bsz=1024, num_updates=1890, lr=4.30328e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=30, gb_free=13.4, wall=11995
2024-11-09 10:14:31 - progress_bar.py[line:274] - INFO: epoch 006:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.682, ntokens=17293.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.84, wps=3196.4, ups=0.18, wpb=17293.5, bsz=1024, num_updates=1900, lr=4.32605e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=38, gb_free=13.5, wall=12049
2024-11-09 10:15:24 - progress_bar.py[line:274] - INFO: epoch 006:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.676, ntokens=17348.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=3288.5, ups=0.19, wpb=17348.1, bsz=1024, num_updates=1910, lr=4.34882e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=51, gb_free=13.4, wall=12102
2024-11-09 10:16:19 - progress_bar.py[line:274] - INFO: epoch 006:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.722, ntokens=17448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.19, wps=3162.7, ups=0.18, wpb=17448.4, bsz=1024, num_updates=1920, lr=4.37158e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=51, gb_free=13.3, wall=12157
2024-11-09 10:17:12 - progress_bar.py[line:274] - INFO: epoch 006:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.69, ntokens=17190.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.91, wps=3244.5, ups=0.19, wpb=17190.8, bsz=1024, num_updates=1930, lr=4.39435e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=49, gb_free=13.5, wall=12210
2024-11-09 10:18:05 - progress_bar.py[line:274] - INFO: epoch 006:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.709, ntokens=17553.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.08, wps=3317.9, ups=0.19, wpb=17553.6, bsz=1024, num_updates=1940, lr=4.41712e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=51, gb_free=13.5, wall=12263
2024-11-09 10:18:58 - progress_bar.py[line:274] - INFO: epoch 006:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.689, ntokens=17262.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.9, wps=3218.5, ups=0.19, wpb=17262.8, bsz=1024, num_updates=1950, lr=4.43989e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=50, gb_free=13.4, wall=12317
2024-11-09 10:19:51 - progress_bar.py[line:274] - INFO: epoch 006:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.645, ntokens=17154.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.51, wps=3239.1, ups=0.19, wpb=17154.7, bsz=1024, num_updates=1960, lr=4.46266e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=53, gb_free=13.4, wall=12369
2024-11-09 10:20:45 - progress_bar.py[line:274] - INFO: epoch 006:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.683, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.85, wps=3240.8, ups=0.19, wpb=17370.2, bsz=1024, num_updates=1970, lr=4.48543e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=45, gb_free=13.3, wall=12423
2024-11-09 10:21:40 - progress_bar.py[line:274] - INFO: epoch 006:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.75, ntokens=17658.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=3219.7, ups=0.18, wpb=17658.6, bsz=1024, num_updates=1980, lr=4.5082e-05, gnorm=0.007, clip=0, loss_scale=1024, train_wall=45, gb_free=13.5, wall=12478
2024-11-09 10:22:35 - progress_bar.py[line:274] - INFO: epoch 006:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.664, ntokens=17308.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=3153.9, ups=0.18, wpb=17308.1, bsz=1024, num_updates=1990, lr=4.53097e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=45, gb_free=13.4, wall=12533
2024-11-09 10:23:30 - progress_bar.py[line:274] - INFO: epoch 006:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.677, ntokens=17328.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.79, wps=3126.4, ups=0.18, wpb=17328.9, bsz=1024, num_updates=2000, lr=4.55373e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=52, gb_free=13.4, wall=12588
2024-11-09 10:24:25 - progress_bar.py[line:274] - INFO: epoch 006:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.686, ntokens=17558.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.87, wps=3208, ups=0.18, wpb=17558.6, bsz=1024, num_updates=2010, lr=4.5765e-05, gnorm=0.008, clip=0, loss_scale=1024, train_wall=55, gb_free=13.4, wall=12643
2024-11-09 10:25:16 - progress_bar.py[line:274] - INFO: epoch 006:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.633, ntokens=17041.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.41, wps=3324.5, ups=0.2, wpb=17041.3, bsz=1024, num_updates=2020, lr=4.59927e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=46, gb_free=13.4, wall=12694
2024-11-09 10:26:07 - progress_bar.py[line:274] - INFO: epoch 006:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.738, ntokens=17790, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=13.35, wps=3462.2, ups=0.19, wpb=17790, bsz=1024, num_updates=2030, lr=4.62204e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=37, gb_free=13.3, wall=12746
2024-11-09 10:27:00 - progress_bar.py[line:274] - INFO: epoch 006:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.647, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.53, wps=3275.5, ups=0.19, wpb=17268.7, bsz=1024, num_updates=2040, lr=4.64481e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=30, gb_free=13.5, wall=12798
2024-11-09 10:27:53 - progress_bar.py[line:274] - INFO: epoch 006:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.648, ntokens=17333.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=12.54, wps=3291.4, ups=0.19, wpb=17333.4, bsz=1015.4, num_updates=2050, lr=4.66758e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=12851
2024-11-09 10:28:46 - progress_bar.py[line:274] - INFO: epoch 006:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=17262.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3234.1, ups=0.19, wpb=17262.7, bsz=1024, num_updates=2060, lr=4.69035e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=35, gb_free=13.4, wall=12904
2024-11-09 10:29:40 - progress_bar.py[line:274] - INFO: epoch 006:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.673, ntokens=17390.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.75, wps=3222.9, ups=0.19, wpb=17390.1, bsz=1024, num_updates=2070, lr=4.71311e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=50, gb_free=13.4, wall=12958
2024-11-09 10:30:35 - progress_bar.py[line:274] - INFO: epoch 006:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.689, ntokens=17466.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.89, wps=3205, ups=0.18, wpb=17466.8, bsz=1024, num_updates=2080, lr=4.73588e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=54, gb_free=13.3, wall=13013
2024-11-09 10:31:26 - progress_bar.py[line:274] - INFO: epoch 006:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.684, ntokens=17636.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.85, wps=3401.8, ups=0.19, wpb=17636.8, bsz=1024, num_updates=2090, lr=4.75865e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=13065
2024-11-09 10:32:18 - progress_bar.py[line:274] - INFO: epoch 006:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=17086.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.14, wps=3312.8, ups=0.19, wpb=17086.4, bsz=1024, num_updates=2100, lr=4.78142e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=51, gb_free=13.4, wall=13116
2024-11-09 10:33:10 - progress_bar.py[line:274] - INFO: epoch 006:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.658, ntokens=17394.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.63, wps=3320.6, ups=0.19, wpb=17394.3, bsz=1024, num_updates=2110, lr=4.80419e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=51, gb_free=13.5, wall=13169
2024-11-09 10:34:02 - progress_bar.py[line:274] - INFO: epoch 006:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.629, ntokens=17347.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.37, wps=3334, ups=0.19, wpb=17347.3, bsz=1024, num_updates=2120, lr=4.82696e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=50, gb_free=13.4, wall=13221
2024-11-09 10:34:55 - progress_bar.py[line:274] - INFO: epoch 006:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.607, ntokens=17295.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.19, wps=3307.3, ups=0.19, wpb=17295.2, bsz=1024, num_updates=2130, lr=4.84973e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=46, gb_free=13.5, wall=13273
2024-11-09 10:35:47 - progress_bar.py[line:274] - INFO: epoch 006:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.613, ntokens=17566, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.23, wps=3380.8, ups=0.19, wpb=17566, bsz=1024, num_updates=2140, lr=4.8725e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=43, gb_free=13.2, wall=13325
2024-11-09 10:36:39 - progress_bar.py[line:274] - INFO: epoch 006:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.689, ntokens=17882.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.9, wps=3422.4, ups=0.19, wpb=17882.8, bsz=1024, num_updates=2150, lr=4.89526e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=50, gb_free=13.5, wall=13377
2024-11-09 10:37:31 - progress_bar.py[line:274] - INFO: epoch 006:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=17495.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=3362.8, ups=0.19, wpb=17495.3, bsz=1024, num_updates=2160, lr=4.91803e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=13429
2024-11-09 10:38:23 - progress_bar.py[line:274] - INFO: epoch 006:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=17503.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3379.5, ups=0.19, wpb=17503.6, bsz=1024, num_updates=2170, lr=4.9408e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=13481
2024-11-09 10:39:15 - progress_bar.py[line:274] - INFO: epoch 006:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.612, ntokens=17616, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.23, wps=3391.8, ups=0.19, wpb=17616, bsz=1024, num_updates=2180, lr=4.96357e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=52, gb_free=13.4, wall=13533
2024-11-09 10:40:07 - progress_bar.py[line:274] - INFO: epoch 006:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=17454.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=3330.7, ups=0.19, wpb=17454.3, bsz=1024, num_updates=2190, lr=4.98634e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=13585
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 10:40:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 2196 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
2024-11-09 10:40:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 10:42:23 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 10:44:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 6 @ 2196 updates, score 0) (writing took 218.98193048901157 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_6.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442


slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 10:45:09 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-09 10:45:09 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.67 | ntokens 17387.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.73 | wps 2699.3 | ups 0.16 | wpb 17387.7 | bsz 1023.1 | num_updates 2196 | lr 5e-05 | gnorm 0.007 | clip 0 | loss_scale 2048 | train_wall 1629 | gb_free 13.3 | wall 13888
2024-11-09 10:45:09 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 10:47:42 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-09 10:47:42 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 10:48:05 - progress_bar.py[line:274] - INFO: epoch 007:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=16976.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=355.2, ups=0.02, wpb=16976.3, bsz=998.4, num_updates=2200, lr=4.99942e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=41, gb_free=13.5, wall=14063
2024-11-09 10:48:58 - progress_bar.py[line:274] - INFO: epoch 007:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=17358.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.08, wps=3299.2, ups=0.19, wpb=17358.1, bsz=1024, num_updates=2210, lr=4.99797e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14116
2024-11-09 10:49:50 - progress_bar.py[line:274] - INFO: epoch 007:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.615, ntokens=17580.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.25, wps=3332.6, ups=0.19, wpb=17580.5, bsz=1024, num_updates=2220, lr=4.99651e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14169
2024-11-09 10:50:43 - progress_bar.py[line:274] - INFO: epoch 007:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.584, ntokens=17434, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.99, wps=3306.7, ups=0.19, wpb=17434, bsz=1024, num_updates=2230, lr=4.99506e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=30, gb_free=13.2, wall=14221
2024-11-09 10:51:36 - progress_bar.py[line:274] - INFO: epoch 007:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=17378.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=3312.4, ups=0.19, wpb=17378.9, bsz=1024, num_updates=2240, lr=4.99361e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14274
2024-11-09 10:52:29 - progress_bar.py[line:274] - INFO: epoch 007:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=17446.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=3272.2, ups=0.19, wpb=17446.3, bsz=1024, num_updates=2250, lr=4.99215e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=30, gb_free=13.1, wall=14327
2024-11-09 10:53:21 - progress_bar.py[line:274] - INFO: epoch 007:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.582, ntokens=17412.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.97, wps=3325.2, ups=0.19, wpb=17412.6, bsz=1024, num_updates=2260, lr=4.9907e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=30, gb_free=13.5, wall=14380
2024-11-09 10:54:15 - progress_bar.py[line:274] - INFO: epoch 007:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.577, ntokens=17376.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3265.3, ups=0.19, wpb=17376.3, bsz=1024, num_updates=2270, lr=4.98925e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=31, gb_free=13.5, wall=14433
2024-11-09 10:55:10 - progress_bar.py[line:274] - INFO: epoch 007:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=17589.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.07, wps=3153.7, ups=0.18, wpb=17589.3, bsz=1024, num_updates=2280, lr=4.98779e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=38, gb_free=13.5, wall=14489
2024-11-09 10:56:06 - progress_bar.py[line:274] - INFO: epoch 007:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.552, ntokens=17406.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.73, wps=3123.9, ups=0.18, wpb=17406.1, bsz=1024, num_updates=2290, lr=4.98634e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=38, gb_free=13.5, wall=14544
2024-11-09 10:57:00 - progress_bar.py[line:274] - INFO: epoch 007:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=17458, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3259, ups=0.19, wpb=17458, bsz=1024, num_updates=2300, lr=4.98489e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=38, gb_free=13.3, wall=14598
2024-11-09 10:57:53 - progress_bar.py[line:274] - INFO: epoch 007:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.575, ntokens=17443.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.92, wps=3252.9, ups=0.19, wpb=17443.3, bsz=1024, num_updates=2310, lr=4.98343e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=37, gb_free=13.3, wall=14651
2024-11-09 10:58:48 - progress_bar.py[line:274] - INFO: epoch 007:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.578, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=3198, ups=0.18, wpb=17422.9, bsz=1024, num_updates=2320, lr=4.98198e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=40, gb_free=13.5, wall=14706
2024-11-09 10:59:41 - progress_bar.py[line:274] - INFO: epoch 007:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.554, ntokens=17408.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.74, wps=3240.6, ups=0.19, wpb=17408.3, bsz=1024, num_updates=2330, lr=4.98053e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=37, gb_free=13.4, wall=14760
2024-11-09 11:00:36 - progress_bar.py[line:274] - INFO: epoch 007:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.499, ntokens=17046.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.31, wps=3146.6, ups=0.18, wpb=17046.5, bsz=1024, num_updates=2340, lr=4.97907e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=36, gb_free=13.4, wall=14814
2024-11-09 11:01:29 - progress_bar.py[line:274] - INFO: epoch 007:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.567, ntokens=17491.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.85, wps=3258, ups=0.19, wpb=17491.3, bsz=1024, num_updates=2350, lr=4.97762e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=38, gb_free=13.3, wall=14868
2024-11-09 11:02:22 - progress_bar.py[line:274] - INFO: epoch 007:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=17508.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=3295.8, ups=0.19, wpb=17508.5, bsz=1024, num_updates=2360, lr=4.97617e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=36, gb_free=13.4, wall=14921
2024-11-09 11:03:17 - progress_bar.py[line:274] - INFO: epoch 007:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.512, ntokens=17360.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.41, wps=3199.3, ups=0.18, wpb=17360.4, bsz=1024, num_updates=2370, lr=4.97471e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=41, gb_free=13.5, wall=14975
2024-11-09 11:04:11 - progress_bar.py[line:274] - INFO: epoch 007:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.607, ntokens=17646.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=12.18, wps=3231.3, ups=0.18, wpb=17646.1, bsz=1024, num_updates=2380, lr=4.97326e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=42, gb_free=13.4, wall=15030
2024-11-09 11:05:06 - progress_bar.py[line:274] - INFO: epoch 007:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=17309.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=3177.7, ups=0.18, wpb=17309.3, bsz=1024, num_updates=2390, lr=4.97181e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=46, gb_free=13.4, wall=15084
2024-11-09 11:06:02 - progress_bar.py[line:274] - INFO: epoch 007:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.542, ntokens=17546.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.65, wps=3143.8, ups=0.18, wpb=17546.6, bsz=1024, num_updates=2400, lr=4.97035e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=55, gb_free=13.2, wall=15140
2024-11-09 11:06:57 - progress_bar.py[line:274] - INFO: epoch 007:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.514, ntokens=17385.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.43, wps=3158.4, ups=0.18, wpb=17385.2, bsz=1024, num_updates=2410, lr=4.9689e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=55, gb_free=13.1, wall=15195
2024-11-09 11:07:51 - progress_bar.py[line:274] - INFO: epoch 007:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.539, ntokens=17588.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.62, wps=3264.6, ups=0.19, wpb=17588.2, bsz=1024, num_updates=2420, lr=4.96745e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=54, gb_free=13.5, wall=15249
2024-11-09 11:08:43 - progress_bar.py[line:274] - INFO: epoch 007:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.533, ntokens=17409.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=3342.7, ups=0.19, wpb=17409.5, bsz=1024, num_updates=2430, lr=4.96599e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=52, gb_free=13.5, wall=15301
2024-11-09 11:09:36 - progress_bar.py[line:274] - INFO: epoch 007:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.544, ntokens=17498, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.66, wps=3261.8, ups=0.19, wpb=17498, bsz=1024, num_updates=2440, lr=4.96454e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=53, gb_free=13.4, wall=15354
2024-11-09 11:10:29 - progress_bar.py[line:274] - INFO: epoch 007:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.575, ntokens=17611, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.92, wps=3323.1, ups=0.19, wpb=17611, bsz=1024, num_updates=2450, lr=4.96309e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=53, gb_free=13.4, wall=15407
2024-11-09 11:11:24 - progress_bar.py[line:274] - INFO: epoch 007:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=17589.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=3217.5, ups=0.18, wpb=17589.6, bsz=1024, num_updates=2460, lr=4.96163e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=55, gb_free=13.4, wall=15462
2024-11-09 11:12:17 - progress_bar.py[line:274] - INFO: epoch 007:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.488, ntokens=17219.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.22, wps=3258.3, ups=0.19, wpb=17219.3, bsz=1024, num_updates=2470, lr=4.96018e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=53, gb_free=13.3, wall=15515
2024-11-09 11:13:10 - progress_bar.py[line:274] - INFO: epoch 007:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=16993.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3195.8, ups=0.19, wpb=16993.8, bsz=1015.4, num_updates=2480, lr=4.95873e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=52, gb_free=13.3, wall=15568
2024-11-09 11:14:04 - progress_bar.py[line:274] - INFO: epoch 007:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.519, ntokens=17398.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=3208.8, ups=0.18, wpb=17398.1, bsz=1024, num_updates=2490, lr=4.95727e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=50, gb_free=13.5, wall=15622
2024-11-09 11:14:57 - progress_bar.py[line:274] - INFO: epoch 007:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.544, ntokens=17676.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.67, wps=3316.1, ups=0.19, wpb=17676.5, bsz=1024, num_updates=2500, lr=4.95582e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=51, gb_free=13.4, wall=15676
2024-11-09 11:15:52 - progress_bar.py[line:274] - INFO: epoch 007:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.532, ntokens=17735.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=3273.7, ups=0.18, wpb=17735.5, bsz=1024, num_updates=2510, lr=4.95437e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=54, gb_free=13.4, wall=15730
2024-11-09 11:16:46 - progress_bar.py[line:274] - INFO: epoch 007:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.521, ntokens=17700.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=3271.1, ups=0.18, wpb=17700.5, bsz=1024, num_updates=2520, lr=4.95291e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=54, gb_free=13.2, wall=15784
2024-11-09 11:17:38 - progress_bar.py[line:274] - INFO: epoch 007:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.484, ntokens=17333.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.19, wps=3314.6, ups=0.19, wpb=17333.1, bsz=1024, num_updates=2530, lr=4.95146e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=52, gb_free=13.2, wall=15836
2024-11-09 11:18:32 - progress_bar.py[line:274] - INFO: epoch 007:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.552, ntokens=17814.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.73, wps=3322.3, ups=0.19, wpb=17814.3, bsz=1024, num_updates=2540, lr=4.95001e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=49, gb_free=13.4, wall=15890
2024-11-09 11:19:28 - progress_bar.py[line:274] - INFO: epoch 007:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.521, ntokens=17504.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=3104.1, ups=0.18, wpb=17504.5, bsz=1024, num_updates=2550, lr=4.94855e-05, gnorm=0.004, clip=0, loss_scale=2048, train_wall=37, gb_free=13.4, wall=15946
2024-11-09 11:20:23 - progress_bar.py[line:274] - INFO: epoch 007:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=17872.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=3233.8, ups=0.18, wpb=17872.1, bsz=1024, num_updates=2560, lr=4.9471e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=34, gb_free=13.3, wall=16002
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 11:20:32 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2562 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt

2024-11-09 11:20:32 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 11:22:19 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
2024-11-09 11:24:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 7 @ 2562 updates, score 0) (writing took 218.86594450997654 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_7.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442


slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 11:25:05 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-09 11:25:05 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.553 | ntokens 17458.4 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.74 | wps 2667.5 | ups 0.15 | wpb 17458.4 | bsz 1023.1 | num_updates 2562 | lr 4.94681e-05 | gnorm 0.006 | clip 0 | loss_scale 4096 | train_wall 1560 | gb_free 13.5 | wall 16283
2024-11-09 11:25:05 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 11:27:33 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-09 11:27:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 11:28:18 - progress_bar.py[line:274] - INFO: epoch 008:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.479, ntokens=16956, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=11.15, wps=357.5, ups=0.02, wpb=16956, bsz=998.4, num_updates=2570, lr=4.94565e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=29, gb_free=13.4, wall=16476
2024-11-09 11:29:11 - progress_bar.py[line:274] - INFO: epoch 008:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.446, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=3220.2, ups=0.19, wpb=17102.7, bsz=1024, num_updates=2580, lr=4.94419e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16529
2024-11-09 11:30:03 - progress_bar.py[line:274] - INFO: epoch 008:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.513, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.42, wps=3362.9, ups=0.19, wpb=17543.5, bsz=1024, num_updates=2590, lr=4.94274e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16581
2024-11-09 11:30:55 - progress_bar.py[line:274] - INFO: epoch 008:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.5, ntokens=17599, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.31, wps=3356, ups=0.19, wpb=17599, bsz=1024, num_updates=2600, lr=4.94129e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=16634
2024-11-09 11:31:48 - progress_bar.py[line:274] - INFO: epoch 008:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=3260.7, ups=0.19, wpb=17309.4, bsz=1024, num_updates=2610, lr=4.93983e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=16687
2024-11-09 11:32:41 - progress_bar.py[line:274] - INFO: epoch 008:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.497, ntokens=17439.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.29, wps=3332.7, ups=0.19, wpb=17439.9, bsz=1024, num_updates=2620, lr=4.93838e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16739
2024-11-09 11:33:34 - progress_bar.py[line:274] - INFO: epoch 008:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=17258.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=3265.7, ups=0.19, wpb=17258.9, bsz=1024, num_updates=2630, lr=4.93693e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16792
2024-11-09 11:34:27 - progress_bar.py[line:274] - INFO: epoch 008:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.473, ntokens=17378.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.1, wps=3261, ups=0.19, wpb=17378.7, bsz=1024, num_updates=2640, lr=4.93547e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=16845
2024-11-09 11:35:19 - progress_bar.py[line:274] - INFO: epoch 008:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=17484.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.87, wps=3323.6, ups=0.19, wpb=17484.3, bsz=1024, num_updates=2650, lr=4.93402e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.1, wall=16898
2024-11-09 11:36:12 - progress_bar.py[line:274] - INFO: epoch 008:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.525, ntokens=17567.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.51, wps=3318.4, ups=0.19, wpb=17567.9, bsz=1024, num_updates=2660, lr=4.93257e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=16951
2024-11-09 11:37:05 - progress_bar.py[line:274] - INFO: epoch 008:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.449, ntokens=17427.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.92, wps=3335.9, ups=0.19, wpb=17427.2, bsz=1024, num_updates=2670, lr=4.93111e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17003
2024-11-09 11:37:57 - progress_bar.py[line:274] - INFO: epoch 008:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=17406.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=3317, ups=0.19, wpb=17406.8, bsz=1015.4, num_updates=2680, lr=4.92966e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17055
2024-11-09 11:38:50 - progress_bar.py[line:274] - INFO: epoch 008:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17072.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.71, wps=3215.2, ups=0.19, wpb=17072.2, bsz=1024, num_updates=2690, lr=4.92821e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17108
2024-11-09 11:39:43 - progress_bar.py[line:274] - INFO: epoch 008:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.468, ntokens=17554.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=3308.7, ups=0.19, wpb=17554.5, bsz=1024, num_updates=2700, lr=4.92675e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17161
2024-11-09 11:40:36 - progress_bar.py[line:274] - INFO: epoch 008:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.536, ntokens=17807.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.6, wps=3372.9, ups=0.19, wpb=17807.7, bsz=1024, num_updates=2710, lr=4.9253e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17214
2024-11-09 11:41:29 - progress_bar.py[line:274] - INFO: epoch 008:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=17247.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.87, wps=3275.4, ups=0.19, wpb=17247.7, bsz=1024, num_updates=2720, lr=4.92385e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.1, wall=17267
2024-11-09 11:42:22 - progress_bar.py[line:274] - INFO: epoch 008:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.451, ntokens=17431, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.94, wps=3288.5, ups=0.19, wpb=17431, bsz=1024, num_updates=2730, lr=4.92239e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17320
2024-11-09 11:43:14 - progress_bar.py[line:274] - INFO: epoch 008:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=17252.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=3285.6, ups=0.19, wpb=17252.6, bsz=1024, num_updates=2740, lr=4.92094e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17372
2024-11-09 11:44:07 - progress_bar.py[line:274] - INFO: epoch 008:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.425, ntokens=17115, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.74, wps=3221.7, ups=0.19, wpb=17115, bsz=1024, num_updates=2750, lr=4.91949e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17426
2024-11-09 11:45:00 - progress_bar.py[line:274] - INFO: epoch 008:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=17493.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=3324, ups=0.19, wpb=17493.1, bsz=1024, num_updates=2760, lr=4.91803e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=17478
2024-11-09 11:45:53 - progress_bar.py[line:274] - INFO: epoch 008:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=17508.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=3333.7, ups=0.19, wpb=17508.3, bsz=1024, num_updates=2770, lr=4.91658e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=17531
2024-11-09 11:46:45 - progress_bar.py[line:274] - INFO: epoch 008:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=17027.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3267.2, ups=0.19, wpb=17027.4, bsz=1024, num_updates=2780, lr=4.91513e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=17583
2024-11-09 11:47:37 - progress_bar.py[line:274] - INFO: epoch 008:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17410.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3299.3, ups=0.19, wpb=17410.4, bsz=1024, num_updates=2790, lr=4.91367e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=31, gb_free=13.4, wall=17636
2024-11-09 11:48:31 - progress_bar.py[line:274] - INFO: epoch 008:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.492, ntokens=17581.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.25, wps=3301.6, ups=0.19, wpb=17581.6, bsz=1024, num_updates=2800, lr=4.91222e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=17689
2024-11-09 11:49:24 - progress_bar.py[line:274] - INFO: epoch 008:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.465, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=3298.6, ups=0.19, wpb=17435.9, bsz=1024, num_updates=2810, lr=4.91077e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=17742
2024-11-09 11:50:16 - progress_bar.py[line:274] - INFO: epoch 008:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=17077.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=3234.8, ups=0.19, wpb=17077.4, bsz=1024, num_updates=2820, lr=4.90931e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17795
2024-11-09 11:51:09 - progress_bar.py[line:274] - INFO: epoch 008:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=17404.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.75, wps=3308, ups=0.19, wpb=17404.8, bsz=1024, num_updates=2830, lr=4.90786e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.6, wall=17847
2024-11-09 11:52:01 - progress_bar.py[line:274] - INFO: epoch 008:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.418, ntokens=17322.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.69, wps=3297, ups=0.19, wpb=17322.7, bsz=1024, num_updates=2840, lr=4.90641e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17900
2024-11-09 11:52:54 - progress_bar.py[line:274] - INFO: epoch 008:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=17391.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=3285.5, ups=0.19, wpb=17391.9, bsz=1024, num_updates=2850, lr=4.90495e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=17953
2024-11-09 11:53:48 - progress_bar.py[line:274] - INFO: epoch 008:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=17375.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=3236.7, ups=0.19, wpb=17375.1, bsz=1024, num_updates=2860, lr=4.9035e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18006
2024-11-09 11:54:40 - progress_bar.py[line:274] - INFO: epoch 008:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=17897, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=3421, ups=0.19, wpb=17897, bsz=1024, num_updates=2870, lr=4.90205e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18059
2024-11-09 11:55:32 - progress_bar.py[line:274] - INFO: epoch 008:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.517, ntokens=17827.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11.45, wps=3441.1, ups=0.19, wpb=17827.9, bsz=1024, num_updates=2880, lr=4.90059e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=18110
2024-11-09 11:56:26 - progress_bar.py[line:274] - INFO: epoch 008:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.438, ntokens=17743.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=3313.2, ups=0.19, wpb=17743.1, bsz=1024, num_updates=2890, lr=4.89914e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=40, gb_free=13.3, wall=18164
2024-11-09 11:57:19 - progress_bar.py[line:274] - INFO: epoch 008:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.459, ntokens=17614, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=11, wps=3312.8, ups=0.19, wpb=17614, bsz=1024, num_updates=2900, lr=4.89769e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=50, gb_free=13.4, wall=18217
2024-11-09 11:58:12 - progress_bar.py[line:274] - INFO: epoch 008:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17461.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=3306.8, ups=0.19, wpb=17461.8, bsz=1024, num_updates=2910, lr=4.89623e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=53, gb_free=13.4, wall=18270
2024-11-09 11:59:05 - progress_bar.py[line:274] - INFO: epoch 008:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.438, ntokens=17631.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.84, wps=3326.6, ups=0.19, wpb=17631.7, bsz=1024, num_updates=2920, lr=4.89478e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=53, gb_free=13.2, wall=18323
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt2024-11-09 11:59:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2928 updates


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
2024-11-09 11:59:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 12:01:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
2024-11-09 12:03:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 8 @ 2928 updates, score 0) (writing took 219.99352623795858 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_8.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442


slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-09 12:04:20 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-09 12:04:20 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.456 | ntokens 17422.6 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.98 | wps 2707.9 | ups 0.16 | wpb 17422.6 | bsz 1023.1 | num_updates 2928 | lr 4.89362e-05 | gnorm 0.007 | clip 0 | loss_scale 4096 | train_wall 1199 | gb_free 13.4 | wall 18638
2024-11-09 12:04:20 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 12:06:48 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-09 12:06:48 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 12:07:00 - progress_bar.py[line:274] - INFO: epoch 009:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=17103.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=10.86, wps=359.6, ups=0.02, wpb=17103.7, bsz=998.4, num_updates=2930, lr=4.89333e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=46, gb_free=13.2, wall=18799
2024-11-09 12:07:53 - progress_bar.py[line:274] - INFO: epoch 009:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.408, ntokens=17419.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=3320, ups=0.19, wpb=17419.1, bsz=1024, num_updates=2940, lr=4.89187e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18851
2024-11-09 12:08:46 - progress_bar.py[line:274] - INFO: epoch 009:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=17619.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.87, wps=3323.9, ups=0.19, wpb=17619.5, bsz=1024, num_updates=2950, lr=4.89042e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=18904
2024-11-09 12:09:38 - progress_bar.py[line:274] - INFO: epoch 009:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17429.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3324.5, ups=0.19, wpb=17429.3, bsz=1024, num_updates=2960, lr=4.88897e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=18956
2024-11-09 12:10:31 - progress_bar.py[line:274] - INFO: epoch 009:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.419, ntokens=17494.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.7, wps=3344.8, ups=0.19, wpb=17494.2, bsz=1024, num_updates=2970, lr=4.88751e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19009
2024-11-09 12:11:23 - progress_bar.py[line:274] - INFO: epoch 009:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.446, ntokens=17399.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=3325.2, ups=0.19, wpb=17399.6, bsz=1015.4, num_updates=2980, lr=4.88606e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19061
2024-11-09 12:12:15 - progress_bar.py[line:274] - INFO: epoch 009:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=3306.2, ups=0.19, wpb=17309.4, bsz=1024, num_updates=2990, lr=4.88461e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.5, wall=19113
2024-11-09 12:13:08 - progress_bar.py[line:274] - INFO: epoch 009:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=17283.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3277.1, ups=0.19, wpb=17283.8, bsz=1024, num_updates=3000, lr=4.88315e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=30, gb_free=13.3, wall=19166
2024-11-09 12:14:01 - progress_bar.py[line:274] - INFO: epoch 009:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=17352.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=3286.9, ups=0.19, wpb=17352.6, bsz=1024, num_updates=3010, lr=4.8817e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19219
2024-11-09 12:14:54 - progress_bar.py[line:274] - INFO: epoch 009:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=17610.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=3319.2, ups=0.19, wpb=17610.6, bsz=1024, num_updates=3020, lr=4.88025e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19272
2024-11-09 12:15:47 - progress_bar.py[line:274] - INFO: epoch 009:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=17416.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=3298.5, ups=0.19, wpb=17416.7, bsz=1024, num_updates=3030, lr=4.87879e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19325
2024-11-09 12:16:39 - progress_bar.py[line:274] - INFO: epoch 009:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.413, ntokens=17449.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.66, wps=3304.3, ups=0.19, wpb=17449.5, bsz=1024, num_updates=3040, lr=4.87734e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=30, gb_free=13.4, wall=19378
2024-11-09 12:17:33 - progress_bar.py[line:274] - INFO: epoch 009:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=17513.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3282.4, ups=0.19, wpb=17513.6, bsz=1024, num_updates=3050, lr=4.87589e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=35, gb_free=13.5, wall=19431
2024-11-09 12:18:25 - progress_bar.py[line:274] - INFO: epoch 009:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=17196.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=3287.9, ups=0.19, wpb=17196.7, bsz=1024, num_updates=3060, lr=4.87443e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=40, gb_free=13.5, wall=19483
2024-11-09 12:19:18 - progress_bar.py[line:274] - INFO: epoch 009:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.426, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.75, wps=3347.4, ups=0.19, wpb=17590.9, bsz=1024, num_updates=3070, lr=4.87298e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=31, gb_free=13.2, wall=19536
2024-11-09 12:20:10 - progress_bar.py[line:274] - INFO: epoch 009:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17461.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3322.1, ups=0.19, wpb=17461.5, bsz=1024, num_updates=3080, lr=4.87153e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=19588
2024-11-09 12:21:03 - progress_bar.py[line:274] - INFO: epoch 009:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17307.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3259.3, ups=0.19, wpb=17307.4, bsz=1024, num_updates=3090, lr=4.87007e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19642
2024-11-09 12:21:56 - progress_bar.py[line:274] - INFO: epoch 009:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.418, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.69, wps=3327.8, ups=0.19, wpb=17435.9, bsz=1024, num_updates=3100, lr=4.86862e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=19694
2024-11-09 12:22:48 - progress_bar.py[line:274] - INFO: epoch 009:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=3340.8, ups=0.19, wpb=17521.3, bsz=1024, num_updates=3110, lr=4.86717e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19746
2024-11-09 12:23:41 - progress_bar.py[line:274] - INFO: epoch 009:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=17047.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=3208, ups=0.19, wpb=17047.3, bsz=1024, num_updates=3120, lr=4.86571e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=19800
2024-11-09 12:24:34 - progress_bar.py[line:274] - INFO: epoch 009:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=17353.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=3268.2, ups=0.19, wpb=17353.7, bsz=1024, num_updates=3130, lr=4.86426e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=19853
2024-11-09 12:25:27 - progress_bar.py[line:274] - INFO: epoch 009:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=17171.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3266.1, ups=0.19, wpb=17171.8, bsz=1024, num_updates=3140, lr=4.86281e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=19905
2024-11-09 12:26:19 - progress_bar.py[line:274] - INFO: epoch 009:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.349, ntokens=17316.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.19, wps=3322.2, ups=0.19, wpb=17316.5, bsz=1024, num_updates=3150, lr=4.86135e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=19957
2024-11-09 12:27:12 - progress_bar.py[line:274] - INFO: epoch 009:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=17424, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=3300.1, ups=0.19, wpb=17424, bsz=1024, num_updates=3160, lr=4.8599e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20010
2024-11-09 12:28:04 - progress_bar.py[line:274] - INFO: epoch 009:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.41, ntokens=17476, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=3344.8, ups=0.19, wpb=17476, bsz=1024, num_updates=3170, lr=4.85845e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=20062
2024-11-09 12:28:57 - progress_bar.py[line:274] - INFO: epoch 009:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.35, ntokens=17049.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.19, wps=3257.5, ups=0.19, wpb=17049.5, bsz=1024, num_updates=3180, lr=4.85699e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=20115
2024-11-09 12:29:49 - progress_bar.py[line:274] - INFO: epoch 009:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=17394.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=3293.5, ups=0.19, wpb=17394.4, bsz=1024, num_updates=3190, lr=4.85554e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20168
2024-11-09 12:30:42 - progress_bar.py[line:274] - INFO: epoch 009:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=17217.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=3268.9, ups=0.19, wpb=17217.4, bsz=1024, num_updates=3200, lr=4.85409e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.2, wall=20220
2024-11-09 12:31:34 - progress_bar.py[line:274] - INFO: epoch 009:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.413, ntokens=17497.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.65, wps=3334.4, ups=0.19, wpb=17497.3, bsz=1024, num_updates=3210, lr=4.85263e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20273
2024-11-09 12:32:27 - progress_bar.py[line:274] - INFO: epoch 009:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=17383, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3329.5, ups=0.19, wpb=17383, bsz=1024, num_updates=3220, lr=4.85118e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20325
2024-11-09 12:33:19 - progress_bar.py[line:274] - INFO: epoch 009:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=17598.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=3371.3, ups=0.19, wpb=17598.1, bsz=1024, num_updates=3230, lr=4.84973e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=20377
2024-11-09 12:34:10 - progress_bar.py[line:274] - INFO: epoch 009:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=17373.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=3403.8, ups=0.2, wpb=17373.2, bsz=1024, num_updates=3240, lr=4.84827e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=31, gb_free=13.3, wall=20428
2024-11-09 12:35:02 - progress_bar.py[line:274] - INFO: epoch 009:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=17570.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=3382.6, ups=0.19, wpb=17570.4, bsz=1024, num_updates=3250, lr=4.84682e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=20480
2024-11-09 12:35:54 - progress_bar.py[line:274] - INFO: epoch 009:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=17748.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=3404.7, ups=0.19, wpb=17748.8, bsz=1024, num_updates=3260, lr=4.84537e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=20532
2024-11-09 12:36:46 - progress_bar.py[line:274] - INFO: epoch 009:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=17543.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=3347.2, ups=0.19, wpb=17543.7, bsz=1024, num_updates=3270, lr=4.84391e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=20585
2024-11-09 12:37:38 - progress_bar.py[line:274] - INFO: epoch 009:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=17614.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=3387.1, ups=0.19, wpb=17614.6, bsz=1024, num_updates=3280, lr=4.84246e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=32, gb_free=13, wall=20637
2024-11-09 12:38:30 - progress_bar.py[line:274] - INFO: epoch 009:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.366, ntokens=17537.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3394.2, ups=0.19, wpb=17537.3, bsz=1024, num_updates=3290, lr=4.84101e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=33, gb_free=13.4, wall=20688
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 12:38:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 3294 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
2024-11-09 12:38:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 12:40:36 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 12:42:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 9 @ 3294 updates, score 0) (writing took 219.55073205498047 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_9.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442



slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
2024-11-09 12:43:22 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-09 12:43:22 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.396 | ntokens 17411.5 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.53 | wps 2720.2 | ups 0.16 | wpb 17411.5 | bsz 1023.1 | num_updates 3294 | lr 4.84043e-05 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 1128 | gb_free 13.3 | wall 20981
2024-11-09 12:43:22 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 12:45:55 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-09 12:45:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 12:46:29 - progress_bar.py[line:274] - INFO: epoch 010:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=16968.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=354.4, ups=0.02, wpb=16968.5, bsz=998.4, num_updates=3300, lr=4.83955e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=29, gb_free=13.4, wall=21167
2024-11-09 12:47:22 - progress_bar.py[line:274] - INFO: epoch 010:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=17570.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=3335.3, ups=0.19, wpb=17570.4, bsz=1024, num_updates=3310, lr=4.8381e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21220
2024-11-09 12:48:14 - progress_bar.py[line:274] - INFO: epoch 010:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.366, ntokens=17437.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3308, ups=0.19, wpb=17437.8, bsz=1024, num_updates=3320, lr=4.83665e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21273
2024-11-09 12:49:07 - progress_bar.py[line:274] - INFO: epoch 010:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.363, ntokens=17487.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.29, wps=3345.4, ups=0.19, wpb=17487.9, bsz=1024, num_updates=3330, lr=4.83519e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21325
2024-11-09 12:49:59 - progress_bar.py[line:274] - INFO: epoch 010:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=17465.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=3332.8, ups=0.19, wpb=17465.9, bsz=1024, num_updates=3340, lr=4.83374e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21377
2024-11-09 12:50:51 - progress_bar.py[line:274] - INFO: epoch 010:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=17413, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=3336.4, ups=0.19, wpb=17413, bsz=1024, num_updates=3350, lr=4.83229e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=31, gb_free=13.4, wall=21429
2024-11-09 12:51:44 - progress_bar.py[line:274] - INFO: epoch 010:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.364, ntokens=17535.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.29, wps=3317.5, ups=0.19, wpb=17535.1, bsz=1024, num_updates=3360, lr=4.83083e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.3, wall=21482
2024-11-09 12:52:36 - progress_bar.py[line:274] - INFO: epoch 010:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=17195.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=3305.6, ups=0.19, wpb=17195.2, bsz=1024, num_updates=3370, lr=4.82938e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21534
2024-11-09 12:53:29 - progress_bar.py[line:274] - INFO: epoch 010:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=17504.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=3322.9, ups=0.19, wpb=17504.6, bsz=1024, num_updates=3380, lr=4.82793e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=30, gb_free=13.5, wall=21587
2024-11-09 12:54:22 - progress_bar.py[line:274] - INFO: epoch 010:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=17580.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=3330.8, ups=0.19, wpb=17580.5, bsz=1024, num_updates=3390, lr=4.82647e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21640
2024-11-09 12:55:14 - progress_bar.py[line:274] - INFO: epoch 010:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.345, ntokens=17268.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=3298.2, ups=0.19, wpb=17268.7, bsz=1024, num_updates=3400, lr=4.82502e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21692
2024-11-09 12:56:07 - progress_bar.py[line:274] - INFO: epoch 010:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.36, ntokens=17455.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=3311, ups=0.19, wpb=17455.4, bsz=1024, num_updates=3410, lr=4.82357e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.4, wall=21745
2024-11-09 12:56:59 - progress_bar.py[line:274] - INFO: epoch 010:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=17374.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=3323.6, ups=0.19, wpb=17374.4, bsz=1024, num_updates=3420, lr=4.82211e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=30, gb_free=13.2, wall=21797
2024-11-09 12:57:53 - progress_bar.py[line:274] - INFO: epoch 010:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.309, ntokens=17186.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.91, wps=3184.8, ups=0.19, wpb=17186.4, bsz=1024, num_updates=3430, lr=4.82066e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=37, gb_free=13.4, wall=21851
2024-11-09 12:58:47 - progress_bar.py[line:274] - INFO: epoch 010:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=17540.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=3256.8, ups=0.19, wpb=17540.7, bsz=1024, num_updates=3440, lr=4.81921e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=50, gb_free=13.3, wall=21905
2024-11-09 12:59:41 - progress_bar.py[line:274] - INFO: epoch 010:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=17354.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=3203.3, ups=0.18, wpb=17354.7, bsz=1024, num_updates=3450, lr=4.81775e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=54, gb_free=13.3, wall=21959
2024-11-09 13:00:35 - progress_bar.py[line:274] - INFO: epoch 010:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=17338, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3229.1, ups=0.19, wpb=17338, bsz=1024, num_updates=3460, lr=4.8163e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=54, gb_free=13.2, wall=22013
2024-11-09 13:01:29 - progress_bar.py[line:274] - INFO: epoch 010:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=17453.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=3233.5, ups=0.19, wpb=17453.7, bsz=1024, num_updates=3470, lr=4.81485e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=54, gb_free=13.2, wall=22067
2024-11-09 13:02:22 - progress_bar.py[line:274] - INFO: epoch 010:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=17260.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=3226.8, ups=0.19, wpb=17260.3, bsz=1024, num_updates=3480, lr=4.81339e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=22120
2024-11-09 13:03:16 - progress_bar.py[line:274] - INFO: epoch 010:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.364, ntokens=17432.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=3227.4, ups=0.19, wpb=17432.6, bsz=1024, num_updates=3490, lr=4.81194e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=54, gb_free=13.3, wall=22174
2024-11-09 13:04:09 - progress_bar.py[line:274] - INFO: epoch 010:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=17817.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=3367.4, ups=0.19, wpb=17817.9, bsz=1024, num_updates=3500, lr=4.81049e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=53, gb_free=13.5, wall=22227
2024-11-09 13:05:01 - progress_bar.py[line:274] - INFO: epoch 010:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.292, ntokens=17077.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3283.8, ups=0.19, wpb=17077.9, bsz=1024, num_updates=3510, lr=4.80903e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=52, gb_free=13.1, wall=22279
2024-11-09 13:05:53 - progress_bar.py[line:274] - INFO: epoch 010:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.322, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=3382.5, ups=0.19, wpb=17478.4, bsz=1024, num_updates=3520, lr=4.80758e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=22331
2024-11-09 13:06:49 - progress_bar.py[line:274] - INFO: epoch 010:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=17497.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=3103.2, ups=0.18, wpb=17497.4, bsz=1024, num_updates=3530, lr=4.80613e-05, gnorm=0.004, clip=0, loss_scale=8192, train_wall=56, gb_free=13.5, wall=22387
2024-11-09 13:07:42 - progress_bar.py[line:274] - INFO: epoch 010:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=17352, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=3304.3, ups=0.19, wpb=17352, bsz=1024, num_updates=3540, lr=4.80467e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=52, gb_free=13.5, wall=22440
2024-11-09 13:08:34 - progress_bar.py[line:274] - INFO: epoch 010:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=17329.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=3327.2, ups=0.19, wpb=17329.5, bsz=1024, num_updates=3550, lr=4.80322e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=52, gb_free=13.4, wall=22492
2024-11-09 13:09:26 - progress_bar.py[line:274] - INFO: epoch 010:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.317, ntokens=17272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=3320.1, ups=0.19, wpb=17272.4, bsz=1024, num_updates=3560, lr=4.80177e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=44, gb_free=13.3, wall=22544
2024-11-09 13:10:19 - progress_bar.py[line:274] - INFO: epoch 010:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=17359.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=3264.4, ups=0.19, wpb=17359.2, bsz=1024, num_updates=3570, lr=4.80031e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=41, gb_free=13.5, wall=22597
2024-11-09 13:11:12 - progress_bar.py[line:274] - INFO: epoch 010:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.313, ntokens=17154.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.94, wps=3234.9, ups=0.19, wpb=17154.1, bsz=1024, num_updates=3580, lr=4.79886e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=39, gb_free=13.4, wall=22650
2024-11-09 13:12:05 - progress_bar.py[line:274] - INFO: epoch 010:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.304, ntokens=17263.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3218.8, ups=0.19, wpb=17263.3, bsz=1024, num_updates=3590, lr=4.79741e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=22704
2024-11-09 13:12:58 - progress_bar.py[line:274] - INFO: epoch 010:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.329, ntokens=17611.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.05, wps=3376.3, ups=0.19, wpb=17611.3, bsz=1024, num_updates=3600, lr=4.79595e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=22756
2024-11-09 13:13:49 - progress_bar.py[line:274] - INFO: epoch 010:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.416, ntokens=17942.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.68, wps=3479, ups=0.19, wpb=17942.5, bsz=1024, num_updates=3610, lr=4.7945e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=31, gb_free=13.3, wall=22807
2024-11-09 13:14:41 - progress_bar.py[line:274] - INFO: epoch 010:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.319, ntokens=17435.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3351.4, ups=0.19, wpb=17435.9, bsz=1024, num_updates=3620, lr=4.79305e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=34, gb_free=13.2, wall=22859
2024-11-09 13:15:33 - progress_bar.py[line:274] - INFO: epoch 010:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=17776, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=3405.3, ups=0.19, wpb=17776, bsz=1024, num_updates=3630, lr=4.79159e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=37, gb_free=13.3, wall=22912
2024-11-09 13:16:26 - progress_bar.py[line:274] - INFO: epoch 010:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=17514.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=3336.4, ups=0.19, wpb=17514.7, bsz=1024, num_updates=3640, lr=4.79014e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=34, gb_free=13.4, wall=22964
2024-11-09 13:17:18 - progress_bar.py[line:274] - INFO: epoch 010:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=17590.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=3376.5, ups=0.19, wpb=17590.1, bsz=1024, num_updates=3650, lr=4.78869e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.2, wall=23016
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 13:18:07 - progress_bar.py[line:274] - INFO: epoch 010:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=16882.1, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3414.9, ups=0.2, wpb=16882.1, bsz=989.8, num_updates=3660, lr=4.78723e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=29, gb_free=13.5, wall=23066
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt2024-11-09 13:18:07 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3660 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
2024-11-09 13:18:07 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

2024-11-09 13:19:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-09 13:21:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 10 @ 3660 updates, score 0) (writing took 213.88591540500056 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_10.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 13:22:36 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-09 13:22:36 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.348 | ntokens 17418.1 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.18 | wps 2708.7 | ups 0.16 | wpb 17418.1 | bsz 1023.1 | num_updates 3660 | lr 4.78723e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1433 | gb_free 13.5 | wall 23334
2024-11-09 13:22:36 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 13:25:04 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-09 13:25:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 13:25:59 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=17558.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=372, ups=0.02, wpb=17558.3, bsz=1024, num_updates=3670, lr=4.78578e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23538
2024-11-09 13:26:52 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.318, ntokens=17391.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.98, wps=3325.1, ups=0.19, wpb=17391.7, bsz=1024, num_updates=3680, lr=4.78433e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23590
2024-11-09 13:27:44 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=17596.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=3344.8, ups=0.19, wpb=17596.5, bsz=1024, num_updates=3690, lr=4.78287e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23643
2024-11-09 13:28:37 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=17638.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=3348.3, ups=0.19, wpb=17638.9, bsz=1024, num_updates=3700, lr=4.78142e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23695
2024-11-09 13:29:30 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=17589.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=3331.9, ups=0.19, wpb=17589.4, bsz=1024, num_updates=3710, lr=4.77997e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23748
2024-11-09 13:30:23 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.282, ntokens=17274.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3274.9, ups=0.19, wpb=17274.7, bsz=1024, num_updates=3720, lr=4.77851e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23801
2024-11-09 13:31:15 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=17484.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3331.5, ups=0.19, wpb=17484.6, bsz=1024, num_updates=3730, lr=4.77706e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=23853
2024-11-09 13:32:08 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.332, ntokens=17508.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=3335.9, ups=0.19, wpb=17508.1, bsz=1024, num_updates=3740, lr=4.77561e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=23906
2024-11-09 13:33:00 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=17726.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=3348.6, ups=0.19, wpb=17726.8, bsz=1024, num_updates=3750, lr=4.77415e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=23959
2024-11-09 13:33:53 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.329, ntokens=17475.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.05, wps=3300.7, ups=0.19, wpb=17475.9, bsz=1024, num_updates=3760, lr=4.7727e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24012
2024-11-09 13:34:47 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.281, ntokens=17229.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.72, wps=3229.4, ups=0.19, wpb=17229.9, bsz=1024, num_updates=3770, lr=4.77125e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24065
2024-11-09 13:35:39 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.291, ntokens=17299.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3304.8, ups=0.19, wpb=17299.7, bsz=1024, num_updates=3780, lr=4.76979e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24117
2024-11-09 13:36:32 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17081.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3247.4, ups=0.19, wpb=17081.3, bsz=1024, num_updates=3790, lr=4.76834e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.2, wall=24170
2024-11-09 13:37:24 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.304, ntokens=17283.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.88, wps=3322.4, ups=0.19, wpb=17283.3, bsz=1015.4, num_updates=3800, lr=4.76689e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24222
2024-11-09 13:38:16 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=17673.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=3385.1, ups=0.19, wpb=17673.9, bsz=1024, num_updates=3810, lr=4.76543e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24274
2024-11-09 13:39:09 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=3309.2, ups=0.19, wpb=17448.2, bsz=1024, num_updates=3820, lr=4.76398e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24327
2024-11-09 13:40:01 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17379.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.83, wps=3294.9, ups=0.19, wpb=17379.2, bsz=1024, num_updates=3830, lr=4.76253e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=24380
2024-11-09 13:40:54 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.286, ntokens=17326.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.75, wps=3303.3, ups=0.19, wpb=17326.3, bsz=1024, num_updates=3840, lr=4.76107e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24432
2024-11-09 13:41:47 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.31, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=3288.9, ups=0.19, wpb=17370.2, bsz=1024, num_updates=3850, lr=4.75962e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24485
2024-11-09 13:42:39 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.308, ntokens=17545, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.91, wps=3347.6, ups=0.19, wpb=17545, bsz=1024, num_updates=3860, lr=4.75817e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=24537
2024-11-09 13:43:32 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=17475.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=3319.8, ups=0.19, wpb=17475.4, bsz=1024, num_updates=3870, lr=4.75671e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24590
2024-11-09 13:44:24 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.278, ntokens=17406.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.7, wps=3333.2, ups=0.19, wpb=17406.4, bsz=1024, num_updates=3880, lr=4.75526e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=24642
2024-11-09 13:45:17 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.287, ntokens=17283.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.76, wps=3282.2, ups=0.19, wpb=17283.6, bsz=1024, num_updates=3890, lr=4.75381e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=24695
2024-11-09 13:46:10 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=17611.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=3318.3, ups=0.19, wpb=17611.8, bsz=1024, num_updates=3900, lr=4.75235e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=31, gb_free=13.5, wall=24748
2024-11-09 13:47:03 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=17419.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3284.7, ups=0.19, wpb=17419.6, bsz=1024, num_updates=3910, lr=4.7509e-05, gnorm=0.007, clip=0, loss_scale=16384, train_wall=33, gb_free=13.4, wall=24801
2024-11-09 13:47:56 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=17294.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=3256.1, ups=0.19, wpb=17294.2, bsz=1024, num_updates=3920, lr=4.74945e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=41, gb_free=13.4, wall=24854
2024-11-09 13:48:49 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.265, ntokens=17252.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3239.5, ups=0.19, wpb=17252.1, bsz=1024, num_updates=3930, lr=4.74799e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=49, gb_free=13.2, wall=24907
2024-11-09 13:49:42 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.301, ntokens=17384, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3317.3, ups=0.19, wpb=17384, bsz=1024, num_updates=3940, lr=4.74654e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=24960
2024-11-09 13:50:34 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.284, ntokens=17458.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.74, wps=3313.6, ups=0.19, wpb=17458.7, bsz=1024, num_updates=3950, lr=4.74509e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25012
2024-11-09 13:51:26 - progress_bar.py[line:274] - INFO: epoch 011:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.302, ntokens=17403.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3329.7, ups=0.19, wpb=17403.5, bsz=1024, num_updates=3960, lr=4.74363e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=25065
2024-11-09 13:52:19 - progress_bar.py[line:274] - INFO: epoch 011:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.269, ntokens=17493.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3324.7, ups=0.19, wpb=17493.5, bsz=1024, num_updates=3970, lr=4.74218e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25117
2024-11-09 13:53:12 - progress_bar.py[line:274] - INFO: epoch 011:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=17635.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=3355.1, ups=0.19, wpb=17635.1, bsz=1024, num_updates=3980, lr=4.74073e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=25170
2024-11-09 13:54:04 - progress_bar.py[line:274] - INFO: epoch 011:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.313, ntokens=17750.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.94, wps=3370.8, ups=0.19, wpb=17750.2, bsz=1024, num_updates=3990, lr=4.73927e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=53, gb_free=13.4, wall=25223
2024-11-09 13:54:57 - progress_bar.py[line:274] - INFO: epoch 011:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=3361.7, ups=0.19, wpb=17543.5, bsz=1024, num_updates=4000, lr=4.73782e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=25275
2024-11-09 13:55:49 - progress_bar.py[line:274] - INFO: epoch 011:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=17757.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=3390.6, ups=0.19, wpb=17757.6, bsz=1024, num_updates=4010, lr=4.73637e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=52, gb_free=13.3, wall=25327
2024-11-09 13:56:41 - progress_bar.py[line:274] - INFO: epoch 011:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=17825.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=3426.7, ups=0.19, wpb=17825.5, bsz=1024, num_updates=4020, lr=4.73491e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=52, gb_free=13.4, wall=25379
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt

2024-11-09 13:57:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 4026 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt

2024-11-09 13:57:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 13:58:57 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 14:00:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 11 @ 4026 updates, score 0) (writing took 219.28546363202622 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_11.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 14:01:43 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-09 14:01:43 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.312 | ntokens 17461 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.93 | wps 2722.4 | ups 0.16 | wpb 17461 | bsz 1023.1 | num_updates 4026 | lr 4.73404e-05 | gnorm 0.006 | clip 0 | loss_scale 16384 | train_wall 1349 | gb_free 13.4 | wall 25682
2024-11-09 14:01:43 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 14:04:12 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-09 14:04:12 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 14:04:35 - progress_bar.py[line:274] - INFO: epoch 012:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.301, ntokens=17053.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=9.85, wps=359.5, ups=0.02, wpb=17053.1, bsz=998.4, num_updates=4030, lr=4.73346e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=41, gb_free=13.5, wall=25853
2024-11-09 14:05:28 - progress_bar.py[line:274] - INFO: epoch 012:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17205, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3272.9, ups=0.19, wpb=17205, bsz=1024, num_updates=4040, lr=4.73201e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25906
2024-11-09 14:06:21 - progress_bar.py[line:274] - INFO: epoch 012:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17028, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3197.8, ups=0.19, wpb=17028, bsz=1024, num_updates=4050, lr=4.73055e-05, gnorm=0.005, clip=0, loss_scale=16384, train_wall=30, gb_free=13.4, wall=25959
2024-11-09 14:07:13 - progress_bar.py[line:274] - INFO: epoch 012:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.247, ntokens=17323.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.49, wps=3307.6, ups=0.19, wpb=17323.2, bsz=1024, num_updates=4060, lr=4.7291e-05, gnorm=0.004, clip=0, loss_scale=16384, train_wall=30, gb_free=13.3, wall=26012
2024-11-09 14:08:06 - progress_bar.py[line:274] - INFO: epoch 012:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.263, ntokens=17351.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.6, wps=3300.6, ups=0.19, wpb=17351.8, bsz=1024, num_updates=4070, lr=4.72765e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26064
2024-11-09 14:08:58 - progress_bar.py[line:274] - INFO: epoch 012:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.304, ntokens=17457, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.87, wps=3331.8, ups=0.19, wpb=17457, bsz=1024, num_updates=4080, lr=4.72619e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26117
2024-11-09 14:09:51 - progress_bar.py[line:274] - INFO: epoch 012:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.32, ntokens=17847.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3412.9, ups=0.19, wpb=17847.1, bsz=1024, num_updates=4090, lr=4.72474e-05, gnorm=0.006, clip=0, loss_scale=16384, train_wall=30, gb_free=13.5, wall=26169
2024-11-09 14:10:42 - progress_bar.py[line:274] - INFO: epoch 012:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.249, ntokens=17361.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.51, wps=3350.7, ups=0.19, wpb=17361.8, bsz=1024, num_updates=4100, lr=4.72329e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26221
2024-11-09 14:11:35 - progress_bar.py[line:274] - INFO: epoch 012:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.292, ntokens=17520.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.79, wps=3336.4, ups=0.19, wpb=17520.6, bsz=1024, num_updates=4110, lr=4.72183e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26273
2024-11-09 14:12:27 - progress_bar.py[line:274] - INFO: epoch 012:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.217, ntokens=17163, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3288.5, ups=0.19, wpb=17163, bsz=1024, num_updates=4120, lr=4.72038e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26325
2024-11-09 14:13:20 - progress_bar.py[line:274] - INFO: epoch 012:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=17598.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=3353.1, ups=0.19, wpb=17598.9, bsz=1024, num_updates=4130, lr=4.71893e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26378
2024-11-09 14:14:13 - progress_bar.py[line:274] - INFO: epoch 012:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.273, ntokens=17469.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3293.5, ups=0.19, wpb=17469.6, bsz=1024, num_updates=4140, lr=4.71747e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=26431
2024-11-09 14:15:05 - progress_bar.py[line:274] - INFO: epoch 012:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17292.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3280.3, ups=0.19, wpb=17292.3, bsz=1024, num_updates=4150, lr=4.71602e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=33, gb_free=13.5, wall=26484
2024-11-09 14:15:58 - progress_bar.py[line:274] - INFO: epoch 012:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.27, ntokens=17390.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3292.2, ups=0.19, wpb=17390.5, bsz=1024, num_updates=4160, lr=4.71457e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26536
2024-11-09 14:16:51 - progress_bar.py[line:274] - INFO: epoch 012:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.297, ntokens=17501.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.83, wps=3305, ups=0.19, wpb=17501.5, bsz=1024, num_updates=4170, lr=4.71311e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=26589
2024-11-09 14:17:44 - progress_bar.py[line:274] - INFO: epoch 012:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.266, ntokens=17494, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3345, ups=0.19, wpb=17494, bsz=1024, num_updates=4180, lr=4.71166e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26642
2024-11-09 14:18:37 - progress_bar.py[line:274] - INFO: epoch 012:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.229, ntokens=17145.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.38, wps=3207.1, ups=0.19, wpb=17145.2, bsz=1024, num_updates=4190, lr=4.71021e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26695
2024-11-09 14:19:30 - progress_bar.py[line:274] - INFO: epoch 012:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.261, ntokens=17347.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3268.4, ups=0.19, wpb=17347.3, bsz=1024, num_updates=4200, lr=4.70875e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=26748
2024-11-09 14:20:26 - progress_bar.py[line:274] - INFO: epoch 012:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.302, ntokens=17400.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3127.2, ups=0.18, wpb=17400.5, bsz=1024, num_updates=4210, lr=4.7073e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=43, gb_free=13.4, wall=26804
2024-11-09 14:21:22 - progress_bar.py[line:274] - INFO: epoch 012:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.243, ntokens=17404.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3111.8, ups=0.18, wpb=17404.2, bsz=1024, num_updates=4220, lr=4.70585e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=26860
2024-11-09 14:22:18 - progress_bar.py[line:274] - INFO: epoch 012:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.26, ntokens=17375.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.58, wps=3085.2, ups=0.18, wpb=17375.4, bsz=1024, num_updates=4230, lr=4.70439e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.3, wall=26916
2024-11-09 14:23:14 - progress_bar.py[line:274] - INFO: epoch 012:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.248, ntokens=17482.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3117.4, ups=0.18, wpb=17482.8, bsz=1024, num_updates=4240, lr=4.70294e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13, wall=26972
2024-11-09 14:24:10 - progress_bar.py[line:274] - INFO: epoch 012:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.321, ntokens=17703.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.99, wps=3143.8, ups=0.18, wpb=17703.4, bsz=1024, num_updates=4250, lr=4.70149e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=56, gb_free=13.4, wall=27029
2024-11-09 14:25:04 - progress_bar.py[line:274] - INFO: epoch 012:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.239, ntokens=17230.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3193.2, ups=0.19, wpb=17230.4, bsz=1024, num_updates=4260, lr=4.70003e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=54, gb_free=13.5, wall=27083
2024-11-09 14:25:56 - progress_bar.py[line:274] - INFO: epoch 012:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.277, ntokens=17486.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.69, wps=3372.6, ups=0.19, wpb=17486.8, bsz=1024, num_updates=4270, lr=4.69858e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=52, gb_free=13.5, wall=27134
2024-11-09 14:26:48 - progress_bar.py[line:274] - INFO: epoch 012:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.294, ntokens=17496.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.81, wps=3375.7, ups=0.19, wpb=17496.7, bsz=1024, num_updates=4280, lr=4.69713e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=43, gb_free=13.5, wall=27186
2024-11-09 14:27:42 - progress_bar.py[line:274] - INFO: epoch 012:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.258, ntokens=17449.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3255.7, ups=0.19, wpb=17449.3, bsz=1024, num_updates=4290, lr=4.69567e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=27240
2024-11-09 14:28:34 - progress_bar.py[line:274] - INFO: epoch 012:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.254, ntokens=17068.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3229.4, ups=0.19, wpb=17068.7, bsz=1015.4, num_updates=4300, lr=4.69422e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27293
2024-11-09 14:29:29 - progress_bar.py[line:274] - INFO: epoch 012:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.211, ntokens=17111.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3154.2, ups=0.18, wpb=17111.8, bsz=1024, num_updates=4310, lr=4.69277e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=27347
2024-11-09 14:30:22 - progress_bar.py[line:274] - INFO: epoch 012:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.264, ntokens=17388.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.61, wps=3254.8, ups=0.19, wpb=17388.2, bsz=1024, num_updates=4320, lr=4.69131e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=27400
2024-11-09 14:31:15 - progress_bar.py[line:274] - INFO: epoch 012:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.259, ntokens=17421, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.58, wps=3278.3, ups=0.19, wpb=17421, bsz=1024, num_updates=4330, lr=4.68986e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27453
2024-11-09 14:32:07 - progress_bar.py[line:274] - INFO: epoch 012:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.237, ntokens=17267.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3315.5, ups=0.19, wpb=17267.9, bsz=1024, num_updates=4340, lr=4.68841e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=27506
2024-11-09 14:33:01 - progress_bar.py[line:274] - INFO: epoch 012:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.239, ntokens=17527, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3283.9, ups=0.19, wpb=17527, bsz=1024, num_updates=4350, lr=4.68696e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27559
2024-11-09 14:33:53 - progress_bar.py[line:274] - INFO: epoch 012:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.302, ntokens=17649.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=3394.4, ups=0.19, wpb=17649.3, bsz=1024, num_updates=4360, lr=4.6855e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=27611
2024-11-09 14:34:45 - progress_bar.py[line:274] - INFO: epoch 012:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.258, ntokens=17485, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.57, wps=3359.1, ups=0.19, wpb=17485, bsz=1024, num_updates=4370, lr=4.68405e-05, gnorm=0.003, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=27663
2024-11-09 14:35:36 - progress_bar.py[line:274] - INFO: epoch 012:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.292, ntokens=17643.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.8, wps=3418.7, ups=0.19, wpb=17643.2, bsz=1024, num_updates=4380, lr=4.6826e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=27715
2024-11-09 14:36:28 - progress_bar.py[line:274] - INFO: epoch 012:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.28, ntokens=17650.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.71, wps=3407.4, ups=0.19, wpb=17650.9, bsz=1024, num_updates=4390, lr=4.68114e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=27766
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 14:36:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 4392 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
2024-11-09 14:36:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 14:38:21 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-09 14:40:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 12 @ 4392 updates, score 0) (writing took 216.51390861300752 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_12.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
2024-11-09 14:41:07 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-09 14:41:07 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.267 | ntokens 17394.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.62 | wps 2693.6 | ups 0.15 | wpb 17394.9 | bsz 1023.1 | num_updates 4392 | lr 4.68085e-05 | gnorm 0.006 | clip 0 | loss_scale 32768 | train_wall 1285 | gb_free 13.4 | wall 28045
2024-11-09 14:41:07 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 14:43:36 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-09 14:43:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 14:44:20 - progress_bar.py[line:274] - INFO: epoch 013:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=16733.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=354.8, ups=0.02, wpb=16733.3, bsz=998.4, num_updates=4400, lr=4.67969e-05, gnorm=0.007, clip=0, loss_scale=32768, train_wall=29, gb_free=13.3, wall=28238
2024-11-09 14:45:12 - progress_bar.py[line:274] - INFO: epoch 013:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.239, ntokens=17436.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3330.2, ups=0.19, wpb=17436.6, bsz=1024, num_updates=4410, lr=4.67824e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28290
2024-11-09 14:46:05 - progress_bar.py[line:274] - INFO: epoch 013:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.236, ntokens=17282.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.42, wps=3253.9, ups=0.19, wpb=17282.7, bsz=1024, num_updates=4420, lr=4.67678e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28344
2024-11-09 14:46:58 - progress_bar.py[line:274] - INFO: epoch 013:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17530.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3329.6, ups=0.19, wpb=17530.5, bsz=1024, num_updates=4430, lr=4.67533e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28396
2024-11-09 14:47:50 - progress_bar.py[line:274] - INFO: epoch 013:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17402.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3317.8, ups=0.19, wpb=17402.5, bsz=1024, num_updates=4440, lr=4.67388e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=31, gb_free=13.4, wall=28449
2024-11-09 14:48:44 - progress_bar.py[line:274] - INFO: epoch 013:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.235, ntokens=17377.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3259.6, ups=0.19, wpb=17377.8, bsz=1024, num_updates=4450, lr=4.67242e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28502
2024-11-09 14:49:37 - progress_bar.py[line:274] - INFO: epoch 013:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.262, ntokens=17540.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.59, wps=3312.3, ups=0.19, wpb=17540.3, bsz=1024, num_updates=4460, lr=4.67097e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=28555
2024-11-09 14:50:29 - progress_bar.py[line:274] - INFO: epoch 013:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.221, ntokens=17384.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3293.9, ups=0.19, wpb=17384.5, bsz=1024, num_updates=4470, lr=4.66952e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=28608
2024-11-09 14:51:22 - progress_bar.py[line:274] - INFO: epoch 013:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=17529.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.44, wps=3315.9, ups=0.19, wpb=17529.9, bsz=1024, num_updates=4480, lr=4.66806e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.2, wall=28661
2024-11-09 14:52:15 - progress_bar.py[line:274] - INFO: epoch 013:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.22, ntokens=17127.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3222.1, ups=0.19, wpb=17127.3, bsz=1024, num_updates=4490, lr=4.66661e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28714
2024-11-09 14:53:08 - progress_bar.py[line:274] - INFO: epoch 013:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.213, ntokens=17159.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3277.4, ups=0.19, wpb=17159.4, bsz=1024, num_updates=4500, lr=4.66516e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.5, wall=28766
2024-11-09 14:54:00 - progress_bar.py[line:274] - INFO: epoch 013:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.237, ntokens=17392.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3316.7, ups=0.19, wpb=17392.6, bsz=1024, num_updates=4510, lr=4.6637e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=28818
2024-11-09 14:54:53 - progress_bar.py[line:274] - INFO: epoch 013:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.227, ntokens=17249, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.37, wps=3278.1, ups=0.19, wpb=17249, bsz=1024, num_updates=4520, lr=4.66225e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28871
2024-11-09 14:55:45 - progress_bar.py[line:274] - INFO: epoch 013:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.247, ntokens=17484.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.49, wps=3325.8, ups=0.19, wpb=17484.2, bsz=1024, num_updates=4530, lr=4.6608e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28924
2024-11-09 14:56:38 - progress_bar.py[line:274] - INFO: epoch 013:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.27, ntokens=17385.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.65, wps=3301.7, ups=0.19, wpb=17385.1, bsz=1015.4, num_updates=4540, lr=4.65934e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=28976
2024-11-09 14:57:31 - progress_bar.py[line:274] - INFO: epoch 013:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.22, ntokens=17362.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3302.7, ups=0.19, wpb=17362.9, bsz=1024, num_updates=4550, lr=4.65789e-05, gnorm=0.004, clip=0, loss_scale=32768, train_wall=31, gb_free=13.5, wall=29029
2024-11-09 14:58:23 - progress_bar.py[line:274] - INFO: epoch 013:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.238, ntokens=17455.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.43, wps=3318.6, ups=0.19, wpb=17455.5, bsz=1024, num_updates=4560, lr=4.65644e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29082
2024-11-09 14:59:16 - progress_bar.py[line:274] - INFO: epoch 013:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=17288.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3274.4, ups=0.19, wpb=17288.5, bsz=1024, num_updates=4570, lr=4.65498e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29134
2024-11-09 15:00:09 - progress_bar.py[line:274] - INFO: epoch 013:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.205, ntokens=17027, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.22, wps=3215.7, ups=0.19, wpb=17027, bsz=1024, num_updates=4580, lr=4.65353e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=29187
2024-11-09 15:01:02 - progress_bar.py[line:274] - INFO: epoch 013:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.236, ntokens=17427.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.42, wps=3271.8, ups=0.19, wpb=17427.5, bsz=1024, num_updates=4590, lr=4.65208e-05, gnorm=0.006, clip=0, loss_scale=32768, train_wall=30, gb_free=13.4, wall=29241
2024-11-09 15:01:55 - progress_bar.py[line:274] - INFO: epoch 013:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.266, ntokens=17566.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.62, wps=3313.6, ups=0.19, wpb=17566.9, bsz=1024, num_updates=4600, lr=4.65062e-05, gnorm=0.005, clip=0, loss_scale=32768, train_wall=30, gb_free=13.3, wall=29294
2024-11-09 15:02:48 - progress_bar.py[line:274] - INFO: epoch 013:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17464.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3309.9, ups=0.19, wpb=17464.7, bsz=1024, num_updates=4610, lr=4.64917e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=29346
2024-11-09 15:03:41 - progress_bar.py[line:274] - INFO: epoch 013:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.204, ntokens=17241.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.21, wps=3288.2, ups=0.19, wpb=17241.5, bsz=1024, num_updates=4620, lr=4.64772e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=29399
2024-11-09 15:04:33 - progress_bar.py[line:274] - INFO: epoch 013:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.241, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3327.9, ups=0.19, wpb=17455, bsz=1024, num_updates=4630, lr=4.64626e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=29451
2024-11-09 15:05:27 - progress_bar.py[line:274] - INFO: epoch 013:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.24, ntokens=17327.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.45, wps=3179.1, ups=0.18, wpb=17327.3, bsz=1024, num_updates=4640, lr=4.64481e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=37, gb_free=13.5, wall=29506
2024-11-09 15:06:24 - progress_bar.py[line:274] - INFO: epoch 013:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17510, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3086.1, ups=0.18, wpb=17510, bsz=1024, num_updates=4650, lr=4.64336e-05, gnorm=0.003, clip=0, loss_scale=65536, train_wall=57, gb_free=13.5, wall=29562
2024-11-09 15:07:18 - progress_bar.py[line:274] - INFO: epoch 013:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.199, ntokens=17257.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3233.1, ups=0.19, wpb=17257.9, bsz=1024, num_updates=4660, lr=4.6419e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=53, gb_free=13.5, wall=29616
2024-11-09 15:08:09 - progress_bar.py[line:274] - INFO: epoch 013:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.241, ntokens=17399.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.46, wps=3354.5, ups=0.19, wpb=17399.9, bsz=1024, num_updates=4670, lr=4.64045e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=29668
2024-11-09 15:09:02 - progress_bar.py[line:274] - INFO: epoch 013:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.211, ntokens=17320.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3298.3, ups=0.19, wpb=17320.9, bsz=1024, num_updates=4680, lr=4.639e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=29720
2024-11-09 15:09:55 - progress_bar.py[line:274] - INFO: epoch 013:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.255, ntokens=17593.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.54, wps=3336.4, ups=0.19, wpb=17593.7, bsz=1024, num_updates=4690, lr=4.63754e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=51, gb_free=13.5, wall=29773
2024-11-09 15:10:47 - progress_bar.py[line:274] - INFO: epoch 013:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.214, ntokens=17426.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3361.4, ups=0.19, wpb=17426.5, bsz=1024, num_updates=4700, lr=4.63609e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=29825
2024-11-09 15:11:38 - progress_bar.py[line:274] - INFO: epoch 013:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.271, ntokens=17627.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.65, wps=3411.2, ups=0.19, wpb=17627.2, bsz=1024, num_updates=4710, lr=4.63464e-05, gnorm=0.01, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=29876
2024-11-09 15:12:31 - progress_bar.py[line:274] - INFO: epoch 013:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17730.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3332.2, ups=0.19, wpb=17730.8, bsz=1024, num_updates=4720, lr=4.63318e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=29930
2024-11-09 15:13:24 - progress_bar.py[line:274] - INFO: epoch 013:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.272, ntokens=17648.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.66, wps=3335.1, ups=0.19, wpb=17648.7, bsz=1024, num_updates=4730, lr=4.63173e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=29983
2024-11-09 15:14:17 - progress_bar.py[line:274] - INFO: epoch 013:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.317, ntokens=17802.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.96, wps=3383.3, ups=0.19, wpb=17802.5, bsz=1024, num_updates=4740, lr=4.63028e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.3, wall=30035
2024-11-09 15:15:09 - progress_bar.py[line:274] - INFO: epoch 013:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.247, ntokens=17781.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3388.2, ups=0.19, wpb=17781.5, bsz=1024, num_updates=4750, lr=4.62882e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=30088
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt2024-11-09 15:15:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 4758 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
2024-11-09 15:15:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 15:17:37 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 1 seek offset 46806slice_id 5 seek offset 234027

slice_id 7 seek offset 327637
2024-11-09 15:19:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 13 @ 4758 updates, score 0) (writing took 219.9149120229995 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_13.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
2024-11-09 15:20:23 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-09 15:20:23 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.237 | ntokens 17409.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.43 | wps 2704.3 | ups 0.16 | wpb 17409.2 | bsz 1023.1 | num_updates 4758 | lr 4.62766e-05 | gnorm 0.006 | clip 0 | loss_scale 65536 | train_wall 1376 | gb_free 13.4 | wall 30401
2024-11-09 15:20:23 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 15:22:51 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-09 15:22:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 15:23:04 - progress_bar.py[line:274] - INFO: epoch 014:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.187, ntokens=16883.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=356.1, ups=0.02, wpb=16883.3, bsz=998.4, num_updates=4760, lr=4.62737e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=45, gb_free=13.1, wall=30562
2024-11-09 15:23:57 - progress_bar.py[line:274] - INFO: epoch 014:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.197, ntokens=17383.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3264, ups=0.19, wpb=17383.9, bsz=1024, num_updates=4770, lr=4.62592e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=30615
2024-11-09 15:24:49 - progress_bar.py[line:274] - INFO: epoch 014:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17339.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3312.7, ups=0.19, wpb=17339.3, bsz=1024, num_updates=4780, lr=4.62446e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.6, wall=30667
2024-11-09 15:25:42 - progress_bar.py[line:274] - INFO: epoch 014:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.19, ntokens=17402.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.13, wps=3298.4, ups=0.19, wpb=17402.3, bsz=1024, num_updates=4790, lr=4.62301e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.6, wall=30720
2024-11-09 15:26:34 - progress_bar.py[line:274] - INFO: epoch 014:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.248, ntokens=17564.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.5, wps=3365.9, ups=0.19, wpb=17564.8, bsz=1024, num_updates=4800, lr=4.62156e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30772
2024-11-09 15:27:27 - progress_bar.py[line:274] - INFO: epoch 014:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.208, ntokens=17232.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3267, ups=0.19, wpb=17232.2, bsz=1024, num_updates=4810, lr=4.6201e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.3, wall=30825
2024-11-09 15:28:20 - progress_bar.py[line:274] - INFO: epoch 014:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.213, ntokens=17421.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3305.4, ups=0.19, wpb=17421.4, bsz=1024, num_updates=4820, lr=4.61865e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=30878
2024-11-09 15:29:12 - progress_bar.py[line:274] - INFO: epoch 014:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17465.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.33, wps=3311.7, ups=0.19, wpb=17465.8, bsz=1024, num_updates=4830, lr=4.6172e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.2, wall=30931
2024-11-09 15:30:07 - progress_bar.py[line:274] - INFO: epoch 014:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.234, ntokens=17570.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.41, wps=3221.7, ups=0.18, wpb=17570.6, bsz=1024, num_updates=4840, lr=4.61574e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=30985
2024-11-09 15:31:00 - progress_bar.py[line:274] - INFO: epoch 014:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.249, ntokens=17608, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.51, wps=3339.8, ups=0.19, wpb=17608, bsz=1024, num_updates=4850, lr=4.61429e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31038
2024-11-09 15:31:52 - progress_bar.py[line:274] - INFO: epoch 014:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17219.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3285.5, ups=0.19, wpb=17219.7, bsz=1024, num_updates=4860, lr=4.61284e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.4, wall=31090
2024-11-09 15:32:45 - progress_bar.py[line:274] - INFO: epoch 014:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.197, ntokens=17339.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3281.3, ups=0.19, wpb=17339.1, bsz=1024, num_updates=4870, lr=4.61138e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31143
2024-11-09 15:33:38 - progress_bar.py[line:274] - INFO: epoch 014:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.215, ntokens=17318, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3261.5, ups=0.19, wpb=17318, bsz=1024, num_updates=4880, lr=4.60993e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31196
2024-11-09 15:34:31 - progress_bar.py[line:274] - INFO: epoch 014:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.145, ntokens=17223.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3254.5, ups=0.19, wpb=17223.7, bsz=1024, num_updates=4890, lr=4.60848e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31249
2024-11-09 15:35:22 - progress_bar.py[line:274] - INFO: epoch 014:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.232, ntokens=17299.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.39, wps=3354.4, ups=0.19, wpb=17299.1, bsz=1015.4, num_updates=4900, lr=4.60702e-05, gnorm=0.008, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31301
2024-11-09 15:36:15 - progress_bar.py[line:274] - INFO: epoch 014:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.22, ntokens=17518.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3320.2, ups=0.19, wpb=17518.7, bsz=1024, num_updates=4910, lr=4.60557e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=30, gb_free=13.4, wall=31353
2024-11-09 15:37:08 - progress_bar.py[line:274] - INFO: epoch 014:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17258, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3287, ups=0.19, wpb=17258, bsz=1024, num_updates=4920, lr=4.60412e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=31, gb_free=13.5, wall=31406
2024-11-09 15:38:01 - progress_bar.py[line:274] - INFO: epoch 014:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17065.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3233, ups=0.19, wpb=17065.7, bsz=1024, num_updates=4930, lr=4.60266e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=30, gb_free=13.5, wall=31459
2024-11-09 15:38:55 - progress_bar.py[line:274] - INFO: epoch 014:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17189.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.01, wps=3174.2, ups=0.18, wpb=17189.9, bsz=1024, num_updates=4940, lr=4.60121e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=34, gb_free=13.5, wall=31513
2024-11-09 15:39:49 - progress_bar.py[line:274] - INFO: epoch 014:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.215, ntokens=17444.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.28, wps=3200.7, ups=0.18, wpb=17444.4, bsz=1024, num_updates=4950, lr=4.59976e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.5, wall=31567
2024-11-09 15:40:44 - progress_bar.py[line:274] - INFO: epoch 014:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.206, ntokens=17363, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.23, wps=3159.4, ups=0.18, wpb=17363, bsz=1024, num_updates=4960, lr=4.5983e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=55, gb_free=13.5, wall=31622
2024-11-09 15:41:40 - progress_bar.py[line:274] - INFO: epoch 014:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.225, ntokens=17507.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.35, wps=3149.1, ups=0.18, wpb=17507.7, bsz=1024, num_updates=4970, lr=4.59685e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=31678
2024-11-09 15:42:36 - progress_bar.py[line:274] - INFO: epoch 014:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17380.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3102.8, ups=0.18, wpb=17380.9, bsz=1024, num_updates=4980, lr=4.5954e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.5, wall=31734
2024-11-09 15:43:32 - progress_bar.py[line:274] - INFO: epoch 014:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17288.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3083, ups=0.18, wpb=17288.2, bsz=1024, num_updates=4990, lr=4.59394e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=56, gb_free=13.4, wall=31790
2024-11-09 15:44:26 - progress_bar.py[line:274] - INFO: epoch 014:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.251, ntokens=17532.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.52, wps=3248.5, ups=0.19, wpb=17532.4, bsz=1024, num_updates=5000, lr=4.59249e-05, gnorm=0.004, clip=0, loss_scale=65536, train_wall=54, gb_free=13.2, wall=31844
loss_reg: 0.00806672630901797 loss_cls: 0.004271258600056171
loss_reg: 0.007941405355627686 loss_cls: 0.004073519259691238
loss_reg: 0.014080229970654449 loss_cls: 0.0032543065026402473
loss_reg: 0.010966963398733333 loss_cls: 0.003510525915771723
loss_reg: 0.007939664437792579 loss_cls: 0.0033796951174736023
loss_reg: 0.006388822797892404 loss_cls: 0.004326281137764454
loss_reg: 0.008458856449981483 loss_cls: 0.004434662871062756
loss_reg: 0.009056498571357204 loss_cls: 0.003976412117481232
loss_reg: 0.007062864432210928 loss_cls: 0.004059621132910252
loss_reg: 0.008298797812995896 loss_cls: 0.00410294346511364
loss_reg: 0.010296160821799277 loss_cls: 0.0038781047333031893
loss_reg: 0.007327043592549192 loss_cls: 0.003918664995580912
loss_reg: 0.012398111240602208 loss_cls: 0.0031562678050249815
loss_reg: 0.014556576642606121 loss_cls: 0.0037306814920157194
loss_reg: 0.011872158797343985 loss_cls: 0.0038473159074783325
loss_reg: 0.008900961145475318 loss_cls: 0.003373170970007777
loss_reg: 0.010153681795480641 loss_cls: 0.0034124283120036125
loss_reg: 0.013490148078991602 loss_cls: 0.0034278943203389645
loss_reg: 0.012469458889298457 loss_cls: 0.0034247487783432007
loss_reg: 0.010857636787805252 loss_cls: 0.003596630645915866
loss_reg: 0.010363016829984105 loss_cls: 0.004716555587947369
loss_reg: 0.016759998508162385 loss_cls: 0.0033038302790373564
loss_reg: 0.01326584325288001 loss_cls: 0.0028487101662904024
loss_reg: 0.010046148787992398 loss_cls: 0.00484867999330163
loss_reg: 0.009968259979389937 loss_cls: 0.003587080165743828
loss_reg: 0.01188989243342902 loss_cls: 0.003155103884637356
loss_reg: 0.009096947827649235 loss_cls: 0.00374038890004158
loss_reg: 0.010241268387123623 loss_cls: 0.003886788384988904
loss_reg: 0.010041062171371126 loss_cls: 0.0033937895204871893
loss_reg: 0.010376611053185051 loss_cls: 0.00518687441945076
loss_reg: 0.014509666828218474 loss_cls: 0.003372752806171775
loss_reg: 0.010211486556286356 loss_cls: 0.003495622891932726
loss_reg: 0.013173396489015075 loss_cls: 0.004539900925010443
loss_reg: 0.008051209609562963 loss_cls: 0.0033224071376025677
loss_reg: 0.017215556544361736 loss_cls: 0.003167686052620411
loss_reg: 0.016508554282910676 loss_cls: 0.0035320911556482315
loss_reg: 0.012195700208100017 loss_cls: 0.0035623260773718357
loss_reg: 0.01225755233418918 loss_cls: 0.004268628545105457
loss_reg: 0.008872573562316861 loss_cls: 0.0037080682814121246
loss_reg: 0.013962144225185798 loss_cls: 0.004719488322734833
loss_reg: 0.006939695814826363 loss_cls: 0.004070920404046774
loss_reg: 0.010987674248985136 loss_cls: 0.004009419586509466
loss_reg: 0.012808902349967797 loss_cls: 0.0029206550680100918
loss_reg: 0.012437376203519677 loss_cls: 0.0033529784996062517
loss_reg: 0.012940273225240136 loss_cls: 0.0030667257960885763
loss_reg: 0.013706983359450482 loss_cls: 0.0033122836612164974
loss_reg: 0.0154835457982838 loss_cls: 0.0029206869658082724
loss_reg: 0.013068961394830558 loss_cls: 0.0036204387433826923
loss_reg: 0.015472188950277 loss_cls: 0.004165834281593561
loss_reg: 0.009404683586128308 loss_cls: 0.003515748307108879
loss_reg: 0.010979589169962552 loss_cls: 0.00330048194155097
loss_reg: 0.009824098654014056 loss_cls: 0.003332891035825014
loss_reg: 0.01358840221150709 loss_cls: 0.003243989311158657
loss_reg: 0.011446333958676952 loss_cls: 0.0037074892316013575
loss_reg: 0.01243547762609574 loss_cls: 0.003460933919996023
loss_reg: 0.014049658404962273 loss_cls: 0.0034518844913691282
loss_reg: 0.013784141427896263 loss_cls: 0.003319316543638706
loss_reg: 0.013243830677273163 loss_cls: 0.004403602797538042
loss_reg: 0.014630445910967764 loss_cls: 0.0033089190255850554
loss_reg: 0.014137450251218457 loss_cls: 0.003221169812604785
loss_reg: 0.012769731947366393 loss_cls: 0.0030340575613081455
loss_reg: 0.00883595885636856 loss_cls: 0.00395653210580349
loss_reg: 0.011070817014391103 loss_cls: 0.003603253746405244
loss_reg: 0.011037441479693079 loss_cls: 0.0030853624921292067
2024-11-09 15:45:19 - progress_bar.py[line:274] - INFO: epoch 014:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.195, ntokens=17307.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3240.2, ups=0.19, wpb=17307.9, bsz=1024, num_updates=5010, lr=4.59104e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.4, wall=31897
2024-11-09 15:46:13 - progress_bar.py[line:274] - INFO: epoch 014:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17378.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3211.6, ups=0.18, wpb=17378.8, bsz=1024, num_updates=5020, lr=4.58958e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=54, gb_free=13.4, wall=31952
2024-11-09 15:47:05 - progress_bar.py[line:274] - INFO: epoch 014:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.228, ntokens=17481.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.37, wps=3372.8, ups=0.19, wpb=17481.8, bsz=1024, num_updates=5030, lr=4.58813e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=52, gb_free=13.4, wall=32003
2024-11-09 15:47:57 - progress_bar.py[line:274] - INFO: epoch 014:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.212, ntokens=17507.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.27, wps=3380.7, ups=0.19, wpb=17507.6, bsz=1024, num_updates=5040, lr=4.58668e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=52, gb_free=13.3, wall=32055
2024-11-09 15:48:49 - progress_bar.py[line:274] - INFO: epoch 014:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17150.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3290.5, ups=0.19, wpb=17150.7, bsz=1024, num_updates=5050, lr=4.58522e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=49, gb_free=13.5, wall=32107
2024-11-09 15:49:40 - progress_bar.py[line:274] - INFO: epoch 014:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.203, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.21, wps=3422.1, ups=0.2, wpb=17478.4, bsz=1024, num_updates=5060, lr=4.58377e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=38, gb_free=13.4, wall=32158
2024-11-09 15:50:33 - progress_bar.py[line:274] - INFO: epoch 014:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17507.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3340.1, ups=0.19, wpb=17507.6, bsz=1024, num_updates=5070, lr=4.58232e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=33, gb_free=13.2, wall=32211
2024-11-09 15:51:25 - progress_bar.py[line:274] - INFO: epoch 014:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.273, ntokens=17895.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.67, wps=3424.1, ups=0.19, wpb=17895.7, bsz=1024, num_updates=5080, lr=4.58086e-05, gnorm=0.006, clip=0, loss_scale=65536, train_wall=39, gb_free=13.2, wall=32263
2024-11-09 15:52:18 - progress_bar.py[line:274] - INFO: epoch 014:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.218, ntokens=17551.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3325.2, ups=0.19, wpb=17551.2, bsz=1024, num_updates=5090, lr=4.57941e-05, gnorm=0.007, clip=0, loss_scale=65536, train_wall=43, gb_free=13.4, wall=32316
2024-11-09 15:53:10 - progress_bar.py[line:274] - INFO: epoch 014:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.223, ntokens=17612.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.34, wps=3369.9, ups=0.19, wpb=17612.8, bsz=1024, num_updates=5100, lr=4.57796e-05, gnorm=0.009, clip=0, loss_scale=65536, train_wall=47, gb_free=13.4, wall=32368
2024-11-09 15:54:03 - progress_bar.py[line:274] - INFO: epoch 014:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.257, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.56, wps=3318.3, ups=0.19, wpb=17590.9, bsz=1024, num_updates=5110, lr=4.5765e-05, gnorm=0.005, clip=0, loss_scale=65536, train_wall=53, gb_free=13.1, wall=32421
2024-11-09 15:54:55 - progress_bar.py[line:274] - INFO: epoch 014:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.209, ntokens=17588.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3343.4, ups=0.19, wpb=17588.6, bsz=1024, num_updates=5120, lr=4.57505e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=32474
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 15:55:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 5124 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
2024-11-09 15:55:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 15:56:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 15:58:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 14 @ 5124 updates, score 0) (writing took 216.2230951070087 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_14.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 15:59:45 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-09 15:59:45 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.21 | ntokens 17402.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.26 | wps 2697.3 | ups 0.15 | wpb 17402.9 | bsz 1023.1 | num_updates 5124 | lr 4.57447e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1468 | gb_free 13.3 | wall 32763
2024-11-09 15:59:45 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 16:02:12 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-09 16:02:12 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 16:02:46 - progress_bar.py[line:274] - INFO: epoch 015:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.175, ntokens=16904.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=359.3, ups=0.02, wpb=16904.3, bsz=998.4, num_updates=5130, lr=4.5736e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=36, gb_free=13.2, wall=32944
2024-11-09 16:03:39 - progress_bar.py[line:274] - INFO: epoch 015:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.218, ntokens=17564.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.3, wps=3312.9, ups=0.19, wpb=17564.1, bsz=1024, num_updates=5140, lr=4.57214e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=32997
2024-11-09 16:04:31 - progress_bar.py[line:274] - INFO: epoch 015:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.178, ntokens=17350.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.05, wps=3311.8, ups=0.19, wpb=17350.7, bsz=1024, num_updates=5150, lr=4.57069e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=33050
2024-11-09 16:05:24 - progress_bar.py[line:274] - INFO: epoch 015:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.211, ntokens=17447.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.26, wps=3290.5, ups=0.19, wpb=17447.5, bsz=1024, num_updates=5160, lr=4.56924e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=33103
2024-11-09 16:06:17 - progress_bar.py[line:274] - INFO: epoch 015:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=17319.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3311.6, ups=0.19, wpb=17319.6, bsz=1024, num_updates=5170, lr=4.56778e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=33155
2024-11-09 16:07:10 - progress_bar.py[line:274] - INFO: epoch 015:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.231, ntokens=17569.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.39, wps=3326.9, ups=0.19, wpb=17569.5, bsz=1024, num_updates=5180, lr=4.56633e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=33208
2024-11-09 16:08:02 - progress_bar.py[line:274] - INFO: epoch 015:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17529.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3354.8, ups=0.19, wpb=17529.5, bsz=1024, num_updates=5190, lr=4.56488e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=33260
2024-11-09 16:08:55 - progress_bar.py[line:274] - INFO: epoch 015:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.192, ntokens=17435.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3301.1, ups=0.19, wpb=17435.2, bsz=1024, num_updates=5200, lr=4.56342e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33313
2024-11-09 16:09:47 - progress_bar.py[line:274] - INFO: epoch 015:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.18, ntokens=17464.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3326.2, ups=0.19, wpb=17464.9, bsz=1024, num_updates=5210, lr=4.56197e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=33365
2024-11-09 16:10:40 - progress_bar.py[line:274] - INFO: epoch 015:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.219, ntokens=17544.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.31, wps=3314.7, ups=0.19, wpb=17544.3, bsz=1024, num_updates=5220, lr=4.56052e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33418
2024-11-09 16:11:33 - progress_bar.py[line:274] - INFO: epoch 015:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17391.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3267.5, ups=0.19, wpb=17391.1, bsz=1024, num_updates=5230, lr=4.55906e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=33471
2024-11-09 16:12:26 - progress_bar.py[line:274] - INFO: epoch 015:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.195, ntokens=17498.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3305.6, ups=0.19, wpb=17498.5, bsz=1024, num_updates=5240, lr=4.55761e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33524
2024-11-09 16:13:19 - progress_bar.py[line:274] - INFO: epoch 015:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.192, ntokens=17420.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3292.5, ups=0.19, wpb=17420.3, bsz=1024, num_updates=5250, lr=4.55616e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=33577
2024-11-09 16:14:11 - progress_bar.py[line:274] - INFO: epoch 015:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.19, ntokens=17475.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3350.8, ups=0.19, wpb=17475.3, bsz=1024, num_updates=5260, lr=4.5547e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33629
2024-11-09 16:15:04 - progress_bar.py[line:274] - INFO: epoch 015:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.198, ntokens=17396.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.18, wps=3297.7, ups=0.19, wpb=17396.8, bsz=1024, num_updates=5270, lr=4.55325e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=33682
2024-11-09 16:15:56 - progress_bar.py[line:274] - INFO: epoch 015:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17160.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3277.6, ups=0.19, wpb=17160.2, bsz=1024, num_updates=5280, lr=4.5518e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=33735
2024-11-09 16:16:49 - progress_bar.py[line:274] - INFO: epoch 015:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.2, ntokens=17441.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.19, wps=3325.4, ups=0.19, wpb=17441.3, bsz=1024, num_updates=5290, lr=4.55034e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=33787
2024-11-09 16:17:42 - progress_bar.py[line:274] - INFO: epoch 015:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.185, ntokens=17484.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.1, wps=3278.7, ups=0.19, wpb=17484.2, bsz=1024, num_updates=5300, lr=4.54889e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=33840
2024-11-09 16:18:35 - progress_bar.py[line:274] - INFO: epoch 015:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.222, ntokens=17370.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.33, wps=3258.6, ups=0.19, wpb=17370.2, bsz=1024, num_updates=5310, lr=4.54744e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33894
2024-11-09 16:19:28 - progress_bar.py[line:274] - INFO: epoch 015:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17239.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3273.8, ups=0.19, wpb=17239.8, bsz=1024, num_updates=5320, lr=4.54598e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=33946
2024-11-09 16:20:21 - progress_bar.py[line:274] - INFO: epoch 015:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.186, ntokens=17400.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.1, wps=3296.2, ups=0.19, wpb=17400.7, bsz=1024, num_updates=5330, lr=4.54453e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=33999
2024-11-09 16:21:14 - progress_bar.py[line:274] - INFO: epoch 015:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3281.8, ups=0.19, wpb=17269.4, bsz=1024, num_updates=5340, lr=4.54308e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=34052
2024-11-09 16:22:07 - progress_bar.py[line:274] - INFO: epoch 015:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.196, ntokens=17661.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3325, ups=0.19, wpb=17661.6, bsz=1024, num_updates=5350, lr=4.54162e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=34105
2024-11-09 16:22:59 - progress_bar.py[line:274] - INFO: epoch 015:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.21, ntokens=17371, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3299.6, ups=0.19, wpb=17371, bsz=1024, num_updates=5360, lr=4.54017e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=34157
2024-11-09 16:23:52 - progress_bar.py[line:274] - INFO: epoch 015:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.195, ntokens=17444.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.16, wps=3321.9, ups=0.19, wpb=17444.9, bsz=1024, num_updates=5370, lr=4.53872e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=34210
2024-11-09 16:24:44 - progress_bar.py[line:274] - INFO: epoch 015:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.185, ntokens=17433, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3310.7, ups=0.19, wpb=17433, bsz=1024, num_updates=5380, lr=4.53726e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34263
2024-11-09 16:25:37 - progress_bar.py[line:274] - INFO: epoch 015:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=17162.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3276.3, ups=0.19, wpb=17162.9, bsz=1024, num_updates=5390, lr=4.53581e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=34315
2024-11-09 16:26:30 - progress_bar.py[line:274] - INFO: epoch 015:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.125, ntokens=16968.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3220.8, ups=0.19, wpb=16968.3, bsz=1015.4, num_updates=5400, lr=4.53436e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34368
2024-11-09 16:27:22 - progress_bar.py[line:274] - INFO: epoch 015:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.149, ntokens=17077.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3251, ups=0.19, wpb=17077.2, bsz=1024, num_updates=5410, lr=4.5329e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34420
2024-11-09 16:28:15 - progress_bar.py[line:274] - INFO: epoch 015:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17335.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3268, ups=0.19, wpb=17335.6, bsz=1024, num_updates=5420, lr=4.53145e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=34473
2024-11-09 16:29:07 - progress_bar.py[line:274] - INFO: epoch 015:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.181, ntokens=17488.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3368.8, ups=0.19, wpb=17488.2, bsz=1024, num_updates=5430, lr=4.53e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=34525
2024-11-09 16:29:58 - progress_bar.py[line:274] - INFO: epoch 015:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.246, ntokens=17770.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.49, wps=3452.4, ups=0.19, wpb=17770.5, bsz=1024, num_updates=5440, lr=4.52854e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=34577
2024-11-09 16:30:50 - progress_bar.py[line:274] - INFO: epoch 015:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.187, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.11, wps=3378, ups=0.19, wpb=17521.3, bsz=1024, num_updates=5450, lr=4.52709e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=34629
2024-11-09 16:31:43 - progress_bar.py[line:274] - INFO: epoch 015:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.204, ntokens=17501.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.21, wps=3336.1, ups=0.19, wpb=17501.2, bsz=1024, num_updates=5460, lr=4.52564e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=41, gb_free=13.5, wall=34681
2024-11-09 16:32:35 - progress_bar.py[line:274] - INFO: epoch 015:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=17366.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3303.2, ups=0.19, wpb=17366.5, bsz=1024, num_updates=5470, lr=4.52418e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=34734
2024-11-09 16:33:27 - progress_bar.py[line:274] - INFO: epoch 015:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.203, ntokens=17535.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.21, wps=3365.1, ups=0.19, wpb=17535.8, bsz=1024, num_updates=5480, lr=4.52273e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=52, gb_free=13.1, wall=34786
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 16:34:16 - progress_bar.py[line:274] - INFO: epoch 015:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.165, ntokens=17039.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.97, wps=3498.9, ups=0.21, wpb=17039.5, bsz=998.4, num_updates=5490, lr=4.52128e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=47, gb_free=13.4, wall=34834
2024-11-09 16:34:16 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 5490 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-09 16:34:16 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt': File exists: File exists
: File exists

: File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 16:35:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
2024-11-09 16:37:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 15 @ 5490 updates, score 0) (writing took 211.26794118701946 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_15.pt
2024-11-09 16:38:42 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-09 16:38:42 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.187 | ntokens 17398.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.11 | wps 2724.3 | ups 0.16 | wpb 17398.2 | bsz 1023.1 | num_updates 5490 | lr 4.52128e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1183 | gb_free 13.4 | wall 35100
2024-11-09 16:38:42 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 16:41:14 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-09 16:41:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 16:42:09 - progress_bar.py[line:274] - INFO: epoch 016:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17223.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=364.2, ups=0.02, wpb=17223.8, bsz=1024, num_updates=5500, lr=4.51982e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=35307
2024-11-09 16:43:02 - progress_bar.py[line:274] - INFO: epoch 016:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.198, ntokens=17573.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.17, wps=3317.7, ups=0.19, wpb=17573.7, bsz=1024, num_updates=5510, lr=4.51837e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=35360
2024-11-09 16:43:55 - progress_bar.py[line:274] - INFO: epoch 016:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17411.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3319.9, ups=0.19, wpb=17411.5, bsz=1024, num_updates=5520, lr=4.51692e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=35413
2024-11-09 16:44:48 - progress_bar.py[line:274] - INFO: epoch 016:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.166, ntokens=17458.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3264.3, ups=0.19, wpb=17458.9, bsz=1024, num_updates=5530, lr=4.51546e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=35466
2024-11-09 16:45:43 - progress_bar.py[line:274] - INFO: epoch 016:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.185, ntokens=17426, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3191.4, ups=0.18, wpb=17426, bsz=1024, num_updates=5540, lr=4.51401e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=35521
2024-11-09 16:46:36 - progress_bar.py[line:274] - INFO: epoch 016:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.168, ntokens=17492.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.99, wps=3286, ups=0.19, wpb=17492.4, bsz=1024, num_updates=5550, lr=4.51256e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=35574
2024-11-09 16:47:29 - progress_bar.py[line:274] - INFO: epoch 016:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.148, ntokens=17397.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3300.5, ups=0.19, wpb=17397.2, bsz=1024, num_updates=5560, lr=4.5111e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=35627
2024-11-09 16:48:22 - progress_bar.py[line:274] - INFO: epoch 016:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.208, ntokens=17676.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.24, wps=3330.5, ups=0.19, wpb=17676.4, bsz=1024, num_updates=5570, lr=4.50965e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=35680
2024-11-09 16:49:15 - progress_bar.py[line:274] - INFO: epoch 016:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17224.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3253.1, ups=0.19, wpb=17224.5, bsz=1024, num_updates=5580, lr=4.5082e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=35733
2024-11-09 16:50:07 - progress_bar.py[line:274] - INFO: epoch 016:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17345.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3299.9, ups=0.19, wpb=17345.3, bsz=1024, num_updates=5590, lr=4.50674e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=35785
2024-11-09 16:51:00 - progress_bar.py[line:274] - INFO: epoch 016:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17218.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3288.8, ups=0.19, wpb=17218.1, bsz=1024, num_updates=5600, lr=4.50529e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=35838
2024-11-09 16:51:52 - progress_bar.py[line:274] - INFO: epoch 016:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.221, ntokens=17741.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.32, wps=3384, ups=0.19, wpb=17741.6, bsz=1024, num_updates=5610, lr=4.50384e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=35890
2024-11-09 16:52:45 - progress_bar.py[line:274] - INFO: epoch 016:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.149, ntokens=17315.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3270.9, ups=0.19, wpb=17315.7, bsz=1024, num_updates=5620, lr=4.50238e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=35943
2024-11-09 16:53:38 - progress_bar.py[line:274] - INFO: epoch 016:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.192, ntokens=17479.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3299.2, ups=0.19, wpb=17479.3, bsz=1024, num_updates=5630, lr=4.50093e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=35996
2024-11-09 16:54:31 - progress_bar.py[line:274] - INFO: epoch 016:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.244, ntokens=17820, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.47, wps=3376.4, ups=0.19, wpb=17820, bsz=1024, num_updates=5640, lr=4.49948e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=36049
2024-11-09 16:54:36 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 16:55:30 - progress_bar.py[line:274] - INFO: epoch 016:    161 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.152, ntokens=17397.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=2941.9, ups=0.17, wpb=17397.9, bsz=1024, num_updates=5650, lr=4.49802e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=36108
2024-11-09 16:56:23 - progress_bar.py[line:274] - INFO: epoch 016:    171 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.167, ntokens=17478.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3291.2, ups=0.19, wpb=17478.8, bsz=1024, num_updates=5660, lr=4.49657e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=36161
2024-11-09 16:57:16 - progress_bar.py[line:274] - INFO: epoch 016:    181 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17528.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3301.5, ups=0.19, wpb=17528.4, bsz=1024, num_updates=5670, lr=4.49512e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=36214
2024-11-09 16:58:09 - progress_bar.py[line:274] - INFO: epoch 016:    191 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.169, ntokens=17366.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3288.5, ups=0.19, wpb=17366.4, bsz=1024, num_updates=5680, lr=4.49366e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=36267
2024-11-09 16:59:02 - progress_bar.py[line:274] - INFO: epoch 016:    201 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=17441.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3258.4, ups=0.19, wpb=17441.7, bsz=1024, num_updates=5690, lr=4.49221e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=32, gb_free=13.5, wall=36321
2024-11-09 16:59:56 - progress_bar.py[line:274] - INFO: epoch 016:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.184, ntokens=17529.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.09, wps=3244.5, ups=0.19, wpb=17529.2, bsz=1024, num_updates=5700, lr=4.49076e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.2, wall=36375
2024-11-09 17:00:49 - progress_bar.py[line:274] - INFO: epoch 016:    221 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.142, ntokens=17373.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3326, ups=0.19, wpb=17373.7, bsz=1024, num_updates=5710, lr=4.4893e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=36427
2024-11-09 17:01:42 - progress_bar.py[line:274] - INFO: epoch 016:    231 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17268.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3251, ups=0.19, wpb=17268.8, bsz=1024, num_updates=5720, lr=4.48785e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=48, gb_free=13.4, wall=36480
2024-11-09 17:02:35 - progress_bar.py[line:274] - INFO: epoch 016:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17346.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3282.5, ups=0.19, wpb=17346.7, bsz=1024, num_updates=5730, lr=4.4864e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=50, gb_free=13.4, wall=36533
2024-11-09 17:03:27 - progress_bar.py[line:274] - INFO: epoch 016:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.152, ntokens=17331.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3305.8, ups=0.19, wpb=17331.4, bsz=1024, num_updates=5740, lr=4.48494e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=47, gb_free=13.4, wall=36585
2024-11-09 17:04:19 - progress_bar.py[line:274] - INFO: epoch 016:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17097.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3273.8, ups=0.19, wpb=17097.3, bsz=1024, num_updates=5750, lr=4.48349e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=43, gb_free=13.5, wall=36637
2024-11-09 17:05:12 - progress_bar.py[line:274] - INFO: epoch 016:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=17601.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3330.9, ups=0.19, wpb=17601.3, bsz=1024, num_updates=5760, lr=4.48204e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=36690
2024-11-09 17:06:05 - progress_bar.py[line:274] - INFO: epoch 016:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.129, ntokens=17197.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3245.6, ups=0.19, wpb=17197.2, bsz=1024, num_updates=5770, lr=4.48058e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=36743
2024-11-09 17:06:58 - progress_bar.py[line:274] - INFO: epoch 016:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=17559.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3333.7, ups=0.19, wpb=17559.7, bsz=1024, num_updates=5780, lr=4.47913e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=36796
2024-11-09 17:07:50 - progress_bar.py[line:274] - INFO: epoch 016:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.146, ntokens=17251.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3279.1, ups=0.19, wpb=17251.3, bsz=1024, num_updates=5790, lr=4.47768e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=37, gb_free=13.2, wall=36849
2024-11-09 17:08:43 - progress_bar.py[line:274] - INFO: epoch 016:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17567.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3329.3, ups=0.19, wpb=17567.2, bsz=1024, num_updates=5800, lr=4.47622e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=49, gb_free=13.5, wall=36901
2024-11-09 17:09:36 - progress_bar.py[line:274] - INFO: epoch 016:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.268, ntokens=18035.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=3430.1, ups=0.19, wpb=18035.1, bsz=1024, num_updates=5810, lr=4.47477e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=36954
2024-11-09 17:10:29 - progress_bar.py[line:274] - INFO: epoch 016:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.201, ntokens=17692.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.2, wps=3338, ups=0.19, wpb=17692.4, bsz=1024, num_updates=5820, lr=4.47332e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=37007
2024-11-09 17:11:20 - progress_bar.py[line:274] - INFO: epoch 016:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.193, ntokens=17601.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.14, wps=3400.1, ups=0.19, wpb=17601.4, bsz=1015.4, num_updates=5830, lr=4.47186e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.3, wall=37059
2024-11-09 17:12:13 - progress_bar.py[line:274] - INFO: epoch 016:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=17413.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3326.8, ups=0.19, wpb=17413.4, bsz=1024, num_updates=5840, lr=4.47041e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=37111
2024-11-09 17:13:05 - progress_bar.py[line:274] - INFO: epoch 016:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=17664.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3405.1, ups=0.19, wpb=17664.7, bsz=1024, num_updates=5850, lr=4.46896e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=37163
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 17:13:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 5855 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
2024-11-09 17:13:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

2024-11-09 17:15:15 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
2024-11-09 17:17:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 16 @ 5855 updates, score 0) (writing took 218.11708818405168 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_16.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442


slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
2024-11-09 17:18:01 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-09 17:18:01 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.173 | ntokens 17447.4 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 9.02 | wps 2699 | ups 0.15 | wpb 17447.4 | bsz 1023.1 | num_updates 5855 | lr 4.46823e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1368 | gb_free 13.4 | wall 37460
2024-11-09 17:18:01 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 17:20:29 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-09 17:20:29 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 17:20:58 - progress_bar.py[line:274] - INFO: epoch 017:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=16982.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=358.8, ups=0.02, wpb=16982.3, bsz=998.4, num_updates=5860, lr=4.4675e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=39, gb_free=13.4, wall=37636
2024-11-09 17:21:51 - progress_bar.py[line:274] - INFO: epoch 017:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17387.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3277, ups=0.19, wpb=17387.6, bsz=1024, num_updates=5870, lr=4.46605e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=37689
2024-11-09 17:22:43 - progress_bar.py[line:274] - INFO: epoch 017:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17330.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3310.5, ups=0.19, wpb=17330.1, bsz=1024, num_updates=5880, lr=4.4646e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=37742
2024-11-09 17:23:36 - progress_bar.py[line:274] - INFO: epoch 017:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17389.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3313.4, ups=0.19, wpb=17389.5, bsz=1024, num_updates=5890, lr=4.46314e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=37794
2024-11-09 17:24:29 - progress_bar.py[line:274] - INFO: epoch 017:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.194, ntokens=17574.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.15, wps=3324.8, ups=0.19, wpb=17574.1, bsz=1024, num_updates=5900, lr=4.46169e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=37847
2024-11-09 17:25:21 - progress_bar.py[line:274] - INFO: epoch 017:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.129, ntokens=17368.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3316.4, ups=0.19, wpb=17368.3, bsz=1024, num_updates=5910, lr=4.46024e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=37899
2024-11-09 17:26:14 - progress_bar.py[line:274] - INFO: epoch 017:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17296.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3290.6, ups=0.19, wpb=17296.6, bsz=1024, num_updates=5920, lr=4.45878e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=37952
2024-11-09 17:27:07 - progress_bar.py[line:274] - INFO: epoch 017:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=17223.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3246.7, ups=0.19, wpb=17223.2, bsz=1024, num_updates=5930, lr=4.45733e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38005
2024-11-09 17:27:59 - progress_bar.py[line:274] - INFO: epoch 017:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17419.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3318.4, ups=0.19, wpb=17419.9, bsz=1024, num_updates=5940, lr=4.45588e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38057
2024-11-09 17:28:53 - progress_bar.py[line:274] - INFO: epoch 017:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17437.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3246.3, ups=0.19, wpb=17437.8, bsz=1024, num_updates=5950, lr=4.45442e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38111
2024-11-09 17:29:46 - progress_bar.py[line:274] - INFO: epoch 017:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.153, ntokens=17365.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3289.4, ups=0.19, wpb=17365.4, bsz=1024, num_updates=5960, lr=4.45297e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=38164
2024-11-09 17:30:39 - progress_bar.py[line:274] - INFO: epoch 017:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.148, ntokens=17322.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3243, ups=0.19, wpb=17322.5, bsz=1024, num_updates=5970, lr=4.45152e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38217
2024-11-09 17:31:32 - progress_bar.py[line:274] - INFO: epoch 017:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=17286.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3288.3, ups=0.19, wpb=17286.1, bsz=1024, num_updates=5980, lr=4.45006e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38270
2024-11-09 17:32:25 - progress_bar.py[line:274] - INFO: epoch 017:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17468.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3277.4, ups=0.19, wpb=17468.2, bsz=1024, num_updates=5990, lr=4.44861e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=38323
2024-11-09 17:33:18 - progress_bar.py[line:274] - INFO: epoch 017:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.171, ntokens=17460.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9, wps=3325.6, ups=0.19, wpb=17460.7, bsz=1024, num_updates=6000, lr=4.44716e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38376
2024-11-09 17:34:10 - progress_bar.py[line:274] - INFO: epoch 017:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.162, ntokens=17609.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3356.3, ups=0.19, wpb=17609.2, bsz=1024, num_updates=6010, lr=4.4457e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38428
2024-11-09 17:35:03 - progress_bar.py[line:274] - INFO: epoch 017:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.179, ntokens=17581.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.06, wps=3320.5, ups=0.19, wpb=17581.4, bsz=1024, num_updates=6020, lr=4.44425e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38481
2024-11-09 17:35:55 - progress_bar.py[line:274] - INFO: epoch 017:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.155, ntokens=17419.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3316.9, ups=0.19, wpb=17419.2, bsz=1024, num_updates=6030, lr=4.4428e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38534
2024-11-09 17:36:49 - progress_bar.py[line:274] - INFO: epoch 017:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17272.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3245, ups=0.19, wpb=17272.4, bsz=1024, num_updates=6040, lr=4.44134e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=38587
2024-11-09 17:37:41 - progress_bar.py[line:274] - INFO: epoch 017:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17506.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3361.9, ups=0.19, wpb=17506.9, bsz=1024, num_updates=6050, lr=4.43989e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38639
2024-11-09 17:38:34 - progress_bar.py[line:274] - INFO: epoch 017:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.134, ntokens=17405.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3300.8, ups=0.19, wpb=17405.2, bsz=1024, num_updates=6060, lr=4.43844e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=38692
2024-11-09 17:39:26 - progress_bar.py[line:274] - INFO: epoch 017:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.121, ntokens=17269.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3267.9, ups=0.19, wpb=17269.2, bsz=1024, num_updates=6070, lr=4.43698e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38745
2024-11-09 17:40:19 - progress_bar.py[line:274] - INFO: epoch 017:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17486.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3290.8, ups=0.19, wpb=17486.6, bsz=1024, num_updates=6080, lr=4.43553e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38798
2024-11-09 17:41:12 - progress_bar.py[line:274] - INFO: epoch 017:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.167, ntokens=17455, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.98, wps=3308.8, ups=0.19, wpb=17455, bsz=1024, num_updates=6090, lr=4.43408e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=38850
2024-11-09 17:42:05 - progress_bar.py[line:274] - INFO: epoch 017:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.114, ntokens=17095.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3226.3, ups=0.19, wpb=17095.5, bsz=1024, num_updates=6100, lr=4.43262e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=38903
2024-11-09 17:42:58 - progress_bar.py[line:274] - INFO: epoch 017:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17275.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3274.3, ups=0.19, wpb=17275.9, bsz=1024, num_updates=6110, lr=4.43117e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=38956
2024-11-09 17:43:51 - progress_bar.py[line:274] - INFO: epoch 017:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17235.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3222.9, ups=0.19, wpb=17235.3, bsz=1024, num_updates=6120, lr=4.42972e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=39010
2024-11-09 17:44:45 - progress_bar.py[line:274] - INFO: epoch 017:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.149, ntokens=17435.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.87, wps=3254.2, ups=0.19, wpb=17435.1, bsz=1024, num_updates=6130, lr=4.42826e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=39063
2024-11-09 17:45:39 - progress_bar.py[line:274] - INFO: epoch 017:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17287.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3206.2, ups=0.19, wpb=17287.8, bsz=1024, num_updates=6140, lr=4.42681e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=39117
2024-11-09 17:46:33 - progress_bar.py[line:274] - INFO: epoch 017:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17115.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=3191, ups=0.19, wpb=17115.6, bsz=1024, num_updates=6150, lr=4.42536e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=39171
2024-11-09 17:47:25 - progress_bar.py[line:274] - INFO: epoch 017:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.14, ntokens=17481.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3313.4, ups=0.19, wpb=17481.6, bsz=1024, num_updates=6160, lr=4.4239e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=36, gb_free=13.4, wall=39224
2024-11-09 17:47:36 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 17:48:21 - progress_bar.py[line:274] - INFO: epoch 017:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.21, ntokens=17806.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.25, wps=3175.6, ups=0.18, wpb=17806.8, bsz=1024, num_updates=6170, lr=4.42245e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=41, gb_free=13.4, wall=39280
2024-11-09 17:49:14 - progress_bar.py[line:274] - INFO: epoch 017:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17595.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3379.7, ups=0.19, wpb=17595.4, bsz=1024, num_updates=6180, lr=4.421e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=37, gb_free=13.3, wall=39332
2024-11-09 17:50:06 - progress_bar.py[line:274] - INFO: epoch 017:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.132, ntokens=17331.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3287.8, ups=0.19, wpb=17331.6, bsz=1024, num_updates=6190, lr=4.41954e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=39, gb_free=13.3, wall=39384
2024-11-09 17:50:58 - progress_bar.py[line:274] - INFO: epoch 017:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.156, ntokens=17543.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.91, wps=3390.2, ups=0.19, wpb=17543.8, bsz=1024, num_updates=6200, lr=4.41809e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=39436
2024-11-09 17:51:50 - progress_bar.py[line:274] - INFO: epoch 017:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.177, ntokens=17532.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3370.2, ups=0.19, wpb=17532.2, bsz=1015.4, num_updates=6210, lr=4.41664e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=38, gb_free=13.2, wall=39488
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 17:52:39 - progress_bar.py[line:274] - INFO: epoch 017:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17162.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3475.3, ups=0.2, wpb=17162.3, bsz=998.4, num_updates=6220, lr=4.41518e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=42, gb_free=13.4, wall=39538
2024-11-09 17:52:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 6220 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
2024-11-09 17:52:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 17:54:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-09 17:56:26 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 17 @ 6220 updates, score 0) (writing took 226.4684371780022 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_17.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
2024-11-09 17:57:22 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-09 17:57:22 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.146 | ntokens 17395.5 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.85 | wps 2690.2 | ups 0.15 | wpb 17395.5 | bsz 1023.1 | num_updates 6220 | lr 4.41518e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1165 | gb_free 13.4 | wall 39820
2024-11-09 17:57:22 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 17:59:49 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-09 17:59:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 18:00:44 - progress_bar.py[line:274] - INFO: epoch 018:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17484.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=361.1, ups=0.02, wpb=17484.4, bsz=1024, num_updates=6230, lr=4.41373e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=40022
2024-11-09 18:01:37 - progress_bar.py[line:274] - INFO: epoch 018:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17187.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3244.4, ups=0.19, wpb=17187.2, bsz=1024, num_updates=6240, lr=4.41228e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40075
2024-11-09 18:02:29 - progress_bar.py[line:274] - INFO: epoch 018:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17420.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3300.7, ups=0.19, wpb=17420.2, bsz=1024, num_updates=6250, lr=4.41082e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40128
2024-11-09 18:03:22 - progress_bar.py[line:274] - INFO: epoch 018:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17217.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3278.7, ups=0.19, wpb=17217.8, bsz=1015.4, num_updates=6260, lr=4.40937e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40180
2024-11-09 18:04:15 - progress_bar.py[line:274] - INFO: epoch 018:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.147, ntokens=17326.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.86, wps=3285.6, ups=0.19, wpb=17326.2, bsz=1024, num_updates=6270, lr=4.40792e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40233
2024-11-09 18:05:08 - progress_bar.py[line:274] - INFO: epoch 018:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17291.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3224.3, ups=0.19, wpb=17291.6, bsz=1024, num_updates=6280, lr=4.40646e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40286
2024-11-09 18:06:01 - progress_bar.py[line:274] - INFO: epoch 018:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17247.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3274.9, ups=0.19, wpb=17247.5, bsz=1024, num_updates=6290, lr=4.40501e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40339
2024-11-09 18:06:54 - progress_bar.py[line:274] - INFO: epoch 018:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17413.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3295.5, ups=0.19, wpb=17413.5, bsz=1024, num_updates=6300, lr=4.40356e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=40392
2024-11-09 18:07:46 - progress_bar.py[line:274] - INFO: epoch 018:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17290.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3283, ups=0.19, wpb=17290.9, bsz=1024, num_updates=6310, lr=4.4021e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40445
2024-11-09 18:08:39 - progress_bar.py[line:274] - INFO: epoch 018:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17249.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3266, ups=0.19, wpb=17249.1, bsz=1024, num_updates=6320, lr=4.40065e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40497
2024-11-09 18:09:32 - progress_bar.py[line:274] - INFO: epoch 018:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17330.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3251.9, ups=0.19, wpb=17330.5, bsz=1024, num_updates=6330, lr=4.3992e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40551
2024-11-09 18:10:26 - progress_bar.py[line:274] - INFO: epoch 018:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.175, ntokens=17632.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.03, wps=3302.5, ups=0.19, wpb=17632.9, bsz=1024, num_updates=6340, lr=4.39774e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40604
2024-11-09 18:11:19 - progress_bar.py[line:274] - INFO: epoch 018:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17152.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3221.9, ups=0.19, wpb=17152.6, bsz=1024, num_updates=6350, lr=4.39629e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40657
2024-11-09 18:12:11 - progress_bar.py[line:274] - INFO: epoch 018:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.143, ntokens=17456.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3345.2, ups=0.19, wpb=17456.6, bsz=1024, num_updates=6360, lr=4.39484e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=40710
2024-11-09 18:13:03 - progress_bar.py[line:274] - INFO: epoch 018:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17786.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3426.1, ups=0.19, wpb=17786.4, bsz=1024, num_updates=6370, lr=4.39338e-05, gnorm=0.011, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=40761
2024-11-09 18:13:56 - progress_bar.py[line:274] - INFO: epoch 018:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17477.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3319.6, ups=0.19, wpb=17477.3, bsz=1024, num_updates=6380, lr=4.39193e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=40814
2024-11-09 18:14:49 - progress_bar.py[line:274] - INFO: epoch 018:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.151, ntokens=17405.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3269.5, ups=0.19, wpb=17405.5, bsz=1024, num_updates=6390, lr=4.39048e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=40867
2024-11-09 18:15:42 - progress_bar.py[line:274] - INFO: epoch 018:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.141, ntokens=17555.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.82, wps=3347.3, ups=0.19, wpb=17555.3, bsz=1024, num_updates=6400, lr=4.38902e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40920
2024-11-09 18:16:34 - progress_bar.py[line:274] - INFO: epoch 018:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17217.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3263.9, ups=0.19, wpb=17217.5, bsz=1024, num_updates=6410, lr=4.38757e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=40973
2024-11-09 18:17:28 - progress_bar.py[line:274] - INFO: epoch 018:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17447.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3250.8, ups=0.19, wpb=17447.2, bsz=1024, num_updates=6420, lr=4.38612e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=41026
2024-11-09 18:18:21 - progress_bar.py[line:274] - INFO: epoch 018:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.102, ntokens=17195.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3231.7, ups=0.19, wpb=17195.3, bsz=1024, num_updates=6430, lr=4.38466e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=41079
2024-11-09 18:19:15 - progress_bar.py[line:274] - INFO: epoch 018:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.128, ntokens=17474.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3257.8, ups=0.19, wpb=17474.2, bsz=1024, num_updates=6440, lr=4.38321e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=41133
2024-11-09 18:20:08 - progress_bar.py[line:274] - INFO: epoch 018:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.176, ntokens=17677.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.04, wps=3344.6, ups=0.19, wpb=17677.6, bsz=1024, num_updates=6450, lr=4.38176e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=41186
2024-11-09 18:21:00 - progress_bar.py[line:274] - INFO: epoch 018:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17335.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3311, ups=0.19, wpb=17335.8, bsz=1024, num_updates=6460, lr=4.3803e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=41238
2024-11-09 18:21:52 - progress_bar.py[line:274] - INFO: epoch 018:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17302.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3310.8, ups=0.19, wpb=17302.7, bsz=1024, num_updates=6470, lr=4.37885e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=41291
2024-11-09 18:22:45 - progress_bar.py[line:274] - INFO: epoch 018:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.144, ntokens=17443.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.84, wps=3311.5, ups=0.19, wpb=17443.7, bsz=1024, num_updates=6480, lr=4.3774e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=41343
2024-11-09 18:23:38 - progress_bar.py[line:274] - INFO: epoch 018:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.106, ntokens=17310.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=3269, ups=0.19, wpb=17310.2, bsz=1024, num_updates=6490, lr=4.37594e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=41396
2024-11-09 18:24:30 - progress_bar.py[line:274] - INFO: epoch 018:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17064.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3253.2, ups=0.19, wpb=17064.3, bsz=1024, num_updates=6500, lr=4.37449e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=41449
2024-11-09 18:25:24 - progress_bar.py[line:274] - INFO: epoch 018:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17214.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3227.9, ups=0.19, wpb=17214.8, bsz=1024, num_updates=6510, lr=4.37304e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=41502
2024-11-09 18:26:16 - progress_bar.py[line:274] - INFO: epoch 018:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.103, ntokens=17405, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3306, ups=0.19, wpb=17405, bsz=1024, num_updates=6520, lr=4.37158e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=41555
2024-11-09 18:27:08 - progress_bar.py[line:274] - INFO: epoch 018:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=17435, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3388.7, ups=0.19, wpb=17435, bsz=1024, num_updates=6530, lr=4.37013e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=41606
2024-11-09 18:28:00 - progress_bar.py[line:274] - INFO: epoch 018:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.189, ntokens=17735.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.12, wps=3371.7, ups=0.19, wpb=17735.3, bsz=1024, num_updates=6540, lr=4.36868e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=41659
2024-11-09 18:28:53 - progress_bar.py[line:274] - INFO: epoch 018:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.142, ntokens=17635.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.83, wps=3333.3, ups=0.19, wpb=17635.8, bsz=1024, num_updates=6550, lr=4.36722e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=34, gb_free=13.2, wall=41712
2024-11-09 18:29:46 - progress_bar.py[line:274] - INFO: epoch 018:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17800.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3355, ups=0.19, wpb=17800.3, bsz=1024, num_updates=6560, lr=4.36577e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=47, gb_free=13.2, wall=41765
2024-11-09 18:30:39 - progress_bar.py[line:274] - INFO: epoch 018:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.161, ntokens=17580.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.95, wps=3312.5, ups=0.19, wpb=17580.6, bsz=1024, num_updates=6570, lr=4.36432e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=41818
2024-11-09 18:31:33 - progress_bar.py[line:274] - INFO: epoch 018:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.183, ntokens=17968.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.08, wps=3352.7, ups=0.19, wpb=17968.3, bsz=1024, num_updates=6580, lr=4.36286e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=41871
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 18:32:02 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 6586 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
2024-11-09 18:32:02 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 18:33:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
2024-11-09 18:35:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 18 @ 6586 updates, score 0) (writing took 219.06153917004121 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_18.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
2024-11-09 18:36:37 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-09 18:36:37 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.133 | ntokens 17412.6 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.77 | wps 2706.1 | ups 0.16 | wpb 17412.6 | bsz 1023.1 | num_updates 6586 | lr 4.36199e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1185 | gb_free 13.3 | wall 42175
2024-11-09 18:36:37 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 18:39:05 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-09 18:39:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 18:39:28 - progress_bar.py[line:274] - INFO: epoch 019:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.121, ntokens=17001, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=357.9, ups=0.02, wpb=17001, bsz=998.4, num_updates=6590, lr=4.36141e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=41, gb_free=13.5, wall=42346
2024-11-09 18:40:22 - progress_bar.py[line:274] - INFO: epoch 019:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.122, ntokens=17519.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3258.9, ups=0.19, wpb=17519.2, bsz=1024, num_updates=6600, lr=4.35996e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=42400
2024-11-09 18:41:15 - progress_bar.py[line:274] - INFO: epoch 019:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.123, ntokens=17455.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.71, wps=3278.2, ups=0.19, wpb=17455.3, bsz=1024, num_updates=6610, lr=4.3585e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=42453
2024-11-09 18:42:09 - progress_bar.py[line:274] - INFO: epoch 019:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17451.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3262.7, ups=0.19, wpb=17451.2, bsz=1024, num_updates=6620, lr=4.35705e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42507
2024-11-09 18:43:02 - progress_bar.py[line:274] - INFO: epoch 019:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17102.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3227.4, ups=0.19, wpb=17102.7, bsz=1024, num_updates=6630, lr=4.3556e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42560
2024-11-09 18:43:55 - progress_bar.py[line:274] - INFO: epoch 019:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17283.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3249.7, ups=0.19, wpb=17283.2, bsz=1024, num_updates=6640, lr=4.35414e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42613
2024-11-09 18:44:48 - progress_bar.py[line:274] - INFO: epoch 019:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.127, ntokens=17508, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.74, wps=3314.2, ups=0.19, wpb=17508, bsz=1024, num_updates=6650, lr=4.35269e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42666
2024-11-09 18:45:40 - progress_bar.py[line:274] - INFO: epoch 019:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.1, ntokens=17231.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3253.1, ups=0.19, wpb=17231.3, bsz=1024, num_updates=6660, lr=4.35124e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42719
2024-11-09 18:46:34 - progress_bar.py[line:274] - INFO: epoch 019:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17350.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3246.8, ups=0.19, wpb=17350.2, bsz=1024, num_updates=6670, lr=4.34978e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=42772
2024-11-09 18:46:56 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 18:47:33 - progress_bar.py[line:274] - INFO: epoch 019:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.093, ntokens=17250.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=2907.3, ups=0.17, wpb=17250.8, bsz=1024, num_updates=6680, lr=4.34833e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=42831
2024-11-09 18:48:27 - progress_bar.py[line:274] - INFO: epoch 019:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.138, ntokens=17380, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3251.2, ups=0.19, wpb=17380, bsz=1024, num_updates=6690, lr=4.34688e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=42885
2024-11-09 18:49:19 - progress_bar.py[line:274] - INFO: epoch 019:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17316.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3287.6, ups=0.19, wpb=17316.6, bsz=1015.4, num_updates=6700, lr=4.34542e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42938
2024-11-09 18:50:13 - progress_bar.py[line:274] - INFO: epoch 019:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.096, ntokens=17331.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3256.4, ups=0.19, wpb=17331.9, bsz=1024, num_updates=6710, lr=4.34397e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=42991
2024-11-09 18:51:05 - progress_bar.py[line:274] - INFO: epoch 019:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.096, ntokens=17342.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3291.2, ups=0.19, wpb=17342.3, bsz=1024, num_updates=6720, lr=4.34252e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=43044
2024-11-09 18:51:57 - progress_bar.py[line:274] - INFO: epoch 019:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.124, ntokens=17370.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3330.4, ups=0.19, wpb=17370.8, bsz=1024, num_updates=6730, lr=4.34106e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=43096
2024-11-09 18:52:51 - progress_bar.py[line:274] - INFO: epoch 019:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.163, ntokens=17767.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.96, wps=3303.8, ups=0.19, wpb=17767.9, bsz=1024, num_updates=6740, lr=4.33961e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=34, gb_free=13.5, wall=43149
2024-11-09 18:53:45 - progress_bar.py[line:274] - INFO: epoch 019:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.102, ntokens=17319.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3213.6, ups=0.19, wpb=17319.6, bsz=1024, num_updates=6750, lr=4.33816e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=45, gb_free=13.5, wall=43203
2024-11-09 18:54:38 - progress_bar.py[line:274] - INFO: epoch 019:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17413.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3279.4, ups=0.19, wpb=17413.3, bsz=1024, num_updates=6760, lr=4.33671e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=43256
2024-11-09 18:55:31 - progress_bar.py[line:274] - INFO: epoch 019:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.12, ntokens=17268.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.7, wps=3269.8, ups=0.19, wpb=17268.1, bsz=1024, num_updates=6770, lr=4.33525e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=43309
2024-11-09 18:56:24 - progress_bar.py[line:274] - INFO: epoch 019:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17187.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3228, ups=0.19, wpb=17187.3, bsz=1024, num_updates=6780, lr=4.3338e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=43363
2024-11-09 18:57:18 - progress_bar.py[line:274] - INFO: epoch 019:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.16, ntokens=17773.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.94, wps=3311, ups=0.19, wpb=17773.1, bsz=1024, num_updates=6790, lr=4.33235e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=43416
2024-11-09 18:58:12 - progress_bar.py[line:274] - INFO: epoch 019:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17347.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3240.7, ups=0.19, wpb=17347.3, bsz=1024, num_updates=6800, lr=4.33089e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=43470
2024-11-09 18:59:05 - progress_bar.py[line:274] - INFO: epoch 019:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.137, ntokens=17763.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.8, wps=3351.5, ups=0.19, wpb=17763.1, bsz=1024, num_updates=6810, lr=4.32944e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=43523
2024-11-09 18:59:57 - progress_bar.py[line:274] - INFO: epoch 019:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.152, ntokens=17512.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.89, wps=3308.8, ups=0.19, wpb=17512.5, bsz=1024, num_updates=6820, lr=4.32799e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=49, gb_free=13.5, wall=43576
2024-11-09 19:00:51 - progress_bar.py[line:274] - INFO: epoch 019:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.098, ntokens=17351.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3241.6, ups=0.19, wpb=17351.9, bsz=1024, num_updates=6830, lr=4.32653e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=45, gb_free=13.4, wall=43629
2024-11-09 19:01:47 - progress_bar.py[line:274] - INFO: epoch 019:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.096, ntokens=17279.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3110.4, ups=0.18, wpb=17279.5, bsz=1024, num_updates=6840, lr=4.32508e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=43685
2024-11-09 19:02:41 - progress_bar.py[line:274] - INFO: epoch 019:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.108, ntokens=17295.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3148.6, ups=0.18, wpb=17295.4, bsz=1024, num_updates=6850, lr=4.32363e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=43740
2024-11-09 19:03:37 - progress_bar.py[line:274] - INFO: epoch 019:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17463.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3159.3, ups=0.18, wpb=17463.4, bsz=1024, num_updates=6860, lr=4.32217e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=43795
2024-11-09 19:04:32 - progress_bar.py[line:274] - INFO: epoch 019:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.093, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3138, ups=0.18, wpb=17239.6, bsz=1024, num_updates=6870, lr=4.32072e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=43850
2024-11-09 19:05:27 - progress_bar.py[line:274] - INFO: epoch 019:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17070.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3093.2, ups=0.18, wpb=17070.5, bsz=1024, num_updates=6880, lr=4.31927e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=43905
2024-11-09 19:06:22 - progress_bar.py[line:274] - INFO: epoch 019:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17355.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3133, ups=0.18, wpb=17355.7, bsz=1024, num_updates=6890, lr=4.31781e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=43960
2024-11-09 19:07:18 - progress_bar.py[line:274] - INFO: epoch 019:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.116, ntokens=17496.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3139.6, ups=0.18, wpb=17496.2, bsz=1024, num_updates=6900, lr=4.31636e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=44016
2024-11-09 19:08:14 - progress_bar.py[line:274] - INFO: epoch 019:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.118, ntokens=17572.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.68, wps=3149.2, ups=0.18, wpb=17572.4, bsz=1024, num_updates=6910, lr=4.31491e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=44072
2024-11-09 19:09:09 - progress_bar.py[line:274] - INFO: epoch 019:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.13, ntokens=17537.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.75, wps=3161.5, ups=0.18, wpb=17537.7, bsz=1024, num_updates=6920, lr=4.31345e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=44127
2024-11-09 19:10:05 - progress_bar.py[line:274] - INFO: epoch 019:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17477.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3123.3, ups=0.18, wpb=17477.9, bsz=1024, num_updates=6930, lr=4.312e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=44183
2024-11-09 19:11:01 - progress_bar.py[line:274] - INFO: epoch 019:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.159, ntokens=17794.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.93, wps=3173.8, ups=0.18, wpb=17794.8, bsz=1024, num_updates=6940, lr=4.31055e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=44239
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 19:11:57 - progress_bar.py[line:274] - INFO: epoch 019:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.125, ntokens=17632.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.72, wps=3180.5, ups=0.18, wpb=17632.7, bsz=1024, num_updates=6950, lr=4.30909e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=44295
2024-11-09 19:12:00 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 6951 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
2024-11-09 19:12:00 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt': File exists
: File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 19:13:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
2024-11-09 19:15:42 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 19 @ 6951 updates, score 0) (writing took 222.69888507400174 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_19.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 19:16:38 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-09 19:16:38 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.112 | ntokens 17395.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.64 | wps 2644.3 | ups 0.15 | wpb 17395.7 | bsz 1023.1 | num_updates 6951 | lr 4.30895e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1597 | gb_free 13.3 | wall 44576
2024-11-09 19:16:38 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 19:19:06 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-09 19:19:06 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 19:19:56 - progress_bar.py[line:274] - INFO: epoch 020:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=16674.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=347.7, ups=0.02, wpb=16674.1, bsz=998.4, num_updates=6960, lr=4.30764e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=44774
2024-11-09 19:20:49 - progress_bar.py[line:274] - INFO: epoch 020:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17116.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3235.8, ups=0.19, wpb=17116.9, bsz=1015.4, num_updates=6970, lr=4.30619e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=44827
2024-11-09 19:21:46 - progress_bar.py[line:274] - INFO: epoch 020:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17393, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3046.2, ups=0.18, wpb=17393, bsz=1024, num_updates=6980, lr=4.30473e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=47, gb_free=13.4, wall=44884
2024-11-09 19:22:43 - progress_bar.py[line:274] - INFO: epoch 020:     39 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.1, ntokens=17430.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3077.5, ups=0.18, wpb=17430.5, bsz=1024, num_updates=6990, lr=4.30328e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=44941
2024-11-09 19:23:39 - progress_bar.py[line:274] - INFO: epoch 020:     49 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17426.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3080.1, ups=0.18, wpb=17426.6, bsz=1024, num_updates=7000, lr=4.30183e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=44998
2024-11-09 19:24:36 - progress_bar.py[line:274] - INFO: epoch 020:     59 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17740.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3130.8, ups=0.18, wpb=17740.1, bsz=1024, num_updates=7010, lr=4.30037e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45054
2024-11-09 19:25:33 - progress_bar.py[line:274] - INFO: epoch 020:     69 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.125, ntokens=17684.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3094, ups=0.17, wpb=17684.3, bsz=1024, num_updates=7020, lr=4.29892e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=45112
2024-11-09 19:26:31 - progress_bar.py[line:274] - INFO: epoch 020:     79 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.15, ntokens=17593.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.88, wps=3066.2, ups=0.17, wpb=17593.3, bsz=1024, num_updates=7030, lr=4.29747e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=45169
2024-11-09 19:27:28 - progress_bar.py[line:274] - INFO: epoch 020:     89 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17287.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3022.6, ups=0.17, wpb=17287.1, bsz=1024, num_updates=7040, lr=4.29601e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45226
2024-11-09 19:28:24 - progress_bar.py[line:274] - INFO: epoch 020:     99 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.136, ntokens=17395.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.79, wps=3086.2, ups=0.18, wpb=17395.9, bsz=1024, num_updates=7050, lr=4.29456e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=45282
2024-11-09 19:29:21 - progress_bar.py[line:274] - INFO: epoch 020:    109 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.09, ntokens=17421.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3051.3, ups=0.18, wpb=17421.6, bsz=1024, num_updates=7060, lr=4.29311e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45340
2024-11-09 19:30:19 - progress_bar.py[line:274] - INFO: epoch 020:    119 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17359.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3020.8, ups=0.17, wpb=17359.5, bsz=1024, num_updates=7070, lr=4.29165e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=45397
2024-11-09 19:31:16 - progress_bar.py[line:274] - INFO: epoch 020:    129 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17259.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3020.9, ups=0.18, wpb=17259.8, bsz=1024, num_updates=7080, lr=4.2902e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=45454
2024-11-09 19:32:13 - progress_bar.py[line:274] - INFO: epoch 020:    139 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17446.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3048.8, ups=0.17, wpb=17446.6, bsz=1024, num_updates=7090, lr=4.28875e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.1, wall=45511
2024-11-09 19:33:10 - progress_bar.py[line:274] - INFO: epoch 020:    149 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.113, ntokens=17467.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.65, wps=3071.4, ups=0.18, wpb=17467.5, bsz=1024, num_updates=7100, lr=4.28729e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45568
2024-11-09 19:34:07 - progress_bar.py[line:274] - INFO: epoch 020:    159 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17425.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3076.8, ups=0.18, wpb=17425.6, bsz=1024, num_updates=7110, lr=4.28584e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45625
2024-11-09 19:35:03 - progress_bar.py[line:274] - INFO: epoch 020:    169 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17478.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3081.4, ups=0.18, wpb=17478.9, bsz=1024, num_updates=7120, lr=4.28439e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=45682
2024-11-09 19:35:59 - progress_bar.py[line:274] - INFO: epoch 020:    179 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17472.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3134.5, ups=0.18, wpb=17472.3, bsz=1024, num_updates=7130, lr=4.28293e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=45737
2024-11-09 19:36:55 - progress_bar.py[line:274] - INFO: epoch 020:    189 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17552.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3142, ups=0.18, wpb=17552.3, bsz=1024, num_updates=7140, lr=4.28148e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=45793
2024-11-09 19:37:49 - progress_bar.py[line:274] - INFO: epoch 020:    199 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.081, ntokens=17269.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3219.5, ups=0.19, wpb=17269.2, bsz=1024, num_updates=7150, lr=4.28003e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=45847
2024-11-09 19:38:42 - progress_bar.py[line:274] - INFO: epoch 020:    209 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17588.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3312.8, ups=0.19, wpb=17588.1, bsz=1024, num_updates=7160, lr=4.27857e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=45900
2024-11-09 19:39:36 - progress_bar.py[line:274] - INFO: epoch 020:    219 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17320, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3206.7, ups=0.19, wpb=17320, bsz=1024, num_updates=7170, lr=4.27712e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=45954
2024-11-09 19:40:30 - progress_bar.py[line:274] - INFO: epoch 020:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.119, ntokens=17614, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.69, wps=3271.1, ups=0.19, wpb=17614, bsz=1024, num_updates=7180, lr=4.27567e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=46008
2024-11-09 19:41:26 - progress_bar.py[line:274] - INFO: epoch 020:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=17430.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=3111.7, ups=0.18, wpb=17430.4, bsz=1024, num_updates=7190, lr=4.27421e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=46064
2024-11-09 19:42:23 - progress_bar.py[line:274] - INFO: epoch 020:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17538.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3073.1, ups=0.18, wpb=17538.3, bsz=1024, num_updates=7200, lr=4.27276e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=46121
2024-11-09 19:43:18 - progress_bar.py[line:274] - INFO: epoch 020:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17330.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3123.2, ups=0.18, wpb=17330.4, bsz=1024, num_updates=7210, lr=4.27131e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=46176
2024-11-09 19:44:14 - progress_bar.py[line:274] - INFO: epoch 020:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17220.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3084.5, ups=0.18, wpb=17220.2, bsz=1024, num_updates=7220, lr=4.26985e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=46232
2024-11-09 19:44:53 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 19:45:16 - progress_bar.py[line:274] - INFO: epoch 020:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.111, ntokens=17427.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.64, wps=2814.6, ups=0.16, wpb=17427.3, bsz=1024, num_updates=7230, lr=4.2684e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=62, gb_free=13.3, wall=46294
2024-11-09 19:46:13 - progress_bar.py[line:274] - INFO: epoch 020:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.114, ntokens=17516.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.66, wps=3070.6, ups=0.18, wpb=17516.7, bsz=1024, num_updates=7240, lr=4.26695e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=46351
2024-11-09 19:47:09 - progress_bar.py[line:274] - INFO: epoch 020:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17435.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3123.5, ups=0.18, wpb=17435.3, bsz=1024, num_updates=7250, lr=4.26549e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=46407
2024-11-09 19:48:05 - progress_bar.py[line:274] - INFO: epoch 020:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17366.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3092.3, ups=0.18, wpb=17366.7, bsz=1024, num_updates=7260, lr=4.26404e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=46463
2024-11-09 19:49:02 - progress_bar.py[line:274] - INFO: epoch 020:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.181, ntokens=17972.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=9.07, wps=3171.3, ups=0.18, wpb=17972.5, bsz=1024, num_updates=7270, lr=4.26259e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=46520
2024-11-09 19:49:58 - progress_bar.py[line:274] - INFO: epoch 020:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.146, ntokens=17697.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.85, wps=3124.3, ups=0.18, wpb=17697.3, bsz=1024, num_updates=7280, lr=4.26113e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=46576
2024-11-09 19:50:55 - progress_bar.py[line:274] - INFO: epoch 020:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17476, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3086.7, ups=0.18, wpb=17476, bsz=1024, num_updates=7290, lr=4.25968e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=46633
2024-11-09 19:51:52 - progress_bar.py[line:274] - INFO: epoch 020:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.108, ntokens=17557.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3099.5, ups=0.18, wpb=17557.9, bsz=1024, num_updates=7300, lr=4.25823e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=46690
2024-11-09 19:52:48 - progress_bar.py[line:274] - INFO: epoch 020:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.139, ntokens=17777.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.81, wps=3160.2, ups=0.18, wpb=17777.4, bsz=1024, num_updates=7310, lr=4.25677e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=46746
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 19:53:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 7316 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
2024-11-09 19:53:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 19:55:10 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
2024-11-09 19:57:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 20 @ 7316 updates, score 0) (writing took 223.40366961900145 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_20.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
2024-11-09 19:57:58 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-09 19:57:58 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.105 | ntokens 17448.3 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.6 | wps 2567.5 | ups 0.15 | wpb 17448.3 | bsz 1023.1 | num_updates 7316 | lr 4.2559e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1994 | gb_free 13.3 | wall 47057
2024-11-09 19:57:58 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 20:00:27 - trainer.py[line:703] - INFO: begin training epoch 21
2024-11-09 20:00:27 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 20:00:50 - progress_bar.py[line:274] - INFO: epoch 021:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=16976.6, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=351.8, ups=0.02, wpb=16976.6, bsz=998.4, num_updates=7320, lr=4.25532e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=44, gb_free=13.5, wall=47229
2024-11-09 20:01:43 - progress_bar.py[line:274] - INFO: epoch 021:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17490.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3321.9, ups=0.19, wpb=17490.2, bsz=1024, num_updates=7330, lr=4.25387e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=47281
2024-11-09 20:02:38 - progress_bar.py[line:274] - INFO: epoch 021:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.102, ntokens=17457.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3181.7, ups=0.18, wpb=17457.9, bsz=1024, num_updates=7340, lr=4.25241e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=37, gb_free=13.6, wall=47336
2024-11-09 20:03:34 - progress_bar.py[line:274] - INFO: epoch 021:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.126, ntokens=17633.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.73, wps=3140.9, ups=0.18, wpb=17633.3, bsz=1024, num_updates=7350, lr=4.25096e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=47392
2024-11-09 20:04:30 - progress_bar.py[line:274] - INFO: epoch 021:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3107.1, ups=0.18, wpb=17424.2, bsz=1024, num_updates=7360, lr=4.24951e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=47448
2024-11-09 20:05:26 - progress_bar.py[line:274] - INFO: epoch 021:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17539.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3134.7, ups=0.18, wpb=17539.4, bsz=1024, num_updates=7370, lr=4.24805e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=47504
2024-11-09 20:06:21 - progress_bar.py[line:274] - INFO: epoch 021:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.053, ntokens=17211.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3119.7, ups=0.18, wpb=17211.1, bsz=1024, num_updates=7380, lr=4.2466e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=47559
2024-11-09 20:07:17 - progress_bar.py[line:274] - INFO: epoch 021:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.103, ntokens=17547.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.59, wps=3167.8, ups=0.18, wpb=17547.8, bsz=1024, num_updates=7390, lr=4.24515e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=47615
2024-11-09 20:08:11 - progress_bar.py[line:274] - INFO: epoch 021:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.062, ntokens=17116.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3115.6, ups=0.18, wpb=17116.8, bsz=1015.4, num_updates=7400, lr=4.24369e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=47670
2024-11-09 20:09:09 - progress_bar.py[line:274] - INFO: epoch 021:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17467, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3052.2, ups=0.17, wpb=17467, bsz=1024, num_updates=7410, lr=4.24224e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=47727
2024-11-09 20:10:05 - progress_bar.py[line:274] - INFO: epoch 021:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.112, ntokens=17470.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.65, wps=3102, ups=0.18, wpb=17470.3, bsz=1024, num_updates=7420, lr=4.24079e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=47783
2024-11-09 20:11:02 - progress_bar.py[line:274] - INFO: epoch 021:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17409.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3083.6, ups=0.18, wpb=17409.9, bsz=1024, num_updates=7430, lr=4.23933e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=47840
2024-11-09 20:11:58 - progress_bar.py[line:274] - INFO: epoch 021:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17479.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3104.9, ups=0.18, wpb=17479.8, bsz=1024, num_updates=7440, lr=4.23788e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=47896
2024-11-09 20:12:55 - progress_bar.py[line:274] - INFO: epoch 021:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17053.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3007.7, ups=0.18, wpb=17053.1, bsz=1024, num_updates=7450, lr=4.23643e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=47953
2024-11-09 20:13:50 - progress_bar.py[line:274] - INFO: epoch 021:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.074, ntokens=17139.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3073.7, ups=0.18, wpb=17139.1, bsz=1024, num_updates=7460, lr=4.23497e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=48008
2024-11-09 20:14:47 - progress_bar.py[line:274] - INFO: epoch 021:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.135, ntokens=17809.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.78, wps=3127.3, ups=0.18, wpb=17809.5, bsz=1024, num_updates=7470, lr=4.23352e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=48065
2024-11-09 20:15:42 - progress_bar.py[line:274] - INFO: epoch 021:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17193.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3137, ups=0.18, wpb=17193.9, bsz=1024, num_updates=7480, lr=4.23207e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=48120
2024-11-09 20:16:37 - progress_bar.py[line:274] - INFO: epoch 021:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17605.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3189.2, ups=0.18, wpb=17605.6, bsz=1024, num_updates=7490, lr=4.23061e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=48175
2024-11-09 20:17:34 - progress_bar.py[line:274] - INFO: epoch 021:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.133, ntokens=17587.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.77, wps=3118.6, ups=0.18, wpb=17587.6, bsz=1024, num_updates=7500, lr=4.22916e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=48232
2024-11-09 20:18:27 - progress_bar.py[line:274] - INFO: epoch 021:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17178.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3239.1, ups=0.19, wpb=17178.8, bsz=1024, num_updates=7510, lr=4.22771e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=48285
2024-11-09 20:19:20 - progress_bar.py[line:274] - INFO: epoch 021:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17304.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3259.8, ups=0.19, wpb=17304.2, bsz=1024, num_updates=7520, lr=4.22625e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=48338
2024-11-09 20:20:14 - progress_bar.py[line:274] - INFO: epoch 021:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.083, ntokens=17470.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3229.8, ups=0.18, wpb=17470.6, bsz=1024, num_updates=7530, lr=4.2248e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.2, wall=48392
2024-11-09 20:21:10 - progress_bar.py[line:274] - INFO: epoch 021:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17305.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3064.4, ups=0.18, wpb=17305.1, bsz=1024, num_updates=7540, lr=4.22335e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=48449
2024-11-09 20:22:07 - progress_bar.py[line:274] - INFO: epoch 021:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.094, ntokens=17459, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.54, wps=3093.5, ups=0.18, wpb=17459, bsz=1024, num_updates=7550, lr=4.22189e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=48505
2024-11-09 20:23:04 - progress_bar.py[line:274] - INFO: epoch 021:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.051, ntokens=17076.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=2995.8, ups=0.18, wpb=17076.7, bsz=1024, num_updates=7560, lr=4.22044e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=48562
2024-11-09 20:24:01 - progress_bar.py[line:274] - INFO: epoch 021:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17285.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3026.5, ups=0.18, wpb=17285.8, bsz=1024, num_updates=7570, lr=4.21899e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=48619
2024-11-09 20:24:58 - progress_bar.py[line:274] - INFO: epoch 021:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17481.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3057.5, ups=0.17, wpb=17481.6, bsz=1024, num_updates=7580, lr=4.21753e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=48676
2024-11-09 20:25:56 - progress_bar.py[line:274] - INFO: epoch 021:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17450.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3009.3, ups=0.17, wpb=17450.9, bsz=1024, num_updates=7590, lr=4.21608e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=48734
2024-11-09 20:26:53 - progress_bar.py[line:274] - INFO: epoch 021:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17000.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=2963, ups=0.17, wpb=17000.2, bsz=1024, num_updates=7600, lr=4.21463e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=48792
2024-11-09 20:27:50 - progress_bar.py[line:274] - INFO: epoch 021:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17450.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3089.5, ups=0.18, wpb=17450.9, bsz=1024, num_updates=7610, lr=4.21317e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=48848
2024-11-09 20:28:47 - progress_bar.py[line:274] - INFO: epoch 021:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.079, ntokens=17354.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=3030.2, ups=0.17, wpb=17354.9, bsz=1024, num_updates=7620, lr=4.21172e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=48905
2024-11-09 20:29:42 - progress_bar.py[line:274] - INFO: epoch 021:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17498.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3178.6, ups=0.18, wpb=17498.6, bsz=1024, num_updates=7630, lr=4.21027e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=48960
2024-11-09 20:30:38 - progress_bar.py[line:274] - INFO: epoch 021:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.098, ntokens=17591.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3155.9, ups=0.18, wpb=17591.1, bsz=1024, num_updates=7640, lr=4.20881e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=49016
2024-11-09 20:31:35 - progress_bar.py[line:274] - INFO: epoch 021:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.101, ntokens=17632.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3111, ups=0.18, wpb=17632.2, bsz=1024, num_updates=7650, lr=4.20736e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=49073
2024-11-09 20:32:31 - progress_bar.py[line:274] - INFO: epoch 021:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17520.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3120.5, ups=0.18, wpb=17520.1, bsz=1024, num_updates=7660, lr=4.20591e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=49129
2024-11-09 20:33:28 - progress_bar.py[line:274] - INFO: epoch 021:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.131, ntokens=17698.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.76, wps=3099.2, ups=0.18, wpb=17698.4, bsz=1024, num_updates=7670, lr=4.20445e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=49186
2024-11-09 20:34:25 - progress_bar.py[line:274] - INFO: epoch 021:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.097, ntokens=17635.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.56, wps=3109.8, ups=0.18, wpb=17635.7, bsz=1024, num_updates=7680, lr=4.203e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.1, wall=49243
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 20:34:33 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 21 @ 7682 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt

2024-11-09 20:34:33 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 20:36:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-09 20:38:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 21 @ 7682 updates, score 0) (writing took 217.45502236299217 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_21.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
2024-11-09 20:39:06 - train.py[line:336] - INFO: end of epoch 21 (average epoch stats below)
2024-11-09 20:39:06 - progress_bar.py[line:282] - INFO: epoch 021 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.083 | ntokens 17405.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.48 | wps 2581.7 | ups 0.15 | wpb 17405.9 | bsz 1023.1 | num_updates 7682 | lr 4.20271e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 1991 | gb_free 13.5 | wall 49524
2024-11-09 20:39:06 - trainer.py[line:639] - INFO: loading train data for epoch 22
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 20:41:34 - trainer.py[line:703] - INFO: begin training epoch 22
2024-11-09 20:41:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 20:42:20 - progress_bar.py[line:274] - INFO: epoch 022:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=16882.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=355.4, ups=0.02, wpb=16882.5, bsz=998.4, num_updates=7690, lr=4.20155e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=49718
2024-11-09 20:43:16 - progress_bar.py[line:274] - INFO: epoch 022:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17245.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3037.9, ups=0.18, wpb=17245.9, bsz=1024, num_updates=7700, lr=4.20009e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=45, gb_free=13.6, wall=49775
2024-11-09 20:44:14 - progress_bar.py[line:274] - INFO: epoch 022:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17625.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=3078.9, ups=0.17, wpb=17625.5, bsz=1024, num_updates=7710, lr=4.19864e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=49832
2024-11-09 20:45:10 - progress_bar.py[line:274] - INFO: epoch 022:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.088, ntokens=17473, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3101.4, ups=0.18, wpb=17473, bsz=1024, num_updates=7720, lr=4.19719e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=49888
2024-11-09 20:46:06 - progress_bar.py[line:274] - INFO: epoch 022:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17308.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=3100.5, ups=0.18, wpb=17308.9, bsz=1024, num_updates=7730, lr=4.19573e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=49944
2024-11-09 20:47:02 - progress_bar.py[line:274] - INFO: epoch 022:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.073, ntokens=17510.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3101.9, ups=0.18, wpb=17510.3, bsz=1024, num_updates=7740, lr=4.19428e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=50001
2024-11-09 20:47:57 - progress_bar.py[line:274] - INFO: epoch 022:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17586.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3206.1, ups=0.18, wpb=17586.8, bsz=1024, num_updates=7750, lr=4.19283e-05, gnorm=0.008, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=50055
2024-11-09 20:48:54 - progress_bar.py[line:274] - INFO: epoch 022:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17636.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.62, wps=3090.5, ups=0.18, wpb=17636.4, bsz=1024, num_updates=7760, lr=4.19137e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=50112
2024-11-09 20:49:27 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 20:49:56 - progress_bar.py[line:274] - INFO: epoch 022:     89 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.091, ntokens=17662.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.52, wps=2858.2, ups=0.16, wpb=17662.4, bsz=1024, num_updates=7770, lr=4.18992e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=62, gb_free=13.4, wall=50174
2024-11-09 20:50:53 - progress_bar.py[line:274] - INFO: epoch 022:     99 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17342.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3040.6, ups=0.18, wpb=17342.4, bsz=1024, num_updates=7780, lr=4.18847e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=50231
2024-11-09 20:51:51 - progress_bar.py[line:274] - INFO: epoch 022:    109 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17449.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3024.3, ups=0.17, wpb=17449.9, bsz=1024, num_updates=7790, lr=4.18701e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=50289
2024-11-09 20:52:48 - progress_bar.py[line:274] - INFO: epoch 022:    119 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17256.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=2997, ups=0.17, wpb=17256.8, bsz=1024, num_updates=7800, lr=4.18556e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.6, wall=50347
2024-11-09 20:53:45 - progress_bar.py[line:274] - INFO: epoch 022:    129 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17428.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3057.5, ups=0.18, wpb=17428.4, bsz=1024, num_updates=7810, lr=4.18411e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=50404
2024-11-09 20:54:42 - progress_bar.py[line:274] - INFO: epoch 022:    139 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.062, ntokens=17398.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.35, wps=3092.2, ups=0.18, wpb=17398.3, bsz=1024, num_updates=7820, lr=4.18265e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=50460
2024-11-09 20:55:39 - progress_bar.py[line:274] - INFO: epoch 022:    149 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.082, ntokens=17485.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.47, wps=3069, ups=0.18, wpb=17485.6, bsz=1024, num_updates=7830, lr=4.1812e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=50517
2024-11-09 20:56:36 - progress_bar.py[line:274] - INFO: epoch 022:    159 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17571.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3058.1, ups=0.17, wpb=17571.2, bsz=1024, num_updates=7840, lr=4.17975e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=50574
2024-11-09 20:57:33 - progress_bar.py[line:274] - INFO: epoch 022:    169 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17406.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3035.2, ups=0.17, wpb=17406.5, bsz=1024, num_updates=7850, lr=4.17829e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=50632
2024-11-09 20:58:30 - progress_bar.py[line:274] - INFO: epoch 022:    179 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.085, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.49, wps=3073.3, ups=0.18, wpb=17420.4, bsz=1024, num_updates=7860, lr=4.17684e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=50688
2024-11-09 20:59:26 - progress_bar.py[line:274] - INFO: epoch 022:    189 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17067.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3056, ups=0.18, wpb=17067.5, bsz=1024, num_updates=7870, lr=4.17539e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=50744
2024-11-09 21:00:22 - progress_bar.py[line:274] - INFO: epoch 022:    199 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17466.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3134.8, ups=0.18, wpb=17466.9, bsz=1024, num_updates=7880, lr=4.17393e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=50800
2024-11-09 21:01:19 - progress_bar.py[line:274] - INFO: epoch 022:    209 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17455.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3058.1, ups=0.18, wpb=17455.1, bsz=1024, num_updates=7890, lr=4.17248e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=50857
2024-11-09 21:02:16 - progress_bar.py[line:274] - INFO: epoch 022:    219 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.026, ntokens=17255.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3021.3, ups=0.18, wpb=17255.2, bsz=1024, num_updates=7900, lr=4.17103e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=50914
2024-11-09 21:03:12 - progress_bar.py[line:274] - INFO: epoch 022:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.083, ntokens=17513.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.48, wps=3128, ups=0.18, wpb=17513.6, bsz=1024, num_updates=7910, lr=4.16957e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=50970
2024-11-09 21:04:09 - progress_bar.py[line:274] - INFO: epoch 022:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17424.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3070.9, ups=0.18, wpb=17424.3, bsz=1024, num_updates=7920, lr=4.16812e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51027
2024-11-09 21:05:05 - progress_bar.py[line:274] - INFO: epoch 022:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.087, ntokens=17534.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.5, wps=3100.9, ups=0.18, wpb=17534.1, bsz=1024, num_updates=7930, lr=4.16667e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=51083
2024-11-09 21:06:02 - progress_bar.py[line:274] - INFO: epoch 022:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.043, ntokens=17141.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3009.9, ups=0.18, wpb=17141.5, bsz=1024, num_updates=7940, lr=4.16521e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51140
2024-11-09 21:06:59 - progress_bar.py[line:274] - INFO: epoch 022:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17369.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3074.3, ups=0.18, wpb=17369.9, bsz=1024, num_updates=7950, lr=4.16376e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=51197
2024-11-09 21:07:55 - progress_bar.py[line:274] - INFO: epoch 022:    279 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=16938.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3017.7, ups=0.18, wpb=16938.3, bsz=1015.4, num_updates=7960, lr=4.16231e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.1, wall=51253
2024-11-09 21:08:49 - progress_bar.py[line:274] - INFO: epoch 022:    289 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17273.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3186.7, ups=0.18, wpb=17273.9, bsz=1024, num_updates=7970, lr=4.16085e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=51307
2024-11-09 21:09:44 - progress_bar.py[line:274] - INFO: epoch 022:    299 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17539.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3180.1, ups=0.18, wpb=17539.9, bsz=1024, num_updates=7980, lr=4.1594e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=51362
2024-11-09 21:10:41 - progress_bar.py[line:274] - INFO: epoch 022:    309 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17605.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3083.9, ups=0.18, wpb=17605.9, bsz=1024, num_updates=7990, lr=4.15795e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51419
2024-11-09 21:11:38 - progress_bar.py[line:274] - INFO: epoch 022:    319 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.117, ntokens=17674.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.67, wps=3117.5, ups=0.18, wpb=17674.6, bsz=1024, num_updates=8000, lr=4.15649e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51476
2024-11-09 21:12:33 - progress_bar.py[line:274] - INFO: epoch 022:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17536.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3169.8, ups=0.18, wpb=17536.9, bsz=1024, num_updates=8010, lr=4.15504e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=51531
2024-11-09 21:13:30 - progress_bar.py[line:274] - INFO: epoch 022:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.089, ntokens=17639.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3079.6, ups=0.17, wpb=17639.5, bsz=1024, num_updates=8020, lr=4.15359e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51589
2024-11-09 21:14:27 - progress_bar.py[line:274] - INFO: epoch 022:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17369, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3063.5, ups=0.18, wpb=17369, bsz=1024, num_updates=8030, lr=4.15213e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=51645
2024-11-09 21:15:24 - progress_bar.py[line:274] - INFO: epoch 022:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17673.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3120.6, ups=0.18, wpb=17673.2, bsz=1024, num_updates=8040, lr=4.15068e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=51702
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 21:15:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 22 @ 8047 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
2024-11-09 21:15:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 21:17:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-09 21:19:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 22 @ 8047 updates, score 0) (writing took 218.12490926904138 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_22.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 21:20:32 - train.py[line:336] - INFO: end of epoch 22 (average epoch stats below)
2024-11-09 21:20:32 - progress_bar.py[line:282] - INFO: epoch 022 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.07 | ntokens 17428.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.4 | wps 2558.4 | ups 0.15 | wpb 17428.7 | bsz 1023.1 | num_updates 8047 | lr 4.14966e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 2029 | gb_free 13.5 | wall 52011
2024-11-09 21:20:32 - trainer.py[line:639] - INFO: loading train data for epoch 23
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 21:23:02 - trainer.py[line:703] - INFO: begin training epoch 23
2024-11-09 21:23:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 21:23:20 - progress_bar.py[line:274] - INFO: epoch 023:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.107, ntokens=17325.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.61, wps=363.8, ups=0.02, wpb=17325.5, bsz=998.4, num_updates=8050, lr=4.14923e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=44, gb_free=13.5, wall=52178
2024-11-09 21:24:13 - progress_bar.py[line:274] - INFO: epoch 023:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17570.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3308.8, ups=0.19, wpb=17570.4, bsz=1024, num_updates=8060, lr=4.14777e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=52231
2024-11-09 21:25:08 - progress_bar.py[line:274] - INFO: epoch 023:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17412.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3155.5, ups=0.18, wpb=17412.2, bsz=1024, num_updates=8070, lr=4.14632e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=52286
2024-11-09 21:26:03 - progress_bar.py[line:274] - INFO: epoch 023:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17589.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3235.3, ups=0.18, wpb=17589.6, bsz=1024, num_updates=8080, lr=4.14487e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=52341
2024-11-09 21:26:56 - progress_bar.py[line:274] - INFO: epoch 023:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17568.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3270.9, ups=0.19, wpb=17568.4, bsz=1024, num_updates=8090, lr=4.14341e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=52395
2024-11-09 21:27:51 - progress_bar.py[line:274] - INFO: epoch 023:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17504, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.43, wps=3175.7, ups=0.18, wpb=17504, bsz=1024, num_updates=8100, lr=4.14196e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=52450
2024-11-09 21:28:49 - progress_bar.py[line:274] - INFO: epoch 023:     63 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.069, ntokens=17475.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3052.5, ups=0.17, wpb=17475.5, bsz=1024, num_updates=8110, lr=4.14051e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=52507
2024-11-09 21:29:45 - progress_bar.py[line:274] - INFO: epoch 023:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17515, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3104.8, ups=0.18, wpb=17515, bsz=1024, num_updates=8120, lr=4.13905e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=52563
2024-11-09 21:30:42 - progress_bar.py[line:274] - INFO: epoch 023:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17485.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3077.8, ups=0.18, wpb=17485.9, bsz=1024, num_updates=8130, lr=4.1376e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=52620
2024-11-09 21:31:39 - progress_bar.py[line:274] - INFO: epoch 023:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17245.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3046.3, ups=0.18, wpb=17245.1, bsz=1024, num_updates=8140, lr=4.13615e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=52677
2024-11-09 21:32:36 - progress_bar.py[line:274] - INFO: epoch 023:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.076, ntokens=17263.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3009.4, ups=0.17, wpb=17263.7, bsz=1024, num_updates=8150, lr=4.13469e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=52734
2024-11-09 21:33:33 - progress_bar.py[line:274] - INFO: epoch 023:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17371.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3051.6, ups=0.18, wpb=17371.3, bsz=1024, num_updates=8160, lr=4.13324e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=52791
2024-11-09 21:34:30 - progress_bar.py[line:274] - INFO: epoch 023:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.09, ntokens=17496.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.51, wps=3054.7, ups=0.17, wpb=17496.5, bsz=1024, num_updates=8170, lr=4.13179e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=52848
2024-11-09 21:35:27 - progress_bar.py[line:274] - INFO: epoch 023:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17375, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3034.7, ups=0.17, wpb=17375, bsz=1024, num_updates=8180, lr=4.13033e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=52906
2024-11-09 21:36:25 - progress_bar.py[line:274] - INFO: epoch 023:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.104, ntokens=17660.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3072.5, ups=0.17, wpb=17660.9, bsz=1024, num_updates=8190, lr=4.12888e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=52963
2024-11-09 21:37:22 - progress_bar.py[line:274] - INFO: epoch 023:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.068, ntokens=17548.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.39, wps=3057.7, ups=0.17, wpb=17548.9, bsz=1024, num_updates=8200, lr=4.12743e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=53020
2024-11-09 21:38:19 - progress_bar.py[line:274] - INFO: epoch 023:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17147.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3019.3, ups=0.18, wpb=17147.6, bsz=1024, num_updates=8210, lr=4.12597e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=53077
2024-11-09 21:39:15 - progress_bar.py[line:274] - INFO: epoch 023:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17318.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3109.3, ups=0.18, wpb=17318.3, bsz=1024, num_updates=8220, lr=4.12452e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=53133
2024-11-09 21:40:10 - progress_bar.py[line:274] - INFO: epoch 023:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.099, ntokens=17492.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.57, wps=3171.1, ups=0.18, wpb=17492.5, bsz=1024, num_updates=8230, lr=4.12307e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=53188
2024-11-09 21:41:07 - progress_bar.py[line:274] - INFO: epoch 023:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.077, ntokens=17569.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.44, wps=3051.4, ups=0.17, wpb=17569.4, bsz=1024, num_updates=8240, lr=4.12161e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=53246
2024-11-09 21:42:03 - progress_bar.py[line:274] - INFO: epoch 023:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17268.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3102.2, ups=0.18, wpb=17268.3, bsz=1024, num_updates=8250, lr=4.12016e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=53301
2024-11-09 21:43:00 - progress_bar.py[line:274] - INFO: epoch 023:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17334.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3055.8, ups=0.18, wpb=17334.6, bsz=1024, num_updates=8260, lr=4.11871e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=53358
2024-11-09 21:43:57 - progress_bar.py[line:274] - INFO: epoch 023:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17019.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=2988, ups=0.18, wpb=17019.4, bsz=1024, num_updates=8270, lr=4.11725e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.1, wall=53415
2024-11-09 21:44:53 - progress_bar.py[line:274] - INFO: epoch 023:    233 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.102, ntokens=17713.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.58, wps=3128.3, ups=0.18, wpb=17713.7, bsz=1024, num_updates=8280, lr=4.1158e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=53472
2024-11-09 21:45:51 - progress_bar.py[line:274] - INFO: epoch 023:    243 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17419.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3009.7, ups=0.17, wpb=17419.9, bsz=1024, num_updates=8290, lr=4.11435e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=53530
2024-11-09 21:46:49 - progress_bar.py[line:274] - INFO: epoch 023:    253 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17460.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3030.5, ups=0.17, wpb=17460.7, bsz=1024, num_updates=8300, lr=4.11289e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=53587
2024-11-09 21:47:47 - progress_bar.py[line:274] - INFO: epoch 023:    263 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.055, ntokens=17345.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.31, wps=3007.2, ups=0.17, wpb=17345.2, bsz=1024, num_updates=8310, lr=4.11144e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=53645
2024-11-09 21:48:43 - progress_bar.py[line:274] - INFO: epoch 023:    273 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=16999.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3013.7, ups=0.18, wpb=16999.3, bsz=1015.4, num_updates=8320, lr=4.10999e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=53701
2024-11-09 21:49:40 - progress_bar.py[line:274] - INFO: epoch 023:    283 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.056, ntokens=17399.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=3028.1, ups=0.17, wpb=17399.9, bsz=1024, num_updates=8330, lr=4.10853e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=53759
2024-11-09 21:50:37 - progress_bar.py[line:274] - INFO: epoch 023:    293 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17500.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3116, ups=0.18, wpb=17500.6, bsz=1024, num_updates=8340, lr=4.10708e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=53815
2024-11-09 21:51:34 - progress_bar.py[line:274] - INFO: epoch 023:    303 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.105, ntokens=17837.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.6, wps=3131.8, ups=0.18, wpb=17837.4, bsz=1024, num_updates=8350, lr=4.10563e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=53872
2024-11-09 21:52:25 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 21:52:37 - progress_bar.py[line:274] - INFO: epoch 023:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17373.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=2760.7, ups=0.16, wpb=17373.5, bsz=1024, num_updates=8360, lr=4.10417e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=63, gb_free=13.4, wall=53935
2024-11-09 21:53:33 - progress_bar.py[line:274] - INFO: epoch 023:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17687.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3113.8, ups=0.18, wpb=17687.4, bsz=1024, num_updates=8370, lr=4.10272e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=53992
2024-11-09 21:54:31 - progress_bar.py[line:274] - INFO: epoch 023:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.071, ntokens=17615.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3074.3, ups=0.17, wpb=17615.4, bsz=1024, num_updates=8380, lr=4.10127e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=54049
2024-11-09 21:55:28 - progress_bar.py[line:274] - INFO: epoch 023:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.079, ntokens=17535.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=3079.7, ups=0.18, wpb=17535.7, bsz=1024, num_updates=8390, lr=4.09981e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=54106
2024-11-09 21:56:24 - progress_bar.py[line:274] - INFO: epoch 023:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17281.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3056.4, ups=0.18, wpb=17281.8, bsz=1024, num_updates=8400, lr=4.09836e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=54162
2024-11-09 21:57:21 - progress_bar.py[line:274] - INFO: epoch 023:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.08, ntokens=17584, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.46, wps=3109.9, ups=0.18, wpb=17584, bsz=1024, num_updates=8410, lr=4.09691e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=54219
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-09 21:57:30 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 23 @ 8412 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
2024-11-09 21:57:30 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt

cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 21:59:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
2024-11-09 22:01:11 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 23 @ 8412 updates, score 0) (writing took 221.13665437698364 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_23.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 22:02:06 - train.py[line:336] - INFO: end of epoch 23 (average epoch stats below)
2024-11-09 22:02:06 - progress_bar.py[line:282] - INFO: epoch 023 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.058 | ntokens 17437.6 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.33 | wps 2552.1 | ups 0.15 | wpb 17437.6 | bsz 1023.1 | num_updates 8412 | lr 4.09662e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2008 | gb_free 13.4 | wall 54505
2024-11-09 22:02:06 - trainer.py[line:639] - INFO: loading train data for epoch 24
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 22:04:36 - trainer.py[line:703] - INFO: begin training epoch 24
2024-11-09 22:04:36 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 22:05:21 - progress_bar.py[line:274] - INFO: epoch 024:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=16874.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=351.2, ups=0.02, wpb=16874.2, bsz=998.4, num_updates=8420, lr=4.09545e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=54699
2024-11-09 22:06:16 - progress_bar.py[line:274] - INFO: epoch 024:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17413.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3175.7, ups=0.18, wpb=17413.7, bsz=1024, num_updates=8430, lr=4.094e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=39, gb_free=13.5, wall=54754
2024-11-09 22:07:15 - progress_bar.py[line:274] - INFO: epoch 024:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.044, ntokens=17519.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=2969, ups=0.17, wpb=17519.6, bsz=1024, num_updates=8440, lr=4.09255e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=54813
2024-11-09 22:08:12 - progress_bar.py[line:274] - INFO: epoch 024:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.027, ntokens=17302.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3015.1, ups=0.17, wpb=17302.1, bsz=1024, num_updates=8450, lr=4.09109e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=54871
2024-11-09 22:09:09 - progress_bar.py[line:274] - INFO: epoch 024:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.046, ntokens=17428.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3061, ups=0.18, wpb=17428.5, bsz=1024, num_updates=8460, lr=4.08964e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=54928
2024-11-09 22:10:07 - progress_bar.py[line:274] - INFO: epoch 024:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17533.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3054.5, ups=0.17, wpb=17533.3, bsz=1024, num_updates=8470, lr=4.08819e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=54985
2024-11-09 22:11:03 - progress_bar.py[line:274] - INFO: epoch 024:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17574.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3124.9, ups=0.18, wpb=17574.7, bsz=1024, num_updates=8480, lr=4.08673e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=55041
2024-11-09 22:12:01 - progress_bar.py[line:274] - INFO: epoch 024:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17507.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3030.7, ups=0.17, wpb=17507.2, bsz=1024, num_updates=8490, lr=4.08528e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=55099
2024-11-09 22:12:58 - progress_bar.py[line:274] - INFO: epoch 024:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17568.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3042.6, ups=0.17, wpb=17568.3, bsz=1024, num_updates=8500, lr=4.08383e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=55157
2024-11-09 22:13:56 - progress_bar.py[line:274] - INFO: epoch 024:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17507.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3039.5, ups=0.17, wpb=17507.9, bsz=1024, num_updates=8510, lr=4.08237e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=55214
2024-11-09 22:14:54 - progress_bar.py[line:274] - INFO: epoch 024:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.074, ntokens=17609.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.42, wps=3047.8, ups=0.17, wpb=17609.4, bsz=1024, num_updates=8520, lr=4.08092e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=55272
2024-11-09 22:15:50 - progress_bar.py[line:274] - INFO: epoch 024:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.066, ntokens=17423.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3081.3, ups=0.18, wpb=17423.8, bsz=1015.4, num_updates=8530, lr=4.07947e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=55329
2024-11-09 22:16:49 - progress_bar.py[line:274] - INFO: epoch 024:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=16911.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=2904, ups=0.17, wpb=16911.4, bsz=1024, num_updates=8540, lr=4.07801e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=55387
2024-11-09 22:17:47 - progress_bar.py[line:274] - INFO: epoch 024:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.032, ntokens=17299.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=2986.9, ups=0.17, wpb=17299.9, bsz=1024, num_updates=8550, lr=4.07656e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=55445
2024-11-09 22:18:44 - progress_bar.py[line:274] - INFO: epoch 024:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17558.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3062.4, ups=0.17, wpb=17558.6, bsz=1024, num_updates=8560, lr=4.07511e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=55502
2024-11-09 22:19:41 - progress_bar.py[line:274] - INFO: epoch 024:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.01, ntokens=17233, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3016.7, ups=0.18, wpb=17233, bsz=1024, num_updates=8570, lr=4.07365e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=55559
2024-11-09 22:20:38 - progress_bar.py[line:274] - INFO: epoch 024:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.059, ntokens=17539.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.33, wps=3082.2, ups=0.18, wpb=17539.6, bsz=1024, num_updates=8580, lr=4.0722e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=55616
2024-11-09 22:21:35 - progress_bar.py[line:274] - INFO: epoch 024:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17597, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3067.4, ups=0.17, wpb=17597, bsz=1024, num_updates=8590, lr=4.07075e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=55673
2024-11-09 22:22:33 - progress_bar.py[line:274] - INFO: epoch 024:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=17387.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3003.6, ups=0.17, wpb=17387.2, bsz=1024, num_updates=8600, lr=4.06929e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=55731
2024-11-09 22:23:31 - progress_bar.py[line:274] - INFO: epoch 024:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17302, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3002.2, ups=0.17, wpb=17302, bsz=1024, num_updates=8610, lr=4.06784e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=55789
2024-11-09 22:24:28 - progress_bar.py[line:274] - INFO: epoch 024:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.026, ntokens=17414.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3036, ups=0.17, wpb=17414.7, bsz=1024, num_updates=8620, lr=4.06639e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=55846
2024-11-09 22:25:26 - progress_bar.py[line:274] - INFO: epoch 024:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.01, ntokens=17268.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=2969, ups=0.17, wpb=17268.3, bsz=1024, num_updates=8630, lr=4.06493e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=55905
2024-11-09 22:26:24 - progress_bar.py[line:274] - INFO: epoch 024:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17544.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3023.5, ups=0.17, wpb=17544.3, bsz=1024, num_updates=8640, lr=4.06348e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=55963
2024-11-09 22:27:21 - progress_bar.py[line:274] - INFO: epoch 024:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.079, ntokens=17573.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.45, wps=3093, ups=0.18, wpb=17573.7, bsz=1024, num_updates=8650, lr=4.06203e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=56019
2024-11-09 22:28:18 - progress_bar.py[line:274] - INFO: epoch 024:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17174.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3021, ups=0.18, wpb=17174.7, bsz=1024, num_updates=8660, lr=4.06057e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=56076
2024-11-09 22:29:14 - progress_bar.py[line:274] - INFO: epoch 024:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.054, ntokens=17420.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3106.5, ups=0.18, wpb=17420.5, bsz=1024, num_updates=8670, lr=4.05912e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=56132
2024-11-09 22:30:08 - progress_bar.py[line:274] - INFO: epoch 024:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17439.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3207.2, ups=0.18, wpb=17439.2, bsz=1024, num_updates=8680, lr=4.05767e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=56187
2024-11-09 22:31:06 - progress_bar.py[line:274] - INFO: epoch 024:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=17204.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=2999.9, ups=0.17, wpb=17204.9, bsz=1024, num_updates=8690, lr=4.05621e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=56244
2024-11-09 22:32:00 - progress_bar.py[line:274] - INFO: epoch 024:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.038, ntokens=17386.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3206.8, ups=0.18, wpb=17386.6, bsz=1024, num_updates=8700, lr=4.05476e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=56298
2024-11-09 22:32:57 - progress_bar.py[line:274] - INFO: epoch 024:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17332, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3051, ups=0.18, wpb=17332, bsz=1024, num_updates=8710, lr=4.05331e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=56355
2024-11-09 22:33:54 - progress_bar.py[line:274] - INFO: epoch 024:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.095, ntokens=17810.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.55, wps=3131.1, ups=0.18, wpb=17810.2, bsz=1024, num_updates=8720, lr=4.05185e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=56412
2024-11-09 22:34:51 - progress_bar.py[line:274] - INFO: epoch 024:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.11, ntokens=17937.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.63, wps=3133.7, ups=0.17, wpb=17937.7, bsz=1024, num_updates=8730, lr=4.0504e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=56469
2024-11-09 22:35:48 - progress_bar.py[line:274] - INFO: epoch 024:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=17594.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3093.5, ups=0.18, wpb=17594.7, bsz=1024, num_updates=8740, lr=4.04895e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=56526
2024-11-09 22:36:45 - progress_bar.py[line:274] - INFO: epoch 024:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.063, ntokens=17604.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3093.7, ups=0.18, wpb=17604.3, bsz=1024, num_updates=8750, lr=4.04749e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=56583
2024-11-09 22:37:43 - progress_bar.py[line:274] - INFO: epoch 024:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.092, ntokens=17678.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.53, wps=3051.2, ups=0.17, wpb=17678.2, bsz=1024, num_updates=8760, lr=4.04604e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=56641
2024-11-09 22:38:41 - progress_bar.py[line:274] - INFO: epoch 024:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.053, ntokens=17629.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3036, ups=0.17, wpb=17629.9, bsz=1024, num_updates=8770, lr=4.04459e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=56699
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt2024-11-09 22:39:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 24 @ 8778 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
2024-11-09 22:39:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt': File exists: File exists

: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 22:41:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
2024-11-09 22:43:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 24 @ 8778 updates, score 0) (writing took 221.89325437595835 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_24.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-09 22:44:02 - train.py[line:336] - INFO: end of epoch 24 (average epoch stats below)
2024-11-09 22:44:02 - progress_bar.py[line:282] - INFO: epoch 024 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.045 | ntokens 17444.8 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.25 | wps 2538.1 | ups 0.15 | wpb 17444.8 | bsz 1023.1 | num_updates 8778 | lr 4.04343e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2045 | gb_free 13.5 | wall 57020
2024-11-09 22:44:02 - trainer.py[line:639] - INFO: loading train data for epoch 25
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 22:46:31 - trainer.py[line:703] - INFO: begin training epoch 25
2024-11-09 22:46:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 22:46:44 - progress_bar.py[line:274] - INFO: epoch 025:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.022, ntokens=16991.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=351.9, ups=0.02, wpb=16991.8, bsz=998.4, num_updates=8780, lr=4.04313e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=49, gb_free=13.2, wall=57182
2024-11-09 22:47:38 - progress_bar.py[line:274] - INFO: epoch 025:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17210, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3164.7, ups=0.18, wpb=17210, bsz=1024, num_updates=8790, lr=4.04168e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=57236
2024-11-09 22:48:32 - progress_bar.py[line:274] - INFO: epoch 025:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.064, ntokens=17404.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.36, wps=3224.5, ups=0.19, wpb=17404.7, bsz=1024, num_updates=8800, lr=4.04023e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=44, gb_free=13.3, wall=57290
2024-11-09 22:49:28 - progress_bar.py[line:274] - INFO: epoch 025:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.973, ntokens=17172.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3066.6, ups=0.18, wpb=17172.6, bsz=1024, num_updates=8810, lr=4.03877e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=44, gb_free=13.5, wall=57346
2024-11-09 22:50:21 - progress_bar.py[line:274] - INFO: epoch 025:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17272.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3277.5, ups=0.19, wpb=17272.6, bsz=1024, num_updates=8820, lr=4.03732e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=52, gb_free=13.3, wall=57399
2024-11-09 22:51:15 - progress_bar.py[line:274] - INFO: epoch 025:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.072, ntokens=17645.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.41, wps=3230.5, ups=0.18, wpb=17645.4, bsz=1024, num_updates=8830, lr=4.03587e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=57453
2024-11-09 22:52:13 - progress_bar.py[line:274] - INFO: epoch 025:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17312.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3019.5, ups=0.17, wpb=17312.5, bsz=1024, num_updates=8840, lr=4.03441e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=57511
2024-11-09 22:53:10 - progress_bar.py[line:274] - INFO: epoch 025:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17347.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3038.6, ups=0.18, wpb=17347.1, bsz=1024, num_updates=8850, lr=4.03296e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=57568
2024-11-09 22:54:07 - progress_bar.py[line:274] - INFO: epoch 025:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17230.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3000.7, ups=0.17, wpb=17230.8, bsz=1024, num_updates=8860, lr=4.03151e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=57625
2024-11-09 22:55:02 - progress_bar.py[line:274] - INFO: epoch 025:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17652.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3200.9, ups=0.18, wpb=17652.4, bsz=1024, num_updates=8870, lr=4.03005e-05, gnorm=0.007, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=57680
2024-11-09 22:55:59 - progress_bar.py[line:274] - INFO: epoch 025:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.029, ntokens=17456.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3082.9, ups=0.18, wpb=17456.8, bsz=1024, num_updates=8880, lr=4.0286e-05, gnorm=0.007, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=57737
2024-11-09 22:56:05 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 22:56:58 - progress_bar.py[line:274] - INFO: epoch 025:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.037, ntokens=17459, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=2955, ups=0.17, wpb=17459, bsz=1024, num_updates=8890, lr=4.02715e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=59, gb_free=13.2, wall=57796
2024-11-09 22:57:52 - progress_bar.py[line:274] - INFO: epoch 025:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=17407.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3199.4, ups=0.18, wpb=17407.1, bsz=1024, num_updates=8900, lr=4.02569e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=57851
2024-11-09 22:58:49 - progress_bar.py[line:274] - INFO: epoch 025:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17430.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3080.6, ups=0.18, wpb=17430.8, bsz=1024, num_updates=8910, lr=4.02424e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=57907
2024-11-09 22:59:47 - progress_bar.py[line:274] - INFO: epoch 025:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17395.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3019.1, ups=0.17, wpb=17395.6, bsz=1024, num_updates=8920, lr=4.02279e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=57965
2024-11-09 23:00:44 - progress_bar.py[line:274] - INFO: epoch 025:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17514.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3069.8, ups=0.18, wpb=17514.9, bsz=1024, num_updates=8930, lr=4.02133e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58022
2024-11-09 23:01:41 - progress_bar.py[line:274] - INFO: epoch 025:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17425.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3017, ups=0.17, wpb=17425.9, bsz=1024, num_updates=8940, lr=4.01988e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=58080
2024-11-09 23:02:39 - progress_bar.py[line:274] - INFO: epoch 025:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.065, ntokens=17661.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.37, wps=3059, ups=0.17, wpb=17661.8, bsz=1024, num_updates=8950, lr=4.01843e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=58137
2024-11-09 23:03:36 - progress_bar.py[line:274] - INFO: epoch 025:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17502.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3065.1, ups=0.18, wpb=17502.6, bsz=1024, num_updates=8960, lr=4.01697e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=58194
2024-11-09 23:04:34 - progress_bar.py[line:274] - INFO: epoch 025:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=17333.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3018.7, ups=0.17, wpb=17333.9, bsz=1024, num_updates=8970, lr=4.01552e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58252
2024-11-09 23:05:31 - progress_bar.py[line:274] - INFO: epoch 025:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17485.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3054.6, ups=0.17, wpb=17485.9, bsz=1024, num_updates=8980, lr=4.01407e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=58309
2024-11-09 23:06:24 - progress_bar.py[line:274] - INFO: epoch 025:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17248.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3243.3, ups=0.19, wpb=17248.8, bsz=1024, num_updates=8990, lr=4.01261e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=58362
2024-11-09 23:07:21 - progress_bar.py[line:274] - INFO: epoch 025:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17462.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3078.9, ups=0.18, wpb=17462.2, bsz=1024, num_updates=9000, lr=4.01116e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=58419
2024-11-09 23:08:18 - progress_bar.py[line:274] - INFO: epoch 025:    233 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17737.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3110.4, ups=0.18, wpb=17737.2, bsz=1024, num_updates=9010, lr=4.00971e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58476
2024-11-09 23:09:14 - progress_bar.py[line:274] - INFO: epoch 025:    243 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.07, ntokens=17606, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.4, wps=3139.9, ups=0.18, wpb=17606, bsz=1024, num_updates=9020, lr=4.00825e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=58532
2024-11-09 23:10:08 - progress_bar.py[line:274] - INFO: epoch 025:    253 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17569.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3224.7, ups=0.18, wpb=17569.4, bsz=1024, num_updates=9030, lr=4.0068e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=58587
2024-11-09 23:11:05 - progress_bar.py[line:274] - INFO: epoch 025:    263 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17180.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3057.1, ups=0.18, wpb=17180.5, bsz=1024, num_updates=9040, lr=4.00535e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=58643
2024-11-09 23:12:02 - progress_bar.py[line:274] - INFO: epoch 025:    273 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17335, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3035.3, ups=0.18, wpb=17335, bsz=1015.4, num_updates=9050, lr=4.00389e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58700
2024-11-09 23:12:57 - progress_bar.py[line:274] - INFO: epoch 025:    283 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17480.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3138, ups=0.18, wpb=17480.4, bsz=1024, num_updates=9060, lr=4.00244e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.6, wall=58756
2024-11-09 23:13:53 - progress_bar.py[line:274] - INFO: epoch 025:    293 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=17461.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3154, ups=0.18, wpb=17461.1, bsz=1024, num_updates=9070, lr=4.00099e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=58811
2024-11-09 23:14:50 - progress_bar.py[line:274] - INFO: epoch 025:    303 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.036, ntokens=17442.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3035.2, ups=0.17, wpb=17442.6, bsz=1024, num_updates=9080, lr=3.99953e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58868
2024-11-09 23:15:47 - progress_bar.py[line:274] - INFO: epoch 025:    313 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17699.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3108.1, ups=0.18, wpb=17699.2, bsz=1024, num_updates=9090, lr=3.99808e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=58925
2024-11-09 23:16:44 - progress_bar.py[line:274] - INFO: epoch 025:    323 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.036, ntokens=17588.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3105.4, ups=0.18, wpb=17588.6, bsz=1024, num_updates=9100, lr=3.99663e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=58982
2024-11-09 23:17:41 - progress_bar.py[line:274] - INFO: epoch 025:    333 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.037, ntokens=17566.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.21, wps=3078.4, ups=0.18, wpb=17566.3, bsz=1024, num_updates=9110, lr=3.99517e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=59039
2024-11-09 23:18:38 - progress_bar.py[line:274] - INFO: epoch 025:    343 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17621, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3106.8, ups=0.18, wpb=17621, bsz=1024, num_updates=9120, lr=3.99372e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=59096
2024-11-09 23:19:35 - progress_bar.py[line:274] - INFO: epoch 025:    353 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.05, ntokens=17612.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.28, wps=3082.5, ups=0.18, wpb=17612.8, bsz=1024, num_updates=9130, lr=3.99227e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=59153
2024-11-09 23:20:32 - progress_bar.py[line:274] - INFO: epoch 025:    363 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.033, ntokens=17404.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3031.2, ups=0.17, wpb=17404.1, bsz=1024, num_updates=9140, lr=3.99082e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=59210
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt2024-11-09 23:20:46 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 25 @ 9143 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
2024-11-09 23:20:46 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt': File exists: File exists
: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-09 23:22:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
2024-11-09 23:24:24 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 25 @ 9143 updates, score 0) (writing took 217.69145356601803 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_25.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
2024-11-09 23:25:20 - train.py[line:336] - INFO: end of epoch 25 (average epoch stats below)
2024-11-09 23:25:20 - progress_bar.py[line:282] - INFO: epoch 025 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.031 | ntokens 17441.1 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.17 | wps 2569.2 | ups 0.15 | wpb 17441.1 | bsz 1023.1 | num_updates 9143 | lr 3.99038e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 2000 | gb_free 13.4 | wall 59498
2024-11-09 23:25:20 - trainer.py[line:639] - INFO: loading train data for epoch 26
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 23:27:52 - trainer.py[line:703] - INFO: begin training epoch 26
2024-11-09 23:27:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 23:28:32 - progress_bar.py[line:274] - INFO: epoch 026:      7 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.007, ntokens=17037.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=355.2, ups=0.02, wpb=17037.3, bsz=998.4, num_updates=9150, lr=3.98936e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=35, gb_free=13.5, wall=59690
2024-11-09 23:29:27 - progress_bar.py[line:274] - INFO: epoch 026:     17 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17375.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3137.7, ups=0.18, wpb=17375.5, bsz=1024, num_updates=9160, lr=3.98791e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=33, gb_free=13.5, wall=59745
2024-11-09 23:30:25 - progress_bar.py[line:274] - INFO: epoch 026:     27 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.001, ntokens=17387, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=2999.6, ups=0.17, wpb=17387, bsz=1024, num_updates=9170, lr=3.98646e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=59803
2024-11-09 23:31:23 - progress_bar.py[line:274] - INFO: epoch 026:     37 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17078.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=2962.1, ups=0.17, wpb=17078.3, bsz=1024, num_updates=9180, lr=3.985e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=59861
2024-11-09 23:32:20 - progress_bar.py[line:274] - INFO: epoch 026:     47 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.01, ntokens=17429.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3041.4, ups=0.17, wpb=17429.1, bsz=1024, num_updates=9190, lr=3.98355e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=59918
2024-11-09 23:33:18 - progress_bar.py[line:274] - INFO: epoch 026:     57 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.034, ntokens=17465.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.19, wps=3026.9, ups=0.17, wpb=17465.4, bsz=1024, num_updates=9200, lr=3.9821e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=59976
2024-11-09 23:34:16 - progress_bar.py[line:274] - INFO: epoch 026:     67 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17670.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3055.1, ups=0.17, wpb=17670.6, bsz=1024, num_updates=9210, lr=3.98064e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=60034
2024-11-09 23:35:14 - progress_bar.py[line:274] - INFO: epoch 026:     77 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.049, ntokens=17486.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.27, wps=3016, ups=0.17, wpb=17486.1, bsz=1024, num_updates=9220, lr=3.97919e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=60092
2024-11-09 23:36:13 - progress_bar.py[line:274] - INFO: epoch 026:     87 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17540.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=2977.2, ups=0.17, wpb=17540.6, bsz=1024, num_updates=9230, lr=3.97774e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=60151
2024-11-09 23:37:11 - progress_bar.py[line:274] - INFO: epoch 026:     97 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17359.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=2994.9, ups=0.17, wpb=17359.1, bsz=1024, num_updates=9240, lr=3.97628e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=60209
2024-11-09 23:38:08 - progress_bar.py[line:274] - INFO: epoch 026:    107 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17538.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.3, wps=3039.5, ups=0.17, wpb=17538.3, bsz=1024, num_updates=9250, lr=3.97483e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=60266
2024-11-09 23:39:06 - progress_bar.py[line:274] - INFO: epoch 026:    117 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.03, ntokens=17499.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3013.3, ups=0.17, wpb=17499.8, bsz=1024, num_updates=9260, lr=3.97338e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=60325
2024-11-09 23:40:05 - progress_bar.py[line:274] - INFO: epoch 026:    127 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=17375.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=2969.6, ups=0.17, wpb=17375.7, bsz=1024, num_updates=9270, lr=3.97192e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=60383
2024-11-09 23:41:03 - progress_bar.py[line:274] - INFO: epoch 026:    137 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17448.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=2987.1, ups=0.17, wpb=17448.2, bsz=1024, num_updates=9280, lr=3.97047e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=60441
2024-11-09 23:41:56 - progress_bar.py[line:274] - INFO: epoch 026:    147 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17668.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3333.7, ups=0.19, wpb=17668.9, bsz=1024, num_updates=9290, lr=3.96902e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=60494
2024-11-09 23:42:52 - progress_bar.py[line:274] - INFO: epoch 026:    157 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17129, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3094.9, ups=0.18, wpb=17129, bsz=1024, num_updates=9300, lr=3.96756e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=60550
2024-11-09 23:43:46 - progress_bar.py[line:274] - INFO: epoch 026:    167 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17399.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3173.3, ups=0.18, wpb=17399.4, bsz=1024, num_updates=9310, lr=3.96611e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=60605
2024-11-09 23:44:43 - progress_bar.py[line:274] - INFO: epoch 026:    177 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17637.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3111, ups=0.18, wpb=17637.1, bsz=1024, num_updates=9320, lr=3.96466e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=60661
2024-11-09 23:45:40 - progress_bar.py[line:274] - INFO: epoch 026:    187 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.041, ntokens=17411.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.23, wps=3046, ups=0.17, wpb=17411.4, bsz=1024, num_updates=9330, lr=3.9632e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=60718
2024-11-09 23:46:38 - progress_bar.py[line:274] - INFO: epoch 026:    197 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.019, ntokens=17566.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3022.9, ups=0.17, wpb=17566.4, bsz=1024, num_updates=9340, lr=3.96175e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=60777
2024-11-09 23:47:36 - progress_bar.py[line:274] - INFO: epoch 026:    207 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=17280.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=2993.9, ups=0.17, wpb=17280.5, bsz=1024, num_updates=9350, lr=3.9603e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=60834
2024-11-09 23:48:31 - progress_bar.py[line:274] - INFO: epoch 026:    217 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17328.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3166.2, ups=0.18, wpb=17328.9, bsz=1024, num_updates=9360, lr=3.95884e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=60889
2024-11-09 23:49:27 - progress_bar.py[line:274] - INFO: epoch 026:    227 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.005, ntokens=17464.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3085.6, ups=0.18, wpb=17464.6, bsz=1024, num_updates=9370, lr=3.95739e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=60946
2024-11-09 23:50:22 - progress_bar.py[line:274] - INFO: epoch 026:    237 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17306.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3173.4, ups=0.18, wpb=17306.1, bsz=1024, num_updates=9380, lr=3.95594e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=61000
2024-11-09 23:51:19 - progress_bar.py[line:274] - INFO: epoch 026:    247 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17309.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3037.4, ups=0.18, wpb=17309.7, bsz=1024, num_updates=9390, lr=3.95448e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=61057
2024-11-09 23:52:05 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-09 23:52:22 - progress_bar.py[line:274] - INFO: epoch 026:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.057, ntokens=17583.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.32, wps=2778.8, ups=0.16, wpb=17583.3, bsz=1024, num_updates=9400, lr=3.95303e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=63, gb_free=13.5, wall=61120
2024-11-09 23:53:19 - progress_bar.py[line:274] - INFO: epoch 026:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17419.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3058.7, ups=0.18, wpb=17419.4, bsz=1024, num_updates=9410, lr=3.95158e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=61177
2024-11-09 23:54:17 - progress_bar.py[line:274] - INFO: epoch 026:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.975, ntokens=17180, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=2973.9, ups=0.17, wpb=17180, bsz=1024, num_updates=9420, lr=3.95012e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=61235
2024-11-09 23:55:15 - progress_bar.py[line:274] - INFO: epoch 026:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.023, ntokens=17440.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=2992.8, ups=0.17, wpb=17440.8, bsz=1024, num_updates=9430, lr=3.94867e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=61293
2024-11-09 23:56:13 - progress_bar.py[line:274] - INFO: epoch 026:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17508.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3033.2, ups=0.17, wpb=17508.2, bsz=1024, num_updates=9440, lr=3.94722e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=61351
2024-11-09 23:57:11 - progress_bar.py[line:274] - INFO: epoch 026:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17599, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3025.5, ups=0.17, wpb=17599, bsz=1024, num_updates=9450, lr=3.94576e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=61409
2024-11-09 23:58:09 - progress_bar.py[line:274] - INFO: epoch 026:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.067, ntokens=17713.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.38, wps=3071.4, ups=0.17, wpb=17713.1, bsz=1024, num_updates=9460, lr=3.94431e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=61467
2024-11-09 23:59:05 - progress_bar.py[line:274] - INFO: epoch 026:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17491, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3132.3, ups=0.18, wpb=17491, bsz=1024, num_updates=9470, lr=3.94286e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=61523
2024-11-10 00:00:03 - progress_bar.py[line:274] - INFO: epoch 026:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17433, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3011.8, ups=0.17, wpb=17433, bsz=1024, num_updates=9480, lr=3.9414e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=61581
2024-11-10 00:01:01 - progress_bar.py[line:274] - INFO: epoch 026:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17668.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.26, wps=3041.4, ups=0.17, wpb=17668.5, bsz=1024, num_updates=9490, lr=3.93995e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=61639
2024-11-10 00:01:58 - progress_bar.py[line:274] - INFO: epoch 026:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.061, ntokens=17681.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3085.3, ups=0.17, wpb=17681.5, bsz=1024, num_updates=9500, lr=3.9385e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=61696
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 00:02:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 26 @ 9508 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
2024-11-10 00:02:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt': File exists
: File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 00:04:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027slice_id 1 seek offset 46806

2024-11-10 00:06:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 26 @ 9508 updates, score 0) (writing took 220.68376814201474 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_26.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 00:07:15 - train.py[line:336] - INFO: end of epoch 26 (average epoch stats below)
2024-11-10 00:07:15 - progress_bar.py[line:282] - INFO: epoch 026 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.021 | ntokens 17441.3 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 8.12 | wps 2531.3 | ups 0.15 | wpb 17441.3 | bsz 1023.1 | num_updates 9508 | lr 3.93733e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2040 | gb_free 13.5 | wall 62013
2024-11-10 00:07:15 - trainer.py[line:639] - INFO: loading train data for epoch 27
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 00:09:43 - trainer.py[line:703] - INFO: begin training epoch 27
2024-11-10 00:09:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 00:09:56 - progress_bar.py[line:274] - INFO: epoch 027:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=16978.8, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=354.9, ups=0.02, wpb=16978.8, bsz=989.8, num_updates=9510, lr=3.93704e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=46, gb_free=13.5, wall=62174
2024-11-10 00:10:51 - progress_bar.py[line:274] - INFO: epoch 027:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17256.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3143.2, ups=0.18, wpb=17256.1, bsz=1024, num_updates=9520, lr=3.93559e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=62229
2024-11-10 00:11:49 - progress_bar.py[line:274] - INFO: epoch 027:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.003, ntokens=17373, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=2987.6, ups=0.17, wpb=17373, bsz=1024, num_updates=9530, lr=3.93414e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=50, gb_free=13.4, wall=62288
2024-11-10 00:12:48 - progress_bar.py[line:274] - INFO: epoch 027:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17272.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=2955.2, ups=0.17, wpb=17272.8, bsz=1024, num_updates=9540, lr=3.93268e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=62346
2024-11-10 00:13:46 - progress_bar.py[line:274] - INFO: epoch 027:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17414.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3011.8, ups=0.17, wpb=17414.1, bsz=1024, num_updates=9550, lr=3.93123e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=62404
2024-11-10 00:14:41 - progress_bar.py[line:274] - INFO: epoch 027:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.039, ntokens=17513.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3154.5, ups=0.18, wpb=17513.4, bsz=1024, num_updates=9560, lr=3.92978e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=62459
2024-11-10 00:15:38 - progress_bar.py[line:274] - INFO: epoch 027:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17593.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3079.9, ups=0.18, wpb=17593.7, bsz=1024, num_updates=9570, lr=3.92832e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=62516
2024-11-10 00:16:36 - progress_bar.py[line:274] - INFO: epoch 027:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17177.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=2985.7, ups=0.17, wpb=17177.6, bsz=1024, num_updates=9580, lr=3.92687e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=62574
2024-11-10 00:17:30 - progress_bar.py[line:274] - INFO: epoch 027:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17278.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3185.9, ups=0.18, wpb=17278.5, bsz=1024, num_updates=9590, lr=3.92542e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=62628
2024-11-10 00:18:26 - progress_bar.py[line:274] - INFO: epoch 027:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17419.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3100.1, ups=0.18, wpb=17419.6, bsz=1024, num_updates=9600, lr=3.92396e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=62684
2024-11-10 00:19:23 - progress_bar.py[line:274] - INFO: epoch 027:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17298.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3064.1, ups=0.18, wpb=17298.8, bsz=1024, num_updates=9610, lr=3.92251e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=62741
2024-11-10 00:20:21 - progress_bar.py[line:274] - INFO: epoch 027:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.012, ntokens=17508.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3023.5, ups=0.17, wpb=17508.4, bsz=1024, num_updates=9620, lr=3.92106e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=62799
2024-11-10 00:21:16 - progress_bar.py[line:274] - INFO: epoch 027:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17287, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3124, ups=0.18, wpb=17287, bsz=1015.4, num_updates=9630, lr=3.9196e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=62854
2024-11-10 00:22:14 - progress_bar.py[line:274] - INFO: epoch 027:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17010.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=2911.9, ups=0.17, wpb=17010.3, bsz=1024, num_updates=9640, lr=3.91815e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=62913
2024-11-10 00:23:10 - progress_bar.py[line:274] - INFO: epoch 027:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.997, ntokens=17359.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3116.3, ups=0.18, wpb=17359.9, bsz=1024, num_updates=9650, lr=3.9167e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=62968
2024-11-10 00:24:08 - progress_bar.py[line:274] - INFO: epoch 027:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17270.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3004.9, ups=0.17, wpb=17270.6, bsz=1024, num_updates=9660, lr=3.91524e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=63026
2024-11-10 00:25:02 - progress_bar.py[line:274] - INFO: epoch 027:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17342.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3164.5, ups=0.18, wpb=17342.6, bsz=1024, num_updates=9670, lr=3.91379e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=63081
2024-11-10 00:25:57 - progress_bar.py[line:274] - INFO: epoch 027:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.031, ntokens=17511.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.17, wps=3191, ups=0.18, wpb=17511.5, bsz=1024, num_updates=9680, lr=3.91234e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=63135
2024-11-10 00:26:56 - progress_bar.py[line:274] - INFO: epoch 027:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17318.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=2940.1, ups=0.17, wpb=17318.5, bsz=1024, num_updates=9690, lr=3.91088e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=63194
2024-11-10 00:27:50 - progress_bar.py[line:274] - INFO: epoch 027:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.032, ntokens=17554.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3257, ups=0.19, wpb=17554.7, bsz=1024, num_updates=9700, lr=3.90943e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=63248
2024-11-10 00:28:45 - progress_bar.py[line:274] - INFO: epoch 027:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17378, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3136, ups=0.18, wpb=17378, bsz=1024, num_updates=9710, lr=3.90798e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=63304
2024-11-10 00:29:42 - progress_bar.py[line:274] - INFO: epoch 027:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17347.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3059.3, ups=0.18, wpb=17347.5, bsz=1024, num_updates=9720, lr=3.90652e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=63360
2024-11-10 00:30:40 - progress_bar.py[line:274] - INFO: epoch 027:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17338.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3002.4, ups=0.17, wpb=17338.1, bsz=1024, num_updates=9730, lr=3.90507e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=63418
2024-11-10 00:31:36 - progress_bar.py[line:274] - INFO: epoch 027:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.969, ntokens=17139.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3052.7, ups=0.18, wpb=17139.5, bsz=1024, num_updates=9740, lr=3.90362e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=63474
2024-11-10 00:32:29 - progress_bar.py[line:274] - INFO: epoch 027:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17292.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3275.4, ups=0.19, wpb=17292.7, bsz=1024, num_updates=9750, lr=3.90216e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=63527
2024-11-10 00:33:25 - progress_bar.py[line:274] - INFO: epoch 027:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17445, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3130.5, ups=0.18, wpb=17445, bsz=1024, num_updates=9760, lr=3.90071e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=63583
2024-11-10 00:34:18 - progress_bar.py[line:274] - INFO: epoch 027:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.018, ntokens=17374.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3252.7, ups=0.19, wpb=17374.8, bsz=1024, num_updates=9770, lr=3.89926e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=63636
2024-11-10 00:35:14 - progress_bar.py[line:274] - INFO: epoch 027:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17465.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3108.6, ups=0.18, wpb=17465.8, bsz=1024, num_updates=9780, lr=3.8978e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=63692
2024-11-10 00:36:13 - progress_bar.py[line:274] - INFO: epoch 027:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17195.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=2933.8, ups=0.17, wpb=17195.7, bsz=1024, num_updates=9790, lr=3.89635e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=63751
2024-11-10 00:37:11 - progress_bar.py[line:274] - INFO: epoch 027:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17356.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=2976.5, ups=0.17, wpb=17356.7, bsz=1024, num_updates=9800, lr=3.8949e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=63809
2024-11-10 00:38:09 - progress_bar.py[line:274] - INFO: epoch 027:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.036, ntokens=17693.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3070.3, ups=0.17, wpb=17693.2, bsz=1024, num_updates=9810, lr=3.89344e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=63867
2024-11-10 00:39:06 - progress_bar.py[line:274] - INFO: epoch 027:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17562.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3072.3, ups=0.17, wpb=17562.3, bsz=1024, num_updates=9820, lr=3.89199e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=63924
2024-11-10 00:40:04 - progress_bar.py[line:274] - INFO: epoch 027:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=17486.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3020.7, ups=0.17, wpb=17486.9, bsz=1024, num_updates=9830, lr=3.89054e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=63982
2024-11-10 00:41:02 - progress_bar.py[line:274] - INFO: epoch 027:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.06, ntokens=17904, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.34, wps=3089, ups=0.17, wpb=17904, bsz=1024, num_updates=9840, lr=3.88908e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=64040
2024-11-10 00:42:00 - progress_bar.py[line:274] - INFO: epoch 027:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.045, ntokens=17667.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.25, wps=3055.1, ups=0.17, wpb=17667.6, bsz=1024, num_updates=9850, lr=3.88763e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=64098
2024-11-10 00:42:57 - progress_bar.py[line:274] - INFO: epoch 027:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.032, ntokens=17523.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.18, wps=3034.2, ups=0.17, wpb=17523.3, bsz=1024, num_updates=9860, lr=3.88618e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=64155
2024-11-10 00:43:54 - progress_bar.py[line:274] - INFO: epoch 027:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17458.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3100.6, ups=0.18, wpb=17458.7, bsz=1024, num_updates=9870, lr=3.88472e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=64212
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 00:44:14 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 27 @ 9874 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
2024-11-10 00:44:14 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 00:46:03 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
2024-11-10 00:47:56 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 27 @ 9874 updates, score 0) (writing took 222.05549476400483 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_27.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 00:48:51 - train.py[line:336] - INFO: end of epoch 27 (average epoch stats below)
2024-11-10 00:48:51 - progress_bar.py[line:282] - INFO: epoch 027 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.001 | ntokens 17389.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 8 | wps 2549.4 | ups 0.15 | wpb 17389.9 | bsz 1023.1 | num_updates 9874 | lr 3.88414e-05 | gnorm 0.006 | clip 0 | loss_scale 131072 | train_wall 2027 | gb_free 13.4 | wall 64509
2024-11-10 00:48:51 - trainer.py[line:639] - INFO: loading train data for epoch 28
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 00:51:22 - trainer.py[line:703] - INFO: begin training epoch 28
2024-11-10 00:51:22 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 00:51:57 - progress_bar.py[line:274] - INFO: epoch 028:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17003.4, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=351.8, ups=0.02, wpb=17003.4, bsz=998.4, num_updates=9880, lr=3.88327e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=64695
2024-11-10 00:52:54 - progress_bar.py[line:274] - INFO: epoch 028:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17356.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3047.5, ups=0.18, wpb=17356.9, bsz=1024, num_updates=9890, lr=3.88182e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=35, gb_free=13.5, wall=64752
2024-11-10 00:53:50 - progress_bar.py[line:274] - INFO: epoch 028:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.013, ntokens=17488.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.07, wps=3120.3, ups=0.18, wpb=17488.3, bsz=1024, num_updates=9900, lr=3.88036e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=64808
2024-11-10 00:54:46 - progress_bar.py[line:274] - INFO: epoch 028:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17111.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3045.2, ups=0.18, wpb=17111.1, bsz=1024, num_updates=9910, lr=3.87891e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=64864
2024-11-10 00:55:43 - progress_bar.py[line:274] - INFO: epoch 028:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.011, ntokens=17496.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3056.2, ups=0.17, wpb=17496.8, bsz=1024, num_updates=9920, lr=3.87746e-05, gnorm=0.007, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=64922
2024-11-10 00:56:41 - progress_bar.py[line:274] - INFO: epoch 028:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17220.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=2991.9, ups=0.17, wpb=17220.9, bsz=1024, num_updates=9930, lr=3.876e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=64979
2024-11-10 00:57:38 - progress_bar.py[line:274] - INFO: epoch 028:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.005, ntokens=17518.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3078.6, ups=0.18, wpb=17518.8, bsz=1024, num_updates=9940, lr=3.87455e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.2, wall=65036
2024-11-10 00:58:01 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 00:58:42 - progress_bar.py[line:274] - INFO: epoch 028:     77 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17363.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=2718.9, ups=0.16, wpb=17363.5, bsz=1024, num_updates=9950, lr=3.8731e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=64, gb_free=13.4, wall=65100
2024-11-10 00:59:39 - progress_bar.py[line:274] - INFO: epoch 028:     87 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17574.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3080.9, ups=0.18, wpb=17574.4, bsz=1024, num_updates=9960, lr=3.87164e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=65157
2024-11-10 01:00:37 - progress_bar.py[line:274] - INFO: epoch 028:     97 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.011, ntokens=17521.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.06, wps=3015.4, ups=0.17, wpb=17521.6, bsz=1024, num_updates=9970, lr=3.87019e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=65215
2024-11-10 01:01:35 - progress_bar.py[line:274] - INFO: epoch 028:    107 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17215.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=2955.1, ups=0.17, wpb=17215.6, bsz=1024, num_updates=9980, lr=3.86874e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=65273
2024-11-10 01:02:32 - progress_bar.py[line:274] - INFO: epoch 028:    117 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17573.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3076, ups=0.18, wpb=17573.3, bsz=1024, num_updates=9990, lr=3.86728e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=65330
2024-11-10 01:03:28 - progress_bar.py[line:274] - INFO: epoch 028:    127 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.969, ntokens=17239.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3061.7, ups=0.18, wpb=17239.7, bsz=1024, num_updates=10000, lr=3.86583e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=65387
loss_reg: 0.010675971358493675 loss_cls: 0.004300590138882399
loss_reg: 0.006604909330027398 loss_cls: 0.004113147966563702
loss_reg: 0.008114516477857256 loss_cls: 0.0032974621281027794
loss_reg: 0.009204230811886075 loss_cls: 0.003761124098673463
loss_reg: 0.010934748367338118 loss_cls: 0.004006759729236364
loss_reg: 0.009732018663266314 loss_cls: 0.0032103117555379868
loss_reg: 0.009559570720045239 loss_cls: 0.0029557556845247746
loss_reg: 0.007849326941719529 loss_cls: 0.003659295616671443
loss_reg: 0.007262887205187545 loss_cls: 0.0031774500384926796
loss_reg: 0.008583160362695168 loss_cls: 0.003081034868955612
loss_reg: 0.008015186088091826 loss_cls: 0.003708464791998267
loss_reg: 0.007722534340163983 loss_cls: 0.003848593682050705
loss_reg: 0.011738970242668689 loss_cls: 0.00422982033342123
loss_reg: 0.010771168132177602 loss_cls: 0.004211927764117718
loss_reg: 0.013431685833998388 loss_cls: 0.003021255834028125
loss_reg: 0.008114290391286166 loss_cls: 0.0035151932388544083
loss_reg: 0.01078556150671379 loss_cls: 0.004042483866214752
loss_reg: 0.012040224933925071 loss_cls: 0.002899966901168227
loss_reg: 0.007439850446411954 loss_cls: 0.003557444317266345
loss_reg: 0.006932635968279287 loss_cls: 0.003818853059783578
loss_reg: 0.008528753721819925 loss_cls: 0.003922533709555864
loss_reg: 0.006837767060586775 loss_cls: 0.0038200614508241415
loss_reg: 0.011864451011406783 loss_cls: 0.0037431051023304462
loss_reg: 0.006342980360209457 loss_cls: 0.0041536628268659115
loss_reg: 0.009602531336614449 loss_cls: 0.003621828043833375
loss_reg: 0.009841349958302905 loss_cls: 0.0031776740215718746
loss_reg: 0.008483904579521903 loss_cls: 0.0036068034823983908
loss_reg: 0.012035217472230806 loss_cls: 0.0037720846012234688
loss_reg: 0.006012964719375109 loss_cls: 0.0039487616159021854
loss_reg: 0.007915290359506954 loss_cls: 0.0030216246377676725
loss_reg: 0.010781282501725047 loss_cls: 0.0039547341875731945
loss_reg: 0.007966108115469384 loss_cls: 0.003457646584138274
loss_reg: 0.013474111271430826 loss_cls: 0.003923714626580477
loss_reg: 0.007162215315700962 loss_cls: 0.00356822251342237
loss_reg: 0.012814902580624671 loss_cls: 0.004024009685963392
loss_reg: 0.00959546670438944 loss_cls: 0.003587929531931877
loss_reg: 0.007833409318922688 loss_cls: 0.003996115177869797
loss_reg: 0.00772916883132816 loss_cls: 0.003146315459161997
loss_reg: 0.012245793912039733 loss_cls: 0.0038297309074550867
loss_reg: 0.006777278378496323 loss_cls: 0.003977866377681494
loss_reg: 0.00963656353840993 loss_cls: 0.00452130101621151
loss_reg: 0.005864182212177038 loss_cls: 0.004047095309942961
loss_reg: 0.009141084717912076 loss_cls: 0.005005567334592342
loss_reg: 0.005587814488165499 loss_cls: 0.004027390852570534
loss_reg: 0.007496234811407822 loss_cls: 0.003386865137144923
loss_reg: 0.00849626319376263 loss_cls: 0.005251362454146147
loss_reg: 0.007258215698360625 loss_cls: 0.003958072979003191
loss_reg: 0.008930690486010275 loss_cls: 0.004861538298428059
loss_reg: 0.006372342544876972 loss_cls: 0.004070156719535589
loss_reg: 0.0082301550144655 loss_cls: 0.0035024015232920647
loss_reg: 0.006224198280182262 loss_cls: 0.003459045197814703
loss_reg: 0.012765378953311366 loss_cls: 0.0028588329441845417
loss_reg: 0.008214653088304841 loss_cls: 0.00420382060110569
loss_reg: 0.01208662944926144 loss_cls: 0.0028287197928875685
loss_reg: 0.008923872763732136 loss_cls: 0.0034078427124768496
loss_reg: 0.011739220761183418 loss_cls: 0.0037148494739085436
loss_reg: 0.011178756648633662 loss_cls: 0.0033817326184362173
loss_reg: 0.0068166452390361265 loss_cls: 0.004110075067728758
loss_reg: 0.008375772731483013 loss_cls: 0.004419572185724974
loss_reg: 0.008512274330949424 loss_cls: 0.003568063024431467
loss_reg: 0.008135190959924854 loss_cls: 0.004115567542612553
loss_reg: 0.007102285493814459 loss_cls: 0.003116115927696228
loss_reg: 0.006620620366651725 loss_cls: 0.003730490803718567
loss_reg: 0.010474072456228325 loss_cls: 0.003357777837663889
2024-11-10 01:04:24 - progress_bar.py[line:274] - INFO: epoch 028:    137 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.998, ntokens=17553.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3177.5, ups=0.18, wpb=17553.5, bsz=1024, num_updates=10010, lr=3.86438e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=65442
2024-11-10 01:05:19 - progress_bar.py[line:274] - INFO: epoch 028:    147 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.027, ntokens=17572.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.15, wps=3164.2, ups=0.18, wpb=17572.4, bsz=1024, num_updates=10020, lr=3.86292e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=65497
2024-11-10 01:06:17 - progress_bar.py[line:274] - INFO: epoch 028:    157 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17400.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3011.6, ups=0.17, wpb=17400.5, bsz=1024, num_updates=10030, lr=3.86147e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=65555
2024-11-10 01:07:12 - progress_bar.py[line:274] - INFO: epoch 028:    167 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.995, ntokens=17469.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3181.8, ups=0.18, wpb=17469.1, bsz=1024, num_updates=10040, lr=3.86002e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=65610
2024-11-10 01:08:08 - progress_bar.py[line:274] - INFO: epoch 028:    177 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17510.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3100.5, ups=0.18, wpb=17510.2, bsz=1024, num_updates=10050, lr=3.85856e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=65667
2024-11-10 01:09:05 - progress_bar.py[line:274] - INFO: epoch 028:    187 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.028, ntokens=17496.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.16, wps=3113.9, ups=0.18, wpb=17496.6, bsz=1024, num_updates=10060, lr=3.85711e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=65723
2024-11-10 01:10:02 - progress_bar.py[line:274] - INFO: epoch 028:    197 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17617.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3080, ups=0.17, wpb=17617.8, bsz=1024, num_updates=10070, lr=3.85566e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=65780
2024-11-10 01:10:59 - progress_bar.py[line:274] - INFO: epoch 028:    207 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17376.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3029.3, ups=0.17, wpb=17376.3, bsz=1024, num_updates=10080, lr=3.8542e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=65837
2024-11-10 01:11:57 - progress_bar.py[line:274] - INFO: epoch 028:    217 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17021.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=2921.7, ups=0.17, wpb=17021.9, bsz=1024, num_updates=10090, lr=3.85275e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=65896
2024-11-10 01:12:53 - progress_bar.py[line:274] - INFO: epoch 028:    227 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.016, ntokens=17491.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3164.5, ups=0.18, wpb=17491.3, bsz=1024, num_updates=10100, lr=3.8513e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=65951
2024-11-10 01:13:50 - progress_bar.py[line:274] - INFO: epoch 028:    237 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17322.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3006, ups=0.17, wpb=17322.6, bsz=1024, num_updates=10110, lr=3.84984e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=66009
2024-11-10 01:14:47 - progress_bar.py[line:274] - INFO: epoch 028:    247 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17496.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3061, ups=0.17, wpb=17496.6, bsz=1024, num_updates=10120, lr=3.84839e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=66066
2024-11-10 01:15:44 - progress_bar.py[line:274] - INFO: epoch 028:    257 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17239.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3048.3, ups=0.18, wpb=17239.6, bsz=1024, num_updates=10130, lr=3.84694e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=66122
2024-11-10 01:16:42 - progress_bar.py[line:274] - INFO: epoch 028:    267 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17108.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=2961.8, ups=0.17, wpb=17108.4, bsz=1024, num_updates=10140, lr=3.84548e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=66180
2024-11-10 01:17:40 - progress_bar.py[line:274] - INFO: epoch 028:    277 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=17388.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=2981.7, ups=0.17, wpb=17388.9, bsz=1024, num_updates=10150, lr=3.84403e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=66238
2024-11-10 01:18:38 - progress_bar.py[line:274] - INFO: epoch 028:    287 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17229, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=2970.3, ups=0.17, wpb=17229, bsz=1024, num_updates=10160, lr=3.84258e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=66296
2024-11-10 01:19:36 - progress_bar.py[line:274] - INFO: epoch 028:    297 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17035.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=2948.7, ups=0.17, wpb=17035.9, bsz=1015.4, num_updates=10170, lr=3.84112e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=66354
2024-11-10 01:20:34 - progress_bar.py[line:274] - INFO: epoch 028:    307 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.043, ntokens=17796.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3046.2, ups=0.17, wpb=17796.6, bsz=1024, num_updates=10180, lr=3.83967e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=66413
2024-11-10 01:21:32 - progress_bar.py[line:274] - INFO: epoch 028:    317 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.052, ntokens=17838.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.29, wps=3115.6, ups=0.17, wpb=17838.6, bsz=1024, num_updates=10190, lr=3.83822e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=66470
2024-11-10 01:22:30 - progress_bar.py[line:274] - INFO: epoch 028:    327 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17522.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=2990.9, ups=0.17, wpb=17522.6, bsz=1024, num_updates=10200, lr=3.83676e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=66528
2024-11-10 01:23:28 - progress_bar.py[line:274] - INFO: epoch 028:    337 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.007, ntokens=17640.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3067.1, ups=0.17, wpb=17640.6, bsz=1024, num_updates=10210, lr=3.83531e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=66586
2024-11-10 01:24:24 - progress_bar.py[line:274] - INFO: epoch 028:    347 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.035, ntokens=17677, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.2, wps=3130.5, ups=0.18, wpb=17677, bsz=1024, num_updates=10220, lr=3.83386e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=66642
2024-11-10 01:25:21 - progress_bar.py[line:274] - INFO: epoch 028:    357 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17613.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.1, wps=3116.1, ups=0.18, wpb=17613.5, bsz=1024, num_updates=10230, lr=3.8324e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=66699
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt2024-11-10 01:26:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 28 @ 10239 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
2024-11-10 01:26:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt': File exists: File exists
: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 01:27:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
2024-11-10 01:29:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 28 @ 10239 updates, score 0) (writing took 220.0258825609926 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_28.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 01:30:44 - train.py[line:336] - INFO: end of epoch 28 (average epoch stats below)
2024-11-10 01:30:44 - progress_bar.py[line:282] - INFO: epoch 028 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.993 | ntokens 17415.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.96 | wps 2529.4 | ups 0.15 | wpb 17415.7 | bsz 1023.1 | num_updates 10239 | lr 3.8311e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2044 | gb_free 13.5 | wall 67023
2024-11-10 01:30:44 - trainer.py[line:639] - INFO: loading train data for epoch 29
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 01:33:14 - trainer.py[line:703] - INFO: begin training epoch 29
2024-11-10 01:33:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 01:33:22 - progress_bar.py[line:274] - INFO: epoch 029:      1 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=16861.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=350.6, ups=0.02, wpb=16861.1, bsz=998.4, num_updates=10240, lr=3.83095e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=51, gb_free=13.5, wall=67180
2024-11-10 01:34:16 - progress_bar.py[line:274] - INFO: epoch 029:     11 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17359.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3172.7, ups=0.18, wpb=17359.8, bsz=1024, num_updates=10250, lr=3.8295e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=67234
2024-11-10 01:35:13 - progress_bar.py[line:274] - INFO: epoch 029:     21 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=17577.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3093.4, ups=0.18, wpb=17577.3, bsz=1024, num_updates=10260, lr=3.82804e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=42, gb_free=13.3, wall=67291
2024-11-10 01:36:11 - progress_bar.py[line:274] - INFO: epoch 029:     31 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17393.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=2994.7, ups=0.17, wpb=17393.1, bsz=1024, num_updates=10270, lr=3.82659e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=67349
2024-11-10 01:37:09 - progress_bar.py[line:274] - INFO: epoch 029:     41 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=17366.5, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3001.7, ups=0.17, wpb=17366.5, bsz=1015.4, num_updates=10280, lr=3.82514e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=67407
2024-11-10 01:38:05 - progress_bar.py[line:274] - INFO: epoch 029:     51 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.02, ntokens=17639.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.11, wps=3143.8, ups=0.18, wpb=17639.3, bsz=1024, num_updates=10290, lr=3.82368e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=67463
2024-11-10 01:39:01 - progress_bar.py[line:274] - INFO: epoch 029:     61 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.981, ntokens=17549.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3150.5, ups=0.18, wpb=17549.7, bsz=1024, num_updates=10300, lr=3.82223e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=67519
2024-11-10 01:39:58 - progress_bar.py[line:274] - INFO: epoch 029:     71 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17620, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3088.4, ups=0.18, wpb=17620, bsz=1024, num_updates=10310, lr=3.82078e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=67576
2024-11-10 01:40:51 - progress_bar.py[line:274] - INFO: epoch 029:     81 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17358.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3242.7, ups=0.19, wpb=17358.8, bsz=1024, num_updates=10320, lr=3.81932e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=67630
2024-11-10 01:41:50 - progress_bar.py[line:274] - INFO: epoch 029:     91 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.957, ntokens=17468.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=2973.4, ups=0.17, wpb=17468.2, bsz=1024, num_updates=10330, lr=3.81787e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13, wall=67688
2024-11-10 01:42:45 - progress_bar.py[line:274] - INFO: epoch 029:    101 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.042, ntokens=17587.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.24, wps=3230.3, ups=0.18, wpb=17587.2, bsz=1024, num_updates=10340, lr=3.81642e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=67743
2024-11-10 01:43:41 - progress_bar.py[line:274] - INFO: epoch 029:    111 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17254.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3059.5, ups=0.18, wpb=17254.7, bsz=1024, num_updates=10350, lr=3.81496e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=67799
2024-11-10 01:44:39 - progress_bar.py[line:274] - INFO: epoch 029:    121 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17627.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.13, wps=3032, ups=0.17, wpb=17627.1, bsz=1024, num_updates=10360, lr=3.81351e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=67857
2024-11-10 01:45:34 - progress_bar.py[line:274] - INFO: epoch 029:    131 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17223.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3123.4, ups=0.18, wpb=17223.7, bsz=1024, num_updates=10370, lr=3.81206e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=67913
2024-11-10 01:46:30 - progress_bar.py[line:274] - INFO: epoch 029:    141 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17228.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3110.3, ups=0.18, wpb=17228.2, bsz=1024, num_updates=10380, lr=3.8106e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=67968
2024-11-10 01:47:28 - progress_bar.py[line:274] - INFO: epoch 029:    151 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.979, ntokens=17461.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=2996.3, ups=0.17, wpb=17461.4, bsz=1024, num_updates=10390, lr=3.80915e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=68026
2024-11-10 01:48:26 - progress_bar.py[line:274] - INFO: epoch 029:    161 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17344.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=2964.9, ups=0.17, wpb=17344.5, bsz=1024, num_updates=10400, lr=3.8077e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=68085
2024-11-10 01:49:24 - progress_bar.py[line:274] - INFO: epoch 029:    171 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17380.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3031.4, ups=0.17, wpb=17380.6, bsz=1024, num_updates=10410, lr=3.80624e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=68142
2024-11-10 01:50:19 - progress_bar.py[line:274] - INFO: epoch 029:    181 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17460.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3146.3, ups=0.18, wpb=17460.8, bsz=1024, num_updates=10420, lr=3.80479e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=68198
2024-11-10 01:51:15 - progress_bar.py[line:274] - INFO: epoch 029:    191 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17254.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3120.9, ups=0.18, wpb=17254.1, bsz=1024, num_updates=10430, lr=3.80334e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=68253
2024-11-10 01:52:09 - progress_bar.py[line:274] - INFO: epoch 029:    201 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17616.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3267.7, ups=0.19, wpb=17616.2, bsz=1024, num_updates=10440, lr=3.80188e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=68307
2024-11-10 01:53:06 - progress_bar.py[line:274] - INFO: epoch 029:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17280.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=2985.4, ups=0.17, wpb=17280.5, bsz=1024, num_updates=10450, lr=3.80043e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=68365
2024-11-10 01:53:44 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 01:54:05 - progress_bar.py[line:274] - INFO: epoch 029:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17223.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=2934.4, ups=0.17, wpb=17223.1, bsz=1024, num_updates=10460, lr=3.79898e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=68423
2024-11-10 01:55:01 - progress_bar.py[line:274] - INFO: epoch 029:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.004, ntokens=17487.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.02, wps=3140.6, ups=0.18, wpb=17487.8, bsz=1024, num_updates=10470, lr=3.79752e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=68479
2024-11-10 01:55:53 - progress_bar.py[line:274] - INFO: epoch 029:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.962, ntokens=17211.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3311.6, ups=0.19, wpb=17211.4, bsz=1024, num_updates=10480, lr=3.79607e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=68531
2024-11-10 01:56:47 - progress_bar.py[line:274] - INFO: epoch 029:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.001, ntokens=17457.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3226.2, ups=0.18, wpb=17457.9, bsz=1024, num_updates=10490, lr=3.79462e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=51, gb_free=13.2, wall=68585
2024-11-10 01:57:42 - progress_bar.py[line:274] - INFO: epoch 029:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17162.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3132.2, ups=0.18, wpb=17162.7, bsz=1024, num_updates=10500, lr=3.79316e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=49, gb_free=13.5, wall=68640
2024-11-10 01:58:40 - progress_bar.py[line:274] - INFO: epoch 029:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17320.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=2962.2, ups=0.17, wpb=17320.5, bsz=1024, num_updates=10510, lr=3.79171e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=68698
2024-11-10 01:59:32 - progress_bar.py[line:274] - INFO: epoch 029:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17177.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3283.4, ups=0.19, wpb=17177.7, bsz=1024, num_updates=10520, lr=3.79026e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=68751
2024-11-10 02:00:29 - progress_bar.py[line:274] - INFO: epoch 029:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.939, ntokens=17270.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3067.3, ups=0.18, wpb=17270.6, bsz=1024, num_updates=10530, lr=3.7888e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.6, wall=68807
2024-11-10 02:01:26 - progress_bar.py[line:274] - INFO: epoch 029:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17416.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3017.1, ups=0.17, wpb=17416.7, bsz=1024, num_updates=10540, lr=3.78735e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=68865
2024-11-10 02:02:23 - progress_bar.py[line:274] - INFO: epoch 029:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17562.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3118.9, ups=0.18, wpb=17562.7, bsz=1024, num_updates=10550, lr=3.7859e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=68921
2024-11-10 02:03:15 - progress_bar.py[line:274] - INFO: epoch 029:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.017, ntokens=17582.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.09, wps=3365.7, ups=0.19, wpb=17582.9, bsz=1024, num_updates=10560, lr=3.78444e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=68973
2024-11-10 02:04:10 - progress_bar.py[line:274] - INFO: epoch 029:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.04, ntokens=18012.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.22, wps=3260.2, ups=0.18, wpb=18012.3, bsz=1024, num_updates=10570, lr=3.78299e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=69028
2024-11-10 02:05:05 - progress_bar.py[line:274] - INFO: epoch 029:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17348.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3154.6, ups=0.18, wpb=17348.8, bsz=1024, num_updates=10580, lr=3.78154e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=69083
2024-11-10 02:06:04 - progress_bar.py[line:274] - INFO: epoch 029:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=17667.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3000.5, ups=0.17, wpb=17667.4, bsz=1024, num_updates=10590, lr=3.78008e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.2, wall=69142
2024-11-10 02:07:02 - progress_bar.py[line:274] - INFO: epoch 029:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.999, ntokens=17723.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.99, wps=3045.1, ups=0.17, wpb=17723.5, bsz=1024, num_updates=10600, lr=3.77863e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=69201
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 02:07:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 29 @ 10604 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
2024-11-10 02:07:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 02:09:12 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-10 02:11:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 29 @ 10604 updates, score 0) (writing took 222.17310436302796 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_29.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 02:12:00 - train.py[line:336] - INFO: end of epoch 29 (average epoch stats below)
2024-11-10 02:12:00 - progress_bar.py[line:282] - INFO: epoch 029 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.981 | ntokens 17426.5 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.9 | wps 2569.5 | ups 0.15 | wpb 17426.5 | bsz 1023.1 | num_updates 10604 | lr 3.77805e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1990 | gb_free 13.4 | wall 69498
2024-11-10 02:12:00 - trainer.py[line:639] - INFO: loading train data for epoch 30
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 02:14:30 - trainer.py[line:703] - INFO: begin training epoch 30
2024-11-10 02:14:30 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 02:15:05 - progress_bar.py[line:274] - INFO: epoch 030:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.99, ntokens=17126, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=355.1, ups=0.02, wpb=17126, bsz=998.4, num_updates=10610, lr=3.77718e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=69683
2024-11-10 02:16:01 - progress_bar.py[line:274] - INFO: epoch 030:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17509, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3109, ups=0.18, wpb=17509, bsz=1024, num_updates=10620, lr=3.77572e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=36, gb_free=13.4, wall=69739
2024-11-10 02:17:00 - progress_bar.py[line:274] - INFO: epoch 030:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.935, ntokens=17208.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=2929.8, ups=0.17, wpb=17208.6, bsz=1024, num_updates=10630, lr=3.77427e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=69798
2024-11-10 02:17:59 - progress_bar.py[line:274] - INFO: epoch 030:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17379.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=2952.6, ups=0.17, wpb=17379.6, bsz=1024, num_updates=10640, lr=3.77282e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=69857
2024-11-10 02:18:54 - progress_bar.py[line:274] - INFO: epoch 030:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17330, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3105.9, ups=0.18, wpb=17330, bsz=1024, num_updates=10650, lr=3.77136e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=69913
2024-11-10 02:19:49 - progress_bar.py[line:274] - INFO: epoch 030:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17202.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3131.4, ups=0.18, wpb=17202.7, bsz=1015.4, num_updates=10660, lr=3.76991e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=69968
2024-11-10 02:20:47 - progress_bar.py[line:274] - INFO: epoch 030:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17332.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3017.3, ups=0.17, wpb=17332.9, bsz=1024, num_updates=10670, lr=3.76846e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=70025
2024-11-10 02:21:45 - progress_bar.py[line:274] - INFO: epoch 030:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17346.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=2994.6, ups=0.17, wpb=17346.6, bsz=1024, num_updates=10680, lr=3.767e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=70083
2024-11-10 02:22:43 - progress_bar.py[line:274] - INFO: epoch 030:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17513, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3017, ups=0.17, wpb=17513, bsz=1024, num_updates=10690, lr=3.76555e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=70141
2024-11-10 02:23:40 - progress_bar.py[line:274] - INFO: epoch 030:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17480.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3039.9, ups=0.17, wpb=17480.6, bsz=1024, num_updates=10700, lr=3.7641e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=70198
2024-11-10 02:24:38 - progress_bar.py[line:274] - INFO: epoch 030:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17310.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=2977.8, ups=0.17, wpb=17310.6, bsz=1024, num_updates=10710, lr=3.76264e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=70257
2024-11-10 02:25:35 - progress_bar.py[line:274] - INFO: epoch 030:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17445.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3092.8, ups=0.18, wpb=17445.8, bsz=1024, num_updates=10720, lr=3.76119e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=70313
2024-11-10 02:26:33 - progress_bar.py[line:274] - INFO: epoch 030:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=17597.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3042.5, ups=0.17, wpb=17597.2, bsz=1024, num_updates=10730, lr=3.75974e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.6, wall=70371
2024-11-10 02:27:31 - progress_bar.py[line:274] - INFO: epoch 030:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17464, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3013.3, ups=0.17, wpb=17464, bsz=1024, num_updates=10740, lr=3.75828e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=70429
2024-11-10 02:28:28 - progress_bar.py[line:274] - INFO: epoch 030:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17542.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3039.1, ups=0.17, wpb=17542.1, bsz=1024, num_updates=10750, lr=3.75683e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=70487
2024-11-10 02:29:27 - progress_bar.py[line:274] - INFO: epoch 030:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17491.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=2988.2, ups=0.17, wpb=17491.3, bsz=1024, num_updates=10760, lr=3.75538e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=70545
2024-11-10 02:30:24 - progress_bar.py[line:274] - INFO: epoch 030:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17444.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3045.1, ups=0.17, wpb=17444.7, bsz=1024, num_updates=10770, lr=3.75392e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.1, wall=70602
2024-11-10 02:31:20 - progress_bar.py[line:274] - INFO: epoch 030:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.981, ntokens=17415.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3096.6, ups=0.18, wpb=17415.6, bsz=1024, num_updates=10780, lr=3.75247e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=70659
2024-11-10 02:32:18 - progress_bar.py[line:274] - INFO: epoch 030:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17655, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3047.6, ups=0.17, wpb=17655, bsz=1024, num_updates=10790, lr=3.75102e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=70717
2024-11-10 02:33:15 - progress_bar.py[line:274] - INFO: epoch 030:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17306.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3048.4, ups=0.18, wpb=17306.9, bsz=1024, num_updates=10800, lr=3.74956e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=70773
2024-11-10 02:34:13 - progress_bar.py[line:274] - INFO: epoch 030:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17254.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=2979.2, ups=0.17, wpb=17254.3, bsz=1024, num_updates=10810, lr=3.74811e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=70831
2024-11-10 02:35:11 - progress_bar.py[line:274] - INFO: epoch 030:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17322, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3006.2, ups=0.17, wpb=17322, bsz=1024, num_updates=10820, lr=3.74666e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=70889
2024-11-10 02:36:08 - progress_bar.py[line:274] - INFO: epoch 030:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.948, ntokens=17403.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3047.7, ups=0.18, wpb=17403.8, bsz=1024, num_updates=10830, lr=3.7452e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=70946
2024-11-10 02:37:06 - progress_bar.py[line:274] - INFO: epoch 030:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17465.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3015.8, ups=0.17, wpb=17465.8, bsz=1024, num_updates=10840, lr=3.74375e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=71004
2024-11-10 02:38:03 - progress_bar.py[line:274] - INFO: epoch 030:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17321.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3010.6, ups=0.17, wpb=17321.5, bsz=1024, num_updates=10850, lr=3.7423e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=71061
2024-11-10 02:39:01 - progress_bar.py[line:274] - INFO: epoch 030:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17463.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3028.5, ups=0.17, wpb=17463.6, bsz=1024, num_updates=10860, lr=3.74084e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=71119
2024-11-10 02:39:58 - progress_bar.py[line:274] - INFO: epoch 030:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17197.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=2985.5, ups=0.17, wpb=17197.9, bsz=1024, num_updates=10870, lr=3.73939e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=71177
2024-11-10 02:40:55 - progress_bar.py[line:274] - INFO: epoch 030:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17449.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3070.5, ups=0.18, wpb=17449.9, bsz=1024, num_updates=10880, lr=3.73794e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=71233
2024-11-10 02:41:52 - progress_bar.py[line:274] - INFO: epoch 030:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17205.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3046.3, ups=0.18, wpb=17205.9, bsz=1024, num_updates=10890, lr=3.73648e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=71290
2024-11-10 02:42:50 - progress_bar.py[line:274] - INFO: epoch 030:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17551.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=2995.4, ups=0.17, wpb=17551.7, bsz=1024, num_updates=10900, lr=3.73503e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=71349
2024-11-10 02:43:48 - progress_bar.py[line:274] - INFO: epoch 030:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.962, ntokens=17455.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3010, ups=0.17, wpb=17455.7, bsz=1024, num_updates=10910, lr=3.73358e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=71407
2024-11-10 02:44:42 - progress_bar.py[line:274] - INFO: epoch 030:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17499.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=3283.8, ups=0.19, wpb=17499.9, bsz=1024, num_updates=10920, lr=3.73212e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=71460
2024-11-10 02:45:39 - progress_bar.py[line:274] - INFO: epoch 030:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17584, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3064.6, ups=0.17, wpb=17584, bsz=1024, num_updates=10930, lr=3.73067e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=71517
2024-11-10 02:46:36 - progress_bar.py[line:274] - INFO: epoch 030:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17542.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3071.4, ups=0.18, wpb=17542.6, bsz=1024, num_updates=10940, lr=3.72922e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=71574
2024-11-10 02:47:34 - progress_bar.py[line:274] - INFO: epoch 030:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.984, ntokens=17568.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3011.1, ups=0.17, wpb=17568.1, bsz=1024, num_updates=10950, lr=3.72776e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=71633
2024-11-10 02:48:32 - progress_bar.py[line:274] - INFO: epoch 030:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.025, ntokens=17836.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3123.9, ups=0.18, wpb=17836.2, bsz=1024, num_updates=10960, lr=3.72631e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=71690
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 02:49:27 - progress_bar.py[line:274] - INFO: epoch 030:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=16943, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3056, ups=0.18, wpb=16943, bsz=998.4, num_updates=10970, lr=3.72486e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=71745
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-10 02:49:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 30 @ 10970 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
2024-11-10 02:49:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 02:51:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 02:53:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 30 @ 10970 updates, score 0) (writing took 223.15510468900902 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_30.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 02:54:06 - train.py[line:336] - INFO: end of epoch 30 (average epoch stats below)
2024-11-10 02:54:06 - progress_bar.py[line:282] - INFO: epoch 030 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.971 | ntokens 17417.6 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.84 | wps 2524 | ups 0.14 | wpb 17417.6 | bsz 1023.1 | num_updates 10970 | lr 3.72486e-05 | gnorm 0.005 | clip 0 | loss_scale 262144 | train_wall 2056 | gb_free 13.4 | wall 72024
2024-11-10 02:54:06 - trainer.py[line:639] - INFO: loading train data for epoch 31
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 02:56:34 - trainer.py[line:703] - INFO: begin training epoch 31
2024-11-10 02:56:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 02:57:30 - progress_bar.py[line:274] - INFO: epoch 031:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17331.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=358.5, ups=0.02, wpb=17331.4, bsz=1024, num_updates=10980, lr=3.7234e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=72229
2024-11-10 02:58:25 - progress_bar.py[line:274] - INFO: epoch 031:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.994, ntokens=17560.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.97, wps=3211.2, ups=0.18, wpb=17560.4, bsz=1024, num_updates=10990, lr=3.72195e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=72283
2024-11-10 02:59:20 - progress_bar.py[line:274] - INFO: epoch 031:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17440, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3177.8, ups=0.18, wpb=17440, bsz=1024, num_updates=11000, lr=3.7205e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=32, gb_free=13.4, wall=72338
2024-11-10 03:00:15 - progress_bar.py[line:274] - INFO: epoch 031:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17372.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3139.5, ups=0.18, wpb=17372.9, bsz=1024, num_updates=11010, lr=3.71904e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=42, gb_free=13.2, wall=72394
2024-11-10 03:01:13 - progress_bar.py[line:274] - INFO: epoch 031:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.977, ntokens=17573.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3028.7, ups=0.17, wpb=17573.1, bsz=1024, num_updates=11020, lr=3.71759e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.1, wall=72452
2024-11-10 03:02:11 - progress_bar.py[line:274] - INFO: epoch 031:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17409.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3006.5, ups=0.17, wpb=17409.9, bsz=1024, num_updates=11030, lr=3.71614e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=72509
2024-11-10 03:03:09 - progress_bar.py[line:274] - INFO: epoch 031:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17478.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3035.6, ups=0.17, wpb=17478.5, bsz=1024, num_updates=11040, lr=3.71468e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=72567
2024-11-10 03:04:05 - progress_bar.py[line:274] - INFO: epoch 031:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17425.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3087.7, ups=0.18, wpb=17425.4, bsz=1024, num_updates=11050, lr=3.71323e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=72624
2024-11-10 03:05:03 - progress_bar.py[line:274] - INFO: epoch 031:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17567.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3044, ups=0.17, wpb=17567.2, bsz=1024, num_updates=11060, lr=3.71178e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=72681
2024-11-10 03:06:00 - progress_bar.py[line:274] - INFO: epoch 031:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.015, ntokens=17676.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=3081.5, ups=0.17, wpb=17676.9, bsz=1024, num_updates=11070, lr=3.71032e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=72739
2024-11-10 03:06:58 - progress_bar.py[line:274] - INFO: epoch 031:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.962, ntokens=17478.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3012.1, ups=0.17, wpb=17478.4, bsz=1024, num_updates=11080, lr=3.70887e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.2, wall=72797
2024-11-10 03:07:56 - progress_bar.py[line:274] - INFO: epoch 031:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17360.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3033.9, ups=0.17, wpb=17360.3, bsz=1024, num_updates=11090, lr=3.70742e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=72854
2024-11-10 03:08:53 - progress_bar.py[line:274] - INFO: epoch 031:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17276.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=2990, ups=0.17, wpb=17276.9, bsz=1024, num_updates=11100, lr=3.70596e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.1, wall=72912
2024-11-10 03:09:49 - progress_bar.py[line:274] - INFO: epoch 031:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.959, ntokens=17344.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3132.2, ups=0.18, wpb=17344.8, bsz=1024, num_updates=11110, lr=3.70451e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=72967
2024-11-10 03:10:42 - progress_bar.py[line:274] - INFO: epoch 031:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.963, ntokens=17492.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3285.5, ups=0.19, wpb=17492.8, bsz=1024, num_updates=11120, lr=3.70306e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=73020
2024-11-10 03:11:36 - progress_bar.py[line:274] - INFO: epoch 031:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=17398.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3207.9, ups=0.18, wpb=17398.4, bsz=1024, num_updates=11130, lr=3.7016e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=73074
2024-11-10 03:12:35 - progress_bar.py[line:274] - INFO: epoch 031:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17278.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=2964.8, ups=0.17, wpb=17278.5, bsz=1024, num_updates=11140, lr=3.70015e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=73133
2024-11-10 03:13:33 - progress_bar.py[line:274] - INFO: epoch 031:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17388.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=2988.5, ups=0.17, wpb=17388.4, bsz=1024, num_updates=11150, lr=3.6987e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=73191
2024-11-10 03:14:30 - progress_bar.py[line:274] - INFO: epoch 031:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=16987.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=2966.4, ups=0.17, wpb=16987.5, bsz=1024, num_updates=11160, lr=3.69724e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=73248
2024-11-10 03:15:22 - progress_bar.py[line:274] - INFO: epoch 031:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17069.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3309, ups=0.19, wpb=17069.1, bsz=1024, num_updates=11170, lr=3.69579e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=50, gb_free=13.4, wall=73300
2024-11-10 03:16:18 - progress_bar.py[line:274] - INFO: epoch 031:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.006, ntokens=17664.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.03, wps=3125.3, ups=0.18, wpb=17664.6, bsz=1024, num_updates=11180, lr=3.69434e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=44, gb_free=13.5, wall=73356
2024-11-10 03:17:16 - progress_bar.py[line:274] - INFO: epoch 031:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17720.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.05, wps=3084.6, ups=0.17, wpb=17720.5, bsz=1024, num_updates=11190, lr=3.69288e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=73414
2024-11-10 03:18:11 - progress_bar.py[line:274] - INFO: epoch 031:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17348.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3102.4, ups=0.18, wpb=17348.2, bsz=1024, num_updates=11200, lr=3.69143e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=73470
2024-11-10 03:18:17 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 03:19:16 - progress_bar.py[line:274] - INFO: epoch 031:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.993, ntokens=17559, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=2723.1, ups=0.16, wpb=17559, bsz=1024, num_updates=11210, lr=3.68998e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=64, gb_free=13.4, wall=73534
2024-11-10 03:20:13 - progress_bar.py[line:274] - INFO: epoch 031:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17315.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3017.7, ups=0.17, wpb=17315.3, bsz=1024, num_updates=11220, lr=3.68852e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=73592
2024-11-10 03:21:10 - progress_bar.py[line:274] - INFO: epoch 031:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17262.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3031, ups=0.18, wpb=17262.4, bsz=1024, num_updates=11230, lr=3.68707e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.6, wall=73648
2024-11-10 03:22:06 - progress_bar.py[line:274] - INFO: epoch 031:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17669.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3162.2, ups=0.18, wpb=17669.5, bsz=1024, num_updates=11240, lr=3.68562e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=73704
2024-11-10 03:22:59 - progress_bar.py[line:274] - INFO: epoch 031:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17174.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3221.8, ups=0.19, wpb=17174.2, bsz=1024, num_updates=11250, lr=3.68416e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=73758
2024-11-10 03:23:59 - progress_bar.py[line:274] - INFO: epoch 031:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17458.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=2951.7, ups=0.17, wpb=17458.5, bsz=1024, num_updates=11260, lr=3.68271e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=73817
2024-11-10 03:24:57 - progress_bar.py[line:274] - INFO: epoch 031:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.992, ntokens=17460.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.96, wps=3013.8, ups=0.17, wpb=17460.9, bsz=1015.4, num_updates=11270, lr=3.68126e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=73875
2024-11-10 03:25:51 - progress_bar.py[line:274] - INFO: epoch 031:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17615, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3250.8, ups=0.18, wpb=17615, bsz=1024, num_updates=11280, lr=3.6798e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=73929
2024-11-10 03:26:47 - progress_bar.py[line:274] - INFO: epoch 031:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.982, ntokens=17560.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.9, wps=3139.7, ups=0.18, wpb=17560.3, bsz=1024, num_updates=11290, lr=3.67835e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=73985
2024-11-10 03:27:42 - progress_bar.py[line:274] - INFO: epoch 031:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.968, ntokens=17475.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3184.2, ups=0.18, wpb=17475.8, bsz=1024, num_updates=11300, lr=3.6769e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=74040
2024-11-10 03:28:38 - progress_bar.py[line:274] - INFO: epoch 031:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=17588.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3110.4, ups=0.18, wpb=17588.3, bsz=1024, num_updates=11310, lr=3.67544e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=74096
2024-11-10 03:29:35 - progress_bar.py[line:274] - INFO: epoch 031:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17618.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3079.4, ups=0.17, wpb=17618.4, bsz=1024, num_updates=11320, lr=3.67399e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=74154
2024-11-10 03:30:29 - progress_bar.py[line:274] - INFO: epoch 031:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.983, ntokens=17623.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.91, wps=3258.7, ups=0.18, wpb=17623.2, bsz=1024, num_updates=11330, lr=3.67254e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=74208
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 03:30:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 31 @ 11335 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
2024-11-10 03:30:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 03:32:45 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
2024-11-10 03:34:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 31 @ 11335 updates, score 0) (writing took 222.4236519599799 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_31.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 03:35:33 - train.py[line:336] - INFO: end of epoch 31 (average epoch stats below)
2024-11-10 03:35:33 - progress_bar.py[line:282] - INFO: epoch 031 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.966 | ntokens 17435 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.81 | wps 2558.8 | ups 0.15 | wpb 17435 | bsz 1023.1 | num_updates 11335 | lr 3.67181e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1957 | gb_free 13.4 | wall 74511
2024-11-10 03:35:33 - trainer.py[line:639] - INFO: loading train data for epoch 32
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 03:38:01 - trainer.py[line:703] - INFO: begin training epoch 32
2024-11-10 03:38:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 03:38:30 - progress_bar.py[line:274] - INFO: epoch 032:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.98, ntokens=17197.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.89, wps=358.1, ups=0.02, wpb=17197.1, bsz=998.4, num_updates=11340, lr=3.67108e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=41, gb_free=13.4, wall=74688
2024-11-10 03:39:23 - progress_bar.py[line:274] - INFO: epoch 032:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17307.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3225, ups=0.19, wpb=17307.9, bsz=1015.4, num_updates=11350, lr=3.66963e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=74741
2024-11-10 03:40:20 - progress_bar.py[line:274] - INFO: epoch 032:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17521.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3115.5, ups=0.18, wpb=17521.2, bsz=1024, num_updates=11360, lr=3.66818e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=74798
2024-11-10 03:41:15 - progress_bar.py[line:274] - INFO: epoch 032:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=17334.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3119.1, ups=0.18, wpb=17334.5, bsz=1024, num_updates=11370, lr=3.66672e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=74853
2024-11-10 03:42:09 - progress_bar.py[line:274] - INFO: epoch 032:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17416.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3230.5, ups=0.19, wpb=17416.6, bsz=1024, num_updates=11380, lr=3.66527e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.2, wall=74907
2024-11-10 03:43:05 - progress_bar.py[line:274] - INFO: epoch 032:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17181.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3092.3, ups=0.18, wpb=17181.8, bsz=1024, num_updates=11390, lr=3.66382e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=74963
2024-11-10 03:44:02 - progress_bar.py[line:274] - INFO: epoch 032:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.95, ntokens=17389, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3008.8, ups=0.17, wpb=17389, bsz=1024, num_updates=11400, lr=3.66236e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=75021
2024-11-10 03:45:01 - progress_bar.py[line:274] - INFO: epoch 032:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17545.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3016.9, ups=0.17, wpb=17545.7, bsz=1024, num_updates=11410, lr=3.66091e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=75079
2024-11-10 03:45:58 - progress_bar.py[line:274] - INFO: epoch 032:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.974, ntokens=17606.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.86, wps=3064.9, ups=0.17, wpb=17606.5, bsz=1024, num_updates=11420, lr=3.65946e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=75136
2024-11-10 03:46:56 - progress_bar.py[line:274] - INFO: epoch 032:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17353.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3015.4, ups=0.17, wpb=17353.6, bsz=1024, num_updates=11430, lr=3.658e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=75194
2024-11-10 03:47:53 - progress_bar.py[line:274] - INFO: epoch 032:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17332.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3035.9, ups=0.18, wpb=17332.4, bsz=1024, num_updates=11440, lr=3.65655e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=75251
2024-11-10 03:48:51 - progress_bar.py[line:274] - INFO: epoch 032:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.951, ntokens=17387.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.73, wps=3003.5, ups=0.17, wpb=17387.3, bsz=1024, num_updates=11450, lr=3.6551e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=75309
2024-11-10 03:49:47 - progress_bar.py[line:274] - INFO: epoch 032:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17348.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3054, ups=0.18, wpb=17348.1, bsz=1024, num_updates=11460, lr=3.65364e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=75366
2024-11-10 03:50:45 - progress_bar.py[line:274] - INFO: epoch 032:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17382.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3038.9, ups=0.17, wpb=17382.8, bsz=1024, num_updates=11470, lr=3.65219e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=75423
2024-11-10 03:51:41 - progress_bar.py[line:274] - INFO: epoch 032:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17220.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3037.2, ups=0.18, wpb=17220.2, bsz=1024, num_updates=11480, lr=3.65074e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=75479
2024-11-10 03:52:38 - progress_bar.py[line:274] - INFO: epoch 032:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17473.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3074.1, ups=0.18, wpb=17473.6, bsz=1024, num_updates=11490, lr=3.64928e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=75536
2024-11-10 03:53:35 - progress_bar.py[line:274] - INFO: epoch 032:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17179.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3010.7, ups=0.18, wpb=17179.4, bsz=1024, num_updates=11500, lr=3.64783e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=75593
2024-11-10 03:54:32 - progress_bar.py[line:274] - INFO: epoch 032:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.968, ntokens=17558.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3084.4, ups=0.18, wpb=17558.9, bsz=1024, num_updates=11510, lr=3.64638e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=75650
2024-11-10 03:55:30 - progress_bar.py[line:274] - INFO: epoch 032:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17144.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=2964.7, ups=0.17, wpb=17144.8, bsz=1024, num_updates=11520, lr=3.64493e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=75708
2024-11-10 03:56:28 - progress_bar.py[line:274] - INFO: epoch 032:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.989, ntokens=17551.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.94, wps=3039.7, ups=0.17, wpb=17551.1, bsz=1024, num_updates=11530, lr=3.64347e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=75766
2024-11-10 03:57:25 - progress_bar.py[line:274] - INFO: epoch 032:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17415.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3037.5, ups=0.17, wpb=17415.6, bsz=1024, num_updates=11540, lr=3.64202e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=75823
2024-11-10 03:58:23 - progress_bar.py[line:274] - INFO: epoch 032:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17343.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3006.4, ups=0.17, wpb=17343.3, bsz=1024, num_updates=11550, lr=3.64057e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=75881
2024-11-10 03:59:20 - progress_bar.py[line:274] - INFO: epoch 032:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.976, ntokens=17644.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.87, wps=3052.2, ups=0.17, wpb=17644.9, bsz=1024, num_updates=11560, lr=3.63911e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=75939
2024-11-10 04:00:18 - progress_bar.py[line:274] - INFO: epoch 032:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17413, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3001.3, ups=0.17, wpb=17413, bsz=1024, num_updates=11570, lr=3.63766e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=75997
2024-11-10 04:01:15 - progress_bar.py[line:274] - INFO: epoch 032:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3, ntokens=17562.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8, wps=3088.2, ups=0.18, wpb=17562.9, bsz=1024, num_updates=11580, lr=3.63621e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=76054
2024-11-10 04:02:12 - progress_bar.py[line:274] - INFO: epoch 032:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17617.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3108.4, ups=0.18, wpb=17617.1, bsz=1024, num_updates=11590, lr=3.63475e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=76110
2024-11-10 04:03:07 - progress_bar.py[line:274] - INFO: epoch 032:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17272, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3157, ups=0.18, wpb=17272, bsz=1024, num_updates=11600, lr=3.6333e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=76165
2024-11-10 04:04:02 - progress_bar.py[line:274] - INFO: epoch 032:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.964, ntokens=17460.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.8, wps=3172, ups=0.18, wpb=17460.3, bsz=1024, num_updates=11610, lr=3.63185e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=76220
2024-11-10 04:04:59 - progress_bar.py[line:274] - INFO: epoch 032:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17255.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3037.3, ups=0.18, wpb=17255.8, bsz=1024, num_updates=11620, lr=3.63039e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=76277
2024-11-10 04:05:56 - progress_bar.py[line:274] - INFO: epoch 032:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17420.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3018.2, ups=0.17, wpb=17420.3, bsz=1024, num_updates=11630, lr=3.62894e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=76335
2024-11-10 04:06:54 - progress_bar.py[line:274] - INFO: epoch 032:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17582.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3065.7, ups=0.17, wpb=17582.4, bsz=1024, num_updates=11640, lr=3.62749e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=76392
2024-11-10 04:07:50 - progress_bar.py[line:274] - INFO: epoch 032:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.988, ntokens=17728.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3146.1, ups=0.18, wpb=17728.1, bsz=1024, num_updates=11650, lr=3.62603e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=76448
2024-11-10 04:08:47 - progress_bar.py[line:274] - INFO: epoch 032:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17533.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3059.4, ups=0.17, wpb=17533.8, bsz=1024, num_updates=11660, lr=3.62458e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=76506
2024-11-10 04:09:45 - progress_bar.py[line:274] - INFO: epoch 032:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17365.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=2997.7, ups=0.17, wpb=17365.8, bsz=1024, num_updates=11670, lr=3.62313e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=76563
2024-11-10 04:10:43 - progress_bar.py[line:274] - INFO: epoch 032:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.008, ntokens=17717.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.04, wps=3070.7, ups=0.17, wpb=17717.7, bsz=1024, num_updates=11680, lr=3.62167e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=76621
2024-11-10 04:11:37 - progress_bar.py[line:274] - INFO: epoch 032:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.94, ntokens=17388.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3223.2, ups=0.19, wpb=17388.1, bsz=1024, num_updates=11690, lr=3.62022e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=76675
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 04:12:34 - progress_bar.py[line:274] - INFO: epoch 032:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.956, ntokens=17518.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3052.5, ups=0.17, wpb=17518.9, bsz=1024, num_updates=11700, lr=3.61877e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=76733
2024-11-10 04:12:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 32 @ 11701 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
2024-11-10 04:12:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt': File exists: File exists
: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 04:14:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-10 04:16:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 32 @ 11701 updates, score 0) (writing took 221.34810955199646 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_32.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-10 04:17:14 - train.py[line:336] - INFO: end of epoch 32 (average epoch stats below)
2024-11-10 04:17:14 - progress_bar.py[line:282] - INFO: epoch 032 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.954 | ntokens 17420.3 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.75 | wps 2548.4 | ups 0.15 | wpb 17420.3 | bsz 1023.1 | num_updates 11701 | lr 3.61862e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2020 | gb_free 13.3 | wall 77013
2024-11-10 04:17:14 - trainer.py[line:639] - INFO: loading train data for epoch 33
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 04:19:44 - trainer.py[line:703] - INFO: begin training epoch 33
2024-11-10 04:19:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 04:20:35 - progress_bar.py[line:274] - INFO: epoch 033:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=16934.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=352.6, ups=0.02, wpb=16934.1, bsz=998.4, num_updates=11710, lr=3.61731e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=77213
2024-11-10 04:21:30 - progress_bar.py[line:274] - INFO: epoch 033:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17459.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3180.1, ups=0.18, wpb=17459.9, bsz=1024, num_updates=11720, lr=3.61586e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=32, gb_free=13.5, wall=77268
2024-11-10 04:22:28 - progress_bar.py[line:274] - INFO: epoch 033:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.929, ntokens=17517.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3001.3, ups=0.17, wpb=17517.1, bsz=1024, num_updates=11730, lr=3.61441e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=77326
2024-11-10 04:23:26 - progress_bar.py[line:274] - INFO: epoch 033:     39 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17423, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3014.6, ups=0.17, wpb=17423, bsz=1024, num_updates=11740, lr=3.61295e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=77384
2024-11-10 04:24:19 - progress_bar.py[line:274] - INFO: epoch 033:     49 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.968, ntokens=17559.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3264.1, ups=0.19, wpb=17559.8, bsz=1024, num_updates=11750, lr=3.6115e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=77438
2024-11-10 04:25:13 - progress_bar.py[line:274] - INFO: epoch 033:     59 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17588.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3281.9, ups=0.19, wpb=17588.6, bsz=1024, num_updates=11760, lr=3.61005e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=77491
2024-11-10 04:25:34 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 04:26:15 - progress_bar.py[line:274] - INFO: epoch 033:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17369.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=2796.9, ups=0.16, wpb=17369.5, bsz=1024, num_updates=11770, lr=3.60859e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=61, gb_free=13.5, wall=77553
2024-11-10 04:27:13 - progress_bar.py[line:274] - INFO: epoch 033:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17263.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=2968.1, ups=0.17, wpb=17263.4, bsz=1024, num_updates=11780, lr=3.60714e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=77612
2024-11-10 04:28:11 - progress_bar.py[line:274] - INFO: epoch 033:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17355.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=2992, ups=0.17, wpb=17355.8, bsz=1024, num_updates=11790, lr=3.60569e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=77670
2024-11-10 04:29:09 - progress_bar.py[line:274] - INFO: epoch 033:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17292.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=2990.6, ups=0.17, wpb=17292.6, bsz=1024, num_updates=11800, lr=3.60423e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=77727
2024-11-10 04:30:06 - progress_bar.py[line:274] - INFO: epoch 033:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17348.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3075, ups=0.18, wpb=17348.1, bsz=1015.4, num_updates=11810, lr=3.60278e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=77784
2024-11-10 04:31:00 - progress_bar.py[line:274] - INFO: epoch 033:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17557.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=3240.5, ups=0.18, wpb=17557.4, bsz=1024, num_updates=11820, lr=3.60133e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=77838
2024-11-10 04:31:58 - progress_bar.py[line:274] - INFO: epoch 033:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17460.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3002.3, ups=0.17, wpb=17460.8, bsz=1024, num_updates=11830, lr=3.59987e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=77896
2024-11-10 04:32:53 - progress_bar.py[line:274] - INFO: epoch 033:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.985, ntokens=17669.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.92, wps=3200.5, ups=0.18, wpb=17669.7, bsz=1024, num_updates=11840, lr=3.59842e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=77951
2024-11-10 04:33:50 - progress_bar.py[line:274] - INFO: epoch 033:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17236.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3040.2, ups=0.18, wpb=17236.3, bsz=1024, num_updates=11850, lr=3.59697e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=78008
2024-11-10 04:34:48 - progress_bar.py[line:274] - INFO: epoch 033:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17496.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3032.2, ups=0.17, wpb=17496.9, bsz=1024, num_updates=11860, lr=3.59551e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=78066
2024-11-10 04:35:42 - progress_bar.py[line:274] - INFO: epoch 033:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17230.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3160.5, ups=0.18, wpb=17230.7, bsz=1024, num_updates=11870, lr=3.59406e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=78120
2024-11-10 04:36:41 - progress_bar.py[line:274] - INFO: epoch 033:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.97, ntokens=17548.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.83, wps=2951.9, ups=0.17, wpb=17548.3, bsz=1024, num_updates=11880, lr=3.59261e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=78180
2024-11-10 04:37:36 - progress_bar.py[line:274] - INFO: epoch 033:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.953, ntokens=17465.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3230.6, ups=0.18, wpb=17465.6, bsz=1024, num_updates=11890, lr=3.59115e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=78234
2024-11-10 04:38:34 - progress_bar.py[line:274] - INFO: epoch 033:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.96, ntokens=17606.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.78, wps=3027.8, ups=0.17, wpb=17606.8, bsz=1024, num_updates=11900, lr=3.5897e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=78292
2024-11-10 04:39:32 - progress_bar.py[line:274] - INFO: epoch 033:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.938, ntokens=17408.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=2997.4, ups=0.17, wpb=17408.6, bsz=1024, num_updates=11910, lr=3.58825e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=78350
2024-11-10 04:40:30 - progress_bar.py[line:274] - INFO: epoch 033:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17293.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=2972.7, ups=0.17, wpb=17293.7, bsz=1024, num_updates=11920, lr=3.58679e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=78408
2024-11-10 04:41:27 - progress_bar.py[line:274] - INFO: epoch 033:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.948, ntokens=17533.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3048.8, ups=0.17, wpb=17533.3, bsz=1024, num_updates=11930, lr=3.58534e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=78466
2024-11-10 04:42:25 - progress_bar.py[line:274] - INFO: epoch 033:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.948, ntokens=17293.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3014.7, ups=0.17, wpb=17293.9, bsz=1024, num_updates=11940, lr=3.58389e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=78523
2024-11-10 04:43:19 - progress_bar.py[line:274] - INFO: epoch 033:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17140.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3175.7, ups=0.19, wpb=17140.9, bsz=1024, num_updates=11950, lr=3.58243e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=78577
2024-11-10 04:44:17 - progress_bar.py[line:274] - INFO: epoch 033:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.966, ntokens=17533.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3039.3, ups=0.17, wpb=17533.6, bsz=1024, num_updates=11960, lr=3.58098e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=78635
2024-11-10 04:45:15 - progress_bar.py[line:274] - INFO: epoch 033:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17322.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=2983.9, ups=0.17, wpb=17322.5, bsz=1024, num_updates=11970, lr=3.57953e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=78693
2024-11-10 04:46:13 - progress_bar.py[line:274] - INFO: epoch 033:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17312.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=2966.1, ups=0.17, wpb=17312.5, bsz=1024, num_updates=11980, lr=3.57807e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=78751
2024-11-10 04:47:11 - progress_bar.py[line:274] - INFO: epoch 033:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17174.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=2932.6, ups=0.17, wpb=17174.1, bsz=1024, num_updates=11990, lr=3.57662e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=78810
2024-11-10 04:48:10 - progress_bar.py[line:274] - INFO: epoch 033:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17462.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3006.7, ups=0.17, wpb=17462.5, bsz=1024, num_updates=12000, lr=3.57517e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=78868
2024-11-10 04:49:07 - progress_bar.py[line:274] - INFO: epoch 033:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.939, ntokens=17441.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.67, wps=3022.2, ups=0.17, wpb=17441.8, bsz=1024, num_updates=12010, lr=3.57371e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=78925
2024-11-10 04:50:05 - progress_bar.py[line:274] - INFO: epoch 033:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.991, ntokens=17671.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.95, wps=3076.2, ups=0.17, wpb=17671.6, bsz=1024, num_updates=12020, lr=3.57226e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=78983
2024-11-10 04:51:03 - progress_bar.py[line:274] - INFO: epoch 033:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17494.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3026.8, ups=0.17, wpb=17494.8, bsz=1024, num_updates=12030, lr=3.57081e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=79041
2024-11-10 04:52:00 - progress_bar.py[line:274] - INFO: epoch 033:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17647.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3052.6, ups=0.17, wpb=17647.7, bsz=1024, num_updates=12040, lr=3.56935e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=79099
2024-11-10 04:52:59 - progress_bar.py[line:274] - INFO: epoch 033:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.024, ntokens=17986.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.14, wps=3092.6, ups=0.17, wpb=17986.2, bsz=1024, num_updates=12050, lr=3.5679e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=79157
2024-11-10 04:53:56 - progress_bar.py[line:274] - INFO: epoch 033:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.002, ntokens=18013.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.01, wps=3141.9, ups=0.17, wpb=18013.2, bsz=1024, num_updates=12060, lr=3.56645e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=79214
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt2024-11-10 04:54:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 33 @ 12066 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
2024-11-10 04:54:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt': File exists
: File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 04:56:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
2024-11-10 04:58:09 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 33 @ 12066 updates, score 0) (writing took 220.90148823196068 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_33.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 04:59:04 - train.py[line:336] - INFO: end of epoch 33 (average epoch stats below)
2024-11-10 04:59:04 - progress_bar.py[line:282] - INFO: epoch 033 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.949 | ntokens 17451.1 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.72 | wps 2538.3 | ups 0.15 | wpb 17451.1 | bsz 1023.1 | num_updates 12066 | lr 3.56557e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2030 | gb_free 13.4 | wall 79522
2024-11-10 04:59:04 - trainer.py[line:639] - INFO: loading train data for epoch 34
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 05:01:33 - trainer.py[line:703] - INFO: begin training epoch 34
2024-11-10 05:01:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 05:01:56 - progress_bar.py[line:274] - INFO: epoch 034:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17199.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=357.9, ups=0.02, wpb=17199.8, bsz=998.4, num_updates=12070, lr=3.56499e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=44, gb_free=13.5, wall=79695
2024-11-10 05:02:53 - progress_bar.py[line:274] - INFO: epoch 034:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17354, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3082.6, ups=0.18, wpb=17354, bsz=1024, num_updates=12080, lr=3.56354e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=36, gb_free=13.4, wall=79751
2024-11-10 05:03:52 - progress_bar.py[line:274] - INFO: epoch 034:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=17398.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=2924.8, ups=0.17, wpb=17398.8, bsz=1024, num_updates=12090, lr=3.56209e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.6, wall=79810
2024-11-10 05:04:49 - progress_bar.py[line:274] - INFO: epoch 034:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17301.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3042.1, ups=0.18, wpb=17301.1, bsz=1024, num_updates=12100, lr=3.56063e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=79867
2024-11-10 05:05:45 - progress_bar.py[line:274] - INFO: epoch 034:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17425.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3093.7, ups=0.18, wpb=17425.3, bsz=1024, num_updates=12110, lr=3.55918e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=79924
2024-11-10 05:06:45 - progress_bar.py[line:274] - INFO: epoch 034:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17182.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=2885.8, ups=0.17, wpb=17182.4, bsz=1024, num_updates=12120, lr=3.55773e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=79983
2024-11-10 05:07:42 - progress_bar.py[line:274] - INFO: epoch 034:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17182.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3016.7, ups=0.18, wpb=17182.2, bsz=1024, num_updates=12130, lr=3.55627e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=80040
2024-11-10 05:08:36 - progress_bar.py[line:274] - INFO: epoch 034:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17489.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3208.3, ups=0.18, wpb=17489.6, bsz=1024, num_updates=12140, lr=3.55482e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=80095
2024-11-10 05:09:31 - progress_bar.py[line:274] - INFO: epoch 034:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17403.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3169.3, ups=0.18, wpb=17403.9, bsz=1024, num_updates=12150, lr=3.55337e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=80150
2024-11-10 05:10:25 - progress_bar.py[line:274] - INFO: epoch 034:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3220.4, ups=0.19, wpb=17332.3, bsz=1024, num_updates=12160, lr=3.55191e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=80203
2024-11-10 05:11:20 - progress_bar.py[line:274] - INFO: epoch 034:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17137.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3114.2, ups=0.18, wpb=17137.4, bsz=1024, num_updates=12170, lr=3.55046e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=80258
2024-11-10 05:12:18 - progress_bar.py[line:274] - INFO: epoch 034:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17546.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3049.2, ups=0.17, wpb=17546.6, bsz=1024, num_updates=12180, lr=3.54901e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=80316
2024-11-10 05:13:15 - progress_bar.py[line:274] - INFO: epoch 034:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17337.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3024.8, ups=0.17, wpb=17337.2, bsz=1024, num_updates=12190, lr=3.54755e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=80373
2024-11-10 05:14:13 - progress_bar.py[line:274] - INFO: epoch 034:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17534.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3025, ups=0.17, wpb=17534.8, bsz=1024, num_updates=12200, lr=3.5461e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=80431
2024-11-10 05:15:11 - progress_bar.py[line:274] - INFO: epoch 034:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17094.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=2961.4, ups=0.17, wpb=17094.6, bsz=1024, num_updates=12210, lr=3.54465e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=80489
2024-11-10 05:16:08 - progress_bar.py[line:274] - INFO: epoch 034:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.978, ntokens=17614.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.88, wps=3101.3, ups=0.18, wpb=17614.1, bsz=1024, num_updates=12220, lr=3.54319e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=80546
2024-11-10 05:17:05 - progress_bar.py[line:274] - INFO: epoch 034:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17340.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3003.2, ups=0.17, wpb=17340.5, bsz=1024, num_updates=12230, lr=3.54174e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=80603
2024-11-10 05:18:03 - progress_bar.py[line:274] - INFO: epoch 034:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17311, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=2980.3, ups=0.17, wpb=17311, bsz=1024, num_updates=12240, lr=3.54029e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=80662
2024-11-10 05:19:00 - progress_bar.py[line:274] - INFO: epoch 034:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.957, ntokens=17471.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3075.1, ups=0.18, wpb=17471.7, bsz=1024, num_updates=12250, lr=3.53883e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=80718
2024-11-10 05:19:55 - progress_bar.py[line:274] - INFO: epoch 034:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17324.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3160, ups=0.18, wpb=17324.6, bsz=1024, num_updates=12260, lr=3.53738e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=80773
2024-11-10 05:20:49 - progress_bar.py[line:274] - INFO: epoch 034:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3260.1, ups=0.19, wpb=17448.4, bsz=1024, num_updates=12270, lr=3.53593e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=80827
2024-11-10 05:21:42 - progress_bar.py[line:274] - INFO: epoch 034:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17405.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3241.2, ups=0.19, wpb=17405.6, bsz=1024, num_updates=12280, lr=3.53447e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=80880
2024-11-10 05:22:40 - progress_bar.py[line:274] - INFO: epoch 034:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17425.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=2992.9, ups=0.17, wpb=17425.2, bsz=1024, num_updates=12290, lr=3.53302e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=80939
2024-11-10 05:23:37 - progress_bar.py[line:274] - INFO: epoch 034:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.948, ntokens=17501.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3092.9, ups=0.18, wpb=17501.1, bsz=1024, num_updates=12300, lr=3.53157e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=80995
2024-11-10 05:24:35 - progress_bar.py[line:274] - INFO: epoch 034:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17424.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3031.3, ups=0.17, wpb=17424.3, bsz=1024, num_updates=12310, lr=3.53011e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=81053
2024-11-10 05:25:30 - progress_bar.py[line:274] - INFO: epoch 034:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17287.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3122.7, ups=0.18, wpb=17287.8, bsz=1024, num_updates=12320, lr=3.52866e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=81108
2024-11-10 05:25:40 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 05:26:32 - progress_bar.py[line:274] - INFO: epoch 034:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17434.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=2801.8, ups=0.16, wpb=17434.9, bsz=1024, num_updates=12330, lr=3.52721e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=62, gb_free=13.6, wall=81170
2024-11-10 05:27:27 - progress_bar.py[line:274] - INFO: epoch 034:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17409.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3171.6, ups=0.18, wpb=17409.5, bsz=1024, num_updates=12340, lr=3.52575e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=81225
2024-11-10 05:28:20 - progress_bar.py[line:274] - INFO: epoch 034:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17049.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3190.1, ups=0.19, wpb=17049.4, bsz=1024, num_updates=12350, lr=3.5243e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=51, gb_free=13.5, wall=81279
2024-11-10 05:29:18 - progress_bar.py[line:274] - INFO: epoch 034:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17408.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3036.3, ups=0.17, wpb=17408.3, bsz=1024, num_updates=12360, lr=3.52285e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=81336
2024-11-10 05:30:17 - progress_bar.py[line:274] - INFO: epoch 034:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17407.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=2961.4, ups=0.17, wpb=17407.6, bsz=1015.4, num_updates=12370, lr=3.52139e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=81395
2024-11-10 05:31:14 - progress_bar.py[line:274] - INFO: epoch 034:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17730.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3066.2, ups=0.17, wpb=17730.9, bsz=1024, num_updates=12380, lr=3.51994e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=81453
2024-11-10 05:32:13 - progress_bar.py[line:274] - INFO: epoch 034:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.996, ntokens=17754.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.98, wps=3027.2, ups=0.17, wpb=17754.3, bsz=1024, num_updates=12390, lr=3.51849e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=81511
2024-11-10 05:33:10 - progress_bar.py[line:274] - INFO: epoch 034:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.955, ntokens=17629.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.76, wps=3081.6, ups=0.17, wpb=17629.5, bsz=1024, num_updates=12400, lr=3.51703e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=81568
2024-11-10 05:34:05 - progress_bar.py[line:274] - INFO: epoch 034:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17657.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3247.8, ups=0.18, wpb=17657.3, bsz=1024, num_updates=12410, lr=3.51558e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=81623
2024-11-10 05:35:00 - progress_bar.py[line:274] - INFO: epoch 034:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17490.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3150.4, ups=0.18, wpb=17490.2, bsz=1024, num_updates=12420, lr=3.51413e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=81678
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 05:35:58 - progress_bar.py[line:274] - INFO: epoch 034:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17643.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3040.4, ups=0.17, wpb=17643.9, bsz=1024, num_updates=12430, lr=3.51267e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=81736
2024-11-10 05:36:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 34 @ 12431 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
2024-11-10 05:36:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 05:37:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
2024-11-10 05:39:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 34 @ 12431 updates, score 0) (writing took 223.29880755394697 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_34.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 05:40:40 - train.py[line:336] - INFO: end of epoch 34 (average epoch stats below)
2024-11-10 05:40:40 - progress_bar.py[line:282] - INFO: epoch 034 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.932 | ntokens 17405.1 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.63 | wps 2545.2 | ups 0.15 | wpb 17405.1 | bsz 1023.1 | num_updates 12431 | lr 3.51253e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2028 | gb_free 13.4 | wall 82018
2024-11-10 05:40:40 - trainer.py[line:639] - INFO: loading train data for epoch 35
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 05:43:11 - trainer.py[line:703] - INFO: begin training epoch 35
2024-11-10 05:43:11 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 05:44:01 - progress_bar.py[line:274] - INFO: epoch 035:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=16940.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=350.9, ups=0.02, wpb=16940.3, bsz=998.4, num_updates=12440, lr=3.51122e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=82219
2024-11-10 05:44:58 - progress_bar.py[line:274] - INFO: epoch 035:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3059.9, ups=0.18, wpb=17345, bsz=1024, num_updates=12450, lr=3.50977e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=42, gb_free=13.5, wall=82276
2024-11-10 05:45:51 - progress_bar.py[line:274] - INFO: epoch 035:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17434, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3263.9, ups=0.19, wpb=17434, bsz=1024, num_updates=12460, lr=3.50831e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=82329
2024-11-10 05:46:47 - progress_bar.py[line:274] - INFO: epoch 035:     39 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17475, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3141.1, ups=0.18, wpb=17475, bsz=1024, num_updates=12470, lr=3.50686e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=82385
2024-11-10 05:47:44 - progress_bar.py[line:274] - INFO: epoch 035:     49 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17343, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=3011, ups=0.17, wpb=17343, bsz=1024, num_updates=12480, lr=3.50541e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=82442
2024-11-10 05:48:38 - progress_bar.py[line:274] - INFO: epoch 035:     59 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17433.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3248.1, ups=0.19, wpb=17433.9, bsz=1024, num_updates=12490, lr=3.50395e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=82496
2024-11-10 05:49:34 - progress_bar.py[line:274] - INFO: epoch 035:     69 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17150.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3050.7, ups=0.18, wpb=17150.2, bsz=1015.4, num_updates=12500, lr=3.5025e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=82552
2024-11-10 05:50:31 - progress_bar.py[line:274] - INFO: epoch 035:     79 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17482.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3070.5, ups=0.18, wpb=17482.1, bsz=1024, num_updates=12510, lr=3.50105e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=82609
2024-11-10 05:51:29 - progress_bar.py[line:274] - INFO: epoch 035:     89 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17450.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3036, ups=0.17, wpb=17450.2, bsz=1024, num_updates=12520, lr=3.49959e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=82667
2024-11-10 05:52:26 - progress_bar.py[line:274] - INFO: epoch 035:     99 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17422.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3029.8, ups=0.17, wpb=17422.9, bsz=1024, num_updates=12530, lr=3.49814e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=82724
2024-11-10 05:53:23 - progress_bar.py[line:274] - INFO: epoch 035:    109 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.961, ntokens=17659.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.79, wps=3108.6, ups=0.18, wpb=17659.2, bsz=1024, num_updates=12540, lr=3.49669e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=82781
2024-11-10 05:54:20 - progress_bar.py[line:274] - INFO: epoch 035:    119 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17582.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3075.2, ups=0.17, wpb=17582.5, bsz=1024, num_updates=12550, lr=3.49523e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=82838
2024-11-10 05:55:16 - progress_bar.py[line:274] - INFO: epoch 035:    129 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17428.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3110, ups=0.18, wpb=17428.4, bsz=1024, num_updates=12560, lr=3.49378e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=82894
2024-11-10 05:56:13 - progress_bar.py[line:274] - INFO: epoch 035:    139 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.934, ntokens=17448.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3044.4, ups=0.17, wpb=17448.4, bsz=1024, num_updates=12570, lr=3.49233e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=82952
2024-11-10 05:57:10 - progress_bar.py[line:274] - INFO: epoch 035:    149 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17432, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3057, ups=0.18, wpb=17432, bsz=1024, num_updates=12580, lr=3.49087e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83009
2024-11-10 05:58:08 - progress_bar.py[line:274] - INFO: epoch 035:    159 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17538.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3040.8, ups=0.17, wpb=17538.4, bsz=1024, num_updates=12590, lr=3.48942e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=83066
2024-11-10 05:59:06 - progress_bar.py[line:274] - INFO: epoch 035:    169 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17410.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3025.2, ups=0.17, wpb=17410.1, bsz=1024, num_updates=12600, lr=3.48797e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=83124
2024-11-10 06:00:03 - progress_bar.py[line:274] - INFO: epoch 035:    179 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17495, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3078.7, ups=0.18, wpb=17495, bsz=1024, num_updates=12610, lr=3.48651e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83181
2024-11-10 06:01:00 - progress_bar.py[line:274] - INFO: epoch 035:    189 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17338, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3022.5, ups=0.17, wpb=17338, bsz=1024, num_updates=12620, lr=3.48506e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=83238
2024-11-10 06:01:57 - progress_bar.py[line:274] - INFO: epoch 035:    199 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17539.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3080.1, ups=0.18, wpb=17539.9, bsz=1024, num_updates=12630, lr=3.48361e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83295
2024-11-10 06:02:54 - progress_bar.py[line:274] - INFO: epoch 035:    209 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17594.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3063.1, ups=0.17, wpb=17594.6, bsz=1024, num_updates=12640, lr=3.48215e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83352
2024-11-10 06:03:51 - progress_bar.py[line:274] - INFO: epoch 035:    219 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17334.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3036.4, ups=0.18, wpb=17334.7, bsz=1024, num_updates=12650, lr=3.4807e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83410
2024-11-10 06:04:47 - progress_bar.py[line:274] - INFO: epoch 035:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17294.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3116.2, ups=0.18, wpb=17294.1, bsz=1024, num_updates=12660, lr=3.47925e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=83465
2024-11-10 06:05:44 - progress_bar.py[line:274] - INFO: epoch 035:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17494.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3052.5, ups=0.17, wpb=17494.7, bsz=1024, num_updates=12670, lr=3.47779e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=83522
2024-11-10 06:06:37 - progress_bar.py[line:274] - INFO: epoch 035:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.946, ntokens=17410.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3273.5, ups=0.19, wpb=17410.2, bsz=1024, num_updates=12680, lr=3.47634e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.2, wall=83576
2024-11-10 06:07:34 - progress_bar.py[line:274] - INFO: epoch 035:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=17314.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3058, ups=0.18, wpb=17314.9, bsz=1024, num_updates=12690, lr=3.47489e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83632
2024-11-10 06:08:30 - progress_bar.py[line:274] - INFO: epoch 035:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17292.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3090.1, ups=0.18, wpb=17292.5, bsz=1024, num_updates=12700, lr=3.47343e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=83688
2024-11-10 06:09:27 - progress_bar.py[line:274] - INFO: epoch 035:    279 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17380.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3020.8, ups=0.17, wpb=17380.6, bsz=1024, num_updates=12710, lr=3.47198e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=83746
2024-11-10 06:10:24 - progress_bar.py[line:274] - INFO: epoch 035:    289 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17288, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3060, ups=0.18, wpb=17288, bsz=1024, num_updates=12720, lr=3.47053e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.6, wall=83802
2024-11-10 06:11:19 - progress_bar.py[line:274] - INFO: epoch 035:    299 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17318, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3156, ups=0.18, wpb=17318, bsz=1024, num_updates=12730, lr=3.46907e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=83857
2024-11-10 06:12:14 - progress_bar.py[line:274] - INFO: epoch 035:    309 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.987, ntokens=17844.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.93, wps=3215.8, ups=0.18, wpb=17844.8, bsz=1024, num_updates=12740, lr=3.46762e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=83913
2024-11-10 06:13:10 - progress_bar.py[line:274] - INFO: epoch 035:    319 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.021, ntokens=18047.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=8.12, wps=3226.3, ups=0.18, wpb=18047.5, bsz=1024, num_updates=12750, lr=3.46617e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=83968
2024-11-10 06:14:08 - progress_bar.py[line:274] - INFO: epoch 035:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.938, ntokens=17609, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3076.6, ups=0.17, wpb=17609, bsz=1024, num_updates=12760, lr=3.46471e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=84026
2024-11-10 06:15:05 - progress_bar.py[line:274] - INFO: epoch 035:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17451.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3037.9, ups=0.17, wpb=17451.4, bsz=1024, num_updates=12770, lr=3.46326e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=84083
2024-11-10 06:16:02 - progress_bar.py[line:274] - INFO: epoch 035:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17420.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3050.4, ups=0.18, wpb=17420.8, bsz=1024, num_updates=12780, lr=3.46181e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=84140
2024-11-10 06:17:00 - progress_bar.py[line:274] - INFO: epoch 035:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17502.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3040.6, ups=0.17, wpb=17502.2, bsz=1024, num_updates=12790, lr=3.46035e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=84198
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
2024-11-10 06:17:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 35 @ 12797 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
2024-11-10 06:17:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 06:19:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 06:21:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 35 @ 12797 updates, score 0) (writing took 222.47626756998943 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_35.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 06:22:13 - train.py[line:336] - INFO: end of epoch 35 (average epoch stats below)
2024-11-10 06:22:13 - progress_bar.py[line:282] - INFO: epoch 035 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.931 | ntokens 17444.8 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.62 | wps 2560.6 | ups 0.15 | wpb 17444.8 | bsz 1023.1 | num_updates 12797 | lr 3.45934e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 2024 | gb_free 13.4 | wall 84512
2024-11-10 06:22:13 - trainer.py[line:639] - INFO: loading train data for epoch 36
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 06:24:42 - trainer.py[line:703] - INFO: begin training epoch 36
2024-11-10 06:24:42 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 06:25:00 - progress_bar.py[line:274] - INFO: epoch 036:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=16950.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=352.9, ups=0.02, wpb=16950.8, bsz=998.4, num_updates=12800, lr=3.4589e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=46, gb_free=13.5, wall=84678
2024-11-10 06:25:52 - progress_bar.py[line:274] - INFO: epoch 036:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17181.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3317.5, ups=0.19, wpb=17181.6, bsz=1015.4, num_updates=12810, lr=3.45745e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=84730
2024-11-10 06:26:48 - progress_bar.py[line:274] - INFO: epoch 036:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.957, ntokens=17488.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3114.5, ups=0.18, wpb=17488.1, bsz=1024, num_updates=12820, lr=3.45599e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=48, gb_free=13.5, wall=84786
2024-11-10 06:27:43 - progress_bar.py[line:274] - INFO: epoch 036:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17252.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3143.3, ups=0.18, wpb=17252.6, bsz=1024, num_updates=12830, lr=3.45454e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=84841
2024-11-10 06:28:40 - progress_bar.py[line:274] - INFO: epoch 036:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17441.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3060.4, ups=0.18, wpb=17441.9, bsz=1024, num_updates=12840, lr=3.45309e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=84898
2024-11-10 06:29:34 - progress_bar.py[line:274] - INFO: epoch 036:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17389.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3217.3, ups=0.19, wpb=17389.4, bsz=1024, num_updates=12850, lr=3.45163e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=84952
2024-11-10 06:30:16 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 06:30:32 - progress_bar.py[line:274] - INFO: epoch 036:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17113.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=2917.3, ups=0.17, wpb=17113.4, bsz=1024, num_updates=12860, lr=3.45018e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=85011
2024-11-10 06:31:27 - progress_bar.py[line:274] - INFO: epoch 036:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17408.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3214.7, ups=0.18, wpb=17408.3, bsz=1024, num_updates=12870, lr=3.44873e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=85065
2024-11-10 06:32:20 - progress_bar.py[line:274] - INFO: epoch 036:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.913, ntokens=17258.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3219.7, ups=0.19, wpb=17258.4, bsz=1024, num_updates=12880, lr=3.44727e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=85118
2024-11-10 06:33:13 - progress_bar.py[line:274] - INFO: epoch 036:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17226.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3282.5, ups=0.19, wpb=17226.7, bsz=1024, num_updates=12890, lr=3.44582e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=85171
2024-11-10 06:34:05 - progress_bar.py[line:274] - INFO: epoch 036:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17423.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3348.9, ups=0.19, wpb=17423.4, bsz=1024, num_updates=12900, lr=3.44437e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=85223
2024-11-10 06:34:56 - progress_bar.py[line:274] - INFO: epoch 036:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17413.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3366.8, ups=0.19, wpb=17413.8, bsz=1024, num_updates=12910, lr=3.44291e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=47, gb_free=13.5, wall=85275
2024-11-10 06:35:49 - progress_bar.py[line:274] - INFO: epoch 036:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17481.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3331.3, ups=0.19, wpb=17481.8, bsz=1024, num_updates=12920, lr=3.44146e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=41, gb_free=13.5, wall=85327
2024-11-10 06:36:41 - progress_bar.py[line:274] - INFO: epoch 036:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17582.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3375.2, ups=0.19, wpb=17582.4, bsz=1024, num_updates=12930, lr=3.44001e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=34, gb_free=13.3, wall=85379
2024-11-10 06:37:33 - progress_bar.py[line:274] - INFO: epoch 036:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17242.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3302.1, ups=0.19, wpb=17242.4, bsz=1024, num_updates=12940, lr=3.43855e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=85431
2024-11-10 06:38:26 - progress_bar.py[line:274] - INFO: epoch 036:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17432.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3305.3, ups=0.19, wpb=17432.9, bsz=1024, num_updates=12950, lr=3.4371e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85484
2024-11-10 06:39:20 - progress_bar.py[line:274] - INFO: epoch 036:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17489.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3267.7, ups=0.19, wpb=17489.3, bsz=1024, num_updates=12960, lr=3.43565e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85538
2024-11-10 06:40:13 - progress_bar.py[line:274] - INFO: epoch 036:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=17285.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3240.8, ups=0.19, wpb=17285.8, bsz=1024, num_updates=12970, lr=3.43419e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85591
2024-11-10 06:41:06 - progress_bar.py[line:274] - INFO: epoch 036:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17347.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.64, wps=3249.6, ups=0.19, wpb=17347.7, bsz=1024, num_updates=12980, lr=3.43274e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=85644
2024-11-10 06:42:00 - progress_bar.py[line:274] - INFO: epoch 036:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17284.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3240.8, ups=0.19, wpb=17284.2, bsz=1024, num_updates=12990, lr=3.43129e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85698
2024-11-10 06:42:52 - progress_bar.py[line:274] - INFO: epoch 036:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17283.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3300.7, ups=0.19, wpb=17283.1, bsz=1024, num_updates=13000, lr=3.42983e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=85750
2024-11-10 06:43:45 - progress_bar.py[line:274] - INFO: epoch 036:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17156.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3252.3, ups=0.19, wpb=17156.7, bsz=1024, num_updates=13010, lr=3.42838e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=85803
2024-11-10 06:44:38 - progress_bar.py[line:274] - INFO: epoch 036:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17511.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3311.9, ups=0.19, wpb=17511.5, bsz=1024, num_updates=13020, lr=3.42693e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=85856
2024-11-10 06:45:30 - progress_bar.py[line:274] - INFO: epoch 036:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.965, ntokens=17790.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.81, wps=3401.3, ups=0.19, wpb=17790.9, bsz=1024, num_updates=13030, lr=3.42547e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85908
2024-11-10 06:46:23 - progress_bar.py[line:274] - INFO: epoch 036:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.972, ntokens=17585.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.85, wps=3320.5, ups=0.19, wpb=17585.7, bsz=1024, num_updates=13040, lr=3.42402e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=85961
2024-11-10 06:47:15 - progress_bar.py[line:274] - INFO: epoch 036:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.907, ntokens=17289.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3297.4, ups=0.19, wpb=17289.5, bsz=1024, num_updates=13050, lr=3.42257e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=86013
2024-11-10 06:48:08 - progress_bar.py[line:274] - INFO: epoch 036:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17081.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3212.6, ups=0.19, wpb=17081.5, bsz=1024, num_updates=13060, lr=3.42111e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=86067
2024-11-10 06:49:02 - progress_bar.py[line:274] - INFO: epoch 036:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17311.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3222.1, ups=0.19, wpb=17311.3, bsz=1024, num_updates=13070, lr=3.41966e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=86120
2024-11-10 06:49:59 - progress_bar.py[line:274] - INFO: epoch 036:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17434.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3078.3, ups=0.18, wpb=17434.4, bsz=1024, num_updates=13080, lr=3.41821e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=46, gb_free=13.3, wall=86177
2024-11-10 06:50:52 - progress_bar.py[line:274] - INFO: epoch 036:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17570.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3322.3, ups=0.19, wpb=17570.8, bsz=1024, num_updates=13090, lr=3.41675e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86230
2024-11-10 06:51:44 - progress_bar.py[line:274] - INFO: epoch 036:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17572.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3333.4, ups=0.19, wpb=17572.6, bsz=1024, num_updates=13100, lr=3.4153e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86283
2024-11-10 06:52:37 - progress_bar.py[line:274] - INFO: epoch 036:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17748.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3371.6, ups=0.19, wpb=17748.2, bsz=1024, num_updates=13110, lr=3.41385e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86335
2024-11-10 06:53:30 - progress_bar.py[line:274] - INFO: epoch 036:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17533.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3322.7, ups=0.19, wpb=17533.3, bsz=1024, num_updates=13120, lr=3.41239e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=86388
2024-11-10 06:54:23 - progress_bar.py[line:274] - INFO: epoch 036:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17435.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3308, ups=0.19, wpb=17435.3, bsz=1024, num_updates=13130, lr=3.41094e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.2, wall=86441
2024-11-10 06:55:16 - progress_bar.py[line:274] - INFO: epoch 036:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.954, ntokens=17596.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.75, wps=3317.9, ups=0.19, wpb=17596.1, bsz=1024, num_updates=13140, lr=3.40949e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=86494
2024-11-10 06:56:08 - progress_bar.py[line:274] - INFO: epoch 036:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.958, ntokens=17740.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.77, wps=3371.8, ups=0.19, wpb=17740.6, bsz=1024, num_updates=13150, lr=3.40803e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=86546
2024-11-10 06:57:01 - progress_bar.py[line:274] - INFO: epoch 036:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=17443.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3292.4, ups=0.19, wpb=17443.4, bsz=1024, num_updates=13160, lr=3.40658e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=86599
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 06:57:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 36 @ 13162 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
2024-11-10 06:57:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 06:59:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
2024-11-10 07:00:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 36 @ 13162 updates, score 0) (writing took 222.7492644850281 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_36.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 07:01:47 - train.py[line:336] - INFO: end of epoch 36 (average epoch stats below)
2024-11-10 07:01:47 - progress_bar.py[line:282] - INFO: epoch 036 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.918 | ntokens 17395.2 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.56 | wps 2675 | ups 0.15 | wpb 17395.2 | bsz 1023.1 | num_updates 13162 | lr 3.40629e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1545 | gb_free 13.4 | wall 86885
2024-11-10 07:01:47 - trainer.py[line:639] - INFO: loading train data for epoch 37
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 07:04:16 - trainer.py[line:703] - INFO: begin training epoch 37
2024-11-10 07:04:16 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 07:05:00 - progress_bar.py[line:274] - INFO: epoch 037:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=16823.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=351.2, ups=0.02, wpb=16823.3, bsz=998.4, num_updates=13170, lr=3.40513e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=32, gb_free=13.3, wall=87078
2024-11-10 07:05:53 - progress_bar.py[line:274] - INFO: epoch 037:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17417.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3327.4, ups=0.19, wpb=17417.1, bsz=1024, num_updates=13180, lr=3.40367e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87131
2024-11-10 07:06:46 - progress_bar.py[line:274] - INFO: epoch 037:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17716.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3342.9, ups=0.19, wpb=17716.9, bsz=1024, num_updates=13190, lr=3.40222e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=87184
2024-11-10 07:07:38 - progress_bar.py[line:274] - INFO: epoch 037:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17614.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3324, ups=0.19, wpb=17614.4, bsz=1024, num_updates=13200, lr=3.40077e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87237
2024-11-10 07:08:31 - progress_bar.py[line:274] - INFO: epoch 037:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17430.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3303.2, ups=0.19, wpb=17430.3, bsz=1024, num_updates=13210, lr=3.39931e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87289
2024-11-10 07:09:24 - progress_bar.py[line:274] - INFO: epoch 037:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17391.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3299.2, ups=0.19, wpb=17391.1, bsz=1024, num_updates=13220, lr=3.39786e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87342
2024-11-10 07:10:16 - progress_bar.py[line:274] - INFO: epoch 037:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.947, ntokens=17590.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.71, wps=3368.5, ups=0.19, wpb=17590.3, bsz=1024, num_updates=13230, lr=3.39641e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87394
2024-11-10 07:11:09 - progress_bar.py[line:274] - INFO: epoch 037:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17475.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3294.9, ups=0.19, wpb=17475.4, bsz=1024, num_updates=13240, lr=3.39495e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=87447
2024-11-10 07:12:02 - progress_bar.py[line:274] - INFO: epoch 037:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17481.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3335, ups=0.19, wpb=17481.1, bsz=1024, num_updates=13250, lr=3.3935e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=87500
2024-11-10 07:12:55 - progress_bar.py[line:274] - INFO: epoch 037:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.942, ntokens=17488.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3285.8, ups=0.19, wpb=17488.4, bsz=1024, num_updates=13260, lr=3.39205e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87553
2024-11-10 07:13:48 - progress_bar.py[line:274] - INFO: epoch 037:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17337.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3239.4, ups=0.19, wpb=17337.1, bsz=1024, num_updates=13270, lr=3.39059e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87607
2024-11-10 07:14:41 - progress_bar.py[line:274] - INFO: epoch 037:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.921, ntokens=17508.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3309.3, ups=0.19, wpb=17508.3, bsz=1024, num_updates=13280, lr=3.38914e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87660
2024-11-10 07:15:34 - progress_bar.py[line:274] - INFO: epoch 037:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17192.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3266.7, ups=0.19, wpb=17192.4, bsz=1024, num_updates=13290, lr=3.38769e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87712
2024-11-10 07:16:27 - progress_bar.py[line:274] - INFO: epoch 037:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17269.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3258.8, ups=0.19, wpb=17269.6, bsz=1024, num_updates=13300, lr=3.38623e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=87765
2024-11-10 07:17:20 - progress_bar.py[line:274] - INFO: epoch 037:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17278.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3245.9, ups=0.19, wpb=17278.7, bsz=1024, num_updates=13310, lr=3.38478e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=87818
2024-11-10 07:18:13 - progress_bar.py[line:274] - INFO: epoch 037:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17368.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3277.8, ups=0.19, wpb=17368.5, bsz=1024, num_updates=13320, lr=3.38333e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=87871
2024-11-10 07:19:06 - progress_bar.py[line:274] - INFO: epoch 037:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.9, ntokens=17425.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3322.4, ups=0.19, wpb=17425.4, bsz=1024, num_updates=13330, lr=3.38187e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=87924
2024-11-10 07:19:58 - progress_bar.py[line:274] - INFO: epoch 037:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17498.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3318.6, ups=0.19, wpb=17498.3, bsz=1024, num_updates=13340, lr=3.38042e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=87977
2024-11-10 07:20:52 - progress_bar.py[line:274] - INFO: epoch 037:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17092.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3208.9, ups=0.19, wpb=17092.7, bsz=1024, num_updates=13350, lr=3.37897e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88030
2024-11-10 07:21:45 - progress_bar.py[line:274] - INFO: epoch 037:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.971, ntokens=17772.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.84, wps=3358.8, ups=0.19, wpb=17772.2, bsz=1024, num_updates=13360, lr=3.37751e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88083
2024-11-10 07:22:37 - progress_bar.py[line:274] - INFO: epoch 037:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17334.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3312, ups=0.19, wpb=17334.6, bsz=1024, num_updates=13370, lr=3.37606e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=88135
2024-11-10 07:23:30 - progress_bar.py[line:274] - INFO: epoch 037:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=17143.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3247.9, ups=0.19, wpb=17143.4, bsz=1024, num_updates=13380, lr=3.37461e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=88188
2024-11-10 07:24:07 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 07:24:28 - progress_bar.py[line:274] - INFO: epoch 037:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17396.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=2979.7, ups=0.17, wpb=17396.1, bsz=1024, num_updates=13390, lr=3.37315e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=88246
2024-11-10 07:25:21 - progress_bar.py[line:274] - INFO: epoch 037:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=17259, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3274.2, ups=0.19, wpb=17259, bsz=1024, num_updates=13400, lr=3.3717e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=88299
2024-11-10 07:26:13 - progress_bar.py[line:274] - INFO: epoch 037:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17368.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3330, ups=0.19, wpb=17368.9, bsz=1024, num_updates=13410, lr=3.37025e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88351
2024-11-10 07:27:06 - progress_bar.py[line:274] - INFO: epoch 037:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.903, ntokens=17310.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3277.7, ups=0.19, wpb=17310.2, bsz=1024, num_updates=13420, lr=3.36879e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=88404
2024-11-10 07:27:59 - progress_bar.py[line:274] - INFO: epoch 037:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17439.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3298.5, ups=0.19, wpb=17439.5, bsz=1024, num_updates=13430, lr=3.36734e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=88457
2024-11-10 07:28:51 - progress_bar.py[line:274] - INFO: epoch 037:    279 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17097.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3259.7, ups=0.19, wpb=17097.4, bsz=1024, num_updates=13440, lr=3.36589e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=88509
2024-11-10 07:29:46 - progress_bar.py[line:274] - INFO: epoch 037:    289 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17511.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3177, ups=0.18, wpb=17511.6, bsz=1024, num_updates=13450, lr=3.36443e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88564
2024-11-10 07:30:40 - progress_bar.py[line:274] - INFO: epoch 037:    299 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17253.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3233.5, ups=0.19, wpb=17253.7, bsz=1024, num_updates=13460, lr=3.36298e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=88618
2024-11-10 07:31:31 - progress_bar.py[line:274] - INFO: epoch 037:    309 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17409.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3393, ups=0.19, wpb=17409.9, bsz=1024, num_updates=13470, lr=3.36153e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=88669
2024-11-10 07:32:23 - progress_bar.py[line:274] - INFO: epoch 037:    319 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.943, ntokens=17620.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.69, wps=3359.9, ups=0.19, wpb=17620.6, bsz=1024, num_updates=13480, lr=3.36007e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=88721
2024-11-10 07:33:15 - progress_bar.py[line:274] - INFO: epoch 037:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17624.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3396.5, ups=0.19, wpb=17624.4, bsz=1024, num_updates=13490, lr=3.35862e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88773
2024-11-10 07:34:07 - progress_bar.py[line:274] - INFO: epoch 037:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17270.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3362.5, ups=0.19, wpb=17270.1, bsz=1015.4, num_updates=13500, lr=3.35717e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88825
2024-11-10 07:34:58 - progress_bar.py[line:274] - INFO: epoch 037:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17647.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3412.8, ups=0.19, wpb=17647.6, bsz=1024, num_updates=13510, lr=3.35571e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=88876
2024-11-10 07:35:50 - progress_bar.py[line:274] - INFO: epoch 037:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17396.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3361.3, ups=0.19, wpb=17396.6, bsz=1024, num_updates=13520, lr=3.35426e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=88928
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 07:36:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 37 @ 13527 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
2024-11-10 07:36:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 07:38:15 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-10 07:40:09 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 37 @ 13527 updates, score 0) (writing took 224.66983879602049 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_37.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 07:41:04 - train.py[line:336] - INFO: end of epoch 37 (average epoch stats below)
2024-11-10 07:41:04 - progress_bar.py[line:282] - INFO: epoch 037 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.908 | ntokens 17397.2 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.5 | wps 2693.8 | ups 0.15 | wpb 17397.2 | bsz 1023.1 | num_updates 13527 | lr 3.35324e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1106 | gb_free 13.5 | wall 89242
2024-11-10 07:41:04 - trainer.py[line:639] - INFO: loading train data for epoch 38
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 07:43:33 - trainer.py[line:703] - INFO: begin training epoch 38
2024-11-10 07:43:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 07:43:51 - progress_bar.py[line:274] - INFO: epoch 038:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=16892.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=351.2, ups=0.02, wpb=16892.7, bsz=998.4, num_updates=13530, lr=3.35281e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=29, gb_free=13.4, wall=89409
2024-11-10 07:44:45 - progress_bar.py[line:274] - INFO: epoch 038:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17243.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3204.7, ups=0.19, wpb=17243.8, bsz=1024, num_updates=13540, lr=3.35135e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=89463
2024-11-10 07:45:39 - progress_bar.py[line:274] - INFO: epoch 038:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17317.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3198.6, ups=0.18, wpb=17317.1, bsz=1024, num_updates=13550, lr=3.3499e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=89517
2024-11-10 07:46:33 - progress_bar.py[line:274] - INFO: epoch 038:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17534, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=3273.6, ups=0.19, wpb=17534, bsz=1024, num_updates=13560, lr=3.34845e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=89571
2024-11-10 07:47:26 - progress_bar.py[line:274] - INFO: epoch 038:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17530.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3284.3, ups=0.19, wpb=17530.1, bsz=1024, num_updates=13570, lr=3.34699e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=89624
2024-11-10 07:48:20 - progress_bar.py[line:274] - INFO: epoch 038:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17363.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3233.4, ups=0.19, wpb=17363.7, bsz=1024, num_updates=13580, lr=3.34554e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=89678
2024-11-10 07:49:13 - progress_bar.py[line:274] - INFO: epoch 038:     63 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.933, ntokens=17505, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3291.1, ups=0.19, wpb=17505, bsz=1024, num_updates=13590, lr=3.34409e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=89731
2024-11-10 07:50:06 - progress_bar.py[line:274] - INFO: epoch 038:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17287.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3234.4, ups=0.19, wpb=17287.5, bsz=1024, num_updates=13600, lr=3.34263e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=89784
2024-11-10 07:51:00 - progress_bar.py[line:274] - INFO: epoch 038:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17572, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3298.9, ups=0.19, wpb=17572, bsz=1024, num_updates=13610, lr=3.34118e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=89838
2024-11-10 07:51:53 - progress_bar.py[line:274] - INFO: epoch 038:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17527.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3300.1, ups=0.19, wpb=17527.6, bsz=1024, num_updates=13620, lr=3.33973e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=89891
2024-11-10 07:52:48 - progress_bar.py[line:274] - INFO: epoch 038:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17198.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3133.4, ups=0.18, wpb=17198.6, bsz=1024, num_updates=13630, lr=3.33827e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=35, gb_free=13.5, wall=89946
2024-11-10 07:53:41 - progress_bar.py[line:274] - INFO: epoch 038:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.94, ntokens=17721.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3330.5, ups=0.19, wpb=17721.8, bsz=1024, num_updates=13640, lr=3.33682e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=50, gb_free=13.2, wall=89999
2024-11-10 07:54:34 - progress_bar.py[line:274] - INFO: epoch 038:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17609.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3334.8, ups=0.19, wpb=17609.1, bsz=1024, num_updates=13650, lr=3.33537e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=90052
2024-11-10 07:55:27 - progress_bar.py[line:274] - INFO: epoch 038:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.92, ntokens=17726.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.57, wps=3296.5, ups=0.19, wpb=17726.5, bsz=1024, num_updates=13660, lr=3.33391e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=90106
2024-11-10 07:56:21 - progress_bar.py[line:274] - INFO: epoch 038:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17309.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3209.4, ups=0.19, wpb=17309.2, bsz=1024, num_updates=13670, lr=3.33246e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=90159
2024-11-10 07:57:15 - progress_bar.py[line:274] - INFO: epoch 038:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.967, ntokens=17837, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.82, wps=3348.6, ups=0.19, wpb=17837, bsz=1024, num_updates=13680, lr=3.33101e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=90213
2024-11-10 07:58:08 - progress_bar.py[line:274] - INFO: epoch 038:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17410.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3255.2, ups=0.19, wpb=17410.1, bsz=1024, num_updates=13690, lr=3.32955e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=90266
2024-11-10 07:59:02 - progress_bar.py[line:274] - INFO: epoch 038:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17288.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3231, ups=0.19, wpb=17288.1, bsz=1024, num_updates=13700, lr=3.3281e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=90320
2024-11-10 07:59:55 - progress_bar.py[line:274] - INFO: epoch 038:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17504.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3265.8, ups=0.19, wpb=17504.7, bsz=1024, num_updates=13710, lr=3.32665e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=90373
2024-11-10 08:00:48 - progress_bar.py[line:274] - INFO: epoch 038:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17010.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3192.7, ups=0.19, wpb=17010.4, bsz=1024, num_updates=13720, lr=3.32519e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=90427
2024-11-10 08:01:42 - progress_bar.py[line:274] - INFO: epoch 038:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17494.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3262.4, ups=0.19, wpb=17494.6, bsz=1024, num_updates=13730, lr=3.32374e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=90480
2024-11-10 08:02:35 - progress_bar.py[line:274] - INFO: epoch 038:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17278.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3230.7, ups=0.19, wpb=17278.6, bsz=1024, num_updates=13740, lr=3.32229e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=90534
2024-11-10 08:03:29 - progress_bar.py[line:274] - INFO: epoch 038:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17429.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3257.4, ups=0.19, wpb=17429.6, bsz=1024, num_updates=13750, lr=3.32083e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=90587
2024-11-10 08:04:23 - progress_bar.py[line:274] - INFO: epoch 038:    233 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17398.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3217.8, ups=0.18, wpb=17398.4, bsz=1024, num_updates=13760, lr=3.31938e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=90641
2024-11-10 08:05:20 - progress_bar.py[line:274] - INFO: epoch 038:    243 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17264.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3045.3, ups=0.18, wpb=17264.8, bsz=1024, num_updates=13770, lr=3.31793e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=90698
2024-11-10 08:06:16 - progress_bar.py[line:274] - INFO: epoch 038:    253 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17228.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3040.6, ups=0.18, wpb=17228.3, bsz=1024, num_updates=13780, lr=3.31647e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=90755
2024-11-10 08:07:12 - progress_bar.py[line:274] - INFO: epoch 038:    263 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17280, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3119.1, ups=0.18, wpb=17280, bsz=1024, num_updates=13790, lr=3.31502e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=90810
2024-11-10 08:08:08 - progress_bar.py[line:274] - INFO: epoch 038:    273 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17380.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3092.1, ups=0.18, wpb=17380.7, bsz=1024, num_updates=13800, lr=3.31357e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=90866
2024-11-10 08:09:05 - progress_bar.py[line:274] - INFO: epoch 038:    283 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17211.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3042.7, ups=0.18, wpb=17211.8, bsz=1024, num_updates=13810, lr=3.31211e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=90923
2024-11-10 08:10:02 - progress_bar.py[line:274] - INFO: epoch 038:    293 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17322, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3043, ups=0.18, wpb=17322, bsz=1024, num_updates=13820, lr=3.31066e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=90980
2024-11-10 08:10:58 - progress_bar.py[line:274] - INFO: epoch 038:    303 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17351.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3060.1, ups=0.18, wpb=17351.2, bsz=1024, num_updates=13830, lr=3.30921e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=91036
2024-11-10 08:11:54 - progress_bar.py[line:274] - INFO: epoch 038:    313 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=17557.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3132.9, ups=0.18, wpb=17557.1, bsz=1024, num_updates=13840, lr=3.30775e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=91092
2024-11-10 08:12:51 - progress_bar.py[line:274] - INFO: epoch 038:    323 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.924, ntokens=17599, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3123.4, ups=0.18, wpb=17599, bsz=1024, num_updates=13850, lr=3.3063e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=91149
2024-11-10 08:13:46 - progress_bar.py[line:274] - INFO: epoch 038:    333 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.932, ntokens=17729, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.63, wps=3173.3, ups=0.18, wpb=17729, bsz=1024, num_updates=13860, lr=3.30485e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=91205
2024-11-10 08:14:43 - progress_bar.py[line:274] - INFO: epoch 038:    343 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.944, ntokens=17624.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3140.4, ups=0.18, wpb=17624.6, bsz=1024, num_updates=13870, lr=3.30339e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=91261
2024-11-10 08:15:39 - progress_bar.py[line:274] - INFO: epoch 038:    353 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.937, ntokens=17523.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.66, wps=3130, ups=0.18, wpb=17523.8, bsz=1015.4, num_updates=13880, lr=3.30194e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=91317
2024-11-10 08:16:33 - progress_bar.py[line:274] - INFO: epoch 038:    363 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.927, ntokens=17633.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3254.2, ups=0.18, wpb=17633.2, bsz=1024, num_updates=13890, lr=3.30049e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=91371
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 08:16:47 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 38 @ 13893 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
2024-11-10 08:16:47 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 08:18:37 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
2024-11-10 08:20:31 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 38 @ 13893 updates, score 0) (writing took 223.71526584995445 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_38.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 08:21:26 - train.py[line:336] - INFO: end of epoch 38 (average epoch stats below)
2024-11-10 08:21:26 - progress_bar.py[line:282] - INFO: epoch 038 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.905 | ntokens 17426.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.49 | wps 2633.8 | ups 0.15 | wpb 17426.2 | bsz 1023.1 | num_updates 13893 | lr 3.30005e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1478 | gb_free 13.5 | wall 91664
2024-11-10 08:21:26 - trainer.py[line:639] - INFO: loading train data for epoch 39
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 08:23:54 - trainer.py[line:703] - INFO: begin training epoch 39
2024-11-10 08:23:54 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 08:24:33 - progress_bar.py[line:274] - INFO: epoch 039:      7 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=16994.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=354, ups=0.02, wpb=16994.2, bsz=998.4, num_updates=13900, lr=3.29903e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=35, gb_free=13.3, wall=91851
2024-11-10 08:25:29 - progress_bar.py[line:274] - INFO: epoch 039:     17 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17582.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3142.8, ups=0.18, wpb=17582.8, bsz=1024, num_updates=13910, lr=3.29758e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=44, gb_free=13.5, wall=91907
2024-11-10 08:26:21 - progress_bar.py[line:274] - INFO: epoch 039:     27 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.93, ntokens=17625.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3403.1, ups=0.19, wpb=17625.3, bsz=1024, num_updates=13920, lr=3.29613e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=91959
2024-11-10 08:27:13 - progress_bar.py[line:274] - INFO: epoch 039:     37 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.926, ntokens=17652, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.6, wps=3340.5, ups=0.19, wpb=17652, bsz=1024, num_updates=13930, lr=3.29468e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=92012
2024-11-10 08:28:08 - progress_bar.py[line:274] - INFO: epoch 039:     47 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.916, ntokens=17607.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3211.6, ups=0.18, wpb=17607.4, bsz=1024, num_updates=13940, lr=3.29322e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=92066
2024-11-10 08:29:04 - progress_bar.py[line:274] - INFO: epoch 039:     57 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17458.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3138.2, ups=0.18, wpb=17458.4, bsz=1024, num_updates=13950, lr=3.29177e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=92122
2024-11-10 08:30:00 - progress_bar.py[line:274] - INFO: epoch 039:     67 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17180.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3049.6, ups=0.18, wpb=17180.6, bsz=1024, num_updates=13960, lr=3.29032e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=92178
2024-11-10 08:30:57 - progress_bar.py[line:274] - INFO: epoch 039:     77 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.952, ntokens=17685.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.74, wps=3142.9, ups=0.18, wpb=17685.1, bsz=1024, num_updates=13970, lr=3.28886e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=92235
2024-11-10 08:31:53 - progress_bar.py[line:274] - INFO: epoch 039:     87 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17202.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3052.2, ups=0.18, wpb=17202.3, bsz=1024, num_updates=13980, lr=3.28741e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=92291
2024-11-10 08:32:50 - progress_bar.py[line:274] - INFO: epoch 039:     97 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.909, ntokens=17507.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3072.6, ups=0.18, wpb=17507.4, bsz=1024, num_updates=13990, lr=3.28596e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=92348
2024-11-10 08:33:43 - progress_bar.py[line:274] - INFO: epoch 039:    107 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17488.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3314.8, ups=0.19, wpb=17488.9, bsz=1024, num_updates=14000, lr=3.2845e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=92401
2024-11-10 08:34:37 - progress_bar.py[line:274] - INFO: epoch 039:    117 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17381.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3191.1, ups=0.18, wpb=17381.3, bsz=1024, num_updates=14010, lr=3.28305e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=92455
2024-11-10 08:35:34 - progress_bar.py[line:274] - INFO: epoch 039:    127 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17412, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3082.5, ups=0.18, wpb=17412, bsz=1024, num_updates=14020, lr=3.2816e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=92512
2024-11-10 08:36:31 - progress_bar.py[line:274] - INFO: epoch 039:    137 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17386.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3040.6, ups=0.17, wpb=17386.3, bsz=1024, num_updates=14030, lr=3.28014e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=92569
2024-11-10 08:36:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 08:37:32 - progress_bar.py[line:274] - INFO: epoch 039:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.923, ntokens=17472.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=2838.8, ups=0.16, wpb=17472.6, bsz=1024, num_updates=14040, lr=3.27869e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=61, gb_free=13.4, wall=92631
2024-11-10 08:38:29 - progress_bar.py[line:274] - INFO: epoch 039:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17703.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3096.4, ups=0.17, wpb=17703.2, bsz=1024, num_updates=14050, lr=3.27724e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=92688
2024-11-10 08:39:27 - progress_bar.py[line:274] - INFO: epoch 039:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17558.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3039.2, ups=0.17, wpb=17558.6, bsz=1024, num_updates=14060, lr=3.27578e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=92745
2024-11-10 08:40:25 - progress_bar.py[line:274] - INFO: epoch 039:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17520.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3012.5, ups=0.17, wpb=17520.4, bsz=1024, num_updates=14070, lr=3.27433e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=92804
2024-11-10 08:41:22 - progress_bar.py[line:274] - INFO: epoch 039:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17137.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3041.8, ups=0.18, wpb=17137.9, bsz=1024, num_updates=14080, lr=3.27288e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=92860
2024-11-10 08:42:19 - progress_bar.py[line:274] - INFO: epoch 039:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17418.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3054.4, ups=0.18, wpb=17418.4, bsz=1024, num_updates=14090, lr=3.27142e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=92917
2024-11-10 08:43:19 - progress_bar.py[line:274] - INFO: epoch 039:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17522.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=2924.8, ups=0.17, wpb=17522.7, bsz=1024, num_updates=14100, lr=3.26997e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.2, wall=92977
2024-11-10 08:44:21 - progress_bar.py[line:274] - INFO: epoch 039:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17235.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=2762.1, ups=0.16, wpb=17235.6, bsz=1024, num_updates=14110, lr=3.26852e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=62, gb_free=13.5, wall=93039
2024-11-10 08:45:22 - progress_bar.py[line:274] - INFO: epoch 039:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17582.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=2875.8, ups=0.16, wpb=17582.1, bsz=1024, num_updates=14120, lr=3.26706e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=61, gb_free=13.5, wall=93100
2024-11-10 08:46:23 - progress_bar.py[line:274] - INFO: epoch 039:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.918, ntokens=17429.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=2857.8, ups=0.16, wpb=17429.8, bsz=1024, num_updates=14130, lr=3.26561e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=61, gb_free=13.5, wall=93161
2024-11-10 08:47:24 - progress_bar.py[line:274] - INFO: epoch 039:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17305.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=2826.8, ups=0.16, wpb=17305.4, bsz=1024, num_updates=14140, lr=3.26416e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=61, gb_free=13.5, wall=93223
2024-11-10 08:48:25 - progress_bar.py[line:274] - INFO: epoch 039:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17381.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=2891, ups=0.17, wpb=17381.3, bsz=1024, num_updates=14150, lr=3.2627e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.6, wall=93283
2024-11-10 08:49:27 - progress_bar.py[line:274] - INFO: epoch 039:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17324.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=2778.2, ups=0.16, wpb=17324.7, bsz=1024, num_updates=14160, lr=3.26125e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=62, gb_free=13.6, wall=93345
2024-11-10 08:50:29 - progress_bar.py[line:274] - INFO: epoch 039:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.929, ntokens=17595.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=2854.4, ups=0.16, wpb=17595.9, bsz=1024, num_updates=14170, lr=3.2598e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=62, gb_free=13.3, wall=93407
2024-11-10 08:51:31 - progress_bar.py[line:274] - INFO: epoch 039:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17278.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=2775.4, ups=0.16, wpb=17278.7, bsz=1024, num_updates=14180, lr=3.25834e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=62, gb_free=13.2, wall=93469
2024-11-10 08:52:33 - progress_bar.py[line:274] - INFO: epoch 039:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17216.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=2790, ups=0.16, wpb=17216.8, bsz=1024, num_updates=14190, lr=3.25689e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=62, gb_free=13.5, wall=93531
2024-11-10 08:53:34 - progress_bar.py[line:274] - INFO: epoch 039:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17350.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=2814.1, ups=0.16, wpb=17350.9, bsz=1024, num_updates=14200, lr=3.25544e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=62, gb_free=13.4, wall=93592
2024-11-10 08:54:35 - progress_bar.py[line:274] - INFO: epoch 039:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17494.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=2900.7, ups=0.17, wpb=17494.9, bsz=1024, num_updates=14210, lr=3.25398e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.3, wall=93653
2024-11-10 08:55:35 - progress_bar.py[line:274] - INFO: epoch 039:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17572.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=2902.6, ups=0.17, wpb=17572.5, bsz=1024, num_updates=14220, lr=3.25253e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=60, gb_free=13.3, wall=93713
2024-11-10 08:56:35 - progress_bar.py[line:274] - INFO: epoch 039:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17812.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=2958.6, ups=0.17, wpb=17812.9, bsz=1024, num_updates=14230, lr=3.25108e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=60, gb_free=13.5, wall=93774
2024-11-10 08:57:35 - progress_bar.py[line:274] - INFO: epoch 039:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.936, ntokens=17514.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.65, wps=2920.1, ups=0.17, wpb=17514.4, bsz=1015.4, num_updates=14240, lr=3.24962e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=93833
2024-11-10 08:58:36 - progress_bar.py[line:274] - INFO: epoch 039:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17507.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=2880.2, ups=0.16, wpb=17507.4, bsz=1024, num_updates=14250, lr=3.24817e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=61, gb_free=13.3, wall=93894
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
2024-11-10 08:59:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 39 @ 14258 updates
2024-11-10 08:59:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 09:01:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 09:03:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 39 @ 14258 updates, score 0) (writing took 229.42212186701363 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_39.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
2024-11-10 09:04:08 - train.py[line:336] - INFO: end of epoch 39 (average epoch stats below)
2024-11-10 09:04:08 - progress_bar.py[line:282] - INFO: epoch 039 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.9 | ntokens 17452.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.47 | wps 2485.8 | ups 0.14 | wpb 17452.7 | bsz 1023.1 | num_updates 14258 | lr 3.24701e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 2096 | gb_free 13.3 | wall 94227
2024-11-10 09:04:08 - trainer.py[line:639] - INFO: loading train data for epoch 40
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 09:06:41 - trainer.py[line:703] - INFO: begin training epoch 40
2024-11-10 09:06:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 09:06:55 - progress_bar.py[line:274] - INFO: epoch 040:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.919, ntokens=17255.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.56, wps=345.7, ups=0.02, wpb=17255.3, bsz=998.4, num_updates=14260, lr=3.24672e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.1, wall=94393
2024-11-10 09:08:01 - progress_bar.py[line:274] - INFO: epoch 040:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17393.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=2650.6, ups=0.15, wpb=17393.2, bsz=1024, num_updates=14270, lr=3.24526e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=64, gb_free=13.5, wall=94459
2024-11-10 09:09:07 - progress_bar.py[line:274] - INFO: epoch 040:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17390, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=2639.4, ups=0.15, wpb=17390, bsz=1024, num_updates=14280, lr=3.24381e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=66, gb_free=13.3, wall=94525
2024-11-10 09:10:12 - progress_bar.py[line:274] - INFO: epoch 040:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17476.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=2662.9, ups=0.15, wpb=17476.5, bsz=1024, num_updates=14290, lr=3.24236e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=66, gb_free=13.5, wall=94591
2024-11-10 09:11:18 - progress_bar.py[line:274] - INFO: epoch 040:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17322.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=2635.1, ups=0.15, wpb=17322.7, bsz=1024, num_updates=14300, lr=3.2409e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=66, gb_free=13.4, wall=94656
2024-11-10 09:12:24 - progress_bar.py[line:274] - INFO: epoch 040:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=17228, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=2609.2, ups=0.15, wpb=17228, bsz=1024, num_updates=14310, lr=3.23945e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=66, gb_free=13.5, wall=94722
2024-11-10 09:13:22 - progress_bar.py[line:274] - INFO: epoch 040:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17560.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3019, ups=0.17, wpb=17560.7, bsz=1024, num_updates=14320, lr=3.238e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=94780
2024-11-10 09:14:16 - progress_bar.py[line:274] - INFO: epoch 040:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17420.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3232.5, ups=0.19, wpb=17420.8, bsz=1024, num_updates=14330, lr=3.23654e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=48, gb_free=13.3, wall=94834
2024-11-10 09:15:10 - progress_bar.py[line:274] - INFO: epoch 040:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17424.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3211.3, ups=0.18, wpb=17424.6, bsz=1024, num_updates=14340, lr=3.23509e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=94889
2024-11-10 09:16:05 - progress_bar.py[line:274] - INFO: epoch 040:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.917, ntokens=17662.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.55, wps=3208.6, ups=0.18, wpb=17662.4, bsz=1024, num_updates=14350, lr=3.23364e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=94944
2024-11-10 09:16:57 - progress_bar.py[line:274] - INFO: epoch 040:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17316.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3348.5, ups=0.19, wpb=17316.2, bsz=1024, num_updates=14360, lr=3.23218e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=42, gb_free=13.4, wall=94995
2024-11-10 09:17:50 - progress_bar.py[line:274] - INFO: epoch 040:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17419.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3288.5, ups=0.19, wpb=17419.3, bsz=1024, num_updates=14370, lr=3.23073e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95048
2024-11-10 09:18:43 - progress_bar.py[line:274] - INFO: epoch 040:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17225.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3254.8, ups=0.19, wpb=17225.2, bsz=1024, num_updates=14380, lr=3.22928e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95101
2024-11-10 09:19:36 - progress_bar.py[line:274] - INFO: epoch 040:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17290.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3296.1, ups=0.19, wpb=17290.5, bsz=1024, num_updates=14390, lr=3.22782e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95154
2024-11-10 09:20:28 - progress_bar.py[line:274] - INFO: epoch 040:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17318.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3320, ups=0.19, wpb=17318.1, bsz=1024, num_updates=14400, lr=3.22637e-05, gnorm=0.01, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=95206
2024-11-10 09:21:21 - progress_bar.py[line:274] - INFO: epoch 040:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.941, ntokens=17727.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.68, wps=3351.5, ups=0.19, wpb=17727.9, bsz=1024, num_updates=14410, lr=3.22492e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95259
2024-11-10 09:22:13 - progress_bar.py[line:274] - INFO: epoch 040:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17705.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3365, ups=0.19, wpb=17705.6, bsz=1024, num_updates=14420, lr=3.22346e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95311
2024-11-10 09:23:06 - progress_bar.py[line:274] - INFO: epoch 040:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17375.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3299, ups=0.19, wpb=17375.8, bsz=1024, num_updates=14430, lr=3.22201e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95364
2024-11-10 09:23:59 - progress_bar.py[line:274] - INFO: epoch 040:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17509.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3271.8, ups=0.19, wpb=17509.1, bsz=1024, num_updates=14440, lr=3.22056e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95418
2024-11-10 09:24:51 - progress_bar.py[line:274] - INFO: epoch 040:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17205.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3310.6, ups=0.19, wpb=17205.8, bsz=1015.4, num_updates=14450, lr=3.2191e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13, wall=95470
2024-11-10 09:25:44 - progress_bar.py[line:274] - INFO: epoch 040:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17482.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3294.2, ups=0.19, wpb=17482.2, bsz=1024, num_updates=14460, lr=3.21765e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95523
2024-11-10 09:26:37 - progress_bar.py[line:274] - INFO: epoch 040:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17126.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3245.8, ups=0.19, wpb=17126.3, bsz=1024, num_updates=14470, lr=3.2162e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95575
2024-11-10 09:27:30 - progress_bar.py[line:274] - INFO: epoch 040:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17502.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3292.4, ups=0.19, wpb=17502.9, bsz=1024, num_updates=14480, lr=3.21474e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95629
2024-11-10 09:28:23 - progress_bar.py[line:274] - INFO: epoch 040:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17420.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3315.2, ups=0.19, wpb=17420.4, bsz=1024, num_updates=14490, lr=3.21329e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95681
2024-11-10 09:29:17 - progress_bar.py[line:274] - INFO: epoch 040:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.922, ntokens=17529.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.58, wps=3270.3, ups=0.19, wpb=17529.1, bsz=1024, num_updates=14500, lr=3.21184e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=95735
2024-11-10 09:30:09 - progress_bar.py[line:274] - INFO: epoch 040:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17437.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3301.2, ups=0.19, wpb=17437.6, bsz=1024, num_updates=14510, lr=3.21038e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95788
2024-11-10 09:31:03 - progress_bar.py[line:274] - INFO: epoch 040:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17097.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3195, ups=0.19, wpb=17097.1, bsz=1024, num_updates=14520, lr=3.20893e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95841
2024-11-10 09:31:57 - progress_bar.py[line:274] - INFO: epoch 040:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17377, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3235.1, ups=0.19, wpb=17377, bsz=1024, num_updates=14530, lr=3.20748e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=95895
2024-11-10 09:32:49 - progress_bar.py[line:274] - INFO: epoch 040:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17069.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3250.3, ups=0.19, wpb=17069.7, bsz=1024, num_updates=14540, lr=3.20602e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=95947
2024-11-10 09:33:42 - progress_bar.py[line:274] - INFO: epoch 040:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17334.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3297.1, ups=0.19, wpb=17334.7, bsz=1024, num_updates=14550, lr=3.20457e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.6, wall=96000
2024-11-10 09:34:34 - progress_bar.py[line:274] - INFO: epoch 040:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.912, ntokens=17602.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.53, wps=3388.2, ups=0.19, wpb=17602.2, bsz=1024, num_updates=14560, lr=3.20312e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=96052
2024-11-10 09:35:25 - progress_bar.py[line:274] - INFO: epoch 040:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17552.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3409, ups=0.19, wpb=17552.7, bsz=1024, num_updates=14570, lr=3.20166e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.3, wall=96103
2024-11-10 09:36:18 - progress_bar.py[line:274] - INFO: epoch 040:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.949, ntokens=17786, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.72, wps=3393.9, ups=0.19, wpb=17786, bsz=1024, num_updates=14580, lr=3.20021e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=33, gb_free=13.4, wall=96156
2024-11-10 09:37:10 - progress_bar.py[line:274] - INFO: epoch 040:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17470.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3336.7, ups=0.19, wpb=17470.2, bsz=1024, num_updates=14590, lr=3.19876e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=45, gb_free=13.5, wall=96208
2024-11-10 09:38:02 - progress_bar.py[line:274] - INFO: epoch 040:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17699, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3378.8, ups=0.19, wpb=17699, bsz=1024, num_updates=14600, lr=3.1973e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=49, gb_free=13.4, wall=96260
2024-11-10 09:38:55 - progress_bar.py[line:274] - INFO: epoch 040:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=17595.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3347.1, ups=0.19, wpb=17595.3, bsz=1024, num_updates=14610, lr=3.19585e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.2, wall=96313
2024-11-10 09:39:47 - progress_bar.py[line:274] - INFO: epoch 040:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17476.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3345.4, ups=0.19, wpb=17476.7, bsz=1024, num_updates=14620, lr=3.1944e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=96365
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 09:40:06 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 40 @ 14624 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
2024-11-10 09:40:06 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 09:41:58 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 09:43:52 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 40 @ 14624 updates, score 0) (writing took 226.04549784201663 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_40.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 09:44:47 - train.py[line:336] - INFO: end of epoch 40 (average epoch stats below)
2024-11-10 09:44:47 - progress_bar.py[line:282] - INFO: epoch 040 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.89 | ntokens 17425.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.41 | wps 2615 | ups 0.15 | wpb 17425.7 | bsz 1023.1 | num_updates 14624 | lr 3.19381e-05 | gnorm 0.005 | clip 0 | loss_scale 262144 | train_wall 1475 | gb_free 13.5 | wall 96666
2024-11-10 09:44:47 - trainer.py[line:639] - INFO: loading train data for epoch 41
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 09:47:17 - trainer.py[line:703] - INFO: begin training epoch 41
2024-11-10 09:47:17 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 09:47:52 - progress_bar.py[line:274] - INFO: epoch 041:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.928, ntokens=17137.9, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=353.5, ups=0.02, wpb=17137.9, bsz=998.4, num_updates=14630, lr=3.19294e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=37, gb_free=13.4, wall=96850
2024-11-10 09:48:45 - progress_bar.py[line:274] - INFO: epoch 041:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17329.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3291.1, ups=0.19, wpb=17329.1, bsz=1024, num_updates=14640, lr=3.19149e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=96903
2024-11-10 09:49:37 - progress_bar.py[line:274] - INFO: epoch 041:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17315.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3275.6, ups=0.19, wpb=17315.1, bsz=1024, num_updates=14650, lr=3.19004e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=96956
2024-11-10 09:50:30 - progress_bar.py[line:274] - INFO: epoch 041:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17497.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3306.4, ups=0.19, wpb=17497.6, bsz=1024, num_updates=14660, lr=3.18858e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97009
2024-11-10 09:51:23 - progress_bar.py[line:274] - INFO: epoch 041:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17353.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3322.5, ups=0.19, wpb=17353.9, bsz=1024, num_updates=14670, lr=3.18713e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=97061
2024-11-10 09:52:16 - progress_bar.py[line:274] - INFO: epoch 041:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17599.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3323.2, ups=0.19, wpb=17599.7, bsz=1024, num_updates=14680, lr=3.18568e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=97114
2024-11-10 09:53:08 - progress_bar.py[line:274] - INFO: epoch 041:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.905, ntokens=17455.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3300.9, ups=0.19, wpb=17455.3, bsz=1024, num_updates=14690, lr=3.18422e-05, gnorm=0.007, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=97167
2024-11-10 09:54:01 - progress_bar.py[line:274] - INFO: epoch 041:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17163.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3258.4, ups=0.19, wpb=17163.9, bsz=1015.4, num_updates=14700, lr=3.18277e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97219
2024-11-10 09:54:54 - progress_bar.py[line:274] - INFO: epoch 041:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17552, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3326.9, ups=0.19, wpb=17552, bsz=1024, num_updates=14710, lr=3.18132e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=97272
2024-11-10 09:55:47 - progress_bar.py[line:274] - INFO: epoch 041:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17561.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3326.6, ups=0.19, wpb=17561.8, bsz=1024, num_updates=14720, lr=3.17986e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=97325
2024-11-10 09:56:40 - progress_bar.py[line:274] - INFO: epoch 041:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17331.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3279.1, ups=0.19, wpb=17331.8, bsz=1024, num_updates=14730, lr=3.17841e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97378
2024-11-10 09:57:33 - progress_bar.py[line:274] - INFO: epoch 041:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.872, ntokens=17386.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3257.4, ups=0.19, wpb=17386.3, bsz=1024, num_updates=14740, lr=3.17696e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=97431
2024-11-10 09:58:26 - progress_bar.py[line:274] - INFO: epoch 041:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17428.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3277, ups=0.19, wpb=17428.4, bsz=1024, num_updates=14750, lr=3.1755e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97484
2024-11-10 09:59:19 - progress_bar.py[line:274] - INFO: epoch 041:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17224.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3253.8, ups=0.19, wpb=17224.4, bsz=1024, num_updates=14760, lr=3.17405e-05, gnorm=0.007, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=97537
2024-11-10 10:00:12 - progress_bar.py[line:274] - INFO: epoch 041:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.925, ntokens=17691.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.59, wps=3336.9, ups=0.19, wpb=17691.6, bsz=1024, num_updates=14770, lr=3.1726e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97590
2024-11-10 10:01:05 - progress_bar.py[line:274] - INFO: epoch 041:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17496.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3313.8, ups=0.19, wpb=17496.9, bsz=1024, num_updates=14780, lr=3.17114e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97643
2024-11-10 10:01:58 - progress_bar.py[line:274] - INFO: epoch 041:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17339.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3258, ups=0.19, wpb=17339.5, bsz=1024, num_updates=14790, lr=3.16969e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=97696
2024-11-10 10:02:51 - progress_bar.py[line:274] - INFO: epoch 041:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17315.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3284.2, ups=0.19, wpb=17315.7, bsz=1024, num_updates=14800, lr=3.16824e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=97749
2024-11-10 10:03:44 - progress_bar.py[line:274] - INFO: epoch 041:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.883, ntokens=17366.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3277, ups=0.19, wpb=17366.8, bsz=1024, num_updates=14810, lr=3.16678e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=97802
2024-11-10 10:04:37 - progress_bar.py[line:274] - INFO: epoch 041:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17283.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3278.2, ups=0.19, wpb=17283.9, bsz=1024, num_updates=14820, lr=3.16533e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=97855
2024-11-10 10:05:30 - progress_bar.py[line:274] - INFO: epoch 041:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17566.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3307.8, ups=0.19, wpb=17566.9, bsz=1024, num_updates=14830, lr=3.16388e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97908
2024-11-10 10:06:22 - progress_bar.py[line:274] - INFO: epoch 041:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17468.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3334.8, ups=0.19, wpb=17468.5, bsz=1024, num_updates=14840, lr=3.16242e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=97960
2024-11-10 10:07:15 - progress_bar.py[line:274] - INFO: epoch 041:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17529.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3330.8, ups=0.19, wpb=17529.3, bsz=1024, num_updates=14850, lr=3.16097e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=98013
2024-11-10 10:08:08 - progress_bar.py[line:274] - INFO: epoch 041:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17492, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3255.4, ups=0.19, wpb=17492, bsz=1024, num_updates=14860, lr=3.15952e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=98067
2024-11-10 10:09:02 - progress_bar.py[line:274] - INFO: epoch 041:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17376.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3264.1, ups=0.19, wpb=17376.9, bsz=1024, num_updates=14870, lr=3.15806e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=98120
2024-11-10 10:09:54 - progress_bar.py[line:274] - INFO: epoch 041:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17327.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3286.2, ups=0.19, wpb=17327.1, bsz=1024, num_updates=14880, lr=3.15661e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=98173
2024-11-10 10:10:47 - progress_bar.py[line:274] - INFO: epoch 041:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17627.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3324.6, ups=0.19, wpb=17627.2, bsz=1024, num_updates=14890, lr=3.15516e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=98226
2024-11-10 10:11:41 - progress_bar.py[line:274] - INFO: epoch 041:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17232.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3232, ups=0.19, wpb=17232.2, bsz=1024, num_updates=14900, lr=3.1537e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=98279
2024-11-10 10:12:34 - progress_bar.py[line:274] - INFO: epoch 041:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17114.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3208.8, ups=0.19, wpb=17114.2, bsz=1024, num_updates=14910, lr=3.15225e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=98332
2024-11-10 10:13:27 - progress_bar.py[line:274] - INFO: epoch 041:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17293.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3273, ups=0.19, wpb=17293.7, bsz=1024, num_updates=14920, lr=3.1508e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=98385
2024-11-10 10:14:19 - progress_bar.py[line:274] - INFO: epoch 041:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.929, ntokens=17905.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.61, wps=3459.7, ups=0.19, wpb=17905.5, bsz=1024, num_updates=14930, lr=3.14934e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=98437
2024-11-10 10:15:11 - progress_bar.py[line:274] - INFO: epoch 041:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17545.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3377.7, ups=0.19, wpb=17545.9, bsz=1024, num_updates=14940, lr=3.14789e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=98489
2024-11-10 10:16:03 - progress_bar.py[line:274] - INFO: epoch 041:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17589.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3377.2, ups=0.19, wpb=17589.6, bsz=1024, num_updates=14950, lr=3.14644e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=98541
2024-11-10 10:16:57 - progress_bar.py[line:274] - INFO: epoch 041:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17441, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3225.9, ups=0.18, wpb=17441, bsz=1024, num_updates=14960, lr=3.14498e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.3, wall=98595
2024-11-10 10:17:49 - progress_bar.py[line:274] - INFO: epoch 041:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17495.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3352.1, ups=0.19, wpb=17495.4, bsz=1024, num_updates=14970, lr=3.14353e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=98647
2024-11-10 10:18:42 - progress_bar.py[line:274] - INFO: epoch 041:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17476.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3311.6, ups=0.19, wpb=17476.3, bsz=1024, num_updates=14980, lr=3.14208e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=39, gb_free=13.1, wall=98700
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 10:19:31 - progress_bar.py[line:274] - INFO: epoch 041:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=16989.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3413, ups=0.2, wpb=16989.8, bsz=998.4, num_updates=14990, lr=3.14062e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=45, gb_free=13.4, wall=98750
2024-11-10 10:19:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 41 @ 14990 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
2024-11-10 10:19:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 10:21:24 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 10:23:17 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 41 @ 14990 updates, score 0) (writing took 225.99597481597448 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_41.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 10:24:13 - train.py[line:336] - INFO: end of epoch 41 (average epoch stats below)
2024-11-10 10:24:13 - progress_bar.py[line:282] - INFO: epoch 041 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.879 | ntokens 17419.4 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.36 | wps 2695.3 | ups 0.15 | wpb 17419.4 | bsz 1023.1 | num_updates 14990 | lr 3.14062e-05 | gnorm 0.005 | clip 0 | loss_scale 262144 | train_wall 1131 | gb_free 13.4 | wall 99031
2024-11-10 10:24:13 - trainer.py[line:639] - INFO: loading train data for epoch 42
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 10:26:43 - trainer.py[line:703] - INFO: begin training epoch 42
2024-11-10 10:26:43 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 10:27:38 - progress_bar.py[line:274] - INFO: epoch 042:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17166.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=352.6, ups=0.02, wpb=17166.2, bsz=1024, num_updates=15000, lr=3.13917e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=99237
loss_reg: 0.00596388742371338 loss_cls: 0.0032883218955248594
loss_reg: 0.007178783156514088 loss_cls: 0.004519019741564989
loss_reg: 0.005520749735047255 loss_cls: 0.0038978864904493093
loss_reg: 0.007745346905173669 loss_cls: 0.003712897654622793
loss_reg: 0.007534924538738394 loss_cls: 0.0033036309760063887
loss_reg: 0.008271369544755866 loss_cls: 0.004404454957693815
loss_reg: 0.007589542905752941 loss_cls: 0.003837384982034564
loss_reg: 0.006709022533669829 loss_cls: 0.0035826994571834803
loss_reg: 0.005829022218044276 loss_cls: 0.0034067537635564804
loss_reg: 0.007779411166138416 loss_cls: 0.003320107702165842
loss_reg: 0.006873563986835876 loss_cls: 0.004164094105362892
loss_reg: 0.0064172735486819 loss_cls: 0.0045204004272818565
loss_reg: 0.00822232324229801 loss_cls: 0.004122698213905096
loss_reg: 0.007927624369165345 loss_cls: 0.004456130787730217
loss_reg: 0.006005225426884815 loss_cls: 0.003116901498287916
loss_reg: 0.0049890512782420175 loss_cls: 0.003791885217651725
loss_reg: 0.0092887734205424 loss_cls: 0.00383485178463161
loss_reg: 0.01005373843667675 loss_cls: 0.0040815738029778
loss_reg: 0.010671312806122057 loss_cls: 0.0038321276661008596
loss_reg: 0.005887233681539626 loss_cls: 0.003712725592777133
loss_reg: 0.00677135544235798 loss_cls: 0.0037171572912484407
loss_reg: 0.010599202934863472 loss_cls: 0.0033048726618289948
loss_reg: 0.010089089649683924 loss_cls: 0.0033758177887648344
loss_reg: 0.007102599539634927 loss_cls: 0.003043131437152624
loss_reg: 0.008595532512270042 loss_cls: 0.0028103955555707216
loss_reg: 0.006982806938255561 loss_cls: 0.0037555263843387365
loss_reg: 0.010744087137512948 loss_cls: 0.0033817512448877096
loss_reg: 0.00835653930346349 loss_cls: 0.0031061451882123947
loss_reg: 0.007365864631965074 loss_cls: 0.003321330063045025
loss_reg: 0.0074160114506547 loss_cls: 0.0032984684221446514
loss_reg: 0.007420939961960826 loss_cls: 0.003058369504287839
loss_reg: 0.00915403867384277 loss_cls: 0.0030497245024889708
loss_reg: 0.007761697176568429 loss_cls: 0.0033655166625976562
loss_reg: 0.009811090956047718 loss_cls: 0.0034769345074892044
loss_reg: 0.005824299101802755 loss_cls: 0.0031464267522096634
loss_reg: 0.0074306405798353035 loss_cls: 0.0029971511103212833
loss_reg: 0.01108888746838139 loss_cls: 0.003283257130533457
loss_reg: 0.005900881149591147 loss_cls: 0.0038817799650132656
loss_reg: 0.010997063079386362 loss_cls: 0.003485923632979393
loss_reg: 0.0066272629106614 loss_cls: 0.00338218966498971
loss_reg: 0.008979172646847677 loss_cls: 0.003369615413248539
loss_reg: 0.007178147531671238 loss_cls: 0.0035862887743860483
loss_reg: 0.008380212090938418 loss_cls: 0.0049705966375768185
loss_reg: 0.009497142687152191 loss_cls: 0.004113706294447184
loss_reg: 0.0065674504587557945 loss_cls: 0.00431879423558712
loss_reg: 0.006560052139600567 loss_cls: 0.003923096694052219loss_reg: 0.008501933895905579 loss_cls: 0.003059674985706806

loss_reg: 0.004760153098721779 loss_cls: 0.0037022684700787067
loss_reg: 0.006533890214433598 loss_cls: 0.0046998560428619385
loss_reg: 0.008207799484504535 loss_cls: 0.0035992295015603304
loss_reg: 0.008316488359732773 loss_cls: 0.003463398665189743
loss_reg: 0.0071917442607933885 loss_cls: 0.004409896209836006
loss_reg: 0.008083845128913948 loss_cls: 0.0046707880683243275
loss_reg: 0.010540792976280381 loss_cls: 0.003758858423680067
loss_reg: 0.009174653197789852 loss_cls: 0.0038312675897032022
loss_reg: 0.0061483843160464215 loss_cls: 0.004718297626823187
loss_reg: 0.007155420110566794 loss_cls: 0.0036375916097313166
loss_reg: 0.007925895155382544 loss_cls: 0.0031864834018051624
loss_reg: 0.00706861948802021 loss_cls: 0.003218699712306261
loss_reg: 0.006648227140626168 loss_cls: 0.002691668691113591
loss_reg: 0.005531167722615398 loss_cls: 0.0038645125459879637
loss_reg: 0.00597322929528639 loss_cls: 0.0028684420976787806
loss_reg: 0.007666569887086113 loss_cls: 0.004133752081543207
loss_reg: 0.011116290548678054 loss_cls: 0.0038988159503787756
2024-11-10 10:28:32 - progress_bar.py[line:274] - INFO: epoch 042:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.852, ntokens=17346, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3240.9, ups=0.19, wpb=17346, bsz=1024, num_updates=15010, lr=3.13772e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=99290
2024-11-10 10:29:25 - progress_bar.py[line:274] - INFO: epoch 042:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17179, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3234.4, ups=0.19, wpb=17179, bsz=1024, num_updates=15020, lr=3.13626e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=99343
2024-11-10 10:30:18 - progress_bar.py[line:274] - INFO: epoch 042:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17433.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3274.3, ups=0.19, wpb=17433.7, bsz=1024, num_updates=15030, lr=3.13481e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.1, wall=99396
2024-11-10 10:31:11 - progress_bar.py[line:274] - INFO: epoch 042:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17379.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3286.1, ups=0.19, wpb=17379.7, bsz=1024, num_updates=15040, lr=3.13336e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=99449
2024-11-10 10:31:43 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 10:32:09 - progress_bar.py[line:274] - INFO: epoch 042:     61 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17582.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3022.7, ups=0.17, wpb=17582.7, bsz=1024, num_updates=15050, lr=3.1319e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=33, gb_free=13.5, wall=99507
2024-11-10 10:33:02 - progress_bar.py[line:274] - INFO: epoch 042:     71 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17351.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3287.7, ups=0.19, wpb=17351.4, bsz=1024, num_updates=15060, lr=3.13045e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=99560
2024-11-10 10:33:55 - progress_bar.py[line:274] - INFO: epoch 042:     81 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17282.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3268.1, ups=0.19, wpb=17282.9, bsz=1015.4, num_updates=15070, lr=3.129e-05, gnorm=0.009, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=99613
2024-11-10 10:34:47 - progress_bar.py[line:274] - INFO: epoch 042:     91 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17519.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3355, ups=0.19, wpb=17519.5, bsz=1024, num_updates=15080, lr=3.12754e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=99665
2024-11-10 10:35:40 - progress_bar.py[line:274] - INFO: epoch 042:    101 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17547.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3340.4, ups=0.19, wpb=17547.1, bsz=1024, num_updates=15090, lr=3.12609e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=99718
2024-11-10 10:36:33 - progress_bar.py[line:274] - INFO: epoch 042:    111 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17614.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3333.9, ups=0.19, wpb=17614.6, bsz=1024, num_updates=15100, lr=3.12464e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=99771
2024-11-10 10:37:26 - progress_bar.py[line:274] - INFO: epoch 042:    121 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.915, ntokens=17675.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=3321.4, ups=0.19, wpb=17675.7, bsz=1024, num_updates=15110, lr=3.12318e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=99824
2024-11-10 10:38:20 - progress_bar.py[line:274] - INFO: epoch 042:    131 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17098, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3177.9, ups=0.19, wpb=17098, bsz=1024, num_updates=15120, lr=3.12173e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=99878
2024-11-10 10:39:12 - progress_bar.py[line:274] - INFO: epoch 042:    141 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17644.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3337.1, ups=0.19, wpb=17644.4, bsz=1024, num_updates=15130, lr=3.12028e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=99931
2024-11-10 10:40:05 - progress_bar.py[line:274] - INFO: epoch 042:    151 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.897, ntokens=17591.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3320.4, ups=0.19, wpb=17591.6, bsz=1024, num_updates=15140, lr=3.11882e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=99984
2024-11-10 10:40:58 - progress_bar.py[line:274] - INFO: epoch 042:    161 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17504.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3307, ups=0.19, wpb=17504.2, bsz=1024, num_updates=15150, lr=3.11737e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100037
2024-11-10 10:41:51 - progress_bar.py[line:274] - INFO: epoch 042:    171 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17578.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3339.9, ups=0.19, wpb=17578.1, bsz=1024, num_updates=15160, lr=3.11592e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.2, wall=100089
2024-11-10 10:42:44 - progress_bar.py[line:274] - INFO: epoch 042:    181 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.91, ntokens=17606.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3319.4, ups=0.19, wpb=17606.3, bsz=1024, num_updates=15170, lr=3.11446e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=100142
2024-11-10 10:43:37 - progress_bar.py[line:274] - INFO: epoch 042:    191 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17037.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3234.5, ups=0.19, wpb=17037.2, bsz=1024, num_updates=15180, lr=3.11301e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100195
2024-11-10 10:44:29 - progress_bar.py[line:274] - INFO: epoch 042:    201 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17175.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3256.5, ups=0.19, wpb=17175.2, bsz=1024, num_updates=15190, lr=3.11156e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100248
2024-11-10 10:45:23 - progress_bar.py[line:274] - INFO: epoch 042:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17235.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3233.4, ups=0.19, wpb=17235.1, bsz=1024, num_updates=15200, lr=3.1101e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=100301
2024-11-10 10:46:16 - progress_bar.py[line:274] - INFO: epoch 042:    221 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.869, ntokens=17601.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3299.8, ups=0.19, wpb=17601.3, bsz=1024, num_updates=15210, lr=3.10865e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100354
2024-11-10 10:47:09 - progress_bar.py[line:274] - INFO: epoch 042:    231 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17410.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3306.6, ups=0.19, wpb=17410.3, bsz=1024, num_updates=15220, lr=3.1072e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100407
2024-11-10 10:48:02 - progress_bar.py[line:274] - INFO: epoch 042:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17460.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3288, ups=0.19, wpb=17460.3, bsz=1024, num_updates=15230, lr=3.10574e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100460
2024-11-10 10:48:54 - progress_bar.py[line:274] - INFO: epoch 042:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17573.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3342.2, ups=0.19, wpb=17573.6, bsz=1024, num_updates=15240, lr=3.10429e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100513
2024-11-10 10:49:48 - progress_bar.py[line:274] - INFO: epoch 042:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17498.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3294.1, ups=0.19, wpb=17498.5, bsz=1024, num_updates=15250, lr=3.10284e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=100566
2024-11-10 10:50:40 - progress_bar.py[line:274] - INFO: epoch 042:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17355.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3302.3, ups=0.19, wpb=17355.6, bsz=1024, num_updates=15260, lr=3.10138e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100618
2024-11-10 10:51:33 - progress_bar.py[line:274] - INFO: epoch 042:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17028.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3196.4, ups=0.19, wpb=17028.3, bsz=1024, num_updates=15270, lr=3.09993e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=100672
2024-11-10 10:52:26 - progress_bar.py[line:274] - INFO: epoch 042:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17429.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3309.8, ups=0.19, wpb=17429.2, bsz=1024, num_updates=15280, lr=3.09848e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=100724
2024-11-10 10:53:18 - progress_bar.py[line:274] - INFO: epoch 042:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17508.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3345.3, ups=0.19, wpb=17508.9, bsz=1024, num_updates=15290, lr=3.09702e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=100777
2024-11-10 10:54:10 - progress_bar.py[line:274] - INFO: epoch 042:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.877, ntokens=17587.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3390, ups=0.19, wpb=17587.9, bsz=1024, num_updates=15300, lr=3.09557e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=100828
2024-11-10 10:55:03 - progress_bar.py[line:274] - INFO: epoch 042:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.945, ntokens=17918, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.7, wps=3420.6, ups=0.19, wpb=17918, bsz=1024, num_updates=15310, lr=3.09412e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=100881
2024-11-10 10:55:55 - progress_bar.py[line:274] - INFO: epoch 042:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.896, ntokens=17669.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3375.5, ups=0.19, wpb=17669.6, bsz=1024, num_updates=15320, lr=3.09266e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=32, gb_free=13.3, wall=100933
2024-11-10 10:56:47 - progress_bar.py[line:274] - INFO: epoch 042:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.907, ntokens=17733.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3391.2, ups=0.19, wpb=17733.9, bsz=1024, num_updates=15330, lr=3.09121e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=100985
2024-11-10 10:57:40 - progress_bar.py[line:274] - INFO: epoch 042:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.908, ntokens=17654, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.51, wps=3374.8, ups=0.19, wpb=17654, bsz=1024, num_updates=15340, lr=3.08976e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=101038
2024-11-10 10:58:32 - progress_bar.py[line:274] - INFO: epoch 042:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.905, ntokens=17740.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3398.2, ups=0.19, wpb=17740.9, bsz=1024, num_updates=15350, lr=3.0883e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=101090
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 10:58:56 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 42 @ 15355 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
2024-11-10 10:58:56 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 11:00:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
2024-11-10 11:02:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 42 @ 15355 updates, score 0) (writing took 224.6093429630273 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_42.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-10 11:03:36 - train.py[line:336] - INFO: end of epoch 42 (average epoch stats below)
2024-11-10 11:03:36 - progress_bar.py[line:282] - INFO: epoch 042 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.878 | ntokens 17455.9 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.35 | wps 2696.3 | ups 0.15 | wpb 17455.9 | bsz 1023.1 | num_updates 15355 | lr 3.08758e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1110 | gb_free 13.4 | wall 101394
2024-11-10 11:03:36 - trainer.py[line:639] - INFO: loading train data for epoch 43
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 11:06:05 - trainer.py[line:703] - INFO: begin training epoch 43
2024-11-10 11:06:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 11:06:34 - progress_bar.py[line:274] - INFO: epoch 043:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=16700.4, nsentences=989.8, sample_size=989.8, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=346.6, ups=0.02, wpb=16700.4, bsz=989.8, num_updates=15360, lr=3.08685e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=101572
2024-11-10 11:07:32 - progress_bar.py[line:274] - INFO: epoch 043:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17366.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=2982.3, ups=0.17, wpb=17366.8, bsz=1024, num_updates=15370, lr=3.0854e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=101630
2024-11-10 11:08:29 - progress_bar.py[line:274] - INFO: epoch 043:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17447.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3046.7, ups=0.17, wpb=17447.1, bsz=1024, num_updates=15380, lr=3.08394e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=101687
2024-11-10 11:09:22 - progress_bar.py[line:274] - INFO: epoch 043:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17425.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3296.3, ups=0.19, wpb=17425.7, bsz=1024, num_updates=15390, lr=3.08249e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=101740
2024-11-10 11:10:15 - progress_bar.py[line:274] - INFO: epoch 043:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.873, ntokens=17396.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3296.2, ups=0.19, wpb=17396.7, bsz=1024, num_updates=15400, lr=3.08104e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=101793
2024-11-10 11:11:08 - progress_bar.py[line:274] - INFO: epoch 043:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17669.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.5, wps=3349.6, ups=0.19, wpb=17669.8, bsz=1024, num_updates=15410, lr=3.07958e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=101846
2024-11-10 11:12:01 - progress_bar.py[line:274] - INFO: epoch 043:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17526.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3291.5, ups=0.19, wpb=17526.1, bsz=1024, num_updates=15420, lr=3.07813e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=101899
2024-11-10 11:12:54 - progress_bar.py[line:274] - INFO: epoch 043:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17331.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3253.1, ups=0.19, wpb=17331.3, bsz=1024, num_updates=15430, lr=3.07668e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=101952
2024-11-10 11:13:47 - progress_bar.py[line:274] - INFO: epoch 043:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17364, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3300.8, ups=0.19, wpb=17364, bsz=1024, num_updates=15440, lr=3.07522e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=102005
2024-11-10 11:14:40 - progress_bar.py[line:274] - INFO: epoch 043:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.89, ntokens=17623.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3311.4, ups=0.19, wpb=17623.4, bsz=1024, num_updates=15450, lr=3.07377e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=102058
2024-11-10 11:15:32 - progress_bar.py[line:274] - INFO: epoch 043:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.898, ntokens=17543.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.45, wps=3336.6, ups=0.19, wpb=17543.5, bsz=1024, num_updates=15460, lr=3.07232e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=102111
2024-11-10 11:16:25 - progress_bar.py[line:274] - INFO: epoch 043:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.899, ntokens=17664.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.46, wps=3346.9, ups=0.19, wpb=17664.7, bsz=1024, num_updates=15470, lr=3.07086e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=102163
2024-11-10 11:17:19 - progress_bar.py[line:274] - INFO: epoch 043:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17104.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3198.3, ups=0.19, wpb=17104.7, bsz=1024, num_updates=15480, lr=3.06941e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=102217
2024-11-10 11:18:12 - progress_bar.py[line:274] - INFO: epoch 043:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17427.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3285.2, ups=0.19, wpb=17427.6, bsz=1024, num_updates=15490, lr=3.06796e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=102270
2024-11-10 11:19:05 - progress_bar.py[line:274] - INFO: epoch 043:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.876, ntokens=17422.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3298.9, ups=0.19, wpb=17422.3, bsz=1024, num_updates=15500, lr=3.0665e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=102323
2024-11-10 11:19:57 - progress_bar.py[line:274] - INFO: epoch 043:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17393.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3303.3, ups=0.19, wpb=17393.2, bsz=1024, num_updates=15510, lr=3.06505e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=102375
2024-11-10 11:20:49 - progress_bar.py[line:274] - INFO: epoch 043:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17363.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3327.6, ups=0.19, wpb=17363.3, bsz=1024, num_updates=15520, lr=3.0636e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=102428
2024-11-10 11:21:42 - progress_bar.py[line:274] - INFO: epoch 043:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17326.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3274, ups=0.19, wpb=17326.3, bsz=1024, num_updates=15530, lr=3.06214e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=102481
2024-11-10 11:22:35 - progress_bar.py[line:274] - INFO: epoch 043:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17361.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3274, ups=0.19, wpb=17361.6, bsz=1024, num_updates=15540, lr=3.06069e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=102534
2024-11-10 11:23:28 - progress_bar.py[line:274] - INFO: epoch 043:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17257.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3271.1, ups=0.19, wpb=17257.8, bsz=1024, num_updates=15550, lr=3.05924e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=102586
2024-11-10 11:24:21 - progress_bar.py[line:274] - INFO: epoch 043:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=17414.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3270.9, ups=0.19, wpb=17414.8, bsz=1024, num_updates=15560, lr=3.05778e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.6, wall=102640
2024-11-10 11:25:14 - progress_bar.py[line:274] - INFO: epoch 043:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.852, ntokens=17298.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3270.5, ups=0.19, wpb=17298.4, bsz=1024, num_updates=15570, lr=3.05633e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=102692
2024-11-10 11:26:07 - progress_bar.py[line:274] - INFO: epoch 043:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17418.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3333.8, ups=0.19, wpb=17418.9, bsz=1024, num_updates=15580, lr=3.05488e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=102745
2024-11-10 11:27:00 - progress_bar.py[line:274] - INFO: epoch 043:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.911, ntokens=17620.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.52, wps=3318.8, ups=0.19, wpb=17620.1, bsz=1024, num_updates=15590, lr=3.05342e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=102798
2024-11-10 11:27:53 - progress_bar.py[line:274] - INFO: epoch 043:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17339.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3263.3, ups=0.19, wpb=17339.6, bsz=1024, num_updates=15600, lr=3.05197e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=31, gb_free=13.5, wall=102851
2024-11-10 11:28:46 - progress_bar.py[line:274] - INFO: epoch 043:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17334.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3267.7, ups=0.19, wpb=17334.6, bsz=1024, num_updates=15610, lr=3.05052e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=102904
2024-11-10 11:29:39 - progress_bar.py[line:274] - INFO: epoch 043:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17229.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3248, ups=0.19, wpb=17229.7, bsz=1024, num_updates=15620, lr=3.04906e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=102957
2024-11-10 11:30:32 - progress_bar.py[line:274] - INFO: epoch 043:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17560.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3279.2, ups=0.19, wpb=17560.5, bsz=1024, num_updates=15630, lr=3.04761e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=103011
2024-11-10 11:31:26 - progress_bar.py[line:274] - INFO: epoch 043:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17205, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3216, ups=0.19, wpb=17205, bsz=1024, num_updates=15640, lr=3.04616e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=103064
2024-11-10 11:32:19 - progress_bar.py[line:274] - INFO: epoch 043:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17356.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3272.2, ups=0.19, wpb=17356.7, bsz=1024, num_updates=15650, lr=3.0447e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=103117
2024-11-10 11:33:11 - progress_bar.py[line:274] - INFO: epoch 043:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17636.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3385, ups=0.19, wpb=17636.1, bsz=1024, num_updates=15660, lr=3.04325e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=103169
2024-11-10 11:33:38 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 11:34:09 - progress_bar.py[line:274] - INFO: epoch 043:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17549, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3045.3, ups=0.17, wpb=17549, bsz=1024, num_updates=15670, lr=3.0418e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=39, gb_free=13.3, wall=103227
2024-11-10 11:35:01 - progress_bar.py[line:274] - INFO: epoch 043:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3378.2, ups=0.19, wpb=17513.9, bsz=1024, num_updates=15680, lr=3.04034e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=103279
2024-11-10 11:35:54 - progress_bar.py[line:274] - INFO: epoch 043:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17644.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3328.5, ups=0.19, wpb=17644.3, bsz=1024, num_updates=15690, lr=3.03889e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=39, gb_free=13.3, wall=103332
2024-11-10 11:36:46 - progress_bar.py[line:274] - INFO: epoch 043:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17642.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3338.6, ups=0.19, wpb=17642.9, bsz=1024, num_updates=15700, lr=3.03744e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=43, gb_free=13.4, wall=103385
2024-11-10 11:37:40 - progress_bar.py[line:274] - INFO: epoch 043:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.931, ntokens=17821.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.62, wps=3352.9, ups=0.19, wpb=17821.5, bsz=1024, num_updates=15710, lr=3.03598e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=51, gb_free=13.3, wall=103438
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 11:38:30 - progress_bar.py[line:274] - INFO: epoch 043:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17115.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3421.6, ups=0.2, wpb=17115.3, bsz=998.4, num_updates=15720, lr=3.03453e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=50, gb_free=13.5, wall=103488
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
2024-11-10 11:38:30 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 43 @ 15720 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
2024-11-10 11:38:30 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 11:40:21 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 11:42:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 43 @ 15720 updates, score 0) (writing took 224.84692547097802 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_43.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 11:43:10 - train.py[line:336] - INFO: end of epoch 43 (average epoch stats below)
2024-11-10 11:43:10 - progress_bar.py[line:282] - INFO: epoch 043 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.87 | ntokens 17424.6 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.31 | wps 2679.1 | ups 0.15 | wpb 17424.6 | bsz 1023.1 | num_updates 15720 | lr 3.03453e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 1178 | gb_free 13.5 | wall 103768
2024-11-10 11:43:10 - trainer.py[line:639] - INFO: loading train data for epoch 44
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 11:45:37 - trainer.py[line:703] - INFO: begin training epoch 44
2024-11-10 11:45:37 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 11:46:33 - progress_bar.py[line:274] - INFO: epoch 044:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17292.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=357.9, ups=0.02, wpb=17292.4, bsz=1024, num_updates=15730, lr=3.03308e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=103971
2024-11-10 11:47:26 - progress_bar.py[line:274] - INFO: epoch 044:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17106.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3225.8, ups=0.19, wpb=17106.1, bsz=1024, num_updates=15740, lr=3.03162e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104024
2024-11-10 11:48:19 - progress_bar.py[line:274] - INFO: epoch 044:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17349.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3286.8, ups=0.19, wpb=17349.7, bsz=1024, num_updates=15750, lr=3.03017e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104077
2024-11-10 11:49:12 - progress_bar.py[line:274] - INFO: epoch 044:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17481.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3299.4, ups=0.19, wpb=17481.1, bsz=1024, num_updates=15760, lr=3.02872e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=104130
2024-11-10 11:50:04 - progress_bar.py[line:274] - INFO: epoch 044:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.902, ntokens=17600.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3340.3, ups=0.19, wpb=17600.9, bsz=1024, num_updates=15770, lr=3.02726e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=104182
2024-11-10 11:50:57 - progress_bar.py[line:274] - INFO: epoch 044:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17539.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3328.9, ups=0.19, wpb=17539.8, bsz=1024, num_updates=15780, lr=3.02581e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104235
2024-11-10 11:51:50 - progress_bar.py[line:274] - INFO: epoch 044:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17392.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3291.3, ups=0.19, wpb=17392.1, bsz=1024, num_updates=15790, lr=3.02436e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=104288
2024-11-10 11:52:43 - progress_bar.py[line:274] - INFO: epoch 044:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17253.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3260.2, ups=0.19, wpb=17253.2, bsz=1024, num_updates=15800, lr=3.0229e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=104341
2024-11-10 11:53:36 - progress_bar.py[line:274] - INFO: epoch 044:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17355.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3261.9, ups=0.19, wpb=17355.1, bsz=1024, num_updates=15810, lr=3.02145e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=104394
2024-11-10 11:54:30 - progress_bar.py[line:274] - INFO: epoch 044:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17239.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3196.9, ups=0.19, wpb=17239.5, bsz=1024, num_updates=15820, lr=3.02e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=104448
2024-11-10 11:55:22 - progress_bar.py[line:274] - INFO: epoch 044:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17485.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3325.9, ups=0.19, wpb=17485.6, bsz=1024, num_updates=15830, lr=3.01854e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=104501
2024-11-10 11:56:15 - progress_bar.py[line:274] - INFO: epoch 044:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17313.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3274.1, ups=0.19, wpb=17313.4, bsz=1024, num_updates=15840, lr=3.01709e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104553
2024-11-10 11:57:08 - progress_bar.py[line:274] - INFO: epoch 044:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17221.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3287.9, ups=0.19, wpb=17221.5, bsz=1024, num_updates=15850, lr=3.01564e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=104606
2024-11-10 11:58:01 - progress_bar.py[line:274] - INFO: epoch 044:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17424.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3293.7, ups=0.19, wpb=17424.6, bsz=1024, num_updates=15860, lr=3.01418e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104659
2024-11-10 11:58:54 - progress_bar.py[line:274] - INFO: epoch 044:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17523, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3297.4, ups=0.19, wpb=17523, bsz=1024, num_updates=15870, lr=3.01273e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=104712
2024-11-10 11:59:46 - progress_bar.py[line:274] - INFO: epoch 044:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17548.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3344.4, ups=0.19, wpb=17548.8, bsz=1024, num_updates=15880, lr=3.01128e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=104764
2024-11-10 12:00:39 - progress_bar.py[line:274] - INFO: epoch 044:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17326.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3295.6, ups=0.19, wpb=17326.7, bsz=1024, num_updates=15890, lr=3.00982e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=104817
2024-11-10 12:01:32 - progress_bar.py[line:274] - INFO: epoch 044:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17244.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3233.4, ups=0.19, wpb=17244.2, bsz=1024, num_updates=15900, lr=3.00837e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104870
2024-11-10 12:02:25 - progress_bar.py[line:274] - INFO: epoch 044:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17299.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3297.8, ups=0.19, wpb=17299.9, bsz=1024, num_updates=15910, lr=3.00692e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104923
2024-11-10 12:03:18 - progress_bar.py[line:274] - INFO: epoch 044:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17491, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3281.2, ups=0.19, wpb=17491, bsz=1024, num_updates=15920, lr=3.00546e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=104976
2024-11-10 12:04:11 - progress_bar.py[line:274] - INFO: epoch 044:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17511.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3295.1, ups=0.19, wpb=17511.1, bsz=1024, num_updates=15930, lr=3.00401e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105029
2024-11-10 12:05:05 - progress_bar.py[line:274] - INFO: epoch 044:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17009.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3177, ups=0.19, wpb=17009.2, bsz=1024, num_updates=15940, lr=3.00256e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=105083
2024-11-10 12:05:57 - progress_bar.py[line:274] - INFO: epoch 044:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17588.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3339.2, ups=0.19, wpb=17588.3, bsz=1024, num_updates=15950, lr=3.0011e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=105135
2024-11-10 12:06:49 - progress_bar.py[line:274] - INFO: epoch 044:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17376.5, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3331.5, ups=0.19, wpb=17376.5, bsz=1015.4, num_updates=15960, lr=2.99965e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105188
2024-11-10 12:07:42 - progress_bar.py[line:274] - INFO: epoch 044:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17307.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3278, ups=0.19, wpb=17307.7, bsz=1024, num_updates=15970, lr=2.9982e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=105240
2024-11-10 12:08:35 - progress_bar.py[line:274] - INFO: epoch 044:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17374.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3273.7, ups=0.19, wpb=17374.7, bsz=1024, num_updates=15980, lr=2.99674e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105293
2024-11-10 12:09:28 - progress_bar.py[line:274] - INFO: epoch 044:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17187.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3282.3, ups=0.19, wpb=17187.1, bsz=1024, num_updates=15990, lr=2.99529e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105346
2024-11-10 12:10:21 - progress_bar.py[line:274] - INFO: epoch 044:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17573, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3318.9, ups=0.19, wpb=17573, bsz=1024, num_updates=16000, lr=2.99384e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=105399
2024-11-10 12:11:14 - progress_bar.py[line:274] - INFO: epoch 044:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=16966.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3203.3, ups=0.19, wpb=16966.4, bsz=1024, num_updates=16010, lr=2.99238e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105452
2024-11-10 12:12:06 - progress_bar.py[line:274] - INFO: epoch 044:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17535.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3312.3, ups=0.19, wpb=17535.7, bsz=1024, num_updates=16020, lr=2.99093e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=105505
2024-11-10 12:12:58 - progress_bar.py[line:274] - INFO: epoch 044:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17564.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3401.4, ups=0.19, wpb=17564.1, bsz=1024, num_updates=16030, lr=2.98948e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=105556
2024-11-10 12:13:50 - progress_bar.py[line:274] - INFO: epoch 044:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.884, ntokens=17515.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.38, wps=3362.7, ups=0.19, wpb=17515.1, bsz=1024, num_updates=16040, lr=2.98802e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105608
2024-11-10 12:14:42 - progress_bar.py[line:274] - INFO: epoch 044:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17497.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3376.9, ups=0.19, wpb=17497.5, bsz=1024, num_updates=16050, lr=2.98657e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=105660
2024-11-10 12:15:35 - progress_bar.py[line:274] - INFO: epoch 044:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17516.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3318.7, ups=0.19, wpb=17516.5, bsz=1024, num_updates=16060, lr=2.98512e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=105713
2024-11-10 12:16:27 - progress_bar.py[line:274] - INFO: epoch 044:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.901, ntokens=17656.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.47, wps=3364.7, ups=0.19, wpb=17656.5, bsz=1024, num_updates=16070, lr=2.98366e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=105765
2024-11-10 12:17:21 - progress_bar.py[line:274] - INFO: epoch 044:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17698.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3300.7, ups=0.19, wpb=17698.5, bsz=1024, num_updates=16080, lr=2.98221e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=105819
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 12:17:50 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 44 @ 16086 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
2024-11-10 12:17:50 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 12:19:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
2024-11-10 12:21:36 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 44 @ 16086 updates, score 0) (writing took 226.0656978120096 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_44.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 12:22:32 - train.py[line:336] - INFO: end of epoch 44 (average epoch stats below)
2024-11-10 12:22:32 - progress_bar.py[line:282] - INFO: epoch 044 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.855 | ntokens 17384 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.24 | wps 2693.5 | ups 0.15 | wpb 17384 | bsz 1023.1 | num_updates 16086 | lr 2.98134e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 1136 | gb_free 13.5 | wall 106130
2024-11-10 12:22:32 - trainer.py[line:639] - INFO: loading train data for epoch 45
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 12:25:01 - trainer.py[line:703] - INFO: begin training epoch 45
2024-11-10 12:25:01 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 12:25:24 - progress_bar.py[line:274] - INFO: epoch 045:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=16852.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=348.5, ups=0.02, wpb=16852.8, bsz=998.4, num_updates=16090, lr=2.98076e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=39, gb_free=13.5, wall=106303
2024-11-10 12:26:18 - progress_bar.py[line:274] - INFO: epoch 045:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17301, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3241.1, ups=0.19, wpb=17301, bsz=1024, num_updates=16100, lr=2.9793e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=106356
2024-11-10 12:27:11 - progress_bar.py[line:274] - INFO: epoch 045:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.886, ntokens=17629.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3289.3, ups=0.19, wpb=17629.4, bsz=1024, num_updates=16110, lr=2.97785e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=106410
2024-11-10 12:28:05 - progress_bar.py[line:274] - INFO: epoch 045:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.852, ntokens=17541.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3284.1, ups=0.19, wpb=17541.8, bsz=1024, num_updates=16120, lr=2.9764e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=106463
2024-11-10 12:28:59 - progress_bar.py[line:274] - INFO: epoch 045:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.858, ntokens=17429.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3225.2, ups=0.19, wpb=17429.3, bsz=1024, num_updates=16130, lr=2.97494e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=106517
2024-11-10 12:29:51 - progress_bar.py[line:274] - INFO: epoch 045:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17496.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3330.7, ups=0.19, wpb=17496.5, bsz=1024, num_updates=16140, lr=2.97349e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=33, gb_free=13.2, wall=106570
2024-11-10 12:30:45 - progress_bar.py[line:274] - INFO: epoch 045:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17266.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3237, ups=0.19, wpb=17266.5, bsz=1024, num_updates=16150, lr=2.97204e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=106623
2024-11-10 12:31:38 - progress_bar.py[line:274] - INFO: epoch 045:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17331.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3235.7, ups=0.19, wpb=17331.3, bsz=1024, num_updates=16160, lr=2.97058e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=106676
2024-11-10 12:32:33 - progress_bar.py[line:274] - INFO: epoch 045:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17551.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3224.9, ups=0.18, wpb=17551.3, bsz=1024, num_updates=16170, lr=2.96913e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=106731
2024-11-10 12:33:27 - progress_bar.py[line:274] - INFO: epoch 045:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17064.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3130.5, ups=0.18, wpb=17064.7, bsz=1024, num_updates=16180, lr=2.96768e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=40, gb_free=13.5, wall=106785
2024-11-10 12:34:29 - progress_bar.py[line:274] - INFO: epoch 045:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17555.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=2856.5, ups=0.16, wpb=17555.8, bsz=1024, num_updates=16190, lr=2.96622e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=106847
2024-11-10 12:35:29 - progress_bar.py[line:274] - INFO: epoch 045:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17582.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=2922.2, ups=0.17, wpb=17582.4, bsz=1024, num_updates=16200, lr=2.96477e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=60, gb_free=13.5, wall=106907
2024-11-10 12:36:29 - progress_bar.py[line:274] - INFO: epoch 045:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17320, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=2864.4, ups=0.17, wpb=17320, bsz=1015.4, num_updates=16210, lr=2.96332e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=60, gb_free=13.3, wall=106968
2024-11-10 12:37:29 - progress_bar.py[line:274] - INFO: epoch 045:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17447.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=2922.6, ups=0.17, wpb=17447.8, bsz=1024, num_updates=16220, lr=2.96186e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=60, gb_free=13.5, wall=107027
2024-11-10 12:38:24 - progress_bar.py[line:274] - INFO: epoch 045:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17441.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3145.5, ups=0.18, wpb=17441.5, bsz=1024, num_updates=16230, lr=2.96041e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=107083
2024-11-10 12:39:22 - progress_bar.py[line:274] - INFO: epoch 045:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17321.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3028.8, ups=0.17, wpb=17321.7, bsz=1024, num_updates=16240, lr=2.95896e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=107140
2024-11-10 12:40:19 - progress_bar.py[line:274] - INFO: epoch 045:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17346.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3031.2, ups=0.17, wpb=17346.1, bsz=1024, num_updates=16250, lr=2.9575e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=107197
2024-11-10 12:41:17 - progress_bar.py[line:274] - INFO: epoch 045:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17355.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=2986.5, ups=0.17, wpb=17355.5, bsz=1024, num_updates=16260, lr=2.95605e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=107255
2024-11-10 12:42:13 - progress_bar.py[line:274] - INFO: epoch 045:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.862, ntokens=17372.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3122.2, ups=0.18, wpb=17372.2, bsz=1024, num_updates=16270, lr=2.9546e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=107311
2024-11-10 12:43:07 - progress_bar.py[line:274] - INFO: epoch 045:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17489.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3206, ups=0.18, wpb=17489.9, bsz=1024, num_updates=16280, lr=2.95314e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=107365
2024-11-10 12:44:02 - progress_bar.py[line:274] - INFO: epoch 045:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17375.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3153.9, ups=0.18, wpb=17375.7, bsz=1024, num_updates=16290, lr=2.95169e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=107420
2024-11-10 12:44:58 - progress_bar.py[line:274] - INFO: epoch 045:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17320.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3092.1, ups=0.18, wpb=17320.5, bsz=1024, num_updates=16300, lr=2.95024e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13, wall=107476
2024-11-10 12:45:55 - progress_bar.py[line:274] - INFO: epoch 045:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17514.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3100.1, ups=0.18, wpb=17514.9, bsz=1024, num_updates=16310, lr=2.94879e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=107533
2024-11-10 12:46:51 - progress_bar.py[line:274] - INFO: epoch 045:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17695.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3137.1, ups=0.18, wpb=17695.2, bsz=1024, num_updates=16320, lr=2.94733e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=107589
2024-11-10 12:47:47 - progress_bar.py[line:274] - INFO: epoch 045:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17424.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3106.4, ups=0.18, wpb=17424.4, bsz=1024, num_updates=16330, lr=2.94588e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=107645
2024-11-10 12:48:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 12:48:48 - progress_bar.py[line:274] - INFO: epoch 045:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17357.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=2880.3, ups=0.17, wpb=17357.9, bsz=1024, num_updates=16340, lr=2.94443e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=107706
2024-11-10 12:49:40 - progress_bar.py[line:274] - INFO: epoch 045:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17267.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3321.9, ups=0.19, wpb=17267.4, bsz=1024, num_updates=16350, lr=2.94297e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=107758
2024-11-10 12:50:31 - progress_bar.py[line:274] - INFO: epoch 045:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17379.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3357, ups=0.19, wpb=17379.3, bsz=1024, num_updates=16360, lr=2.94152e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=107810
2024-11-10 12:51:23 - progress_bar.py[line:274] - INFO: epoch 045:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17336.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3345.3, ups=0.19, wpb=17336.7, bsz=1024, num_updates=16370, lr=2.94007e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=41, gb_free=13.5, wall=107861
2024-11-10 12:52:16 - progress_bar.py[line:274] - INFO: epoch 045:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17337.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3271.1, ups=0.19, wpb=17337.7, bsz=1024, num_updates=16380, lr=2.93861e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=107914
2024-11-10 12:53:08 - progress_bar.py[line:274] - INFO: epoch 045:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17668.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3375.6, ups=0.19, wpb=17668.2, bsz=1024, num_updates=16390, lr=2.93716e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=107967
2024-11-10 12:54:00 - progress_bar.py[line:274] - INFO: epoch 045:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.86, ntokens=17524.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3386.2, ups=0.19, wpb=17524.8, bsz=1024, num_updates=16400, lr=2.93571e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=108018
2024-11-10 12:54:56 - progress_bar.py[line:274] - INFO: epoch 045:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.904, ntokens=17863.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.48, wps=3226.7, ups=0.18, wpb=17863.5, bsz=1024, num_updates=16410, lr=2.93425e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=41, gb_free=13.4, wall=108074
2024-11-10 12:55:52 - progress_bar.py[line:274] - INFO: epoch 045:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17397, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3092.7, ups=0.18, wpb=17397, bsz=1024, num_updates=16420, lr=2.9328e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=108130
2024-11-10 12:56:47 - progress_bar.py[line:274] - INFO: epoch 045:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17598.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3212.2, ups=0.18, wpb=17598.2, bsz=1024, num_updates=16430, lr=2.93135e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=108185
2024-11-10 12:57:40 - progress_bar.py[line:274] - INFO: epoch 045:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.862, ntokens=17628.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3304.3, ups=0.19, wpb=17628.6, bsz=1024, num_updates=16440, lr=2.92989e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=108238
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 12:58:35 - progress_bar.py[line:274] - INFO: epoch 045:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.906, ntokens=17801.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.49, wps=3208.7, ups=0.18, wpb=17801.3, bsz=1024, num_updates=16450, lr=2.92844e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=108294
2024-11-10 12:58:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 45 @ 16451 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
2024-11-10 12:58:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 13:00:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
2024-11-10 13:02:26 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 45 @ 16451 updates, score 0) (writing took 227.46338710503187 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_45.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-10 13:03:23 - train.py[line:336] - INFO: end of epoch 45 (average epoch stats below)
2024-11-10 13:03:23 - progress_bar.py[line:282] - INFO: epoch 045 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.857 | ntokens 17441.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.25 | wps 2597.2 | ups 0.15 | wpb 17441.7 | bsz 1023.1 | num_updates 16451 | lr 2.92829e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 1715 | gb_free 13.5 | wall 108581
2024-11-10 13:03:23 - trainer.py[line:639] - INFO: loading train data for epoch 46
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 13:05:52 - trainer.py[line:703] - INFO: begin training epoch 46
2024-11-10 13:05:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 13:06:44 - progress_bar.py[line:274] - INFO: epoch 046:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17062.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=349.5, ups=0.02, wpb=17062.7, bsz=998.4, num_updates=16460, lr=2.92699e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=32, gb_free=13.3, wall=108782
2024-11-10 13:07:43 - progress_bar.py[line:274] - INFO: epoch 046:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17171.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=2869.8, ups=0.17, wpb=17171.2, bsz=1024, num_updates=16470, lr=2.92553e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=108842
2024-11-10 13:08:43 - progress_bar.py[line:274] - INFO: epoch 046:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17374.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=2909.2, ups=0.17, wpb=17374.3, bsz=1024, num_updates=16480, lr=2.92408e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.3, wall=108901
2024-11-10 13:09:44 - progress_bar.py[line:274] - INFO: epoch 046:     39 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17603, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=2917.7, ups=0.17, wpb=17603, bsz=1024, num_updates=16490, lr=2.92263e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=108962
2024-11-10 13:10:44 - progress_bar.py[line:274] - INFO: epoch 046:     49 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17426.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=2868, ups=0.16, wpb=17426.8, bsz=1024, num_updates=16500, lr=2.92117e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=61, gb_free=13.4, wall=109022
2024-11-10 13:11:44 - progress_bar.py[line:274] - INFO: epoch 046:     59 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17209.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=2860.3, ups=0.17, wpb=17209.7, bsz=1024, num_updates=16510, lr=2.91972e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=109083
2024-11-10 13:12:44 - progress_bar.py[line:274] - INFO: epoch 046:     69 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17299, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=2904.6, ups=0.17, wpb=17299, bsz=1024, num_updates=16520, lr=2.91827e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=109142
2024-11-10 13:13:45 - progress_bar.py[line:274] - INFO: epoch 046:     79 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17529.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=2886.9, ups=0.16, wpb=17529.9, bsz=1024, num_updates=16530, lr=2.91681e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=61, gb_free=13.3, wall=109203
2024-11-10 13:14:44 - progress_bar.py[line:274] - INFO: epoch 046:     89 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17546.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=2951.1, ups=0.17, wpb=17546.9, bsz=1024, num_updates=16540, lr=2.91536e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=109262
2024-11-10 13:15:44 - progress_bar.py[line:274] - INFO: epoch 046:     99 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17385.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=2916.4, ups=0.17, wpb=17385.8, bsz=1024, num_updates=16550, lr=2.91391e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=60, gb_free=13.5, wall=109322
2024-11-10 13:16:44 - progress_bar.py[line:274] - INFO: epoch 046:    109 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17436, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=2899.9, ups=0.17, wpb=17436, bsz=1024, num_updates=16560, lr=2.91245e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=109382
2024-11-10 13:17:43 - progress_bar.py[line:274] - INFO: epoch 046:    119 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17109.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=2911.4, ups=0.17, wpb=17109.6, bsz=1015.4, num_updates=16570, lr=2.911e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=109441
2024-11-10 13:18:40 - progress_bar.py[line:274] - INFO: epoch 046:    129 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17226.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=2990.5, ups=0.17, wpb=17226.7, bsz=1024, num_updates=16580, lr=2.90955e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=109499
2024-11-10 13:19:32 - progress_bar.py[line:274] - INFO: epoch 046:    139 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17336.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3370.7, ups=0.19, wpb=17336.7, bsz=1024, num_updates=16590, lr=2.90809e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=50, gb_free=13.3, wall=109550
2024-11-10 13:20:27 - progress_bar.py[line:274] - INFO: epoch 046:    149 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.887, ntokens=17648.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3165.6, ups=0.18, wpb=17648.6, bsz=1024, num_updates=16600, lr=2.90664e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=109606
2024-11-10 13:21:24 - progress_bar.py[line:274] - INFO: epoch 046:    159 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17297.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3051, ups=0.18, wpb=17297.3, bsz=1024, num_updates=16610, lr=2.90519e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=109662
2024-11-10 13:22:22 - progress_bar.py[line:274] - INFO: epoch 046:    169 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17183.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=2986.8, ups=0.17, wpb=17183.4, bsz=1024, num_updates=16620, lr=2.90373e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=109720
2024-11-10 13:23:20 - progress_bar.py[line:274] - INFO: epoch 046:    179 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17546.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3004.6, ups=0.17, wpb=17546.9, bsz=1024, num_updates=16630, lr=2.90228e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=109778
2024-11-10 13:24:17 - progress_bar.py[line:274] - INFO: epoch 046:    189 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17217, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3017.9, ups=0.18, wpb=17217, bsz=1024, num_updates=16640, lr=2.90083e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=109835
2024-11-10 13:25:11 - progress_bar.py[line:274] - INFO: epoch 046:    199 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17264.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3190.7, ups=0.18, wpb=17264.5, bsz=1024, num_updates=16650, lr=2.89937e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=109889
2024-11-10 13:26:04 - progress_bar.py[line:274] - INFO: epoch 046:    209 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17290, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3276.1, ups=0.19, wpb=17290, bsz=1024, num_updates=16660, lr=2.89792e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=109942
2024-11-10 13:26:57 - progress_bar.py[line:274] - INFO: epoch 046:    219 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3251.5, ups=0.19, wpb=17269.4, bsz=1024, num_updates=16670, lr=2.89647e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=109995
2024-11-10 13:27:51 - progress_bar.py[line:274] - INFO: epoch 046:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17082, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3195.2, ups=0.19, wpb=17082, bsz=1024, num_updates=16680, lr=2.89501e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=110049
2024-11-10 13:28:45 - progress_bar.py[line:274] - INFO: epoch 046:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17344, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3169.6, ups=0.18, wpb=17344, bsz=1024, num_updates=16690, lr=2.89356e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=44, gb_free=13.2, wall=110104
2024-11-10 13:29:39 - progress_bar.py[line:274] - INFO: epoch 046:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17426.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3218.8, ups=0.18, wpb=17426.7, bsz=1024, num_updates=16700, lr=2.89211e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.2, wall=110158
2024-11-10 13:30:33 - progress_bar.py[line:274] - INFO: epoch 046:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17413.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3264.2, ups=0.19, wpb=17413.7, bsz=1024, num_updates=16710, lr=2.89065e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=110211
2024-11-10 13:31:27 - progress_bar.py[line:274] - INFO: epoch 046:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17534.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3256.8, ups=0.19, wpb=17534.8, bsz=1024, num_updates=16720, lr=2.8892e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=110265
2024-11-10 13:32:19 - progress_bar.py[line:274] - INFO: epoch 046:    279 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17443.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3309.1, ups=0.19, wpb=17443.9, bsz=1024, num_updates=16730, lr=2.88775e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=110318
2024-11-10 13:33:13 - progress_bar.py[line:274] - INFO: epoch 046:    289 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17386.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3233.6, ups=0.19, wpb=17386.4, bsz=1024, num_updates=16740, lr=2.88629e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=110371
2024-11-10 13:34:07 - progress_bar.py[line:274] - INFO: epoch 046:    299 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17323.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3230.1, ups=0.19, wpb=17323.8, bsz=1024, num_updates=16750, lr=2.88484e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=110425
2024-11-10 13:35:00 - progress_bar.py[line:274] - INFO: epoch 046:    309 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17373, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3284.9, ups=0.19, wpb=17373, bsz=1024, num_updates=16760, lr=2.88339e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=110478
2024-11-10 13:35:52 - progress_bar.py[line:274] - INFO: epoch 046:    319 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.878, ntokens=17606.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.35, wps=3335.6, ups=0.19, wpb=17606.9, bsz=1024, num_updates=16770, lr=2.88193e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=110531
2024-11-10 13:36:46 - progress_bar.py[line:274] - INFO: epoch 046:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17677.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3332.5, ups=0.19, wpb=17677.1, bsz=1024, num_updates=16780, lr=2.88048e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=110584
2024-11-10 13:37:38 - progress_bar.py[line:274] - INFO: epoch 046:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17458, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3347.7, ups=0.19, wpb=17458, bsz=1024, num_updates=16790, lr=2.87903e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=110636
2024-11-10 13:38:31 - progress_bar.py[line:274] - INFO: epoch 046:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17482.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3288.9, ups=0.19, wpb=17482.2, bsz=1024, num_updates=16800, lr=2.87757e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=110689
2024-11-10 13:39:23 - progress_bar.py[line:274] - INFO: epoch 046:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17631.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.22, wps=3371.6, ups=0.19, wpb=17631.5, bsz=1024, num_updates=16810, lr=2.87612e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=110741
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 13:39:58 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 46 @ 16817 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
2024-11-10 13:39:58 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 13:41:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-10 13:43:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 46 @ 16817 updates, score 0) (writing took 219.74705487902975 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_46.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
2024-11-10 13:44:33 - train.py[line:336] - INFO: end of epoch 46 (average epoch stats below)
2024-11-10 13:44:33 - progress_bar.py[line:282] - INFO: epoch 046 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.844 | ntokens 17378.1 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.18 | wps 2574.7 | ups 0.15 | wpb 17378.1 | bsz 1023.1 | num_updates 16817 | lr 2.8751e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1776 | gb_free 13.5 | wall 111052
2024-11-10 13:44:33 - trainer.py[line:639] - INFO: loading train data for epoch 47
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 13:47:05 - trainer.py[line:703] - INFO: begin training epoch 47
2024-11-10 13:47:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 13:47:23 - progress_bar.py[line:274] - INFO: epoch 047:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=16977.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=353.6, ups=0.02, wpb=16977.5, bsz=998.4, num_updates=16820, lr=2.87467e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=44, gb_free=13.4, wall=111222
2024-11-10 13:48:17 - progress_bar.py[line:274] - INFO: epoch 047:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.862, ntokens=17618.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3301, ups=0.19, wpb=17618.2, bsz=1024, num_updates=16830, lr=2.87321e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=111275
2024-11-10 13:49:10 - progress_bar.py[line:274] - INFO: epoch 047:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.895, ntokens=17788.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3328.7, ups=0.19, wpb=17788.9, bsz=1024, num_updates=16840, lr=2.87176e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=111328
2024-11-10 13:50:05 - progress_bar.py[line:274] - INFO: epoch 047:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17782.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3245.6, ups=0.18, wpb=17782.3, bsz=1024, num_updates=16850, lr=2.87031e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111383
2024-11-10 13:50:15 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 13:51:03 - progress_bar.py[line:274] - INFO: epoch 047:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17515.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3031.6, ups=0.17, wpb=17515.4, bsz=1024, num_updates=16860, lr=2.86885e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=111441
2024-11-10 13:51:56 - progress_bar.py[line:274] - INFO: epoch 047:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17393.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3271.7, ups=0.19, wpb=17393.9, bsz=1024, num_updates=16870, lr=2.8674e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=111494
2024-11-10 13:52:48 - progress_bar.py[line:274] - INFO: epoch 047:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.891, ntokens=17667.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=3360.9, ups=0.19, wpb=17667.1, bsz=1024, num_updates=16880, lr=2.86595e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=111547
2024-11-10 13:53:41 - progress_bar.py[line:274] - INFO: epoch 047:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17157.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3257.2, ups=0.19, wpb=17157.3, bsz=1024, num_updates=16890, lr=2.86449e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111599
2024-11-10 13:54:34 - progress_bar.py[line:274] - INFO: epoch 047:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17407.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3294.1, ups=0.19, wpb=17407.2, bsz=1024, num_updates=16900, lr=2.86304e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111652
2024-11-10 13:55:27 - progress_bar.py[line:274] - INFO: epoch 047:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.871, ntokens=17665.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.32, wps=3339, ups=0.19, wpb=17665.2, bsz=1024, num_updates=16910, lr=2.86159e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111705
2024-11-10 13:56:20 - progress_bar.py[line:274] - INFO: epoch 047:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17427.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3293.3, ups=0.19, wpb=17427.6, bsz=1024, num_updates=16920, lr=2.86013e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111758
2024-11-10 13:57:12 - progress_bar.py[line:274] - INFO: epoch 047:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17299, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3287.5, ups=0.19, wpb=17299, bsz=1015.4, num_updates=16930, lr=2.85868e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=111811
2024-11-10 13:58:05 - progress_bar.py[line:274] - INFO: epoch 047:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17427.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3294.9, ups=0.19, wpb=17427.9, bsz=1024, num_updates=16940, lr=2.85723e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=111863
2024-11-10 13:58:58 - progress_bar.py[line:274] - INFO: epoch 047:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17389, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3312.7, ups=0.19, wpb=17389, bsz=1024, num_updates=16950, lr=2.85577e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111916
2024-11-10 13:59:51 - progress_bar.py[line:274] - INFO: epoch 047:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17518.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3270.1, ups=0.19, wpb=17518.1, bsz=1024, num_updates=16960, lr=2.85432e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=111970
2024-11-10 14:00:44 - progress_bar.py[line:274] - INFO: epoch 047:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17174.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3240.8, ups=0.19, wpb=17174.3, bsz=1024, num_updates=16970, lr=2.85287e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=112023
2024-11-10 14:01:38 - progress_bar.py[line:274] - INFO: epoch 047:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17275.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3243.9, ups=0.19, wpb=17275.7, bsz=1024, num_updates=16980, lr=2.85141e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=112076
2024-11-10 14:02:30 - progress_bar.py[line:274] - INFO: epoch 047:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17278, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3296.6, ups=0.19, wpb=17278, bsz=1024, num_updates=16990, lr=2.84996e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=112128
2024-11-10 14:03:24 - progress_bar.py[line:274] - INFO: epoch 047:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17372.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3237.4, ups=0.19, wpb=17372.2, bsz=1024, num_updates=17000, lr=2.84851e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=112182
2024-11-10 14:04:17 - progress_bar.py[line:274] - INFO: epoch 047:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17305.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3265.8, ups=0.19, wpb=17305.8, bsz=1024, num_updates=17010, lr=2.84705e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=39, gb_free=13.4, wall=112235
2024-11-10 14:05:09 - progress_bar.py[line:274] - INFO: epoch 047:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17295.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3285, ups=0.19, wpb=17295.1, bsz=1024, num_updates=17020, lr=2.8456e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=38, gb_free=13.4, wall=112288
2024-11-10 14:06:02 - progress_bar.py[line:274] - INFO: epoch 047:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17467.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3331.1, ups=0.19, wpb=17467.2, bsz=1024, num_updates=17030, lr=2.84415e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=33, gb_free=13.5, wall=112340
2024-11-10 14:06:54 - progress_bar.py[line:274] - INFO: epoch 047:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17440.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3323.1, ups=0.19, wpb=17440.4, bsz=1024, num_updates=17040, lr=2.84269e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=112392
2024-11-10 14:07:47 - progress_bar.py[line:274] - INFO: epoch 047:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17509.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3300.2, ups=0.19, wpb=17509.4, bsz=1024, num_updates=17050, lr=2.84124e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=112445
2024-11-10 14:08:41 - progress_bar.py[line:274] - INFO: epoch 047:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.889, ntokens=17532.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.41, wps=3281.8, ups=0.19, wpb=17532.9, bsz=1024, num_updates=17060, lr=2.83979e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=112499
2024-11-10 14:09:33 - progress_bar.py[line:274] - INFO: epoch 047:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17521.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3321.3, ups=0.19, wpb=17521.7, bsz=1024, num_updates=17070, lr=2.83833e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=112552
2024-11-10 14:10:27 - progress_bar.py[line:274] - INFO: epoch 047:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17275.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3237.7, ups=0.19, wpb=17275.1, bsz=1024, num_updates=17080, lr=2.83688e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=112605
2024-11-10 14:11:20 - progress_bar.py[line:274] - INFO: epoch 047:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17316.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3277.1, ups=0.19, wpb=17316.3, bsz=1024, num_updates=17090, lr=2.83543e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=112658
2024-11-10 14:12:12 - progress_bar.py[line:274] - INFO: epoch 047:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17196.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3272.7, ups=0.19, wpb=17196.9, bsz=1024, num_updates=17100, lr=2.83397e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=112710
2024-11-10 14:13:06 - progress_bar.py[line:274] - INFO: epoch 047:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=16986.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3184.5, ups=0.19, wpb=16986.4, bsz=1024, num_updates=17110, lr=2.83252e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=112764
2024-11-10 14:13:58 - progress_bar.py[line:274] - INFO: epoch 047:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.881, ntokens=17784.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3395.5, ups=0.19, wpb=17784.8, bsz=1024, num_updates=17120, lr=2.83107e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=112816
2024-11-10 14:14:51 - progress_bar.py[line:274] - INFO: epoch 047:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.855, ntokens=17511.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3303.2, ups=0.19, wpb=17511.7, bsz=1024, num_updates=17130, lr=2.82961e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=36, gb_free=13.4, wall=112869
2024-11-10 14:15:45 - progress_bar.py[line:274] - INFO: epoch 047:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17538.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3274.7, ups=0.19, wpb=17538.2, bsz=1024, num_updates=17140, lr=2.82816e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=51, gb_free=13.5, wall=112923
2024-11-10 14:16:38 - progress_bar.py[line:274] - INFO: epoch 047:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17608.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3290.9, ups=0.19, wpb=17608.7, bsz=1024, num_updates=17150, lr=2.82671e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=112976
2024-11-10 14:17:31 - progress_bar.py[line:274] - INFO: epoch 047:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17245.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3225.9, ups=0.19, wpb=17245.3, bsz=1024, num_updates=17160, lr=2.82525e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=113030
2024-11-10 14:18:24 - progress_bar.py[line:274] - INFO: epoch 047:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.868, ntokens=17556.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3335.5, ups=0.19, wpb=17556.1, bsz=1024, num_updates=17170, lr=2.8238e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=113082
2024-11-10 14:19:16 - progress_bar.py[line:274] - INFO: epoch 047:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17456.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3335.3, ups=0.19, wpb=17456.7, bsz=1024, num_updates=17180, lr=2.82235e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.2, wall=113135
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 14:19:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 47 @ 17182 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt

2024-11-10 14:19:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 14:21:13 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
2024-11-10 14:23:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 47 @ 17182 updates, score 0) (writing took 221.5078481460223 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_47.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 14:24:01 - train.py[line:336] - INFO: end of epoch 47 (average epoch stats below)
2024-11-10 14:24:01 - progress_bar.py[line:282] - INFO: epoch 047 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.844 | ntokens 17424.8 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.18 | wps 2685.8 | ups 0.15 | wpb 17424.8 | bsz 1023.1 | num_updates 17182 | lr 2.82206e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1247 | gb_free 13.4 | wall 113420
2024-11-10 14:24:01 - trainer.py[line:639] - INFO: loading train data for epoch 48
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 14:26:31 - trainer.py[line:703] - INFO: begin training epoch 48
2024-11-10 14:26:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 14:27:15 - progress_bar.py[line:274] - INFO: epoch 048:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17005.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=355.3, ups=0.02, wpb=17005.8, bsz=998.4, num_updates=17190, lr=2.82089e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=32, gb_free=13.3, wall=113613
2024-11-10 14:28:09 - progress_bar.py[line:274] - INFO: epoch 048:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17217.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3198.4, ups=0.19, wpb=17217.4, bsz=1024, num_updates=17200, lr=2.81944e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=113667
2024-11-10 14:29:04 - progress_bar.py[line:274] - INFO: epoch 048:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17628.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3204.5, ups=0.18, wpb=17628.6, bsz=1024, num_updates=17210, lr=2.81799e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=113722
2024-11-10 14:29:58 - progress_bar.py[line:274] - INFO: epoch 048:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17465.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3245.1, ups=0.19, wpb=17465.9, bsz=1024, num_updates=17220, lr=2.81653e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=113776
2024-11-10 14:30:51 - progress_bar.py[line:274] - INFO: epoch 048:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17332.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3248.8, ups=0.19, wpb=17332.7, bsz=1024, num_updates=17230, lr=2.81508e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=113829
2024-11-10 14:31:44 - progress_bar.py[line:274] - INFO: epoch 048:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17521.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3317.8, ups=0.19, wpb=17521.9, bsz=1024, num_updates=17240, lr=2.81363e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=113882
2024-11-10 14:32:37 - progress_bar.py[line:274] - INFO: epoch 048:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17327.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3277.2, ups=0.19, wpb=17327.9, bsz=1024, num_updates=17250, lr=2.81217e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=113935
2024-11-10 14:33:30 - progress_bar.py[line:274] - INFO: epoch 048:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17360.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3290.8, ups=0.19, wpb=17360.3, bsz=1024, num_updates=17260, lr=2.81072e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=113988
2024-11-10 14:34:22 - progress_bar.py[line:274] - INFO: epoch 048:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17606.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3347.5, ups=0.19, wpb=17606.5, bsz=1024, num_updates=17270, lr=2.80927e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=114040
2024-11-10 14:35:15 - progress_bar.py[line:274] - INFO: epoch 048:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17340.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3263.1, ups=0.19, wpb=17340.6, bsz=1024, num_updates=17280, lr=2.80781e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=114093
2024-11-10 14:36:08 - progress_bar.py[line:274] - INFO: epoch 048:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17411.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3307.1, ups=0.19, wpb=17411.1, bsz=1024, num_updates=17290, lr=2.80636e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=114146
2024-11-10 14:37:01 - progress_bar.py[line:274] - INFO: epoch 048:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.864, ntokens=17700.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.28, wps=3361.1, ups=0.19, wpb=17700.8, bsz=1024, num_updates=17300, lr=2.80491e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=114199
2024-11-10 14:37:53 - progress_bar.py[line:274] - INFO: epoch 048:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17202.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3261.9, ups=0.19, wpb=17202.8, bsz=1024, num_updates=17310, lr=2.80345e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=114251
2024-11-10 14:38:47 - progress_bar.py[line:274] - INFO: epoch 048:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17326.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3254.4, ups=0.19, wpb=17326.7, bsz=1024, num_updates=17320, lr=2.802e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=114305
2024-11-10 14:39:39 - progress_bar.py[line:274] - INFO: epoch 048:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17567.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3356.5, ups=0.19, wpb=17567.4, bsz=1024, num_updates=17330, lr=2.80055e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=114357
2024-11-10 14:40:32 - progress_bar.py[line:274] - INFO: epoch 048:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17196, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3250.7, ups=0.19, wpb=17196, bsz=1015.4, num_updates=17340, lr=2.79909e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13, wall=114410
2024-11-10 14:41:28 - progress_bar.py[line:274] - INFO: epoch 048:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17350.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3105.4, ups=0.18, wpb=17350.2, bsz=1024, num_updates=17350, lr=2.79764e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=41, gb_free=13.4, wall=114466
2024-11-10 14:42:22 - progress_bar.py[line:274] - INFO: epoch 048:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17421.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3180.5, ups=0.18, wpb=17421.9, bsz=1024, num_updates=17360, lr=2.79619e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=114521
2024-11-10 14:43:16 - progress_bar.py[line:274] - INFO: epoch 048:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17127.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3190.7, ups=0.19, wpb=17127.5, bsz=1024, num_updates=17370, lr=2.79473e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=114574
2024-11-10 14:44:08 - progress_bar.py[line:274] - INFO: epoch 048:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17606.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3411.3, ups=0.19, wpb=17606.8, bsz=1024, num_updates=17380, lr=2.79328e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.5, wall=114626
2024-11-10 14:45:00 - progress_bar.py[line:274] - INFO: epoch 048:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17182.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3283, ups=0.19, wpb=17182.5, bsz=1024, num_updates=17390, lr=2.79183e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=114678
2024-11-10 14:45:52 - progress_bar.py[line:274] - INFO: epoch 048:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17372.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3313.2, ups=0.19, wpb=17372.5, bsz=1024, num_updates=17400, lr=2.79037e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=114731
2024-11-10 14:46:45 - progress_bar.py[line:274] - INFO: epoch 048:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17486.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3348.5, ups=0.19, wpb=17486.6, bsz=1024, num_updates=17410, lr=2.78892e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=50, gb_free=13.4, wall=114783
2024-11-10 14:47:37 - progress_bar.py[line:274] - INFO: epoch 048:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17375.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3341.4, ups=0.19, wpb=17375.6, bsz=1024, num_updates=17420, lr=2.78747e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=46, gb_free=13.2, wall=114835
2024-11-10 14:48:29 - progress_bar.py[line:274] - INFO: epoch 048:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.843, ntokens=17344.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3310.6, ups=0.19, wpb=17344.8, bsz=1024, num_updates=17430, lr=2.78601e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=39, gb_free=13.5, wall=114887
2024-11-10 14:49:21 - progress_bar.py[line:274] - INFO: epoch 048:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17342.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3317, ups=0.19, wpb=17342.5, bsz=1024, num_updates=17440, lr=2.78456e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=38, gb_free=13.5, wall=114940
2024-11-10 14:50:15 - progress_bar.py[line:274] - INFO: epoch 048:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17333.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3248.7, ups=0.19, wpb=17333.7, bsz=1024, num_updates=17450, lr=2.78311e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=35, gb_free=13.5, wall=114993
2024-11-10 14:51:07 - progress_bar.py[line:274] - INFO: epoch 048:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17214.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3289.5, ups=0.19, wpb=17214.1, bsz=1024, num_updates=17460, lr=2.78165e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=37, gb_free=13.4, wall=115045
2024-11-10 14:52:00 - progress_bar.py[line:274] - INFO: epoch 048:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17390.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3270.4, ups=0.19, wpb=17390.3, bsz=1024, num_updates=17470, lr=2.7802e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=115098
2024-11-10 14:52:54 - progress_bar.py[line:274] - INFO: epoch 048:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17199.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3210, ups=0.19, wpb=17199.3, bsz=1024, num_updates=17480, lr=2.77875e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=115152
2024-11-10 14:53:46 - progress_bar.py[line:274] - INFO: epoch 048:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17499.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3370.2, ups=0.19, wpb=17499.1, bsz=1024, num_updates=17490, lr=2.77729e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=115204
2024-11-10 14:54:38 - progress_bar.py[line:274] - INFO: epoch 048:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17583.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3366.5, ups=0.19, wpb=17583.7, bsz=1024, num_updates=17500, lr=2.77584e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=115256
2024-11-10 14:55:30 - progress_bar.py[line:274] - INFO: epoch 048:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17400.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3333.2, ups=0.19, wpb=17400.4, bsz=1024, num_updates=17510, lr=2.77439e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=32, gb_free=13.4, wall=115308
2024-11-10 14:56:22 - progress_bar.py[line:274] - INFO: epoch 048:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17514.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3354.3, ups=0.19, wpb=17514.6, bsz=1024, num_updates=17520, lr=2.77293e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=38, gb_free=13.4, wall=115361
2024-11-10 14:57:15 - progress_bar.py[line:274] - INFO: epoch 048:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.87, ntokens=17620.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.31, wps=3354.8, ups=0.19, wpb=17620.7, bsz=1024, num_updates=17530, lr=2.77148e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=43, gb_free=13.3, wall=115413
2024-11-10 14:58:07 - progress_bar.py[line:274] - INFO: epoch 048:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.894, ntokens=17821.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.44, wps=3396.7, ups=0.19, wpb=17821.4, bsz=1024, num_updates=17540, lr=2.77003e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=49, gb_free=13.2, wall=115466
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 14:58:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 48 @ 17548 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
2024-11-10 14:58:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt': File exists
: File exists
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 15:00:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
2024-11-10 15:02:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 48 @ 17548 updates, score 0) (writing took 222.345642536995 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_48.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
2024-11-10 15:03:26 - train.py[line:336] - INFO: end of epoch 48 (average epoch stats below)
2024-11-10 15:03:26 - progress_bar.py[line:282] - INFO: epoch 048 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.835 | ntokens 17404.3 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.14 | wps 2694.5 | ups 0.15 | wpb 17404.3 | bsz 1023.1 | num_updates 17548 | lr 2.76886e-05 | gnorm 0.005 | clip 0 | loss_scale 262144 | train_wall 1352 | gb_free 13.5 | wall 115784
2024-11-10 15:03:26 - trainer.py[line:639] - INFO: loading train data for epoch 49
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 15:05:55 - trainer.py[line:703] - INFO: begin training epoch 49
2024-11-10 15:05:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 15:06:07 - progress_bar.py[line:274] - INFO: epoch 049:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17153.6, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=357.3, ups=0.02, wpb=17153.6, bsz=998.4, num_updates=17550, lr=2.76857e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=46, gb_free=13.5, wall=115946
2024-11-10 15:07:01 - progress_bar.py[line:274] - INFO: epoch 049:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17053.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3179.4, ups=0.19, wpb=17053.4, bsz=1024, num_updates=17560, lr=2.76712e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=115999
2024-11-10 15:07:55 - progress_bar.py[line:274] - INFO: epoch 049:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17249.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3184.9, ups=0.18, wpb=17249.6, bsz=1024, num_updates=17570, lr=2.76567e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=116053
2024-11-10 15:08:49 - progress_bar.py[line:274] - INFO: epoch 049:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17535.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3246.6, ups=0.19, wpb=17535.9, bsz=1024, num_updates=17580, lr=2.76421e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=116107
2024-11-10 15:09:42 - progress_bar.py[line:274] - INFO: epoch 049:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17489.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3289.6, ups=0.19, wpb=17489.6, bsz=1024, num_updates=17590, lr=2.76276e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=116161
2024-11-10 15:10:35 - progress_bar.py[line:274] - INFO: epoch 049:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17457.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3296.5, ups=0.19, wpb=17457.3, bsz=1024, num_updates=17600, lr=2.76131e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=116214
2024-11-10 15:11:29 - progress_bar.py[line:274] - INFO: epoch 049:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17510.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3289.8, ups=0.19, wpb=17510.8, bsz=1024, num_updates=17610, lr=2.75985e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=116267
2024-11-10 15:12:16 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 15:12:26 - progress_bar.py[line:274] - INFO: epoch 049:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17316.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2993.4, ups=0.17, wpb=17316.1, bsz=1024, num_updates=17620, lr=2.7584e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=33, gb_free=13.4, wall=116325
2024-11-10 15:13:20 - progress_bar.py[line:274] - INFO: epoch 049:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17451.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3261, ups=0.19, wpb=17451.7, bsz=1024, num_updates=17630, lr=2.75695e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=116378
2024-11-10 15:14:13 - progress_bar.py[line:274] - INFO: epoch 049:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17522.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3277.1, ups=0.19, wpb=17522.4, bsz=1024, num_updates=17640, lr=2.75549e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=116432
2024-11-10 15:15:07 - progress_bar.py[line:274] - INFO: epoch 049:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.888, ntokens=17695.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.4, wps=3293, ups=0.19, wpb=17695.2, bsz=1024, num_updates=17650, lr=2.75404e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=116485
2024-11-10 15:16:01 - progress_bar.py[line:274] - INFO: epoch 049:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17592.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3249.3, ups=0.18, wpb=17592.4, bsz=1024, num_updates=17660, lr=2.75259e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=116540
2024-11-10 15:16:55 - progress_bar.py[line:274] - INFO: epoch 049:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17415.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3262.7, ups=0.19, wpb=17415.5, bsz=1024, num_updates=17670, lr=2.75113e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=116593
2024-11-10 15:17:51 - progress_bar.py[line:274] - INFO: epoch 049:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17397.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3084.8, ups=0.18, wpb=17397.6, bsz=1024, num_updates=17680, lr=2.74968e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=43, gb_free=13.3, wall=116649
2024-11-10 15:18:46 - progress_bar.py[line:274] - INFO: epoch 049:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17350.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3164.8, ups=0.18, wpb=17350.7, bsz=1024, num_updates=17690, lr=2.74823e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=116704
2024-11-10 15:19:38 - progress_bar.py[line:274] - INFO: epoch 049:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17599, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3367.5, ups=0.19, wpb=17599, bsz=1024, num_updates=17700, lr=2.74677e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=52, gb_free=13.2, wall=116756
2024-11-10 15:20:31 - progress_bar.py[line:274] - INFO: epoch 049:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17215.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3265.8, ups=0.19, wpb=17215.2, bsz=1024, num_updates=17710, lr=2.74532e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=116809
2024-11-10 15:21:26 - progress_bar.py[line:274] - INFO: epoch 049:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17553.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3201.3, ups=0.18, wpb=17553.2, bsz=1024, num_updates=17720, lr=2.74387e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=53, gb_free=13.2, wall=116864
2024-11-10 15:22:18 - progress_bar.py[line:274] - INFO: epoch 049:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.84, ntokens=17455.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3340.8, ups=0.19, wpb=17455.2, bsz=1024, num_updates=17730, lr=2.74241e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=47, gb_free=13.6, wall=116916
2024-11-10 15:23:11 - progress_bar.py[line:274] - INFO: epoch 049:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17393.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3294.3, ups=0.19, wpb=17393.3, bsz=1024, num_updates=17740, lr=2.74096e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=33, gb_free=13.3, wall=116969
2024-11-10 15:24:04 - progress_bar.py[line:274] - INFO: epoch 049:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17382.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3262.7, ups=0.19, wpb=17382.2, bsz=1024, num_updates=17750, lr=2.73951e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.1, wall=117022
2024-11-10 15:24:58 - progress_bar.py[line:274] - INFO: epoch 049:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.88, ntokens=17678.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3264.5, ups=0.18, wpb=17678.7, bsz=1024, num_updates=17760, lr=2.73805e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=117076
2024-11-10 15:25:53 - progress_bar.py[line:274] - INFO: epoch 049:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17340.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3181.7, ups=0.18, wpb=17340.6, bsz=1024, num_updates=17770, lr=2.7366e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=117131
2024-11-10 15:26:47 - progress_bar.py[line:274] - INFO: epoch 049:    233 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17301.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3217.9, ups=0.19, wpb=17301.5, bsz=1024, num_updates=17780, lr=2.73515e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=117185
2024-11-10 15:27:40 - progress_bar.py[line:274] - INFO: epoch 049:    243 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17482.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3280, ups=0.19, wpb=17482.2, bsz=1024, num_updates=17790, lr=2.73369e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=117238
2024-11-10 15:28:33 - progress_bar.py[line:274] - INFO: epoch 049:    253 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17398.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3252.9, ups=0.19, wpb=17398.6, bsz=1024, num_updates=17800, lr=2.73224e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=117292
2024-11-10 15:29:26 - progress_bar.py[line:274] - INFO: epoch 049:    263 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17264.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3249.1, ups=0.19, wpb=17264.9, bsz=1024, num_updates=17810, lr=2.73079e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=117345
2024-11-10 15:30:20 - progress_bar.py[line:274] - INFO: epoch 049:    273 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17393, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3224.9, ups=0.19, wpb=17393, bsz=1024, num_updates=17820, lr=2.72933e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=117399
2024-11-10 15:31:15 - progress_bar.py[line:274] - INFO: epoch 049:    283 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17427.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3210.3, ups=0.18, wpb=17427.9, bsz=1024, num_updates=17830, lr=2.72788e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=117453
2024-11-10 15:32:08 - progress_bar.py[line:274] - INFO: epoch 049:    293 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17167.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3230.4, ups=0.19, wpb=17167.6, bsz=1024, num_updates=17840, lr=2.72643e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=117506
2024-11-10 15:33:01 - progress_bar.py[line:274] - INFO: epoch 049:    303 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17651.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3307.7, ups=0.19, wpb=17651.5, bsz=1024, num_updates=17850, lr=2.72497e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=117559
2024-11-10 15:33:54 - progress_bar.py[line:274] - INFO: epoch 049:    313 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17525.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3305.9, ups=0.19, wpb=17525.6, bsz=1024, num_updates=17860, lr=2.72352e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=34, gb_free=13.4, wall=117612
2024-11-10 15:34:47 - progress_bar.py[line:274] - INFO: epoch 049:    323 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17528.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3299.1, ups=0.19, wpb=17528.7, bsz=1024, num_updates=17870, lr=2.72207e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.3, wall=117666
2024-11-10 15:35:41 - progress_bar.py[line:274] - INFO: epoch 049:    333 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.882, ntokens=17901, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.37, wps=3340.1, ups=0.19, wpb=17901, bsz=1024, num_updates=17880, lr=2.72061e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=117719
2024-11-10 15:36:34 - progress_bar.py[line:274] - INFO: epoch 049:    343 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.879, ntokens=17648.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.36, wps=3326, ups=0.19, wpb=17648.8, bsz=1024, num_updates=17890, lr=2.71916e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=117772
2024-11-10 15:37:27 - progress_bar.py[line:274] - INFO: epoch 049:    353 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17541.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3302.6, ups=0.19, wpb=17541.1, bsz=1024, num_updates=17900, lr=2.71771e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=117825
2024-11-10 15:38:20 - progress_bar.py[line:274] - INFO: epoch 049:    363 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17418.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3267.2, ups=0.19, wpb=17418.3, bsz=1024, num_updates=17910, lr=2.71625e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=117879
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
2024-11-10 15:38:34 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 49 @ 17913 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
2024-11-10 15:38:34 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 15:40:19 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
2024-11-10 15:42:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 49 @ 17913 updates, score 0) (writing took 217.6039397039567 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_49.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 15:43:07 - train.py[line:336] - INFO: end of epoch 49 (average epoch stats below)
2024-11-10 15:43:07 - progress_bar.py[line:282] - INFO: epoch 049 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.833 | ntokens 17443.4 | nsentences 1023.3 | sample_size 1023.3 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.13 | wps 2673.3 | ups 0.15 | wpb 17443.4 | bsz 1023.3 | num_updates 17913 | lr 2.71582e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1314 | gb_free 13.5 | wall 118165
2024-11-10 15:43:07 - trainer.py[line:639] - INFO: loading train data for epoch 50
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 15:45:37 - trainer.py[line:703] - INFO: begin training epoch 50
2024-11-10 15:45:37 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 15:46:17 - progress_bar.py[line:274] - INFO: epoch 050:      7 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17044.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=357.5, ups=0.02, wpb=17044.1, bsz=998.4, num_updates=17920, lr=2.7148e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=35, gb_free=13.4, wall=118355
2024-11-10 15:47:12 - progress_bar.py[line:274] - INFO: epoch 050:     17 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17407.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3193.9, ups=0.18, wpb=17407.4, bsz=1024, num_updates=17930, lr=2.71335e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=118410
2024-11-10 15:48:05 - progress_bar.py[line:274] - INFO: epoch 050:     27 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17385.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3234.9, ups=0.19, wpb=17385.6, bsz=1024, num_updates=17940, lr=2.71189e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.2, wall=118464
2024-11-10 15:48:58 - progress_bar.py[line:274] - INFO: epoch 050:     37 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17336, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3269.2, ups=0.19, wpb=17336, bsz=1024, num_updates=17950, lr=2.71044e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=118517
2024-11-10 15:49:51 - progress_bar.py[line:274] - INFO: epoch 050:     47 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17464.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3323.4, ups=0.19, wpb=17464.6, bsz=1024, num_updates=17960, lr=2.70899e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=31, gb_free=13, wall=118569
2024-11-10 15:50:44 - progress_bar.py[line:274] - INFO: epoch 050:     57 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17510.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3286.8, ups=0.19, wpb=17510.3, bsz=1024, num_updates=17970, lr=2.70753e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=118622
2024-11-10 15:51:37 - progress_bar.py[line:274] - INFO: epoch 050:     67 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17141.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3228.3, ups=0.19, wpb=17141.1, bsz=1024, num_updates=17980, lr=2.70608e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=118676
2024-11-10 15:52:31 - progress_bar.py[line:274] - INFO: epoch 050:     77 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17385.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3249.7, ups=0.19, wpb=17385.6, bsz=1024, num_updates=17990, lr=2.70463e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.6, wall=118729
2024-11-10 15:53:25 - progress_bar.py[line:274] - INFO: epoch 050:     87 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17364.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3227.4, ups=0.19, wpb=17364.9, bsz=1024, num_updates=18000, lr=2.70317e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=118783
2024-11-10 15:54:19 - progress_bar.py[line:274] - INFO: epoch 050:     97 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17510.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3237.1, ups=0.18, wpb=17510.4, bsz=1024, num_updates=18010, lr=2.70172e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=36, gb_free=13.4, wall=118837
2024-11-10 15:55:12 - progress_bar.py[line:274] - INFO: epoch 050:    107 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17124.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3196.5, ups=0.19, wpb=17124.4, bsz=1024, num_updates=18020, lr=2.70027e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=36, gb_free=13.5, wall=118891
2024-11-10 15:56:06 - progress_bar.py[line:274] - INFO: epoch 050:    117 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17544.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3267.4, ups=0.19, wpb=17544.8, bsz=1024, num_updates=18030, lr=2.69881e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=34, gb_free=13.3, wall=118944
2024-11-10 15:57:00 - progress_bar.py[line:274] - INFO: epoch 050:    127 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17383.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3220.9, ups=0.19, wpb=17383.1, bsz=1024, num_updates=18040, lr=2.69736e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=30, gb_free=13.5, wall=118998
2024-11-10 15:57:54 - progress_bar.py[line:274] - INFO: epoch 050:    137 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17197.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3184.3, ups=0.19, wpb=17197.6, bsz=1024, num_updates=18050, lr=2.69591e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=31, gb_free=13.5, wall=119052
2024-11-10 15:58:48 - progress_bar.py[line:274] - INFO: epoch 050:    147 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17550.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3239.4, ups=0.18, wpb=17550.7, bsz=1024, num_updates=18060, lr=2.69445e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=34, gb_free=13.4, wall=119106
2024-11-10 15:59:43 - progress_bar.py[line:274] - INFO: epoch 050:    157 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.849, ntokens=17559.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3182.5, ups=0.18, wpb=17559.2, bsz=1024, num_updates=18070, lr=2.693e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=44, gb_free=13.4, wall=119162
2024-11-10 16:00:38 - progress_bar.py[line:274] - INFO: epoch 050:    167 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17467.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3168.2, ups=0.18, wpb=17467.8, bsz=1024, num_updates=18080, lr=2.69155e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=119217
2024-11-10 16:01:33 - progress_bar.py[line:274] - INFO: epoch 050:    177 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17656.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3238.9, ups=0.18, wpb=17656.6, bsz=1024, num_updates=18090, lr=2.69009e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=119271
2024-11-10 16:02:26 - progress_bar.py[line:274] - INFO: epoch 050:    187 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17244.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3282.4, ups=0.19, wpb=17244.3, bsz=1024, num_updates=18100, lr=2.68864e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=119324
2024-11-10 16:03:19 - progress_bar.py[line:274] - INFO: epoch 050:    197 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17374.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3248.5, ups=0.19, wpb=17374.8, bsz=1024, num_updates=18110, lr=2.68719e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=51, gb_free=13.3, wall=119377
2024-11-10 16:04:14 - progress_bar.py[line:274] - INFO: epoch 050:    207 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17455.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3158.8, ups=0.18, wpb=17455.2, bsz=1024, num_updates=18120, lr=2.68573e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=119432
2024-11-10 16:05:11 - progress_bar.py[line:274] - INFO: epoch 050:    217 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17351.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3074.7, ups=0.18, wpb=17351.1, bsz=1024, num_updates=18130, lr=2.68428e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=119489
2024-11-10 16:06:05 - progress_bar.py[line:274] - INFO: epoch 050:    227 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17496.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3230.3, ups=0.18, wpb=17496.7, bsz=1024, num_updates=18140, lr=2.68283e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=119543
2024-11-10 16:06:59 - progress_bar.py[line:274] - INFO: epoch 050:    237 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17473.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3252.9, ups=0.19, wpb=17473.2, bsz=1024, num_updates=18150, lr=2.68137e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=119597
2024-11-10 16:07:53 - progress_bar.py[line:274] - INFO: epoch 050:    247 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17218.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3160.8, ups=0.18, wpb=17218.6, bsz=1024, num_updates=18160, lr=2.67992e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=119651
2024-11-10 16:08:46 - progress_bar.py[line:274] - INFO: epoch 050:    257 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.857, ntokens=17444.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3292.4, ups=0.19, wpb=17444.6, bsz=1024, num_updates=18170, lr=2.67847e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=119704
2024-11-10 16:09:39 - progress_bar.py[line:274] - INFO: epoch 050:    267 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17574.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3293.3, ups=0.19, wpb=17574.3, bsz=1024, num_updates=18180, lr=2.67701e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.2, wall=119758
2024-11-10 16:10:33 - progress_bar.py[line:274] - INFO: epoch 050:    277 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=16874, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3162.8, ups=0.19, wpb=16874, bsz=1015.4, num_updates=18190, lr=2.67556e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=119811
2024-11-10 16:11:27 - progress_bar.py[line:274] - INFO: epoch 050:    287 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17200.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3145.3, ups=0.18, wpb=17200.7, bsz=1024, num_updates=18200, lr=2.67411e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=119866
2024-11-10 16:12:22 - progress_bar.py[line:274] - INFO: epoch 050:    297 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17605.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3242.6, ups=0.18, wpb=17605.9, bsz=1024, num_updates=18210, lr=2.67265e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=119920
2024-11-10 16:13:17 - progress_bar.py[line:274] - INFO: epoch 050:    307 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.851, ntokens=17791.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3205.6, ups=0.18, wpb=17791.1, bsz=1024, num_updates=18220, lr=2.6712e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=119975
2024-11-10 16:14:13 - progress_bar.py[line:274] - INFO: epoch 050:    317 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.859, ntokens=17627.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.25, wps=3157.1, ups=0.18, wpb=17627.1, bsz=1024, num_updates=18230, lr=2.66975e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=120031
2024-11-10 16:15:09 - progress_bar.py[line:274] - INFO: epoch 050:    327 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17797.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3194.1, ups=0.18, wpb=17797.9, bsz=1024, num_updates=18240, lr=2.66829e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=120087
2024-11-10 16:16:04 - progress_bar.py[line:274] - INFO: epoch 050:    337 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17600.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3177.5, ups=0.18, wpb=17600.4, bsz=1024, num_updates=18250, lr=2.66684e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=120142
2024-11-10 16:17:00 - progress_bar.py[line:274] - INFO: epoch 050:    347 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.885, ntokens=17846.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.39, wps=3212.8, ups=0.18, wpb=17846.6, bsz=1024, num_updates=18260, lr=2.66539e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=120198
2024-11-10 16:17:55 - progress_bar.py[line:274] - INFO: epoch 050:    357 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17560.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3150.7, ups=0.18, wpb=17560.6, bsz=1024, num_updates=18270, lr=2.66393e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=120254
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 16:18:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 50 @ 18279 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
2024-11-10 16:18:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 16:20:31 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-10 16:22:24 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 50 @ 18279 updates, score 0) (writing took 222.0128341980162 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_50.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-10 16:23:19 - train.py[line:336] - INFO: end of epoch 50 (average epoch stats below)
2024-11-10 16:23:19 - progress_bar.py[line:282] - INFO: epoch 050 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.827 | ntokens 17430.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.09 | wps 2644.9 | ups 0.15 | wpb 17430.7 | bsz 1023.1 | num_updates 18279 | lr 2.66263e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 1641 | gb_free 13.5 | wall 120578
2024-11-10 16:23:19 - trainer.py[line:639] - INFO: loading train data for epoch 51
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 16:25:49 - trainer.py[line:703] - INFO: begin training epoch 51
2024-11-10 16:25:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 16:25:57 - progress_bar.py[line:274] - INFO: epoch 051:      1 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17023.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=353.7, ups=0.02, wpb=17023.3, bsz=998.4, num_updates=18280, lr=2.66248e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=49, gb_free=13.5, wall=120735
2024-11-10 16:26:50 - progress_bar.py[line:274] - INFO: epoch 051:     11 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17444.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3277.8, ups=0.19, wpb=17444.4, bsz=1024, num_updates=18290, lr=2.66103e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=120788
2024-11-10 16:27:45 - progress_bar.py[line:274] - INFO: epoch 051:     21 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17429.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3185.4, ups=0.18, wpb=17429.3, bsz=1024, num_updates=18300, lr=2.65957e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=34, gb_free=13, wall=120843
2024-11-10 16:28:40 - progress_bar.py[line:274] - INFO: epoch 051:     31 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17556, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3148.8, ups=0.18, wpb=17556, bsz=1024, num_updates=18310, lr=2.65812e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=51, gb_free=13.5, wall=120899
2024-11-10 16:29:35 - progress_bar.py[line:274] - INFO: epoch 051:     41 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17690, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3232, ups=0.18, wpb=17690, bsz=1024, num_updates=18320, lr=2.65667e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=120953
2024-11-10 16:30:30 - progress_bar.py[line:274] - INFO: epoch 051:     51 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.874, ntokens=17930.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.33, wps=3271.2, ups=0.18, wpb=17930.4, bsz=1024, num_updates=18330, lr=2.65521e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=121008
2024-11-10 16:31:20 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 16:31:31 - progress_bar.py[line:274] - INFO: epoch 051:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17686.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=2885.4, ups=0.16, wpb=17686.3, bsz=1024, num_updates=18340, lr=2.65376e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=61, gb_free=13.5, wall=121069
2024-11-10 16:32:25 - progress_bar.py[line:274] - INFO: epoch 051:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17226, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3191.4, ups=0.19, wpb=17226, bsz=1024, num_updates=18350, lr=2.65231e-05, gnorm=0.008, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=121123
2024-11-10 16:33:19 - progress_bar.py[line:274] - INFO: epoch 051:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=17577.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3248.8, ups=0.18, wpb=17577.3, bsz=1024, num_updates=18360, lr=2.65085e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=121178
2024-11-10 16:34:15 - progress_bar.py[line:274] - INFO: epoch 051:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17298.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3102.1, ups=0.18, wpb=17298.1, bsz=1024, num_updates=18370, lr=2.6494e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=121233
2024-11-10 16:35:10 - progress_bar.py[line:274] - INFO: epoch 051:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17438.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3169.2, ups=0.18, wpb=17438.5, bsz=1024, num_updates=18380, lr=2.64795e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=121288
2024-11-10 16:36:06 - progress_bar.py[line:274] - INFO: epoch 051:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17656.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3187.5, ups=0.18, wpb=17656.6, bsz=1024, num_updates=18390, lr=2.64649e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=121344
2024-11-10 16:37:00 - progress_bar.py[line:274] - INFO: epoch 051:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17480.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3199.5, ups=0.18, wpb=17480.9, bsz=1024, num_updates=18400, lr=2.64504e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=121398
2024-11-10 16:37:57 - progress_bar.py[line:274] - INFO: epoch 051:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17214.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3049.8, ups=0.18, wpb=17214.7, bsz=1024, num_updates=18410, lr=2.64359e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=121455
2024-11-10 16:38:52 - progress_bar.py[line:274] - INFO: epoch 051:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17507.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3157.6, ups=0.18, wpb=17507.3, bsz=1024, num_updates=18420, lr=2.64213e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=121510
2024-11-10 16:39:49 - progress_bar.py[line:274] - INFO: epoch 051:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17430.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3073.5, ups=0.18, wpb=17430.1, bsz=1024, num_updates=18430, lr=2.64068e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=121567
2024-11-10 16:40:46 - progress_bar.py[line:274] - INFO: epoch 051:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17274.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3018, ups=0.17, wpb=17274.5, bsz=1024, num_updates=18440, lr=2.63923e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=121624
2024-11-10 16:41:43 - progress_bar.py[line:274] - INFO: epoch 051:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17331.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3063, ups=0.18, wpb=17331.3, bsz=1024, num_updates=18450, lr=2.63777e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=121681
2024-11-10 16:42:38 - progress_bar.py[line:274] - INFO: epoch 051:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17005.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3051.4, ups=0.18, wpb=17005.9, bsz=1024, num_updates=18460, lr=2.63632e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=121737
2024-11-10 16:43:33 - progress_bar.py[line:274] - INFO: epoch 051:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17322.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3169.7, ups=0.18, wpb=17322.9, bsz=1024, num_updates=18470, lr=2.63487e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=121791
2024-11-10 16:44:30 - progress_bar.py[line:274] - INFO: epoch 051:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17609, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3099.3, ups=0.18, wpb=17609, bsz=1024, num_updates=18480, lr=2.63341e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=121848
2024-11-10 16:45:26 - progress_bar.py[line:274] - INFO: epoch 051:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17394.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3072.6, ups=0.18, wpb=17394.3, bsz=1024, num_updates=18490, lr=2.63196e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=121905
2024-11-10 16:46:22 - progress_bar.py[line:274] - INFO: epoch 051:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17697.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3194.7, ups=0.18, wpb=17697.5, bsz=1024, num_updates=18500, lr=2.63051e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=121960
2024-11-10 16:47:19 - progress_bar.py[line:274] - INFO: epoch 051:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.831, ntokens=17389.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3058.3, ups=0.18, wpb=17389.2, bsz=1024, num_updates=18510, lr=2.62905e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=122017
2024-11-10 16:48:15 - progress_bar.py[line:274] - INFO: epoch 051:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17496.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3105.4, ups=0.18, wpb=17496.1, bsz=1024, num_updates=18520, lr=2.6276e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=122073
2024-11-10 16:49:12 - progress_bar.py[line:274] - INFO: epoch 051:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17323.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3057.9, ups=0.18, wpb=17323.6, bsz=1024, num_updates=18530, lr=2.62615e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=122130
2024-11-10 16:50:07 - progress_bar.py[line:274] - INFO: epoch 051:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17348.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3127.7, ups=0.18, wpb=17348.9, bsz=1024, num_updates=18540, lr=2.62469e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=122185
2024-11-10 16:51:04 - progress_bar.py[line:274] - INFO: epoch 051:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17451.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3043.4, ups=0.17, wpb=17451.3, bsz=1024, num_updates=18550, lr=2.62324e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=122243
2024-11-10 16:52:01 - progress_bar.py[line:274] - INFO: epoch 051:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17111.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3051.2, ups=0.18, wpb=17111.7, bsz=1024, num_updates=18560, lr=2.62179e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=122299
2024-11-10 16:52:57 - progress_bar.py[line:274] - INFO: epoch 051:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17399.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3060.2, ups=0.18, wpb=17399.7, bsz=1024, num_updates=18570, lr=2.62033e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=122356
2024-11-10 16:53:55 - progress_bar.py[line:274] - INFO: epoch 051:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17536.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3066.3, ups=0.17, wpb=17536.9, bsz=1024, num_updates=18580, lr=2.61888e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=122413
2024-11-10 16:54:51 - progress_bar.py[line:274] - INFO: epoch 051:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.838, ntokens=17509.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3102.7, ups=0.18, wpb=17509.4, bsz=1024, num_updates=18590, lr=2.61743e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=122469
2024-11-10 16:55:46 - progress_bar.py[line:274] - INFO: epoch 051:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.861, ntokens=17761.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.26, wps=3221.4, ups=0.18, wpb=17761.3, bsz=1024, num_updates=18600, lr=2.61597e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=122524
2024-11-10 16:56:43 - progress_bar.py[line:274] - INFO: epoch 051:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.865, ntokens=17681, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3120.2, ups=0.18, wpb=17681, bsz=1015.4, num_updates=18610, lr=2.61452e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=122581
2024-11-10 16:57:41 - progress_bar.py[line:274] - INFO: epoch 051:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.875, ntokens=17788.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.34, wps=3050.3, ups=0.17, wpb=17788.9, bsz=1024, num_updates=18620, lr=2.61307e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=122639
2024-11-10 16:58:37 - progress_bar.py[line:274] - INFO: epoch 051:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.856, ntokens=17711.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.24, wps=3147.7, ups=0.18, wpb=17711.6, bsz=1024, num_updates=18630, lr=2.61161e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13, wall=122696
2024-11-10 16:59:35 - progress_bar.py[line:274] - INFO: epoch 051:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.85, ntokens=17712.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.21, wps=3081.3, ups=0.17, wpb=17712.3, bsz=1024, num_updates=18640, lr=2.61016e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=122753
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 16:59:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 51 @ 18644 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
2024-11-10 16:59:54 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 17:01:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-10 17:03:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 51 @ 18644 updates, score 0) (writing took 218.4673537950148 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_51.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
2024-11-10 17:04:28 - train.py[line:336] - INFO: end of epoch 51 (average epoch stats below)
2024-11-10 17:04:28 - progress_bar.py[line:282] - INFO: epoch 051 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.827 | ntokens 17472.5 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.09 | wps 2583.2 | ups 0.15 | wpb 17472.5 | bsz 1023.1 | num_updates 18644 | lr 2.60958e-05 | gnorm 0.005 | clip 0 | loss_scale 131072 | train_wall 1990 | gb_free 13.4 | wall 123046
2024-11-10 17:04:28 - trainer.py[line:639] - INFO: loading train data for epoch 52
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 17:06:57 - trainer.py[line:703] - INFO: begin training epoch 52
2024-11-10 17:06:57 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 17:07:32 - progress_bar.py[line:274] - INFO: epoch 052:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=16814.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=352.5, ups=0.02, wpb=16814.5, bsz=998.4, num_updates=18650, lr=2.60871e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=38, gb_free=13.5, wall=123230
2024-11-10 17:08:25 - progress_bar.py[line:274] - INFO: epoch 052:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17459.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3257, ups=0.19, wpb=17459.1, bsz=1024, num_updates=18660, lr=2.60725e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=123284
2024-11-10 17:09:19 - progress_bar.py[line:274] - INFO: epoch 052:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17575.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3260.6, ups=0.19, wpb=17575.7, bsz=1024, num_updates=18670, lr=2.6058e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=40, gb_free=13.4, wall=123338
2024-11-10 17:10:14 - progress_bar.py[line:274] - INFO: epoch 052:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17471.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3224, ups=0.18, wpb=17471.2, bsz=1024, num_updates=18680, lr=2.60435e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=47, gb_free=13.3, wall=123392
2024-11-10 17:11:09 - progress_bar.py[line:274] - INFO: epoch 052:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17401.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3157.2, ups=0.18, wpb=17401.4, bsz=1024, num_updates=18690, lr=2.6029e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=123447
2024-11-10 17:12:04 - progress_bar.py[line:274] - INFO: epoch 052:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17335.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3130.5, ups=0.18, wpb=17335.4, bsz=1024, num_updates=18700, lr=2.60144e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=123502
2024-11-10 17:12:57 - progress_bar.py[line:274] - INFO: epoch 052:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17198, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3241.7, ups=0.19, wpb=17198, bsz=1024, num_updates=18710, lr=2.59999e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=123555
2024-11-10 17:13:55 - progress_bar.py[line:274] - INFO: epoch 052:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17285.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=2969.2, ups=0.17, wpb=17285.8, bsz=1024, num_updates=18720, lr=2.59854e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=123614
2024-11-10 17:14:53 - progress_bar.py[line:274] - INFO: epoch 052:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17194.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2977.5, ups=0.17, wpb=17194.7, bsz=1024, num_updates=18730, lr=2.59708e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=123671
2024-11-10 17:15:51 - progress_bar.py[line:274] - INFO: epoch 052:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.824, ntokens=17463, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3039.1, ups=0.17, wpb=17463, bsz=1024, num_updates=18740, lr=2.59563e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=123729
2024-11-10 17:16:44 - progress_bar.py[line:274] - INFO: epoch 052:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17379.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3238, ups=0.19, wpb=17379.4, bsz=1024, num_updates=18750, lr=2.59418e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13, wall=123782
2024-11-10 17:17:37 - progress_bar.py[line:274] - INFO: epoch 052:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17360.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3264, ups=0.19, wpb=17360.8, bsz=1024, num_updates=18760, lr=2.59272e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=123836
2024-11-10 17:18:31 - progress_bar.py[line:274] - INFO: epoch 052:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17475.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3254.4, ups=0.19, wpb=17475.7, bsz=1024, num_updates=18770, lr=2.59127e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=123889
2024-11-10 17:19:25 - progress_bar.py[line:274] - INFO: epoch 052:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17078.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3192.5, ups=0.19, wpb=17078.2, bsz=1024, num_updates=18780, lr=2.58982e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=123943
2024-11-10 17:20:18 - progress_bar.py[line:274] - INFO: epoch 052:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.829, ntokens=17459.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3260.9, ups=0.19, wpb=17459.8, bsz=1024, num_updates=18790, lr=2.58836e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=123996
2024-11-10 17:21:13 - progress_bar.py[line:274] - INFO: epoch 052:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17493.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3180.6, ups=0.18, wpb=17493.9, bsz=1024, num_updates=18800, lr=2.58691e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=124051
2024-11-10 17:22:09 - progress_bar.py[line:274] - INFO: epoch 052:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17666.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3151.1, ups=0.18, wpb=17666.8, bsz=1024, num_updates=18810, lr=2.58546e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=124107
2024-11-10 17:23:07 - progress_bar.py[line:274] - INFO: epoch 052:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17610, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3049.3, ups=0.17, wpb=17610, bsz=1024, num_updates=18820, lr=2.584e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=124165
2024-11-10 17:24:04 - progress_bar.py[line:274] - INFO: epoch 052:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17464.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3060.9, ups=0.18, wpb=17464.9, bsz=1024, num_updates=18830, lr=2.58255e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=124222
2024-11-10 17:25:02 - progress_bar.py[line:274] - INFO: epoch 052:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17372.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3012.7, ups=0.17, wpb=17372.7, bsz=1024, num_updates=18840, lr=2.5811e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=124280
2024-11-10 17:25:56 - progress_bar.py[line:274] - INFO: epoch 052:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17415.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3207, ups=0.18, wpb=17415.6, bsz=1024, num_updates=18850, lr=2.57964e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=124334
2024-11-10 17:26:48 - progress_bar.py[line:274] - INFO: epoch 052:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3344.5, ups=0.19, wpb=17521.3, bsz=1024, num_updates=18860, lr=2.57819e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=124387
2024-11-10 17:27:44 - progress_bar.py[line:274] - INFO: epoch 052:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17406.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3108.9, ups=0.18, wpb=17406.8, bsz=1015.4, num_updates=18870, lr=2.57674e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=124443
2024-11-10 17:28:40 - progress_bar.py[line:274] - INFO: epoch 052:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17395.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3103.3, ups=0.18, wpb=17395.2, bsz=1024, num_updates=18880, lr=2.57528e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=124499
2024-11-10 17:29:34 - progress_bar.py[line:274] - INFO: epoch 052:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17420.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3243.1, ups=0.19, wpb=17420.1, bsz=1024, num_updates=18890, lr=2.57383e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=124552
2024-11-10 17:30:32 - progress_bar.py[line:274] - INFO: epoch 052:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17208.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=2994.6, ups=0.17, wpb=17208.6, bsz=1024, num_updates=18900, lr=2.57238e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=124610
2024-11-10 17:31:24 - progress_bar.py[line:274] - INFO: epoch 052:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17522, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3354, ups=0.19, wpb=17522, bsz=1024, num_updates=18910, lr=2.57092e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=124662
2024-11-10 17:32:19 - progress_bar.py[line:274] - INFO: epoch 052:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17471.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3139.8, ups=0.18, wpb=17471.2, bsz=1024, num_updates=18920, lr=2.56947e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=124718
2024-11-10 17:33:17 - progress_bar.py[line:274] - INFO: epoch 052:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17225.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=2991.4, ups=0.17, wpb=17225.2, bsz=1024, num_updates=18930, lr=2.56802e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=124775
2024-11-10 17:34:14 - progress_bar.py[line:274] - INFO: epoch 052:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17302.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3042.4, ups=0.18, wpb=17302.1, bsz=1024, num_updates=18940, lr=2.56656e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.1, wall=124832
2024-11-10 17:35:08 - progress_bar.py[line:274] - INFO: epoch 052:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.867, ntokens=17842.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3314.1, ups=0.19, wpb=17842.3, bsz=1024, num_updates=18950, lr=2.56511e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=124886
2024-11-10 17:36:05 - progress_bar.py[line:274] - INFO: epoch 052:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17644.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3085.9, ups=0.17, wpb=17644.3, bsz=1024, num_updates=18960, lr=2.56366e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=124943
2024-11-10 17:36:57 - progress_bar.py[line:274] - INFO: epoch 052:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17541.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3345.6, ups=0.19, wpb=17541.7, bsz=1024, num_updates=18970, lr=2.5622e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=124996
2024-11-10 17:37:55 - progress_bar.py[line:274] - INFO: epoch 052:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17472, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3055.1, ups=0.17, wpb=17472, bsz=1024, num_updates=18980, lr=2.56075e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=125053
2024-11-10 17:38:51 - progress_bar.py[line:274] - INFO: epoch 052:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.853, ntokens=17624.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3137.8, ups=0.18, wpb=17624.2, bsz=1024, num_updates=18990, lr=2.5593e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=125109
2024-11-10 17:39:46 - progress_bar.py[line:274] - INFO: epoch 052:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17671.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3207.6, ups=0.18, wpb=17671.3, bsz=1024, num_updates=19000, lr=2.55784e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=125164
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 17:40:40 - progress_bar.py[line:274] - INFO: epoch 052:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17303.4, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3215.1, ups=0.19, wpb=17303.4, bsz=998.4, num_updates=19010, lr=2.55639e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=125218
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt

2024-11-10 17:40:40 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 52 @ 19010 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
2024-11-10 17:40:40 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 17:42:30 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 4 seek offset 187222
2024-11-10 17:44:23 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 52 @ 19010 updates, score 0) (writing took 223.08421476202784 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_52.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-10 17:45:18 - train.py[line:336] - INFO: end of epoch 52 (average epoch stats below)
2024-11-10 17:45:18 - progress_bar.py[line:282] - INFO: epoch 052 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.816 | ntokens 17430.9 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.04 | wps 2604 | ups 0.15 | wpb 17430.9 | bsz 1023.1 | num_updates 19010 | lr 2.55639e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 1957 | gb_free 13.4 | wall 125496
2024-11-10 17:45:18 - trainer.py[line:639] - INFO: loading train data for epoch 53
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 17:47:46 - trainer.py[line:703] - INFO: begin training epoch 53
2024-11-10 17:47:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 17:48:42 - progress_bar.py[line:274] - INFO: epoch 053:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17292.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=358.6, ups=0.02, wpb=17292.1, bsz=1024, num_updates=19020, lr=2.55494e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.2, wall=125700
2024-11-10 17:49:40 - progress_bar.py[line:274] - INFO: epoch 053:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17386.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2982, ups=0.17, wpb=17386.2, bsz=1024, num_updates=19030, lr=2.55348e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=125758
2024-11-10 17:50:38 - progress_bar.py[line:274] - INFO: epoch 053:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.848, ntokens=17593.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.2, wps=3048.4, ups=0.17, wpb=17593.7, bsz=1024, num_updates=19040, lr=2.55203e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=125816
2024-11-10 17:51:36 - progress_bar.py[line:274] - INFO: epoch 053:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17414.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=2993.6, ups=0.17, wpb=17414.8, bsz=1024, num_updates=19050, lr=2.55058e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=125874
2024-11-10 17:51:42 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 17:52:40 - progress_bar.py[line:274] - INFO: epoch 053:     51 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17393.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=2741.7, ups=0.16, wpb=17393.9, bsz=1024, num_updates=19060, lr=2.54912e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=63, gb_free=13.3, wall=125938
2024-11-10 17:53:38 - progress_bar.py[line:274] - INFO: epoch 053:     61 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17351.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=2981.6, ups=0.17, wpb=17351.5, bsz=1024, num_updates=19070, lr=2.54767e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.6, wall=125996
2024-11-10 17:54:30 - progress_bar.py[line:274] - INFO: epoch 053:     71 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17569.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3337.3, ups=0.19, wpb=17569.1, bsz=1024, num_updates=19080, lr=2.54622e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=126049
2024-11-10 17:55:28 - progress_bar.py[line:274] - INFO: epoch 053:     81 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17251.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2979.1, ups=0.17, wpb=17251.4, bsz=1024, num_updates=19090, lr=2.54476e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=126106
2024-11-10 17:56:27 - progress_bar.py[line:274] - INFO: epoch 053:     91 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17428.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=2963.3, ups=0.17, wpb=17428.9, bsz=1024, num_updates=19100, lr=2.54331e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.6, wall=126165
2024-11-10 17:57:24 - progress_bar.py[line:274] - INFO: epoch 053:    101 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.846, ntokens=17605.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3105.8, ups=0.18, wpb=17605.5, bsz=1024, num_updates=19110, lr=2.54186e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=126222
2024-11-10 17:58:21 - progress_bar.py[line:274] - INFO: epoch 053:    111 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17439.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3070.1, ups=0.18, wpb=17439.3, bsz=1024, num_updates=19120, lr=2.5404e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=126279
2024-11-10 17:59:19 - progress_bar.py[line:274] - INFO: epoch 053:    121 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17403.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=2990.1, ups=0.17, wpb=17403.3, bsz=1024, num_updates=19130, lr=2.53895e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=126337
2024-11-10 18:00:16 - progress_bar.py[line:274] - INFO: epoch 053:    131 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17081.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2978.1, ups=0.17, wpb=17081.6, bsz=1024, num_updates=19140, lr=2.5375e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=126394
2024-11-10 18:01:15 - progress_bar.py[line:274] - INFO: epoch 053:    141 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17224.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=2945, ups=0.17, wpb=17224.2, bsz=1024, num_updates=19150, lr=2.53604e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=126453
2024-11-10 18:02:12 - progress_bar.py[line:274] - INFO: epoch 053:    151 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.863, ntokens=17705.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.27, wps=3087.5, ups=0.17, wpb=17705.6, bsz=1024, num_updates=19160, lr=2.53459e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=126510
2024-11-10 18:03:07 - progress_bar.py[line:274] - INFO: epoch 053:    161 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17427, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3164.6, ups=0.18, wpb=17427, bsz=1024, num_updates=19170, lr=2.53314e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=126565
2024-11-10 18:04:02 - progress_bar.py[line:274] - INFO: epoch 053:    171 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17304.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3124.4, ups=0.18, wpb=17304.1, bsz=1024, num_updates=19180, lr=2.53168e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=126621
2024-11-10 18:04:59 - progress_bar.py[line:274] - INFO: epoch 053:    181 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17474.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3103.6, ups=0.18, wpb=17474.3, bsz=1024, num_updates=19190, lr=2.53023e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=126677
2024-11-10 18:05:57 - progress_bar.py[line:274] - INFO: epoch 053:    191 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17448.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=2989.9, ups=0.17, wpb=17448.3, bsz=1024, num_updates=19200, lr=2.52878e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=126735
2024-11-10 18:06:55 - progress_bar.py[line:274] - INFO: epoch 053:    201 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17407.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3011.8, ups=0.17, wpb=17407.8, bsz=1024, num_updates=19210, lr=2.52732e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=126793
2024-11-10 18:07:52 - progress_bar.py[line:274] - INFO: epoch 053:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17350, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3015.7, ups=0.17, wpb=17350, bsz=1024, num_updates=19220, lr=2.52587e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=126851
2024-11-10 18:08:48 - progress_bar.py[line:274] - INFO: epoch 053:    221 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17395.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3131.8, ups=0.18, wpb=17395.8, bsz=1024, num_updates=19230, lr=2.52442e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=126906
2024-11-10 18:09:45 - progress_bar.py[line:274] - INFO: epoch 053:    231 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17465.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3040, ups=0.17, wpb=17465.1, bsz=1024, num_updates=19240, lr=2.52296e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=126964
2024-11-10 18:10:42 - progress_bar.py[line:274] - INFO: epoch 053:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17599.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3131.8, ups=0.18, wpb=17599.1, bsz=1024, num_updates=19250, lr=2.52151e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=127020
2024-11-10 18:11:37 - progress_bar.py[line:274] - INFO: epoch 053:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17094.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3080.5, ups=0.18, wpb=17094.2, bsz=1024, num_updates=19260, lr=2.52006e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=127075
2024-11-10 18:12:35 - progress_bar.py[line:274] - INFO: epoch 053:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17310.5, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3009.8, ups=0.17, wpb=17310.5, bsz=1015.4, num_updates=19270, lr=2.5186e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=127133
2024-11-10 18:13:33 - progress_bar.py[line:274] - INFO: epoch 053:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17590.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3005, ups=0.17, wpb=17590.3, bsz=1024, num_updates=19280, lr=2.51715e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=127191
2024-11-10 18:14:29 - progress_bar.py[line:274] - INFO: epoch 053:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17037.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3057.4, ups=0.18, wpb=17037.6, bsz=1024, num_updates=19290, lr=2.5157e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=127247
2024-11-10 18:15:27 - progress_bar.py[line:274] - INFO: epoch 053:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17250.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2953.1, ups=0.17, wpb=17250.4, bsz=1024, num_updates=19300, lr=2.51424e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=127306
2024-11-10 18:16:25 - progress_bar.py[line:274] - INFO: epoch 053:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17317.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3015.7, ups=0.17, wpb=17317.6, bsz=1024, num_updates=19310, lr=2.51279e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=127363
2024-11-10 18:17:22 - progress_bar.py[line:274] - INFO: epoch 053:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17557.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3053.5, ups=0.17, wpb=17557.6, bsz=1024, num_updates=19320, lr=2.51134e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=127420
2024-11-10 18:18:21 - progress_bar.py[line:274] - INFO: epoch 053:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.893, ntokens=17945.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.43, wps=3072, ups=0.17, wpb=17945.9, bsz=1024, num_updates=19330, lr=2.50988e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=127479
2024-11-10 18:19:19 - progress_bar.py[line:274] - INFO: epoch 053:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17694.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3018.5, ups=0.17, wpb=17694.3, bsz=1024, num_updates=19340, lr=2.50843e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=127537
2024-11-10 18:20:15 - progress_bar.py[line:274] - INFO: epoch 053:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17615.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3173.4, ups=0.18, wpb=17615.3, bsz=1024, num_updates=19350, lr=2.50698e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=127593
2024-11-10 18:21:11 - progress_bar.py[line:274] - INFO: epoch 053:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.847, ntokens=17539.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=3128.2, ups=0.18, wpb=17539.6, bsz=1024, num_updates=19360, lr=2.50552e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=127649
2024-11-10 18:22:06 - progress_bar.py[line:274] - INFO: epoch 053:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17522.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3174.5, ups=0.18, wpb=17522.8, bsz=1024, num_updates=19370, lr=2.50407e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=127704
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt2024-11-10 18:22:30 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 53 @ 19375 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
2024-11-10 18:22:30 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 18:24:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
2024-11-10 18:26:15 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 53 @ 19375 updates, score 0) (writing took 224.74516022298485 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_53.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
2024-11-10 18:27:10 - train.py[line:336] - INFO: end of epoch 53 (average epoch stats below)
2024-11-10 18:27:10 - progress_bar.py[line:282] - INFO: epoch 053 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.81 | ntokens 17420.2 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 7.01 | wps 2531.3 | ups 0.15 | wpb 17420.2 | bsz 1023.1 | num_updates 19375 | lr 2.50334e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 2049 | gb_free 13.6 | wall 128008
2024-11-10 18:27:10 - trainer.py[line:639] - INFO: loading train data for epoch 54
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 18:29:41 - trainer.py[line:703] - INFO: begin training epoch 54
2024-11-10 18:29:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 18:30:10 - progress_bar.py[line:274] - INFO: epoch 054:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=16841.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=348.2, ups=0.02, wpb=16841.2, bsz=998.4, num_updates=19380, lr=2.50262e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=39, gb_free=13.5, wall=128188
2024-11-10 18:31:03 - progress_bar.py[line:274] - INFO: epoch 054:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17817.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3347.1, ups=0.19, wpb=17817.9, bsz=1024, num_updates=19390, lr=2.50116e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=30, gb_free=13.3, wall=128241
2024-11-10 18:31:56 - progress_bar.py[line:274] - INFO: epoch 054:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17458.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3270.8, ups=0.19, wpb=17458.4, bsz=1024, num_updates=19400, lr=2.49971e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=35, gb_free=13.4, wall=128295
2024-11-10 18:32:49 - progress_bar.py[line:274] - INFO: epoch 054:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17232.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3245.9, ups=0.19, wpb=17232.5, bsz=1024, num_updates=19410, lr=2.49826e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=32, gb_free=13.4, wall=128348
2024-11-10 18:33:44 - progress_bar.py[line:274] - INFO: epoch 054:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.869, ntokens=17733.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.3, wps=3230.6, ups=0.18, wpb=17733.9, bsz=1024, num_updates=19420, lr=2.4968e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=32, gb_free=13.2, wall=128403
2024-11-10 18:34:42 - progress_bar.py[line:274] - INFO: epoch 054:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.841, ntokens=17794.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3083.8, ups=0.17, wpb=17794.6, bsz=1024, num_updates=19430, lr=2.49535e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=128460
2024-11-10 18:35:40 - progress_bar.py[line:274] - INFO: epoch 054:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17299.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3007.3, ups=0.17, wpb=17299.1, bsz=1024, num_updates=19440, lr=2.4939e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=128518
2024-11-10 18:36:38 - progress_bar.py[line:274] - INFO: epoch 054:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17374.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2996.3, ups=0.17, wpb=17374.7, bsz=1024, num_updates=19450, lr=2.49244e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=128576
2024-11-10 18:37:36 - progress_bar.py[line:274] - INFO: epoch 054:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17302.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=2956.4, ups=0.17, wpb=17302.7, bsz=1024, num_updates=19460, lr=2.49099e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=128634
2024-11-10 18:38:34 - progress_bar.py[line:274] - INFO: epoch 054:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17408, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3011, ups=0.17, wpb=17408, bsz=1024, num_updates=19470, lr=2.48954e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=128692
2024-11-10 18:39:31 - progress_bar.py[line:274] - INFO: epoch 054:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17444.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3066.4, ups=0.18, wpb=17444.8, bsz=1024, num_updates=19480, lr=2.48808e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=128749
2024-11-10 18:40:28 - progress_bar.py[line:274] - INFO: epoch 054:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17289.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3012.8, ups=0.17, wpb=17289.9, bsz=1024, num_updates=19490, lr=2.48663e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=128806
2024-11-10 18:41:26 - progress_bar.py[line:274] - INFO: epoch 054:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.836, ntokens=17655.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.14, wps=3031.7, ups=0.17, wpb=17655.9, bsz=1024, num_updates=19500, lr=2.48518e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=128865
2024-11-10 18:42:21 - progress_bar.py[line:274] - INFO: epoch 054:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17039.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3144, ups=0.18, wpb=17039.2, bsz=1024, num_updates=19510, lr=2.48372e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.6, wall=128919
2024-11-10 18:43:19 - progress_bar.py[line:274] - INFO: epoch 054:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17025.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2924.5, ups=0.17, wpb=17025.1, bsz=1024, num_updates=19520, lr=2.48227e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=128977
2024-11-10 18:44:15 - progress_bar.py[line:274] - INFO: epoch 054:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17334.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3084.3, ups=0.18, wpb=17334.8, bsz=1024, num_updates=19530, lr=2.48082e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=129033
2024-11-10 18:45:11 - progress_bar.py[line:274] - INFO: epoch 054:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17298.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3069.8, ups=0.18, wpb=17298.7, bsz=1024, num_updates=19540, lr=2.47936e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=129090
2024-11-10 18:46:07 - progress_bar.py[line:274] - INFO: epoch 054:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.83, ntokens=17597.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.11, wps=3160.9, ups=0.18, wpb=17597.3, bsz=1024, num_updates=19550, lr=2.47791e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=129145
2024-11-10 18:47:01 - progress_bar.py[line:274] - INFO: epoch 054:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17278.9, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3210.4, ups=0.19, wpb=17278.9, bsz=1015.4, num_updates=19560, lr=2.47646e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=129199
2024-11-10 18:47:59 - progress_bar.py[line:274] - INFO: epoch 054:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17521.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3029.8, ups=0.17, wpb=17521.3, bsz=1024, num_updates=19570, lr=2.475e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=129257
2024-11-10 18:48:56 - progress_bar.py[line:274] - INFO: epoch 054:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17366.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3023.8, ups=0.17, wpb=17366.5, bsz=1024, num_updates=19580, lr=2.47355e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=129314
2024-11-10 18:49:52 - progress_bar.py[line:274] - INFO: epoch 054:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17479.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3138, ups=0.18, wpb=17479.6, bsz=1024, num_updates=19590, lr=2.4721e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=129370
2024-11-10 18:50:47 - progress_bar.py[line:274] - INFO: epoch 054:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17338.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3168.2, ups=0.18, wpb=17338.7, bsz=1024, num_updates=19600, lr=2.47064e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=129425
2024-11-10 18:51:44 - progress_bar.py[line:274] - INFO: epoch 054:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17472.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3029.7, ups=0.17, wpb=17472.8, bsz=1024, num_updates=19610, lr=2.46919e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=129482
2024-11-10 18:52:42 - progress_bar.py[line:274] - INFO: epoch 054:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17344.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2991.9, ups=0.17, wpb=17344.2, bsz=1024, num_updates=19620, lr=2.46774e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=129540
2024-11-10 18:53:40 - progress_bar.py[line:274] - INFO: epoch 054:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17303.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=2984.8, ups=0.17, wpb=17303.3, bsz=1024, num_updates=19630, lr=2.46628e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=129598
2024-11-10 18:54:37 - progress_bar.py[line:274] - INFO: epoch 054:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17322.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3066.6, ups=0.18, wpb=17322.5, bsz=1024, num_updates=19640, lr=2.46483e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.6, wall=129655
2024-11-10 18:55:34 - progress_bar.py[line:274] - INFO: epoch 054:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17328.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3049.2, ups=0.18, wpb=17328.3, bsz=1024, num_updates=19650, lr=2.46338e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=129712
2024-11-10 18:56:29 - progress_bar.py[line:274] - INFO: epoch 054:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17227.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3130.1, ups=0.18, wpb=17227.7, bsz=1024, num_updates=19660, lr=2.46192e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=129767
2024-11-10 18:57:25 - progress_bar.py[line:274] - INFO: epoch 054:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17370.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3089.9, ups=0.18, wpb=17370.8, bsz=1024, num_updates=19670, lr=2.46047e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=129823
2024-11-10 18:58:19 - progress_bar.py[line:274] - INFO: epoch 054:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17531.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3226.6, ups=0.18, wpb=17531.2, bsz=1024, num_updates=19680, lr=2.45902e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=129877
2024-11-10 18:59:19 - progress_bar.py[line:274] - INFO: epoch 054:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.835, ntokens=17637.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=2968.5, ups=0.17, wpb=17637.2, bsz=1024, num_updates=19690, lr=2.45756e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=129937
2024-11-10 19:00:12 - progress_bar.py[line:274] - INFO: epoch 054:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17446.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3234.9, ups=0.19, wpb=17446.2, bsz=1024, num_updates=19700, lr=2.45611e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=129991
2024-11-10 19:01:09 - progress_bar.py[line:274] - INFO: epoch 054:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17544.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3078.5, ups=0.18, wpb=17544.5, bsz=1024, num_updates=19710, lr=2.45466e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=130048
2024-11-10 19:02:04 - progress_bar.py[line:274] - INFO: epoch 054:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17473.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3179.9, ups=0.18, wpb=17473.9, bsz=1024, num_updates=19720, lr=2.4532e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=130103
2024-11-10 19:02:58 - progress_bar.py[line:274] - INFO: epoch 054:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17623.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3281.5, ups=0.19, wpb=17623.4, bsz=1024, num_updates=19730, lr=2.45175e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=130156
reach the end of datafile, start a new reader
2024-11-10 19:03:51 - progress_bar.py[line:274] - INFO: epoch 054:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17443.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3325.8, ups=0.19, wpb=17443.7, bsz=1024, num_updates=19740, lr=2.4503e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=130209
reach the end of datafile, start a new reader
2024-11-10 19:03:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 54 @ 19741 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt

2024-11-10 19:03:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt': File exists: File exists

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 19:05:46 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 19:07:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 54 @ 19741 updates, score 0) (writing took 224.71832130197436 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_54.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442

slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
2024-11-10 19:08:34 - train.py[line:336] - INFO: end of epoch 54 (average epoch stats below)
2024-11-10 19:08:34 - progress_bar.py[line:282] - INFO: epoch 054 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.8 | ntokens 17404 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.96 | wps 2564.8 | ups 0.15 | wpb 17404 | bsz 1023.1 | num_updates 19741 | lr 2.45015e-05 | gnorm 0.005 | clip 0 | loss_scale 262144 | train_wall 1949 | gb_free 13.4 | wall 130492
2024-11-10 19:08:34 - trainer.py[line:639] - INFO: loading train data for epoch 55
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 19:11:02 - trainer.py[line:703] - INFO: begin training epoch 55
2024-11-10 19:11:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 19:11:52 - progress_bar.py[line:274] - INFO: epoch 055:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17057.4, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=354.1, ups=0.02, wpb=17057.4, bsz=998.4, num_updates=19750, lr=2.44884e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=130690
2024-11-10 19:12:48 - progress_bar.py[line:274] - INFO: epoch 055:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17436.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3148.9, ups=0.18, wpb=17436.9, bsz=1024, num_updates=19760, lr=2.44739e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=40, gb_free=13.5, wall=130746
2024-11-10 19:13:46 - progress_bar.py[line:274] - INFO: epoch 055:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17343.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2989.9, ups=0.17, wpb=17343.6, bsz=1024, num_updates=19770, lr=2.44594e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=130804
2024-11-10 19:14:03 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 19:14:50 - progress_bar.py[line:274] - INFO: epoch 055:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17590.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=2743, ups=0.16, wpb=17590.4, bsz=1024, num_updates=19780, lr=2.44448e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=64, gb_free=13.4, wall=130868
2024-11-10 19:15:47 - progress_bar.py[line:274] - INFO: epoch 055:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17345.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3021.1, ups=0.17, wpb=17345.1, bsz=1024, num_updates=19790, lr=2.44303e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=130925
2024-11-10 19:16:45 - progress_bar.py[line:274] - INFO: epoch 055:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17150.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2953.2, ups=0.17, wpb=17150.3, bsz=1024, num_updates=19800, lr=2.44158e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=130983
2024-11-10 19:17:43 - progress_bar.py[line:274] - INFO: epoch 055:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17497.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3015.9, ups=0.17, wpb=17497.3, bsz=1024, num_updates=19810, lr=2.44012e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=131041
2024-11-10 19:18:37 - progress_bar.py[line:274] - INFO: epoch 055:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17620, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3269.3, ups=0.19, wpb=17620, bsz=1024, num_updates=19820, lr=2.43867e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=131095
2024-11-10 19:19:34 - progress_bar.py[line:274] - INFO: epoch 055:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17527.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3094.9, ups=0.18, wpb=17527.5, bsz=1024, num_updates=19830, lr=2.43722e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=131152
2024-11-10 19:20:32 - progress_bar.py[line:274] - INFO: epoch 055:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17231.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2982.8, ups=0.17, wpb=17231.8, bsz=1024, num_updates=19840, lr=2.43576e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=131210
2024-11-10 19:21:30 - progress_bar.py[line:274] - INFO: epoch 055:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17429.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=2966.9, ups=0.17, wpb=17429.7, bsz=1024, num_updates=19850, lr=2.43431e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.2, wall=131269
2024-11-10 19:22:28 - progress_bar.py[line:274] - INFO: epoch 055:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17565.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3056.2, ups=0.17, wpb=17565.2, bsz=1024, num_updates=19860, lr=2.43286e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=131326
2024-11-10 19:23:26 - progress_bar.py[line:274] - INFO: epoch 055:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17147, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2962.4, ups=0.17, wpb=17147, bsz=1024, num_updates=19870, lr=2.4314e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=131384
2024-11-10 19:24:20 - progress_bar.py[line:274] - INFO: epoch 055:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17502.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3223.6, ups=0.18, wpb=17502.9, bsz=1024, num_updates=19880, lr=2.42995e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=131438
2024-11-10 19:25:16 - progress_bar.py[line:274] - INFO: epoch 055:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17481.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3103.4, ups=0.18, wpb=17481.3, bsz=1024, num_updates=19890, lr=2.4285e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=131495
2024-11-10 19:26:11 - progress_bar.py[line:274] - INFO: epoch 055:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.804, ntokens=17479.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3221.7, ups=0.18, wpb=17479.8, bsz=1024, num_updates=19900, lr=2.42704e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=131549
2024-11-10 19:27:09 - progress_bar.py[line:274] - INFO: epoch 055:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17229.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2950.5, ups=0.17, wpb=17229.3, bsz=1024, num_updates=19910, lr=2.42559e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=131607
2024-11-10 19:28:07 - progress_bar.py[line:274] - INFO: epoch 055:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.822, ntokens=17571.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3031.3, ups=0.17, wpb=17571.9, bsz=1024, num_updates=19920, lr=2.42414e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=131665
2024-11-10 19:29:04 - progress_bar.py[line:274] - INFO: epoch 055:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.819, ntokens=17532.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3091.5, ups=0.18, wpb=17532.5, bsz=1024, num_updates=19930, lr=2.42268e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=131722
2024-11-10 19:30:01 - progress_bar.py[line:274] - INFO: epoch 055:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17525.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3030, ups=0.17, wpb=17525.4, bsz=1024, num_updates=19940, lr=2.42123e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=131780
2024-11-10 19:30:56 - progress_bar.py[line:274] - INFO: epoch 055:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17279.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3145.6, ups=0.18, wpb=17279.2, bsz=1015.4, num_updates=19950, lr=2.41978e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=131835
2024-11-10 19:31:49 - progress_bar.py[line:274] - INFO: epoch 055:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17819.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3397.7, ups=0.19, wpb=17819.2, bsz=1024, num_updates=19960, lr=2.41832e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=131887
2024-11-10 19:32:42 - progress_bar.py[line:274] - INFO: epoch 055:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17222.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3267.6, ups=0.19, wpb=17222.6, bsz=1024, num_updates=19970, lr=2.41687e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=131940
2024-11-10 19:33:37 - progress_bar.py[line:274] - INFO: epoch 055:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17379.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3117.3, ups=0.18, wpb=17379.6, bsz=1024, num_updates=19980, lr=2.41542e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=131996
2024-11-10 19:34:34 - progress_bar.py[line:274] - INFO: epoch 055:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17437.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3078.3, ups=0.18, wpb=17437.7, bsz=1024, num_updates=19990, lr=2.41396e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=132052
2024-11-10 19:35:27 - progress_bar.py[line:274] - INFO: epoch 055:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17376.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3270.8, ups=0.19, wpb=17376.7, bsz=1024, num_updates=20000, lr=2.41251e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=132105
loss_reg: 0.005188890596980964 loss_cls: 0.0030314242467284203
loss_reg: 0.007184925478863524 loss_cls: 0.0029589820187538862
loss_reg: 0.006827764793561432 loss_cls: 0.003984024748206139
loss_reg: 0.004930849494800279 loss_cls: 0.003793932031840086
loss_reg: 0.01046698645562898 loss_cls: 0.0034875567071139812
loss_reg: 0.005369373808529335 loss_cls: 0.004672521725296974
loss_reg: 0.007018397896579843 loss_cls: 0.0034057265147566795
loss_reg: 0.01047356749313135 loss_cls: 0.0036281682550907135
loss_reg: 0.00769045486155749 loss_cls: 0.0037367374170571566
loss_reg: 0.005544602097219629 loss_cls: 0.003261157078668475
loss_reg: 0.007065946209467054 loss_cls: 0.0035151084885001183
loss_reg: 0.006433364750989294 loss_cls: 0.0035223793238401413
loss_reg: 0.005153957257541928 loss_cls: 0.0028665403369814157
loss_reg: 0.006905794236969647 loss_cls: 0.0036118391435593367
loss_reg: 0.007450283216879256 loss_cls: 0.003950120415538549
loss_reg: 0.006050778204594774 loss_cls: 0.004084560088813305
loss_reg: 0.006936557411067372 loss_cls: 0.0036974498070776463
loss_reg: 0.006785590443980719 loss_cls: 0.003230305155739188
loss_reg: 0.005111169216866325 loss_cls: 0.003701580688357353
loss_reg: 0.007675154114474355 loss_cls: 0.003403613343834877
loss_reg: 0.006353593958296487 loss_cls: 0.0038521175738424063
loss_reg: 0.004652781360933957 loss_cls: 0.0037807198241353035
loss_reg: 0.007258939297266205 loss_cls: 0.0034785119350999594
loss_reg: 0.006122801364605425 loss_cls: 0.004366602282971144
loss_reg: 0.004479922824151562 loss_cls: 0.003927427344024181
loss_reg: 0.004774373072077936 loss_cls: 0.00353387463837862
loss_reg: 0.005839411988257069 loss_cls: 0.003933927975594997
loss_reg: 0.0056103690126474755 loss_cls: 0.00319096096791327
loss_reg: 0.006193499140813517 loss_cls: 0.003701332723721862
loss_reg: 0.009044901467534469 loss_cls: 0.0034622326493263245
loss_reg: 0.008059104218047194 loss_cls: 0.0032851358409971
loss_reg: 0.007437446268946999 loss_cls: 0.003362376941367984
loss_reg: 0.006528982641921936 loss_cls: 0.003822573460638523
loss_reg: 0.007706961120227797 loss_cls: 0.003380881855264306
loss_reg: 0.006696333979978324 loss_cls: 0.003686178009957075
loss_reg: 0.007860002026996722 loss_cls: 0.003748479066416621
loss_reg: 0.006805404224996294 loss_cls: 0.0032027438282966614
loss_reg: 0.008695518452034857 loss_cls: 0.004120329860597849
loss_reg: 0.006472749002033573 loss_cls: 0.003984644077718258
loss_reg: 0.00469174866805322 loss_cls: 0.004016107879579067
loss_reg: 0.005631155265851322 loss_cls: 0.003893888322636485
loss_reg: 0.005202671186821984 loss_cls: 0.0038877115584909916
loss_reg: 0.007201771884452663 loss_cls: 0.005344113800674677
loss_reg: 0.01110139529638553 loss_cls: 0.00371156120672822
loss_reg: 0.005431261695099326 loss_cls: 0.0034197941422462463
loss_reg: 0.005098192001087949 loss_cls: 0.004505109041929245
loss_reg: 0.006886081020266507 loss_cls: 0.004185037687420845
loss_reg: 0.010181925569682474 loss_cls: 0.004026468843221664
loss_reg: 0.006367496594149955 loss_cls: 0.003001294331625104
loss_reg: 0.010450187585488229 loss_cls: 0.0040585738606750965
loss_reg: 0.0060822343199443294 loss_cls: 0.0035533749032765627
loss_reg: 0.0069851853816812505 loss_cls: 0.003832979593425989
loss_reg: 0.008300747473424599 loss_cls: 0.003375895554199815
loss_reg: 0.0061914633268012826 loss_cls: 0.004214964807033539
loss_reg: 0.006789668326728146 loss_cls: 0.0032370968256145716
loss_reg: 0.005587900812735459 loss_cls: 0.0037750659976154566
loss_reg: 0.006612645636929072 loss_cls: 0.0033831100445240736
loss_reg: 0.006863567878310357 loss_cls: 0.004629223141819239
loss_reg: 0.005625866692473004 loss_cls: 0.00392982829362154
loss_reg: 0.005970399837179167 loss_cls: 0.00443281652405858
loss_reg: 0.006368795978691096 loss_cls: 0.004172002896666527
loss_reg: 0.006881693405188759 loss_cls: 0.004055510740727186
loss_reg: 0.007704630694399046 loss_cls: 0.003944427706301212
loss_reg: 0.004821061974606383 loss_cls: 0.004351655021309853
2024-11-10 19:36:20 - progress_bar.py[line:274] - INFO: epoch 055:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17532.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3285.4, ups=0.19, wpb=17532.2, bsz=1024, num_updates=20010, lr=2.41106e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=132159
2024-11-10 19:37:18 - progress_bar.py[line:274] - INFO: epoch 055:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17264, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3000, ups=0.17, wpb=17264, bsz=1024, num_updates=20020, lr=2.4096e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=132216
2024-11-10 19:38:10 - progress_bar.py[line:274] - INFO: epoch 055:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17074.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3283.7, ups=0.19, wpb=17074.4, bsz=1024, num_updates=20030, lr=2.40815e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=132268
2024-11-10 19:39:03 - progress_bar.py[line:274] - INFO: epoch 055:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17131.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3261.5, ups=0.19, wpb=17131.6, bsz=1024, num_updates=20040, lr=2.4067e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=51, gb_free=13.4, wall=132321
2024-11-10 19:39:57 - progress_bar.py[line:274] - INFO: epoch 055:    310 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17670.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3257.2, ups=0.18, wpb=17670.5, bsz=1024, num_updates=20050, lr=2.40524e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=132375
2024-11-10 19:40:50 - progress_bar.py[line:274] - INFO: epoch 055:    320 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.844, ntokens=17782.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.18, wps=3328.6, ups=0.19, wpb=17782.6, bsz=1024, num_updates=20060, lr=2.40379e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=132428
2024-11-10 19:41:49 - progress_bar.py[line:274] - INFO: epoch 055:    330 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17614.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=2993.8, ups=0.17, wpb=17614.4, bsz=1024, num_updates=20070, lr=2.40234e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.3, wall=132487
2024-11-10 19:42:44 - progress_bar.py[line:274] - INFO: epoch 055:    340 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17464.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3173.9, ups=0.18, wpb=17464.6, bsz=1024, num_updates=20080, lr=2.40088e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=132542
2024-11-10 19:43:40 - progress_bar.py[line:274] - INFO: epoch 055:    350 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17637.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3155.4, ups=0.18, wpb=17637.7, bsz=1024, num_updates=20090, lr=2.39943e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.1, wall=132598
2024-11-10 19:44:38 - progress_bar.py[line:274] - INFO: epoch 055:    360 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17529.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3015.9, ups=0.17, wpb=17529.7, bsz=1024, num_updates=20100, lr=2.39798e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=132656
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 19:45:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 55 @ 20106 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt


cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
2024-11-10 19:45:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt': File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 19:47:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
2024-11-10 19:48:55 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 55 @ 20106 updates, score 0) (writing took 225.22348290501395 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_55.pt
slice_id 6 seek offset 280832
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
2024-11-10 19:49:51 - train.py[line:336] - INFO: end of epoch 55 (average epoch stats below)
2024-11-10 19:49:51 - progress_bar.py[line:282] - INFO: epoch 055 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.799 | ntokens 17427.7 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.96 | wps 2568 | ups 0.15 | wpb 17427.7 | bsz 1023.1 | num_updates 20106 | lr 2.3971e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 2003 | gb_free 13.4 | wall 132969
2024-11-10 19:49:51 - trainer.py[line:639] - INFO: loading train data for epoch 56
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 19:52:23 - trainer.py[line:703] - INFO: begin training epoch 56
2024-11-10 19:52:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 19:52:47 - progress_bar.py[line:274] - INFO: epoch 056:      4 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=16743.3, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=342.6, ups=0.02, wpb=16743.3, bsz=998.4, num_updates=20110, lr=2.39652e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=44, gb_free=13.5, wall=133145
2024-11-10 19:53:42 - progress_bar.py[line:274] - INFO: epoch 056:     14 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17493.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3172.7, ups=0.18, wpb=17493.5, bsz=1024, num_updates=20120, lr=2.39507e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=38, gb_free=13.2, wall=133200
2024-11-10 19:54:35 - progress_bar.py[line:274] - INFO: epoch 056:     24 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17518.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3317.2, ups=0.19, wpb=17518.7, bsz=1024, num_updates=20130, lr=2.39362e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=48, gb_free=13.5, wall=133253
2024-11-10 19:55:33 - progress_bar.py[line:274] - INFO: epoch 056:     34 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17424.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3010.5, ups=0.17, wpb=17424.3, bsz=1024, num_updates=20140, lr=2.39216e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=133311
2024-11-10 19:56:31 - progress_bar.py[line:274] - INFO: epoch 056:     44 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.832, ntokens=17547.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3004.6, ups=0.17, wpb=17547.9, bsz=1024, num_updates=20150, lr=2.39071e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=133369
2024-11-10 19:57:26 - progress_bar.py[line:274] - INFO: epoch 056:     54 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.817, ntokens=17593.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3222.8, ups=0.18, wpb=17593.4, bsz=1024, num_updates=20160, lr=2.38926e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=133424
2024-11-10 19:58:21 - progress_bar.py[line:274] - INFO: epoch 056:     64 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.866, ntokens=17739.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.29, wps=3221, ups=0.18, wpb=17739.4, bsz=1024, num_updates=20170, lr=2.3878e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=133479
2024-11-10 19:59:19 - progress_bar.py[line:274] - INFO: epoch 056:     74 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17679.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3045.7, ups=0.17, wpb=17679.4, bsz=1024, num_updates=20180, lr=2.38635e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=133537
2024-11-10 20:00:15 - progress_bar.py[line:274] - INFO: epoch 056:     84 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17390.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3084.7, ups=0.18, wpb=17390.5, bsz=1024, num_updates=20190, lr=2.3849e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=133593
2024-11-10 20:01:08 - progress_bar.py[line:274] - INFO: epoch 056:     94 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17231.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3246.5, ups=0.19, wpb=17231.4, bsz=1024, num_updates=20200, lr=2.38344e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=133646
2024-11-10 20:02:05 - progress_bar.py[line:274] - INFO: epoch 056:    104 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17617.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3081.9, ups=0.17, wpb=17617.4, bsz=1024, num_updates=20210, lr=2.38199e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=133704
2024-11-10 20:02:59 - progress_bar.py[line:274] - INFO: epoch 056:    114 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17458.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3267.8, ups=0.19, wpb=17458.8, bsz=1024, num_updates=20220, lr=2.38054e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=133757
2024-11-10 20:03:51 - progress_bar.py[line:274] - INFO: epoch 056:    124 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17495.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3332.6, ups=0.19, wpb=17495.1, bsz=1024, num_updates=20230, lr=2.37908e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.5, wall=133810
2024-11-10 20:04:45 - progress_bar.py[line:274] - INFO: epoch 056:    134 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17531.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3261.8, ups=0.19, wpb=17531.7, bsz=1024, num_updates=20240, lr=2.37763e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=133863
2024-11-10 20:05:40 - progress_bar.py[line:274] - INFO: epoch 056:    144 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17611.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3229.2, ups=0.18, wpb=17611.7, bsz=1024, num_updates=20250, lr=2.37618e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=133918
2024-11-10 20:06:34 - progress_bar.py[line:274] - INFO: epoch 056:    154 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17684.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3231.5, ups=0.18, wpb=17684.1, bsz=1024, num_updates=20260, lr=2.37472e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.2, wall=133973
2024-11-10 20:07:32 - progress_bar.py[line:274] - INFO: epoch 056:    164 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17380.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3030.8, ups=0.17, wpb=17380.9, bsz=1024, num_updates=20270, lr=2.37327e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=134030
2024-11-10 20:08:30 - progress_bar.py[line:274] - INFO: epoch 056:    174 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17401.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=2995.6, ups=0.17, wpb=17401.9, bsz=1024, num_updates=20280, lr=2.37182e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.6, wall=134088
2024-11-10 20:09:29 - progress_bar.py[line:274] - INFO: epoch 056:    184 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17560.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=2948, ups=0.17, wpb=17560.4, bsz=1024, num_updates=20290, lr=2.37036e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=134148
2024-11-10 20:10:26 - progress_bar.py[line:274] - INFO: epoch 056:    194 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17543.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3083.2, ups=0.18, wpb=17543.9, bsz=1024, num_updates=20300, lr=2.36891e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=134204
2024-11-10 20:11:22 - progress_bar.py[line:274] - INFO: epoch 056:    204 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17188.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3098.5, ups=0.18, wpb=17188.6, bsz=1024, num_updates=20310, lr=2.36746e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=134260
2024-11-10 20:12:19 - progress_bar.py[line:274] - INFO: epoch 056:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17191.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3003.6, ups=0.17, wpb=17191.2, bsz=1024, num_updates=20320, lr=2.366e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=134317
2024-11-10 20:13:14 - progress_bar.py[line:274] - INFO: epoch 056:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17357.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3140.6, ups=0.18, wpb=17357.3, bsz=1024, num_updates=20330, lr=2.36455e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=134372
2024-11-10 20:14:09 - progress_bar.py[line:274] - INFO: epoch 056:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17414.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3172.7, ups=0.18, wpb=17414.6, bsz=1024, num_updates=20340, lr=2.3631e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=134427
2024-11-10 20:15:08 - progress_bar.py[line:274] - INFO: epoch 056:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17466.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=2988.7, ups=0.17, wpb=17466.5, bsz=1024, num_updates=20350, lr=2.36164e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=134486
2024-11-10 20:16:04 - progress_bar.py[line:274] - INFO: epoch 056:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17339.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3052.9, ups=0.18, wpb=17339.7, bsz=1024, num_updates=20360, lr=2.36019e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=134543
2024-11-10 20:16:58 - progress_bar.py[line:274] - INFO: epoch 056:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17298.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3215.7, ups=0.19, wpb=17298.8, bsz=1024, num_updates=20370, lr=2.35874e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=134596
2024-11-10 20:17:52 - progress_bar.py[line:274] - INFO: epoch 056:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17361.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3233, ups=0.19, wpb=17361.2, bsz=1024, num_updates=20380, lr=2.35728e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.1, wall=134650
2024-11-10 20:18:50 - progress_bar.py[line:274] - INFO: epoch 056:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=16997.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2939.4, ups=0.17, wpb=16997.7, bsz=1015.4, num_updates=20390, lr=2.35583e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=134708
2024-11-10 20:19:48 - progress_bar.py[line:274] - INFO: epoch 056:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17245, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2944.2, ups=0.17, wpb=17245, bsz=1024, num_updates=20400, lr=2.35438e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.6, wall=134766
2024-11-10 20:20:44 - progress_bar.py[line:274] - INFO: epoch 056:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17519.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3137.5, ups=0.18, wpb=17519.3, bsz=1024, num_updates=20410, lr=2.35292e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=134822
2024-11-10 20:21:39 - progress_bar.py[line:274] - INFO: epoch 056:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17785.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3223.4, ups=0.18, wpb=17785.7, bsz=1024, num_updates=20420, lr=2.35147e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=134877
2024-11-10 20:22:38 - progress_bar.py[line:274] - INFO: epoch 056:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.82, ntokens=17656.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.06, wps=3024.4, ups=0.17, wpb=17656.3, bsz=1024, num_updates=20430, lr=2.35002e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=134936
2024-11-10 20:23:35 - progress_bar.py[line:274] - INFO: epoch 056:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17773.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3077.2, ups=0.17, wpb=17773.9, bsz=1024, num_updates=20440, lr=2.34856e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=134994
2024-11-10 20:24:34 - progress_bar.py[line:274] - INFO: epoch 056:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17810.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3036.6, ups=0.17, wpb=17810.6, bsz=1024, num_updates=20450, lr=2.34711e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=135052
2024-11-10 20:25:32 - progress_bar.py[line:274] - INFO: epoch 056:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17451.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2999.4, ups=0.17, wpb=17451.7, bsz=1024, num_updates=20460, lr=2.34566e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=135110
2024-11-10 20:26:27 - progress_bar.py[line:274] - INFO: epoch 056:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17460.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3173.9, ups=0.18, wpb=17460.5, bsz=1024, num_updates=20470, lr=2.3442e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=135165
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 20:26:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 56 @ 20472 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
2024-11-10 20:26:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt'cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt': File existscannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt'
: File exists: File exists: File exists
: File exists

: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 20:27:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 6 seek offset 280832
2024-11-10 20:30:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 56 @ 20472 updates, score 0) (writing took 218.8677925649681 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_56.pt
2024-11-10 20:31:10 - train.py[line:336] - INFO: end of epoch 56 (average epoch stats below)
2024-11-10 20:31:10 - progress_bar.py[line:282] - INFO: epoch 056 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.801 | ntokens 17460.5 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.97 | wps 2578 | ups 0.15 | wpb 17460.5 | bsz 1023.1 | num_updates 20472 | lr 2.34391e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2013 | gb_free 13.3 | wall 135448
2024-11-10 20:31:10 - trainer.py[line:639] - INFO: loading train data for epoch 57
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 20:33:41 - trainer.py[line:703] - INFO: begin training epoch 57
2024-11-10 20:33:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 20:34:25 - progress_bar.py[line:274] - INFO: epoch 057:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=16988.4, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=355.3, ups=0.02, wpb=16988.4, bsz=998.4, num_updates=20480, lr=2.34275e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=33, gb_free=13.3, wall=135644
2024-11-10 20:35:24 - progress_bar.py[line:274] - INFO: epoch 057:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17395.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2985.5, ups=0.17, wpb=17395.4, bsz=1024, num_updates=20490, lr=2.3413e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=49, gb_free=13.4, wall=135702
2024-11-10 20:36:21 - progress_bar.py[line:274] - INFO: epoch 057:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17527.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3038.1, ups=0.17, wpb=17527.4, bsz=1024, num_updates=20500, lr=2.33984e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=135760
2024-11-10 20:37:20 - progress_bar.py[line:274] - INFO: epoch 057:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17425.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=2961.2, ups=0.17, wpb=17425.7, bsz=1024, num_updates=20510, lr=2.33839e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=135818
2024-11-10 20:38:19 - progress_bar.py[line:274] - INFO: epoch 057:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17590.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=2997, ups=0.17, wpb=17590.8, bsz=1024, num_updates=20520, lr=2.33694e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=135877
2024-11-10 20:39:17 - progress_bar.py[line:274] - INFO: epoch 057:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17555.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3012, ups=0.17, wpb=17555.1, bsz=1024, num_updates=20530, lr=2.33548e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=135935
2024-11-10 20:40:15 - progress_bar.py[line:274] - INFO: epoch 057:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17381.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3025.1, ups=0.17, wpb=17381.7, bsz=1024, num_updates=20540, lr=2.33403e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=135993
2024-11-10 20:41:10 - progress_bar.py[line:274] - INFO: epoch 057:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17482.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3146, ups=0.18, wpb=17482.5, bsz=1024, num_updates=20550, lr=2.33258e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=136048
2024-11-10 20:42:05 - progress_bar.py[line:274] - INFO: epoch 057:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17388.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3188.9, ups=0.18, wpb=17388.5, bsz=1024, num_updates=20560, lr=2.33112e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13, wall=136103
2024-11-10 20:43:01 - progress_bar.py[line:274] - INFO: epoch 057:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17157.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3030.4, ups=0.18, wpb=17157.6, bsz=1024, num_updates=20570, lr=2.32967e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=136160
2024-11-10 20:43:57 - progress_bar.py[line:274] - INFO: epoch 057:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17431, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3123.6, ups=0.18, wpb=17431, bsz=1024, num_updates=20580, lr=2.32822e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=136215
2024-11-10 20:44:55 - progress_bar.py[line:274] - INFO: epoch 057:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17586.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3026.8, ups=0.17, wpb=17586.9, bsz=1024, num_updates=20590, lr=2.32676e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=136273
2024-11-10 20:45:48 - progress_bar.py[line:274] - INFO: epoch 057:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17358.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3308, ups=0.19, wpb=17358.4, bsz=1024, num_updates=20600, lr=2.32531e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=136326
2024-11-10 20:46:45 - progress_bar.py[line:274] - INFO: epoch 057:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17448.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3065.7, ups=0.18, wpb=17448.6, bsz=1024, num_updates=20610, lr=2.32386e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=136383
2024-11-10 20:47:42 - progress_bar.py[line:274] - INFO: epoch 057:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17583.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3060.4, ups=0.17, wpb=17583.8, bsz=1024, num_updates=20620, lr=2.3224e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=136440
2024-11-10 20:48:36 - progress_bar.py[line:274] - INFO: epoch 057:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17508.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3270.8, ups=0.19, wpb=17508.4, bsz=1024, num_updates=20630, lr=2.32095e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=136494
2024-11-10 20:49:33 - progress_bar.py[line:274] - INFO: epoch 057:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17471.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3046.5, ups=0.17, wpb=17471.4, bsz=1024, num_updates=20640, lr=2.3195e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=136551
2024-11-10 20:50:31 - progress_bar.py[line:274] - INFO: epoch 057:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17364.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=2978.1, ups=0.17, wpb=17364.2, bsz=1024, num_updates=20650, lr=2.31804e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=136609
2024-11-10 20:51:29 - progress_bar.py[line:274] - INFO: epoch 057:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17303.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=2995.2, ups=0.17, wpb=17303.4, bsz=1024, num_updates=20660, lr=2.31659e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=136667
2024-11-10 20:52:24 - progress_bar.py[line:274] - INFO: epoch 057:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17480.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3163.5, ups=0.18, wpb=17480.2, bsz=1024, num_updates=20670, lr=2.31514e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=136722
2024-11-10 20:53:17 - progress_bar.py[line:274] - INFO: epoch 057:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17397.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3310.4, ups=0.19, wpb=17397.4, bsz=1015.4, num_updates=20680, lr=2.31368e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=52, gb_free=13.3, wall=136775
2024-11-10 20:54:16 - progress_bar.py[line:274] - INFO: epoch 057:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17182.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2907.7, ups=0.17, wpb=17182.9, bsz=1024, num_updates=20690, lr=2.31223e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=136834
2024-11-10 20:55:14 - progress_bar.py[line:274] - INFO: epoch 057:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17564.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3009.6, ups=0.17, wpb=17564.7, bsz=1024, num_updates=20700, lr=2.31078e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=136892
2024-11-10 20:56:08 - progress_bar.py[line:274] - INFO: epoch 057:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.842, ntokens=17818.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.17, wps=3306.7, ups=0.19, wpb=17818.3, bsz=1024, num_updates=20710, lr=2.30932e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=136946
2024-11-10 20:57:06 - progress_bar.py[line:274] - INFO: epoch 057:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17208, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=2988.4, ups=0.17, wpb=17208, bsz=1024, num_updates=20720, lr=2.30787e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=137004
2024-11-10 20:58:03 - progress_bar.py[line:274] - INFO: epoch 057:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17362.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3038, ups=0.17, wpb=17362.5, bsz=1024, num_updates=20730, lr=2.30642e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=137061
2024-11-10 20:59:00 - progress_bar.py[line:274] - INFO: epoch 057:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17292.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3044.5, ups=0.18, wpb=17292.3, bsz=1024, num_updates=20740, lr=2.30496e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=137118
2024-11-10 20:59:54 - progress_bar.py[line:274] - INFO: epoch 057:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17459.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3231.6, ups=0.19, wpb=17459.7, bsz=1024, num_updates=20750, lr=2.30351e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=137172
2024-11-10 21:00:50 - progress_bar.py[line:274] - INFO: epoch 057:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17408.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3117.1, ups=0.18, wpb=17408.2, bsz=1024, num_updates=20760, lr=2.30206e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=137228
2024-11-10 21:01:45 - progress_bar.py[line:274] - INFO: epoch 057:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17348.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3127.9, ups=0.18, wpb=17348.5, bsz=1024, num_updates=20770, lr=2.3006e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=137283
2024-11-10 21:02:38 - progress_bar.py[line:274] - INFO: epoch 057:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17759.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3354.7, ups=0.19, wpb=17759.4, bsz=1024, num_updates=20780, lr=2.29915e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=137336
2024-11-10 21:03:37 - progress_bar.py[line:274] - INFO: epoch 057:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.845, ntokens=17697.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.19, wps=2999.7, ups=0.17, wpb=17697.7, bsz=1024, num_updates=20790, lr=2.2977e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=137395
2024-11-10 21:04:30 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 262144.0
2024-11-10 21:04:36 - progress_bar.py[line:274] - INFO: epoch 057:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17660.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=2986.9, ups=0.17, wpb=17660.2, bsz=1024, num_updates=20800, lr=2.29624e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=137454
2024-11-10 21:05:34 - progress_bar.py[line:274] - INFO: epoch 057:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17583, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3061.5, ups=0.17, wpb=17583, bsz=1024, num_updates=20810, lr=2.29479e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=137512
2024-11-10 21:06:26 - progress_bar.py[line:274] - INFO: epoch 057:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.837, ntokens=17603.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.15, wps=3333.6, ups=0.19, wpb=17603.7, bsz=1024, num_updates=20820, lr=2.29334e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=137565
2024-11-10 21:07:22 - progress_bar.py[line:274] - INFO: epoch 057:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17439.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3158.4, ups=0.18, wpb=17439.8, bsz=1024, num_updates=20830, lr=2.29188e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=137620
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 21:07:59 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 57 @ 20837 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
2024-11-10 21:07:59 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 21:09:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 21:11:41 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 57 @ 20837 updates, score 0) (writing took 221.99135901604313 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_57.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
2024-11-10 21:12:36 - train.py[line:336] - INFO: end of epoch 57 (average epoch stats below)
2024-11-10 21:12:36 - progress_bar.py[line:282] - INFO: epoch 057 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.796 | ntokens 17455.1 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.95 | wps 2562 | ups 0.15 | wpb 17455.1 | bsz 1023.1 | num_updates 20837 | lr 2.29087e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2026 | gb_free 13.3 | wall 137935
2024-11-10 21:12:36 - trainer.py[line:639] - INFO: loading train data for epoch 58
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 21:15:05 - trainer.py[line:703] - INFO: begin training epoch 58
2024-11-10 21:15:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 21:15:24 - progress_bar.py[line:274] - INFO: epoch 058:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.811, ntokens=17235.8, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=357.6, ups=0.02, wpb=17235.8, bsz=998.4, num_updates=20840, lr=2.29043e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=47, gb_free=13.3, wall=138102
2024-11-10 21:16:18 - progress_bar.py[line:274] - INFO: epoch 058:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17308.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3174.3, ups=0.18, wpb=17308.4, bsz=1024, num_updates=20850, lr=2.28898e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=33, gb_free=13.5, wall=138156
2024-11-10 21:17:16 - progress_bar.py[line:274] - INFO: epoch 058:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17552.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3055.8, ups=0.17, wpb=17552.7, bsz=1024, num_updates=20860, lr=2.28752e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=138214
2024-11-10 21:18:12 - progress_bar.py[line:274] - INFO: epoch 058:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17450.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3092.8, ups=0.18, wpb=17450.9, bsz=1024, num_updates=20870, lr=2.28607e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=138270
2024-11-10 21:19:06 - progress_bar.py[line:274] - INFO: epoch 058:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.833, ntokens=17695.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.12, wps=3251.4, ups=0.18, wpb=17695.7, bsz=1024, num_updates=20880, lr=2.28462e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=138325
2024-11-10 21:19:59 - progress_bar.py[line:274] - INFO: epoch 058:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17251.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3252.4, ups=0.19, wpb=17251.4, bsz=1024, num_updates=20890, lr=2.28316e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=138378
2024-11-10 21:20:57 - progress_bar.py[line:274] - INFO: epoch 058:     63 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17248.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3008, ups=0.17, wpb=17248.6, bsz=1024, num_updates=20900, lr=2.28171e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=138435
2024-11-10 21:21:53 - progress_bar.py[line:274] - INFO: epoch 058:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17118.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3021.7, ups=0.18, wpb=17118.2, bsz=1015.4, num_updates=20910, lr=2.28026e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=138492
2024-11-10 21:22:50 - progress_bar.py[line:274] - INFO: epoch 058:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17705.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3129.6, ups=0.18, wpb=17705.9, bsz=1024, num_updates=20920, lr=2.2788e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.1, wall=138548
2024-11-10 21:23:45 - progress_bar.py[line:274] - INFO: epoch 058:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17492.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3177.4, ups=0.18, wpb=17492.3, bsz=1024, num_updates=20930, lr=2.27735e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=138603
2024-11-10 21:24:38 - progress_bar.py[line:274] - INFO: epoch 058:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17226.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3263.2, ups=0.19, wpb=17226.7, bsz=1024, num_updates=20940, lr=2.2759e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=138656
2024-11-10 21:25:36 - progress_bar.py[line:274] - INFO: epoch 058:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17328.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2983.1, ups=0.17, wpb=17328.2, bsz=1024, num_updates=20950, lr=2.27444e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=138714
2024-11-10 21:26:33 - progress_bar.py[line:274] - INFO: epoch 058:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17365.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3029.4, ups=0.17, wpb=17365.8, bsz=1024, num_updates=20960, lr=2.27299e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=138772
2024-11-10 21:27:30 - progress_bar.py[line:274] - INFO: epoch 058:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17401.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3048, ups=0.18, wpb=17401.5, bsz=1024, num_updates=20970, lr=2.27154e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=138829
2024-11-10 21:28:24 - progress_bar.py[line:274] - INFO: epoch 058:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17171.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3221.4, ups=0.19, wpb=17171.1, bsz=1024, num_updates=20980, lr=2.27008e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.2, wall=138882
2024-11-10 21:29:18 - progress_bar.py[line:274] - INFO: epoch 058:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17488.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3231.3, ups=0.18, wpb=17488.5, bsz=1024, num_updates=20990, lr=2.26863e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=138936
2024-11-10 21:30:15 - progress_bar.py[line:274] - INFO: epoch 058:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17201.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3009.8, ups=0.17, wpb=17201.1, bsz=1024, num_updates=21000, lr=2.26718e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=138993
2024-11-10 21:31:13 - progress_bar.py[line:274] - INFO: epoch 058:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17358.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=2999.7, ups=0.17, wpb=17358.7, bsz=1024, num_updates=21010, lr=2.26572e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.1, wall=139051
2024-11-10 21:32:07 - progress_bar.py[line:274] - INFO: epoch 058:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17494.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3223.9, ups=0.18, wpb=17494.2, bsz=1024, num_updates=21020, lr=2.26427e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=139105
2024-11-10 21:33:02 - progress_bar.py[line:274] - INFO: epoch 058:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17500.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3165.3, ups=0.18, wpb=17500.4, bsz=1024, num_updates=21030, lr=2.26282e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=139161
2024-11-10 21:34:00 - progress_bar.py[line:274] - INFO: epoch 058:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.823, ntokens=17685.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3072.5, ups=0.17, wpb=17685.9, bsz=1024, num_updates=21040, lr=2.26136e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=139218
2024-11-10 21:34:56 - progress_bar.py[line:274] - INFO: epoch 058:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17257.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3079.5, ups=0.18, wpb=17257.1, bsz=1024, num_updates=21050, lr=2.25991e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=139274
2024-11-10 21:35:50 - progress_bar.py[line:274] - INFO: epoch 058:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17389.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3229.1, ups=0.19, wpb=17389.1, bsz=1024, num_updates=21060, lr=2.25846e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=139328
2024-11-10 21:36:47 - progress_bar.py[line:274] - INFO: epoch 058:    233 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17343.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3048.6, ups=0.18, wpb=17343.5, bsz=1024, num_updates=21070, lr=2.257e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=139385
2024-11-10 21:37:43 - progress_bar.py[line:274] - INFO: epoch 058:    243 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17308.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3049.3, ups=0.18, wpb=17308.3, bsz=1024, num_updates=21080, lr=2.25555e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=139442
2024-11-10 21:38:40 - progress_bar.py[line:274] - INFO: epoch 058:    253 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17180.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3052.2, ups=0.18, wpb=17180.4, bsz=1024, num_updates=21090, lr=2.2541e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=139498
2024-11-10 21:39:36 - progress_bar.py[line:274] - INFO: epoch 058:    263 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17084.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3066.2, ups=0.18, wpb=17084.4, bsz=1024, num_updates=21100, lr=2.25265e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=139554
2024-11-10 21:40:32 - progress_bar.py[line:274] - INFO: epoch 058:    273 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17404.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3054.2, ups=0.18, wpb=17404.7, bsz=1024, num_updates=21110, lr=2.25119e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=139611
2024-11-10 21:41:30 - progress_bar.py[line:274] - INFO: epoch 058:    283 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17231.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3009.5, ups=0.17, wpb=17231.5, bsz=1024, num_updates=21120, lr=2.24974e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=139668
2024-11-10 21:42:28 - progress_bar.py[line:274] - INFO: epoch 058:    293 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17365.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3005.2, ups=0.17, wpb=17365.1, bsz=1024, num_updates=21130, lr=2.24829e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=139726
2024-11-10 21:43:26 - progress_bar.py[line:274] - INFO: epoch 058:    303 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17512.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3018.9, ups=0.17, wpb=17512.4, bsz=1024, num_updates=21140, lr=2.24683e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=139784
2024-11-10 21:44:21 - progress_bar.py[line:274] - INFO: epoch 058:    313 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17595.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3150.9, ups=0.18, wpb=17595.1, bsz=1024, num_updates=21150, lr=2.24538e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=139840
2024-11-10 21:45:17 - progress_bar.py[line:274] - INFO: epoch 058:    323 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17762.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3166.4, ups=0.18, wpb=17762.4, bsz=1024, num_updates=21160, lr=2.24393e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=139896
2024-11-10 21:46:13 - progress_bar.py[line:274] - INFO: epoch 058:    333 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.818, ntokens=17734, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.05, wps=3190.3, ups=0.18, wpb=17734, bsz=1024, num_updates=21170, lr=2.24247e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=139951
2024-11-10 21:47:07 - progress_bar.py[line:274] - INFO: epoch 058:    343 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17640.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3242.5, ups=0.18, wpb=17640.7, bsz=1024, num_updates=21180, lr=2.24102e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=140006
2024-11-10 21:48:04 - progress_bar.py[line:274] - INFO: epoch 058:    353 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17804, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=3151.3, ups=0.18, wpb=17804, bsz=1024, num_updates=21190, lr=2.23957e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=140062
2024-11-10 21:49:01 - progress_bar.py[line:274] - INFO: epoch 058:    363 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17513.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3096.7, ups=0.18, wpb=17513.8, bsz=1024, num_updates=21200, lr=2.23811e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=140119
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 21:49:15 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 58 @ 21203 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
2024-11-10 21:49:15 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt': File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 21:51:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-10 21:52:58 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 58 @ 21203 updates, score 0) (writing took 223.23536628298461 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_58.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
2024-11-10 21:53:53 - train.py[line:336] - INFO: end of epoch 58 (average epoch stats below)
2024-11-10 21:53:53 - progress_bar.py[line:282] - INFO: epoch 058 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.785 | ntokens 17414.6 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.89 | wps 2573.3 | ups 0.15 | wpb 17414.6 | bsz 1023.1 | num_updates 21203 | lr 2.23768e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2015 | gb_free 13.5 | wall 140411
2024-11-10 21:53:53 - trainer.py[line:639] - INFO: loading train data for epoch 59
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 21:56:23 - trainer.py[line:703] - INFO: begin training epoch 59
2024-11-10 21:56:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 21:57:04 - progress_bar.py[line:274] - INFO: epoch 059:      7 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=16986.9, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=351.2, ups=0.02, wpb=16986.9, bsz=998.4, num_updates=21210, lr=2.23666e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=35, gb_free=13.4, wall=140602
2024-11-10 21:57:59 - progress_bar.py[line:274] - INFO: epoch 059:     17 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17515.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3185.9, ups=0.18, wpb=17515.3, bsz=1024, num_updates=21220, lr=2.23521e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=32, gb_free=13.5, wall=140657
2024-11-10 21:58:52 - progress_bar.py[line:274] - INFO: epoch 059:     27 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17492.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3296.3, ups=0.19, wpb=17492.6, bsz=1024, num_updates=21230, lr=2.23375e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=39, gb_free=13.4, wall=140710
2024-11-10 21:59:47 - progress_bar.py[line:274] - INFO: epoch 059:     37 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17331.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3161.3, ups=0.18, wpb=17331.2, bsz=1024, num_updates=21240, lr=2.2323e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=43, gb_free=13.4, wall=140765
2024-11-10 22:00:46 - progress_bar.py[line:274] - INFO: epoch 059:     47 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17408.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=2976.9, ups=0.17, wpb=17408.2, bsz=1024, num_updates=21250, lr=2.23085e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.2, wall=140824
2024-11-10 22:01:43 - progress_bar.py[line:274] - INFO: epoch 059:     57 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17581.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3082.9, ups=0.18, wpb=17581.4, bsz=1024, num_updates=21260, lr=2.22939e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=140881
2024-11-10 22:02:37 - progress_bar.py[line:274] - INFO: epoch 059:     67 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.839, ntokens=17746.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.16, wps=3276.4, ups=0.18, wpb=17746.7, bsz=1024, num_updates=21270, lr=2.22794e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=140935
2024-11-10 22:02:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-10 22:03:40 - progress_bar.py[line:274] - INFO: epoch 059:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17268.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2749.1, ups=0.16, wpb=17268.4, bsz=1024, num_updates=21280, lr=2.22649e-05, gnorm=0.007, clip=0, loss_scale=131072, train_wall=63, gb_free=13.4, wall=140998
2024-11-10 22:04:37 - progress_bar.py[line:274] - INFO: epoch 059:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17785.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3076.4, ups=0.17, wpb=17785.8, bsz=1024, num_updates=21290, lr=2.22503e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.6, wall=141056
2024-11-10 22:05:34 - progress_bar.py[line:274] - INFO: epoch 059:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17189.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3053.1, ups=0.18, wpb=17189.5, bsz=1024, num_updates=21300, lr=2.22358e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=141112
2024-11-10 22:06:32 - progress_bar.py[line:274] - INFO: epoch 059:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17662.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3018.5, ups=0.17, wpb=17662.2, bsz=1024, num_updates=21310, lr=2.22213e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=141170
2024-11-10 22:07:26 - progress_bar.py[line:274] - INFO: epoch 059:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17652.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3288.1, ups=0.19, wpb=17652.2, bsz=1024, num_updates=21320, lr=2.22067e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=141224
2024-11-10 22:08:25 - progress_bar.py[line:274] - INFO: epoch 059:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17215.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2901, ups=0.17, wpb=17215.3, bsz=1024, num_updates=21330, lr=2.21922e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=141283
2024-11-10 22:09:23 - progress_bar.py[line:274] - INFO: epoch 059:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=2977.4, ups=0.17, wpb=17269.4, bsz=1024, num_updates=21340, lr=2.21777e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=141341
2024-11-10 22:10:22 - progress_bar.py[line:274] - INFO: epoch 059:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17261.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=2950.7, ups=0.17, wpb=17261.1, bsz=1024, num_updates=21350, lr=2.21631e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=141400
2024-11-10 22:11:20 - progress_bar.py[line:274] - INFO: epoch 059:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17511.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=2979.2, ups=0.17, wpb=17511.2, bsz=1024, num_updates=21360, lr=2.21486e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=141459
2024-11-10 22:12:19 - progress_bar.py[line:274] - INFO: epoch 059:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=2963.1, ups=0.17, wpb=17345, bsz=1024, num_updates=21370, lr=2.21341e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=141517
2024-11-10 22:13:15 - progress_bar.py[line:274] - INFO: epoch 059:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17528, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3157.4, ups=0.18, wpb=17528, bsz=1024, num_updates=21380, lr=2.21195e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=141573
2024-11-10 22:14:10 - progress_bar.py[line:274] - INFO: epoch 059:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17215.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3079.8, ups=0.18, wpb=17215.2, bsz=1015.4, num_updates=21390, lr=2.2105e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=141629
2024-11-10 22:15:08 - progress_bar.py[line:274] - INFO: epoch 059:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17159.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2967.6, ups=0.17, wpb=17159.6, bsz=1024, num_updates=21400, lr=2.20905e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=141686
2024-11-10 22:16:03 - progress_bar.py[line:274] - INFO: epoch 059:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17591.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3186.9, ups=0.18, wpb=17591.5, bsz=1024, num_updates=21410, lr=2.20759e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=141742
2024-11-10 22:16:56 - progress_bar.py[line:274] - INFO: epoch 059:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17238.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3271.8, ups=0.19, wpb=17238.8, bsz=1024, num_updates=21420, lr=2.20614e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=141794
2024-11-10 22:17:53 - progress_bar.py[line:274] - INFO: epoch 059:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17422.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3046.4, ups=0.17, wpb=17422.7, bsz=1024, num_updates=21430, lr=2.20469e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=141852
2024-11-10 22:18:47 - progress_bar.py[line:274] - INFO: epoch 059:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17555.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3263.4, ups=0.19, wpb=17555.8, bsz=1024, num_updates=21440, lr=2.20323e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=141905
2024-11-10 22:19:44 - progress_bar.py[line:274] - INFO: epoch 059:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17387.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3067, ups=0.18, wpb=17387.1, bsz=1024, num_updates=21450, lr=2.20178e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=141962
2024-11-10 22:20:38 - progress_bar.py[line:274] - INFO: epoch 059:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17251.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3185.2, ups=0.18, wpb=17251.9, bsz=1024, num_updates=21460, lr=2.20033e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=142016
2024-11-10 22:21:32 - progress_bar.py[line:274] - INFO: epoch 059:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.828, ntokens=17698.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.1, wps=3257.3, ups=0.18, wpb=17698.9, bsz=1024, num_updates=21470, lr=2.19887e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.5, wall=142071
2024-11-10 22:22:29 - progress_bar.py[line:274] - INFO: epoch 059:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17400.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3083, ups=0.18, wpb=17400.5, bsz=1024, num_updates=21480, lr=2.19742e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=142127
2024-11-10 22:23:21 - progress_bar.py[line:274] - INFO: epoch 059:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17341.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3294.3, ups=0.19, wpb=17341.6, bsz=1024, num_updates=21490, lr=2.19597e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=53, gb_free=13.4, wall=142180
2024-11-10 22:24:18 - progress_bar.py[line:274] - INFO: epoch 059:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17175, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3032.5, ups=0.18, wpb=17175, bsz=1024, num_updates=21500, lr=2.19451e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=142236
2024-11-10 22:25:16 - progress_bar.py[line:274] - INFO: epoch 059:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17504.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3041.1, ups=0.17, wpb=17504.6, bsz=1024, num_updates=21510, lr=2.19306e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=142294
2024-11-10 22:26:10 - progress_bar.py[line:274] - INFO: epoch 059:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17679.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3256.3, ups=0.18, wpb=17679.8, bsz=1024, num_updates=21520, lr=2.19161e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=142348
2024-11-10 22:27:05 - progress_bar.py[line:274] - INFO: epoch 059:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17732.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3203.2, ups=0.18, wpb=17732.2, bsz=1024, num_updates=21530, lr=2.19015e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=142403
2024-11-10 22:28:03 - progress_bar.py[line:274] - INFO: epoch 059:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17502.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3021.1, ups=0.17, wpb=17502.8, bsz=1024, num_updates=21540, lr=2.1887e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=142461
2024-11-10 22:28:57 - progress_bar.py[line:274] - INFO: epoch 059:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.81, ntokens=17542, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3281.4, ups=0.19, wpb=17542, bsz=1024, num_updates=21550, lr=2.18725e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.5, wall=142515
2024-11-10 22:29:54 - progress_bar.py[line:274] - INFO: epoch 059:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17646.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3085.6, ups=0.17, wpb=17646.3, bsz=1024, num_updates=21560, lr=2.18579e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=142572
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 22:30:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 59 @ 21568 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
2024-11-10 22:30:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt': File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 22:32:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
2024-11-10 22:34:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 59 @ 21568 updates, score 0) (writing took 222.8216145139886 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_59.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
2024-11-10 22:35:14 - train.py[line:336] - INFO: end of epoch 59 (average epoch stats below)
2024-11-10 22:35:14 - progress_bar.py[line:282] - INFO: epoch 059 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.784 | ntokens 17444 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.89 | wps 2566.8 | ups 0.15 | wpb 17444 | bsz 1023.1 | num_updates 21568 | lr 2.18463e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 1981 | gb_free 13.4 | wall 142892
2024-11-10 22:35:14 - trainer.py[line:639] - INFO: loading train data for epoch 60
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 22:37:45 - trainer.py[line:703] - INFO: begin training epoch 60
2024-11-10 22:37:45 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 22:37:58 - progress_bar.py[line:274] - INFO: epoch 060:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.834, ntokens=17397.6, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.13, wps=359.3, ups=0.02, wpb=17397.6, bsz=998.4, num_updates=21570, lr=2.18434e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=47, gb_free=13.4, wall=143056
2024-11-10 22:38:53 - progress_bar.py[line:274] - INFO: epoch 060:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17279.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3167.7, ups=0.18, wpb=17279.5, bsz=1024, num_updates=21580, lr=2.18289e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=31, gb_free=13.4, wall=143111
2024-11-10 22:39:47 - progress_bar.py[line:274] - INFO: epoch 060:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17236.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3180.2, ups=0.18, wpb=17236.2, bsz=1024, num_updates=21590, lr=2.18143e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=50, gb_free=13.4, wall=143165
2024-11-10 22:40:45 - progress_bar.py[line:274] - INFO: epoch 060:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17313.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2958.6, ups=0.17, wpb=17313.2, bsz=1024, num_updates=21600, lr=2.17998e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=143224
2024-11-10 22:41:43 - progress_bar.py[line:274] - INFO: epoch 060:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17320.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3020, ups=0.17, wpb=17320.4, bsz=1024, num_updates=21610, lr=2.17853e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=143281
2024-11-10 22:42:40 - progress_bar.py[line:274] - INFO: epoch 060:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17459.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3040.1, ups=0.17, wpb=17459.3, bsz=1024, num_updates=21620, lr=2.17707e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=143338
2024-11-10 22:43:37 - progress_bar.py[line:274] - INFO: epoch 060:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17205.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3028.6, ups=0.18, wpb=17205.6, bsz=1024, num_updates=21630, lr=2.17562e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=143395
2024-11-10 22:44:34 - progress_bar.py[line:274] - INFO: epoch 060:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17197.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3032.5, ups=0.18, wpb=17197.4, bsz=1024, num_updates=21640, lr=2.17417e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=143452
2024-11-10 22:45:32 - progress_bar.py[line:274] - INFO: epoch 060:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17526.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=2995.1, ups=0.17, wpb=17526.6, bsz=1024, num_updates=21650, lr=2.17271e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=143510
2024-11-10 22:46:29 - progress_bar.py[line:274] - INFO: epoch 060:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17530.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3090.6, ups=0.18, wpb=17530.5, bsz=1024, num_updates=21660, lr=2.17126e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=143567
2024-11-10 22:47:23 - progress_bar.py[line:274] - INFO: epoch 060:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17374.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3215.5, ups=0.19, wpb=17374.3, bsz=1024, num_updates=21670, lr=2.16981e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=143621
2024-11-10 22:48:21 - progress_bar.py[line:274] - INFO: epoch 060:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17493.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3010.8, ups=0.17, wpb=17493.2, bsz=1024, num_updates=21680, lr=2.16835e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=143679
2024-11-10 22:49:13 - progress_bar.py[line:274] - INFO: epoch 060:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17351.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3359.5, ups=0.19, wpb=17351.7, bsz=1024, num_updates=21690, lr=2.1669e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=143731
2024-11-10 22:50:10 - progress_bar.py[line:274] - INFO: epoch 060:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17376.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3034.2, ups=0.17, wpb=17376.1, bsz=1024, num_updates=21700, lr=2.16545e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=143788
2024-11-10 22:51:08 - progress_bar.py[line:274] - INFO: epoch 060:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17483.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3010.9, ups=0.17, wpb=17483.4, bsz=1024, num_updates=21710, lr=2.16399e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=143846
2024-11-10 22:52:05 - progress_bar.py[line:274] - INFO: epoch 060:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17556, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3070.4, ups=0.17, wpb=17556, bsz=1024, num_updates=21720, lr=2.16254e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=143903
2024-11-10 22:53:02 - progress_bar.py[line:274] - INFO: epoch 060:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17225.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3013.2, ups=0.17, wpb=17225.7, bsz=1024, num_updates=21730, lr=2.16109e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=143961
2024-11-10 22:54:00 - progress_bar.py[line:274] - INFO: epoch 060:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17485.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3011.1, ups=0.17, wpb=17485.6, bsz=1024, num_updates=21740, lr=2.15963e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=144019
2024-11-10 22:54:58 - progress_bar.py[line:274] - INFO: epoch 060:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17370, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3010.1, ups=0.17, wpb=17370, bsz=1024, num_updates=21750, lr=2.15818e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=144076
2024-11-10 22:55:56 - progress_bar.py[line:274] - INFO: epoch 060:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17461, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3031.8, ups=0.17, wpb=17461, bsz=1024, num_updates=21760, lr=2.15673e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.1, wall=144134
2024-11-10 22:56:55 - progress_bar.py[line:274] - INFO: epoch 060:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17351.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=2932.4, ups=0.17, wpb=17351.7, bsz=1024, num_updates=21770, lr=2.15527e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=144193
2024-11-10 22:57:52 - progress_bar.py[line:274] - INFO: epoch 060:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17152.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2988.2, ups=0.17, wpb=17152.9, bsz=1024, num_updates=21780, lr=2.15382e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=144250
2024-11-10 22:58:48 - progress_bar.py[line:274] - INFO: epoch 060:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17462.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3134.5, ups=0.18, wpb=17462.1, bsz=1024, num_updates=21790, lr=2.15237e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=144306
2024-11-10 22:59:46 - progress_bar.py[line:274] - INFO: epoch 060:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17539.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3045.3, ups=0.17, wpb=17539.8, bsz=1024, num_updates=21800, lr=2.15091e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=144364
2024-11-10 23:00:44 - progress_bar.py[line:274] - INFO: epoch 060:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17394.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=2964.3, ups=0.17, wpb=17394.5, bsz=1024, num_updates=21810, lr=2.14946e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=144422
2024-11-10 23:01:43 - progress_bar.py[line:274] - INFO: epoch 060:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17208.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2953.5, ups=0.17, wpb=17208.7, bsz=1024, num_updates=21820, lr=2.14801e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=144481
2024-11-10 23:02:41 - progress_bar.py[line:274] - INFO: epoch 060:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17250.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2946.6, ups=0.17, wpb=17250.7, bsz=1024, num_updates=21830, lr=2.14655e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=144539
2024-11-10 23:03:39 - progress_bar.py[line:274] - INFO: epoch 060:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17087.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2940.8, ups=0.17, wpb=17087.1, bsz=1015.4, num_updates=21840, lr=2.1451e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=144597
2024-11-10 23:04:36 - progress_bar.py[line:274] - INFO: epoch 060:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17283.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3024.4, ups=0.17, wpb=17283.1, bsz=1024, num_updates=21850, lr=2.14365e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=144655
2024-11-10 23:05:32 - progress_bar.py[line:274] - INFO: epoch 060:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17553.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3163.4, ups=0.18, wpb=17553.4, bsz=1024, num_updates=21860, lr=2.14219e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.6, wall=144710
2024-11-10 23:06:29 - progress_bar.py[line:274] - INFO: epoch 060:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17606.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3063.5, ups=0.17, wpb=17606.9, bsz=1024, num_updates=21870, lr=2.14074e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=144768
2024-11-10 23:07:26 - progress_bar.py[line:274] - INFO: epoch 060:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17605.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3088, ups=0.18, wpb=17605.3, bsz=1024, num_updates=21880, lr=2.13929e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=144825
2024-11-10 23:08:24 - progress_bar.py[line:274] - INFO: epoch 060:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.809, ntokens=17638.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.01, wps=3066.3, ups=0.17, wpb=17638.3, bsz=1024, num_updates=21890, lr=2.13783e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=144882
2024-11-10 23:09:21 - progress_bar.py[line:274] - INFO: epoch 060:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17765.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3090.5, ups=0.17, wpb=17765.8, bsz=1024, num_updates=21900, lr=2.13638e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=144940
2024-11-10 23:10:16 - progress_bar.py[line:274] - INFO: epoch 060:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.815, ntokens=17768.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3220.9, ups=0.18, wpb=17768.7, bsz=1024, num_updates=21910, lr=2.13493e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=144995
2024-11-10 23:11:13 - progress_bar.py[line:274] - INFO: epoch 060:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17493.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3085, ups=0.18, wpb=17493.1, bsz=1024, num_updates=21920, lr=2.13347e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13, wall=145051
2024-11-10 23:12:10 - progress_bar.py[line:274] - INFO: epoch 060:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.808, ntokens=17771.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3114.1, ups=0.18, wpb=17771.9, bsz=1024, num_updates=21930, lr=2.13202e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=145108
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 23:12:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 60 @ 21934 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
2024-11-10 23:12:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt': File exists: File exists

: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 23:14:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-10 23:16:14 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 60 @ 21934 updates, score 0) (writing took 223.7286487580277 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_60.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
2024-11-10 23:17:10 - train.py[line:336] - INFO: end of epoch 60 (average epoch stats below)
2024-11-10 23:17:10 - progress_bar.py[line:282] - INFO: epoch 060 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.775 | ntokens 17413.8 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.84 | wps 2533 | ups 0.15 | wpb 17413.8 | bsz 1023.1 | num_updates 21934 | lr 2.13144e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2045 | gb_free 13.4 | wall 145408
2024-11-10 23:17:10 - trainer.py[line:639] - INFO: loading train data for epoch 61
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-10 23:19:41 - trainer.py[line:703] - INFO: begin training epoch 61
2024-11-10 23:19:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-10 23:20:15 - progress_bar.py[line:274] - INFO: epoch 061:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=16779.6, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=345.8, ups=0.02, wpb=16779.6, bsz=998.4, num_updates=21940, lr=2.13057e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=39, gb_free=13.3, wall=145594
2024-11-10 23:21:14 - progress_bar.py[line:274] - INFO: epoch 061:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17327.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2961.5, ups=0.17, wpb=17327.6, bsz=1024, num_updates=21950, lr=2.12911e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=49, gb_free=13.5, wall=145652
2024-11-10 23:22:13 - progress_bar.py[line:274] - INFO: epoch 061:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17486.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=2947, ups=0.17, wpb=17486.6, bsz=1024, num_updates=21960, lr=2.12766e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=145712
2024-11-10 23:23:08 - progress_bar.py[line:274] - INFO: epoch 061:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.789, ntokens=17602.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3230.5, ups=0.18, wpb=17602.4, bsz=1024, num_updates=21970, lr=2.12621e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=145766
2024-11-10 23:24:05 - progress_bar.py[line:274] - INFO: epoch 061:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17512, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3075.7, ups=0.18, wpb=17512, bsz=1024, num_updates=21980, lr=2.12475e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=145823
2024-11-10 23:25:02 - progress_bar.py[line:274] - INFO: epoch 061:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17305.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3010, ups=0.17, wpb=17305.7, bsz=1024, num_updates=21990, lr=2.1233e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=145880
2024-11-10 23:26:01 - progress_bar.py[line:274] - INFO: epoch 061:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17485.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=2962.6, ups=0.17, wpb=17485.9, bsz=1024, num_updates=22000, lr=2.12185e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.2, wall=145939
2024-11-10 23:26:55 - progress_bar.py[line:274] - INFO: epoch 061:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17293.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3235.5, ups=0.19, wpb=17293.3, bsz=1024, num_updates=22010, lr=2.12039e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=145993
2024-11-10 23:27:53 - progress_bar.py[line:274] - INFO: epoch 061:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17341, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=2982.5, ups=0.17, wpb=17341, bsz=1024, num_updates=22020, lr=2.11894e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.2, wall=146051
2024-11-10 23:28:48 - progress_bar.py[line:274] - INFO: epoch 061:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.816, ntokens=17715.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.04, wps=3203.8, ups=0.18, wpb=17715.2, bsz=1024, num_updates=22030, lr=2.11749e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=146106
2024-11-10 23:29:43 - progress_bar.py[line:274] - INFO: epoch 061:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17580.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3222.9, ups=0.18, wpb=17580.7, bsz=1024, num_updates=22040, lr=2.11603e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=146161
2024-11-10 23:30:40 - progress_bar.py[line:274] - INFO: epoch 061:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17428.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3024.9, ups=0.17, wpb=17428.6, bsz=1024, num_updates=22050, lr=2.11458e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=146219
2024-11-10 23:31:38 - progress_bar.py[line:274] - INFO: epoch 061:    126 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17193.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2969.5, ups=0.17, wpb=17193.7, bsz=1024, num_updates=22060, lr=2.11313e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=146276
2024-11-10 23:32:36 - progress_bar.py[line:274] - INFO: epoch 061:    136 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17159.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2984.9, ups=0.17, wpb=17159.9, bsz=1024, num_updates=22070, lr=2.11167e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=146334
2024-11-10 23:33:34 - progress_bar.py[line:274] - INFO: epoch 061:    146 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17480.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=2997.7, ups=0.17, wpb=17480.7, bsz=1024, num_updates=22080, lr=2.11022e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=146392
2024-11-10 23:34:33 - progress_bar.py[line:274] - INFO: epoch 061:    156 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17172.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2930.8, ups=0.17, wpb=17172.8, bsz=1024, num_updates=22090, lr=2.10877e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=146451
2024-11-10 23:35:30 - progress_bar.py[line:274] - INFO: epoch 061:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17493.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3042.3, ups=0.17, wpb=17493.2, bsz=1024, num_updates=22100, lr=2.10731e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.2, wall=146508
2024-11-10 23:36:28 - progress_bar.py[line:274] - INFO: epoch 061:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17332.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2995.8, ups=0.17, wpb=17332.3, bsz=1024, num_updates=22110, lr=2.10586e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=146566
2024-11-10 23:37:27 - progress_bar.py[line:274] - INFO: epoch 061:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17369.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2956.7, ups=0.17, wpb=17369.7, bsz=1024, num_updates=22120, lr=2.10441e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=146625
2024-11-10 23:38:25 - progress_bar.py[line:274] - INFO: epoch 061:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17328.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=2950.7, ups=0.17, wpb=17328.4, bsz=1024, num_updates=22130, lr=2.10295e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=146684
2024-11-10 23:39:24 - progress_bar.py[line:274] - INFO: epoch 061:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17519, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2998.1, ups=0.17, wpb=17519, bsz=1024, num_updates=22140, lr=2.1015e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=146742
2024-11-10 23:40:22 - progress_bar.py[line:274] - INFO: epoch 061:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17426.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3011.4, ups=0.17, wpb=17426.1, bsz=1024, num_updates=22150, lr=2.10005e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=146800
2024-11-10 23:41:19 - progress_bar.py[line:274] - INFO: epoch 061:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17356.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3013.4, ups=0.17, wpb=17356.2, bsz=1024, num_updates=22160, lr=2.09859e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=146858
2024-11-10 23:42:15 - progress_bar.py[line:274] - INFO: epoch 061:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.821, ntokens=17644.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.07, wps=3156.5, ups=0.18, wpb=17644.5, bsz=1024, num_updates=22170, lr=2.09714e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=146913
2024-11-10 23:43:11 - progress_bar.py[line:274] - INFO: epoch 061:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17283.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3109.6, ups=0.18, wpb=17283.2, bsz=1024, num_updates=22180, lr=2.09569e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=146969
2024-11-10 23:44:06 - progress_bar.py[line:274] - INFO: epoch 061:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17211, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3108.5, ups=0.18, wpb=17211, bsz=1024, num_updates=22190, lr=2.09423e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=147024
2024-11-10 23:45:01 - progress_bar.py[line:274] - INFO: epoch 061:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17319.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3185.7, ups=0.18, wpb=17319.7, bsz=1024, num_updates=22200, lr=2.09278e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=147079
2024-11-10 23:45:53 - progress_bar.py[line:274] - INFO: epoch 061:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17061.6, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3257.8, ups=0.19, wpb=17061.6, bsz=1015.4, num_updates=22210, lr=2.09133e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=147131
2024-11-10 23:46:49 - progress_bar.py[line:274] - INFO: epoch 061:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17274.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3069.7, ups=0.18, wpb=17274.6, bsz=1024, num_updates=22220, lr=2.08987e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=147187
2024-11-10 23:47:42 - progress_bar.py[line:274] - INFO: epoch 061:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17415.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3269.2, ups=0.19, wpb=17415.3, bsz=1024, num_updates=22230, lr=2.08842e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=147241
2024-11-10 23:48:37 - progress_bar.py[line:274] - INFO: epoch 061:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17764.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3237.1, ups=0.18, wpb=17764.3, bsz=1024, num_updates=22240, lr=2.08697e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=147296
2024-11-10 23:49:36 - progress_bar.py[line:274] - INFO: epoch 061:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17500.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2999, ups=0.17, wpb=17500.8, bsz=1024, num_updates=22250, lr=2.08551e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=147354
2024-11-10 23:50:30 - progress_bar.py[line:274] - INFO: epoch 061:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17841.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3263.2, ups=0.18, wpb=17841.2, bsz=1024, num_updates=22260, lr=2.08406e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=147409
2024-11-10 23:51:30 - progress_bar.py[line:274] - INFO: epoch 061:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.826, ntokens=17976.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3040.8, ups=0.17, wpb=17976.4, bsz=1024, num_updates=22270, lr=2.08261e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.2, wall=147468
2024-11-10 23:52:23 - progress_bar.py[line:274] - INFO: epoch 061:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17466, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3288.3, ups=0.19, wpb=17466, bsz=1024, num_updates=22280, lr=2.08115e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=147521
2024-11-10 23:53:22 - progress_bar.py[line:274] - INFO: epoch 061:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17481.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=2964, ups=0.17, wpb=17481.6, bsz=1024, num_updates=22290, lr=2.0797e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=59, gb_free=13.2, wall=147580
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-10 23:54:17 - progress_bar.py[line:274] - INFO: epoch 061:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.803, ntokens=17147.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.98, wps=3121.4, ups=0.18, wpb=17147.2, bsz=998.4, num_updates=22300, lr=2.07825e-05, gnorm=0.003, clip=0, loss_scale=524288, train_wall=55, gb_free=13.6, wall=147635
2024-11-10 23:54:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 61 @ 22300 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
2024-11-10 23:54:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt': File exists: File exists
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-10 23:56:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 2 seek offset 93612
2024-11-10 23:58:01 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 61 @ 22300 updates, score 0) (writing took 224.532955964969 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_61.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-10 23:58:57 - train.py[line:336] - INFO: end of epoch 61 (average epoch stats below)
2024-11-10 23:58:57 - progress_bar.py[line:282] - INFO: epoch 061 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.772 | ntokens 17417.8 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.83 | wps 2542.9 | ups 0.15 | wpb 17417.8 | bsz 1023.1 | num_updates 22300 | lr 2.07825e-05 | gnorm 0.004 | clip 0 | loss_scale 524288 | train_wall 2046 | gb_free 13.6 | wall 147915
2024-11-10 23:58:57 - trainer.py[line:639] - INFO: loading train data for epoch 62
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 00:01:28 - trainer.py[line:703] - INFO: begin training epoch 62
2024-11-11 00:01:28 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 00:02:24 - progress_bar.py[line:274] - INFO: epoch 062:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17358.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=356.5, ups=0.02, wpb=17358.8, bsz=1024, num_updates=22310, lr=2.07679e-05, gnorm=0.003, clip=0, loss_scale=524288, train_wall=30, gb_free=13.5, wall=148122
2024-11-11 00:02:41 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 262144.0
2024-11-11 00:03:28 - progress_bar.py[line:274] - INFO: epoch 062:     21 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17403.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=2692.1, ups=0.15, wpb=17403.6, bsz=1024, num_updates=22320, lr=2.07534e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=148186
2024-11-11 00:04:20 - progress_bar.py[line:274] - INFO: epoch 062:     31 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17270.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3343.3, ups=0.19, wpb=17270.8, bsz=1015.4, num_updates=22330, lr=2.07389e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.5, wall=148238
2024-11-11 00:05:15 - progress_bar.py[line:274] - INFO: epoch 062:     41 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17597.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3186.5, ups=0.18, wpb=17597.2, bsz=1024, num_updates=22340, lr=2.07243e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=148293
2024-11-11 00:06:11 - progress_bar.py[line:274] - INFO: epoch 062:     51 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17729.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3197, ups=0.18, wpb=17729.5, bsz=1024, num_updates=22350, lr=2.07098e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=148349
2024-11-11 00:07:05 - progress_bar.py[line:274] - INFO: epoch 062:     61 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.813, ntokens=17776, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3262.3, ups=0.18, wpb=17776, bsz=1024, num_updates=22360, lr=2.06953e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=148403
2024-11-11 00:08:02 - progress_bar.py[line:274] - INFO: epoch 062:     71 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17116.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3011.9, ups=0.18, wpb=17116.7, bsz=1024, num_updates=22370, lr=2.06807e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=148460
2024-11-11 00:09:01 - progress_bar.py[line:274] - INFO: epoch 062:     81 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17407.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2958.4, ups=0.17, wpb=17407.9, bsz=1024, num_updates=22380, lr=2.06662e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=148519
2024-11-11 00:09:55 - progress_bar.py[line:274] - INFO: epoch 062:     91 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17424, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3180.9, ups=0.18, wpb=17424, bsz=1024, num_updates=22390, lr=2.06517e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.1, wall=148574
2024-11-11 00:10:52 - progress_bar.py[line:274] - INFO: epoch 062:    101 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.806, ntokens=17698, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3144.5, ups=0.18, wpb=17698, bsz=1024, num_updates=22400, lr=2.06371e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=148630
2024-11-11 00:11:51 - progress_bar.py[line:274] - INFO: epoch 062:    111 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17287.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2918.6, ups=0.17, wpb=17287.6, bsz=1024, num_updates=22410, lr=2.06226e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=148689
2024-11-11 00:12:49 - progress_bar.py[line:274] - INFO: epoch 062:    121 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17572.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3006.5, ups=0.17, wpb=17572.1, bsz=1024, num_updates=22420, lr=2.06081e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=148748
2024-11-11 00:13:48 - progress_bar.py[line:274] - INFO: epoch 062:    131 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17173.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2932.9, ups=0.17, wpb=17173.1, bsz=1024, num_updates=22430, lr=2.05935e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=148806
2024-11-11 00:14:44 - progress_bar.py[line:274] - INFO: epoch 062:    141 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17376.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3102.3, ups=0.18, wpb=17376.4, bsz=1024, num_updates=22440, lr=2.0579e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=148862
2024-11-11 00:15:40 - progress_bar.py[line:274] - INFO: epoch 062:    151 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17519.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=3146.1, ups=0.18, wpb=17519.1, bsz=1024, num_updates=22450, lr=2.05645e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=148918
2024-11-11 00:16:33 - progress_bar.py[line:274] - INFO: epoch 062:    161 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17584.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3278.6, ups=0.19, wpb=17584.2, bsz=1024, num_updates=22460, lr=2.05499e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=148972
2024-11-11 00:17:26 - progress_bar.py[line:274] - INFO: epoch 062:    171 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17497.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3297.8, ups=0.19, wpb=17497.1, bsz=1024, num_updates=22470, lr=2.05354e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.2, wall=149025
2024-11-11 00:18:23 - progress_bar.py[line:274] - INFO: epoch 062:    181 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17624.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3097.4, ups=0.18, wpb=17624.1, bsz=1024, num_updates=22480, lr=2.05209e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=149081
2024-11-11 00:19:18 - progress_bar.py[line:274] - INFO: epoch 062:    191 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17363.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3187.9, ups=0.18, wpb=17363.3, bsz=1024, num_updates=22490, lr=2.05063e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=149136
2024-11-11 00:20:17 - progress_bar.py[line:274] - INFO: epoch 062:    201 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17458.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2961.3, ups=0.17, wpb=17458.2, bsz=1024, num_updates=22500, lr=2.04918e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=149195
2024-11-11 00:21:16 - progress_bar.py[line:274] - INFO: epoch 062:    211 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17494.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=2939.1, ups=0.17, wpb=17494.4, bsz=1024, num_updates=22510, lr=2.04773e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=149254
2024-11-11 00:22:14 - progress_bar.py[line:274] - INFO: epoch 062:    221 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17456.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3030.8, ups=0.17, wpb=17456.2, bsz=1024, num_updates=22520, lr=2.04627e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=149312
2024-11-11 00:23:06 - progress_bar.py[line:274] - INFO: epoch 062:    231 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17417.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3337.2, ups=0.19, wpb=17417.2, bsz=1024, num_updates=22530, lr=2.04482e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=149364
2024-11-11 00:24:05 - progress_bar.py[line:274] - INFO: epoch 062:    241 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17348.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=2934, ups=0.17, wpb=17348.5, bsz=1024, num_updates=22540, lr=2.04337e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=149423
2024-11-11 00:25:03 - progress_bar.py[line:274] - INFO: epoch 062:    251 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.793, ntokens=17486.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3030.4, ups=0.17, wpb=17486.3, bsz=1024, num_updates=22550, lr=2.04191e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=149481
2024-11-11 00:26:01 - progress_bar.py[line:274] - INFO: epoch 062:    261 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17153, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2940.1, ups=0.17, wpb=17153, bsz=1024, num_updates=22560, lr=2.04046e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=149539
2024-11-11 00:27:00 - progress_bar.py[line:274] - INFO: epoch 062:    271 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17211.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2922.6, ups=0.17, wpb=17211.8, bsz=1024, num_updates=22570, lr=2.03901e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=149598
2024-11-11 00:27:59 - progress_bar.py[line:274] - INFO: epoch 062:    281 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17387.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=2971.4, ups=0.17, wpb=17387.6, bsz=1024, num_updates=22580, lr=2.03755e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=149657
2024-11-11 00:28:52 - progress_bar.py[line:274] - INFO: epoch 062:    291 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17490.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3248, ups=0.19, wpb=17490.6, bsz=1024, num_updates=22590, lr=2.0361e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=149711
2024-11-11 00:29:51 - progress_bar.py[line:274] - INFO: epoch 062:    301 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17432.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=2981.9, ups=0.17, wpb=17432.9, bsz=1024, num_updates=22600, lr=2.03465e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=149769
2024-11-11 00:30:49 - progress_bar.py[line:274] - INFO: epoch 062:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17560.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3030.7, ups=0.17, wpb=17560.8, bsz=1024, num_updates=22610, lr=2.03319e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.1, wall=149827
2024-11-11 00:31:45 - progress_bar.py[line:274] - INFO: epoch 062:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17660.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3138.6, ups=0.18, wpb=17660.6, bsz=1024, num_updates=22620, lr=2.03174e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=149883
2024-11-11 00:32:38 - progress_bar.py[line:274] - INFO: epoch 062:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17612, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3314.1, ups=0.19, wpb=17612, bsz=1024, num_updates=22630, lr=2.03029e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=149936
2024-11-11 00:33:36 - progress_bar.py[line:274] - INFO: epoch 062:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17633.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.93, wps=3040.3, ups=0.17, wpb=17633.1, bsz=1024, num_updates=22640, lr=2.02883e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=149994
2024-11-11 00:34:31 - progress_bar.py[line:274] - INFO: epoch 062:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.797, ntokens=17567, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3229.4, ups=0.18, wpb=17567, bsz=1024, num_updates=22650, lr=2.02738e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=150049
2024-11-11 00:35:26 - progress_bar.py[line:274] - INFO: epoch 062:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17462.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3152.5, ups=0.18, wpb=17462.9, bsz=1024, num_updates=22660, lr=2.02593e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=150104
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 00:35:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 62 @ 22665 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt

2024-11-11 00:35:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt': File exists
: File exists: File exists: File exists


local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 00:37:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-11 00:39:32 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 62 @ 22665 updates, score 0) (writing took 221.6501047029742 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_62.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
2024-11-11 00:40:28 - train.py[line:336] - INFO: end of epoch 62 (average epoch stats below)
2024-11-11 00:40:28 - progress_bar.py[line:282] - INFO: epoch 062 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.771 | ntokens 17455 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.83 | wps 2558 | ups 0.15 | wpb 17455 | bsz 1023.1 | num_updates 22665 | lr 2.0252e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2026 | gb_free 13.6 | wall 150406
2024-11-11 00:40:28 - trainer.py[line:639] - INFO: loading train data for epoch 63
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 00:42:59 - trainer.py[line:703] - INFO: begin training epoch 63
2024-11-11 00:42:59 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 00:43:27 - progress_bar.py[line:274] - INFO: epoch 063:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=16999, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=353.2, ups=0.02, wpb=16999, bsz=998.4, num_updates=22670, lr=2.02447e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=40, gb_free=13.6, wall=150586
2024-11-11 00:44:21 - progress_bar.py[line:274] - INFO: epoch 063:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17391.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3215.2, ups=0.18, wpb=17391.4, bsz=1024, num_updates=22680, lr=2.02302e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=33, gb_free=13.5, wall=150640
2024-11-11 00:45:20 - progress_bar.py[line:274] - INFO: epoch 063:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17301.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2955.3, ups=0.17, wpb=17301.2, bsz=1024, num_updates=22690, lr=2.02157e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=50, gb_free=13.4, wall=150698
2024-11-11 00:46:19 - progress_bar.py[line:274] - INFO: epoch 063:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17446, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=2944.6, ups=0.17, wpb=17446, bsz=1024, num_updates=22700, lr=2.02011e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=150757
2024-11-11 00:47:19 - progress_bar.py[line:274] - INFO: epoch 063:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17305.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2913.6, ups=0.17, wpb=17305.5, bsz=1024, num_updates=22710, lr=2.01866e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=59, gb_free=13.2, wall=150817
2024-11-11 00:48:16 - progress_bar.py[line:274] - INFO: epoch 063:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17428.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3023.7, ups=0.17, wpb=17428.6, bsz=1024, num_updates=22720, lr=2.01721e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.6, wall=150875
2024-11-11 00:49:14 - progress_bar.py[line:274] - INFO: epoch 063:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17416.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3040.8, ups=0.17, wpb=17416.3, bsz=1024, num_updates=22730, lr=2.01575e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=150932
2024-11-11 00:50:11 - progress_bar.py[line:274] - INFO: epoch 063:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17140.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2986.1, ups=0.17, wpb=17140.6, bsz=1024, num_updates=22740, lr=2.0143e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=150989
2024-11-11 00:51:09 - progress_bar.py[line:274] - INFO: epoch 063:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17746, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=3037.2, ups=0.17, wpb=17746, bsz=1024, num_updates=22750, lr=2.01285e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=151048
2024-11-11 00:52:06 - progress_bar.py[line:274] - INFO: epoch 063:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17489.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3114.5, ups=0.18, wpb=17489.1, bsz=1024, num_updates=22760, lr=2.01139e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=151104
2024-11-11 00:53:04 - progress_bar.py[line:274] - INFO: epoch 063:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17231.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2959.4, ups=0.17, wpb=17231.3, bsz=1024, num_updates=22770, lr=2.00994e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=151162
2024-11-11 00:53:58 - progress_bar.py[line:274] - INFO: epoch 063:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17265.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3206.4, ups=0.19, wpb=17265.3, bsz=1024, num_updates=22780, lr=2.00849e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=151216
2024-11-11 00:54:51 - progress_bar.py[line:274] - INFO: epoch 063:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17424.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3289.2, ups=0.19, wpb=17424.3, bsz=1024, num_updates=22790, lr=2.00703e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=151269
2024-11-11 00:55:50 - progress_bar.py[line:274] - INFO: epoch 063:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17452.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2952.1, ups=0.17, wpb=17452.4, bsz=1024, num_updates=22800, lr=2.00558e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=151328
2024-11-11 00:56:48 - progress_bar.py[line:274] - INFO: epoch 063:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17522.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=2993.2, ups=0.17, wpb=17522.6, bsz=1024, num_updates=22810, lr=2.00413e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=151386
2024-11-11 00:57:45 - progress_bar.py[line:274] - INFO: epoch 063:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.796, ntokens=17536.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3102.4, ups=0.18, wpb=17536.3, bsz=1024, num_updates=22820, lr=2.00267e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=151443
2024-11-11 00:58:22 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 262144.0
2024-11-11 00:58:43 - progress_bar.py[line:274] - INFO: epoch 063:    166 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17280.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2965.4, ups=0.17, wpb=17280.3, bsz=1024, num_updates=22830, lr=2.00122e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=151501
2024-11-11 00:59:41 - progress_bar.py[line:274] - INFO: epoch 063:    176 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17453.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3036.7, ups=0.17, wpb=17453.1, bsz=1024, num_updates=22840, lr=1.99977e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=151559
2024-11-11 01:00:38 - progress_bar.py[line:274] - INFO: epoch 063:    186 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.78, ntokens=17471.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3033, ups=0.17, wpb=17471.1, bsz=1024, num_updates=22850, lr=1.99831e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=151616
2024-11-11 01:01:33 - progress_bar.py[line:274] - INFO: epoch 063:    196 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17453.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3173.8, ups=0.18, wpb=17453.1, bsz=1024, num_updates=22860, lr=1.99686e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=151671
2024-11-11 01:02:28 - progress_bar.py[line:274] - INFO: epoch 063:    206 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17104.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3097.5, ups=0.18, wpb=17104.3, bsz=1024, num_updates=22870, lr=1.99541e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=151727
2024-11-11 01:03:26 - progress_bar.py[line:274] - INFO: epoch 063:    216 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17355.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3005.4, ups=0.17, wpb=17355.6, bsz=1024, num_updates=22880, lr=1.99395e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=151784
2024-11-11 01:04:24 - progress_bar.py[line:274] - INFO: epoch 063:    226 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17250.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=2987.7, ups=0.17, wpb=17250.7, bsz=1024, num_updates=22890, lr=1.9925e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=151842
2024-11-11 01:05:18 - progress_bar.py[line:274] - INFO: epoch 063:    236 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17093.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3180.4, ups=0.19, wpb=17093.8, bsz=1015.4, num_updates=22900, lr=1.99105e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=151896
2024-11-11 01:06:16 - progress_bar.py[line:274] - INFO: epoch 063:    246 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17407, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2968.2, ups=0.17, wpb=17407, bsz=1024, num_updates=22910, lr=1.98959e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=59, gb_free=13.5, wall=151954
2024-11-11 01:07:09 - progress_bar.py[line:274] - INFO: epoch 063:    256 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17397.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3318.4, ups=0.19, wpb=17397.8, bsz=1024, num_updates=22920, lr=1.98814e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.5, wall=152007
2024-11-11 01:08:07 - progress_bar.py[line:274] - INFO: epoch 063:    266 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.788, ntokens=17534.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2986.8, ups=0.17, wpb=17534.9, bsz=1024, num_updates=22930, lr=1.98669e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.2, wall=152066
2024-11-11 01:09:04 - progress_bar.py[line:274] - INFO: epoch 063:    276 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.779, ntokens=17666.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3120.3, ups=0.18, wpb=17666.6, bsz=1024, num_updates=22940, lr=1.98523e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=152122
2024-11-11 01:09:59 - progress_bar.py[line:274] - INFO: epoch 063:    286 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.783, ntokens=17420.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=3149.6, ups=0.18, wpb=17420.1, bsz=1024, num_updates=22950, lr=1.98378e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=152178
2024-11-11 01:10:56 - progress_bar.py[line:274] - INFO: epoch 063:    296 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17484.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3076.5, ups=0.18, wpb=17484.3, bsz=1024, num_updates=22960, lr=1.98233e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.2, wall=152234
2024-11-11 01:11:51 - progress_bar.py[line:274] - INFO: epoch 063:    306 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17402.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3148.1, ups=0.18, wpb=17402.2, bsz=1024, num_updates=22970, lr=1.98087e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=152290
2024-11-11 01:12:48 - progress_bar.py[line:274] - INFO: epoch 063:    316 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.8, ntokens=17659.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=3124.8, ups=0.18, wpb=17659.9, bsz=1024, num_updates=22980, lr=1.97942e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=152346
2024-11-11 01:13:47 - progress_bar.py[line:274] - INFO: epoch 063:    326 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.799, ntokens=17681.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.96, wps=2998.3, ups=0.17, wpb=17681.2, bsz=1024, num_updates=22990, lr=1.97797e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=152405
2024-11-11 01:14:45 - progress_bar.py[line:274] - INFO: epoch 063:    336 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17652.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3016.2, ups=0.17, wpb=17652.7, bsz=1024, num_updates=23000, lr=1.97651e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=152464
2024-11-11 01:15:43 - progress_bar.py[line:274] - INFO: epoch 063:    346 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17582, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3036.7, ups=0.17, wpb=17582, bsz=1024, num_updates=23010, lr=1.97506e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=152522
2024-11-11 01:16:40 - progress_bar.py[line:274] - INFO: epoch 063:    356 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17399.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3054.9, ups=0.18, wpb=17399.3, bsz=1024, num_updates=23020, lr=1.97361e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.2, wall=152579
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 01:17:33 - progress_bar.py[line:274] - INFO: epoch 063:    366 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.827, ntokens=17482.1, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=7.09, wps=3321.3, ups=0.19, wpb=17482.1, bsz=998.4, num_updates=23030, lr=1.97215e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=152631
2024-11-11 01:17:33 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 63 @ 23030 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt2024-11-11 01:17:33 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt

cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 01:19:25 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
2024-11-11 01:21:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 63 @ 23030 updates, score 0) (writing took 225.00684064201778 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_63.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
2024-11-11 01:22:14 - train.py[line:336] - INFO: end of epoch 63 (average epoch stats below)
2024-11-11 01:22:14 - progress_bar.py[line:282] - INFO: epoch 063 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.762 | ntokens 17420.1 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.79 | wps 2537.1 | ups 0.15 | wpb 17420.1 | bsz 1023.1 | num_updates 23030 | lr 1.97215e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 2028 | gb_free 13.4 | wall 152912
2024-11-11 01:22:14 - trainer.py[line:639] - INFO: loading train data for epoch 64
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 01:24:44 - trainer.py[line:703] - INFO: begin training epoch 64
2024-11-11 01:24:44 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 01:25:40 - progress_bar.py[line:274] - INFO: epoch 064:     10 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17250.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=354.1, ups=0.02, wpb=17250.3, bsz=1024, num_updates=23040, lr=1.9707e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=153118
2024-11-11 01:26:34 - progress_bar.py[line:274] - INFO: epoch 064:     20 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17578.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3229, ups=0.18, wpb=17578.3, bsz=1024, num_updates=23050, lr=1.96925e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=41, gb_free=13.4, wall=153173
2024-11-11 01:27:28 - progress_bar.py[line:274] - INFO: epoch 064:     30 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17081.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3180.5, ups=0.19, wpb=17081.1, bsz=1024, num_updates=23060, lr=1.96779e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=47, gb_free=13.5, wall=153226
2024-11-11 01:28:25 - progress_bar.py[line:274] - INFO: epoch 064:     40 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17465.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3058.8, ups=0.18, wpb=17465.7, bsz=1024, num_updates=23070, lr=1.96634e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=153283
2024-11-11 01:29:20 - progress_bar.py[line:274] - INFO: epoch 064:     50 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17413.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3206.2, ups=0.18, wpb=17413.7, bsz=1024, num_updates=23080, lr=1.96489e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.1, wall=153338
2024-11-11 01:30:17 - progress_bar.py[line:274] - INFO: epoch 064:     60 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17387.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3003.1, ups=0.17, wpb=17387.5, bsz=1024, num_updates=23090, lr=1.96343e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=153396
2024-11-11 01:31:15 - progress_bar.py[line:274] - INFO: epoch 064:     70 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17527.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3060.1, ups=0.17, wpb=17527.9, bsz=1024, num_updates=23100, lr=1.96198e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=153453
2024-11-11 01:32:13 - progress_bar.py[line:274] - INFO: epoch 064:     80 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17265.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2975.4, ups=0.17, wpb=17265.7, bsz=1024, num_updates=23110, lr=1.96053e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=153511
2024-11-11 01:33:11 - progress_bar.py[line:274] - INFO: epoch 064:     90 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17304.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=2972.8, ups=0.17, wpb=17304.1, bsz=1024, num_updates=23120, lr=1.95907e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=58, gb_free=13.4, wall=153569
2024-11-11 01:34:10 - progress_bar.py[line:274] - INFO: epoch 064:    100 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17409.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=2935.1, ups=0.17, wpb=17409.2, bsz=1024, num_updates=23130, lr=1.95762e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=59, gb_free=13.4, wall=153629
2024-11-11 01:35:05 - progress_bar.py[line:274] - INFO: epoch 064:    110 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17542.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3219.9, ups=0.18, wpb=17542.7, bsz=1024, num_updates=23140, lr=1.95617e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=153683
2024-11-11 01:36:03 - progress_bar.py[line:274] - INFO: epoch 064:    120 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17592.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3042.8, ups=0.17, wpb=17592.1, bsz=1024, num_updates=23150, lr=1.95471e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=58, gb_free=13.3, wall=153741
2024-11-11 01:36:57 - progress_bar.py[line:274] - INFO: epoch 064:    130 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17519.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3220, ups=0.18, wpb=17519.4, bsz=1024, num_updates=23160, lr=1.95326e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=153795
2024-11-11 01:37:54 - progress_bar.py[line:274] - INFO: epoch 064:    140 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17325.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3038, ups=0.18, wpb=17325.2, bsz=1024, num_updates=23170, lr=1.95181e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=153852
2024-11-11 01:38:48 - progress_bar.py[line:274] - INFO: epoch 064:    150 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17220.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3207.2, ups=0.19, wpb=17220.3, bsz=1024, num_updates=23180, lr=1.95035e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=153906
2024-11-11 01:39:46 - progress_bar.py[line:274] - INFO: epoch 064:    160 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17519.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3028.9, ups=0.17, wpb=17519.7, bsz=1024, num_updates=23190, lr=1.9489e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=58, gb_free=13.5, wall=153964
2024-11-11 01:40:42 - progress_bar.py[line:274] - INFO: epoch 064:    170 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17298.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3093.1, ups=0.18, wpb=17298.4, bsz=1024, num_updates=23200, lr=1.94745e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=154020
2024-11-11 01:41:35 - progress_bar.py[line:274] - INFO: epoch 064:    180 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17305.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3263.6, ups=0.19, wpb=17305.8, bsz=1024, num_updates=23210, lr=1.94599e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=154073
2024-11-11 01:42:30 - progress_bar.py[line:274] - INFO: epoch 064:    190 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17268, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3115.8, ups=0.18, wpb=17268, bsz=1024, num_updates=23220, lr=1.94454e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=154128
2024-11-11 01:43:27 - progress_bar.py[line:274] - INFO: epoch 064:    200 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17302.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3025.9, ups=0.17, wpb=17302.7, bsz=1024, num_updates=23230, lr=1.94309e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=154185
2024-11-11 01:44:27 - progress_bar.py[line:274] - INFO: epoch 064:    210 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17482.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=2931.1, ups=0.17, wpb=17482.2, bsz=1024, num_updates=23240, lr=1.94163e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=60, gb_free=13.5, wall=154245
2024-11-11 01:45:23 - progress_bar.py[line:274] - INFO: epoch 064:    220 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17476, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3099.3, ups=0.18, wpb=17476, bsz=1024, num_updates=23250, lr=1.94018e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=154301
2024-11-11 01:46:18 - progress_bar.py[line:274] - INFO: epoch 064:    230 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17472.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3198.9, ups=0.18, wpb=17472.2, bsz=1024, num_updates=23260, lr=1.93873e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=154356
2024-11-11 01:47:17 - progress_bar.py[line:274] - INFO: epoch 064:    240 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17498, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.91, wps=2951, ups=0.17, wpb=17498, bsz=1024, num_updates=23270, lr=1.93727e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=59, gb_free=13.3, wall=154415
2024-11-11 01:48:15 - progress_bar.py[line:274] - INFO: epoch 064:    250 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17430.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3035.2, ups=0.17, wpb=17430.6, bsz=1024, num_updates=23280, lr=1.93582e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=154473
2024-11-11 01:49:07 - progress_bar.py[line:274] - INFO: epoch 064:    260 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17590.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3337.8, ups=0.19, wpb=17590.9, bsz=1024, num_updates=23290, lr=1.93437e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=154525
2024-11-11 01:50:07 - progress_bar.py[line:274] - INFO: epoch 064:    270 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17339.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2900.4, ups=0.17, wpb=17339.2, bsz=1024, num_updates=23300, lr=1.93291e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=60, gb_free=13.3, wall=154585
2024-11-11 01:51:03 - progress_bar.py[line:274] - INFO: epoch 064:    280 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17463.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3131.6, ups=0.18, wpb=17463.4, bsz=1024, num_updates=23310, lr=1.93146e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=154641
2024-11-11 01:51:59 - progress_bar.py[line:274] - INFO: epoch 064:    290 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17485.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3089.9, ups=0.18, wpb=17485.9, bsz=1024, num_updates=23320, lr=1.93001e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=154698
2024-11-11 01:52:56 - progress_bar.py[line:274] - INFO: epoch 064:    300 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.776, ntokens=17664.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3112.9, ups=0.18, wpb=17664.3, bsz=1024, num_updates=23330, lr=1.92855e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=154754
2024-11-11 01:53:02 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-11 01:54:00 - progress_bar.py[line:274] - INFO: epoch 064:    311 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.79, ntokens=17728.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=2770.2, ups=0.16, wpb=17728.3, bsz=1024, num_updates=23340, lr=1.9271e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=64, gb_free=13.1, wall=154818
2024-11-11 01:54:58 - progress_bar.py[line:274] - INFO: epoch 064:    321 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.814, ntokens=17701.1, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=7.03, wps=3040.8, ups=0.17, wpb=17701.1, bsz=1015.4, num_updates=23350, lr=1.92565e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.2, wall=154877
2024-11-11 01:55:55 - progress_bar.py[line:274] - INFO: epoch 064:    331 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17543.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3123.1, ups=0.18, wpb=17543.1, bsz=1024, num_updates=23360, lr=1.92419e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=154933
2024-11-11 01:56:54 - progress_bar.py[line:274] - INFO: epoch 064:    341 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17526.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2948.2, ups=0.17, wpb=17526.4, bsz=1024, num_updates=23370, lr=1.92274e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=154992
2024-11-11 01:57:52 - progress_bar.py[line:274] - INFO: epoch 064:    351 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.854, ntokens=18007, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.23, wps=3125, ups=0.17, wpb=18007, bsz=1024, num_updates=23380, lr=1.92129e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=155050
2024-11-11 01:58:50 - progress_bar.py[line:274] - INFO: epoch 064:    361 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.784, ntokens=17659.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3013.3, ups=0.17, wpb=17659.5, bsz=1024, num_updates=23390, lr=1.91983e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=155108
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 01:59:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 64 @ 23395 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
2024-11-11 01:59:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt': File exists
: File exists: File exists
: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 02:01:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
2024-11-11 02:02:59 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 64 @ 23395 updates, score 0) (writing took 222.08891759696417 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_64.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
2024-11-11 02:03:54 - train.py[line:336] - INFO: end of epoch 64 (average epoch stats below)
2024-11-11 02:03:54 - progress_bar.py[line:282] - INFO: epoch 064 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.762 | ntokens 17445.6 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.78 | wps 2546.8 | ups 0.15 | wpb 17445.6 | bsz 1023.1 | num_updates 23395 | lr 1.91911e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 2021 | gb_free 13.3 | wall 155412
2024-11-11 02:03:54 - trainer.py[line:639] - INFO: loading train data for epoch 65
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 02:06:25 - trainer.py[line:703] - INFO: begin training epoch 65
2024-11-11 02:06:25 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 02:06:54 - progress_bar.py[line:274] - INFO: epoch 065:      5 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=16883.4, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=349.1, ups=0.02, wpb=16883.4, bsz=998.4, num_updates=23400, lr=1.91838e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=42, gb_free=13.5, wall=155592
2024-11-11 02:07:50 - progress_bar.py[line:274] - INFO: epoch 065:     15 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17189.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3036.3, ups=0.18, wpb=17189.3, bsz=1024, num_updates=23410, lr=1.91693e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=42, gb_free=13.3, wall=155649
2024-11-11 02:08:49 - progress_bar.py[line:274] - INFO: epoch 065:     25 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17423.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2953.2, ups=0.17, wpb=17423.2, bsz=1024, num_updates=23420, lr=1.91547e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=155708
2024-11-11 02:09:48 - progress_bar.py[line:274] - INFO: epoch 065:     35 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.782, ntokens=17529, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.88, wps=2995.7, ups=0.17, wpb=17529, bsz=1024, num_updates=23430, lr=1.91402e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=155766
2024-11-11 02:10:44 - progress_bar.py[line:274] - INFO: epoch 065:     45 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17417.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3120.6, ups=0.18, wpb=17417.2, bsz=1024, num_updates=23440, lr=1.91257e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=155822
2024-11-11 02:11:40 - progress_bar.py[line:274] - INFO: epoch 065:     55 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17463.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3094.3, ups=0.18, wpb=17463.8, bsz=1024, num_updates=23450, lr=1.91111e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=155878
2024-11-11 02:12:34 - progress_bar.py[line:274] - INFO: epoch 065:     65 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17257.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3186.1, ups=0.18, wpb=17257.3, bsz=1024, num_updates=23460, lr=1.90966e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=54, gb_free=13.3, wall=155933
2024-11-11 02:13:31 - progress_bar.py[line:274] - INFO: epoch 065:     75 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17251.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3024.4, ups=0.18, wpb=17251.2, bsz=1024, num_updates=23470, lr=1.90821e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=155990
2024-11-11 02:14:29 - progress_bar.py[line:274] - INFO: epoch 065:     85 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17432, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3044.9, ups=0.17, wpb=17432, bsz=1024, num_updates=23480, lr=1.90676e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=156047
2024-11-11 02:15:26 - progress_bar.py[line:274] - INFO: epoch 065:     95 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17440.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3018.3, ups=0.17, wpb=17440.3, bsz=1024, num_updates=23490, lr=1.9053e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=156105
2024-11-11 02:16:26 - progress_bar.py[line:274] - INFO: epoch 065:    105 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.802, ntokens=17722.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=2997.7, ups=0.17, wpb=17722.2, bsz=1024, num_updates=23500, lr=1.90385e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=156164
2024-11-11 02:17:25 - progress_bar.py[line:274] - INFO: epoch 065:    115 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17506.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2961.4, ups=0.17, wpb=17506.8, bsz=1024, num_updates=23510, lr=1.9024e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=156223
2024-11-11 02:18:23 - progress_bar.py[line:274] - INFO: epoch 065:    125 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17600.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3024.7, ups=0.17, wpb=17600.1, bsz=1024, num_updates=23520, lr=1.90094e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=156281
2024-11-11 02:19:18 - progress_bar.py[line:274] - INFO: epoch 065:    135 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17224.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3146.7, ups=0.18, wpb=17224.4, bsz=1024, num_updates=23530, lr=1.89949e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=156336
2024-11-11 02:20:16 - progress_bar.py[line:274] - INFO: epoch 065:    145 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17386.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2963.6, ups=0.17, wpb=17386.8, bsz=1024, num_updates=23540, lr=1.89804e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=156394
2024-11-11 02:21:13 - progress_bar.py[line:274] - INFO: epoch 065:    155 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17272.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3050.3, ups=0.18, wpb=17272.6, bsz=1024, num_updates=23550, lr=1.89658e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=156451
2024-11-11 02:22:07 - progress_bar.py[line:274] - INFO: epoch 065:    165 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17411.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3239.8, ups=0.19, wpb=17411.7, bsz=1024, num_updates=23560, lr=1.89513e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=156505
2024-11-11 02:23:04 - progress_bar.py[line:274] - INFO: epoch 065:    175 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17597.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3058, ups=0.17, wpb=17597.2, bsz=1024, num_updates=23570, lr=1.89368e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=156562
2024-11-11 02:24:02 - progress_bar.py[line:274] - INFO: epoch 065:    185 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17303.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2992.9, ups=0.17, wpb=17303.1, bsz=1024, num_updates=23580, lr=1.89222e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=156620
2024-11-11 02:24:57 - progress_bar.py[line:274] - INFO: epoch 065:    195 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17454.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3185.1, ups=0.18, wpb=17454.1, bsz=1024, num_updates=23590, lr=1.89077e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.3, wall=156675
2024-11-11 02:25:56 - progress_bar.py[line:274] - INFO: epoch 065:    205 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.699, ntokens=17123.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=2907.3, ups=0.17, wpb=17123.6, bsz=1024, num_updates=23600, lr=1.88932e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=156734
2024-11-11 02:26:55 - progress_bar.py[line:274] - INFO: epoch 065:    215 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17421.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=2930.5, ups=0.17, wpb=17421.8, bsz=1024, num_updates=23610, lr=1.88786e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.4, wall=156793
2024-11-11 02:27:54 - progress_bar.py[line:274] - INFO: epoch 065:    225 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17430.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=2968.9, ups=0.17, wpb=17430.2, bsz=1024, num_updates=23620, lr=1.88641e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=59, gb_free=13.5, wall=156852
2024-11-11 02:28:51 - progress_bar.py[line:274] - INFO: epoch 065:    235 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17480.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3040.4, ups=0.17, wpb=17480.5, bsz=1024, num_updates=23630, lr=1.88496e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=57, gb_free=13.6, wall=156910
2024-11-11 02:29:49 - progress_bar.py[line:274] - INFO: epoch 065:    245 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17677.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3047.6, ups=0.17, wpb=17677.2, bsz=1024, num_updates=23640, lr=1.8835e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=156968
2024-11-11 02:30:47 - progress_bar.py[line:274] - INFO: epoch 065:    255 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17410, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=2997.6, ups=0.17, wpb=17410, bsz=1024, num_updates=23650, lr=1.88205e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.3, wall=157026
2024-11-11 02:31:46 - progress_bar.py[line:274] - INFO: epoch 065:    265 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17426.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=2987, ups=0.17, wpb=17426.9, bsz=1024, num_updates=23660, lr=1.8806e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=157084
2024-11-11 02:32:43 - progress_bar.py[line:274] - INFO: epoch 065:    275 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17277.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3028.8, ups=0.18, wpb=17277.5, bsz=1024, num_updates=23670, lr=1.87914e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=157141
2024-11-11 02:33:38 - progress_bar.py[line:274] - INFO: epoch 065:    285 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17213.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3117.4, ups=0.18, wpb=17213.5, bsz=1024, num_updates=23680, lr=1.87769e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=157196
2024-11-11 02:34:36 - progress_bar.py[line:274] - INFO: epoch 065:    295 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.694, ntokens=16981.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=2941, ups=0.17, wpb=16981.4, bsz=1015.4, num_updates=23690, lr=1.87624e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=157254
2024-11-11 02:35:35 - progress_bar.py[line:274] - INFO: epoch 065:    305 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.801, ntokens=17759.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.97, wps=2996.4, ups=0.17, wpb=17759.9, bsz=1024, num_updates=23700, lr=1.87478e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=59, gb_free=13.1, wall=157313
2024-11-11 02:36:34 - progress_bar.py[line:274] - INFO: epoch 065:    315 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17453.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=2953.7, ups=0.17, wpb=17453.9, bsz=1024, num_updates=23710, lr=1.87333e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=59, gb_free=13.1, wall=157372
2024-11-11 02:37:32 - progress_bar.py[line:274] - INFO: epoch 065:    325 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.795, ntokens=17717.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3043.5, ups=0.17, wpb=17717.2, bsz=1024, num_updates=23720, lr=1.87188e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=157431
2024-11-11 02:38:29 - progress_bar.py[line:274] - INFO: epoch 065:    335 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17626, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3093.3, ups=0.18, wpb=17626, bsz=1024, num_updates=23730, lr=1.87042e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=157488
2024-11-11 02:39:28 - progress_bar.py[line:274] - INFO: epoch 065:    345 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17322, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2968, ups=0.17, wpb=17322, bsz=1024, num_updates=23740, lr=1.86897e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=157546
2024-11-11 02:40:25 - progress_bar.py[line:274] - INFO: epoch 065:    355 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17553.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3069.9, ups=0.17, wpb=17553.1, bsz=1024, num_updates=23750, lr=1.86752e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=157603
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 02:41:23 - progress_bar.py[line:274] - INFO: epoch 065:    365 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17523.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3016.6, ups=0.17, wpb=17523.6, bsz=1024, num_updates=23760, lr=1.86606e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=157661
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
2024-11-11 02:41:26 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 65 @ 23761 updates
2024-11-11 02:41:26 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt': File exists
: File exists: File exists

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 02:43:16 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
2024-11-11 02:45:08 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 65 @ 23761 updates, score 0) (writing took 221.43069147196366 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_65.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
2024-11-11 02:46:03 - train.py[line:336] - INFO: end of epoch 65 (average epoch stats below)
2024-11-11 02:46:03 - progress_bar.py[line:282] - INFO: epoch 065 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.755 | ntokens 17410.1 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.75 | wps 2519.7 | ups 0.14 | wpb 17410.1 | bsz 1023.1 | num_updates 23761 | lr 1.86592e-05 | gnorm 0.004 | clip 0 | loss_scale 131072 | train_wall 2070 | gb_free 13.5 | wall 157941
2024-11-11 02:46:03 - trainer.py[line:639] - INFO: loading train data for epoch 66
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 02:48:35 - trainer.py[line:703] - INFO: begin training epoch 66
2024-11-11 02:48:35 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 02:49:30 - progress_bar.py[line:274] - INFO: epoch 066:      9 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=16867.7, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=346.1, ups=0.02, wpb=16867.7, bsz=998.4, num_updates=23770, lr=1.86461e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=42, gb_free=13.3, wall=158149
2024-11-11 02:50:27 - progress_bar.py[line:274] - INFO: epoch 066:     19 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17586.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3127.7, ups=0.18, wpb=17586.5, bsz=1024, num_updates=23780, lr=1.86316e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=43, gb_free=13.5, wall=158205
2024-11-11 02:51:23 - progress_bar.py[line:274] - INFO: epoch 066:     29 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17400.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3080.2, ups=0.18, wpb=17400.7, bsz=1024, num_updates=23790, lr=1.8617e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=43, gb_free=13.3, wall=158261
2024-11-11 02:52:19 - progress_bar.py[line:274] - INFO: epoch 066:     39 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17374.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3093.9, ups=0.18, wpb=17374.1, bsz=1024, num_updates=23800, lr=1.86025e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=42, gb_free=13.4, wall=158317
2024-11-11 02:53:16 - progress_bar.py[line:274] - INFO: epoch 066:     49 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17216.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3054.1, ups=0.18, wpb=17216.5, bsz=1024, num_updates=23810, lr=1.8588e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=43, gb_free=13.4, wall=158374
2024-11-11 02:54:13 - progress_bar.py[line:274] - INFO: epoch 066:     59 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17398.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3037.9, ups=0.17, wpb=17398.3, bsz=1024, num_updates=23820, lr=1.85734e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=43, gb_free=13.4, wall=158431
2024-11-11 02:55:10 - progress_bar.py[line:274] - INFO: epoch 066:     69 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17292.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3037.2, ups=0.18, wpb=17292.1, bsz=1024, num_updates=23830, lr=1.85589e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=44, gb_free=13.4, wall=158488
2024-11-11 02:56:06 - progress_bar.py[line:274] - INFO: epoch 066:     79 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17549.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3128.8, ups=0.18, wpb=17549.2, bsz=1024, num_updates=23840, lr=1.85444e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=42, gb_free=13.4, wall=158544
2024-11-11 02:57:04 - progress_bar.py[line:274] - INFO: epoch 066:     89 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17435, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3023.2, ups=0.17, wpb=17435, bsz=1024, num_updates=23850, lr=1.85298e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=44, gb_free=13.4, wall=158602
2024-11-11 02:58:10 - progress_bar.py[line:274] - INFO: epoch 066:     99 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17171.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=2585.8, ups=0.15, wpb=17171.2, bsz=1024, num_updates=23860, lr=1.85153e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=64, gb_free=13.5, wall=158668
2024-11-11 02:59:15 - progress_bar.py[line:274] - INFO: epoch 066:    109 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17457.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=2668.4, ups=0.15, wpb=17457.7, bsz=1024, num_updates=23870, lr=1.85008e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=65, gb_free=13.4, wall=158734
2024-11-11 03:00:20 - progress_bar.py[line:274] - INFO: epoch 066:    119 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17564.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=2699.4, ups=0.15, wpb=17564.5, bsz=1024, num_updates=23880, lr=1.84862e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=65, gb_free=13.6, wall=158799
2024-11-11 03:01:26 - progress_bar.py[line:274] - INFO: epoch 066:    129 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17075.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=2625.7, ups=0.15, wpb=17075.7, bsz=1024, num_updates=23890, lr=1.84717e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=65, gb_free=13.5, wall=158864
2024-11-11 03:02:31 - progress_bar.py[line:274] - INFO: epoch 066:    139 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17262.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2640.4, ups=0.15, wpb=17262.7, bsz=1024, num_updates=23900, lr=1.84572e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=65, gb_free=13.6, wall=158929
2024-11-11 03:03:36 - progress_bar.py[line:274] - INFO: epoch 066:    149 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17302.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=2654.3, ups=0.15, wpb=17302.7, bsz=1024, num_updates=23910, lr=1.84426e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=65, gb_free=13.3, wall=158994
2024-11-11 03:04:42 - progress_bar.py[line:274] - INFO: epoch 066:    159 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17390, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2645.8, ups=0.15, wpb=17390, bsz=1024, num_updates=23920, lr=1.84281e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=66, gb_free=13.5, wall=159060
2024-11-11 03:05:48 - progress_bar.py[line:274] - INFO: epoch 066:    169 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17189.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=2597.2, ups=0.15, wpb=17189.6, bsz=1024, num_updates=23930, lr=1.84136e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=66, gb_free=13.4, wall=159126
2024-11-11 03:06:54 - progress_bar.py[line:274] - INFO: epoch 066:    179 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17468.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=2640.2, ups=0.15, wpb=17468.2, bsz=1024, num_updates=23940, lr=1.8399e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=66, gb_free=13.3, wall=159192
2024-11-11 03:08:00 - progress_bar.py[line:274] - INFO: epoch 066:    189 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=2615.3, ups=0.15, wpb=17289.7, bsz=1024, num_updates=23950, lr=1.83845e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=66, gb_free=13.5, wall=159259
2024-11-11 03:08:56 - progress_bar.py[line:274] - INFO: epoch 066:    199 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.798, ntokens=17676.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.95, wps=3201.1, ups=0.18, wpb=17676.1, bsz=1024, num_updates=23960, lr=1.837e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=52, gb_free=13.2, wall=159314
2024-11-11 03:09:52 - progress_bar.py[line:274] - INFO: epoch 066:    209 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17526.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3102.2, ups=0.18, wpb=17526.2, bsz=1024, num_updates=23970, lr=1.83554e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=159370
2024-11-11 03:10:49 - progress_bar.py[line:274] - INFO: epoch 066:    219 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17513.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3078.7, ups=0.18, wpb=17513.9, bsz=1024, num_updates=23980, lr=1.83409e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=159427
2024-11-11 03:11:43 - progress_bar.py[line:274] - INFO: epoch 066:    229 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17464, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3222.2, ups=0.18, wpb=17464, bsz=1024, num_updates=23990, lr=1.83264e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=159481
2024-11-11 03:12:37 - progress_bar.py[line:274] - INFO: epoch 066:    239 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17376.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3248.6, ups=0.19, wpb=17376.4, bsz=1024, num_updates=24000, lr=1.83118e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=159535
2024-11-11 03:13:31 - progress_bar.py[line:274] - INFO: epoch 066:    249 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17424.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3211.2, ups=0.18, wpb=17424.2, bsz=1024, num_updates=24010, lr=1.82973e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=159589
2024-11-11 03:14:24 - progress_bar.py[line:274] - INFO: epoch 066:    259 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17253.8, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3229.9, ups=0.19, wpb=17253.8, bsz=1015.4, num_updates=24020, lr=1.82828e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=159643
2024-11-11 03:15:16 - progress_bar.py[line:274] - INFO: epoch 066:    269 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17198.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3316.7, ups=0.19, wpb=17198.5, bsz=1024, num_updates=24030, lr=1.82682e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.6, wall=159694
2024-11-11 03:16:08 - progress_bar.py[line:274] - INFO: epoch 066:    279 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.706, ntokens=17165.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3330, ups=0.19, wpb=17165.4, bsz=1024, num_updates=24040, lr=1.82537e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=48, gb_free=13.4, wall=159746
2024-11-11 03:16:59 - progress_bar.py[line:274] - INFO: epoch 066:    289 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17392, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3363.9, ups=0.19, wpb=17392, bsz=1024, num_updates=24050, lr=1.82392e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=39, gb_free=13.5, wall=159798
2024-11-11 03:17:53 - progress_bar.py[line:274] - INFO: epoch 066:    299 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.724, ntokens=17345, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3262.7, ups=0.19, wpb=17345, bsz=1024, num_updates=24060, lr=1.82246e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=39, gb_free=13.5, wall=159851
2024-11-11 03:18:46 - progress_bar.py[line:274] - INFO: epoch 066:    309 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17661.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3332.8, ups=0.19, wpb=17661.5, bsz=1024, num_updates=24070, lr=1.82101e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.5, wall=159904
2024-11-11 03:19:39 - progress_bar.py[line:274] - INFO: epoch 066:    319 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.807, ntokens=17683.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7, wps=3299.7, ups=0.19, wpb=17683.5, bsz=1024, num_updates=24080, lr=1.81956e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=159957
2024-11-11 03:20:32 - progress_bar.py[line:274] - INFO: epoch 066:    329 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17519.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3343.4, ups=0.19, wpb=17519.8, bsz=1024, num_updates=24090, lr=1.8181e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=160010
2024-11-11 03:21:24 - progress_bar.py[line:274] - INFO: epoch 066:    339 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17682.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3359.6, ups=0.19, wpb=17682.5, bsz=1024, num_updates=24100, lr=1.81665e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=160062
2024-11-11 03:22:17 - progress_bar.py[line:274] - INFO: epoch 066:    349 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.773, ntokens=17616.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3340.9, ups=0.19, wpb=17616.4, bsz=1024, num_updates=24110, lr=1.8152e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=160115
2024-11-11 03:23:09 - progress_bar.py[line:274] - INFO: epoch 066:    359 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17365.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3331.8, ups=0.19, wpb=17365.4, bsz=1024, num_updates=24120, lr=1.81374e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=160167
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 03:23:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 66 @ 24127 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
2024-11-11 03:23:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 03:25:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
2024-11-11 03:27:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 66 @ 24127 updates, score 0) (writing took 222.6818276779959 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_66.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442

slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
slice_id 1 seek offset 46806
2024-11-11 03:28:20 - train.py[line:336] - INFO: end of epoch 66 (average epoch stats below)
2024-11-11 03:28:20 - progress_bar.py[line:282] - INFO: epoch 066 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.748 | ntokens 17396.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.72 | wps 2509.7 | ups 0.14 | wpb 17396.7 | bsz 1023.1 | num_updates 24127 | lr 1.81273e-05 | gnorm 0.003 | clip 0 | loss_scale 262144 | train_wall 1943 | gb_free 13.5 | wall 160478
2024-11-11 03:28:20 - trainer.py[line:639] - INFO: loading train data for epoch 67
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 03:30:51 - trainer.py[line:703] - INFO: begin training epoch 67
2024-11-11 03:30:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 03:31:09 - progress_bar.py[line:274] - INFO: epoch 067:      3 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17012.9, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=354.7, ups=0.02, wpb=17012.9, bsz=998.4, num_updates=24130, lr=1.81229e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=43, gb_free=13.3, wall=160647
2024-11-11 03:32:01 - progress_bar.py[line:274] - INFO: epoch 067:     13 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17599.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3364.1, ups=0.19, wpb=17599.4, bsz=1024, num_updates=24140, lr=1.81084e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=160699
2024-11-11 03:32:54 - progress_bar.py[line:274] - INFO: epoch 067:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17370.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3304.6, ups=0.19, wpb=17370.9, bsz=1024, num_updates=24150, lr=1.80938e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=160752
2024-11-11 03:33:46 - progress_bar.py[line:274] - INFO: epoch 067:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17516.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3310.7, ups=0.19, wpb=17516.1, bsz=1024, num_updates=24160, lr=1.80793e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=160805
2024-11-11 03:34:39 - progress_bar.py[line:274] - INFO: epoch 067:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17497.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3349, ups=0.19, wpb=17497.9, bsz=1024, num_updates=24170, lr=1.80648e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=160857
2024-11-11 03:35:31 - progress_bar.py[line:274] - INFO: epoch 067:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17501.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3323.7, ups=0.19, wpb=17501.6, bsz=1024, num_updates=24180, lr=1.80502e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=160910
2024-11-11 03:36:24 - progress_bar.py[line:274] - INFO: epoch 067:     63 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17461.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3295.1, ups=0.19, wpb=17461.4, bsz=1024, num_updates=24190, lr=1.80357e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=160963
2024-11-11 03:37:17 - progress_bar.py[line:274] - INFO: epoch 067:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.778, ntokens=17764.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.86, wps=3381.7, ups=0.19, wpb=17764.5, bsz=1024, num_updates=24200, lr=1.80212e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=161015
2024-11-11 03:38:10 - progress_bar.py[line:274] - INFO: epoch 067:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17318.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3276.2, ups=0.19, wpb=17318.1, bsz=1024, num_updates=24210, lr=1.80066e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=161068
2024-11-11 03:39:03 - progress_bar.py[line:274] - INFO: epoch 067:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.707, ntokens=17248.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.53, wps=3248.5, ups=0.19, wpb=17248.8, bsz=1024, num_updates=24220, lr=1.79921e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=161121
2024-11-11 03:39:56 - progress_bar.py[line:274] - INFO: epoch 067:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17639.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3338.6, ups=0.19, wpb=17639.4, bsz=1024, num_updates=24230, lr=1.79776e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=161174
2024-11-11 03:40:49 - progress_bar.py[line:274] - INFO: epoch 067:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17340.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3278.6, ups=0.19, wpb=17340.2, bsz=1024, num_updates=24240, lr=1.7963e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=30, gb_free=13.1, wall=161227
2024-11-11 03:41:41 - progress_bar.py[line:274] - INFO: epoch 067:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17433.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3323.6, ups=0.19, wpb=17433.3, bsz=1024, num_updates=24250, lr=1.79485e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161279
2024-11-11 03:42:34 - progress_bar.py[line:274] - INFO: epoch 067:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.7, ntokens=17185.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.5, wps=3258.8, ups=0.19, wpb=17185.5, bsz=1024, num_updates=24260, lr=1.7934e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161332
2024-11-11 03:43:26 - progress_bar.py[line:274] - INFO: epoch 067:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17484.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3344.8, ups=0.19, wpb=17484.3, bsz=1024, num_updates=24270, lr=1.79194e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=161384
2024-11-11 03:44:18 - progress_bar.py[line:274] - INFO: epoch 067:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.825, ntokens=17848.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.08, wps=3403, ups=0.19, wpb=17848.2, bsz=1024, num_updates=24280, lr=1.79049e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=161437
2024-11-11 03:45:11 - progress_bar.py[line:274] - INFO: epoch 067:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17244.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3271.5, ups=0.19, wpb=17244.5, bsz=1024, num_updates=24290, lr=1.78904e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=161489
2024-11-11 03:46:04 - progress_bar.py[line:274] - INFO: epoch 067:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17598.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3363.8, ups=0.19, wpb=17598.4, bsz=1024, num_updates=24300, lr=1.78758e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=161542
2024-11-11 03:46:56 - progress_bar.py[line:274] - INFO: epoch 067:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17397, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3290.4, ups=0.19, wpb=17397, bsz=1024, num_updates=24310, lr=1.78613e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161595
2024-11-11 03:47:49 - progress_bar.py[line:274] - INFO: epoch 067:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.759, ntokens=17479, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3295.8, ups=0.19, wpb=17479, bsz=1024, num_updates=24320, lr=1.78468e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=161648
2024-11-11 03:48:42 - progress_bar.py[line:274] - INFO: epoch 067:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17357.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3289.3, ups=0.19, wpb=17357.8, bsz=1024, num_updates=24330, lr=1.78322e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=161700
2024-11-11 03:49:34 - progress_bar.py[line:274] - INFO: epoch 067:    213 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17435.2, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3333.5, ups=0.19, wpb=17435.2, bsz=1015.4, num_updates=24340, lr=1.78177e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161753
2024-11-11 03:50:28 - progress_bar.py[line:274] - INFO: epoch 067:    223 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.695, ntokens=17249.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.48, wps=3245.8, ups=0.19, wpb=17249.7, bsz=1024, num_updates=24350, lr=1.78032e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161806
2024-11-11 03:51:05 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 262144.0
2024-11-11 03:51:26 - progress_bar.py[line:274] - INFO: epoch 067:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17262.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2966.5, ups=0.17, wpb=17262.6, bsz=1024, num_updates=24360, lr=1.77886e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=33, gb_free=13.5, wall=161864
2024-11-11 03:52:18 - progress_bar.py[line:274] - INFO: epoch 067:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.812, ntokens=17864.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=7.02, wps=3424.7, ups=0.19, wpb=17864.4, bsz=1024, num_updates=24370, lr=1.77741e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=161916
2024-11-11 03:53:11 - progress_bar.py[line:274] - INFO: epoch 067:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.781, ntokens=17558.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.87, wps=3343.2, ups=0.19, wpb=17558.4, bsz=1024, num_updates=24380, lr=1.77596e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=161969
2024-11-11 03:54:03 - progress_bar.py[line:274] - INFO: epoch 067:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17111, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3236.4, ups=0.19, wpb=17111, bsz=1024, num_updates=24390, lr=1.7745e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=162022
2024-11-11 03:54:56 - progress_bar.py[line:274] - INFO: epoch 067:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17512.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3336.3, ups=0.19, wpb=17512.7, bsz=1024, num_updates=24400, lr=1.77305e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=162074
2024-11-11 03:55:49 - progress_bar.py[line:274] - INFO: epoch 067:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17261.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3254.8, ups=0.19, wpb=17261.3, bsz=1024, num_updates=24410, lr=1.7716e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.2, wall=162127
2024-11-11 03:56:42 - progress_bar.py[line:274] - INFO: epoch 067:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17493, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3303.2, ups=0.19, wpb=17493, bsz=1024, num_updates=24420, lr=1.77014e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=162180
2024-11-11 03:57:34 - progress_bar.py[line:274] - INFO: epoch 067:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17433.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3314.1, ups=0.19, wpb=17433.3, bsz=1024, num_updates=24430, lr=1.76869e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=162233
2024-11-11 03:58:28 - progress_bar.py[line:274] - INFO: epoch 067:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.787, ntokens=17706.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3295.7, ups=0.19, wpb=17706.2, bsz=1024, num_updates=24440, lr=1.76724e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=34, gb_free=13.4, wall=162286
2024-11-11 03:59:25 - progress_bar.py[line:274] - INFO: epoch 067:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17493.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3054, ups=0.17, wpb=17493.9, bsz=1024, num_updates=24450, lr=1.76578e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=162344
2024-11-11 04:00:19 - progress_bar.py[line:274] - INFO: epoch 067:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17738.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3300.8, ups=0.19, wpb=17738.5, bsz=1024, num_updates=24460, lr=1.76433e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=162397
2024-11-11 04:01:11 - progress_bar.py[line:274] - INFO: epoch 067:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.785, ntokens=17801.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.89, wps=3408.9, ups=0.19, wpb=17801.2, bsz=1024, num_updates=24470, lr=1.76288e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=162450
2024-11-11 04:02:07 - progress_bar.py[line:274] - INFO: epoch 067:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.762, ntokens=17536, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3145.1, ups=0.18, wpb=17536, bsz=1024, num_updates=24480, lr=1.76142e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=162505
2024-11-11 04:03:00 - progress_bar.py[line:274] - INFO: epoch 067:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17496, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3285.2, ups=0.19, wpb=17496, bsz=1024, num_updates=24490, lr=1.75997e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=162559
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt2024-11-11 04:03:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 67 @ 24492 updates

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt

2024-11-11 04:03:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 04:04:58 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-11 04:06:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 67 @ 24492 updates, score 0) (writing took 221.697282491019 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_67.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
2024-11-11 04:07:45 - train.py[line:336] - INFO: end of epoch 67 (average epoch stats below)
2024-11-11 04:07:45 - progress_bar.py[line:282] - INFO: epoch 067 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.752 | ntokens 17469.2 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.74 | wps 2696.4 | ups 0.15 | wpb 17469.2 | bsz 1023.1 | num_updates 24492 | lr 1.75968e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 1233 | gb_free 13.4 | wall 162843
2024-11-11 04:07:45 - trainer.py[line:639] - INFO: loading train data for epoch 68
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 04:10:14 - trainer.py[line:703] - INFO: begin training epoch 68
2024-11-11 04:10:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 04:10:59 - progress_bar.py[line:274] - INFO: epoch 068:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17056.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=356.3, ups=0.02, wpb=17056.2, bsz=998.4, num_updates=24500, lr=1.75852e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=32, gb_free=13.3, wall=163037
2024-11-11 04:11:52 - progress_bar.py[line:274] - INFO: epoch 068:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17303.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3295, ups=0.19, wpb=17303.7, bsz=1015.4, num_updates=24510, lr=1.75706e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163090
2024-11-11 04:12:45 - progress_bar.py[line:274] - INFO: epoch 068:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.772, ntokens=17563.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.83, wps=3314.9, ups=0.19, wpb=17563.4, bsz=1024, num_updates=24520, lr=1.75561e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=163143
2024-11-11 04:13:38 - progress_bar.py[line:274] - INFO: epoch 068:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17632, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3323.3, ups=0.19, wpb=17632, bsz=1024, num_updates=24530, lr=1.75416e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163196
2024-11-11 04:14:31 - progress_bar.py[line:274] - INFO: epoch 068:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.767, ntokens=17558.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3328.4, ups=0.19, wpb=17558.1, bsz=1024, num_updates=24540, lr=1.7527e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=32, gb_free=13.4, wall=163249
2024-11-11 04:15:23 - progress_bar.py[line:274] - INFO: epoch 068:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17666, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3376.6, ups=0.19, wpb=17666, bsz=1024, num_updates=24550, lr=1.75125e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=163301
2024-11-11 04:16:16 - progress_bar.py[line:274] - INFO: epoch 068:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17204.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3262.5, ups=0.19, wpb=17204.8, bsz=1024, num_updates=24560, lr=1.7498e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=31, gb_free=13.3, wall=163354
2024-11-11 04:17:08 - progress_bar.py[line:274] - INFO: epoch 068:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17378.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3298.2, ups=0.19, wpb=17378.6, bsz=1024, num_updates=24570, lr=1.74834e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=33, gb_free=13.5, wall=163406
2024-11-11 04:18:01 - progress_bar.py[line:274] - INFO: epoch 068:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.731, ntokens=17305.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3274.7, ups=0.19, wpb=17305.8, bsz=1024, num_updates=24580, lr=1.74689e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=31, gb_free=13.2, wall=163459
2024-11-11 04:18:54 - progress_bar.py[line:274] - INFO: epoch 068:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.688, ntokens=17042.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3202.8, ups=0.19, wpb=17042.1, bsz=1024, num_updates=24590, lr=1.74544e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=163513
2024-11-11 04:19:47 - progress_bar.py[line:274] - INFO: epoch 068:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17487.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3307.8, ups=0.19, wpb=17487.7, bsz=1024, num_updates=24600, lr=1.74398e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=163565
2024-11-11 04:20:40 - progress_bar.py[line:274] - INFO: epoch 068:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17510.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3319, ups=0.19, wpb=17510.2, bsz=1024, num_updates=24610, lr=1.74253e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163618
2024-11-11 04:21:33 - progress_bar.py[line:274] - INFO: epoch 068:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17323.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3261.4, ups=0.19, wpb=17323.9, bsz=1024, num_updates=24620, lr=1.74108e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163671
2024-11-11 04:22:26 - progress_bar.py[line:274] - INFO: epoch 068:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17164.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3266.5, ups=0.19, wpb=17164.8, bsz=1024, num_updates=24630, lr=1.73962e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.3, wall=163724
2024-11-11 04:23:18 - progress_bar.py[line:274] - INFO: epoch 068:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17558.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3353.3, ups=0.19, wpb=17558.3, bsz=1024, num_updates=24640, lr=1.73817e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163776
2024-11-11 04:24:11 - progress_bar.py[line:274] - INFO: epoch 068:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17415.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3306.3, ups=0.19, wpb=17415.9, bsz=1024, num_updates=24650, lr=1.73672e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=30, gb_free=13.4, wall=163829
2024-11-11 04:25:07 - progress_bar.py[line:274] - INFO: epoch 068:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17576.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3124.8, ups=0.18, wpb=17576.8, bsz=1024, num_updates=24660, lr=1.73526e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=43, gb_free=13.5, wall=163885
2024-11-11 04:26:02 - progress_bar.py[line:274] - INFO: epoch 068:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.758, ntokens=17486.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3190.2, ups=0.18, wpb=17486.2, bsz=1024, num_updates=24670, lr=1.73381e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=163940
2024-11-11 04:26:59 - progress_bar.py[line:274] - INFO: epoch 068:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17348.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3048.2, ups=0.18, wpb=17348.6, bsz=1024, num_updates=24680, lr=1.73236e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=163997
2024-11-11 04:27:53 - progress_bar.py[line:274] - INFO: epoch 068:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17544.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3225.6, ups=0.18, wpb=17544.2, bsz=1024, num_updates=24690, lr=1.7309e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=164051
2024-11-11 04:28:49 - progress_bar.py[line:274] - INFO: epoch 068:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17192.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3089.2, ups=0.18, wpb=17192.7, bsz=1024, num_updates=24700, lr=1.72945e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=164107
2024-11-11 04:29:43 - progress_bar.py[line:274] - INFO: epoch 068:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17159.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3138, ups=0.18, wpb=17159.3, bsz=1024, num_updates=24710, lr=1.728e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=164162
2024-11-11 04:30:39 - progress_bar.py[line:274] - INFO: epoch 068:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17443.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3157.2, ups=0.18, wpb=17443.2, bsz=1024, num_updates=24720, lr=1.72654e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164217
2024-11-11 04:31:34 - progress_bar.py[line:274] - INFO: epoch 068:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17502, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3172, ups=0.18, wpb=17502, bsz=1024, num_updates=24730, lr=1.72509e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=164272
2024-11-11 04:32:29 - progress_bar.py[line:274] - INFO: epoch 068:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17315.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3153.8, ups=0.18, wpb=17315.1, bsz=1024, num_updates=24740, lr=1.72364e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164327
2024-11-11 04:33:24 - progress_bar.py[line:274] - INFO: epoch 068:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17150.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3127.5, ups=0.18, wpb=17150.7, bsz=1024, num_updates=24750, lr=1.72218e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164382
2024-11-11 04:34:19 - progress_bar.py[line:274] - INFO: epoch 068:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17397.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3159, ups=0.18, wpb=17397.6, bsz=1024, num_updates=24760, lr=1.72073e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164437
2024-11-11 04:35:14 - progress_bar.py[line:274] - INFO: epoch 068:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17427.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3165.1, ups=0.18, wpb=17427.4, bsz=1024, num_updates=24770, lr=1.71928e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164492
2024-11-11 04:36:09 - progress_bar.py[line:274] - INFO: epoch 068:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17201, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3122.4, ups=0.18, wpb=17201, bsz=1024, num_updates=24780, lr=1.71782e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=55, gb_free=13.5, wall=164547
2024-11-11 04:37:03 - progress_bar.py[line:274] - INFO: epoch 068:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17330.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3189.3, ups=0.18, wpb=17330.1, bsz=1024, num_updates=24790, lr=1.71637e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=164601
2024-11-11 04:37:57 - progress_bar.py[line:274] - INFO: epoch 068:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17641.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3253.7, ups=0.18, wpb=17641.2, bsz=1024, num_updates=24800, lr=1.71492e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=164656
2024-11-11 04:38:50 - progress_bar.py[line:274] - INFO: epoch 068:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.805, ntokens=17837.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.99, wps=3358.4, ups=0.19, wpb=17837.2, bsz=1024, num_updates=24810, lr=1.71346e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=164709
2024-11-11 04:39:43 - progress_bar.py[line:274] - INFO: epoch 068:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.761, ntokens=17712.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.78, wps=3339.5, ups=0.19, wpb=17712.6, bsz=1024, num_updates=24820, lr=1.71201e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.3, wall=164762
2024-11-11 04:40:37 - progress_bar.py[line:274] - INFO: epoch 068:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.794, ntokens=17905.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.94, wps=3344.8, ups=0.19, wpb=17905.3, bsz=1024, num_updates=24830, lr=1.71056e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=164815
2024-11-11 04:41:31 - progress_bar.py[line:274] - INFO: epoch 068:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17562.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3249, ups=0.18, wpb=17562.9, bsz=1024, num_updates=24840, lr=1.7091e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=164869
2024-11-11 04:42:26 - progress_bar.py[line:274] - INFO: epoch 068:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17547, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3202.2, ups=0.18, wpb=17547, bsz=1024, num_updates=24850, lr=1.70765e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=164924
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 04:43:07 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 68 @ 24858 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt

2024-11-11 04:43:07 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt': File exists
: File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 04:44:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-11 04:46:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 68 @ 24858 updates, score 0) (writing took 224.25508626701776 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_68.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
2024-11-11 04:47:46 - train.py[line:336] - INFO: end of epoch 68 (average epoch stats below)
2024-11-11 04:47:46 - progress_bar.py[line:282] - INFO: epoch 068 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.746 | ntokens 17431.2 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.71 | wps 2656.9 | ups 0.15 | wpb 17431.2 | bsz 1023.1 | num_updates 24858 | lr 1.70649e-05 | gnorm 0.003 | clip 0 | loss_scale 262144 | train_wall 1605 | gb_free 13.4 | wall 165244
2024-11-11 04:47:46 - trainer.py[line:639] - INFO: loading train data for epoch 69
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 04:50:15 - trainer.py[line:703] - INFO: begin training epoch 69
2024-11-11 04:50:15 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 04:50:28 - progress_bar.py[line:274] - INFO: epoch 069:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.764, ntokens=17117.6, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=355, ups=0.02, wpb=17117.6, bsz=998.4, num_updates=24860, lr=1.7062e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=47, gb_free=13.5, wall=165406
2024-11-11 04:51:23 - progress_bar.py[line:274] - INFO: epoch 069:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17433.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3197.3, ups=0.18, wpb=17433.9, bsz=1024, num_updates=24870, lr=1.70474e-05, gnorm=0.003, clip=0, loss_scale=524288, train_wall=30, gb_free=13.5, wall=165461
2024-11-11 04:51:34 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 262144.0
2024-11-11 04:52:26 - progress_bar.py[line:274] - INFO: epoch 069:     23 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17373.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=2754.1, ups=0.16, wpb=17373.8, bsz=1024, num_updates=24880, lr=1.70329e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=33, gb_free=13.5, wall=165524
2024-11-11 04:53:19 - progress_bar.py[line:274] - INFO: epoch 069:     33 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17490.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3268.5, ups=0.19, wpb=17490.7, bsz=1024, num_updates=24890, lr=1.70184e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=165577
2024-11-11 04:54:11 - progress_bar.py[line:274] - INFO: epoch 069:     43 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17545.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3356.9, ups=0.19, wpb=17545.7, bsz=1024, num_updates=24900, lr=1.70038e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=31, gb_free=13.4, wall=165630
2024-11-11 04:55:06 - progress_bar.py[line:274] - INFO: epoch 069:     53 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.741, ntokens=17480.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3215.1, ups=0.18, wpb=17480.2, bsz=1024, num_updates=24910, lr=1.69893e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=40, gb_free=13.4, wall=165684
2024-11-11 04:56:00 - progress_bar.py[line:274] - INFO: epoch 069:     63 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.749, ntokens=17389.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3208.6, ups=0.18, wpb=17389.1, bsz=1024, num_updates=24920, lr=1.69748e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=52, gb_free=13.5, wall=165738
2024-11-11 04:56:55 - progress_bar.py[line:274] - INFO: epoch 069:     73 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17269.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3151.7, ups=0.18, wpb=17269.4, bsz=1024, num_updates=24930, lr=1.69602e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=165793
2024-11-11 04:57:49 - progress_bar.py[line:274] - INFO: epoch 069:     83 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.77, ntokens=17484.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3226.8, ups=0.18, wpb=17484.6, bsz=1024, num_updates=24940, lr=1.69457e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.2, wall=165847
2024-11-11 04:58:43 - progress_bar.py[line:274] - INFO: epoch 069:     93 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.686, ntokens=17195.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.44, wps=3156.4, ups=0.18, wpb=17195.2, bsz=1024, num_updates=24950, lr=1.69312e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=165902
2024-11-11 04:59:38 - progress_bar.py[line:274] - INFO: epoch 069:    103 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17342.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3177.4, ups=0.18, wpb=17342.1, bsz=1024, num_updates=24960, lr=1.69166e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=165956
2024-11-11 05:00:32 - progress_bar.py[line:274] - INFO: epoch 069:    113 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17570, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3254.7, ups=0.19, wpb=17570, bsz=1024, num_updates=24970, lr=1.69021e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=166010
2024-11-11 05:01:26 - progress_bar.py[line:274] - INFO: epoch 069:    123 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.716, ntokens=17312.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3176.3, ups=0.18, wpb=17312.9, bsz=1024, num_updates=24980, lr=1.68876e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=166065
2024-11-11 05:02:20 - progress_bar.py[line:274] - INFO: epoch 069:    133 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.705, ntokens=17129.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3172.5, ups=0.19, wpb=17129.5, bsz=1024, num_updates=24990, lr=1.6873e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.6, wall=166119
2024-11-11 05:03:15 - progress_bar.py[line:274] - INFO: epoch 069:    143 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.726, ntokens=17280.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3189, ups=0.18, wpb=17280.7, bsz=1024, num_updates=25000, lr=1.68585e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=166173
loss_reg: 0.006832846520898921 loss_cls: 0.0045250216498970985
loss_reg: 0.007217203670124827 loss_cls: 0.004056238569319248
loss_reg: 0.004319280846333954 loss_cls: 0.004377750214189291
loss_reg: 0.004570505309793709 loss_cls: 0.004044562112540007
loss_reg: 0.005533601852776327 loss_cls: 0.0030716205947101116
loss_reg: 0.004858847629213589 loss_cls: 0.0032392670400440693
loss_reg: 0.005102550006938978 loss_cls: 0.003971555735915899
loss_reg: 0.0072547975793797 loss_cls: 0.003343573771417141
loss_reg: 0.007502804630199924 loss_cls: 0.0037645676638931036
loss_reg: 0.005472445079169873 loss_cls: 0.0028440949972718954
loss_reg: 0.006097304934500334 loss_cls: 0.0032143001444637775
loss_reg: 0.004879854248655298 loss_cls: 0.002986048348248005
loss_reg: 0.0064110584270687795 loss_cls: 0.0034632859751582146
loss_reg: 0.007322946502245274 loss_cls: 0.004270906560122967
loss_reg: 0.006387958935751837 loss_cls: 0.0035299574956297874
loss_reg: 0.004680096611520636 loss_cls: 0.003818291937932372
loss_reg: 0.0075778569677767875 loss_cls: 0.003495163517072797
loss_reg: 0.0039198034603251984 loss_cls: 0.004149516578763723
loss_reg: 0.005206780183959815 loss_cls: 0.003630898194387555
loss_reg: 0.004116314064285133 loss_cls: 0.003929424565285444
loss_reg: 0.006316372274059686 loss_cls: 0.003462808905169368
loss_reg: 0.005070925229878041 loss_cls: 0.0028832005336880684
loss_reg: 0.00854252185145436 loss_cls: 0.004345709923654795
loss_reg: 0.009540400911490677 loss_cls: 0.003350944258272648
loss_reg: 0.008376218768106585 loss_cls: 0.003193529322743416
loss_reg: 0.009632344880725171 loss_cls: 0.002986916108056903
loss_reg: 0.005672349613915759 loss_cls: 0.004184042569249868
loss_reg: 0.008303648144307419 loss_cls: 0.0030235054437071085
loss_reg: 0.00402652096762042 loss_cls: 0.004328477196395397
loss_reg: 0.006399862084548203 loss_cls: 0.003406563540920615
loss_reg: 0.005580574706717104 loss_cls: 0.0031808668281883
loss_reg: 0.006363979706377145 loss_cls: 0.003193796845152974
loss_reg: 0.006839620993435796 loss_cls: 0.004546354059129953
loss_reg: 0.006780776702088208 loss_cls: 0.003806415479630232
loss_reg: 0.0065872766707824534 loss_cls: 0.0035946331918239594
loss_reg: 0.00409245101384143 loss_cls: 0.004087074659764767
loss_reg: 0.005164618336899902 loss_cls: 0.0033862977288663387
loss_reg: 0.006451993483597349 loss_cls: 0.0031806572806090117
loss_reg: 0.005531529707654838 loss_cls: 0.005864947102963924
loss_reg: 0.003959592946601366 loss_cls: 0.003955566789954901
loss_reg: 0.007034404565312511 loss_cls: 0.005355693865567446
loss_reg: 0.0036796339412030867 loss_cls: 0.004078739322721958
loss_reg: 0.0057779210739528 loss_cls: 0.003586359554901719
loss_reg: 0.005335820762343582 loss_cls: 0.003366566263139248
loss_reg: 0.00727376133346644 loss_cls: 0.004205397330224514
loss_reg: 0.00625175093663638 loss_cls: 0.004214080981910229
loss_reg: 0.006551432327921827 loss_cls: 0.0038437549956142902
loss_reg: 0.00622483742229585 loss_cls: 0.004158390685915947
loss_reg: 0.005743843849532335 loss_cls: 0.003800004255026579
loss_reg: 0.006349183063792171 loss_cls: 0.004336307756602764
loss_reg: 0.006342829240613027 loss_cls: 0.0029774715658277273
loss_reg: 0.007762608455048861 loss_cls: 0.0032481811940670013
loss_reg: 0.009750758583836982 loss_cls: 0.0029292588587850332
loss_reg: 0.007337416152095622 loss_cls: 0.0036445497535169125
loss_reg: 0.00420464850807817 loss_cls: 0.004643303342163563
loss_reg: 0.007495503027386429 loss_cls: 0.004151212517172098
loss_reg: 0.0073075506488966485 loss_cls: 0.0033202620688825846
loss_reg: 0.008448713613800788 loss_cls: 0.0031868477817624807
loss_reg: 0.004153272204164535 loss_cls: 0.005067289806902409
loss_reg: 0.006986401115060108 loss_cls: 0.004820628557354212
loss_reg: 0.007478020268691366 loss_cls: 0.003955516964197159
loss_reg: 0.005250130994963959 loss_cls: 0.0036075564566999674
loss_reg: 0.00597127835836825 loss_cls: 0.0039740195497870445
loss_reg: 0.008503453980942122 loss_cls: 0.003721408313140273
2024-11-11 05:04:09 - progress_bar.py[line:274] - INFO: epoch 069:    153 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.743, ntokens=17451.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3192, ups=0.18, wpb=17451.2, bsz=1024, num_updates=25010, lr=1.6844e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=55, gb_free=13.2, wall=166228
2024-11-11 05:05:04 - progress_bar.py[line:274] - INFO: epoch 069:    163 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17215.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3137.4, ups=0.18, wpb=17215.4, bsz=1024, num_updates=25020, lr=1.68294e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=166282
2024-11-11 05:05:59 - progress_bar.py[line:274] - INFO: epoch 069:    173 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17485.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3209.5, ups=0.18, wpb=17485.7, bsz=1024, num_updates=25030, lr=1.68149e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=166337
2024-11-11 05:06:53 - progress_bar.py[line:274] - INFO: epoch 069:    183 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17373.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3184.8, ups=0.18, wpb=17373.7, bsz=1024, num_updates=25040, lr=1.68004e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.5, wall=166391
2024-11-11 05:07:48 - progress_bar.py[line:274] - INFO: epoch 069:    193 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17347.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3185.2, ups=0.18, wpb=17347.1, bsz=1024, num_updates=25050, lr=1.67858e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=54, gb_free=13.4, wall=166446
2024-11-11 05:08:43 - progress_bar.py[line:274] - INFO: epoch 069:    203 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17513.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3189.3, ups=0.18, wpb=17513.3, bsz=1024, num_updates=25060, lr=1.67713e-05, gnorm=0.006, clip=0, loss_scale=262144, train_wall=55, gb_free=13.3, wall=166501
2024-11-11 05:08:53 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 131072.0
2024-11-11 05:09:43 - progress_bar.py[line:274] - INFO: epoch 069:    214 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17380.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=2874.1, ups=0.17, wpb=17380.8, bsz=1024, num_updates=25070, lr=1.67568e-05, gnorm=0.006, clip=0, loss_scale=131072, train_wall=60, gb_free=13.4, wall=166561
2024-11-11 05:10:38 - progress_bar.py[line:274] - INFO: epoch 069:    224 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17444.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3182.6, ups=0.18, wpb=17444.3, bsz=1024, num_updates=25080, lr=1.67422e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=166616
2024-11-11 05:11:33 - progress_bar.py[line:274] - INFO: epoch 069:    234 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17436, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3137.7, ups=0.18, wpb=17436, bsz=1024, num_updates=25090, lr=1.67277e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=166672
2024-11-11 05:12:29 - progress_bar.py[line:274] - INFO: epoch 069:    244 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17334.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3123.5, ups=0.18, wpb=17334.1, bsz=1024, num_updates=25100, lr=1.67132e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=166727
2024-11-11 05:13:25 - progress_bar.py[line:274] - INFO: epoch 069:    254 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17329.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3071, ups=0.18, wpb=17329.8, bsz=1024, num_updates=25110, lr=1.66986e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=166784
2024-11-11 05:14:22 - progress_bar.py[line:274] - INFO: epoch 069:    264 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.738, ntokens=17342.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3087.3, ups=0.18, wpb=17342.2, bsz=1024, num_updates=25120, lr=1.66841e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=166840
2024-11-11 05:15:17 - progress_bar.py[line:274] - INFO: epoch 069:    274 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17269.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3093.6, ups=0.18, wpb=17269.6, bsz=1024, num_updates=25130, lr=1.66696e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.2, wall=166896
2024-11-11 05:16:12 - progress_bar.py[line:274] - INFO: epoch 069:    284 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17197.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3151.7, ups=0.18, wpb=17197.4, bsz=1024, num_updates=25140, lr=1.6655e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=166950
2024-11-11 05:17:07 - progress_bar.py[line:274] - INFO: epoch 069:    294 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17048, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3083.3, ups=0.18, wpb=17048, bsz=1015.4, num_updates=25150, lr=1.66405e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=167005
2024-11-11 05:18:00 - progress_bar.py[line:274] - INFO: epoch 069:    304 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.698, ntokens=17284.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3282, ups=0.19, wpb=17284.3, bsz=1024, num_updates=25160, lr=1.6626e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=53, gb_free=13.3, wall=167058
2024-11-11 05:18:55 - progress_bar.py[line:274] - INFO: epoch 069:    314 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.792, ntokens=17699.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3229.6, ups=0.18, wpb=17699.3, bsz=1024, num_updates=25170, lr=1.66114e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=167113
2024-11-11 05:19:51 - progress_bar.py[line:274] - INFO: epoch 069:    324 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17677.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3135.7, ups=0.18, wpb=17677.3, bsz=1024, num_updates=25180, lr=1.65969e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=167169
2024-11-11 05:20:48 - progress_bar.py[line:274] - INFO: epoch 069:    334 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.734, ntokens=17521.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3096.3, ups=0.18, wpb=17521.4, bsz=1024, num_updates=25190, lr=1.65824e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.1, wall=167226
2024-11-11 05:21:44 - progress_bar.py[line:274] - INFO: epoch 069:    344 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17360.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3083.9, ups=0.18, wpb=17360.8, bsz=1024, num_updates=25200, lr=1.65678e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=167282
2024-11-11 05:22:40 - progress_bar.py[line:274] - INFO: epoch 069:    354 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17315.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3065.4, ups=0.18, wpb=17315.2, bsz=1024, num_updates=25210, lr=1.65533e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=167339
2024-11-11 05:23:37 - progress_bar.py[line:274] - INFO: epoch 069:    364 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17531.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3110.2, ups=0.18, wpb=17531.4, bsz=1024, num_updates=25220, lr=1.65388e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=167395
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 05:23:45 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 69 @ 25222 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
2024-11-11 05:23:45 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt': File exists
: File exists
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 05:25:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 1 seek offset 46806
2024-11-11 05:27:30 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 69 @ 25222 updates, score 0) (writing took 224.89004786702571 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_69.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping


file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442

slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
2024-11-11 05:28:26 - train.py[line:336] - INFO: end of epoch 69 (average epoch stats below)
2024-11-11 05:28:26 - progress_bar.py[line:282] - INFO: epoch 069 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.735 | ntokens 17374.6 | nsentences 1023.06 | sample_size 1023.06 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.66 | wps 2592.4 | ups 0.15 | wpb 17374.6 | bsz 1023.1 | num_updates 25222 | lr 1.65359e-05 | gnorm 0.003 | clip 0 | loss_scale 131072 | train_wall 1884 | gb_free 13.4 | wall 167684
2024-11-11 05:28:26 - trainer.py[line:639] - INFO: loading train data for epoch 70
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 05:30:56 - trainer.py[line:703] - INFO: begin training epoch 70
2024-11-11 05:30:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 05:31:41 - progress_bar.py[line:274] - INFO: epoch 070:      8 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17066.5, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=352.5, ups=0.02, wpb=17066.5, bsz=998.4, num_updates=25230, lr=1.65242e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=32, gb_free=13.3, wall=167879
2024-11-11 05:32:34 - progress_bar.py[line:274] - INFO: epoch 070:     18 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.717, ntokens=17310.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3241.9, ups=0.19, wpb=17310.2, bsz=1024, num_updates=25240, lr=1.65097e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=167933
2024-11-11 05:33:27 - progress_bar.py[line:274] - INFO: epoch 070:     28 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17372.7, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3292.1, ups=0.19, wpb=17372.7, bsz=1015.4, num_updates=25250, lr=1.64952e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=167985
2024-11-11 05:34:20 - progress_bar.py[line:274] - INFO: epoch 070:     38 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.753, ntokens=17491.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3331.5, ups=0.19, wpb=17491.2, bsz=1024, num_updates=25260, lr=1.64806e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=30, gb_free=13.4, wall=168038
2024-11-11 05:35:14 - progress_bar.py[line:274] - INFO: epoch 070:     48 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.754, ntokens=17402.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3191.3, ups=0.18, wpb=17402.5, bsz=1024, num_updates=25270, lr=1.64661e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=35, gb_free=13.5, wall=168092
2024-11-11 05:36:07 - progress_bar.py[line:274] - INFO: epoch 070:     58 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17589.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3306.8, ups=0.19, wpb=17589.5, bsz=1024, num_updates=25280, lr=1.64516e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=51, gb_free=13.5, wall=168146
2024-11-11 05:37:02 - progress_bar.py[line:274] - INFO: epoch 070:     68 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.765, ntokens=17450.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3211.4, ups=0.18, wpb=17450.3, bsz=1024, num_updates=25290, lr=1.6437e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=168200
2024-11-11 05:37:57 - progress_bar.py[line:274] - INFO: epoch 070:     78 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17591.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3156.2, ups=0.18, wpb=17591.6, bsz=1024, num_updates=25300, lr=1.64225e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.5, wall=168256
2024-11-11 05:38:52 - progress_bar.py[line:274] - INFO: epoch 070:     88 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.747, ntokens=17608.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3219.8, ups=0.18, wpb=17608.9, bsz=1024, num_updates=25310, lr=1.6408e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=168310
2024-11-11 05:39:50 - progress_bar.py[line:274] - INFO: epoch 070:     98 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17564.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3059.1, ups=0.17, wpb=17564.2, bsz=1024, num_updates=25320, lr=1.63934e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=168368
2024-11-11 05:40:46 - progress_bar.py[line:274] - INFO: epoch 070:    108 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17513.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3093, ups=0.18, wpb=17513.7, bsz=1024, num_updates=25330, lr=1.63789e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.6, wall=168424
2024-11-11 05:41:41 - progress_bar.py[line:274] - INFO: epoch 070:    118 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17437.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3173.2, ups=0.18, wpb=17437.2, bsz=1024, num_updates=25340, lr=1.63644e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.4, wall=168479
2024-11-11 05:42:37 - progress_bar.py[line:274] - INFO: epoch 070:    128 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.693, ntokens=17253.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.47, wps=3088.5, ups=0.18, wpb=17253.3, bsz=1024, num_updates=25350, lr=1.63498e-05, gnorm=0.005, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=168535
2024-11-11 05:43:34 - progress_bar.py[line:274] - INFO: epoch 070:    138 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.786, ntokens=17648.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.9, wps=3119.7, ups=0.18, wpb=17648.8, bsz=1024, num_updates=25360, lr=1.63353e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=168592
2024-11-11 05:44:30 - progress_bar.py[line:274] - INFO: epoch 070:    148 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17370.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3081.6, ups=0.18, wpb=17370.5, bsz=1024, num_updates=25370, lr=1.63208e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.3, wall=168648
2024-11-11 05:45:27 - progress_bar.py[line:274] - INFO: epoch 070:    158 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.746, ntokens=17455.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.71, wps=3063.4, ups=0.18, wpb=17455.3, bsz=1024, num_updates=25380, lr=1.63062e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=168705
2024-11-11 05:46:25 - progress_bar.py[line:274] - INFO: epoch 070:    168 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.723, ntokens=17404.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3011.4, ups=0.17, wpb=17404.5, bsz=1024, num_updates=25390, lr=1.62917e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.5, wall=168763
2024-11-11 05:47:22 - progress_bar.py[line:274] - INFO: epoch 070:    178 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.732, ntokens=17428.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.64, wps=3066.4, ups=0.18, wpb=17428.3, bsz=1024, num_updates=25400, lr=1.62772e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=168820
2024-11-11 05:48:18 - progress_bar.py[line:274] - INFO: epoch 070:    188 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.76, ntokens=17478.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.77, wps=3107.4, ups=0.18, wpb=17478.3, bsz=1024, num_updates=25410, lr=1.62626e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=168876
2024-11-11 05:49:12 - progress_bar.py[line:274] - INFO: epoch 070:    198 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17400.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3208.5, ups=0.18, wpb=17400.1, bsz=1024, num_updates=25420, lr=1.62481e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=54, gb_free=13.4, wall=168930
2024-11-11 05:50:09 - progress_bar.py[line:274] - INFO: epoch 070:    208 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.721, ntokens=17317.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3049.6, ups=0.18, wpb=17317.9, bsz=1024, num_updates=25430, lr=1.62336e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=168987
2024-11-11 05:51:06 - progress_bar.py[line:274] - INFO: epoch 070:    218 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17094.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3007.6, ups=0.18, wpb=17094.9, bsz=1024, num_updates=25440, lr=1.6219e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=169044
2024-11-11 05:52:03 - progress_bar.py[line:274] - INFO: epoch 070:    228 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.72, ntokens=17404.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.59, wps=3034.5, ups=0.17, wpb=17404.1, bsz=1024, num_updates=25450, lr=1.62045e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=169101
2024-11-11 05:53:01 - progress_bar.py[line:274] - INFO: epoch 070:    238 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.739, ntokens=17299.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=2995, ups=0.17, wpb=17299.3, bsz=1024, num_updates=25460, lr=1.619e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=58, gb_free=13.4, wall=169159
2024-11-11 05:53:54 - progress_bar.py[line:274] - INFO: epoch 070:    248 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17495.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3287, ups=0.19, wpb=17495.7, bsz=1024, num_updates=25470, lr=1.61754e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=53, gb_free=13.6, wall=169212
2024-11-11 05:54:51 - progress_bar.py[line:274] - INFO: epoch 070:    258 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17292.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=3041.4, ups=0.18, wpb=17292.8, bsz=1024, num_updates=25480, lr=1.61609e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.5, wall=169269
2024-11-11 05:55:47 - progress_bar.py[line:274] - INFO: epoch 070:    268 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.73, ntokens=17401.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3074.2, ups=0.18, wpb=17401.1, bsz=1024, num_updates=25490, lr=1.61464e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.6, wall=169326
2024-11-11 05:56:40 - progress_bar.py[line:274] - INFO: epoch 070:    278 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17285.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3312.1, ups=0.19, wpb=17285.2, bsz=1024, num_updates=25500, lr=1.61318e-05, gnorm=0.002, clip=0, loss_scale=131072, train_wall=52, gb_free=13.4, wall=169378
2024-11-11 05:57:37 - progress_bar.py[line:274] - INFO: epoch 070:    288 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.768, ntokens=17487.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3072.4, ups=0.18, wpb=17487.2, bsz=1024, num_updates=25510, lr=1.61173e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.2, wall=169435
2024-11-11 05:58:31 - progress_bar.py[line:274] - INFO: epoch 070:    298 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.697, ntokens=17343.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.49, wps=3168.5, ups=0.18, wpb=17343.3, bsz=1024, num_updates=25520, lr=1.61028e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=55, gb_free=13.5, wall=169490
2024-11-11 05:59:29 - progress_bar.py[line:274] - INFO: epoch 070:    308 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.774, ntokens=17698.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.84, wps=3095.6, ups=0.17, wpb=17698.7, bsz=1024, num_updates=25530, lr=1.60882e-05, gnorm=0.004, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=169547
2024-11-11 06:00:26 - progress_bar.py[line:274] - INFO: epoch 070:    318 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.791, ntokens=17804.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.92, wps=3098.9, ups=0.17, wpb=17804.4, bsz=1024, num_updates=25540, lr=1.60737e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.4, wall=169604
2024-11-11 06:01:23 - progress_bar.py[line:274] - INFO: epoch 070:    328 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.775, ntokens=17731.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3117.3, ups=0.18, wpb=17731.4, bsz=1024, num_updates=25550, lr=1.60592e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=57, gb_free=13.3, wall=169661
2024-11-11 06:02:19 - progress_bar.py[line:274] - INFO: epoch 070:    338 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17523.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3114.2, ups=0.18, wpb=17523.6, bsz=1024, num_updates=25560, lr=1.60446e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=169717
2024-11-11 06:03:15 - progress_bar.py[line:274] - INFO: epoch 070:    348 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.744, ntokens=17431.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3122.2, ups=0.18, wpb=17431.7, bsz=1024, num_updates=25570, lr=1.60301e-05, gnorm=0.003, clip=0, loss_scale=131072, train_wall=56, gb_free=13.4, wall=169773
2024-11-11 06:04:12 - progress_bar.py[line:274] - INFO: epoch 070:    358 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17443.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3062.5, ups=0.18, wpb=17443.8, bsz=1024, num_updates=25580, lr=1.60156e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.2, wall=169830
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 06:04:54 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 70 @ 25588 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
2024-11-11 06:04:54 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 06:06:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-11 06:08:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 70 @ 25588 updates, score 0) (writing took 224.8112392280018 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_70.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442
slice_id 2 seek offset 93612
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
2024-11-11 06:09:35 - train.py[line:336] - INFO: end of epoch 70 (average epoch stats below)
2024-11-11 06:09:35 - progress_bar.py[line:282] - INFO: epoch 070 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.742 | ntokens 17446.3 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.69 | wps 2586 | ups 0.15 | wpb 17446.3 | bsz 1023.1 | num_updates 25588 | lr 1.6004e-05 | gnorm 0.004 | clip 0 | loss_scale 262144 | train_wall 1923 | gb_free 13.5 | wall 170153
2024-11-11 06:09:35 - trainer.py[line:639] - INFO: loading train data for epoch 71
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 06:12:04 - trainer.py[line:703] - INFO: begin training epoch 71
2024-11-11 06:12:04 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 06:12:17 - progress_bar.py[line:274] - INFO: epoch 071:      2 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17303.2, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=356.5, ups=0.02, wpb=17303.2, bsz=998.4, num_updates=25590, lr=1.6001e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=48, gb_free=13.3, wall=170315
2024-11-11 06:13:11 - progress_bar.py[line:274] - INFO: epoch 071:     12 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17471.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3278.4, ups=0.19, wpb=17471.4, bsz=1024, num_updates=25600, lr=1.59865e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=170369
2024-11-11 06:14:04 - progress_bar.py[line:274] - INFO: epoch 071:     22 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.708, ntokens=17326.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3240.4, ups=0.19, wpb=17326.6, bsz=1024, num_updates=25610, lr=1.5972e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=30, gb_free=13.5, wall=170422
2024-11-11 06:14:58 - progress_bar.py[line:274] - INFO: epoch 071:     32 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.736, ntokens=17390, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3214.8, ups=0.18, wpb=17390, bsz=1024, num_updates=25620, lr=1.59574e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=32, gb_free=13.5, wall=170476
2024-11-11 06:15:54 - progress_bar.py[line:274] - INFO: epoch 071:     42 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17406.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3110.4, ups=0.18, wpb=17406.1, bsz=1024, num_updates=25630, lr=1.59429e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=48, gb_free=13.4, wall=170532
2024-11-11 06:16:51 - progress_bar.py[line:274] - INFO: epoch 071:     52 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17320.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3031, ups=0.17, wpb=17320.5, bsz=1024, num_updates=25640, lr=1.59284e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=170589
2024-11-11 06:17:48 - progress_bar.py[line:274] - INFO: epoch 071:     62 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.729, ntokens=17383.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.63, wps=3060, ups=0.18, wpb=17383.1, bsz=1024, num_updates=25650, lr=1.59138e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=170646
2024-11-11 06:18:41 - progress_bar.py[line:274] - INFO: epoch 071:     72 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17389.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3254.9, ups=0.19, wpb=17389.6, bsz=1024, num_updates=25660, lr=1.58993e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.2, wall=170700
2024-11-11 06:19:34 - progress_bar.py[line:274] - INFO: epoch 071:     82 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.771, ntokens=17735.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.82, wps=3361.7, ups=0.19, wpb=17735.8, bsz=1024, num_updates=25670, lr=1.58848e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.4, wall=170752
2024-11-11 06:20:30 - progress_bar.py[line:274] - INFO: epoch 071:     92 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17625.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3171.7, ups=0.18, wpb=17625.9, bsz=1024, num_updates=25680, lr=1.58702e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=55, gb_free=13.4, wall=170808
2024-11-11 06:21:26 - progress_bar.py[line:274] - INFO: epoch 071:    102 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17239.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3088, ups=0.18, wpb=17239.3, bsz=1024, num_updates=25690, lr=1.58557e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=170864
2024-11-11 06:22:17 - progress_bar.py[line:274] - INFO: epoch 071:    112 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.727, ntokens=17430.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3371.2, ups=0.19, wpb=17430.1, bsz=1024, num_updates=25700, lr=1.58412e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=52, gb_free=13.4, wall=170915
2024-11-11 06:23:14 - progress_bar.py[line:274] - INFO: epoch 071:    122 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.74, ntokens=17357.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.68, wps=3039.3, ups=0.18, wpb=17357.4, bsz=1024, num_updates=25710, lr=1.58266e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=170973
2024-11-11 06:24:11 - progress_bar.py[line:274] - INFO: epoch 071:    132 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.718, ntokens=17461.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3069.7, ups=0.18, wpb=17461.2, bsz=1024, num_updates=25720, lr=1.58121e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171029
2024-11-11 06:25:05 - progress_bar.py[line:274] - INFO: epoch 071:    142 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.777, ntokens=17689.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.85, wps=3283.5, ups=0.19, wpb=17689.8, bsz=1024, num_updates=25730, lr=1.57976e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=54, gb_free=13.3, wall=171083
2024-11-11 06:26:03 - progress_bar.py[line:274] - INFO: epoch 071:    152 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.763, ntokens=17540.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.79, wps=3050, ups=0.17, wpb=17540.4, bsz=1024, num_updates=25740, lr=1.5783e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=171141
2024-11-11 06:26:55 - progress_bar.py[line:274] - INFO: epoch 071:    162 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.704, ntokens=17279.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.52, wps=3270.4, ups=0.19, wpb=17279.3, bsz=1024, num_updates=25750, lr=1.57685e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=53, gb_free=13.5, wall=171194
2024-11-11 06:27:52 - progress_bar.py[line:274] - INFO: epoch 071:    172 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.737, ntokens=17166.4, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.67, wps=3040.9, ups=0.18, wpb=17166.4, bsz=1015.4, num_updates=25760, lr=1.5754e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=171250
2024-11-11 06:28:49 - progress_bar.py[line:274] - INFO: epoch 071:    182 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.728, ntokens=17406, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.62, wps=3075.1, ups=0.18, wpb=17406, bsz=1024, num_updates=25770, lr=1.57394e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171307
2024-11-11 06:29:45 - progress_bar.py[line:274] - INFO: epoch 071:    192 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.719, ntokens=17287.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.58, wps=3046.8, ups=0.18, wpb=17287.3, bsz=1024, num_updates=25780, lr=1.57249e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171363
2024-11-11 06:30:41 - progress_bar.py[line:274] - INFO: epoch 071:    202 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.714, ntokens=17319, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.56, wps=3084.1, ups=0.18, wpb=17319, bsz=1024, num_updates=25790, lr=1.57104e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.5, wall=171420
2024-11-11 06:31:39 - progress_bar.py[line:274] - INFO: epoch 071:    212 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.733, ntokens=17459.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.65, wps=3053.2, ups=0.17, wpb=17459.5, bsz=1024, num_updates=25800, lr=1.56958e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171477
2024-11-11 06:32:36 - progress_bar.py[line:274] - INFO: epoch 071:    222 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.712, ntokens=17477.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3059.4, ups=0.18, wpb=17477.8, bsz=1024, num_updates=25810, lr=1.56813e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=171534
2024-11-11 06:33:33 - progress_bar.py[line:274] - INFO: epoch 071:    232 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17608.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3080.8, ups=0.17, wpb=17608.5, bsz=1024, num_updates=25820, lr=1.56668e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171591
2024-11-11 06:34:30 - progress_bar.py[line:274] - INFO: epoch 071:    242 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.757, ntokens=17465.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.76, wps=3035.2, ups=0.17, wpb=17465.5, bsz=1024, num_updates=25830, lr=1.56522e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.1, wall=171649
2024-11-11 06:35:27 - progress_bar.py[line:274] - INFO: epoch 071:    252 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17289.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3074, ups=0.18, wpb=17289.7, bsz=1024, num_updates=25840, lr=1.56377e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.2, wall=171705
2024-11-11 06:36:24 - progress_bar.py[line:274] - INFO: epoch 071:    262 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.735, ntokens=17350.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.66, wps=3038.2, ups=0.18, wpb=17350.5, bsz=1024, num_updates=25850, lr=1.56232e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=171762
2024-11-11 06:37:21 - progress_bar.py[line:274] - INFO: epoch 071:    272 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17365.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3058.3, ups=0.18, wpb=17365.3, bsz=1024, num_updates=25860, lr=1.56087e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=171819
2024-11-11 06:38:18 - progress_bar.py[line:274] - INFO: epoch 071:    282 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.669, ntokens=17090.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.36, wps=2991.9, ups=0.18, wpb=17090.1, bsz=1024, num_updates=25870, lr=1.55941e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=171876
2024-11-11 06:39:15 - progress_bar.py[line:274] - INFO: epoch 071:    292 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.715, ntokens=17374.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.57, wps=3036.5, ups=0.17, wpb=17374.4, bsz=1024, num_updates=25880, lr=1.55796e-05, gnorm=0.002, clip=0, loss_scale=262144, train_wall=57, gb_free=13.6, wall=171933
2024-11-11 06:40:11 - progress_bar.py[line:274] - INFO: epoch 071:    302 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.725, ntokens=17419.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.61, wps=3080.9, ups=0.18, wpb=17419.3, bsz=1024, num_updates=25890, lr=1.55651e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=171990
2024-11-11 06:41:07 - progress_bar.py[line:274] - INFO: epoch 071:    312 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.752, ntokens=17534.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.74, wps=3133.4, ups=0.18, wpb=17534.5, bsz=1024, num_updates=25900, lr=1.55505e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=172046
2024-11-11 06:42:04 - progress_bar.py[line:274] - INFO: epoch 071:    322 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.755, ntokens=17576.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3122.2, ups=0.18, wpb=17576.4, bsz=1024, num_updates=25910, lr=1.5536e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=172102
2024-11-11 06:43:00 - progress_bar.py[line:274] - INFO: epoch 071:    332 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.751, ntokens=17713.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3122.8, ups=0.18, wpb=17713.9, bsz=1024, num_updates=25920, lr=1.55215e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=172159
2024-11-11 06:43:57 - progress_bar.py[line:274] - INFO: epoch 071:    342 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.756, ntokens=17645.9, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.75, wps=3127.9, ups=0.18, wpb=17645.9, bsz=1024, num_updates=25930, lr=1.55069e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=172215
2024-11-11 06:44:54 - progress_bar.py[line:274] - INFO: epoch 071:    352 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.745, ntokens=17522.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.7, wps=3055.6, ups=0.17, wpb=17522.7, bsz=1024, num_updates=25940, lr=1.54924e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=172272
2024-11-11 06:45:52 - progress_bar.py[line:274] - INFO: epoch 071:    362 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.713, ntokens=17365.5, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3030.6, ups=0.17, wpb=17365.5, bsz=1024, num_updates=25950, lr=1.54779e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=172330
reach the end of datafile, start a new reader
reach the end of datafile, start a new reader
2024-11-11 06:46:11 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 71 @ 25954 updates
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.ptcp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt

cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
2024-11-11 06:46:11 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
cp: cp: cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt'cannot create regular file './polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt': File exists: File exists

local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
2024-11-11 06:48:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 7 row count 46805 total row count 374442

slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
2024-11-11 06:49:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_best.pt (epoch 71 @ 25954 updates, score 0) (writing took 225.63513215701096 seconds)
cp ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_last.pt ./polyformer_b_aihub_indoor_80_unique_checkpoints/100_5e-5_512/checkpoint_epoch_71.pt
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 2 row count 46805 total row count 374442
slice_id 4 seek offset 187222
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 5 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 3 seek offset 140417
2024-11-11 06:50:52 - train.py[line:336] - INFO: end of epoch 71 (average epoch stats below)
2024-11-11 06:50:52 - progress_bar.py[line:282] - INFO: epoch 071 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 2.734 | ntokens 17423.7 | nsentences 1023.07 | sample_size 1023.07 | sample_size_v1 0 | sample_size_v2 0 | ppl 6.65 | wps 2574.3 | ups 0.15 | wpb 17423.7 | bsz 1023.1 | num_updates 25954 | lr 1.5472e-05 | gnorm 0.003 | clip 0 | loss_scale 262144 | train_wall 1961 | gb_free 13.5 | wall 172630
2024-11-11 06:50:52 - trainer.py[line:639] - INFO: loading train data for epoch 72
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/finetune/aihub_indoor_bbox_fix/aihub_indoor_train.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-11 06:53:22 - trainer.py[line:703] - INFO: begin training epoch 72
2024-11-11 06:53:22 - train.py[line:297] - INFO: Start iterating over samples
2024-11-11 06:53:56 - progress_bar.py[line:274] - INFO: epoch 072:      6 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.742, ntokens=17093, nsentences=998.4, sample_size=998.4, sample_size_v1=0, sample_size_v2=0, ppl=6.69, wps=352.6, ups=0.02, wpb=17093, bsz=998.4, num_updates=25960, lr=1.54633e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=38, gb_free=13.4, wall=172814
2024-11-11 06:54:52 - progress_bar.py[line:274] - INFO: epoch 072:     16 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.766, ntokens=17668.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.8, wps=3164, ups=0.18, wpb=17668.3, bsz=1024, num_updates=25970, lr=1.54488e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=38, gb_free=13.5, wall=172870
2024-11-11 06:55:49 - progress_bar.py[line:274] - INFO: epoch 072:     26 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17337.6, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=3025.4, ups=0.17, wpb=17337.6, bsz=1024, num_updates=25980, lr=1.54343e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.3, wall=172928
2024-11-11 06:56:46 - progress_bar.py[line:274] - INFO: epoch 072:     36 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.748, ntokens=17566.7, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.72, wps=3088, ups=0.18, wpb=17566.7, bsz=1024, num_updates=25990, lr=1.54197e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=172984
2024-11-11 06:57:44 - progress_bar.py[line:274] - INFO: epoch 072:     46 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.703, ntokens=17182.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.51, wps=2996.2, ups=0.17, wpb=17182.1, bsz=1024, num_updates=26000, lr=1.54052e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=173042
2024-11-11 06:58:41 - progress_bar.py[line:274] - INFO: epoch 072:     56 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.709, ntokens=17305.2, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.54, wps=3020.6, ups=0.17, wpb=17305.2, bsz=1024, num_updates=26010, lr=1.53907e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=173099
2024-11-11 06:59:38 - progress_bar.py[line:274] - INFO: epoch 072:     66 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17232.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3040.2, ups=0.18, wpb=17232.3, bsz=1024, num_updates=26020, lr=1.53761e-05, gnorm=0.005, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=173156
2024-11-11 07:00:34 - progress_bar.py[line:274] - INFO: epoch 072:     76 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.676, ntokens=17075.3, nsentences=1015.4, sample_size=1015.4, sample_size_v1=0, sample_size_v2=0, ppl=6.39, wps=3027.7, ups=0.18, wpb=17075.3, bsz=1015.4, num_updates=26030, lr=1.53616e-05, gnorm=0.004, clip=0, loss_scale=262144, train_wall=56, gb_free=13.4, wall=173212
2024-11-11 07:01:30 - progress_bar.py[line:274] - INFO: epoch 072:     86 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.75, ntokens=17511.1, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.73, wps=3100.3, ups=0.18, wpb=17511.1, bsz=1024, num_updates=26040, lr=1.53471e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=173269
2024-11-11 07:02:27 - progress_bar.py[line:274] - INFO: epoch 072:     96 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.71, ntokens=17309.4, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.55, wps=3059, ups=0.18, wpb=17309.4, bsz=1024, num_updates=26050, lr=1.53325e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=56, gb_free=13.3, wall=173325
2024-11-11 07:03:24 - progress_bar.py[line:274] - INFO: epoch 072:    106 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.722, ntokens=17417.3, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.6, wps=3057.9, ups=0.18, wpb=17417.3, bsz=1024, num_updates=26060, lr=1.5318e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.5, wall=173382
2024-11-11 07:04:21 - progress_bar.py[line:274] - INFO: epoch 072:    116 / 366 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=2.769, ntokens=17613.8, nsentences=1024, sample_size=1024, sample_size_v1=0, sample_size_v2=0, ppl=6.81, wps=3087.5, ups=0.18, wpb=17613.8, bsz=1024, num_updates=26070, lr=1.53035e-05, gnorm=0.003, clip=0, loss_scale=262144, train_wall=57, gb_free=13.4, wall=173439
