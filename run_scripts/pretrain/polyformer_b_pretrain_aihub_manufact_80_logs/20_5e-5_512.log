/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:12 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-06 03:30:15 - utils.py[line:261] - INFO: Start init
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-06 03:30:15 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 4
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 2
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 5
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
single-machine distributed training is initialized.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 3
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 7
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 1
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 6
single-machine distributed training is initialized.
2024-11-06 03:30:15 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-06 03:30:15 - utils.py[line:274] - INFO: initialized host ip-172-31-11-84 as rank 0
single-machine distributed training is initialized.
2024-11-06 03:30:19 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 20, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 1000, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 20, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 20, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512', 'restore_file': '../pretrain/polyformer_b_pretrain_aihub_indoor_80_checkpoints_resume_2/20_5e-5_512/checkpoint.best_score_0.5220.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=20, batch_size_valid=20, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/pretrain/train_aihub_manufact_80.tsv,../../datasets/pretrain/val_aihub_manufact_80.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=1.0, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=20, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='../pretrain/polyformer_b_pretrain_aihub_indoor_80_checkpoints_resume_2/20_5e-5_512/checkpoint.best_score_0.5220.pt', sample_patch_num=196, save_dir='./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512', save_interval=1, save_interval_updates=1000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,3,1,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco_pretrain', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=1000, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco_pretrain', 'data': '../../datasets/pretrain/train_aihub_manufact_80.tsv,../../datasets/pretrain/val_aihub_manufact_80.tsv', 'selected_cols': '0,3,1,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 1.0, 'cls_weight': 0.0, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-06 03:30:19 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-06 03:30:19 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
Loaded Swin Pretrained Weights ../../pretrained_weights/swin_base_patch4_window12_384_22k.pth
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 1 row count 6955 total row count 55640
The model and loaded state dict do not match exactly

unexpected key in source state_dict: norm.weight, norm.bias, head.weight, head.bias, layers.0.blocks.1.attn_mask, layers.1.blocks.1.attn_mask, layers.2.blocks.1.attn_mask, layers.2.blocks.3.attn_mask, layers.2.blocks.5.attn_mask, layers.2.blocks.7.attn_mask, layers.2.blocks.9.attn_mask, layers.2.blocks.11.attn_mask, layers.2.blocks.13.attn_mask, layers.2.blocks.15.attn_mask, layers.2.blocks.17.attn_mask

missing keys in source state_dict: norm3.weight, norm3.bias

2024-11-06 03:30:32 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-06 03:30:32 - train.py[line:102] - INFO: task: RefcocoPretrainTask
2024-11-06 03:30:32 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-06 03:30:32 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
2024-11-06 03:30:32 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-06 03:30:32 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 0 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 3 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 6 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 4 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 2 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 5 row count 6955 total row count 55640
local datafile ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_manufact_80.tsv slice_id 7 row count 6955 total row count 55640
2024-11-06 03:30:34 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-06 03:30:34 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-06 03:30:34 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-06 03:30:36 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-06 03:30:36 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-06 03:30:36 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-06 03:30:36 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 20
2024-11-06 03:30:36 - trainer.py[line:458] - INFO: Preparing to load checkpoint ../pretrain/polyformer_b_pretrain_aihub_indoor_80_checkpoints_resume_2/20_5e-5_512/checkpoint.best_score_0.5220.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 03:30:48 - trainer.py[line:619] - INFO: Loaded checkpoint ../pretrain/polyformer_b_pretrain_aihub_indoor_80_checkpoints_resume_2/20_5e-5_512/checkpoint.best_score_0.5220.pt (epoch 16 @ 0 updates)
2024-11-06 03:30:48 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 1 seek offset 50000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 5 seek offset 250000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 2 seek offset 100000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 3 seek offset 150000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 0 seek offset 0
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
2024-11-06 03:30:50 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-06 03:30:50 - train.py[line:297] - INFO: Start iterating over samples
slice_id 7 seek offset 350000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 6 seek offset 300000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
slice_id 4 seek offset 200000
Total steps 6260, warmup steps 375, warmup_factor 0.0026666666666666666
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.1722412109375 loss_cls: 0.0
loss_reg: 0.1688232421875 loss_cls: 0.0
loss_reg: 0.1614990234375 loss_cls: 0.0
loss_reg: 0.179443359375 loss_cls: 0.0
loss_reg: 0.167236328125 loss_cls: 0.0
loss_reg: 0.1710205078125 loss_cls: 0.0
loss_reg: 0.1947021484375 loss_cls: 0.0
loss_reg: 0.1422119140625 loss_cls: 0.0
loss_reg: 0.1666259765625 loss_cls: 0.0
loss_reg: 0.1607666015625 loss_cls: 0.0
loss_reg: 0.1856689453125 loss_cls: 0.0
loss_reg: 0.174072265625 loss_cls: 0.0
loss_reg: 0.135009765625 loss_cls: 0.0
loss_reg: 0.1639404296875 loss_cls: 0.0
loss_reg: 0.178955078125 loss_cls: 0.0
loss_reg: 0.181640625 loss_cls: 0.0
loss_reg: 0.201904296875 loss_cls: 0.0
loss_reg: 0.14208984375 loss_cls: 0.0
loss_reg: 0.1446533203125 loss_cls: 0.0
loss_reg: 0.144775390625 loss_cls: 0.0
loss_reg: 0.1973876953125 loss_cls: 0.0
loss_reg: 0.14697265625 loss_cls: 0.0
loss_reg: 0.17236328125 loss_cls: 0.0
loss_reg: 0.15185546875 loss_cls: 0.0
loss_reg: 0.15673828125 loss_cls: 0.0
loss_reg: 0.167236328125 loss_cls: 0.0
loss_reg: 0.203125 loss_cls: 0.0
loss_reg: 0.16552734375 loss_cls: 0.0
loss_reg: 0.1826171875 loss_cls: 0.0
loss_reg: 0.172607421875 loss_cls: 0.0
loss_reg: 0.126220703125 loss_cls: 0.0
loss_reg: 0.142333984375 loss_cls: 0.0
loss_reg: 0.1328125 loss_cls: 0.0
loss_reg: 0.142333984375 loss_cls: 0.0
loss_reg: 0.1571044921875 loss_cls: 0.0
loss_reg: 0.171142578125 loss_cls: 0.0
loss_reg: 0.2003173828125 loss_cls: 0.0
loss_reg: 0.1312255859375 loss_cls: 0.0
loss_reg: 0.142822265625 loss_cls: 0.0
loss_reg: 0.152099609375 loss_cls: 0.0
loss_reg: 0.1446533203125 loss_cls: 0.0
loss_reg: 0.1373291015625 loss_cls: 0.0
loss_reg: 0.16455078125 loss_cls: 0.0
loss_reg: 0.177734375 loss_cls: 0.0
loss_reg: 0.1768798828125 loss_cls: 0.0
loss_reg: 0.11932373046875 loss_cls: 0.0
loss_reg: 0.1712646484375 loss_cls: 0.0
loss_reg: 0.151123046875 loss_cls: 0.0
loss_reg: 0.1136474609375 loss_cls: 0.0
loss_reg: 0.1466064453125 loss_cls: 0.0
loss_reg: 0.1773681640625 loss_cls: 0.0
loss_reg: 0.1632080078125 loss_cls: 0.0
loss_reg: 0.1806640625 loss_cls: 0.0
loss_reg: 0.1534423828125 loss_cls: 0.0
loss_reg: 0.1759033203125 loss_cls: 0.0
loss_reg: 0.148681640625 loss_cls: 0.0
loss_reg: 0.18115234375 loss_cls: 0.0
loss_reg: 0.1873779296875 loss_cls: 0.0
loss_reg: 0.14501953125 loss_cls: 0.0
loss_reg: 0.15625 loss_cls: 0.0
loss_reg: 0.1715087890625 loss_cls: 0.0
loss_reg: 0.123779296875 loss_cls: 0.0
loss_reg: 0.1630859375 loss_cls: 0.0
loss_reg: 0.158935546875 loss_cls: 0.0
2024-11-06 03:32:40 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=5117.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.08, wps=509.5, ups=0.1, wpb=5117.3, bsz=1280, num_updates=10, lr=1.33333e-06, gnorm=0.02, clip=0, loss_scale=128, train_wall=57, gb_free=9.5, wall=124
2024-11-06 03:34:22 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=501.3, ups=0.1, wpb=5118.4, bsz=1280, num_updates=20, lr=2.66667e-06, gnorm=0.022, clip=0, loss_scale=128, train_wall=71, gb_free=9.6, wall=226
2024-11-06 03:36:05 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=496.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=30, lr=4e-06, gnorm=0.015, clip=0, loss_scale=128, train_wall=99, gb_free=9.7, wall=329
2024-11-06 03:37:47 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.577, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=499.3, ups=0.1, wpb=5118.3, bsz=1280, num_updates=40, lr=5.33333e-06, gnorm=0.011, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=431
2024-11-06 03:39:30 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.54, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.63, wps=500.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=50, lr=6.66667e-06, gnorm=0.008, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=534
2024-11-06 03:41:12 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.513, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.41, wps=500.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=60, lr=8e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=636
2024-11-06 03:42:54 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.489, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.23, wps=499.8, ups=0.1, wpb=5117.8, bsz=1280, num_updates=70, lr=9.33333e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=739
2024-11-06 03:44:37 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=498.6, ups=0.1, wpb=5118.3, bsz=1280, num_updates=80, lr=1.06667e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=841
2024-11-06 03:46:20 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.437, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=497.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=90, lr=1.2e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=944
2024-11-06 03:48:02 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.441, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.86, wps=498.9, ups=0.1, wpb=5117.8, bsz=1280, num_updates=100, lr=1.33333e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.6, wall=1047
2024-11-06 03:49:45 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.439, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.84, wps=500.5, ups=0.1, wpb=5118.7, bsz=1280, num_updates=110, lr=1.46667e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1149
2024-11-06 03:51:27 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 313 loss=0.008, loss_v1=0, loss_v2=0, nll_loss=3.444, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.88, wps=499.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=120, lr=1.6e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1251
2024-11-06 03:53:09 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.466, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=500.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=130, lr=1.73333e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1353
2024-11-06 03:54:52 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=499.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=140, lr=1.86667e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1456
2024-11-06 03:56:34 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.468, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=499.7, ups=0.1, wpb=5118.3, bsz=1280, num_updates=150, lr=2e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1558
2024-11-06 03:58:17 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.466, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=498.6, ups=0.1, wpb=5118, bsz=1280, num_updates=160, lr=2.13333e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=1661
2024-11-06 03:59:59 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.464, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.03, wps=499, ups=0.1, wpb=5117.9, bsz=1280, num_updates=170, lr=2.26667e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1764
2024-11-06 04:01:42 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.516, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.44, wps=499.2, ups=0.1, wpb=5118.2, bsz=1280, num_updates=180, lr=2.4e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1866
2024-11-06 04:03:24 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.53, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=499.9, ups=0.1, wpb=5118.8, bsz=1280, num_updates=190, lr=2.53333e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=1968
2024-11-06 04:05:07 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=498.6, ups=0.1, wpb=5118.6, bsz=1280, num_updates=200, lr=2.66667e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=103, gb_free=9.5, wall=2071
2024-11-06 04:06:48 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.546, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.68, wps=504.1, ups=0.1, wpb=5117.9, bsz=1280, num_updates=210, lr=2.8e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=101, gb_free=9.7, wall=2173
2024-11-06 04:08:31 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.528, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.54, wps=498, ups=0.1, wpb=5117.7, bsz=1280, num_updates=220, lr=2.93333e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=103, gb_free=9.6, wall=2275
2024-11-06 04:10:14 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.514, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.43, wps=498.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=230, lr=3.06667e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=103, gb_free=9.6, wall=2378
2024-11-06 04:11:57 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.491, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=496.6, ups=0.1, wpb=5118.2, bsz=1280, num_updates=240, lr=3.2e-05, gnorm=0.009, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=2481
2024-11-06 04:13:40 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.502, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.33, wps=497, ups=0.1, wpb=5119.4, bsz=1280, num_updates=250, lr=3.33333e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=2584
2024-11-06 04:15:22 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.51, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=499.8, ups=0.1, wpb=5117.9, bsz=1280, num_updates=260, lr=3.46667e-05, gnorm=0.011, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=2687
2024-11-06 04:17:05 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=499.7, ups=0.1, wpb=5118.2, bsz=1280, num_updates=270, lr=3.6e-05, gnorm=0.009, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=2789
2024-11-06 04:18:47 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.478, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=499.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=280, lr=3.73333e-05, gnorm=0.01, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=2892
2024-11-06 04:20:30 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.466, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=499.9, ups=0.1, wpb=5118, bsz=1280, num_updates=290, lr=3.86667e-05, gnorm=0.01, clip=0, loss_scale=128, train_wall=102, gb_free=9.6, wall=2994
2024-11-06 04:22:13 - progress_bar.py[line:274] - INFO: epoch 001:    300 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.438, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.84, wps=495.5, ups=0.1, wpb=5118.7, bsz=1280, num_updates=300, lr=4e-05, gnorm=0.01, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=3097
2024-11-06 04:23:56 - progress_bar.py[line:274] - INFO: epoch 001:    310 / 313 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.75, wps=494.8, ups=0.1, wpb=5119.4, bsz=1280, num_updates=310, lr=4.13333e-05, gnorm=0.012, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=3201
slice_id 1 seek offset 6955slice_id 6 seek offset 41730
slice_id 3 seek offset 20865slice_id 7 seek offset 48685
2024-11-06 04:24:20 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 2 seek offset 13910

slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 0 seek offset 0
2024-11-06 04:31:42 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 0.007 | loss_v1 0 | loss_v2 0 | nll_loss 3.424 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.73 | score 0.3088 | wps 505.1 | wpb 639.3 | bsz 159.9 | num_updates 313
2024-11-06 04:31:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 313 updates
2024-11-06 04:31:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 5 seek offset 250000
2024-11-06 04:31:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 04:32:05 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 1 @ 313 updates, score 0.3088) (writing took 22.403973555003176 seconds)
2024-11-06 04:32:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 313 updates
2024-11-06 04:32:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 04:33:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 04:33:32 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 1 @ 313 updates, score 0) (writing took 87.21537868800078 seconds)
2024-11-06 04:33:32 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-06 04:33:32 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.007 | loss_v1 0 | loss_v2 0 | nll_loss 3.497 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.29 | wps 426 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 313 | lr 4.17333e-05 | gnorm 0.008 | clip 0 | loss_scale 128 | train_wall 3120 | gb_free 9.7 | wall 3776
2024-11-06 04:33:32 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 04:33:34 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-06 04:33:34 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 04:34:47 - progress_bar.py[line:274] - INFO: epoch 002:      7 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.442, ntokens=4861.8, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.86, wps=74.7, ups=0.02, wpb=4861.8, bsz=1216, num_updates=320, lr=4.26667e-05, gnorm=0.014, clip=0, loss_scale=128, train_wall=48, gb_free=9.7, wall=3851
2024-11-06 04:36:27 - progress_bar.py[line:274] - INFO: epoch 002:     17 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.97, wps=511.5, ups=0.1, wpb=5118, bsz=1280, num_updates=330, lr=4.4e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=3952
2024-11-06 04:38:07 - progress_bar.py[line:274] - INFO: epoch 002:     27 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=514.8, ups=0.1, wpb=5118.5, bsz=1280, num_updates=340, lr=4.53333e-05, gnorm=0.013, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4051
2024-11-06 04:39:48 - progress_bar.py[line:274] - INFO: epoch 002:     37 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.416, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=505.5, ups=0.1, wpb=5118, bsz=1280, num_updates=350, lr=4.66667e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=39, gb_free=9.7, wall=4152
2024-11-06 04:41:30 - progress_bar.py[line:274] - INFO: epoch 002:     47 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.456, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=501.5, ups=0.1, wpb=5118, bsz=1280, num_updates=360, lr=4.8e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=65, gb_free=9.7, wall=4254
2024-11-06 04:43:13 - progress_bar.py[line:274] - INFO: epoch 002:     57 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.463, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.03, wps=496.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=370, lr=4.93333e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=96, gb_free=9.7, wall=4357
2024-11-06 04:44:57 - progress_bar.py[line:274] - INFO: epoch 002:     67 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.486, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.21, wps=494.5, ups=0.1, wpb=5117.5, bsz=1280, num_updates=380, lr=4.99575e-05, gnorm=0.014, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=4461
2024-11-06 04:46:40 - progress_bar.py[line:274] - INFO: epoch 002:     77 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.48, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.16, wps=496.6, ups=0.1, wpb=5118.3, bsz=1280, num_updates=390, lr=4.98726e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=4564
2024-11-06 04:48:23 - progress_bar.py[line:274] - INFO: epoch 002:     87 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=496, ups=0.1, wpb=5118.2, bsz=1280, num_updates=400, lr=4.97876e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=103, gb_free=9.6, wall=4667
2024-11-06 04:50:06 - progress_bar.py[line:274] - INFO: epoch 002:     97 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.41, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=496.4, ups=0.1, wpb=5117.8, bsz=1280, num_updates=410, lr=4.97026e-05, gnorm=0.017, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=4770
2024-11-06 04:51:48 - progress_bar.py[line:274] - INFO: epoch 002:    107 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.424, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=501, ups=0.1, wpb=5118.2, bsz=1280, num_updates=420, lr=4.96177e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=4872
2024-11-06 04:53:31 - progress_bar.py[line:274] - INFO: epoch 002:    117 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.416, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.68, wps=498.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=430, lr=4.95327e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=4975
2024-11-06 04:55:13 - progress_bar.py[line:274] - INFO: epoch 002:    127 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.41, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=501.9, ups=0.1, wpb=5118.6, bsz=1280, num_updates=440, lr=4.94477e-05, gnorm=0.015, clip=0, loss_scale=128, train_wall=102, gb_free=9.5, wall=5077
2024-11-06 04:56:56 - progress_bar.py[line:274] - INFO: epoch 002:    137 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.435, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.81, wps=496.2, ups=0.1, wpb=5118.6, bsz=1280, num_updates=450, lr=4.93628e-05, gnorm=0.017, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=5180
2024-11-06 04:58:42 - progress_bar.py[line:274] - INFO: epoch 002:    147 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.425, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.74, wps=484.2, ups=0.09, wpb=5118.1, bsz=1280, num_updates=460, lr=4.92778e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=106, gb_free=9.7, wall=5286
2024-11-06 05:00:25 - progress_bar.py[line:274] - INFO: epoch 002:    157 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=493, ups=0.1, wpb=5118.1, bsz=1280, num_updates=470, lr=4.91929e-05, gnorm=0.017, clip=0, loss_scale=128, train_wall=104, gb_free=9.7, wall=5390
2024-11-06 05:02:08 - progress_bar.py[line:274] - INFO: epoch 002:    167 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=497.6, ups=0.1, wpb=5118.2, bsz=1280, num_updates=480, lr=4.91079e-05, gnorm=0.017, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=5493
2024-11-06 05:03:51 - progress_bar.py[line:274] - INFO: epoch 002:    177 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.449, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.92, wps=496.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=490, lr=4.90229e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=5596
2024-11-06 05:05:35 - progress_bar.py[line:274] - INFO: epoch 002:    187 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=496.8, ups=0.1, wpb=5118.5, bsz=1280, num_updates=500, lr=4.8938e-05, gnorm=0.016, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=5699
2024-11-06 05:07:17 - progress_bar.py[line:274] - INFO: epoch 002:    197 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=5119, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=499, ups=0.1, wpb=5119, bsz=1280, num_updates=510, lr=4.8853e-05, gnorm=0.017, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=5801
2024-11-06 05:09:00 - progress_bar.py[line:274] - INFO: epoch 002:    207 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=498.1, ups=0.1, wpb=5117.8, bsz=1280, num_updates=520, lr=4.87681e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=5904
2024-11-06 05:10:43 - progress_bar.py[line:274] - INFO: epoch 002:    217 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=496.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=530, lr=4.86831e-05, gnorm=0.016, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=6007
2024-11-06 05:12:25 - progress_bar.py[line:274] - INFO: epoch 002:    227 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.484, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.19, wps=499, ups=0.1, wpb=5118, bsz=1280, num_updates=540, lr=4.85981e-05, gnorm=0.019, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=6110
2024-11-06 05:14:10 - progress_bar.py[line:274] - INFO: epoch 002:    237 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.488, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.22, wps=491.9, ups=0.1, wpb=5118, bsz=1280, num_updates=550, lr=4.85132e-05, gnorm=0.019, clip=0, loss_scale=256, train_wall=104, gb_free=9.7, wall=6214
2024-11-06 05:15:52 - progress_bar.py[line:274] - INFO: epoch 002:    247 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=499.3, ups=0.1, wpb=5119.2, bsz=1280, num_updates=560, lr=4.84282e-05, gnorm=0.018, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=6316
2024-11-06 05:17:35 - progress_bar.py[line:274] - INFO: epoch 002:    257 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=497.7, ups=0.1, wpb=5117.9, bsz=1280, num_updates=570, lr=4.83432e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=6419
2024-11-06 05:19:18 - progress_bar.py[line:274] - INFO: epoch 002:    267 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.462, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.02, wps=495.1, ups=0.1, wpb=5118, bsz=1280, num_updates=580, lr=4.82583e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=6522
2024-11-06 05:21:01 - progress_bar.py[line:274] - INFO: epoch 002:    277 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.485, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.2, wps=499.6, ups=0.1, wpb=5118.8, bsz=1280, num_updates=590, lr=4.81733e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=6625
2024-11-06 05:22:43 - progress_bar.py[line:274] - INFO: epoch 002:    287 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.513, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.41, wps=499.4, ups=0.1, wpb=5118, bsz=1280, num_updates=600, lr=4.80884e-05, gnorm=0.012, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=6727
2024-11-06 05:24:26 - progress_bar.py[line:274] - INFO: epoch 002:    297 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.546, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.68, wps=498.3, ups=0.1, wpb=5118.6, bsz=1280, num_updates=610, lr=4.80034e-05, gnorm=0.016, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=6830
2024-11-06 05:26:09 - progress_bar.py[line:274] - INFO: epoch 002:    307 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.552, ntokens=5119.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.73, wps=495.7, ups=0.1, wpb=5119.1, bsz=1280, num_updates=620, lr=4.79184e-05, gnorm=0.02, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=6933
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820slice_id 5 seek offset 34775

2024-11-06 05:27:04 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 3 seek offset 20865
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 5 seek offset 34775
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 05:34:27 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 0.006 | loss_v1 0 | loss_v2 0 | nll_loss 3.514 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.42 | score 0.4213 | wps 504.4 | wpb 639.3 | bsz 159.9 | num_updates 626 | best_score 0.4213
2024-11-06 05:34:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 626 updates
2024-11-06 05:34:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 05:35:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 05:36:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 2 @ 626 updates, score 0.4213) (writing took 135.84809161000157 seconds)
2024-11-06 05:36:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 626 updates
2024-11-06 05:36:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 05:38:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 05:38:11 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 2 @ 626 updates, score 0) (writing took 88.18030600099883 seconds)
2024-11-06 05:38:11 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-06 05:38:11 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.006 | loss_v1 0 | loss_v2 0 | nll_loss 3.458 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.99 | wps 412.3 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 626 | lr 4.78675e-05 | gnorm 0.016 | clip 0 | loss_scale 256 | train_wall 2922 | gb_free 9.7 | wall 7656
2024-11-06 05:38:11 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 05:38:14 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-06 05:38:14 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 05:38:58 - progress_bar.py[line:274] - INFO: epoch 003:      4 / 313 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.531, ntokens=4862.1, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=63.3, ups=0.01, wpb=4862.1, bsz=1216, num_updates=630, lr=4.78335e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=69, gb_free=9.7, wall=7702
2024-11-06 05:40:38 - progress_bar.py[line:274] - INFO: epoch 003:     14 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.496, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=510.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=640, lr=4.77485e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=7802
2024-11-06 05:42:18 - progress_bar.py[line:274] - INFO: epoch 003:     24 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.506, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.36, wps=511.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=650, lr=4.76636e-05, gnorm=0.018, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=7902
2024-11-06 05:43:59 - progress_bar.py[line:274] - INFO: epoch 003:     34 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.499, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.3, wps=509, ups=0.1, wpb=5117.8, bsz=1280, num_updates=660, lr=4.75786e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8003
2024-11-06 05:45:40 - progress_bar.py[line:274] - INFO: epoch 003:     44 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=507.8, ups=0.1, wpb=5118, bsz=1280, num_updates=670, lr=4.74936e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=36, gb_free=9.7, wall=8104
2024-11-06 05:47:23 - progress_bar.py[line:274] - INFO: epoch 003:     54 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=495.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=680, lr=4.74087e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=57, gb_free=9.7, wall=8207
2024-11-06 05:49:06 - progress_bar.py[line:274] - INFO: epoch 003:     64 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.506, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.36, wps=496.5, ups=0.1, wpb=5118, bsz=1280, num_updates=690, lr=4.73237e-05, gnorm=0.018, clip=0, loss_scale=256, train_wall=87, gb_free=9.7, wall=8310
2024-11-06 05:50:49 - progress_bar.py[line:274] - INFO: epoch 003:     74 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=496.8, ups=0.1, wpb=5117.7, bsz=1280, num_updates=700, lr=4.72387e-05, gnorm=0.019, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=8413
2024-11-06 05:52:32 - progress_bar.py[line:274] - INFO: epoch 003:     84 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=497, ups=0.1, wpb=5118.4, bsz=1280, num_updates=710, lr=4.71538e-05, gnorm=0.02, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=8516
2024-11-06 05:54:14 - progress_bar.py[line:274] - INFO: epoch 003:     94 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.482, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.17, wps=499.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=720, lr=4.70688e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=8619
2024-11-06 05:55:58 - progress_bar.py[line:274] - INFO: epoch 003:    104 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.479, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.15, wps=492.8, ups=0.1, wpb=5117.8, bsz=1280, num_updates=730, lr=4.69839e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=104, gb_free=9.7, wall=8722
2024-11-06 05:57:43 - progress_bar.py[line:274] - INFO: epoch 003:    114 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.49, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=489, ups=0.1, wpb=5118.5, bsz=1280, num_updates=740, lr=4.68989e-05, gnorm=0.019, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=8827
2024-11-06 05:59:28 - progress_bar.py[line:274] - INFO: epoch 003:    124 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.466, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=488.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=750, lr=4.68139e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=105, gb_free=9.6, wall=8932
2024-11-06 06:01:12 - progress_bar.py[line:274] - INFO: epoch 003:    134 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.463, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.03, wps=488.4, ups=0.1, wpb=5118.7, bsz=1280, num_updates=760, lr=4.6729e-05, gnorm=0.021, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=9037
2024-11-06 06:02:58 - progress_bar.py[line:274] - INFO: epoch 003:    144 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.457, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.98, wps=487, ups=0.1, wpb=5118.2, bsz=1280, num_updates=770, lr=4.6644e-05, gnorm=0.018, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=9142
2024-11-06 06:04:41 - progress_bar.py[line:274] - INFO: epoch 003:    154 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=492.4, ups=0.1, wpb=5118, bsz=1280, num_updates=780, lr=4.6559e-05, gnorm=0.016, clip=0, loss_scale=256, train_wall=104, gb_free=9.7, wall=9246
2024-11-06 06:06:24 - progress_bar.py[line:274] - INFO: epoch 003:    164 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.461, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.01, wps=497.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=790, lr=4.64741e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=9349
2024-11-06 06:08:08 - progress_bar.py[line:274] - INFO: epoch 003:    174 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.455, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.96, wps=493.5, ups=0.1, wpb=5118, bsz=1280, num_updates=800, lr=4.63891e-05, gnorm=0.017, clip=0, loss_scale=256, train_wall=104, gb_free=9.6, wall=9452
2024-11-06 06:09:52 - progress_bar.py[line:274] - INFO: epoch 003:    184 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.448, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.91, wps=494.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=810, lr=4.63042e-05, gnorm=0.016, clip=0, loss_scale=256, train_wall=103, gb_free=9.6, wall=9556
2024-11-06 06:11:37 - progress_bar.py[line:274] - INFO: epoch 003:    194 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.428, ntokens=5119, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=486.8, ups=0.1, wpb=5119, bsz=1280, num_updates=820, lr=4.62192e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=9661
2024-11-06 06:13:22 - progress_bar.py[line:274] - INFO: epoch 003:    204 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.501, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.32, wps=488.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=830, lr=4.61342e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=9766
2024-11-06 06:15:04 - progress_bar.py[line:274] - INFO: epoch 003:    214 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=497.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=840, lr=4.60493e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=103, gb_free=9.6, wall=9869
2024-11-06 06:16:47 - progress_bar.py[line:274] - INFO: epoch 003:    224 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.446, ntokens=5117.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=497, ups=0.1, wpb=5117.2, bsz=1280, num_updates=850, lr=4.59643e-05, gnorm=0.012, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=9972
2024-11-06 06:18:31 - progress_bar.py[line:274] - INFO: epoch 003:    234 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=492.7, ups=0.1, wpb=5118.6, bsz=1280, num_updates=860, lr=4.58794e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=104, gb_free=9.7, wall=10075
2024-11-06 06:20:15 - progress_bar.py[line:274] - INFO: epoch 003:    244 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=494.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=870, lr=4.57944e-05, gnorm=0.01, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=10179
2024-11-06 06:22:00 - progress_bar.py[line:274] - INFO: epoch 003:    254 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=487.2, ups=0.1, wpb=5118.5, bsz=1280, num_updates=880, lr=4.57094e-05, gnorm=0.012, clip=0, loss_scale=256, train_wall=105, gb_free=9.7, wall=10284
2024-11-06 06:23:44 - progress_bar.py[line:274] - INFO: epoch 003:    264 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=489.5, ups=0.1, wpb=5118, bsz=1280, num_updates=890, lr=4.56245e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=104, gb_free=9.6, wall=10389
2024-11-06 06:25:29 - progress_bar.py[line:274] - INFO: epoch 003:    274 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=489.8, ups=0.1, wpb=5118.9, bsz=1280, num_updates=900, lr=4.55395e-05, gnorm=0.011, clip=0, loss_scale=256, train_wall=104, gb_free=9.7, wall=10493
2024-11-06 06:27:15 - progress_bar.py[line:274] - INFO: epoch 003:    284 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=484.1, ups=0.09, wpb=5118.1, bsz=1280, num_updates=910, lr=4.54545e-05, gnorm=0.016, clip=0, loss_scale=256, train_wall=106, gb_free=9.6, wall=10599
2024-11-06 06:29:00 - progress_bar.py[line:274] - INFO: epoch 003:    294 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.35, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=484.2, ups=0.09, wpb=5118, bsz=1280, num_updates=920, lr=4.53696e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=106, gb_free=9.6, wall=10705
2024-11-06 06:30:44 - progress_bar.py[line:274] - INFO: epoch 003:    304 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=5119, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=495.4, ups=0.1, wpb=5119, bsz=1280, num_updates=930, lr=4.52846e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=103, gb_free=9.7, wall=10808
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 4 seek offset 278202024-11-06 06:32:10 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 5 seek offset 34775
slice_id 0 seek offset 0
slice_id 7 seek offset 48685
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 1 seek offset 6955
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 06:39:36 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 0.006 | loss_v1 0 | loss_v2 0 | nll_loss 3.356 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.24 | score 0.437 | wps 500.4 | wpb 639.3 | bsz 159.9 | num_updates 939 | best_score 0.437
2024-11-06 06:39:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 939 updates
2024-11-06 06:39:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-06 06:40:37 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 06:41:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 3 @ 939 updates, score 0.437) (writing took 134.867191901998 seconds)
2024-11-06 06:41:52 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 939 updates
2024-11-06 06:41:52 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 06:43:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 06:43:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 3 @ 939 updates, score 0) (writing took 86.71500630499213 seconds)
2024-11-06 06:43:18 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-06 06:43:18 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.445 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.89 | wps 409.4 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 939 | lr 4.52082e-05 | gnorm 0.015 | clip 0 | loss_scale 256 | train_wall 2879 | gb_free 9.7 | wall 11562
2024-11-06 06:43:18 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 06:43:21 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-06 06:43:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 06:43:34 - progress_bar.py[line:274] - INFO: epoch 004:      1 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=4862.7, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=63.1, ups=0.01, wpb=4862.7, bsz=1216, num_updates=940, lr=4.51997e-05, gnorm=0.021, clip=0, loss_scale=256, train_wall=89, gb_free=9.7, wall=11578
2024-11-06 06:45:14 - progress_bar.py[line:274] - INFO: epoch 004:     11 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=511, ups=0.1, wpb=5117.7, bsz=1280, num_updates=950, lr=4.51147e-05, gnorm=0.014, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11679
2024-11-06 06:46:54 - progress_bar.py[line:274] - INFO: epoch 004:     21 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=512.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=960, lr=4.50297e-05, gnorm=0.015, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11778
2024-11-06 06:48:35 - progress_bar.py[line:274] - INFO: epoch 004:     31 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=510.1, ups=0.1, wpb=5118, bsz=1280, num_updates=970, lr=4.49448e-05, gnorm=0.021, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11879
2024-11-06 06:50:16 - progress_bar.py[line:274] - INFO: epoch 004:     41 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=507, ups=0.1, wpb=5118.2, bsz=1280, num_updates=980, lr=4.48598e-05, gnorm=0.018, clip=0, loss_scale=256, train_wall=36, gb_free=9.7, wall=11980
2024-11-06 06:51:58 - progress_bar.py[line:274] - INFO: epoch 004:     51 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=501.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=990, lr=4.47749e-05, gnorm=0.017, clip=0, loss_scale=256, train_wall=53, gb_free=9.7, wall=12082
slice_id 7 seek offset 48685slice_id 6 seek offset 41730

slice_id 2 seek offset 13910
2024-11-06 06:53:41 - progress_bar.py[line:274] - INFO: epoch 004:     61 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=497.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1000, lr=4.46899e-05, gnorm=0.011, clip=0, loss_scale=256, train_wall=77, gb_free=9.6, wall=12185
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775slice_id 3 seek offset 20865

slice_id 1 seek offset 6955
2024-11-06 06:53:41 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 4 seek offset 27820
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 07:01:17 - progress_bar.py[line:282] - INFO: epoch 004 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.381 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.42 | score 0.4494 | wps 489.3 | wpb 639.3 | bsz 159.9 | num_updates 1000 | best_score 0.4494
2024-11-06 07:01:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1000 updates
2024-11-06 07:01:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_4_1000.pt
2024-11-06 07:01:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_4_1000.pt
2024-11-06 07:04:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_4_1000.pt (epoch 4 @ 1000 updates, score 0.4494) (writing took 175.94559099500475 seconds)
2024-11-06 07:05:44 - progress_bar.py[line:274] - INFO: epoch 004:     71 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=70.7, ups=0.01, wpb=5117.7, bsz=1280, num_updates=1010, lr=4.46049e-05, gnorm=0.019, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=12908
2024-11-06 07:07:26 - progress_bar.py[line:274] - INFO: epoch 004:     81 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=505.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1020, lr=4.452e-05, gnorm=0.013, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=13010
2024-11-06 07:09:05 - progress_bar.py[line:274] - INFO: epoch 004:     91 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=512.7, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1030, lr=4.4435e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=13110
2024-11-06 07:10:48 - progress_bar.py[line:274] - INFO: epoch 004:    101 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=498.3, ups=0.1, wpb=5117.5, bsz=1280, num_updates=1040, lr=4.435e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=52, gb_free=9.7, wall=13212
2024-11-06 07:12:30 - progress_bar.py[line:274] - INFO: epoch 004:    111 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=500.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1050, lr=4.42651e-05, gnorm=0.016, clip=0, loss_scale=512, train_wall=77, gb_free=9.7, wall=13315
2024-11-06 07:14:15 - progress_bar.py[line:274] - INFO: epoch 004:    121 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=489.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1060, lr=4.41801e-05, gnorm=0.016, clip=0, loss_scale=512, train_wall=99, gb_free=9.7, wall=13419
2024-11-06 07:15:58 - progress_bar.py[line:274] - INFO: epoch 004:    131 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=494.3, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1070, lr=4.40952e-05, gnorm=0.017, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=13523
2024-11-06 07:17:42 - progress_bar.py[line:274] - INFO: epoch 004:    141 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=492.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1080, lr=4.40102e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=13627
2024-11-06 07:19:26 - progress_bar.py[line:274] - INFO: epoch 004:    151 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=492.7, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1090, lr=4.39252e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=13730
2024-11-06 07:21:08 - progress_bar.py[line:274] - INFO: epoch 004:    161 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=501.5, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1100, lr=4.38403e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=102, gb_free=9.7, wall=13832
2024-11-06 07:22:51 - progress_bar.py[line:274] - INFO: epoch 004:    171 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.41, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=497, ups=0.1, wpb=5117.7, bsz=1280, num_updates=1110, lr=4.37553e-05, gnorm=0.017, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=13935
2024-11-06 07:24:35 - progress_bar.py[line:274] - INFO: epoch 004:    181 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.405, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=494.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1120, lr=4.36703e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=14039
2024-11-06 07:26:18 - progress_bar.py[line:274] - INFO: epoch 004:    191 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.63, wps=494.1, ups=0.1, wpb=5118.7, bsz=1280, num_updates=1130, lr=4.35854e-05, gnorm=0.016, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=14143
2024-11-06 07:28:02 - progress_bar.py[line:274] - INFO: epoch 004:    201 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=495.2, ups=0.1, wpb=5118.8, bsz=1280, num_updates=1140, lr=4.35004e-05, gnorm=0.014, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=14246
2024-11-06 07:29:46 - progress_bar.py[line:274] - INFO: epoch 004:    211 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.453, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=490.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1150, lr=4.34155e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=14350
2024-11-06 07:31:31 - progress_bar.py[line:274] - INFO: epoch 004:    221 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.452, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=486.3, ups=0.1, wpb=5117.7, bsz=1280, num_updates=1160, lr=4.33305e-05, gnorm=0.014, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=14456
2024-11-06 07:33:16 - progress_bar.py[line:274] - INFO: epoch 004:    231 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=488.9, ups=0.1, wpb=5118, bsz=1280, num_updates=1170, lr=4.32455e-05, gnorm=0.017, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=14560
2024-11-06 07:35:01 - progress_bar.py[line:274] - INFO: epoch 004:    241 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.46, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.01, wps=485.7, ups=0.09, wpb=5118.3, bsz=1280, num_updates=1180, lr=4.31606e-05, gnorm=0.016, clip=0, loss_scale=512, train_wall=105, gb_free=9.6, wall=14666
2024-11-06 07:36:45 - progress_bar.py[line:274] - INFO: epoch 004:    251 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.449, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.92, wps=494.3, ups=0.1, wpb=5119.2, bsz=1280, num_updates=1190, lr=4.30756e-05, gnorm=0.02, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=14769
2024-11-06 07:38:29 - progress_bar.py[line:274] - INFO: epoch 004:    261 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.433, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.8, wps=489.7, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1200, lr=4.29907e-05, gnorm=0.019, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=14874
2024-11-06 07:40:15 - progress_bar.py[line:274] - INFO: epoch 004:    271 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.436, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=483.8, ups=0.09, wpb=5118.4, bsz=1280, num_updates=1210, lr=4.29057e-05, gnorm=0.014, clip=0, loss_scale=512, train_wall=106, gb_free=9.7, wall=14979
2024-11-06 07:41:59 - progress_bar.py[line:274] - INFO: epoch 004:    281 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.459, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11, wps=492.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1220, lr=4.28207e-05, gnorm=0.014, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=15083
2024-11-06 07:43:42 - progress_bar.py[line:274] - INFO: epoch 004:    291 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.467, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.06, wps=498.8, ups=0.1, wpb=5118, bsz=1280, num_updates=1230, lr=4.27358e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=15186
2024-11-06 07:45:25 - progress_bar.py[line:274] - INFO: epoch 004:    301 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.473, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.11, wps=498.6, ups=0.1, wpb=5118.8, bsz=1280, num_updates=1240, lr=4.26508e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=15289
2024-11-06 07:47:09 - progress_bar.py[line:274] - INFO: epoch 004:    311 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.46, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.01, wps=491.1, ups=0.1, wpb=5119.2, bsz=1280, num_updates=1250, lr=4.25658e-05, gnorm=0.018, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=15393
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865slice_id 7 seek offset 48685

slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
2024-11-06 07:47:22 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 7 seek offset 48685
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 07:54:48 - progress_bar.py[line:282] - INFO: epoch 004 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.456 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.98 | score 0.4591 | wps 501 | wpb 639.3 | bsz 159.9 | num_updates 1252 | best_score 0.4591
2024-11-06 07:54:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1252 updates
2024-11-06 07:54:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-06 07:55:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 07:57:03 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 4 @ 1252 updates, score 0.4591) (writing took 134.3409307480033 seconds)
2024-11-06 07:57:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1252 updates
2024-11-06 07:57:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 07:58:30 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 07:58:31 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 4 @ 1252 updates, score 0) (writing took 87.4241596750071 seconds)
2024-11-06 07:58:31 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-06 07:58:31 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.414 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.66 | wps 354.5 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 1252 | lr 4.25489e-05 | gnorm 0.015 | clip 0 | loss_scale 512 | train_wall 2593 | gb_free 9.7 | wall 16075
2024-11-06 07:58:31 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 07:58:33 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-06 07:58:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 07:59:58 - progress_bar.py[line:274] - INFO: epoch 005:      8 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.447, ntokens=4861.7, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.9, wps=63.2, ups=0.01, wpb=4861.7, bsz=1216, num_updates=1260, lr=4.24809e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=41, gb_free=9.7, wall=16162
2024-11-06 08:01:39 - progress_bar.py[line:274] - INFO: epoch 005:     18 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.437, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=504.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=1270, lr=4.23959e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=35, gb_free=9.6, wall=16263
2024-11-06 08:03:22 - progress_bar.py[line:274] - INFO: epoch 005:     28 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.464, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.03, wps=496.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1280, lr=4.2311e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16366
2024-11-06 08:05:05 - progress_bar.py[line:274] - INFO: epoch 005:     38 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.475, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.12, wps=499.5, ups=0.1, wpb=5118, bsz=1280, num_updates=1290, lr=4.2226e-05, gnorm=0.018, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16469
2024-11-06 08:06:45 - progress_bar.py[line:274] - INFO: epoch 005:     48 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.47, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.08, wps=510.4, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1300, lr=4.2141e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16569
2024-11-06 08:08:25 - progress_bar.py[line:274] - INFO: epoch 005:     58 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.496, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.28, wps=510, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1310, lr=4.20561e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=35, gb_free=9.6, wall=16669
2024-11-06 08:10:06 - progress_bar.py[line:274] - INFO: epoch 005:     68 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.44, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=508.9, ups=0.1, wpb=5117.6, bsz=1280, num_updates=1320, lr=4.19711e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16770
2024-11-06 08:11:47 - progress_bar.py[line:274] - INFO: epoch 005:     78 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=503.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1330, lr=4.18862e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=38, gb_free=9.7, wall=16872
2024-11-06 08:13:30 - progress_bar.py[line:274] - INFO: epoch 005:     88 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.427, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.76, wps=498, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1340, lr=4.18012e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=62, gb_free=9.7, wall=16974
2024-11-06 08:15:13 - progress_bar.py[line:274] - INFO: epoch 005:     98 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=496.7, ups=0.1, wpb=5118, bsz=1280, num_updates=1350, lr=4.17162e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=88, gb_free=9.7, wall=17077
2024-11-06 08:16:58 - progress_bar.py[line:274] - INFO: epoch 005:    108 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=487.3, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1360, lr=4.16313e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=17182
2024-11-06 08:18:41 - progress_bar.py[line:274] - INFO: epoch 005:    118 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=498.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1370, lr=4.15463e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=17285
2024-11-06 08:20:23 - progress_bar.py[line:274] - INFO: epoch 005:    128 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=498.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1380, lr=4.14613e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=17388
2024-11-06 08:22:06 - progress_bar.py[line:274] - INFO: epoch 005:    138 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=498.1, ups=0.1, wpb=5118.7, bsz=1280, num_updates=1390, lr=4.13764e-05, gnorm=0.017, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=17490
2024-11-06 08:23:49 - progress_bar.py[line:274] - INFO: epoch 005:    148 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=499.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1400, lr=4.12914e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=102, gb_free=9.7, wall=17593
2024-11-06 08:25:32 - progress_bar.py[line:274] - INFO: epoch 005:    158 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=495.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1410, lr=4.12065e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=103, gb_free=9.6, wall=17696
2024-11-06 08:27:15 - progress_bar.py[line:274] - INFO: epoch 005:    168 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=495.3, ups=0.1, wpb=5118, bsz=1280, num_updates=1420, lr=4.11215e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=17800
2024-11-06 08:28:58 - progress_bar.py[line:274] - INFO: epoch 005:    178 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.405, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=499.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1430, lr=4.10365e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=102, gb_free=9.7, wall=17902
2024-11-06 08:30:41 - progress_bar.py[line:274] - INFO: epoch 005:    188 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=495.8, ups=0.1, wpb=5118.7, bsz=1280, num_updates=1440, lr=4.09516e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18005
2024-11-06 08:32:23 - progress_bar.py[line:274] - INFO: epoch 005:    198 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=500.1, ups=0.1, wpb=5118.9, bsz=1280, num_updates=1450, lr=4.08666e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=102, gb_free=9.6, wall=18108
2024-11-06 08:34:06 - progress_bar.py[line:274] - INFO: epoch 005:    208 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.416, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=499.2, ups=0.1, wpb=5117.6, bsz=1280, num_updates=1460, lr=4.07816e-05, gnorm=0.015, clip=0, loss_scale=512, train_wall=102, gb_free=9.7, wall=18210
2024-11-06 08:35:49 - progress_bar.py[line:274] - INFO: epoch 005:    218 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.413, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.65, wps=497.8, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1470, lr=4.06967e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18313
2024-11-06 08:37:32 - progress_bar.py[line:274] - INFO: epoch 005:    228 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=497.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=1480, lr=4.06117e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=103, gb_free=9.6, wall=18416
2024-11-06 08:39:15 - progress_bar.py[line:274] - INFO: epoch 005:    238 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=496.1, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1490, lr=4.05268e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18519
2024-11-06 08:40:58 - progress_bar.py[line:274] - INFO: epoch 005:    248 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.435, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.82, wps=496.8, ups=0.1, wpb=5119.2, bsz=1280, num_updates=1500, lr=4.04418e-05, gnorm=0.012, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18622
2024-11-06 08:42:41 - progress_bar.py[line:274] - INFO: epoch 005:    258 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=495.3, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1510, lr=4.03568e-05, gnorm=0.01, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18725
2024-11-06 08:44:24 - progress_bar.py[line:274] - INFO: epoch 005:    268 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.435, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.81, wps=497.2, ups=0.1, wpb=5118, bsz=1280, num_updates=1520, lr=4.02719e-05, gnorm=0.011, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18828
2024-11-06 08:46:07 - progress_bar.py[line:274] - INFO: epoch 005:    278 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=496.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1530, lr=4.01869e-05, gnorm=0.013, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18931
2024-11-06 08:47:50 - progress_bar.py[line:274] - INFO: epoch 005:    288 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.44, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.85, wps=499.8, ups=0.1, wpb=5118, bsz=1280, num_updates=1540, lr=4.0102e-05, gnorm=0.016, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=19034
2024-11-06 08:49:32 - progress_bar.py[line:274] - INFO: epoch 005:    298 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.452, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=497.4, ups=0.1, wpb=5118.7, bsz=1280, num_updates=1550, lr=4.0017e-05, gnorm=0.016, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=19137
2024-11-06 08:51:16 - progress_bar.py[line:274] - INFO: epoch 005:    308 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.437, ntokens=5119.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.83, wps=496.7, ups=0.1, wpb=5119.3, bsz=1280, num_updates=1560, lr=3.9932e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.6, wall=19240
slice_id 1 seek offset 6955slice_id 3 seek offset 20865

slice_id 7 seek offset 48685
slice_id 6 seek offset 41730slice_id 2 seek offset 13910

slice_id 4 seek offset 27820slice_id 5 seek offset 34775

2024-11-06 08:52:00 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 08:59:23 - progress_bar.py[line:282] - INFO: epoch 005 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.395 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.52 | score 0.4681 | wps 503.7 | wpb 639.3 | bsz 159.9 | num_updates 1565 | best_score 0.4681
2024-11-06 08:59:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1565 updates
2024-11-06 08:59:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
slice_id 7 seek offset 350000
2024-11-06 09:00:24 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 09:01:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 5 @ 1565 updates, score 0.4681) (writing took 135.0111126289994 seconds)
2024-11-06 09:01:39 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1565 updates
2024-11-06 09:01:39 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 09:03:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 09:03:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 5 @ 1565 updates, score 0) (writing took 86.86029882200819 seconds)
2024-11-06 09:03:06 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-06 09:03:06 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.419 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.69 | wps 412.8 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 1565 | lr 3.98895e-05 | gnorm 0.013 | clip 0 | loss_scale 1024 | train_wall 2629 | gb_free 9.7 | wall 19950
2024-11-06 09:03:06 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 09:03:08 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-06 09:03:08 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 09:04:02 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=63.4, ups=0.01, wpb=4862.2, bsz=1216, num_updates=1570, lr=3.98471e-05, gnorm=0.017, clip=0, loss_scale=1024, train_wall=61, gb_free=9.7, wall=20006
2024-11-06 09:05:43 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=509.2, ups=0.1, wpb=5117.6, bsz=1280, num_updates=1580, lr=3.97621e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=20107
2024-11-06 09:07:22 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=512.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1590, lr=3.96771e-05, gnorm=0.017, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=20207
2024-11-06 09:09:03 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=509.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=1600, lr=3.95922e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=20307
2024-11-06 09:10:46 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=495.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1610, lr=3.95072e-05, gnorm=0.017, clip=0, loss_scale=1024, train_wall=44, gb_free=9.7, wall=20410
2024-11-06 09:12:30 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=495, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1620, lr=3.94223e-05, gnorm=0.014, clip=0, loss_scale=1024, train_wall=87, gb_free=9.6, wall=20514
2024-11-06 09:14:13 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=496.9, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1630, lr=3.93373e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=20617
2024-11-06 09:15:55 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=499.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1640, lr=3.92523e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=20719
2024-11-06 09:17:38 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=497.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1650, lr=3.91674e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=20822
2024-11-06 09:19:22 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.359, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=491.7, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1660, lr=3.90824e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=104, gb_free=9.6, wall=20926
2024-11-06 09:21:05 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=497.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=1670, lr=3.89975e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21029
2024-11-06 09:22:48 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.352, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=498.5, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1680, lr=3.89125e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21132
2024-11-06 09:24:31 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=495.6, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1690, lr=3.88275e-05, gnorm=0.014, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21235
2024-11-06 09:26:14 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=497.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1700, lr=3.87426e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21338
2024-11-06 09:27:57 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=496, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1710, lr=3.86576e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21441
2024-11-06 09:29:40 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=497.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1720, lr=3.85726e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21544
2024-11-06 09:31:23 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=495.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=1730, lr=3.84877e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=21647
2024-11-06 09:33:07 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=495.4, ups=0.1, wpb=5117.8, bsz=1280, num_updates=1740, lr=3.84027e-05, gnorm=0.014, clip=0, loss_scale=1024, train_wall=103, gb_free=9.6, wall=21751
2024-11-06 09:34:50 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.36, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=496.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1750, lr=3.83178e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.6, wall=21854
2024-11-06 09:36:32 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.23, wps=499.2, ups=0.1, wpb=5118.8, bsz=1280, num_updates=1760, lr=3.82328e-05, gnorm=0.014, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=21956
2024-11-06 09:38:15 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=496.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1770, lr=3.81478e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22059
2024-11-06 09:39:58 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.366, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=499.1, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1780, lr=3.80629e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=22162
2024-11-06 09:41:41 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5117.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=497.5, ups=0.1, wpb=5117.4, bsz=1280, num_updates=1790, lr=3.79779e-05, gnorm=0.017, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22265
2024-11-06 09:43:24 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.405, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=496.8, ups=0.1, wpb=5118.5, bsz=1280, num_updates=1800, lr=3.78929e-05, gnorm=0.02, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22368
2024-11-06 09:45:07 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.391, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=495.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1810, lr=3.7808e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22471
2024-11-06 09:46:50 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=498.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1820, lr=3.7723e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22574
2024-11-06 09:48:33 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=496.5, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1830, lr=3.76381e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22677
2024-11-06 09:50:16 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=494.2, ups=0.1, wpb=5118.9, bsz=1280, num_updates=1840, lr=3.75531e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=104, gb_free=9.7, wall=22781
2024-11-06 09:51:59 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=498, ups=0.1, wpb=5118, bsz=1280, num_updates=1850, lr=3.74681e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22883
2024-11-06 09:53:42 - progress_bar.py[line:274] - INFO: epoch 006:    295 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=498, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1860, lr=3.73832e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=22986
2024-11-06 09:55:25 - progress_bar.py[line:274] - INFO: epoch 006:    305 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=495.5, ups=0.1, wpb=5119.2, bsz=1280, num_updates=1870, lr=3.72982e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=23089
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 2 seek offset 13910
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 4 seek offset 27820
2024-11-06 09:56:41 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 10:04:07 - progress_bar.py[line:282] - INFO: epoch 006 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.375 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.37 | score 0.4732 | wps 500.9 | wpb 639.3 | bsz 159.9 | num_updates 1878 | best_score 0.4732
2024-11-06 10:04:07 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 1878 updates
2024-11-06 10:04:07 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-06 10:05:08 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 10:06:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 6 @ 1878 updates, score 0.4732) (writing took 135.3014931600046 seconds)
2024-11-06 10:06:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 1878 updates
2024-11-06 10:06:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 10:07:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 10:07:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 6 @ 1878 updates, score 0) (writing took 86.71544487199571 seconds)
2024-11-06 10:07:49 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-06 10:07:49 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.377 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.39 | wps 411.8 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 1878 | lr 3.72302e-05 | gnorm 0.013 | clip 0 | loss_scale 1024 | train_wall 2901 | gb_free 9.7 | wall 23834
2024-11-06 10:07:49 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 10:07:52 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-06 10:07:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 10:08:15 - progress_bar.py[line:274] - INFO: epoch 007:      2 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=63.1, ups=0.01, wpb=4862.2, bsz=1216, num_updates=1880, lr=3.72133e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=82, gb_free=9.7, wall=23859
2024-11-06 10:09:56 - progress_bar.py[line:274] - INFO: epoch 007:     12 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=510, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1890, lr=3.71283e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=23960
2024-11-06 10:11:36 - progress_bar.py[line:274] - INFO: epoch 007:     22 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=509.1, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1900, lr=3.70433e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24060
2024-11-06 10:13:17 - progress_bar.py[line:274] - INFO: epoch 007:     32 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.357, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=507.1, ups=0.1, wpb=5117.9, bsz=1280, num_updates=1910, lr=3.69584e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24161
2024-11-06 10:14:58 - progress_bar.py[line:274] - INFO: epoch 007:     42 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=505.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1920, lr=3.68734e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=37, gb_free=9.7, wall=24263
2024-11-06 10:16:42 - progress_bar.py[line:274] - INFO: epoch 007:     52 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=494.4, ups=0.1, wpb=5118, bsz=1280, num_updates=1930, lr=3.67884e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=69, gb_free=9.7, wall=24366
2024-11-06 10:18:26 - progress_bar.py[line:274] - INFO: epoch 007:     62 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=493.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=1940, lr=3.67035e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=95, gb_free=9.7, wall=24470
2024-11-06 10:20:08 - progress_bar.py[line:274] - INFO: epoch 007:     72 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=498.7, ups=0.1, wpb=5117.7, bsz=1280, num_updates=1950, lr=3.66185e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.6, wall=24572
2024-11-06 10:21:51 - progress_bar.py[line:274] - INFO: epoch 007:     82 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=498.2, ups=0.1, wpb=5118.2, bsz=1280, num_updates=1960, lr=3.65336e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=24675
2024-11-06 10:23:34 - progress_bar.py[line:274] - INFO: epoch 007:     92 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=495.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=1970, lr=3.64486e-05, gnorm=0.016, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=24778
2024-11-06 10:25:18 - progress_bar.py[line:274] - INFO: epoch 007:    102 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=493.6, ups=0.1, wpb=5117.7, bsz=1280, num_updates=1980, lr=3.63636e-05, gnorm=0.013, clip=0, loss_scale=1024, train_wall=104, gb_free=9.7, wall=24882
2024-11-06 10:27:03 - progress_bar.py[line:274] - INFO: epoch 007:    112 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=488, ups=0.1, wpb=5118.6, bsz=1280, num_updates=1990, lr=3.62787e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=105, gb_free=9.7, wall=24987
2024-11-06 10:28:46 - progress_bar.py[line:274] - INFO: epoch 007:    122 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=496.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2000, lr=3.61937e-05, gnorm=0.012, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=25090
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 5 seek offset 34775
slice_id 4 seek offset 27820
2024-11-06 10:28:46 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 7 seek offset 48685
slice_id 0 seek offset 0
2024-11-06 10:36:24 - progress_bar.py[line:282] - INFO: epoch 007 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.406 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.6 | score 0.4759 | wps 487.4 | wpb 639.3 | bsz 159.9 | num_updates 2000 | best_score 0.4759
2024-11-06 10:36:24 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2000 updates
2024-11-06 10:36:24 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_7_2000.pt
2024-11-06 10:36:34 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_7_2000.pt
2024-11-06 10:39:17 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_7_2000.pt (epoch 7 @ 2000 updates, score 0.4759) (writing took 173.15536797200912 seconds)
2024-11-06 10:40:48 - progress_bar.py[line:274] - INFO: epoch 007:    132 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=70.8, ups=0.01, wpb=5118.6, bsz=1280, num_updates=2010, lr=3.61088e-05, gnorm=0.009, clip=0, loss_scale=1024, train_wall=35, gb_free=9.6, wall=25813
2024-11-06 10:42:29 - progress_bar.py[line:274] - INFO: epoch 007:    142 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=511.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2020, lr=3.60238e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=25913
2024-11-06 10:44:10 - progress_bar.py[line:274] - INFO: epoch 007:    152 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=505.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2030, lr=3.59388e-05, gnorm=0.011, clip=0, loss_scale=1024, train_wall=36, gb_free=9.7, wall=26014
2024-11-06 10:45:53 - progress_bar.py[line:274] - INFO: epoch 007:    162 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=498.2, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2040, lr=3.58539e-05, gnorm=0.01, clip=0, loss_scale=1024, train_wall=57, gb_free=9.7, wall=26117
2024-11-06 10:47:36 - progress_bar.py[line:274] - INFO: epoch 007:    172 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.364, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=493, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2050, lr=3.57689e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=86, gb_free=9.7, wall=26221
2024-11-06 10:49:19 - progress_bar.py[line:274] - INFO: epoch 007:    182 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=498.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2060, lr=3.56839e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=26323
2024-11-06 10:51:02 - progress_bar.py[line:274] - INFO: epoch 007:    192 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=495.9, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2070, lr=3.5599e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=26427
2024-11-06 10:52:46 - progress_bar.py[line:274] - INFO: epoch 007:    202 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=492.6, ups=0.1, wpb=5118.8, bsz=1280, num_updates=2080, lr=3.5514e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=26530
2024-11-06 10:54:29 - progress_bar.py[line:274] - INFO: epoch 007:    212 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=498.1, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2090, lr=3.54291e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=26633
2024-11-06 10:56:13 - progress_bar.py[line:274] - INFO: epoch 007:    222 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=493.3, ups=0.1, wpb=5117.6, bsz=1280, num_updates=2100, lr=3.53441e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=26737
2024-11-06 10:57:57 - progress_bar.py[line:274] - INFO: epoch 007:    232 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.35, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=493.1, ups=0.1, wpb=5118, bsz=1280, num_updates=2110, lr=3.52591e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=26841
2024-11-06 10:59:40 - progress_bar.py[line:274] - INFO: epoch 007:    242 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.359, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=496.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2120, lr=3.51742e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=26944
2024-11-06 11:01:23 - progress_bar.py[line:274] - INFO: epoch 007:    252 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=495.1, ups=0.1, wpb=5118.9, bsz=1280, num_updates=2130, lr=3.50892e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=27047
2024-11-06 11:03:06 - progress_bar.py[line:274] - INFO: epoch 007:    262 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=497.8, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2140, lr=3.50042e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=27150
2024-11-06 11:04:49 - progress_bar.py[line:274] - INFO: epoch 007:    272 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=495.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2150, lr=3.49193e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=27253
2024-11-06 11:06:32 - progress_bar.py[line:274] - INFO: epoch 007:    282 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=495.8, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2160, lr=3.48343e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=27357
2024-11-06 11:08:16 - progress_bar.py[line:274] - INFO: epoch 007:    292 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=493.1, ups=0.1, wpb=5118, bsz=1280, num_updates=2170, lr=3.47494e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=104, gb_free=9.6, wall=27460
2024-11-06 11:10:00 - progress_bar.py[line:274] - INFO: epoch 007:    302 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.355, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.23, wps=491.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2180, lr=3.46644e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=27565
2024-11-06 11:11:44 - progress_bar.py[line:274] - INFO: epoch 007:    312 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.3, wps=491.5, ups=0.1, wpb=5119.2, bsz=1280, num_updates=2190, lr=3.45794e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=27669
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 4 seek offset 27820slice_id 7 seek offset 48685
2024-11-06 11:11:48 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 5 seek offset 34775

slice_id 2 seek offset 13910slice_id 0 seek offset 0

slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 11:19:13 - progress_bar.py[line:282] - INFO: epoch 007 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.358 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.26 | score 0.4787 | wps 501.2 | wpb 639.3 | bsz 159.9 | num_updates 2191 | best_score 0.4787
2024-11-06 11:19:13 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2191 updates
2024-11-06 11:19:13 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 11:20:14 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 11:21:32 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 7 @ 2191 updates, score 0.4787) (writing took 138.74009567500616 seconds)
2024-11-06 11:21:33 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2191 updates
2024-11-06 11:21:33 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 11:22:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 11:22:59 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 7 @ 2191 updates, score 0) (writing took 86.02100300700113 seconds)
2024-11-06 11:22:59 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-06 11:22:59 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.37 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.34 | wps 354.7 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 2191 | lr 3.45709e-05 | gnorm 0.011 | clip 0 | loss_scale 2048 | train_wall 2631 | gb_free 9.7 | wall 28343
2024-11-06 11:22:59 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 11:23:02 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-06 11:23:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 11:24:35 - progress_bar.py[line:274] - INFO: epoch 008:      9 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=4861.3, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=63.1, ups=0.01, wpb=4861.3, bsz=1216, num_updates=2200, lr=3.44945e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=28439
2024-11-06 11:26:15 - progress_bar.py[line:274] - INFO: epoch 008:     19 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=511.6, ups=0.1, wpb=5118.6, bsz=1280, num_updates=2210, lr=3.44095e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=28540
2024-11-06 11:27:56 - progress_bar.py[line:274] - INFO: epoch 008:     29 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.325, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=508.8, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2220, lr=3.43246e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=28640
2024-11-06 11:29:37 - progress_bar.py[line:274] - INFO: epoch 008:     39 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=507.3, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2230, lr=3.42396e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=28741
2024-11-06 11:31:19 - progress_bar.py[line:274] - INFO: epoch 008:     49 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.362, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=501, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2240, lr=3.41546e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=41, gb_free=9.7, wall=28843
2024-11-06 11:33:02 - progress_bar.py[line:274] - INFO: epoch 008:     59 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=498, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2250, lr=3.40697e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=64, gb_free=9.7, wall=28946
2024-11-06 11:34:45 - progress_bar.py[line:274] - INFO: epoch 008:     69 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=497.1, ups=0.1, wpb=5117.7, bsz=1280, num_updates=2260, lr=3.39847e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=87, gb_free=9.6, wall=29049
2024-11-06 11:36:28 - progress_bar.py[line:274] - INFO: epoch 008:     79 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=497.3, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2270, lr=3.38997e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=29152
2024-11-06 11:38:10 - progress_bar.py[line:274] - INFO: epoch 008:     89 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=499.1, ups=0.1, wpb=5118, bsz=1280, num_updates=2280, lr=3.38148e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=29254
2024-11-06 11:39:53 - progress_bar.py[line:274] - INFO: epoch 008:     99 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=498, ups=0.1, wpb=5118, bsz=1280, num_updates=2290, lr=3.37298e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=29357
2024-11-06 11:41:36 - progress_bar.py[line:274] - INFO: epoch 008:    109 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.327, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=498.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=2300, lr=3.36449e-05, gnorm=0.016, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=29460
2024-11-06 11:43:19 - progress_bar.py[line:274] - INFO: epoch 008:    119 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=495.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2310, lr=3.35599e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=29563
2024-11-06 11:45:02 - progress_bar.py[line:274] - INFO: epoch 008:    129 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.345, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=494.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2320, lr=3.34749e-05, gnorm=0.014, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=29667
2024-11-06 11:46:45 - progress_bar.py[line:274] - INFO: epoch 008:    139 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=499.3, ups=0.1, wpb=5118.8, bsz=1280, num_updates=2330, lr=3.339e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=29769
2024-11-06 11:48:28 - progress_bar.py[line:274] - INFO: epoch 008:    149 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.328, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=496.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2340, lr=3.3305e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=29872
2024-11-06 11:50:11 - progress_bar.py[line:274] - INFO: epoch 008:    159 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.301, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=498.9, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2350, lr=3.32201e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=29975
2024-11-06 11:51:54 - progress_bar.py[line:274] - INFO: epoch 008:    169 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=496.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2360, lr=3.31351e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30078
2024-11-06 11:53:37 - progress_bar.py[line:274] - INFO: epoch 008:    179 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.33, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=496.4, ups=0.1, wpb=5118, bsz=1280, num_updates=2370, lr=3.30501e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30181
2024-11-06 11:55:20 - progress_bar.py[line:274] - INFO: epoch 008:    189 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=497.3, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2380, lr=3.29652e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=30284
2024-11-06 11:57:02 - progress_bar.py[line:274] - INFO: epoch 008:    199 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.03, wps=498.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=2390, lr=3.28802e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30387
2024-11-06 11:58:45 - progress_bar.py[line:274] - INFO: epoch 008:    209 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.314, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.95, wps=497.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2400, lr=3.27952e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30490
2024-11-06 12:00:28 - progress_bar.py[line:274] - INFO: epoch 008:    219 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=496.1, ups=0.1, wpb=5118, bsz=1280, num_updates=2410, lr=3.27103e-05, gnorm=0.015, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30593
2024-11-06 12:02:11 - progress_bar.py[line:274] - INFO: epoch 008:    229 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.326, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=499.8, ups=0.1, wpb=5118, bsz=1280, num_updates=2420, lr=3.26253e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30695
2024-11-06 12:03:54 - progress_bar.py[line:274] - INFO: epoch 008:    239 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.305, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.88, wps=494.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2430, lr=3.25404e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30799
2024-11-06 12:05:38 - progress_bar.py[line:274] - INFO: epoch 008:    249 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.296, ntokens=5119.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.82, wps=494.7, ups=0.1, wpb=5119.3, bsz=1280, num_updates=2440, lr=3.24554e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30902
2024-11-06 12:07:20 - progress_bar.py[line:274] - INFO: epoch 008:    259 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.322, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=500.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2450, lr=3.23704e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=31004
2024-11-06 12:09:03 - progress_bar.py[line:274] - INFO: epoch 008:    269 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=497.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2460, lr=3.22855e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=31107
2024-11-06 12:10:47 - progress_bar.py[line:274] - INFO: epoch 008:    279 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.359, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=491.9, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2470, lr=3.22005e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=31211
2024-11-06 12:12:30 - progress_bar.py[line:274] - INFO: epoch 008:    289 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=497.6, ups=0.1, wpb=5118, bsz=1280, num_updates=2480, lr=3.21155e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=31314
2024-11-06 12:14:12 - progress_bar.py[line:274] - INFO: epoch 008:    299 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=499, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2490, lr=3.20306e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=102, gb_free=9.8, wall=31417
2024-11-06 12:15:56 - progress_bar.py[line:274] - INFO: epoch 008:    309 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=494.2, ups=0.1, wpb=5119.4, bsz=1280, num_updates=2500, lr=3.19456e-05, gnorm=0.017, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=31520
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
2024-11-06 12:16:30 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 12:23:53 - progress_bar.py[line:282] - INFO: epoch 008 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.352 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.21 | score 0.479 | wps 504 | wpb 639.3 | bsz 159.9 | num_updates 2504 | best_score 0.479
2024-11-06 12:23:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2504 updates
2024-11-06 12:23:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappingfile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 6 seek offset 300000
2024-11-06 12:24:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 12:26:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 8 @ 2504 updates, score 0.479) (writing took 173.91414367899415 seconds)
2024-11-06 12:26:47 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2504 updates
2024-11-06 12:26:47 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 12:27:48 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 12:27:49 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 8 @ 2504 updates, score 0) (writing took 61.253490589006105 seconds)
2024-11-06 12:27:49 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-06 12:27:49 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.337 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.11 | wps 411.2 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 2504 | lr 3.19116e-05 | gnorm 0.012 | clip 0 | loss_scale 2048 | train_wall 2830 | gb_free 9.7 | wall 32233
2024-11-06 12:27:49 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 12:27:51 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-06 12:27:51 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 12:28:55 - progress_bar.py[line:274] - INFO: epoch 009:      6 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.348, ntokens=4862.1, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=62.4, ups=0.01, wpb=4862.1, bsz=1216, num_updates=2510, lr=3.18607e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=55, gb_free=9.7, wall=32299
2024-11-06 12:30:36 - progress_bar.py[line:274] - INFO: epoch 009:     16 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=507.5, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2520, lr=3.17757e-05, gnorm=0.01, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=32400
2024-11-06 12:32:16 - progress_bar.py[line:274] - INFO: epoch 009:     26 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=511.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2530, lr=3.16907e-05, gnorm=0.011, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=32500
2024-11-06 12:33:57 - progress_bar.py[line:274] - INFO: epoch 009:     36 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.328, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=505.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2540, lr=3.16058e-05, gnorm=0.012, clip=0, loss_scale=2048, train_wall=36, gb_free=9.7, wall=32601
2024-11-06 12:35:40 - progress_bar.py[line:274] - INFO: epoch 009:     46 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.349, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.19, wps=495.5, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2550, lr=3.15208e-05, gnorm=0.013, clip=0, loss_scale=2048, train_wall=61, gb_free=9.6, wall=32705
2024-11-06 12:37:24 - progress_bar.py[line:274] - INFO: epoch 009:     56 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=496.1, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2560, lr=3.14359e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=90, gb_free=9.7, wall=32808
2024-11-06 12:39:06 - progress_bar.py[line:274] - INFO: epoch 009:     66 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=499, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2570, lr=3.13509e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=32910
2024-11-06 12:40:49 - progress_bar.py[line:274] - INFO: epoch 009:     76 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=497.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2580, lr=3.12659e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=33013
2024-11-06 12:42:34 - progress_bar.py[line:274] - INFO: epoch 009:     86 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=487.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2590, lr=3.1181e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=33118
2024-11-06 12:44:17 - progress_bar.py[line:274] - INFO: epoch 009:     96 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.318, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=495, ups=0.1, wpb=5117.7, bsz=1280, num_updates=2600, lr=3.1096e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33222
2024-11-06 12:46:01 - progress_bar.py[line:274] - INFO: epoch 009:    106 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=492.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2610, lr=3.1011e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=104, gb_free=9.6, wall=33326
2024-11-06 12:47:44 - progress_bar.py[line:274] - INFO: epoch 009:    116 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=497.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2620, lr=3.09261e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33428
2024-11-06 12:49:28 - progress_bar.py[line:274] - INFO: epoch 009:    126 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=495, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2630, lr=3.08411e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33532
2024-11-06 12:51:11 - progress_bar.py[line:274] - INFO: epoch 009:    136 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=497.1, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2640, lr=3.07562e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33635
2024-11-06 12:52:54 - progress_bar.py[line:274] - INFO: epoch 009:    146 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.337, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=493.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2650, lr=3.06712e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=33739
2024-11-06 12:54:37 - progress_bar.py[line:274] - INFO: epoch 009:    156 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.337, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=497.1, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2660, lr=3.05862e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33841
2024-11-06 12:56:21 - progress_bar.py[line:274] - INFO: epoch 009:    166 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=495.1, ups=0.1, wpb=5118.4, bsz=1280, num_updates=2670, lr=3.05013e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=33945
2024-11-06 12:58:04 - progress_bar.py[line:274] - INFO: epoch 009:    176 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.352, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=495.3, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2680, lr=3.04163e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=34048
2024-11-06 12:59:48 - progress_bar.py[line:274] - INFO: epoch 009:    186 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=489.7, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2690, lr=3.03314e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=34153
2024-11-06 13:01:32 - progress_bar.py[line:274] - INFO: epoch 009:    196 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=5119, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=494, ups=0.1, wpb=5119, bsz=1280, num_updates=2700, lr=3.02464e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=34256
2024-11-06 13:03:15 - progress_bar.py[line:274] - INFO: epoch 009:    206 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=496.2, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2710, lr=3.01614e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=34359
2024-11-06 13:05:00 - progress_bar.py[line:274] - INFO: epoch 009:    216 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=487, ups=0.1, wpb=5118, bsz=1280, num_updates=2720, lr=3.00765e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=34465
2024-11-06 13:06:45 - progress_bar.py[line:274] - INFO: epoch 009:    226 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=488.4, ups=0.1, wpb=5117.7, bsz=1280, num_updates=2730, lr=2.99915e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=34569
2024-11-06 13:08:31 - progress_bar.py[line:274] - INFO: epoch 009:    236 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.357, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=485.5, ups=0.09, wpb=5118.1, bsz=1280, num_updates=2740, lr=2.99065e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=105, gb_free=9.6, wall=34675
2024-11-06 13:10:16 - progress_bar.py[line:274] - INFO: epoch 009:    246 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5119.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=487.1, ups=0.1, wpb=5119.1, bsz=1280, num_updates=2750, lr=2.98216e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.6, wall=34780
2024-11-06 13:12:00 - progress_bar.py[line:274] - INFO: epoch 009:    256 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=492, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2760, lr=2.97366e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=34884
2024-11-06 13:13:43 - progress_bar.py[line:274] - INFO: epoch 009:    266 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.337, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=494.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2770, lr=2.96517e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=34987
2024-11-06 13:15:27 - progress_bar.py[line:274] - INFO: epoch 009:    276 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.341, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=495.3, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2780, lr=2.95667e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=35091
2024-11-06 13:17:09 - progress_bar.py[line:274] - INFO: epoch 009:    286 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=497.9, ups=0.1, wpb=5118, bsz=1280, num_updates=2790, lr=2.94817e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=35194
2024-11-06 13:18:52 - progress_bar.py[line:274] - INFO: epoch 009:    296 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.353, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=497.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=2800, lr=2.93968e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=35297
2024-11-06 13:20:36 - progress_bar.py[line:274] - INFO: epoch 009:    306 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=495.6, ups=0.1, wpb=5119.2, bsz=1280, num_updates=2810, lr=2.93118e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=35400
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
2024-11-06 13:21:40 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 6 seek offset 41730slice_id 5 seek offset 34775

slice_id 2 seek offset 13910
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 13:29:03 - progress_bar.py[line:282] - INFO: epoch 009 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.356 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.24 | score 0.4854 | wps 504.2 | wpb 639.3 | bsz 159.9 | num_updates 2817 | best_score 0.4854
2024-11-06 13:29:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 2817 updates
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
2024-11-06 13:29:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 13:30:04 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 13:31:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 9 @ 2817 updates, score 0.4854) (writing took 135.39823363299365 seconds)
2024-11-06 13:31:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 2817 updates
2024-11-06 13:31:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 13:32:46 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 13:32:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 9 @ 2817 updates, score 0) (writing took 87.16755091599771 seconds)
2024-11-06 13:32:47 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-06 13:32:47 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.34 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.13 | wps 410.3 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 2817 | lr 2.92523e-05 | gnorm 0.01 | clip 0 | loss_scale 4096 | train_wall 2932 | gb_free 9.7 | wall 36131
2024-11-06 13:32:47 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 13:32:49 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-06 13:32:49 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 13:33:22 - progress_bar.py[line:274] - INFO: epoch 010:      3 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.345, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=63.4, ups=0.01, wpb=4862.2, bsz=1216, num_updates=2820, lr=2.92268e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=75, gb_free=9.7, wall=36167
2024-11-06 13:35:03 - progress_bar.py[line:274] - INFO: epoch 010:     13 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.325, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=508.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2830, lr=2.91419e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=36267
2024-11-06 13:36:44 - progress_bar.py[line:274] - INFO: epoch 010:     23 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=509.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=2840, lr=2.90569e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=36368
2024-11-06 13:38:25 - progress_bar.py[line:274] - INFO: epoch 010:     33 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=506.6, ups=0.1, wpb=5117.7, bsz=1280, num_updates=2850, lr=2.8972e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=36469
2024-11-06 13:40:05 - progress_bar.py[line:274] - INFO: epoch 010:     43 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.344, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.16, wps=508.6, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2860, lr=2.8887e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=36, gb_free=9.7, wall=36569
2024-11-06 13:41:49 - progress_bar.py[line:274] - INFO: epoch 010:     53 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=491.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2870, lr=2.8802e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=59, gb_free=9.6, wall=36673
2024-11-06 13:43:32 - progress_bar.py[line:274] - INFO: epoch 010:     63 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=496.1, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2880, lr=2.87171e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=95, gb_free=9.7, wall=36777
2024-11-06 13:45:17 - progress_bar.py[line:274] - INFO: epoch 010:     73 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.323, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.01, wps=487.4, ups=0.1, wpb=5117.7, bsz=1280, num_updates=2890, lr=2.86321e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=36882
2024-11-06 13:47:00 - progress_bar.py[line:274] - INFO: epoch 010:     83 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=498.6, ups=0.1, wpb=5118.3, bsz=1280, num_updates=2900, lr=2.85472e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=36984
2024-11-06 13:48:45 - progress_bar.py[line:274] - INFO: epoch 010:     93 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=487.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2910, lr=2.84622e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=37089
2024-11-06 13:50:29 - progress_bar.py[line:274] - INFO: epoch 010:    103 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.306, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.89, wps=493.7, ups=0.1, wpb=5117.8, bsz=1280, num_updates=2920, lr=2.83772e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=37193
2024-11-06 13:52:12 - progress_bar.py[line:274] - INFO: epoch 010:    113 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.333, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=496.8, ups=0.1, wpb=5118.8, bsz=1280, num_updates=2930, lr=2.82923e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=37296
2024-11-06 13:53:55 - progress_bar.py[line:274] - INFO: epoch 010:    123 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=496.2, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2940, lr=2.82073e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=37399
2024-11-06 13:55:40 - progress_bar.py[line:274] - INFO: epoch 010:    133 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=487.7, ups=0.1, wpb=5118.8, bsz=1280, num_updates=2950, lr=2.81223e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=105, gb_free=9.8, wall=37504
2024-11-06 13:57:24 - progress_bar.py[line:274] - INFO: epoch 010:    143 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.317, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=491.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=2960, lr=2.80374e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=37608
2024-11-06 13:59:08 - progress_bar.py[line:274] - INFO: epoch 010:    153 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.322, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=491.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=2970, lr=2.79524e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=37712
2024-11-06 14:00:53 - progress_bar.py[line:274] - INFO: epoch 010:    163 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.332, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.07, wps=489, ups=0.1, wpb=5117.9, bsz=1280, num_updates=2980, lr=2.78675e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=37817
2024-11-06 14:02:38 - progress_bar.py[line:274] - INFO: epoch 010:    173 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=484.3, ups=0.09, wpb=5118, bsz=1280, num_updates=2990, lr=2.77825e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=106, gb_free=9.7, wall=37923
2024-11-06 14:04:23 - progress_bar.py[line:274] - INFO: epoch 010:    183 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=487.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3000, lr=2.76975e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.6, wall=38028
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730slice_id 5 seek offset 34775

slice_id 2 seek offset 13910
slice_id 7 seek offset 48685
2024-11-06 14:04:23 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 14:11:58 - progress_bar.py[line:282] - INFO: epoch 010 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.341 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.13 | score 0.4874 | wps 490.8 | wpb 639.3 | bsz 159.9 | num_updates 3000 | best_score 0.4874
2024-11-06 14:11:58 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3000 updates
2024-11-06 14:11:58 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_10_3000.pt
2024-11-06 14:12:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_10_3000.pt
2024-11-06 14:14:54 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_10_3000.pt (epoch 10 @ 3000 updates, score 0.4874) (writing took 175.83663827700366 seconds)
2024-11-06 14:16:25 - progress_bar.py[line:274] - INFO: epoch 010:    193 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=5119.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=70.9, ups=0.01, wpb=5119.1, bsz=1280, num_updates=3010, lr=2.76126e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38750
2024-11-06 14:18:06 - progress_bar.py[line:274] - INFO: epoch 010:    203 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=508.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=3020, lr=2.75276e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38850
2024-11-06 14:19:48 - progress_bar.py[line:274] - INFO: epoch 010:    213 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.312, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.93, wps=504.9, ups=0.1, wpb=5118, bsz=1280, num_updates=3030, lr=2.74427e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=36, gb_free=9.6, wall=38952
2024-11-06 14:21:31 - progress_bar.py[line:274] - INFO: epoch 010:    223 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=495.8, ups=0.1, wpb=5117.5, bsz=1280, num_updates=3040, lr=2.73577e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=53, gb_free=9.7, wall=39055
2024-11-06 14:23:15 - progress_bar.py[line:274] - INFO: epoch 010:    233 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.329, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.05, wps=492.1, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3050, lr=2.72727e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=81, gb_free=9.6, wall=39159
2024-11-06 14:24:58 - progress_bar.py[line:274] - INFO: epoch 010:    243 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.302, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.86, wps=493.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3060, lr=2.71878e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=39263
2024-11-06 14:26:41 - progress_bar.py[line:274] - INFO: epoch 010:    253 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.324, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=498.5, ups=0.1, wpb=5118.8, bsz=1280, num_updates=3070, lr=2.71028e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=39365
2024-11-06 14:28:25 - progress_bar.py[line:274] - INFO: epoch 010:    263 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.34, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=493.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3080, lr=2.70178e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=39469
2024-11-06 14:30:09 - progress_bar.py[line:274] - INFO: epoch 010:    273 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=493.2, ups=0.1, wpb=5118.9, bsz=1280, num_updates=3090, lr=2.69329e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=39573
2024-11-06 14:31:52 - progress_bar.py[line:274] - INFO: epoch 010:    283 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.329, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.05, wps=494.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3100, lr=2.68479e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=39676
2024-11-06 14:33:35 - progress_bar.py[line:274] - INFO: epoch 010:    293 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.317, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.97, wps=495.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3110, lr=2.6763e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=39780
2024-11-06 14:35:19 - progress_bar.py[line:274] - INFO: epoch 010:    303 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.325, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.02, wps=493.9, ups=0.1, wpb=5118.8, bsz=1280, num_updates=3120, lr=2.6678e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=104, gb_free=9.6, wall=39883
2024-11-06 14:36:56 - progress_bar.py[line:274] - INFO: epoch 010:    313 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.34, ntokens=4863.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=499.3, ups=0.1, wpb=4863.2, bsz=1216, num_updates=3130, lr=2.6593e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=97, gb_free=9.7, wall=39981
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 5 seek offset 34775
2024-11-06 14:36:56 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 14:44:22 - progress_bar.py[line:282] - INFO: epoch 010 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.348 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.18 | score 0.4873 | wps 501.5 | wpb 639.3 | bsz 159.9 | num_updates 3130 | best_score 0.4874
2024-11-06 14:44:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3130 updates
2024-11-06 14:44:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4870.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
2024-11-06 14:45:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4870.pt
2024-11-06 14:46:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint.best_score_0.4870.pt (epoch 10 @ 3130 updates, score 0.4873) (writing took 117.13575219400809 seconds)
2024-11-06 14:46:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 3130 updates
2024-11-06 14:46:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 14:47:20 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 14:47:20 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 10 @ 3130 updates, score 0) (writing took 61.10277100499661 seconds)
2024-11-06 14:47:20 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-06 14:47:20 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.33 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.06 | wps 357.5 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 3130 | lr 2.6593e-05 | gnorm 0.01 | clip 0 | loss_scale 8192 | train_wall 2615 | gb_free 9.7 | wall 40604
2024-11-06 14:47:20 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 14:47:23 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-06 14:47:23 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 14:49:07 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.337, ntokens=5117.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=70.1, ups=0.01, wpb=5117.3, bsz=1280, num_updates=3140, lr=2.65081e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.5, wall=40711
2024-11-06 14:50:47 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.335, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.09, wps=509, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3150, lr=2.64231e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.6, wall=40811
2024-11-06 14:52:28 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.343, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=508.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3160, lr=2.63381e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=40912
2024-11-06 14:54:08 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=509.6, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3170, lr=2.62532e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=41013
2024-11-06 14:55:51 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.311, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.92, wps=499.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3180, lr=2.61682e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=45, gb_free=9.7, wall=41115
2024-11-06 14:57:13 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4096.0
2024-11-06 14:57:44 - progress_bar.py[line:274] - INFO: epoch 011:     61 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=451, ups=0.09, wpb=5118.4, bsz=1280, num_updates=3190, lr=2.60833e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=80, gb_free=9.6, wall=41228
2024-11-06 14:59:27 - progress_bar.py[line:274] - INFO: epoch 011:     71 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.336, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.1, wps=497, ups=0.1, wpb=5117.7, bsz=1280, num_updates=3200, lr=2.59983e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=100, gb_free=9.7, wall=41331
2024-11-06 15:01:13 - progress_bar.py[line:274] - INFO: epoch 011:     81 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=484.9, ups=0.09, wpb=5118.3, bsz=1280, num_updates=3210, lr=2.59133e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=41437
2024-11-06 15:02:56 - progress_bar.py[line:274] - INFO: epoch 011:     91 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.339, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.12, wps=494.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3220, lr=2.58284e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=41540
2024-11-06 15:04:39 - progress_bar.py[line:274] - INFO: epoch 011:    101 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.34, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=495.9, ups=0.1, wpb=5117.5, bsz=1280, num_updates=3230, lr=2.57434e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=41644
2024-11-06 15:06:23 - progress_bar.py[line:274] - INFO: epoch 011:    111 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=496.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=3240, lr=2.56585e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=41747
2024-11-06 15:08:06 - progress_bar.py[line:274] - INFO: epoch 011:    121 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.322, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10, wps=493.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3250, lr=2.55735e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=41851
2024-11-06 15:09:49 - progress_bar.py[line:274] - INFO: epoch 011:    131 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=500.1, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3260, lr=2.54885e-05, gnorm=0.014, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=41953
2024-11-06 15:11:32 - progress_bar.py[line:274] - INFO: epoch 011:    141 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=494, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3270, lr=2.54036e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=42057
2024-11-06 15:13:15 - progress_bar.py[line:274] - INFO: epoch 011:    151 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=497.7, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3280, lr=2.53186e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=42159
2024-11-06 15:15:01 - progress_bar.py[line:274] - INFO: epoch 011:    161 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=484.2, ups=0.09, wpb=5117.8, bsz=1280, num_updates=3290, lr=2.52336e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=106, gb_free=9.7, wall=42265
2024-11-06 15:16:46 - progress_bar.py[line:274] - INFO: epoch 011:    171 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=488.8, ups=0.1, wpb=5117.7, bsz=1280, num_updates=3300, lr=2.51487e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=42370
2024-11-06 15:18:30 - progress_bar.py[line:274] - INFO: epoch 011:    181 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=490.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3310, lr=2.50637e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=42474
2024-11-06 15:20:13 - progress_bar.py[line:274] - INFO: epoch 011:    191 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=494.8, ups=0.1, wpb=5118.7, bsz=1280, num_updates=3320, lr=2.49788e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=42578
2024-11-06 15:21:57 - progress_bar.py[line:274] - INFO: epoch 011:    201 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=494.9, ups=0.1, wpb=5118.8, bsz=1280, num_updates=3330, lr=2.48938e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=42681
2024-11-06 15:23:39 - progress_bar.py[line:274] - INFO: epoch 011:    211 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=500.1, ups=0.1, wpb=5117.8, bsz=1280, num_updates=3340, lr=2.48088e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=42783
2024-11-06 15:25:22 - progress_bar.py[line:274] - INFO: epoch 011:    221 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=498.3, ups=0.1, wpb=5117.7, bsz=1280, num_updates=3350, lr=2.47239e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=42886
2024-11-06 15:27:05 - progress_bar.py[line:274] - INFO: epoch 011:    231 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=496.9, ups=0.1, wpb=5118, bsz=1280, num_updates=3360, lr=2.46389e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=42989
2024-11-06 15:28:48 - progress_bar.py[line:274] - INFO: epoch 011:    241 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.18, wps=497.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3370, lr=2.4554e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=43092
2024-11-06 15:30:29 - progress_bar.py[line:274] - INFO: epoch 011:    251 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.344, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.15, wps=503.5, ups=0.1, wpb=5119.2, bsz=1280, num_updates=3380, lr=2.4469e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=43194
2024-11-06 15:32:12 - progress_bar.py[line:274] - INFO: epoch 011:    261 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.331, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.06, wps=499.9, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3390, lr=2.4384e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=43296
2024-11-06 15:33:55 - progress_bar.py[line:274] - INFO: epoch 011:    271 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.328, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.04, wps=497.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3400, lr=2.42991e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=43399
2024-11-06 15:35:37 - progress_bar.py[line:274] - INFO: epoch 011:    281 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.342, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.14, wps=498, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3410, lr=2.42141e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=43502
2024-11-06 15:37:20 - progress_bar.py[line:274] - INFO: epoch 011:    291 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.359, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.26, wps=498.1, ups=0.1, wpb=5118, bsz=1280, num_updates=3420, lr=2.41291e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=43604
2024-11-06 15:39:03 - progress_bar.py[line:274] - INFO: epoch 011:    301 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.357, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=495.2, ups=0.1, wpb=5118.8, bsz=1280, num_updates=3430, lr=2.40442e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=43708
2024-11-06 15:40:47 - progress_bar.py[line:274] - INFO: epoch 011:    311 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=496.4, ups=0.1, wpb=5119.2, bsz=1280, num_updates=3440, lr=2.39592e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=43811
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685slice_id 6 seek offset 41730

slice_id 2 seek offset 13910
2024-11-06 15:41:00 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 5 seek offset 34775slice_id 3 seek offset 20865

slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 15:48:21 - progress_bar.py[line:282] - INFO: epoch 011 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.393 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.51 | score 0.4884 | wps 506 | wpb 639.3 | bsz 159.9 | num_updates 3442 | best_score 0.4884
2024-11-06 15:48:21 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 3442 updates
2024-11-06 15:48:21 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappingfile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
2024-11-06 15:49:22 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 15:50:35 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 11 @ 3442 updates, score 0.4884) (writing took 133.55679222699837 seconds)
2024-11-06 15:50:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 3442 updates
2024-11-06 15:50:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 15:52:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 15:52:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 11 @ 3442 updates, score 0) (writing took 84.78257478900196 seconds)
2024-11-06 15:52:00 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-06 15:52:00 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.351 | ntokens 5110.05 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.21 | wps 410.9 | ups 0.08 | wpb 5110.1 | bsz 1277.9 | num_updates 3442 | lr 2.39422e-05 | gnorm 0.01 | clip 0 | loss_scale 4096 | train_wall 2855 | gb_free 9.7 | wall 44485
2024-11-06 15:52:00 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 15:52:03 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-06 15:52:03 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 15:53:26 - progress_bar.py[line:274] - INFO: epoch 012:      8 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=4861.7, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=64, ups=0.01, wpb=4861.7, bsz=1216, num_updates=3450, lr=2.38743e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=41, gb_free=9.7, wall=44570
2024-11-06 15:55:06 - progress_bar.py[line:274] - INFO: epoch 012:     18 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.354, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.22, wps=510.7, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3460, lr=2.37893e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=44670
2024-11-06 15:56:46 - progress_bar.py[line:274] - INFO: epoch 012:     28 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=513.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3470, lr=2.37043e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=44770
2024-11-06 15:58:26 - progress_bar.py[line:274] - INFO: epoch 012:     38 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.36, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=512, ups=0.1, wpb=5118, bsz=1280, num_updates=3480, lr=2.36194e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=44870
2024-11-06 16:00:07 - progress_bar.py[line:274] - INFO: epoch 012:     48 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=504.9, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3490, lr=2.35344e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=42, gb_free=9.7, wall=44971
2024-11-06 16:01:50 - progress_bar.py[line:274] - INFO: epoch 012:     58 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=496.9, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3500, lr=2.34494e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=62, gb_free=9.6, wall=45074
2024-11-06 16:03:33 - progress_bar.py[line:274] - INFO: epoch 012:     68 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=497.2, ups=0.1, wpb=5117.6, bsz=1280, num_updates=3510, lr=2.33645e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=92, gb_free=9.7, wall=45177
2024-11-06 16:05:16 - progress_bar.py[line:274] - INFO: epoch 012:     78 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=498.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3520, lr=2.32795e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=45280
2024-11-06 16:06:58 - progress_bar.py[line:274] - INFO: epoch 012:     88 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=499.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3530, lr=2.31946e-05, gnorm=0.016, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=45382
2024-11-06 16:08:40 - progress_bar.py[line:274] - INFO: epoch 012:     98 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.35, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=501.6, ups=0.1, wpb=5118, bsz=1280, num_updates=3540, lr=2.31096e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=45484
2024-11-06 16:10:23 - progress_bar.py[line:274] - INFO: epoch 012:    108 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.338, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.11, wps=499.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3550, lr=2.30246e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=45587
2024-11-06 16:12:06 - progress_bar.py[line:274] - INFO: epoch 012:    118 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=496.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3560, lr=2.29397e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=45690
2024-11-06 16:13:48 - progress_bar.py[line:274] - INFO: epoch 012:    128 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.352, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.21, wps=499.3, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3570, lr=2.28547e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=45792
2024-11-06 16:15:31 - progress_bar.py[line:274] - INFO: epoch 012:    138 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.347, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=498.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=3580, lr=2.27698e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=45895
2024-11-06 16:17:13 - progress_bar.py[line:274] - INFO: epoch 012:    148 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.34, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.13, wps=499.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3590, lr=2.26848e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=45997
2024-11-06 16:18:57 - progress_bar.py[line:274] - INFO: epoch 012:    158 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.334, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.08, wps=494.7, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3600, lr=2.25998e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=46101
2024-11-06 16:20:40 - progress_bar.py[line:274] - INFO: epoch 012:    168 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.346, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.17, wps=493.4, ups=0.1, wpb=5118, bsz=1280, num_updates=3610, lr=2.25149e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=46205
2024-11-06 16:22:24 - progress_bar.py[line:274] - INFO: epoch 012:    178 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=495.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3620, lr=2.24299e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=46308
2024-11-06 16:24:07 - progress_bar.py[line:274] - INFO: epoch 012:    188 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=495.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=3630, lr=2.23449e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=46411
2024-11-06 16:25:50 - progress_bar.py[line:274] - INFO: epoch 012:    198 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.45, wps=495.6, ups=0.1, wpb=5118.9, bsz=1280, num_updates=3640, lr=2.226e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=46514
2024-11-06 16:27:33 - progress_bar.py[line:274] - INFO: epoch 012:    208 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=499.4, ups=0.1, wpb=5117.6, bsz=1280, num_updates=3650, lr=2.2175e-05, gnorm=0.012, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=46617
2024-11-06 16:29:16 - progress_bar.py[line:274] - INFO: epoch 012:    218 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=494.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3660, lr=2.20901e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=46720
2024-11-06 16:30:59 - progress_bar.py[line:274] - INFO: epoch 012:    228 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=497.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3670, lr=2.20051e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=46823
2024-11-06 16:32:41 - progress_bar.py[line:274] - INFO: epoch 012:    238 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=499.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3680, lr=2.19201e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=46926
2024-11-06 16:34:24 - progress_bar.py[line:274] - INFO: epoch 012:    248 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=500.6, ups=0.1, wpb=5119.2, bsz=1280, num_updates=3690, lr=2.18352e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=47028
2024-11-06 16:36:07 - progress_bar.py[line:274] - INFO: epoch 012:    258 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=495.6, ups=0.1, wpb=5117.8, bsz=1280, num_updates=3700, lr=2.17502e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=47131
2024-11-06 16:37:50 - progress_bar.py[line:274] - INFO: epoch 012:    268 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=498.2, ups=0.1, wpb=5118, bsz=1280, num_updates=3710, lr=2.16653e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=47234
2024-11-06 16:39:33 - progress_bar.py[line:274] - INFO: epoch 012:    278 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=496.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=3720, lr=2.15803e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=47337
2024-11-06 16:41:15 - progress_bar.py[line:274] - INFO: epoch 012:    288 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=499.4, ups=0.1, wpb=5118, bsz=1280, num_updates=3730, lr=2.14953e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=47440
2024-11-06 16:42:59 - progress_bar.py[line:274] - INFO: epoch 012:    298 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=493.3, ups=0.1, wpb=5118.7, bsz=1280, num_updates=3740, lr=2.14104e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=47543
2024-11-06 16:44:43 - progress_bar.py[line:274] - INFO: epoch 012:    308 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5119.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=493.5, ups=0.1, wpb=5119.3, bsz=1280, num_updates=3750, lr=2.13254e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=104, gb_free=9.6, wall=47647
slice_id 6 seek offset 41730slice_id 1 seek offset 6955

slice_id 7 seek offset 48685slice_id 2 seek offset 13910

2024-11-06 16:45:27 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 3 seek offset 20865
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 5 seek offset 34775
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 16:52:49 - progress_bar.py[line:282] - INFO: epoch 012 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.381 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.42 | score 0.4919 | wps 506 | wpb 639.3 | bsz 159.9 | num_updates 3755 | best_score 0.4919
2024-11-06 16:52:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 3755 updates
2024-11-06 16:52:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 7 seek offset 350000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 4 seek offset 200000
2024-11-06 16:53:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 16:55:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 12 @ 3755 updates, score 0.4919) (writing took 135.2984193029988 seconds)
2024-11-06 16:55:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 3755 updates
2024-11-06 16:55:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 16:56:32 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 16:56:32 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 12 @ 3755 updates, score 0) (writing took 87.2925530240027 seconds)
2024-11-06 16:56:32 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-06 16:56:32 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.372 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.35 | wps 413.1 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 3755 | lr 2.12829e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 2840 | gb_free 9.7 | wall 48356
2024-11-06 16:56:32 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 16:56:35 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-06 16:56:35 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 16:57:27 - progress_bar.py[line:274] - INFO: epoch 013:      5 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=63.6, ups=0.01, wpb=4862.2, bsz=1216, num_updates=3760, lr=2.12404e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=62, gb_free=9.7, wall=48412
2024-11-06 16:59:07 - progress_bar.py[line:274] - INFO: epoch 013:     15 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=514, ups=0.1, wpb=5117.6, bsz=1280, num_updates=3770, lr=2.11555e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=48511
2024-11-06 17:00:47 - progress_bar.py[line:274] - INFO: epoch 013:     25 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=511.7, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3780, lr=2.10705e-05, gnorm=0.012, clip=0, loss_scale=8192, train_wall=34, gb_free=9.7, wall=48611
2024-11-06 17:02:27 - progress_bar.py[line:274] - INFO: epoch 013:     35 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=513.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3790, lr=2.09856e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=48711
2024-11-06 17:04:10 - progress_bar.py[line:274] - INFO: epoch 013:     45 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=497.3, ups=0.1, wpb=5117.8, bsz=1280, num_updates=3800, lr=2.09006e-05, gnorm=0.012, clip=0, loss_scale=8192, train_wall=50, gb_free=9.7, wall=48814
2024-11-06 17:05:52 - progress_bar.py[line:274] - INFO: epoch 013:     55 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=498, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3810, lr=2.08156e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=86, gb_free=9.6, wall=48917
2024-11-06 17:07:36 - progress_bar.py[line:274] - INFO: epoch 013:     65 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=495.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3820, lr=2.07307e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=49020
2024-11-06 17:09:18 - progress_bar.py[line:274] - INFO: epoch 013:     75 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=498.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3830, lr=2.06457e-05, gnorm=0.012, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=49123
2024-11-06 17:11:01 - progress_bar.py[line:274] - INFO: epoch 013:     85 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=497.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3840, lr=2.05607e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=49225
2024-11-06 17:12:45 - progress_bar.py[line:274] - INFO: epoch 013:     95 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=491, ups=0.1, wpb=5117.8, bsz=1280, num_updates=3850, lr=2.04758e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=104, gb_free=9.6, wall=49330
2024-11-06 17:14:28 - progress_bar.py[line:274] - INFO: epoch 013:    105 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=498.7, ups=0.1, wpb=5118.2, bsz=1280, num_updates=3860, lr=2.03908e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=49432
2024-11-06 17:16:11 - progress_bar.py[line:274] - INFO: epoch 013:    115 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=499.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3870, lr=2.03059e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=49535
2024-11-06 17:17:53 - progress_bar.py[line:274] - INFO: epoch 013:    125 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=500.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=3880, lr=2.02209e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=49637
2024-11-06 17:19:35 - progress_bar.py[line:274] - INFO: epoch 013:    135 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=500.2, ups=0.1, wpb=5118.6, bsz=1280, num_updates=3890, lr=2.01359e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=49740
2024-11-06 17:21:18 - progress_bar.py[line:274] - INFO: epoch 013:    145 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=500.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3900, lr=2.0051e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=49842
2024-11-06 17:23:00 - progress_bar.py[line:274] - INFO: epoch 013:    155 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=499.4, ups=0.1, wpb=5117.9, bsz=1280, num_updates=3910, lr=1.9966e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=49944
2024-11-06 17:24:43 - progress_bar.py[line:274] - INFO: epoch 013:    165 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=499.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=3920, lr=1.98811e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=50047
2024-11-06 17:26:25 - progress_bar.py[line:274] - INFO: epoch 013:    175 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.391, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=500.8, ups=0.1, wpb=5117.8, bsz=1280, num_updates=3930, lr=1.97961e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.6, wall=50149
2024-11-06 17:28:07 - progress_bar.py[line:274] - INFO: epoch 013:    185 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=500.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3940, lr=1.97111e-05, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.6, wall=50251
2024-11-06 17:29:49 - progress_bar.py[line:274] - INFO: epoch 013:    195 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=499.8, ups=0.1, wpb=5118.8, bsz=1280, num_updates=3950, lr=1.96262e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=50354
2024-11-06 17:31:32 - progress_bar.py[line:274] - INFO: epoch 013:    205 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=500.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=3960, lr=1.95412e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=50456
2024-11-06 17:33:14 - progress_bar.py[line:274] - INFO: epoch 013:    215 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=498.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=3970, lr=1.94562e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=50558
2024-11-06 17:34:57 - progress_bar.py[line:274] - INFO: epoch 013:    225 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.361, ntokens=5117.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.28, wps=498.1, ups=0.1, wpb=5117.4, bsz=1280, num_updates=3980, lr=1.93713e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=50661
2024-11-06 17:36:40 - progress_bar.py[line:274] - INFO: epoch 013:    235 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=495.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=3990, lr=1.92863e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=50764
2024-11-06 17:38:23 - progress_bar.py[line:274] - INFO: epoch 013:    245 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.351, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.2, wps=499.9, ups=0.1, wpb=5118.6, bsz=1280, num_updates=4000, lr=1.92014e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=50867
slice_id 6 seek offset 41730
slice_id 2 seek offset 13910
2024-11-06 17:38:23 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 48685slice_id 1 seek offset 6955

slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 5 seek offset 34775
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 17:45:55 - progress_bar.py[line:282] - INFO: epoch 013 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.385 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.44 | score 0.4928 | wps 493.7 | wpb 639.3 | bsz 159.9 | num_updates 4000 | best_score 0.4928
2024-11-06 17:45:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 4000 updates
2024-11-06 17:45:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_13_4000.pt
2024-11-06 17:46:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_13_4000.pt
2024-11-06 17:48:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_13_4000.pt (epoch 13 @ 4000 updates, score 0.4928) (writing took 173.5500608900038 seconds)
2024-11-06 17:50:18 - progress_bar.py[line:274] - INFO: epoch 013:    255 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=71.5, ups=0.01, wpb=5118.4, bsz=1280, num_updates=4010, lr=1.91164e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=34, gb_free=9.7, wall=51582
2024-11-06 17:51:58 - progress_bar.py[line:274] - INFO: epoch 013:    265 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=511.5, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4020, lr=1.90314e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=51683
2024-11-06 17:53:41 - progress_bar.py[line:274] - INFO: epoch 013:    275 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.45, wps=499.8, ups=0.1, wpb=5118.9, bsz=1280, num_updates=4030, lr=1.89465e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=36, gb_free=9.7, wall=51785
2024-11-06 17:55:24 - progress_bar.py[line:274] - INFO: epoch 013:    285 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=497.7, ups=0.1, wpb=5118, bsz=1280, num_updates=4040, lr=1.88615e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=48, gb_free=9.7, wall=51888
2024-11-06 17:57:06 - progress_bar.py[line:274] - INFO: epoch 013:    295 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=497.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4050, lr=1.87766e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=67, gb_free=9.7, wall=51991
2024-11-06 17:58:49 - progress_bar.py[line:274] - INFO: epoch 013:    305 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=497.2, ups=0.1, wpb=5119.2, bsz=1280, num_updates=4060, lr=1.86916e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=98, gb_free=9.7, wall=52094
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 3 seek offset 208652024-11-06 18:00:04 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 5 seek offset 34775
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 18:07:29 - progress_bar.py[line:282] - INFO: epoch 013 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.418 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.69 | score 0.4924 | wps 502.6 | wpb 639.3 | bsz 159.9 | num_updates 4068 | best_score 0.4928
2024-11-06 18:07:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 4068 updates
2024-11-06 18:07:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
2024-11-06 18:08:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 18:08:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 13 @ 4068 updates, score 0.4924) (writing took 60.69451897899853 seconds)
2024-11-06 18:08:29 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 4068 updates
2024-11-06 18:08:29 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 18:09:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 18:09:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 13 @ 4068 updates, score 0) (writing took 60.217560203993344 seconds)
2024-11-06 18:09:29 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-06 18:09:29 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.38 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.41 | wps 365.4 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 4068 | lr 1.86236e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 2599 | gb_free 9.7 | wall 52734
2024-11-06 18:09:29 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 18:09:32 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-06 18:09:32 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 18:09:55 - progress_bar.py[line:274] - INFO: epoch 014:      2 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=73.1, ups=0.02, wpb=4862.2, bsz=1216, num_updates=4070, lr=1.86066e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=81, gb_free=9.7, wall=52759
2024-11-06 18:11:34 - progress_bar.py[line:274] - INFO: epoch 014:     12 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=513, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4080, lr=1.85217e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=52858
2024-11-06 18:13:14 - progress_bar.py[line:274] - INFO: epoch 014:     22 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=513, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4090, lr=1.84367e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=52958
2024-11-06 18:14:54 - progress_bar.py[line:274] - INFO: epoch 014:     32 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=513.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4100, lr=1.83517e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=53058
2024-11-06 18:16:37 - progress_bar.py[line:274] - INFO: epoch 014:     42 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=495.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4110, lr=1.82668e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=54, gb_free=9.7, wall=53161
2024-11-06 18:18:19 - progress_bar.py[line:274] - INFO: epoch 014:     52 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=500, ups=0.1, wpb=5118, bsz=1280, num_updates=4120, lr=1.81818e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=90, gb_free=9.7, wall=53264
2024-11-06 18:20:02 - progress_bar.py[line:274] - INFO: epoch 014:     62 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=501.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4130, lr=1.80969e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=53366
2024-11-06 18:21:34 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4096.0
2024-11-06 18:21:55 - progress_bar.py[line:274] - INFO: epoch 014:     73 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=452.7, ups=0.09, wpb=5117.8, bsz=1280, num_updates=4140, lr=1.80119e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=113, gb_free=9.7, wall=53479
2024-11-06 18:23:38 - progress_bar.py[line:274] - INFO: epoch 014:     83 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=495.8, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4150, lr=1.79269e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=53582
2024-11-06 18:25:20 - progress_bar.py[line:274] - INFO: epoch 014:     93 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=499.3, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4160, lr=1.7842e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=53685
2024-11-06 18:27:03 - progress_bar.py[line:274] - INFO: epoch 014:    103 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=499.9, ups=0.1, wpb=5117.8, bsz=1280, num_updates=4170, lr=1.7757e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=53787
2024-11-06 18:28:45 - progress_bar.py[line:274] - INFO: epoch 014:    113 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=499, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4180, lr=1.7672e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=53890
2024-11-06 18:30:28 - progress_bar.py[line:274] - INFO: epoch 014:    123 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=498.2, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4190, lr=1.75871e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=53992
2024-11-06 18:32:10 - progress_bar.py[line:274] - INFO: epoch 014:    133 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=499.9, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4200, lr=1.75021e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.8, wall=54095
2024-11-06 18:33:53 - progress_bar.py[line:274] - INFO: epoch 014:    143 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=497.1, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4210, lr=1.74172e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=54198
2024-11-06 18:35:36 - progress_bar.py[line:274] - INFO: epoch 014:    153 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=498.3, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4220, lr=1.73322e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=54300
2024-11-06 18:37:19 - progress_bar.py[line:274] - INFO: epoch 014:    163 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=498.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4230, lr=1.72472e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=54403
2024-11-06 18:39:02 - progress_bar.py[line:274] - INFO: epoch 014:    173 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=495.5, ups=0.1, wpb=5118, bsz=1280, num_updates=4240, lr=1.71623e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=54506
2024-11-06 18:40:45 - progress_bar.py[line:274] - INFO: epoch 014:    183 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=497.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4250, lr=1.70773e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=54609
2024-11-06 18:42:28 - progress_bar.py[line:274] - INFO: epoch 014:    193 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5119.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=496.2, ups=0.1, wpb=5119.1, bsz=1280, num_updates=4260, lr=1.69924e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=54712
2024-11-06 18:44:11 - progress_bar.py[line:274] - INFO: epoch 014:    203 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.42, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.7, wps=499.3, ups=0.1, wpb=5118.6, bsz=1280, num_updates=4270, lr=1.69074e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=54815
2024-11-06 18:45:53 - progress_bar.py[line:274] - INFO: epoch 014:    213 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.423, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.73, wps=499, ups=0.1, wpb=5118, bsz=1280, num_updates=4280, lr=1.68224e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=54917
2024-11-06 18:47:36 - progress_bar.py[line:274] - INFO: epoch 014:    223 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=497, ups=0.1, wpb=5117.5, bsz=1280, num_updates=4290, lr=1.67375e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=55020
2024-11-06 18:49:19 - progress_bar.py[line:274] - INFO: epoch 014:    233 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.393, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=497.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4300, lr=1.66525e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=55123
2024-11-06 18:51:01 - progress_bar.py[line:274] - INFO: epoch 014:    243 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=499.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4310, lr=1.65675e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=55226
2024-11-06 18:52:44 - progress_bar.py[line:274] - INFO: epoch 014:    253 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=498.9, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4320, lr=1.64826e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=55328
2024-11-06 18:54:27 - progress_bar.py[line:274] - INFO: epoch 014:    263 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.398, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=498.7, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4330, lr=1.63976e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=55431
2024-11-06 18:56:09 - progress_bar.py[line:274] - INFO: epoch 014:    273 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.402, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=499.9, ups=0.1, wpb=5118.9, bsz=1280, num_updates=4340, lr=1.63127e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=55533
2024-11-06 18:57:52 - progress_bar.py[line:274] - INFO: epoch 014:    283 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=495.5, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4350, lr=1.62277e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=55637
2024-11-06 18:59:36 - progress_bar.py[line:274] - INFO: epoch 014:    293 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=495.8, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4360, lr=1.61427e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=55740
2024-11-06 19:01:19 - progress_bar.py[line:274] - INFO: epoch 014:    303 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=495.4, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4370, lr=1.60578e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=55843
2024-11-06 19:02:54 - progress_bar.py[line:274] - INFO: epoch 014:    313 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.408, ntokens=4863.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=509, ups=0.1, wpb=4863.2, bsz=1216, num_updates=4380, lr=1.59728e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=95, gb_free=9.7, wall=55939
slice_id 7 seek offset 48685slice_id 2 seek offset 13910
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 1 seek offset 6955

2024-11-06 19:02:54 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 5 seek offset 34775
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 19:10:19 - progress_bar.py[line:282] - INFO: epoch 014 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.402 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.57 | score 0.4946 | wps 502.7 | wpb 639.3 | bsz 159.9 | num_updates 4380 | best_score 0.4946
2024-11-06 19:10:19 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 4380 updates
2024-11-06 19:10:19 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 2 seek offset 100000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 4 seek offset 200000
slice_id 6 seek offset 300000
2024-11-06 19:11:19 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 19:12:34 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 14 @ 4380 updates, score 0.4946) (writing took 135.41395747500064 seconds)
2024-11-06 19:12:35 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 4380 updates
2024-11-06 19:12:35 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 19:14:02 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 19:14:02 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 14 @ 4380 updates, score 0) (writing took 87.23585652600741 seconds)
2024-11-06 19:14:02 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-06 19:14:02 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.389 | ntokens 5110.05 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.47 | wps 411.7 | ups 0.08 | wpb 5110.1 | bsz 1277.9 | num_updates 4380 | lr 1.59728e-05 | gnorm 0.008 | clip 0 | loss_scale 4096 | train_wall 2928 | gb_free 9.7 | wall 56606
2024-11-06 19:14:02 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 19:14:05 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-06 19:14:05 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 19:15:47 - progress_bar.py[line:274] - INFO: epoch 015:     10 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5117.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=66.2, ups=0.01, wpb=5117.3, bsz=1280, num_updates=4390, lr=1.58879e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=35, gb_free=9.5, wall=56712
2024-11-06 19:17:27 - progress_bar.py[line:274] - INFO: epoch 015:     20 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.393, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=514.6, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4400, lr=1.58029e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=56811
2024-11-06 19:19:06 - progress_bar.py[line:274] - INFO: epoch 015:     30 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=515, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4410, lr=1.57179e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=56910
2024-11-06 19:20:46 - progress_bar.py[line:274] - INFO: epoch 015:     40 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=514.3, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4420, lr=1.5633e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=57010
2024-11-06 19:22:28 - progress_bar.py[line:274] - INFO: epoch 015:     50 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.45, wps=500.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4430, lr=1.5548e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=48, gb_free=9.7, wall=57112
2024-11-06 19:24:11 - progress_bar.py[line:274] - INFO: epoch 015:     60 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.425, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.74, wps=499.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4440, lr=1.5463e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=79, gb_free=9.7, wall=57215
2024-11-06 19:25:53 - progress_bar.py[line:274] - INFO: epoch 015:     70 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=498.6, ups=0.1, wpb=5117.8, bsz=1280, num_updates=4450, lr=1.53781e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=57318
2024-11-06 19:27:36 - progress_bar.py[line:274] - INFO: epoch 015:     80 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.426, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.75, wps=500.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4460, lr=1.52931e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=57420
2024-11-06 19:29:18 - progress_bar.py[line:274] - INFO: epoch 015:     90 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.421, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.71, wps=500.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4470, lr=1.52082e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=57522
2024-11-06 19:30:59 - progress_bar.py[line:274] - INFO: epoch 015:    100 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=504.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=4480, lr=1.51232e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=101, gb_free=9.6, wall=57624
2024-11-06 19:32:42 - progress_bar.py[line:274] - INFO: epoch 015:    110 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.411, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=498.9, ups=0.1, wpb=5118.7, bsz=1280, num_updates=4490, lr=1.50382e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=57726
2024-11-06 19:34:24 - progress_bar.py[line:274] - INFO: epoch 015:    120 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=499.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4500, lr=1.49533e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=57829
2024-11-06 19:36:07 - progress_bar.py[line:274] - INFO: epoch 015:    130 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=497.9, ups=0.1, wpb=5118.5, bsz=1280, num_updates=4510, lr=1.48683e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=57931
2024-11-06 19:37:50 - progress_bar.py[line:274] - INFO: epoch 015:    140 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=498.5, ups=0.1, wpb=5118.5, bsz=1280, num_updates=4520, lr=1.47833e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=58034
2024-11-06 19:39:32 - progress_bar.py[line:274] - INFO: epoch 015:    150 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.402, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.57, wps=501.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4530, lr=1.46984e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=58136
2024-11-06 19:41:14 - progress_bar.py[line:274] - INFO: epoch 015:    160 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.412, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.64, wps=501, ups=0.1, wpb=5118, bsz=1280, num_updates=4540, lr=1.46134e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=58238
2024-11-06 19:42:57 - progress_bar.py[line:274] - INFO: epoch 015:    170 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.408, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=497.4, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4550, lr=1.45285e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=58341
2024-11-06 19:44:39 - progress_bar.py[line:274] - INFO: epoch 015:    180 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=503.2, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4560, lr=1.44435e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=58443
2024-11-06 19:46:21 - progress_bar.py[line:274] - INFO: epoch 015:    190 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=498.5, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4570, lr=1.43585e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=58546
2024-11-06 19:48:05 - progress_bar.py[line:274] - INFO: epoch 015:    200 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.413, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.65, wps=491.6, ups=0.1, wpb=5118.6, bsz=1280, num_updates=4580, lr=1.42736e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=104, gb_free=9.5, wall=58650
2024-11-06 19:49:48 - progress_bar.py[line:274] - INFO: epoch 015:    210 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=501.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4590, lr=1.41886e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=58752
2024-11-06 19:51:30 - progress_bar.py[line:274] - INFO: epoch 015:    220 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=501.7, ups=0.1, wpb=5117.7, bsz=1280, num_updates=4600, lr=1.41037e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=58854
2024-11-06 19:53:11 - progress_bar.py[line:274] - INFO: epoch 015:    230 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=503.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4610, lr=1.40187e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=58955
2024-11-06 19:54:54 - progress_bar.py[line:274] - INFO: epoch 015:    240 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.393, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=496.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4620, lr=1.39337e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=59058
2024-11-06 19:56:36 - progress_bar.py[line:274] - INFO: epoch 015:    250 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=502.4, ups=0.1, wpb=5119.4, bsz=1280, num_updates=4630, lr=1.38488e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=59160
2024-11-06 19:58:19 - progress_bar.py[line:274] - INFO: epoch 015:    260 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=499.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4640, lr=1.37638e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=59263
2024-11-06 20:00:01 - progress_bar.py[line:274] - INFO: epoch 015:    270 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=499.7, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4650, lr=1.36788e-05, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=59365
2024-11-06 20:01:43 - progress_bar.py[line:274] - INFO: epoch 015:    280 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.409, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.62, wps=500.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=4660, lr=1.35939e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=59468
2024-11-06 20:02:04 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4096.0
2024-11-06 20:03:36 - progress_bar.py[line:274] - INFO: epoch 015:    291 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.417, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.68, wps=454.6, ups=0.09, wpb=5117.9, bsz=1280, num_updates=4670, lr=1.35089e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=112, gb_free=9.7, wall=59580
2024-11-06 20:05:19 - progress_bar.py[line:274] - INFO: epoch 015:    301 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=497.2, ups=0.1, wpb=5118.8, bsz=1280, num_updates=4680, lr=1.3424e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=59683
2024-11-06 20:07:01 - progress_bar.py[line:274] - INFO: epoch 015:    311 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.42, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.7, wps=501.6, ups=0.1, wpb=5119.2, bsz=1280, num_updates=4690, lr=1.3339e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=59785
slice_id 1 seek offset 6955
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
2024-11-06 20:07:14 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 48685
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 20:14:40 - progress_bar.py[line:282] - INFO: epoch 015 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.448 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.91 | score 0.4949 | wps 501.4 | wpb 639.3 | bsz 159.9 | num_updates 4692 | best_score 0.4949
2024-11-06 20:14:40 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 4692 updates
2024-11-06 20:14:40 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
2024-11-06 20:15:40 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 20:16:36 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 15 @ 4692 updates, score 0.4949) (writing took 116.76038275999599 seconds)
2024-11-06 20:16:36 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 4692 updates
2024-11-06 20:16:36 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 20:17:37 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 20:17:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 15 @ 4692 updates, score 0) (writing took 60.39300676299899 seconds)
2024-11-06 20:17:37 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-06 20:17:37 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.403 | ntokens 5110.04 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.58 | wps 417.9 | ups 0.08 | wpb 5110 | bsz 1277.9 | num_updates 4692 | lr 1.3322e-05 | gnorm 0.008 | clip 0 | loss_scale 4096 | train_wall 2846 | gb_free 9.7 | wall 60421
2024-11-06 20:17:37 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 20:17:39 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-06 20:17:39 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 20:19:02 - progress_bar.py[line:274] - INFO: epoch 016:      8 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.419, ntokens=4861.7, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.69, wps=67.4, ups=0.01, wpb=4861.7, bsz=1216, num_updates=4700, lr=1.3254e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=41, gb_free=9.7, wall=60506
2024-11-06 20:20:42 - progress_bar.py[line:274] - INFO: epoch 016:     18 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=511.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4710, lr=1.31691e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=60606
2024-11-06 20:22:22 - progress_bar.py[line:274] - INFO: epoch 016:     28 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.416, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=514.3, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4720, lr=1.30841e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=60706
2024-11-06 20:24:03 - progress_bar.py[line:274] - INFO: epoch 016:     38 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.415, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.67, wps=507, ups=0.1, wpb=5118, bsz=1280, num_updates=4730, lr=1.29992e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=36, gb_free=9.7, wall=60807
2024-11-06 20:25:46 - progress_bar.py[line:274] - INFO: epoch 016:     48 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.43, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.78, wps=496.9, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4740, lr=1.29142e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=61, gb_free=9.7, wall=60910
2024-11-06 20:27:28 - progress_bar.py[line:274] - INFO: epoch 016:     58 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.406, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.6, wps=499.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=4750, lr=1.28292e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=93, gb_free=9.6, wall=61012
2024-11-06 20:29:11 - progress_bar.py[line:274] - INFO: epoch 016:     68 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.399, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=498.3, ups=0.1, wpb=5117.6, bsz=1280, num_updates=4760, lr=1.27443e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=61115
2024-11-06 20:30:53 - progress_bar.py[line:274] - INFO: epoch 016:     78 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.403, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.58, wps=499.1, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4770, lr=1.26593e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=61218
2024-11-06 20:32:36 - progress_bar.py[line:274] - INFO: epoch 016:     88 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=499.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4780, lr=1.25743e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=61320
2024-11-06 20:34:18 - progress_bar.py[line:274] - INFO: epoch 016:     98 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=500.3, ups=0.1, wpb=5118, bsz=1280, num_updates=4790, lr=1.24894e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=61422
2024-11-06 20:36:01 - progress_bar.py[line:274] - INFO: epoch 016:    108 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=498.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4800, lr=1.24044e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=61525
2024-11-06 20:37:43 - progress_bar.py[line:274] - INFO: epoch 016:    118 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=501.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4810, lr=1.23195e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=61627
2024-11-06 20:39:26 - progress_bar.py[line:274] - INFO: epoch 016:    128 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=498.2, ups=0.1, wpb=5118.4, bsz=1280, num_updates=4820, lr=1.22345e-05, gnorm=0.015, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=61730
2024-11-06 20:41:09 - progress_bar.py[line:274] - INFO: epoch 016:    138 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=497.9, ups=0.1, wpb=5118.7, bsz=1280, num_updates=4830, lr=1.21495e-05, gnorm=0.004, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=61833
2024-11-06 20:42:51 - progress_bar.py[line:274] - INFO: epoch 016:    148 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=499.8, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4840, lr=1.20646e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=61935
2024-11-06 20:44:33 - progress_bar.py[line:274] - INFO: epoch 016:    158 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=500.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4850, lr=1.19796e-05, gnorm=0.013, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=62037
2024-11-06 20:46:16 - progress_bar.py[line:274] - INFO: epoch 016:    168 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.391, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=499.1, ups=0.1, wpb=5118, bsz=1280, num_updates=4860, lr=1.18946e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=62140
2024-11-06 20:47:58 - progress_bar.py[line:274] - INFO: epoch 016:    178 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.391, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=499.8, ups=0.1, wpb=5117.9, bsz=1280, num_updates=4870, lr=1.18097e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=62242
2024-11-06 20:49:42 - progress_bar.py[line:274] - INFO: epoch 016:    188 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=494.8, ups=0.1, wpb=5118.7, bsz=1280, num_updates=4880, lr=1.17247e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=62346
2024-11-06 20:51:24 - progress_bar.py[line:274] - INFO: epoch 016:    198 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=500.3, ups=0.1, wpb=5118.9, bsz=1280, num_updates=4890, lr=1.16398e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=62448
2024-11-06 20:53:06 - progress_bar.py[line:274] - INFO: epoch 016:    208 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=499.7, ups=0.1, wpb=5117.6, bsz=1280, num_updates=4900, lr=1.15548e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=62551
2024-11-06 20:54:49 - progress_bar.py[line:274] - INFO: epoch 016:    218 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=499.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4910, lr=1.14698e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=62653
2024-11-06 20:56:31 - progress_bar.py[line:274] - INFO: epoch 016:    228 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.36, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.27, wps=498.4, ups=0.1, wpb=5118.2, bsz=1280, num_updates=4920, lr=1.13849e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=62756
2024-11-06 20:58:14 - progress_bar.py[line:274] - INFO: epoch 016:    238 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=496.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=4930, lr=1.12999e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=62859
2024-11-06 20:59:56 - progress_bar.py[line:274] - INFO: epoch 016:    248 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.356, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.24, wps=503.4, ups=0.1, wpb=5119.2, bsz=1280, num_updates=4940, lr=1.1215e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=62960
2024-11-06 21:01:38 - progress_bar.py[line:274] - INFO: epoch 016:    258 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.367, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=502.5, ups=0.1, wpb=5117.8, bsz=1280, num_updates=4950, lr=1.113e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=63062
2024-11-06 21:03:20 - progress_bar.py[line:274] - INFO: epoch 016:    268 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=499.4, ups=0.1, wpb=5118, bsz=1280, num_updates=4960, lr=1.1045e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=63165
2024-11-06 21:05:04 - progress_bar.py[line:274] - INFO: epoch 016:    278 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=495.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=4970, lr=1.09601e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=63268
2024-11-06 21:06:46 - progress_bar.py[line:274] - INFO: epoch 016:    288 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=501.1, ups=0.1, wpb=5118, bsz=1280, num_updates=4980, lr=1.08751e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=63370
2024-11-06 21:08:28 - progress_bar.py[line:274] - INFO: epoch 016:    298 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=500.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=4990, lr=1.07901e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=63472
2024-11-06 21:10:11 - progress_bar.py[line:274] - INFO: epoch 016:    308 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5119.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=499.4, ups=0.1, wpb=5119.3, bsz=1280, num_updates=5000, lr=1.07052e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=63575
slice_id 6 seek offset 41730
slice_id 2 seek offset 13910
slice_id 7 seek offset 486852024-11-06 21:10:11 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 5 seek offset 34775
slice_id 0 seek offset 0
slice_id 4 seek offset 27820

slice_id 3 seek offset 20865
slice_id 1 seek offset 6955
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 7 seek offset 48685
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
slice_id 1 seek offset 6955
2024-11-06 21:17:42 - progress_bar.py[line:282] - INFO: epoch 016 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.403 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.58 | score 0.4958 | wps 494.9 | wpb 639.3 | bsz 159.9 | num_updates 5000 | best_score 0.4958
2024-11-06 21:17:42 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 5000 updates
2024-11-06 21:17:42 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_16_5000.pt
2024-11-06 21:17:52 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_16_5000.pt
2024-11-06 21:20:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_16_5000.pt (epoch 16 @ 5000 updates, score 0.4958) (writing took 180.78021372399235 seconds)
loss_reg: 0.103759765625 loss_cls: 0.0
loss_reg: 0.12396240234375 loss_cls: 0.0
loss_reg: 0.10919189453125 loss_cls: 0.0
loss_reg: 0.1275634765625 loss_cls: 0.0
loss_reg: 0.11773681640625 loss_cls: 0.0
loss_reg: 0.0926513671875 loss_cls: 0.0
loss_reg: 0.08880615234375 loss_cls: 0.0
loss_reg: 0.08111572265625 loss_cls: 0.0
loss_reg: 0.1209716796875 loss_cls: 0.0
loss_reg: 0.07958984375 loss_cls: 0.0
loss_reg: 0.083984375 loss_cls: 0.0
loss_reg: 0.1229248046875 loss_cls: 0.0
loss_reg: 0.0860595703125 loss_cls: 0.0
loss_reg: 0.07708740234375 loss_cls: 0.0
loss_reg: 0.09808349609375 loss_cls: 0.0
loss_reg: 0.094482421875 loss_cls: 0.0
loss_reg: 0.10028076171875 loss_cls: 0.0
loss_reg: 0.092041015625 loss_cls: 0.0
loss_reg: 0.0802001953125 loss_cls: 0.0
loss_reg: 0.1099853515625 loss_cls: 0.0
loss_reg: 0.11480712890625 loss_cls: 0.0
loss_reg: 0.0865478515625 loss_cls: 0.0
loss_reg: 0.1275634765625 loss_cls: 0.0
loss_reg: 0.10693359375 loss_cls: 0.0
loss_reg: 0.0843505859375 loss_cls: 0.0
loss_reg: 0.1466064453125 loss_cls: 0.0
loss_reg: 0.1033935546875 loss_cls: 0.0
loss_reg: 0.08026123046875 loss_cls: 0.0
loss_reg: 0.076904296875 loss_cls: 0.0
loss_reg: 0.107177734375 loss_cls: 0.0
loss_reg: 0.08953857421875 loss_cls: 0.0
loss_reg: 0.100830078125 loss_cls: 0.0
loss_reg: 0.09405517578125 loss_cls: 0.0
loss_reg: 0.09991455078125 loss_cls: 0.0
loss_reg: 0.11407470703125 loss_cls: 0.0
loss_reg: 0.08697509765625 loss_cls: 0.0
loss_reg: 0.12127685546875 loss_cls: 0.0
loss_reg: 0.085205078125 loss_cls: 0.0
loss_reg: 0.0736083984375 loss_cls: 0.0
loss_reg: 0.10736083984375 loss_cls: 0.0
loss_reg: 0.10186767578125 loss_cls: 0.0
loss_reg: 0.0909423828125 loss_cls: 0.0
loss_reg: 0.071533203125 loss_cls: 0.0
loss_reg: 0.1048583984375 loss_cls: 0.0
loss_reg: 0.0916748046875 loss_cls: 0.0
loss_reg: 0.08392333984375 loss_cls: 0.0
loss_reg: 0.1337890625 loss_cls: 0.0
loss_reg: 0.122314453125 loss_cls: 0.0
loss_reg: 0.0909423828125 loss_cls: 0.0
loss_reg: 0.080322265625 loss_cls: 0.0
loss_reg: 0.103759765625 loss_cls: 0.0
loss_reg: 0.1251220703125 loss_cls: 0.0
loss_reg: 0.10076904296875 loss_cls: 0.0
loss_reg: 0.11328125 loss_cls: 0.0
loss_reg: 0.1041259765625 loss_cls: 0.0
loss_reg: 0.06646728515625 loss_cls: 0.0
loss_reg: 0.0997314453125 loss_cls: 0.0
loss_reg: 0.1343994140625 loss_cls: 0.0
loss_reg: 0.0924072265625 loss_cls: 0.0
loss_reg: 0.09759521484375 loss_cls: 0.0
loss_reg: 0.1270751953125 loss_cls: 0.0
loss_reg: 0.114013671875 loss_cls: 0.0
loss_reg: 0.1046142578125 loss_cls: 0.0
loss_reg: 0.13134765625 loss_cls: 0.0
slice_id 6 seek offset 41730
slice_id 1 seek offset 69552024-11-06 21:21:16 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 3 seek offset 20865
slice_id 0 seek offset 0slice_id 7 seek offset 48685
slice_id 2 seek offset 13910

slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
slice_id 4 seek offset 27820
2024-11-06 21:28:37 - progress_bar.py[line:282] - INFO: epoch 016 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.409 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.62 | score 0.4954 | wps 506.5 | wpb 639.3 | bsz 159.9 | num_updates 5005 | best_score 0.4958
2024-11-06 21:28:37 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 5005 updates
2024-11-06 21:28:37 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
slice_id 7 seek offset 350000
slice_id 6 seek offset 300000
slice_id 1 seek offset 50000
slice_id 5 seek offset 250000
slice_id 3 seek offset 150000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
2024-11-06 21:29:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 21:29:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 16 @ 5005 updates, score 0.4954) (writing took 60.760308327007806 seconds)
2024-11-06 21:29:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 5005 updates
2024-11-06 21:29:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 21:30:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 21:30:38 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 16 @ 5005 updates, score 0) (writing took 60.24307530799706 seconds)
2024-11-06 21:30:38 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-06 21:30:38 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.387 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.46 | wps 365.1 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 5005 | lr 1.06627e-05 | gnorm 0.008 | clip 0 | loss_scale 4096 | train_wall 2864 | gb_free 9.7 | wall 64802
2024-11-06 21:30:38 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 21:30:41 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-06 21:30:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 21:31:33 - progress_bar.py[line:274] - INFO: epoch 017:      5 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=37.9, ups=0.01, wpb=4862.2, bsz=1216, num_updates=5010, lr=1.06202e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=33, gb_free=9.7, wall=64858
2024-11-06 21:33:13 - progress_bar.py[line:274] - INFO: epoch 017:     15 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=515, ups=0.1, wpb=5117.6, bsz=1280, num_updates=5020, lr=1.05353e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=64957
2024-11-06 21:34:52 - progress_bar.py[line:274] - INFO: epoch 017:     25 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=515.9, ups=0.1, wpb=5118.5, bsz=1280, num_updates=5030, lr=1.04503e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=65056
2024-11-06 21:36:33 - progress_bar.py[line:274] - INFO: epoch 017:     35 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=507, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5040, lr=1.03653e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=37, gb_free=9.7, wall=65157
2024-11-06 21:38:17 - progress_bar.py[line:274] - INFO: epoch 017:     45 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=489.8, ups=0.1, wpb=5117.8, bsz=1280, num_updates=5050, lr=1.02804e-05, gnorm=0.005, clip=0, loss_scale=4096, train_wall=69, gb_free=9.7, wall=65262
2024-11-06 21:39:59 - progress_bar.py[line:274] - INFO: epoch 017:     55 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=502.3, ups=0.1, wpb=5118.5, bsz=1280, num_updates=5060, lr=1.01954e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=101, gb_free=9.6, wall=65364
2024-11-06 21:41:42 - progress_bar.py[line:274] - INFO: epoch 017:     65 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=498.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5070, lr=1.01105e-05, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=65466
2024-11-06 21:43:25 - progress_bar.py[line:274] - INFO: epoch 017:     75 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=498.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5080, lr=1.00255e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=65569
2024-11-06 21:45:08 - progress_bar.py[line:274] - INFO: epoch 017:     85 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=494.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5090, lr=9.94053e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=65672
2024-11-06 21:46:51 - progress_bar.py[line:274] - INFO: epoch 017:     95 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=499.3, ups=0.1, wpb=5117.8, bsz=1280, num_updates=5100, lr=9.85556e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.6, wall=65775
2024-11-06 21:48:33 - progress_bar.py[line:274] - INFO: epoch 017:    105 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=498.8, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5110, lr=9.7706e-06, gnorm=0.007, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=65878
2024-11-06 21:50:16 - progress_bar.py[line:274] - INFO: epoch 017:    115 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=499.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5120, lr=9.68564e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=65980
2024-11-06 21:51:58 - progress_bar.py[line:274] - INFO: epoch 017:    125 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=499.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5130, lr=9.60068e-06, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=66083
2024-11-06 21:53:41 - progress_bar.py[line:274] - INFO: epoch 017:    135 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.364, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.29, wps=499.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5140, lr=9.51572e-06, gnorm=0.008, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=66185
2024-11-06 21:55:24 - progress_bar.py[line:274] - INFO: epoch 017:    145 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.358, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.25, wps=498, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5150, lr=9.43076e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=66288
2024-11-06 21:57:06 - progress_bar.py[line:274] - INFO: epoch 017:    155 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=499, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5160, lr=9.34579e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=66390
2024-11-06 21:58:49 - progress_bar.py[line:274] - INFO: epoch 017:    165 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=497, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5170, lr=9.26083e-06, gnorm=0.006, clip=0, loss_scale=4096, train_wall=103, gb_free=9.7, wall=66493
2024-11-06 22:00:32 - progress_bar.py[line:274] - INFO: epoch 017:    175 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=497.7, ups=0.1, wpb=5117.8, bsz=1280, num_updates=5180, lr=9.17587e-06, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.6, wall=66596
2024-11-06 22:02:15 - progress_bar.py[line:274] - INFO: epoch 017:    185 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=496.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5190, lr=9.09091e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.6, wall=66699
2024-11-06 22:03:58 - progress_bar.py[line:274] - INFO: epoch 017:    195 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=496.5, ups=0.1, wpb=5118.8, bsz=1280, num_updates=5200, lr=9.00595e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=66802
2024-11-06 22:05:41 - progress_bar.py[line:274] - INFO: epoch 017:    205 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=497.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5210, lr=8.92099e-06, gnorm=0.009, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=66905
2024-11-06 22:07:24 - progress_bar.py[line:274] - INFO: epoch 017:    215 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.369, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.33, wps=498.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5220, lr=8.83602e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67008
2024-11-06 22:09:07 - progress_bar.py[line:274] - INFO: epoch 017:    225 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5117.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=496.7, ups=0.1, wpb=5117.4, bsz=1280, num_updates=5230, lr=8.75106e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67111
2024-11-06 22:10:50 - progress_bar.py[line:274] - INFO: epoch 017:    235 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=497.2, ups=0.1, wpb=5118.5, bsz=1280, num_updates=5240, lr=8.6661e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67214
2024-11-06 22:12:32 - progress_bar.py[line:274] - INFO: epoch 017:    245 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.368, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.32, wps=498.4, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5250, lr=8.58114e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67317
2024-11-06 22:14:15 - progress_bar.py[line:274] - INFO: epoch 017:    255 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=497.4, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5260, lr=8.49618e-06, gnorm=0.009, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67419
2024-11-06 22:15:58 - progress_bar.py[line:274] - INFO: epoch 017:    265 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=499.2, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5270, lr=8.41121e-06, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=67522
2024-11-06 22:17:40 - progress_bar.py[line:274] - INFO: epoch 017:    275 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=499, ups=0.1, wpb=5118.9, bsz=1280, num_updates=5280, lr=8.32625e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=67625
2024-11-06 22:19:23 - progress_bar.py[line:274] - INFO: epoch 017:    285 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.45, wps=498.6, ups=0.1, wpb=5118, bsz=1280, num_updates=5290, lr=8.24129e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67727
2024-11-06 22:21:06 - progress_bar.py[line:274] - INFO: epoch 017:    295 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=495.5, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5300, lr=8.15633e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=67831
2024-11-06 22:22:52 - progress_bar.py[line:274] - INFO: epoch 017:    305 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=486.4, ups=0.1, wpb=5119.2, bsz=1280, num_updates=5310, lr=8.07137e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=105, gb_free=9.7, wall=67936
slice_id 1 seek offset 6955
slice_id 7 seek offset 48685slice_id 3 seek offset 20865
2024-11-06 22:24:06 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 6 seek offset 41730slice_id 2 seek offset 13910

slice_id 0 seek offset 0
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 7 seek offset 48685
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 4 seek offset 27820
slice_id 2 seek offset 13910
slice_id 0 seek offset 0
2024-11-06 22:31:27 - progress_bar.py[line:282] - INFO: epoch 017 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.397 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.53 | score 0.4957 | wps 507.1 | wpb 639.3 | bsz 159.9 | num_updates 5318 | best_score 0.4958
2024-11-06 22:31:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 5318 updates
2024-11-06 22:31:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 4 seek offset 200000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
2024-11-06 22:32:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 22:32:27 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 17 @ 5318 updates, score 0.4957) (writing took 60.756071291005355 seconds)
2024-11-06 22:32:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 5318 updates
2024-11-06 22:32:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 22:33:27 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 22:33:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 17 @ 5318 updates, score 0) (writing took 60.271872072000406 seconds)
2024-11-06 22:33:28 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-06 22:33:28 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.379 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.4 | wps 424.3 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 5318 | lr 8.0034e-06 | gnorm 0.007 | clip 0 | loss_scale 8192 | train_wall 2939 | gb_free 9.7 | wall 68572
2024-11-06 22:33:28 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 22:33:30 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-06 22:33:30 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 22:33:53 - progress_bar.py[line:274] - INFO: epoch 018:      2 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=4862.2, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=73.5, ups=0.02, wpb=4862.2, bsz=1216, num_updates=5320, lr=7.98641e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=82, gb_free=9.7, wall=68597
2024-11-06 22:35:33 - progress_bar.py[line:274] - INFO: epoch 018:     12 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=512.1, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5330, lr=7.90144e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=68697
2024-11-06 22:37:12 - progress_bar.py[line:274] - INFO: epoch 018:     22 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=516, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5340, lr=7.81648e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=34, gb_free=9.7, wall=68796
2024-11-06 22:38:52 - progress_bar.py[line:274] - INFO: epoch 018:     32 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=514.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5350, lr=7.73152e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=68896
2024-11-06 22:40:33 - progress_bar.py[line:274] - INFO: epoch 018:     42 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=503.8, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5360, lr=7.64656e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=44, gb_free=9.7, wall=68997
2024-11-06 22:42:15 - progress_bar.py[line:274] - INFO: epoch 018:     52 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=500.9, ups=0.1, wpb=5118, bsz=1280, num_updates=5370, lr=7.5616e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=67, gb_free=9.7, wall=69100
2024-11-06 22:43:58 - progress_bar.py[line:274] - INFO: epoch 018:     62 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=499.9, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5380, lr=7.47664e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=93, gb_free=9.7, wall=69202
2024-11-06 22:45:40 - progress_bar.py[line:274] - INFO: epoch 018:     72 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=502.5, ups=0.1, wpb=5117.7, bsz=1280, num_updates=5390, lr=7.39167e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.6, wall=69304
2024-11-06 22:47:23 - progress_bar.py[line:274] - INFO: epoch 018:     82 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.395, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=497.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5400, lr=7.30671e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=69407
2024-11-06 22:49:07 - progress_bar.py[line:274] - INFO: epoch 018:     92 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=491.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5410, lr=7.22175e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=69511
2024-11-06 22:50:50 - progress_bar.py[line:274] - INFO: epoch 018:    102 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.376, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.38, wps=496.6, ups=0.1, wpb=5117.7, bsz=1280, num_updates=5420, lr=7.13679e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=69614
2024-11-06 22:52:32 - progress_bar.py[line:274] - INFO: epoch 018:    112 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=500.3, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5430, lr=7.05183e-06, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=69716
2024-11-06 22:54:14 - progress_bar.py[line:274] - INFO: epoch 018:    122 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=500.5, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5440, lr=6.96686e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=69818
2024-11-06 22:55:56 - progress_bar.py[line:274] - INFO: epoch 018:    132 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=501.3, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5450, lr=6.8819e-06, gnorm=0.009, clip=0, loss_scale=8192, train_wall=102, gb_free=9.6, wall=69921
2024-11-06 22:57:39 - progress_bar.py[line:274] - INFO: epoch 018:    142 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.365, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.31, wps=500.7, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5460, lr=6.79694e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=70023
2024-11-06 22:59:20 - progress_bar.py[line:274] - INFO: epoch 018:    152 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=505, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5470, lr=6.71198e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=70124
2024-11-06 23:01:04 - progress_bar.py[line:274] - INFO: epoch 018:    162 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=493.8, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5480, lr=6.62702e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=70228
2024-11-06 23:02:48 - progress_bar.py[line:274] - INFO: epoch 018:    172 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=491.8, ups=0.1, wpb=5117.8, bsz=1280, num_updates=5490, lr=6.54206e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=70332
2024-11-06 23:04:30 - progress_bar.py[line:274] - INFO: epoch 018:    182 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=498.7, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5500, lr=6.45709e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=70434
2024-11-06 23:06:13 - progress_bar.py[line:274] - INFO: epoch 018:    192 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=500.6, ups=0.1, wpb=5118.7, bsz=1280, num_updates=5510, lr=6.37213e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=70537
2024-11-06 23:07:55 - progress_bar.py[line:274] - INFO: epoch 018:    202 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=497.8, ups=0.1, wpb=5118.8, bsz=1280, num_updates=5520, lr=6.28717e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=70640
2024-11-06 23:09:37 - progress_bar.py[line:274] - INFO: epoch 018:    212 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=501.3, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5530, lr=6.20221e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=70742
2024-11-06 23:11:19 - progress_bar.py[line:274] - INFO: epoch 018:    222 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5117.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=504, ups=0.1, wpb=5117.6, bsz=1280, num_updates=5540, lr=6.11725e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=70843
2024-11-06 23:13:02 - progress_bar.py[line:274] - INFO: epoch 018:    232 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=496.5, ups=0.1, wpb=5118, bsz=1280, num_updates=5550, lr=6.03229e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=70946
2024-11-06 23:14:44 - progress_bar.py[line:274] - INFO: epoch 018:    242 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=500.4, ups=0.1, wpb=5118.5, bsz=1280, num_updates=5560, lr=5.94732e-06, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=71049
2024-11-06 23:16:27 - progress_bar.py[line:274] - INFO: epoch 018:    252 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=499.8, ups=0.1, wpb=5118.9, bsz=1280, num_updates=5570, lr=5.86236e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=71151
2024-11-06 23:18:10 - progress_bar.py[line:274] - INFO: epoch 018:    262 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=496.3, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5580, lr=5.7774e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=71254
2024-11-06 23:19:52 - progress_bar.py[line:274] - INFO: epoch 018:    272 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=499.9, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5590, lr=5.69244e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=71356
2024-11-06 23:21:34 - progress_bar.py[line:274] - INFO: epoch 018:    282 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=503.2, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5600, lr=5.60748e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=71458
2024-11-06 23:23:18 - progress_bar.py[line:274] - INFO: epoch 018:    292 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=494.1, ups=0.1, wpb=5118, bsz=1280, num_updates=5610, lr=5.52251e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.6, wall=71562
2024-11-06 23:25:01 - progress_bar.py[line:274] - INFO: epoch 018:    302 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=497.1, ups=0.1, wpb=5118.7, bsz=1280, num_updates=5620, lr=5.43755e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=71665
2024-11-06 23:26:42 - progress_bar.py[line:274] - INFO: epoch 018:    312 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=502.1, ups=0.1, wpb=5119.2, bsz=1280, num_updates=5630, lr=5.35259e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=71767
slice_id 7 seek offset 48685slice_id 2 seek offset 13910
2024-11-06 23:26:46 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 0 seek offset 0
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 1 seek offset 6955
slice_id 4 seek offset 27820
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-06 23:34:10 - progress_bar.py[line:282] - INFO: epoch 018 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.403 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.58 | score 0.4968 | wps 502.6 | wpb 639.3 | bsz 159.9 | num_updates 5631 | best_score 0.4968
2024-11-06 23:34:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 5631 updates
2024-11-06 23:34:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
slice_id 3 seek offset 150000
slice_id 5 seek offset 250000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
2024-11-06 23:35:11 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-06 23:36:27 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 18 @ 5631 updates, score 0.4968) (writing took 136.91521164801088 seconds)
2024-11-06 23:36:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 5631 updates
2024-11-06 23:36:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 23:37:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-06 23:37:53 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 18 @ 5631 updates, score 0) (writing took 85.75158132899378 seconds)
2024-11-06 23:37:53 - train.py[line:336] - INFO: end of epoch 18 (average epoch stats below)
2024-11-06 23:37:53 - progress_bar.py[line:282] - INFO: epoch 018 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.38 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.41 | wps 413.8 | ups 0.08 | wpb 5110.1 | bsz 1278 | num_updates 5631 | lr 5.3441e-06 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 2881 | gb_free 9.7 | wall 72438
2024-11-06 23:37:53 - trainer.py[line:639] - INFO: loading train data for epoch 19
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-06 23:37:56 - trainer.py[line:703] - INFO: begin training epoch 19
2024-11-06 23:37:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-06 23:39:29 - progress_bar.py[line:274] - INFO: epoch 019:      9 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=4861.3, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=63.4, ups=0.01, wpb=4861.3, bsz=1216, num_updates=5640, lr=5.26763e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=72533
2024-11-06 23:41:09 - progress_bar.py[line:274] - INFO: epoch 019:     19 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=510.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5650, lr=5.18267e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=72633
2024-11-06 23:42:49 - progress_bar.py[line:274] - INFO: epoch 019:     29 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=511.4, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5660, lr=5.09771e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=72734
2024-11-06 23:44:30 - progress_bar.py[line:274] - INFO: epoch 019:     39 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.405, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=507, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5670, lr=5.01274e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=39, gb_free=9.7, wall=72834
2024-11-06 23:46:14 - progress_bar.py[line:274] - INFO: epoch 019:     49 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=494, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5680, lr=4.92778e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=73, gb_free=9.7, wall=72938
2024-11-06 23:47:56 - progress_bar.py[line:274] - INFO: epoch 019:     59 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.407, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.61, wps=499, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5690, lr=4.84282e-06, gnorm=0.007, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=73041
2024-11-06 23:49:39 - progress_bar.py[line:274] - INFO: epoch 019:     69 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.4, ntokens=5117.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.55, wps=496.8, ups=0.1, wpb=5117.7, bsz=1280, num_updates=5700, lr=4.75786e-06, gnorm=0.007, clip=0, loss_scale=16384, train_wall=103, gb_free=9.6, wall=73144
2024-11-06 23:51:22 - progress_bar.py[line:274] - INFO: epoch 019:     79 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.54, wps=500.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5710, lr=4.6729e-06, gnorm=0.005, clip=0, loss_scale=16384, train_wall=102, gb_free=9.6, wall=73246
2024-11-06 23:53:04 - progress_bar.py[line:274] - INFO: epoch 019:     89 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.393, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=498.6, ups=0.1, wpb=5118, bsz=1280, num_updates=5720, lr=4.58794e-06, gnorm=0.007, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=73349
2024-11-06 23:54:47 - progress_bar.py[line:274] - INFO: epoch 019:     99 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.397, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=498.9, ups=0.1, wpb=5118, bsz=1280, num_updates=5730, lr=4.50297e-06, gnorm=0.006, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=73451
2024-11-06 23:56:30 - progress_bar.py[line:274] - INFO: epoch 019:    109 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=496.9, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5740, lr=4.41801e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=103, gb_free=9.6, wall=73554
2024-11-06 23:58:14 - progress_bar.py[line:274] - INFO: epoch 019:    119 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.49, wps=493.1, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5750, lr=4.33305e-06, gnorm=0.008, clip=0, loss_scale=16384, train_wall=104, gb_free=9.6, wall=73658
2024-11-06 23:59:57 - progress_bar.py[line:274] - INFO: epoch 019:    129 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.396, ntokens=5118.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.53, wps=497.1, ups=0.1, wpb=5118.4, bsz=1280, num_updates=5760, lr=4.24809e-06, gnorm=0.01, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=73761
2024-11-07 00:01:41 - progress_bar.py[line:274] - INFO: epoch 019:    139 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=492.7, ups=0.1, wpb=5118.8, bsz=1280, num_updates=5770, lr=4.16313e-06, gnorm=0.006, clip=0, loss_scale=16384, train_wall=104, gb_free=9.7, wall=73865
2024-11-07 00:03:24 - progress_bar.py[line:274] - INFO: epoch 019:    149 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.385, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=494.2, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5780, lr=4.07816e-06, gnorm=0.006, clip=0, loss_scale=16384, train_wall=103, gb_free=9.6, wall=73968
2024-11-07 00:05:08 - progress_bar.py[line:274] - INFO: epoch 019:    159 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=494.5, ups=0.1, wpb=5117.8, bsz=1280, num_updates=5790, lr=3.9932e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74072
2024-11-07 00:06:51 - progress_bar.py[line:274] - INFO: epoch 019:    169 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=494.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=5800, lr=3.90824e-06, gnorm=0.005, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74175
2024-11-07 00:08:34 - progress_bar.py[line:274] - INFO: epoch 019:    179 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.389, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=498.9, ups=0.1, wpb=5118, bsz=1280, num_updates=5810, lr=3.82328e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74278
2024-11-07 00:10:17 - progress_bar.py[line:274] - INFO: epoch 019:    189 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.401, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.56, wps=495.2, ups=0.1, wpb=5118.7, bsz=1280, num_updates=5820, lr=3.73832e-06, gnorm=0.007, clip=0, loss_scale=16384, train_wall=103, gb_free=9.6, wall=74381
2024-11-07 00:12:00 - progress_bar.py[line:274] - INFO: epoch 019:    199 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.404, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.59, wps=498.7, ups=0.1, wpb=5118.6, bsz=1280, num_updates=5830, lr=3.65336e-06, gnorm=0.008, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74484
2024-11-07 00:13:42 - progress_bar.py[line:274] - INFO: epoch 019:    209 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.392, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.5, wps=501.7, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5840, lr=3.56839e-06, gnorm=0.004, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=74586
2024-11-07 00:15:25 - progress_bar.py[line:274] - INFO: epoch 019:    219 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=495.3, ups=0.1, wpb=5118, bsz=1280, num_updates=5850, lr=3.48343e-06, gnorm=0.005, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74689
2024-11-07 00:17:08 - progress_bar.py[line:274] - INFO: epoch 019:    229 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.386, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=497.6, ups=0.1, wpb=5118, bsz=1280, num_updates=5860, lr=3.39847e-06, gnorm=0.006, clip=0, loss_scale=16384, train_wall=103, gb_free=9.7, wall=74792
2024-11-07 00:17:59 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8192.0
2024-11-07 00:19:01 - progress_bar.py[line:274] - INFO: epoch 019:    240 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.394, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.52, wps=451.8, ups=0.09, wpb=5118, bsz=1280, num_updates=5870, lr=3.31351e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=113, gb_free=9.7, wall=74905
2024-11-07 00:20:45 - progress_bar.py[line:274] - INFO: epoch 019:    250 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.388, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.47, wps=494.4, ups=0.1, wpb=5119.4, bsz=1280, num_updates=5880, lr=3.22855e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=75009
2024-11-07 00:22:28 - progress_bar.py[line:274] - INFO: epoch 019:    260 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.39, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.48, wps=493.6, ups=0.1, wpb=5117.9, bsz=1280, num_updates=5890, lr=3.14359e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=75113
2024-11-07 00:24:12 - progress_bar.py[line:274] - INFO: epoch 019:    270 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=494.8, ups=0.1, wpb=5118.2, bsz=1280, num_updates=5900, lr=3.05862e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=75216
2024-11-07 00:25:55 - progress_bar.py[line:274] - INFO: epoch 019:    280 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.387, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.46, wps=495.9, ups=0.1, wpb=5118.3, bsz=1280, num_updates=5910, lr=2.97366e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=75319
2024-11-07 00:27:38 - progress_bar.py[line:274] - INFO: epoch 019:    290 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.393, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.51, wps=497.6, ups=0.1, wpb=5118, bsz=1280, num_updates=5920, lr=2.8887e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.6, wall=75422
2024-11-07 00:29:21 - progress_bar.py[line:274] - INFO: epoch 019:    300 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=495.3, ups=0.1, wpb=5118.7, bsz=1280, num_updates=5930, lr=2.80374e-06, gnorm=0.003, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=75526
2024-11-07 00:31:04 - progress_bar.py[line:274] - INFO: epoch 019:    310 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.379, ntokens=5119.4, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=497.3, ups=0.1, wpb=5119.4, bsz=1280, num_updates=5940, lr=2.71878e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=75628
slice_id 6 seek offset 41730slice_id 7 seek offset 48685
slice_id 1 seek offset 6955

slice_id 3 seek offset 208652024-11-07 00:31:28 - train.py[line:449] - INFO: begin validation on "valid" subset

slice_id 2 seek offset 13910
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-07 00:38:48 - progress_bar.py[line:282] - INFO: epoch 019 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.403 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.58 | score 0.4972 | wps 507.2 | wpb 639.3 | bsz 159.9 | num_updates 5943 | best_score 0.4972
2024-11-07 00:38:48 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 5943 updates
2024-11-07 00:38:48 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 1 seek offset 50000
slice_id 7 seek offset 350000
slice_id 2 seek offset 100000
slice_id 3 seek offset 150000
slice_id 6 seek offset 300000
2024-11-07 00:39:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-07 00:41:43 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 19 @ 5943 updates, score 0.4972) (writing took 174.7957466370135 seconds)
2024-11-07 00:41:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 19 @ 5943 updates
2024-11-07 00:41:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-07 00:42:43 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-07 00:42:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 19 @ 5943 updates, score 0) (writing took 60.47484293600428 seconds)
2024-11-07 00:42:44 - train.py[line:336] - INFO: end of epoch 19 (average epoch stats below)
2024-11-07 00:42:44 - progress_bar.py[line:282] - INFO: epoch 019 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.391 | ntokens 5110.04 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.49 | wps 409.8 | ups 0.08 | wpb 5110 | bsz 1277.9 | num_updates 5943 | lr 2.69329e-06 | gnorm 0.006 | clip 0 | loss_scale 8192 | train_wall 2924 | gb_free 9.7 | wall 76328
2024-11-07 00:42:44 - trainer.py[line:639] - INFO: loading train data for epoch 20
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 00:42:46 - trainer.py[line:703] - INFO: begin training epoch 20
2024-11-07 00:42:46 - train.py[line:297] - INFO: Start iterating over samples
2024-11-07 00:43:59 - progress_bar.py[line:274] - INFO: epoch 020:      7 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=4861.8, nsentences=1216, sample_size=1216, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=62.8, ups=0.01, wpb=4861.8, bsz=1216, num_updates=5950, lr=2.63381e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=48, gb_free=9.7, wall=76403
2024-11-07 00:45:38 - progress_bar.py[line:274] - INFO: epoch 020:     17 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=516.9, ups=0.1, wpb=5118, bsz=1280, num_updates=5960, lr=2.54885e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=76502
2024-11-07 00:47:18 - progress_bar.py[line:274] - INFO: epoch 020:     27 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=511.3, ups=0.1, wpb=5118.5, bsz=1280, num_updates=5970, lr=2.46389e-06, gnorm=0.008, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=76602
2024-11-07 00:48:58 - progress_bar.py[line:274] - INFO: epoch 020:     37 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=511.3, ups=0.1, wpb=5118, bsz=1280, num_updates=5980, lr=2.37893e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=76702
2024-11-07 00:50:40 - progress_bar.py[line:274] - INFO: epoch 020:     47 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=500.1, ups=0.1, wpb=5118, bsz=1280, num_updates=5990, lr=2.29397e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=49, gb_free=9.7, wall=76804
2024-11-07 00:52:23 - progress_bar.py[line:274] - INFO: epoch 020:     57 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=498.6, ups=0.1, wpb=5118.5, bsz=1280, num_updates=6000, lr=2.20901e-06, gnorm=0.003, clip=0, loss_scale=8192, train_wall=80, gb_free=9.7, wall=76907
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 2 seek offset 13910
slice_id 7 seek offset 48685
slice_id 4 seek offset 27820
slice_id 1 seek offset 6955
slice_id 5 seek offset 34775
2024-11-07 00:52:23 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 3 seek offset 20865
slice_id 7 seek offset 48685
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 1 seek offset 6955
slice_id 0 seek offset 0
2024-11-07 00:59:55 - progress_bar.py[line:282] - INFO: epoch 020 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.405 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.59 | score 0.4979 | wps 494.4 | wpb 639.3 | bsz 159.9 | num_updates 6000 | best_score 0.4979
2024-11-07 00:59:55 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 6000 updates
2024-11-07 00:59:55 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_20_6000.pt
2024-11-07 01:00:05 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_20_6000.pt
2024-11-07 01:02:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_20_6000.pt (epoch 20 @ 6000 updates, score 0.4979) (writing took 182.08832770501613 seconds)
2024-11-07 01:04:27 - progress_bar.py[line:274] - INFO: epoch 020:     67 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5117.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=70.7, ups=0.01, wpb=5117.5, bsz=1280, num_updates=6010, lr=2.12404e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=77631
2024-11-07 01:06:07 - progress_bar.py[line:274] - INFO: epoch 020:     77 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.375, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=511.8, ups=0.1, wpb=5118.3, bsz=1280, num_updates=6020, lr=2.03908e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=77731
2024-11-07 01:07:51 - progress_bar.py[line:274] - INFO: epoch 020:     87 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=491.5, ups=0.1, wpb=5118.2, bsz=1280, num_updates=6030, lr=1.95412e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=59, gb_free=9.6, wall=77835
2024-11-07 01:09:37 - progress_bar.py[line:274] - INFO: epoch 020:     97 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=484.3, ups=0.09, wpb=5117.8, bsz=1280, num_updates=6040, lr=1.86916e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=77941
2024-11-07 01:11:20 - progress_bar.py[line:274] - INFO: epoch 020:    107 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=497.1, ups=0.1, wpb=5118.2, bsz=1280, num_updates=6050, lr=1.7842e-06, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=78044
2024-11-07 01:13:02 - progress_bar.py[line:274] - INFO: epoch 020:    117 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.3, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=499.4, ups=0.1, wpb=5118.3, bsz=1280, num_updates=6060, lr=1.69924e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=78146
2024-11-07 01:14:46 - progress_bar.py[line:274] - INFO: epoch 020:    127 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.383, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=494.5, ups=0.1, wpb=5118.6, bsz=1280, num_updates=6070, lr=1.61427e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.5, wall=78250
2024-11-07 01:16:28 - progress_bar.py[line:274] - INFO: epoch 020:    137 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=499.3, ups=0.1, wpb=5118.6, bsz=1280, num_updates=6080, lr=1.52931e-06, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=78352
2024-11-07 01:18:11 - progress_bar.py[line:274] - INFO: epoch 020:    147 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=498.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=6090, lr=1.44435e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=78455
2024-11-07 01:19:53 - progress_bar.py[line:274] - INFO: epoch 020:    157 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.37, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.34, wps=499.3, ups=0.1, wpb=5118.1, bsz=1280, num_updates=6100, lr=1.35939e-06, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=78557
2024-11-07 01:21:36 - progress_bar.py[line:274] - INFO: epoch 020:    167 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.374, ntokens=5118.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.37, wps=498.9, ups=0.1, wpb=5118.2, bsz=1280, num_updates=6110, lr=1.27443e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=78660
2024-11-07 01:23:19 - progress_bar.py[line:274] - INFO: epoch 020:    177 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.377, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.39, wps=494.9, ups=0.1, wpb=5117.9, bsz=1280, num_updates=6120, lr=1.18946e-06, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=78763
2024-11-07 01:25:03 - progress_bar.py[line:274] - INFO: epoch 020:    187 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.382, ntokens=5118.5, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.43, wps=493.2, ups=0.1, wpb=5118.5, bsz=1280, num_updates=6130, lr=1.1045e-06, gnorm=0.003, clip=0, loss_scale=8192, train_wall=104, gb_free=9.7, wall=78867
2024-11-07 01:26:46 - progress_bar.py[line:274] - INFO: epoch 020:    197 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5119, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=499.3, ups=0.1, wpb=5119, bsz=1280, num_updates=6140, lr=1.01954e-06, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=78970
2024-11-07 01:28:28 - progress_bar.py[line:274] - INFO: epoch 020:    207 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5117.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=497.2, ups=0.1, wpb=5117.8, bsz=1280, num_updates=6150, lr=9.34579e-07, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79073
2024-11-07 01:30:11 - progress_bar.py[line:274] - INFO: epoch 020:    217 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5118.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=500.6, ups=0.1, wpb=5118.1, bsz=1280, num_updates=6160, lr=8.49618e-07, gnorm=0.007, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=79175
2024-11-07 01:31:53 - progress_bar.py[line:274] - INFO: epoch 020:    227 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.371, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=498, ups=0.1, wpb=5118, bsz=1280, num_updates=6170, lr=7.64656e-07, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79278
2024-11-07 01:33:36 - progress_bar.py[line:274] - INFO: epoch 020:    237 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=497.3, ups=0.1, wpb=5118, bsz=1280, num_updates=6180, lr=6.79694e-07, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79381
2024-11-07 01:35:19 - progress_bar.py[line:274] - INFO: epoch 020:    247 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.378, ntokens=5119.2, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.4, wps=498.8, ups=0.1, wpb=5119.2, bsz=1280, num_updates=6190, lr=5.94732e-07, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79483
2024-11-07 01:37:02 - progress_bar.py[line:274] - INFO: epoch 020:    257 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.38, ntokens=5117.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.41, wps=497.7, ups=0.1, wpb=5117.9, bsz=1280, num_updates=6200, lr=5.09771e-07, gnorm=0.004, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79586
2024-11-07 01:38:44 - progress_bar.py[line:274] - INFO: epoch 020:    267 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=500, ups=0.1, wpb=5118, bsz=1280, num_updates=6210, lr=4.24809e-07, gnorm=0.005, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=79688
2024-11-07 01:40:28 - progress_bar.py[line:274] - INFO: epoch 020:    277 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.372, ntokens=5118.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.35, wps=494.5, ups=0.1, wpb=5118.8, bsz=1280, num_updates=6220, lr=3.39847e-07, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79792
2024-11-07 01:42:10 - progress_bar.py[line:274] - INFO: epoch 020:    287 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.384, ntokens=5118, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.44, wps=498.8, ups=0.1, wpb=5118, bsz=1280, num_updates=6230, lr=2.54885e-07, gnorm=0.005, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=79895
2024-11-07 01:43:52 - progress_bar.py[line:274] - INFO: epoch 020:    297 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.381, ntokens=5118.6, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.42, wps=501.1, ups=0.1, wpb=5118.6, bsz=1280, num_updates=6240, lr=1.69924e-07, gnorm=0.006, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=79997
2024-11-07 01:45:36 - progress_bar.py[line:274] - INFO: epoch 020:    307 / 313 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.373, ntokens=5119.1, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.36, wps=496.8, ups=0.1, wpb=5119.1, bsz=1280, num_updates=6250, lr=8.49618e-08, gnorm=0.006, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=80100
slice_id 7 seek offset 48685
slice_id 6 seek offset 41730
2024-11-07 01:46:30 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 2 seek offset 13910slice_id 0 seek offset 0

slice_id 1 seek offset 6955
slice_id 3 seek offset 20865
slice_id 4 seek offset 27820
slice_id 5 seek offset 34775
slice_id 3 seek offset 20865
slice_id 5 seek offset 34775
slice_id 6 seek offset 41730
slice_id 7 seek offset 48685
slice_id 1 seek offset 6955
slice_id 2 seek offset 13910
slice_id 4 seek offset 27820
slice_id 0 seek offset 0
2024-11-07 01:53:51 - progress_bar.py[line:282] - INFO: epoch 020 | valid on 'valid' subset | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.401 | ntokens 639.282 | nsentences 159.885 | sample_size 159.885 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.56 | score 0.4979 | wps 507.3 | wpb 639.3 | bsz 159.9 | num_updates 6256 | best_score 0.4979
2024-11-07 01:53:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 6256 updates
2024-11-07 01:53:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 4 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 3 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 7 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 1 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 5 row count 50000 total row count 400000
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 6 row count 50000 total row count 400000
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 2 row count 50000 total row count 400000
slice_id 5 seek offset 250000
slice_id 4 seek offset 200000
slice_id 2 seek offset 100000
slice_id 7 seek offset 350000
slice_id 3 seek offset 150000
slice_id 1 seek offset 50000
slice_id 6 seek offset 300000
2024-11-07 01:54:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-07 01:55:47 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 20 @ 6256 updates, score 0.4979) (writing took 116.78132794899284 seconds)
2024-11-07 01:55:47 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 20 @ 6256 updates
2024-11-07 01:55:47 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-07 01:56:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-07 01:56:48 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_manufact_80_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 20 @ 6256 updates, score 0) (writing took 60.429048808990046 seconds)
2024-11-07 01:56:48 - train.py[line:336] - INFO: end of epoch 20 (average epoch stats below)
2024-11-07 01:56:48 - progress_bar.py[line:282] - INFO: epoch 020 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.377 | ntokens 5110.07 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 10.39 | wps 359.9 | ups 0.07 | wpb 5110.1 | bsz 1278 | num_updates 6256 | lr 3.39847e-08 | gnorm 0.005 | clip 0 | loss_scale 8192 | train_wall 2701 | gb_free 9.7 | wall 80772
2024-11-07 01:56:48 - trainer.py[line:639] - INFO: loading train data for epoch 21
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_manufact_80.tsv slice_id 0 row count 50000 total row count 400000
slice_id 0 seek offset 0
2024-11-07 01:56:50 - train.py[line:206] - INFO: done training in 80760.2 seconds
