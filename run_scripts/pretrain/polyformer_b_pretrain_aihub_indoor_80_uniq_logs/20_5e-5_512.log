/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py:188: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  FutureWarning,
WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:23 - file_utils.py[line:39] - INFO: PyTorch version 1.13.1+cu116 available.
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 1): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 1
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 2): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 2
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 6): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 6
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 5): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 5
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 4): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 4
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 3): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 3
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 7): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - utils.py[line:258] - INFO: distributed init (rank 0): env://
2024-11-08 11:09:25 - utils.py[line:261] - INFO: Start init
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 7
2024-11-08 11:09:25 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:1 to store for rank: 0
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 0
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 6
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 2
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 5
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 4
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 3
single-machine distributed training is initialized.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - distributed_c10d.py[line:354] - INFO: Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 7
single-machine distributed training is initialized.
2024-11-08 11:09:25 - utils.py[line:274] - INFO: initialized host ip-172-31-9-178 as rank 1
single-machine distributed training is initialized.
2024-11-08 11:09:29 - train.py[line:77] - INFO: {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 10, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': 512, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '../../polyformer_module', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 8, 'distributed_num_procs': 8, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': True, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 8, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 20, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 1000, 'validate_after_updates': 0, 'fixed_validation_seed': 7, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 20, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 20, 'max_update': 0, 'stop_time_hours': 0.0, 'clip_norm': 1.0, 'sentence_avg': False, 'update_freq': [8], 'lr': [5e-05], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': './polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': True, 'reset_lr_scheduler': False, 'reset_meters': True, 'reset_optimizer': True, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': 1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'score', 'maximize_best_checkpoint_metric': True, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1, 'use_ema_weights_to_init_param': False, 'use_latest_weights_to_init_ema': False}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 8}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': Namespace(_name='polyformer_b', activation_fn='gelu', adam_betas='(0.9,0.999)', adam_eps=1e-08, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, add_type_embedding=True, all_gather_list_size=16384, amp=False, amp_batch_retries=2, amp_init_scale=128, amp_scale_window=None, arch='polyformer_b', attention_dropout=0.0, attn_scale_factor=2, azureml_logging=False, batch_size=20, batch_size_valid=20, best_checkpoint_metric='score', bf16=False, bpe=None, bpe_dir='../../utils/BPE', broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=1.0, cls_weight=0.0, code_dict_size=8192, code_image_size=128, code_layernorm_embedding=True, combine_valid_subsets=None, constraint_range=None, cpu=False, cpu_offload=False, criterion='adjust_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='../../datasets/pretrain/train_aihub_indoor_80.tsv,../../datasets/pretrain/val_aihub_indoor_80.tsv', data_buffer_size=10, dataset_impl=None, ddp_backend='pytorch_ddp', ddp_comm_hook='none', decoder_attention_heads=12, decoder_drop_path_rate=0.1, decoder_embed_dim=768, decoder_embed_path=None, decoder_ffn_embed_dim=3072, decoder_input_dim=768, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=True, decoder_normalize_before=True, decoder_output_dim=768, det_weight=1.0, device_id=0, disable_entangle=True, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=8, distributed_port=-1, distributed_rank=0, distributed_world_size=8, drop_worst_after=0, drop_worst_ratio=0.0, dropout=0.1, ema_decay=0.9999, ema_fp32=False, ema_seed_model=None, ema_start_update=0, ema_update_freq=1, empty_cache_freq=0, encoder_attention_heads=12, encoder_drop_path_rate=0.1, encoder_embed_dim=768, encoder_embed_path=None, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=True, encoder_normalize_before=True, end_learning_rate=0.0, entangle_position_embedding=False, eos=2, eval_acc=True, eval_args='{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', eval_print_samples=False, fast_stat_sync=False, find_unused_parameters=True, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=7, force_anneal=None, fp16=True, fp16_adam_stats=False, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=512, fp32_reduce_scatter=False, freeze_decoder_embedding=False, freeze_encoder_embedding=False, gen_subset='test', gradient_as_bucket_view=False, heartbeat_timeout=-1, ignore_eos=False, ignore_prefix_size=0, ignore_unused_valid_subsets=False, image_bucket_size=42, imagenet_default_mean_and_std=False, keep_best_checkpoints=1, keep_interval_updates=-1, keep_interval_updates_pattern=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=True, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_file=None, log_format='simple', log_interval=10, lr=[5e-05], lr_scheduler='polynomial_decay', max_epoch=20, max_image_size=512, max_source_positions=1024, max_src_length=80, max_target_positions=1024, max_tgt_length=420, max_tokens=None, max_tokens_valid=None, max_update=0, max_valid_steps=None, maximize_best_checkpoint_metric=True, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=True, no_last_checkpoints=False, no_progress_bar=False, no_reshard_after_forward=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=True, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=8, num_bins=64, num_shards=1, num_workers=0, on_cpu_convert_precision=False, optimizer='adam', optimizer_overrides='{}', out_index=3, pad=1, patch_image_size=512, patch_layernorm_embedding=True, patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, plasma_path='/tmp/plasma', pooler_activation_fn='tanh', pooler_classifier='mlp', pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, reg_alpha=1.0, relu_dropout=0.0, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=True, reset_logging=False, reset_lr_scheduler=False, reset_meters=True, reset_optimizer=True, resnet_drop_path_rate=0.0, restore_file='checkpoint_last.pt', sample_patch_num=196, save_dir='./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512', save_interval=1, save_interval_updates=1000, scale_attn=True, scale_fc=True, scale_heads=True, scale_resids=False, scoring='bleu', scst=False, scst_args='{}', seed=1, selected_cols='0,3,1,2', sentence_avg=False, shard_id=0, share_all_embeddings=True, share_decoder_input_output_embed=True, simul_type=None, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, stop_min_lr=-1.0, stop_time_hours=0, store_ema=False, suppress_crashes=False, sync_bn=False, task='refcoco_pretrain', tensorboard_logdir=None, threshold_loss_scale=None, token_bucket_size=256, tokenizer=None, total_num_update=1000000, tpu=False, train_subset='train', unk=3, update_freq=[8], use_bmuf=False, use_ema_weights_to_init_param=False, use_latest_weights_to_init_ema=False, use_old_adam=False, use_plasma_view=False, use_rdrop=False, use_sharded_state=False, user_dir='../../polyformer_module', uses_ema=False, valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=1000, vis_encoder_type='swin-base', wandb_project=None, warmup_ratio=0.06, warmup_updates=0, weight_decay=0.01, write_checkpoints_asynchronously=False, zero_sharding='none'), 'task': {'_name': 'refcoco_pretrain', 'data': '../../datasets/pretrain/train_aihub_indoor_80.tsv,../../datasets/pretrain/val_aihub_indoor_80.tsv', 'selected_cols': '0,3,1,2', 'bpe_dir': '../../utils/BPE', 'max_source_positions': 1024, 'max_target_positions': 1024, 'max_src_length': 80, 'max_tgt_length': 420, 'code_dict_size': 8192, 'patch_image_size': 512, 'num_bins': 64, 'imagenet_default_mean_and_std': False, 'constraint_range': None, 'eval_acc': True, 'eval_args': '{"beam":5,"min_len":2,"max_len_a":0,"max_len_b":2}', 'uses_ema': False, 'eval_print_samples': False, 'max_image_size': 512, 'scst': False, 'scst_args': '{}'}, 'criterion': {'_name': 'adjust_label_smoothed_cross_entropy', 'label_smoothing': 0.1, 'report_accuracy': False, 'det_weight': 1.0, 'cls_weight': 0.0, 'ignore_prefix_size': 0, 'ignore_eos': False, 'sentence_avg': False, 'drop_worst_ratio': 0.0, 'drop_worst_after': 0, 'use_rdrop': False, 'reg_alpha': 1.0, 'sample_patch_num': 196, 'constraint_range': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [5e-05]}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 0, 'warmup_ratio': 0.06, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000.0, 'lr': [5e-05]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'simul_type': None}
2024-11-08 11:09:29 - base_task.py[line:187] - INFO: source dictionary: 4100 types
2024-11-08 11:09:29 - base_task.py[line:188] - INFO: target dictionary: 4100 types
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/functional.py:504: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3190.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 11:09:41 - train.py[line:101] - INFO: PolyFormerModel(
  (encoder): TransformerEncoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (type_embedding): Embedding(2, 768)
    (embed_images): SwinTransformer(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 128, kernel_size=(4, 4), stride=(4, 4))
        (norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (layers): ModuleList(
        (0): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): Identity()
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=128, out_features=384, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=128, out_features=128, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.009)
              (norm2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=128, out_features=512, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=512, out_features=128, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=512, out_features=256, bias=False)
            (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          )
        )
        (1): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.017)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=256, out_features=768, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=256, out_features=256, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.026)
              (norm2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=256, out_features=1024, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=1024, out_features=256, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=1024, out_features=512, bias=False)
            (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
        (2): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.035)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.043)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (2): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.052)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (3): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.061)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (4): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.070)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (5): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.078)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (6): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.087)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (7): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.096)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (8): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.104)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (9): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.113)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (10): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.122)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (11): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.130)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (12): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.139)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (13): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.148)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (14): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.157)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (15): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.165)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (16): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.174)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (17): SwinTransformerBlock(
              (norm1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=512, out_features=1536, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=512, out_features=512, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.183)
              (norm2): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=512, out_features=2048, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=2048, out_features=512, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
          (downsample): PatchMerging(
            (reduction): Linear(in_features=2048, out_features=1024, bias=False)
            (norm): LayerNorm((2048,), eps=1e-05, elementwise_affine=True)
          )
        )
        (3): BasicLayer(
          (blocks): ModuleList(
            (0): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.191)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
            (1): SwinTransformerBlock(
              (norm1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (attn): WindowAttention(
                (qkv): Linear(in_features=1024, out_features=3072, bias=True)
                (attn_drop): Dropout(p=0.0, inplace=False)
                (proj): Linear(in_features=1024, out_features=1024, bias=True)
                (proj_drop): Dropout(p=0.0, inplace=False)
                (softmax): Softmax(dim=-1)
              )
              (drop_path): DropPath(drop_prob=0.200)
              (norm2): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
              (mlp): Mlp(
                (fc1): Linear(in_features=1024, out_features=4096, bias=True)
                (act): GELU(approximate='none')
                (fc2): Linear(in_features=4096, out_features=1024, bias=True)
                (drop): Dropout(p=0.0, inplace=False)
              )
            )
          )
        )
      )
      (norm3): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    )
    (image_proj): Linear(in_features=1024, out_features=768, bias=True)
    (patch_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout_module): FairseqDropout()
        (activation_dropout_module): FairseqDropout()
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
    (bert): XLMRobertaForMaskedLM(
      (roberta): XLMRobertaModel(
        (embeddings): XLMRobertaEmbeddings(
          (word_embeddings): Embedding(250002, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): XLMRobertaEncoder(
          (layer): ModuleList(
            (0): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (1): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (2): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (3): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (4): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (5): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (6): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (7): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (8): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (9): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (10): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (11): XLMRobertaLayer(
              (attention): XLMRobertaAttention(
                (self): XLMRobertaSelfAttention(
                  (query): Linear(in_features=768, out_features=768, bias=True)
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): Linear(in_features=768, out_features=768, bias=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): XLMRobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): XLMRobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): XLMRobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (lm_head): XLMRobertaLMHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (decoder): Linear(in_features=768, out_features=250002, bias=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (dropout_module): FairseqDropout()
    (embed_tokens): Embedding(4100, 768, padding_idx=1)
    (layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (embed_positions): Embedding(1026, 768)
    (embed_image_positions): Embedding(1765, 768)
    (pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (image_pos_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (self_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (self_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_q_linear): Linear(in_features=768, out_features=768, bias=True)
    (cross_pos_k_linear): Linear(in_features=768, out_features=768, bias=True)
    (code_layernorm_embedding): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): Identity()
      )
      (1): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.019999999552965164)
      )
      (2): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.03999999910593033)
      )
      (3): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.06000000238418579)
      )
      (4): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.07999999821186066)
      )
      (5): TransformerDecoderLayer(
        (dropout_module): FairseqDropout()
        (self_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (self_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (cross_attn_ln): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (activation_dropout_module): FairseqDropout()
        (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (dropout_module): FairseqDropout()
          (k_proj): Linear(in_features=768, out_features=768, bias=True)
          (v_proj): Linear(in_features=768, out_features=768, bias=True)
          (q_proj): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (ffn_layernorm): LayerNorm((3072,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (drop_path): DropPath(p=0.10000000149011612)
      )
    )
    (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
    (reg_head): MLP(
      (layers): ModuleList(
        (0): Linear(in_features=768, out_features=768, bias=True)
        (1): Linear(in_features=768, out_features=768, bias=True)
        (2): Linear(in_features=768, out_features=2, bias=True)
      )
    )
    (cls_head): Linear(in_features=768, out_features=3, bias=False)
    (token_rel_pos_table_list): ModuleList(
      (0): Embedding(511, 12)
      (1): Embedding(511, 12)
      (2): Embedding(511, 12)
      (3): Embedding(511, 12)
      (4): Embedding(511, 12)
      (5): Embedding(511, 12)
    )
    (image_rel_pos_table_list): ModuleList(
      (0): Embedding(6892, 12)
      (1): Embedding(6892, 12)
      (2): Embedding(6892, 12)
      (3): Embedding(6892, 12)
      (4): Embedding(6892, 12)
      (5): Embedding(6892, 12)
    )
  )
  (classification_heads): ModuleDict()
)
2024-11-08 11:09:41 - train.py[line:102] - INFO: task: RefcocoPretrainTask
2024-11-08 11:09:41 - train.py[line:103] - INFO: model: PolyFormerModel
2024-11-08 11:09:41 - train.py[line:104] - INFO: criterion: AdjustLabelSmoothedCrossEntropyCriterion
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 3 row count 10034 total row count 80273
2024-11-08 11:09:41 - train.py[line:108] - INFO: num. shared model params: 478,547,732 (num. trained: 478,547,732)
2024-11-08 11:09:41 - train.py[line:115] - INFO: num. expert model params: 0 (num. trained: 0)
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 2 row count 10034 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 0 row count 10035 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 1 row count 10034 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 7 row count 10034 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 6 row count 10034 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 4 row count 10034 total row count 80273
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/val_aihub_indoor_80.tsv slice_id 5 row count 10034 total row count 80273
2024-11-08 11:09:42 - distributed_c10d.py[line:319] - INFO: Added key: store_based_barrier_key:2 to store for rank: 0
2024-11-08 11:09:43 - distributed_c10d.py[line:354] - INFO: Rank 0: Completed store-based barrier for key:store_based_barrier_key:2 with 8 nodes.
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_tokens.weight <- decoder.embed_tokens.weight
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.1.downsample.reduction.bias
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- encoder.embed_images.layers.2.downsample.reduction.bias
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.embed_images.layers.0.downsample.reduction.bias <- decoder.cls_head.bias
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.roberta.embeddings.word_embeddings.weight <- encoder.bert.lm_head.decoder.weight
2024-11-08 11:09:43 - trainer.py[line:124] - INFO: detected shared parameter: encoder.bert.lm_head.bias <- encoder.bert.lm_head.decoder.bias
2024-11-08 11:09:45 - utils.py[line:759] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   0: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   1: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   2: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   3: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   4: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   5: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   6: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:765] - INFO: rank   7: capabilities =  8.0  ; total memory = 39.564 GB ; name = NVIDIA A100-SXM4-40GB                   
2024-11-08 11:09:45 - utils.py[line:767] - INFO: ***********************CUDA enviroments for all 8 workers***********************
2024-11-08 11:09:45 - train.py[line:145] - INFO: training on 8 devices (GPUs/TPUs)
2024-11-08 11:09:45 - train.py[line:151] - INFO: max tokens per device = None and max sentences per device = 20
2024-11-08 11:09:45 - trainer.py[line:458] - INFO: Preparing to load checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping


2024-11-08 11:09:45 - trainer.py[line:624] - INFO: No existing checkpoint found ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 11:09:45 - trainer.py[line:639] - INFO: loading train data for epoch 1
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping



file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torchvision/transforms/functional.py:443: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  "Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. "
slice_id 0 seek offset 0
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
2024-11-08 11:09:48 - trainer.py[line:703] - INFO: begin training epoch 1
2024-11-08 11:09:48 - train.py[line:297] - INFO: Start iterating over samples
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
slice_id 3 seek offset 140417
slice_id 1 seek offset 46806
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
slice_id 4 seek offset 187222
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
Total steps 5860, warmup steps 351, warmup_factor 0.002849002849002849
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/nn/functional.py:1967: UserWarning: nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.
  warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
loss_reg: 0.1312255859375 loss_cls: 0.0
loss_reg: 0.1416015625 loss_cls: 0.0
loss_reg: 0.1356201171875 loss_cls: 0.0
loss_reg: 0.136474609375 loss_cls: 0.0
loss_reg: 0.154052734375 loss_cls: 0.0
loss_reg: 0.123046875 loss_cls: 0.0
loss_reg: 0.1385498046875 loss_cls: 0.0
loss_reg: 0.1094970703125 loss_cls: 0.0
loss_reg: 0.1514892578125 loss_cls: 0.0
loss_reg: 0.14501953125 loss_cls: 0.0
loss_reg: 0.158203125 loss_cls: 0.0
loss_reg: 0.133056640625 loss_cls: 0.0
loss_reg: 0.141357421875 loss_cls: 0.0
loss_reg: 0.138916015625 loss_cls: 0.0
loss_reg: 0.13671875 loss_cls: 0.0
loss_reg: 0.1441650390625 loss_cls: 0.0
loss_reg: 0.1265869140625 loss_cls: 0.0
loss_reg: 0.1297607421875 loss_cls: 0.0
loss_reg: 0.150634765625 loss_cls: 0.0
loss_reg: 0.1339111328125 loss_cls: 0.0
loss_reg: 0.1492919921875 loss_cls: 0.0
loss_reg: 0.144775390625 loss_cls: 0.0
loss_reg: 0.12109375 loss_cls: 0.0
loss_reg: 0.1627197265625 loss_cls: 0.0
loss_reg: 0.16259765625 loss_cls: 0.0
loss_reg: 0.1580810546875 loss_cls: 0.0
loss_reg: 0.1439208984375 loss_cls: 0.0
loss_reg: 0.149169921875 loss_cls: 0.0
loss_reg: 0.1383056640625 loss_cls: 0.0
loss_reg: 0.1513671875 loss_cls: 0.0
loss_reg: 0.1368408203125 loss_cls: 0.0
loss_reg: 0.164306640625 loss_cls: 0.0
loss_reg: 0.1634521484375 loss_cls: 0.0
loss_reg: 0.1680908203125 loss_cls: 0.0
loss_reg: 0.1163330078125 loss_cls: 0.0
loss_reg: 0.1370849609375 loss_cls: 0.0
loss_reg: 0.1312255859375 loss_cls: 0.0
loss_reg: 0.1298828125 loss_cls: 0.0
loss_reg: 0.1409912109375 loss_cls: 0.0
loss_reg: 0.1683349609375 loss_cls: 0.0
loss_reg: 0.1341552734375 loss_cls: 0.0
loss_reg: 0.1390380859375 loss_cls: 0.0
loss_reg: 0.1392822265625 loss_cls: 0.0
loss_reg: 0.1292724609375 loss_cls: 0.0
loss_reg: 0.1265869140625 loss_cls: 0.0
loss_reg: 0.1846923828125 loss_cls: 0.0
loss_reg: 0.1549072265625 loss_cls: 0.0
loss_reg: 0.1331787109375 loss_cls: 0.0
loss_reg: 0.1434326171875 loss_cls: 0.0
loss_reg: 0.142333984375 loss_cls: 0.0
loss_reg: 0.15234375 loss_cls: 0.0
loss_reg: 0.1466064453125 loss_cls: 0.0
loss_reg: 0.1759033203125 loss_cls: 0.0
loss_reg: 0.15234375 loss_cls: 0.0
loss_reg: 0.1551513671875 loss_cls: 0.0
loss_reg: 0.143310546875 loss_cls: 0.0
loss_reg: 0.1549072265625 loss_cls: 0.0
loss_reg: 0.125 loss_cls: 0.0
loss_reg: 0.1302490234375 loss_cls: 0.0
loss_reg: 0.145751953125 loss_cls: 0.0
loss_reg: 0.1676025390625 loss_cls: 0.0
loss_reg: 0.1446533203125 loss_cls: 0.0
loss_reg: 0.1512451171875 loss_cls: 0.0
loss_reg: 0.171630859375 loss_cls: 0.0
2024-11-08 11:11:40 - progress_bar.py[line:274] - INFO: epoch 001:     10 / 293 loss=0.007, loss_v1=0, loss_v2=0, nll_loss=2.914, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=7.54, wps=490.1, ups=0.1, wpb=5120, bsz=1280, num_updates=10, lr=1.4245e-06, gnorm=0.019, clip=0, loss_scale=128, train_wall=43, gb_free=9.7, wall=115
2024-11-08 11:13:22 - progress_bar.py[line:274] - INFO: epoch 001:     20 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=2.892, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=7.42, wps=500.6, ups=0.1, wpb=5120, bsz=1280, num_updates=20, lr=2.849e-06, gnorm=0.009, clip=0, loss_scale=128, train_wall=51, gb_free=9.7, wall=217
2024-11-08 11:15:04 - progress_bar.py[line:274] - INFO: epoch 001:     30 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.014, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=8.08, wps=503.7, ups=0.1, wpb=5120, bsz=1280, num_updates=30, lr=4.2735e-06, gnorm=0.005, clip=0, loss_scale=128, train_wall=61, gb_free=9.7, wall=319
2024-11-08 11:16:46 - progress_bar.py[line:274] - INFO: epoch 001:     40 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.269, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=9.64, wps=501, ups=0.1, wpb=5119.9, bsz=1280, num_updates=40, lr=5.69801e-06, gnorm=0.004, clip=0, loss_scale=128, train_wall=71, gb_free=9.7, wall=421
2024-11-08 11:18:28 - progress_bar.py[line:274] - INFO: epoch 001:     50 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.429, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.77, wps=503.2, ups=0.1, wpb=5119.8, bsz=1280, num_updates=50, lr=7.12251e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=81, gb_free=9.7, wall=523
2024-11-08 11:20:10 - progress_bar.py[line:274] - INFO: epoch 001:     60 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.559, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.78, wps=502, ups=0.1, wpb=5119.9, bsz=1280, num_updates=60, lr=8.54701e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=86, gb_free=9.7, wall=625
2024-11-08 11:21:52 - progress_bar.py[line:274] - INFO: epoch 001:     70 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.549, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.7, wps=499.8, ups=0.1, wpb=5120, bsz=1280, num_updates=70, lr=9.97151e-06, gnorm=0.003, clip=0, loss_scale=128, train_wall=98, gb_free=9.7, wall=728
2024-11-08 11:23:35 - progress_bar.py[line:274] - INFO: epoch 001:     80 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.596, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=499.2, ups=0.1, wpb=5120, bsz=1280, num_updates=80, lr=1.1396e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=102, gb_free=9.7, wall=830
2024-11-08 11:25:15 - progress_bar.py[line:274] - INFO: epoch 001:     90 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.883, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=14.75, wps=505, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=90, lr=1.28205e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=100, gb_free=9.7, wall=931
2024-11-08 11:26:59 - progress_bar.py[line:274] - INFO: epoch 001:    100 / 293 loss=0.006, loss_v1=0, loss_v2=0, nll_loss=3.925, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=15.19, wps=495.8, ups=0.1, wpb=5120, bsz=1280, num_updates=100, lr=1.4245e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=1034
2024-11-08 11:28:43 - progress_bar.py[line:274] - INFO: epoch 001:    110 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.88, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=14.72, wps=491.5, ups=0.1, wpb=5120, bsz=1280, num_updates=110, lr=1.56695e-05, gnorm=0.01, clip=0, loss_scale=128, train_wall=104, gb_free=9.6, wall=1138
2024-11-08 11:30:27 - progress_bar.py[line:274] - INFO: epoch 001:    120 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.832, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=14.24, wps=492.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=120, lr=1.7094e-05, gnorm=0.01, clip=0, loss_scale=128, train_wall=104, gb_free=9.7, wall=1242
2024-11-08 11:32:10 - progress_bar.py[line:274] - INFO: epoch 001:    130 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.907, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=15, wps=494.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=130, lr=1.85185e-05, gnorm=0.008, clip=0, loss_scale=128, train_wall=104, gb_free=9.6, wall=1345
2024-11-08 11:33:55 - progress_bar.py[line:274] - INFO: epoch 001:    140 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.975, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=15.73, wps=488.1, ups=0.1, wpb=5120, bsz=1280, num_updates=140, lr=1.9943e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=105, gb_free=9.6, wall=1450
2024-11-08 11:35:39 - progress_bar.py[line:274] - INFO: epoch 001:    150 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.912, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=15.05, wps=494.2, ups=0.1, wpb=5120, bsz=1280, num_updates=150, lr=2.13675e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=104, gb_free=9.5, wall=1554
2024-11-08 11:37:22 - progress_bar.py[line:274] - INFO: epoch 001:    160 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.796, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.89, wps=495.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=160, lr=2.2792e-05, gnorm=0.007, clip=0, loss_scale=128, train_wall=103, gb_free=9.7, wall=1657
2024-11-08 11:39:06 - progress_bar.py[line:274] - INFO: epoch 001:    170 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.757, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.52, wps=492.4, ups=0.1, wpb=5120, bsz=1280, num_updates=170, lr=2.42165e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=104, gb_free=9.6, wall=1761
2024-11-08 11:40:49 - progress_bar.py[line:274] - INFO: epoch 001:    180 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.682, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.84, wps=501, ups=0.1, wpb=5120, bsz=1280, num_updates=180, lr=2.5641e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=102, gb_free=9.6, wall=1864
2024-11-08 11:42:30 - progress_bar.py[line:274] - INFO: epoch 001:    190 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.645, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.51, wps=505.6, ups=0.1, wpb=5120, bsz=1280, num_updates=190, lr=2.70655e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=100, gb_free=9.7, wall=1965
2024-11-08 11:44:11 - progress_bar.py[line:274] - INFO: epoch 001:    200 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.573, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.9, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=200, lr=2.849e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=74, gb_free=9.7, wall=2066
2024-11-08 11:45:53 - progress_bar.py[line:274] - INFO: epoch 001:    210 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.578, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=505.7, ups=0.1, wpb=5120, bsz=1280, num_updates=210, lr=2.99145e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=60, gb_free=9.7, wall=2168
2024-11-08 11:47:36 - progress_bar.py[line:274] - INFO: epoch 001:    220 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.497, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.29, wps=493.6, ups=0.1, wpb=5120, bsz=1280, num_updates=220, lr=3.1339e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=37, gb_free=9.7, wall=2271
2024-11-08 11:49:19 - progress_bar.py[line:274] - INFO: epoch 001:    230 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.458, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=497.6, ups=0.1, wpb=5120, bsz=1280, num_updates=230, lr=3.27635e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=2374
2024-11-08 11:51:05 - progress_bar.py[line:274] - INFO: epoch 001:    240 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.478, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=484.7, ups=0.09, wpb=5119.9, bsz=1280, num_updates=240, lr=3.4188e-05, gnorm=0.006, clip=0, loss_scale=128, train_wall=36, gb_free=9.7, wall=2480
2024-11-08 11:52:48 - progress_bar.py[line:274] - INFO: epoch 001:    250 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.49, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.24, wps=498, ups=0.1, wpb=5120, bsz=1280, num_updates=250, lr=3.56125e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=36, gb_free=9.7, wall=2583
2024-11-08 11:54:32 - progress_bar.py[line:274] - INFO: epoch 001:    260 / 293 loss=0.005, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.38, wps=490.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=260, lr=3.7037e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=36, gb_free=9.7, wall=2687
2024-11-08 11:56:12 - progress_bar.py[line:274] - INFO: epoch 001:    270 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.507, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.37, wps=510.6, ups=0.1, wpb=5120, bsz=1280, num_updates=270, lr=3.84615e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.6, wall=2787
2024-11-08 11:57:53 - progress_bar.py[line:274] - INFO: epoch 001:    280 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.444, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.88, wps=509.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=280, lr=3.9886e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=2888
2024-11-08 11:59:32 - progress_bar.py[line:274] - INFO: epoch 001:    290 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.512, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.41, wps=514.5, ups=0.1, wpb=5120, bsz=1280, num_updates=290, lr=4.13105e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=2987
slice_id 6 seek offset 60205slice_id 2 seek offset 20069

slice_id 3 seek offset 30103slice_id 5 seek offset 50171

slice_id 4 seek offset 40137
2024-11-08 11:59:58 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-08 12:10:49 - progress_bar.py[line:282] - INFO: epoch 001 | valid on 'valid' subset | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.486 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.2 | score 0.0094 | wps 494.2 | wpb 639.6 | bsz 159.9 | num_updates 293
2024-11-08 12:10:49 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 293 updates
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 12:10:49 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping




file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442


file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 5 seek offset 234027
2024-11-08 12:11:00 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 12:11:13 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 1 @ 293 updates, score 0.0094) (writing took 24.079178276995663 seconds)
2024-11-08 12:11:13 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 1 @ 293 updates
2024-11-08 12:11:13 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 12:12:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 12:12:44 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 1 @ 293 updates, score 0) (writing took 90.7150727820117 seconds)
2024-11-08 12:12:44 - train.py[line:336] - INFO: end of epoch 1 (average epoch stats below)
2024-11-08 12:12:44 - progress_bar.py[line:282] - INFO: epoch 001 | loss 0.005 | loss_v1 0 | loss_v2 0 | nll_loss 3.567 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.85 | wps 397.2 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 293 | lr 4.17379e-05 | gnorm 0.006 | clip 0 | loss_scale 128 | train_wall 2153 | gb_free 9.7 | wall 3779
2024-11-08 12:12:44 - trainer.py[line:639] - INFO: loading train data for epoch 2
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 12:12:47 - trainer.py[line:703] - INFO: begin training epoch 2
2024-11-08 12:12:47 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 12:14:06 - progress_bar.py[line:274] - INFO: epoch 002:      7 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.514, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=11.43, wps=56.4, ups=0.01, wpb=4928, bsz=1232, num_updates=300, lr=4.2735e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=34, gb_free=9.6, wall=3861
2024-11-08 12:15:47 - progress_bar.py[line:274] - INFO: epoch 002:     17 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=508.3, ups=0.1, wpb=5120, bsz=1280, num_updates=310, lr=4.41595e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=3962
2024-11-08 12:17:28 - progress_bar.py[line:274] - INFO: epoch 002:     27 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.431, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.78, wps=504.3, ups=0.1, wpb=5120, bsz=1280, num_updates=320, lr=4.5584e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4063
2024-11-08 12:19:11 - progress_bar.py[line:274] - INFO: epoch 002:     37 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.431, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.78, wps=497.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=330, lr=4.70085e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4166
2024-11-08 12:20:52 - progress_bar.py[line:274] - INFO: epoch 002:     47 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.422, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.72, wps=508, ups=0.1, wpb=5119.8, bsz=1280, num_updates=340, lr=4.8433e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4267
2024-11-08 12:22:35 - progress_bar.py[line:274] - INFO: epoch 002:     57 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.501, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.32, wps=496, ups=0.1, wpb=5119.9, bsz=1280, num_updates=350, lr=4.98575e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4370
2024-11-08 12:24:18 - progress_bar.py[line:274] - INFO: epoch 002:     67 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.582, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.98, wps=496.6, ups=0.1, wpb=5120, bsz=1280, num_updates=360, lr=4.99183e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4473
2024-11-08 12:26:01 - progress_bar.py[line:274] - INFO: epoch 002:     77 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=500.7, ups=0.1, wpb=5120, bsz=1280, num_updates=370, lr=4.98276e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4576
2024-11-08 12:27:43 - progress_bar.py[line:274] - INFO: epoch 002:     87 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=501.4, ups=0.1, wpb=5120, bsz=1280, num_updates=380, lr=4.97368e-05, gnorm=0.005, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4678
2024-11-08 12:29:26 - progress_bar.py[line:274] - INFO: epoch 002:     97 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.483, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.18, wps=495.1, ups=0.1, wpb=5120, bsz=1280, num_updates=390, lr=4.9646e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4781
2024-11-08 12:31:08 - progress_bar.py[line:274] - INFO: epoch 002:    107 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.617, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=12.27, wps=497.2, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=400, lr=4.95553e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4883
2024-11-08 12:32:51 - progress_bar.py[line:274] - INFO: epoch 002:    117 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.612, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.22, wps=499, ups=0.1, wpb=5120, bsz=1280, num_updates=410, lr=4.94645e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=4986
2024-11-08 12:34:34 - progress_bar.py[line:274] - INFO: epoch 002:    127 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.588, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.02, wps=498.6, ups=0.1, wpb=5119.8, bsz=1280, num_updates=420, lr=4.93738e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=5089
2024-11-08 12:36:16 - progress_bar.py[line:274] - INFO: epoch 002:    137 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.504, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.35, wps=498.6, ups=0.1, wpb=5120, bsz=1280, num_updates=430, lr=4.9283e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=5191
2024-11-08 12:37:59 - progress_bar.py[line:274] - INFO: epoch 002:    147 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.47, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.08, wps=496.1, ups=0.1, wpb=5120, bsz=1280, num_updates=440, lr=4.91922e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=5294
2024-11-08 12:39:42 - progress_bar.py[line:274] - INFO: epoch 002:    157 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.529, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.55, wps=500.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=450, lr=4.91015e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.6, wall=5397
2024-11-08 12:41:26 - progress_bar.py[line:274] - INFO: epoch 002:    167 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.609, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.21, wps=492.6, ups=0.1, wpb=5120, bsz=1280, num_updates=460, lr=4.90107e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=35, gb_free=9.7, wall=5501
2024-11-08 12:43:10 - progress_bar.py[line:274] - INFO: epoch 002:    177 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.652, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=492.8, ups=0.1, wpb=5120, bsz=1280, num_updates=470, lr=4.89199e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=35, gb_free=9.6, wall=5605
2024-11-08 12:44:53 - progress_bar.py[line:274] - INFO: epoch 002:    187 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.692, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.92, wps=497.6, ups=0.1, wpb=5120, bsz=1280, num_updates=480, lr=4.88292e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=36, gb_free=9.6, wall=5708
2024-11-08 12:46:38 - progress_bar.py[line:274] - INFO: epoch 002:    197 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.681, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.82, wps=486.3, ups=0.09, wpb=5120, bsz=1280, num_updates=490, lr=4.87384e-05, gnorm=0.003, clip=0, loss_scale=128, train_wall=49, gb_free=9.6, wall=5813
2024-11-08 12:48:20 - progress_bar.py[line:274] - INFO: epoch 002:    207 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.634, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.42, wps=501, ups=0.1, wpb=5120, bsz=1280, num_updates=500, lr=4.86477e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=52, gb_free=9.7, wall=5915
2024-11-08 12:50:02 - progress_bar.py[line:274] - INFO: epoch 002:    217 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=500.6, ups=0.1, wpb=5120, bsz=1280, num_updates=510, lr=4.85569e-05, gnorm=0.004, clip=0, loss_scale=128, train_wall=52, gb_free=9.6, wall=6017
2024-11-08 12:51:46 - progress_bar.py[line:274] - INFO: epoch 002:    227 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.596, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=495.2, ups=0.1, wpb=5120, bsz=1280, num_updates=520, lr=4.84661e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=52, gb_free=9.6, wall=6121
2024-11-08 12:53:27 - progress_bar.py[line:274] - INFO: epoch 002:    237 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.622, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.31, wps=504.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=530, lr=4.83754e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=55, gb_free=9.7, wall=6222
2024-11-08 12:55:10 - progress_bar.py[line:274] - INFO: epoch 002:    247 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.699, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.99, wps=496.5, ups=0.1, wpb=5120, bsz=1280, num_updates=540, lr=4.82846e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=62, gb_free=9.7, wall=6325
2024-11-08 12:56:53 - progress_bar.py[line:274] - INFO: epoch 002:    257 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.683, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.84, wps=496, ups=0.1, wpb=5119.9, bsz=1280, num_updates=550, lr=4.81939e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=64, gb_free=9.7, wall=6428
2024-11-08 12:58:36 - progress_bar.py[line:274] - INFO: epoch 002:    267 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.652, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=498.2, ups=0.1, wpb=5120, bsz=1280, num_updates=560, lr=4.81031e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=55, gb_free=9.7, wall=6531
2024-11-08 13:00:20 - progress_bar.py[line:274] - INFO: epoch 002:    277 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.691, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.92, wps=495, ups=0.1, wpb=5119.9, bsz=1280, num_updates=570, lr=4.80123e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=51, gb_free=9.7, wall=6635
2024-11-08 13:02:04 - progress_bar.py[line:274] - INFO: epoch 002:    287 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.678, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.8, wps=490.9, ups=0.1, wpb=5120, bsz=1280, num_updates=580, lr=4.79216e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=41, gb_free=9.7, wall=6739
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 3 seek offset 30103
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035slice_id 4 seek offset 40137

2024-11-08 13:03:01 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
2024-11-08 13:13:53 - progress_bar.py[line:282] - INFO: epoch 002 | valid on 'valid' subset | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.783 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.76 | score 0.0102 | wps 493.7 | wpb 639.6 | bsz 159.9 | num_updates 586 | best_score 0.0102
2024-11-08 13:13:53 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 586 updates
2024-11-08 13:13:53 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
2024-11-08 13:14:56 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 13:16:10 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 2 @ 586 updates, score 0.0102) (writing took 136.41594178800005 seconds)
2024-11-08 13:16:10 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 2 @ 586 updates
2024-11-08 13:16:10 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 13:17:39 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 13:17:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 2 @ 586 updates, score 0) (writing took 88.51031155104283 seconds)
2024-11-08 13:17:39 - train.py[line:336] - INFO: end of epoch 2 (average epoch stats below)
2024-11-08 13:17:39 - progress_bar.py[line:282] - INFO: epoch 002 | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.581 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.97 | wps 384.5 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 586 | lr 4.78671e-05 | gnorm 0.004 | clip 0 | loss_scale 256 | train_wall 1206 | gb_free 9.7 | wall 7674
2024-11-08 13:17:39 - trainer.py[line:639] - INFO: loading train data for epoch 3
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 13:17:42 - trainer.py[line:703] - INFO: begin training epoch 3
2024-11-08 13:17:42 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 13:18:26 - progress_bar.py[line:274] - INFO: epoch 003:      4 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.72, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.18, wps=50.2, ups=0.01, wpb=4928, bsz=1232, num_updates=590, lr=4.78308e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=34, gb_free=9.7, wall=7721
2024-11-08 13:20:07 - progress_bar.py[line:274] - INFO: epoch 003:     14 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=600, lr=4.77401e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=7822
2024-11-08 13:21:48 - progress_bar.py[line:274] - INFO: epoch 003:     24 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.699, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.99, wps=507.1, ups=0.1, wpb=5120, bsz=1280, num_updates=610, lr=4.76493e-05, gnorm=0.003, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=7923
2024-11-08 13:23:30 - progress_bar.py[line:274] - INFO: epoch 003:     34 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.67, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.73, wps=501.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=620, lr=4.75585e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8025
2024-11-08 13:25:10 - progress_bar.py[line:274] - INFO: epoch 003:     44 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=5072.7, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=12.69, wps=507.5, ups=0.1, wpb=5072.7, bsz=1268.2, num_updates=630, lr=4.74678e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=8125
2024-11-08 13:26:52 - progress_bar.py[line:274] - INFO: epoch 003:     54 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.07, wps=504.4, ups=0.1, wpb=5119.8, bsz=1280, num_updates=640, lr=4.7377e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8227
2024-11-08 13:28:35 - progress_bar.py[line:274] - INFO: epoch 003:     64 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.531, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=497.8, ups=0.1, wpb=5120, bsz=1280, num_updates=650, lr=4.72863e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8330
2024-11-08 13:30:17 - progress_bar.py[line:274] - INFO: epoch 003:     74 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.51, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=498.7, ups=0.1, wpb=5120, bsz=1280, num_updates=660, lr=4.71955e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8432
2024-11-08 13:31:58 - progress_bar.py[line:274] - INFO: epoch 003:     84 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.443, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.88, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=670, lr=4.71047e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8533
2024-11-08 13:33:41 - progress_bar.py[line:274] - INFO: epoch 003:     94 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=498.7, ups=0.1, wpb=5120, bsz=1280, num_updates=680, lr=4.7014e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8636
2024-11-08 13:35:23 - progress_bar.py[line:274] - INFO: epoch 003:    104 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.559, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.78, wps=499.7, ups=0.1, wpb=5120, bsz=1280, num_updates=690, lr=4.69232e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8738
2024-11-08 13:37:07 - progress_bar.py[line:274] - INFO: epoch 003:    114 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.556, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.76, wps=493.7, ups=0.1, wpb=5120, bsz=1280, num_updates=700, lr=4.68325e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8842
2024-11-08 13:38:49 - progress_bar.py[line:274] - INFO: epoch 003:    124 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.539, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.63, wps=500.2, ups=0.1, wpb=5119.8, bsz=1280, num_updates=710, lr=4.67417e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=8944
2024-11-08 13:40:30 - progress_bar.py[line:274] - INFO: epoch 003:    134 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=507.9, ups=0.1, wpb=5120, bsz=1280, num_updates=720, lr=4.66509e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9045
2024-11-08 13:42:11 - progress_bar.py[line:274] - INFO: epoch 003:    144 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.64, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.47, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=730, lr=4.65602e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9146
2024-11-08 13:43:52 - progress_bar.py[line:274] - INFO: epoch 003:    154 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.643, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.49, wps=505, ups=0.1, wpb=5120, bsz=1280, num_updates=740, lr=4.64694e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=9247
2024-11-08 13:45:34 - progress_bar.py[line:274] - INFO: epoch 003:    164 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=502, ups=0.1, wpb=5119.9, bsz=1280, num_updates=750, lr=4.63787e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9349
2024-11-08 13:47:16 - progress_bar.py[line:274] - INFO: epoch 003:    174 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.586, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.01, wps=505.4, ups=0.1, wpb=5120, bsz=1280, num_updates=760, lr=4.62879e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=9451
2024-11-08 13:48:57 - progress_bar.py[line:274] - INFO: epoch 003:    184 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.603, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=506.1, ups=0.1, wpb=5120, bsz=1280, num_updates=770, lr=4.61971e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9552
2024-11-08 13:50:38 - progress_bar.py[line:274] - INFO: epoch 003:    194 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.613, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.24, wps=506.1, ups=0.1, wpb=5120, bsz=1280, num_updates=780, lr=4.61064e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9653
2024-11-08 13:52:20 - progress_bar.py[line:274] - INFO: epoch 003:    204 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.607, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.18, wps=502.1, ups=0.1, wpb=5120, bsz=1280, num_updates=790, lr=4.60156e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=9755
2024-11-08 13:54:01 - progress_bar.py[line:274] - INFO: epoch 003:    214 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.582, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.97, wps=507.3, ups=0.1, wpb=5120, bsz=1280, num_updates=800, lr=4.59249e-05, gnorm=0.006, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9856
2024-11-08 13:55:42 - progress_bar.py[line:274] - INFO: epoch 003:    224 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.587, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.01, wps=507.4, ups=0.1, wpb=5120, bsz=1280, num_updates=810, lr=4.58341e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=9957
2024-11-08 13:57:23 - progress_bar.py[line:274] - INFO: epoch 003:    234 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=505.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=820, lr=4.57433e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=10058
2024-11-08 13:59:05 - progress_bar.py[line:274] - INFO: epoch 003:    244 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.92, wps=505.2, ups=0.1, wpb=5120, bsz=1280, num_updates=830, lr=4.56526e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=10160
2024-11-08 14:00:48 - progress_bar.py[line:274] - INFO: epoch 003:    254 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.92, wps=492.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=840, lr=4.55618e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=10263
2024-11-08 14:02:31 - progress_bar.py[line:274] - INFO: epoch 003:    264 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.551, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.72, wps=498.1, ups=0.1, wpb=5120, bsz=1280, num_updates=850, lr=4.5471e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=10366
2024-11-08 14:04:15 - progress_bar.py[line:274] - INFO: epoch 003:    274 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.586, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.01, wps=492.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=860, lr=4.53803e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=10470
2024-11-08 14:05:56 - progress_bar.py[line:274] - INFO: epoch 003:    284 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.596, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=505.7, ups=0.1, wpb=5120, bsz=1280, num_updates=870, lr=4.52895e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=10571
slice_id 2 seek offset 20069slice_id 3 seek offset 30103
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171

slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
2024-11-08 14:07:22 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-08 14:18:07 - progress_bar.py[line:282] - INFO: epoch 003 | valid on 'valid' subset | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.598 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.11 | score 0.0203 | wps 499.2 | wpb 639.6 | bsz 159.9 | num_updates 879 | best_score 0.0203
2024-11-08 14:18:07 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 879 updates
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping2024-11-08 14:18:07 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 6 seek offset 280832
2024-11-08 14:19:09 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 14:20:25 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 3 @ 879 updates, score 0.0203) (writing took 137.38341050897725 seconds)
2024-11-08 14:20:25 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 3 @ 879 updates
2024-11-08 14:20:25 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 14:21:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 14:21:53 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 3 @ 879 updates, score 0) (writing took 87.57235152099747 seconds)
2024-11-08 14:21:53 - train.py[line:336] - INFO: end of epoch 3 (average epoch stats below)
2024-11-08 14:21:53 - progress_bar.py[line:282] - INFO: epoch 003 | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.593 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.06 | wps 388.6 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 879 | lr 4.52078e-05 | gnorm 0.005 | clip 0 | loss_scale 256 | train_wall 1020 | gb_free 9.7 | wall 11528
2024-11-08 14:21:53 - trainer.py[line:639] - INFO: loading train data for epoch 4
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 14:21:55 - trainer.py[line:703] - INFO: begin training epoch 4
2024-11-08 14:21:55 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 14:22:09 - progress_bar.py[line:274] - INFO: epoch 004:      1 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.555, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=11.75, wps=50.7, ups=0.01, wpb=4928, bsz=1232, num_updates=880, lr=4.51988e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=34, gb_free=9.7, wall=11544
2024-11-08 14:23:50 - progress_bar.py[line:274] - INFO: epoch 004:     11 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.55, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.72, wps=506, ups=0.1, wpb=5120, bsz=1280, num_updates=890, lr=4.5108e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11645
2024-11-08 14:25:30 - progress_bar.py[line:274] - INFO: epoch 004:     21 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.531, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=509.9, ups=0.1, wpb=5120, bsz=1280, num_updates=900, lr=4.50172e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11745
2024-11-08 14:27:11 - progress_bar.py[line:274] - INFO: epoch 004:     31 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.485, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.2, wps=506.6, ups=0.1, wpb=5120, bsz=1280, num_updates=910, lr=4.49265e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=11846
2024-11-08 14:28:51 - progress_bar.py[line:274] - INFO: epoch 004:     41 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.475, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.12, wps=511.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=920, lr=4.48357e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.6, wall=11947
2024-11-08 14:30:30 - progress_bar.py[line:274] - INFO: epoch 004:     51 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.461, ntokens=5072.5, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=11.01, wps=514.2, ups=0.1, wpb=5072.5, bsz=1268.2, num_updates=930, lr=4.4745e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=12045
2024-11-08 14:32:09 - progress_bar.py[line:274] - INFO: epoch 004:     61 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.489, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.22, wps=517.2, ups=0.1, wpb=5120, bsz=1280, num_updates=940, lr=4.46542e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=12144
2024-11-08 14:33:51 - progress_bar.py[line:274] - INFO: epoch 004:     71 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.479, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.15, wps=504.1, ups=0.1, wpb=5120, bsz=1280, num_updates=950, lr=4.45634e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=53, gb_free=9.6, wall=12246
2024-11-08 14:35:32 - progress_bar.py[line:274] - INFO: epoch 004:     81 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.499, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.3, wps=503.5, ups=0.1, wpb=5120, bsz=1280, num_updates=960, lr=4.44727e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=73, gb_free=9.7, wall=12347
2024-11-08 14:37:14 - progress_bar.py[line:274] - INFO: epoch 004:     91 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=504, ups=0.1, wpb=5120, bsz=1280, num_updates=970, lr=4.43819e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=94, gb_free=9.7, wall=12449
2024-11-08 14:38:56 - progress_bar.py[line:274] - INFO: epoch 004:    101 / 293 loss=0.004, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=502.1, ups=0.1, wpb=5120, bsz=1280, num_updates=980, lr=4.42912e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=12551
2024-11-08 14:40:38 - progress_bar.py[line:274] - INFO: epoch 004:    111 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.512, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.41, wps=502.6, ups=0.1, wpb=5120, bsz=1280, num_updates=990, lr=4.42004e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=12653
2024-11-08 14:42:20 - progress_bar.py[line:274] - INFO: epoch 004:    121 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.485, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.2, wps=502.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1000, lr=4.41096e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=102, gb_free=9.7, wall=12755
slice_id 6 seek offset 60205
slice_id 3 seek offset 30103slice_id 5 seek offset 50171

slice_id 2 seek offset 20069
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
2024-11-08 14:42:20 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 3 seek offset 30103
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 1 seek offset 10035
slice_id 2 seek offset 20069
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
2024-11-08 14:53:22 - progress_bar.py[line:282] - INFO: epoch 004 | valid on 'valid' subset | loss 0.004 | loss_v1 0 | loss_v2 0 | nll_loss 3.522 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.48 | score 0.0245 | wps 486.9 | wpb 639.6 | bsz 159.9 | num_updates 1000 | best_score 0.0245
2024-11-08 14:53:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1000 updates
2024-11-08 14:53:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_4_1000.pt
2024-11-08 14:53:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_4_1000.pt
2024-11-08 14:56:19 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_4_1000.pt (epoch 4 @ 1000 updates, score 0.0245) (writing took 177.79848965199199 seconds)
2024-11-08 14:57:54 - progress_bar.py[line:274] - INFO: epoch 004:    131 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.474, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.11, wps=54.8, ups=0.01, wpb=5119.9, bsz=1280, num_updates=1010, lr=4.40189e-05, gnorm=0.004, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=13689
2024-11-08 14:59:36 - progress_bar.py[line:274] - INFO: epoch 004:    141 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.453, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.95, wps=499.1, ups=0.1, wpb=5120, bsz=1280, num_updates=1020, lr=4.39281e-05, gnorm=0.005, clip=0, loss_scale=256, train_wall=35, gb_free=9.7, wall=13791
2024-11-08 15:01:20 - progress_bar.py[line:274] - INFO: epoch 004:    151 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.432, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=10.79, wps=493.5, ups=0.1, wpb=5120, bsz=1280, num_updates=1030, lr=4.38374e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=37, gb_free=9.6, wall=13895
2024-11-08 15:03:05 - progress_bar.py[line:274] - INFO: epoch 004:    161 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.465, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.04, wps=486.3, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1040, lr=4.37466e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=59, gb_free=9.7, wall=14000
2024-11-08 15:04:50 - progress_bar.py[line:274] - INFO: epoch 004:    171 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.471, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.09, wps=487.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1050, lr=4.36558e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=84, gb_free=9.7, wall=14105
2024-11-08 15:06:39 - progress_bar.py[line:274] - INFO: epoch 004:    181 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.462, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.02, wps=472.9, ups=0.09, wpb=5120, bsz=1280, num_updates=1060, lr=4.35651e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=108, gb_free=9.7, wall=14214
2024-11-08 15:08:23 - progress_bar.py[line:274] - INFO: epoch 004:    191 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.513, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.42, wps=492.4, ups=0.1, wpb=5120, bsz=1280, num_updates=1070, lr=4.34743e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=14318
2024-11-08 15:10:06 - progress_bar.py[line:274] - INFO: epoch 004:    201 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.544, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.66, wps=494.8, ups=0.1, wpb=5120, bsz=1280, num_updates=1080, lr=4.33836e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=103, gb_free=9.6, wall=14421
2024-11-08 15:11:49 - progress_bar.py[line:274] - INFO: epoch 004:    211 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.517, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.45, wps=496.1, ups=0.1, wpb=5120, bsz=1280, num_updates=1090, lr=4.32928e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=14524
2024-11-08 15:13:32 - progress_bar.py[line:274] - INFO: epoch 004:    221 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.499, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.3, wps=499.6, ups=0.1, wpb=5120, bsz=1280, num_updates=1100, lr=4.3202e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=102, gb_free=9.7, wall=14627
2024-11-08 15:15:15 - progress_bar.py[line:274] - INFO: epoch 004:    231 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.526, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.52, wps=496.9, ups=0.1, wpb=5120, bsz=1280, num_updates=1110, lr=4.31113e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=14730
2024-11-08 15:17:02 - progress_bar.py[line:274] - INFO: epoch 004:    241 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.556, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.76, wps=476.5, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1120, lr=4.30205e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=107, gb_free=9.7, wall=14837
2024-11-08 15:18:49 - progress_bar.py[line:274] - INFO: epoch 004:    251 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.561, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.8, wps=480, ups=0.09, wpb=5120, bsz=1280, num_updates=1130, lr=4.29298e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=107, gb_free=9.7, wall=14944
2024-11-08 15:20:36 - progress_bar.py[line:274] - INFO: epoch 004:    261 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.532, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=479.9, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1140, lr=4.2839e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=107, gb_free=9.7, wall=15051
2024-11-08 15:22:23 - progress_bar.py[line:274] - INFO: epoch 004:    271 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.545, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.67, wps=477.2, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1150, lr=4.27482e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=107, gb_free=9.7, wall=15158
2024-11-08 15:24:09 - progress_bar.py[line:274] - INFO: epoch 004:    281 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.521, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.48, wps=484.4, ups=0.09, wpb=5120, bsz=1280, num_updates=1160, lr=4.26575e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=106, gb_free=9.7, wall=15264
2024-11-08 15:25:56 - progress_bar.py[line:274] - INFO: epoch 004:    291 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.506, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.36, wps=477.9, ups=0.09, wpb=5120, bsz=1280, num_updates=1170, lr=4.25667e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=107, gb_free=9.7, wall=15371
slice_id 2 seek offset 20069slice_id 6 seek offset 60205

slice_id 3 seek offset 30103
slice_id 5 seek offset 50171
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
2024-11-08 15:26:12 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 5 seek offset 50171
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-08 15:37:22 - progress_bar.py[line:282] - INFO: epoch 004 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.514 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.43 | score 0.0324 | wps 480.5 | wpb 639.6 | bsz 159.9 | num_updates 1172 | best_score 0.0324
2024-11-08 15:37:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1172 updates
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping2024-11-08 15:37:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
2024-11-08 15:38:23 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 15:39:37 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 4 @ 1172 updates, score 0.0324) (writing took 135.4999265439692 seconds)
2024-11-08 15:39:38 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 4 @ 1172 updates
2024-11-08 15:39:38 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 15:41:07 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 15:41:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 4 @ 1172 updates, score 0) (writing took 89.20401809201576 seconds)
2024-11-08 15:41:07 - train.py[line:336] - INFO: end of epoch 4 (average epoch stats below)
2024-11-08 15:41:07 - progress_bar.py[line:282] - INFO: epoch 004 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.503 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.33 | wps 315 | ups 0.06 | wpb 5111.8 | bsz 1278 | num_updates 1172 | lr 4.25486e-05 | gnorm 0.004 | clip 0 | loss_scale 512 | train_wall 2269 | gb_free 9.7 | wall 16282
2024-11-08 15:41:07 - trainer.py[line:639] - INFO: loading train data for epoch 5
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 15:41:10 - trainer.py[line:703] - INFO: begin training epoch 5
2024-11-08 15:41:10 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 15:42:39 - progress_bar.py[line:274] - INFO: epoch 005:      8 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.495, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=49.1, ups=0.01, wpb=4928, bsz=1232, num_updates=1180, lr=4.24759e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=44, gb_free=9.7, wall=16374
2024-11-08 15:44:22 - progress_bar.py[line:274] - INFO: epoch 005:     18 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.532, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.57, wps=494.8, ups=0.1, wpb=5120, bsz=1280, num_updates=1190, lr=4.23852e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16477
2024-11-08 15:46:08 - progress_bar.py[line:274] - INFO: epoch 005:     28 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.5, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.31, wps=485, ups=0.09, wpb=5120, bsz=1280, num_updates=1200, lr=4.22944e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16583
2024-11-08 15:47:53 - progress_bar.py[line:274] - INFO: epoch 005:     38 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=487.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1210, lr=4.22037e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.6, wall=16688
2024-11-08 15:49:38 - progress_bar.py[line:274] - INFO: epoch 005:     48 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.47, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.08, wps=487.2, ups=0.1, wpb=5119.8, bsz=1280, num_updates=1220, lr=4.21129e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=16793
2024-11-08 15:51:23 - progress_bar.py[line:274] - INFO: epoch 005:     58 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.487, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.21, wps=488, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1230, lr=4.20221e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.6, wall=16898
2024-11-08 15:53:08 - progress_bar.py[line:274] - INFO: epoch 005:     68 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.478, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.14, wps=486.8, ups=0.1, wpb=5120, bsz=1280, num_updates=1240, lr=4.19314e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17003
2024-11-08 15:54:53 - progress_bar.py[line:274] - INFO: epoch 005:     78 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.468, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.07, wps=486.8, ups=0.1, wpb=5120, bsz=1280, num_updates=1250, lr=4.18406e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17109
2024-11-08 15:56:39 - progress_bar.py[line:274] - INFO: epoch 005:     88 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.466, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.05, wps=487.2, ups=0.1, wpb=5120, bsz=1280, num_updates=1260, lr=4.17499e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17214
2024-11-08 15:58:24 - progress_bar.py[line:274] - INFO: epoch 005:     98 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.493, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.26, wps=484, ups=0.09, wpb=5120, bsz=1280, num_updates=1270, lr=4.16591e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17319
2024-11-08 16:00:10 - progress_bar.py[line:274] - INFO: epoch 005:    108 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.476, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.13, wps=485, ups=0.09, wpb=5120, bsz=1280, num_updates=1280, lr=4.15683e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17425
2024-11-08 16:01:53 - progress_bar.py[line:274] - INFO: epoch 005:    118 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.459, ntokens=5072.7, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=10.99, wps=491.4, ups=0.1, wpb=5072.7, bsz=1268.2, num_updates=1290, lr=4.14776e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17528
2024-11-08 16:03:37 - progress_bar.py[line:274] - INFO: epoch 005:    128 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.494, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.27, wps=491, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1300, lr=4.13868e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.6, wall=17632
2024-11-08 16:05:16 - progress_bar.py[line:274] - INFO: epoch 005:    138 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.531, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.56, wps=517.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1310, lr=4.12961e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17731
2024-11-08 16:06:56 - progress_bar.py[line:274] - INFO: epoch 005:    148 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.553, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.74, wps=513, ups=0.1, wpb=5120, bsz=1280, num_updates=1320, lr=4.12053e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=17831
2024-11-08 16:08:37 - progress_bar.py[line:274] - INFO: epoch 005:    158 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.539, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.62, wps=507.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1330, lr=4.11145e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=43, gb_free=9.7, wall=17932
2024-11-08 16:10:19 - progress_bar.py[line:274] - INFO: epoch 005:    168 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.578, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.94, wps=502.7, ups=0.1, wpb=5120, bsz=1280, num_updates=1340, lr=4.10238e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=71, gb_free=9.7, wall=18034
2024-11-08 16:12:00 - progress_bar.py[line:274] - INFO: epoch 005:    178 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=506.4, ups=0.1, wpb=5120, bsz=1280, num_updates=1350, lr=4.0933e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=91, gb_free=9.7, wall=18135
2024-11-08 16:13:43 - progress_bar.py[line:274] - INFO: epoch 005:    188 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.615, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.25, wps=497.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1360, lr=4.08423e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=103, gb_free=9.7, wall=18238
2024-11-08 16:15:28 - progress_bar.py[line:274] - INFO: epoch 005:    198 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=486, ups=0.09, wpb=5120, bsz=1280, num_updates=1370, lr=4.07515e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=18343
2024-11-08 16:17:12 - progress_bar.py[line:274] - INFO: epoch 005:    208 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.62, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.29, wps=493.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1380, lr=4.06607e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=104, gb_free=9.7, wall=18447
2024-11-08 16:18:59 - progress_bar.py[line:274] - INFO: epoch 005:    218 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=481.2, ups=0.09, wpb=5120, bsz=1280, num_updates=1390, lr=4.057e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=106, gb_free=9.7, wall=18554
2024-11-08 16:20:44 - progress_bar.py[line:274] - INFO: epoch 005:    228 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.519, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.46, wps=485.5, ups=0.09, wpb=5120, bsz=1280, num_updates=1400, lr=4.04792e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=105, gb_free=9.6, wall=18659
2024-11-08 16:22:29 - progress_bar.py[line:274] - INFO: epoch 005:    238 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.483, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.18, wps=486.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1410, lr=4.03885e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=18764
2024-11-08 16:24:15 - progress_bar.py[line:274] - INFO: epoch 005:    248 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.507, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.37, wps=485.7, ups=0.09, wpb=5120, bsz=1280, num_updates=1420, lr=4.02977e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=105, gb_free=9.7, wall=18870
2024-11-08 16:26:02 - progress_bar.py[line:274] - INFO: epoch 005:    258 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.518, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.45, wps=476.1, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1430, lr=4.02069e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=99, gb_free=9.7, wall=18977
2024-11-08 16:27:50 - progress_bar.py[line:274] - INFO: epoch 005:    268 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.536, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.6, wps=474.1, ups=0.09, wpb=5120, bsz=1280, num_updates=1440, lr=4.01162e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=60, gb_free=9.7, wall=19085
2024-11-08 16:29:35 - progress_bar.py[line:274] - INFO: epoch 005:    278 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.566, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=486.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1450, lr=4.00254e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=42, gb_free=9.6, wall=19190
2024-11-08 16:31:25 - progress_bar.py[line:274] - INFO: epoch 005:    288 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.584, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.99, wps=467, ups=0.09, wpb=5120, bsz=1280, num_updates=1460, lr=3.99347e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=36, gb_free=9.7, wall=19300
slice_id 6 seek offset 60205slice_id 2 seek offset 20069

slice_id 3 seek offset 30103
slice_id 5 seek offset 50171
2024-11-08 16:32:13 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 40137slice_id 1 seek offset 10035

slice_id 7 seek offset 70239
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-08 16:43:33 - progress_bar.py[line:282] - INFO: epoch 005 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.682 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.83 | score 0.0445 | wps 472.8 | wpb 639.6 | bsz 159.9 | num_updates 1465 | best_score 0.0445
2024-11-08 16:43:33 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1465 updates
2024-11-08 16:43:33 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
slice_id 3 seek offset 140417
slice_id 6 seek offset 280832
2024-11-08 16:44:35 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 16:45:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 5 @ 1465 updates, score 0.0445) (writing took 137.08062065095874 seconds)
2024-11-08 16:45:51 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 5 @ 1465 updates
2024-11-08 16:45:51 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 16:47:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 16:47:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 5 @ 1465 updates, score 0) (writing took 86.68235927599017 seconds)
2024-11-08 16:47:18 - train.py[line:336] - INFO: end of epoch 5 (average epoch stats below)
2024-11-08 16:47:18 - progress_bar.py[line:282] - INFO: epoch 005 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.527 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.52 | wps 377.2 | ups 0.07 | wpb 5111.8 | bsz 1278 | num_updates 1465 | lr 3.98893e-05 | gnorm 0.004 | clip 0 | loss_scale 512 | train_wall 1710 | gb_free 9.7 | wall 20253
2024-11-08 16:47:18 - trainer.py[line:639] - INFO: loading train data for epoch 6
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 16:47:21 - trainer.py[line:703] - INFO: begin training epoch 6
2024-11-08 16:47:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 16:48:16 - progress_bar.py[line:274] - INFO: epoch 006:      5 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.662, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=12.66, wps=48.7, ups=0.01, wpb=4928, bsz=1232, num_updates=1470, lr=3.98439e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=34, gb_free=9.7, wall=20311
2024-11-08 16:49:56 - progress_bar.py[line:274] - INFO: epoch 006:     15 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.663, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.67, wps=512.7, ups=0.1, wpb=5120, bsz=1280, num_updates=1480, lr=3.97531e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20411
2024-11-08 16:51:40 - progress_bar.py[line:274] - INFO: epoch 006:     25 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.673, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.76, wps=492.4, ups=0.1, wpb=5120, bsz=1280, num_updates=1490, lr=3.96624e-05, gnorm=0.005, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20515
2024-11-08 16:53:22 - progress_bar.py[line:274] - INFO: epoch 006:     35 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.633, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.4, wps=504.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1500, lr=3.95716e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20617
2024-11-08 16:55:01 - progress_bar.py[line:274] - INFO: epoch 006:     45 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.598, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.11, wps=514.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1510, lr=3.94808e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20716
2024-11-08 16:56:40 - progress_bar.py[line:274] - INFO: epoch 006:     55 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.6, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.12, wps=515.2, ups=0.1, wpb=5119.8, bsz=1280, num_updates=1520, lr=3.93901e-05, gnorm=0.003, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20816
2024-11-08 16:58:20 - progress_bar.py[line:274] - INFO: epoch 006:     65 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.83, wps=517, ups=0.1, wpb=5120, bsz=1280, num_updates=1530, lr=3.92993e-05, gnorm=0.004, clip=0, loss_scale=512, train_wall=35, gb_free=9.7, wall=20915
2024-11-08 16:59:58 - progress_bar.py[line:274] - INFO: epoch 006:     75 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.507, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.37, wps=517.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1540, lr=3.92086e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=21014
2024-11-08 17:01:41 - progress_bar.py[line:274] - INFO: epoch 006:     85 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.475, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.12, wps=501.4, ups=0.1, wpb=5120, bsz=1280, num_updates=1550, lr=3.91178e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=41, gb_free=9.6, wall=21116
2024-11-08 17:03:26 - progress_bar.py[line:274] - INFO: epoch 006:     95 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.518, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.46, wps=485.9, ups=0.09, wpb=5120, bsz=1280, num_updates=1560, lr=3.9027e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=59, gb_free=9.7, wall=21221
2024-11-08 17:05:12 - progress_bar.py[line:274] - INFO: epoch 006:    105 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.39, wps=480.8, ups=0.09, wpb=5120, bsz=1280, num_updates=1570, lr=3.89363e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=82, gb_free=9.7, wall=21328
2024-11-08 17:06:58 - progress_bar.py[line:274] - INFO: epoch 006:    115 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.516, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.44, wps=485.9, ups=0.09, wpb=5120, bsz=1280, num_updates=1580, lr=3.88455e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=97, gb_free=9.6, wall=21433
2024-11-08 17:08:45 - progress_bar.py[line:274] - INFO: epoch 006:    125 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=478.1, ups=0.09, wpb=5119.8, bsz=1280, num_updates=1590, lr=3.87548e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=107, gb_free=9.7, wall=21540
2024-11-08 17:10:29 - progress_bar.py[line:274] - INFO: epoch 006:    135 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=492.5, ups=0.1, wpb=5120, bsz=1280, num_updates=1600, lr=3.8664e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=104, gb_free=9.7, wall=21644
2024-11-08 17:12:10 - progress_bar.py[line:274] - INFO: epoch 006:    145 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.523, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=11.5, wps=503.2, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=1610, lr=3.85732e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=101, gb_free=9.6, wall=21745
2024-11-08 17:13:52 - progress_bar.py[line:274] - INFO: epoch 006:    155 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.537, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.61, wps=502.1, ups=0.1, wpb=5120, bsz=1280, num_updates=1620, lr=3.84825e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=102, gb_free=9.6, wall=21847
2024-11-08 17:15:33 - progress_bar.py[line:274] - INFO: epoch 006:    165 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.581, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.97, wps=503.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1630, lr=3.83917e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=21948
2024-11-08 17:17:15 - progress_bar.py[line:274] - INFO: epoch 006:    175 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.554, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.75, wps=505.1, ups=0.1, wpb=5120, bsz=1280, num_updates=1640, lr=3.8301e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=101, gb_free=9.7, wall=22050
2024-11-08 17:18:58 - progress_bar.py[line:274] - INFO: epoch 006:    185 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.616, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.26, wps=494.5, ups=0.1, wpb=5120, bsz=1280, num_updates=1650, lr=3.82102e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=103, gb_free=9.4, wall=22153
2024-11-08 17:20:43 - progress_bar.py[line:274] - INFO: epoch 006:    195 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.07, wps=487.6, ups=0.1, wpb=5120, bsz=1280, num_updates=1660, lr=3.81194e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=105, gb_free=9.7, wall=22258
2024-11-08 17:22:29 - progress_bar.py[line:274] - INFO: epoch 006:    205 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.509, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.38, wps=484.3, ups=0.09, wpb=5120, bsz=1280, num_updates=1670, lr=3.80287e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=106, gb_free=9.7, wall=22364
2024-11-08 17:24:15 - progress_bar.py[line:274] - INFO: epoch 006:    215 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.514, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.42, wps=484.2, ups=0.09, wpb=5120, bsz=1280, num_updates=1680, lr=3.79379e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=106, gb_free=9.7, wall=22470
2024-11-08 17:26:02 - progress_bar.py[line:274] - INFO: epoch 006:    225 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.579, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.95, wps=479.1, ups=0.09, wpb=5120, bsz=1280, num_updates=1690, lr=3.78472e-05, gnorm=0.006, clip=0, loss_scale=1024, train_wall=107, gb_free=9.7, wall=22577
2024-11-08 17:27:47 - progress_bar.py[line:274] - INFO: epoch 006:    235 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=485.1, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1700, lr=3.77564e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=105, gb_free=9.7, wall=22682
2024-11-08 17:29:33 - progress_bar.py[line:274] - INFO: epoch 006:    245 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.597, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.1, wps=485.6, ups=0.09, wpb=5120, bsz=1280, num_updates=1710, lr=3.76656e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=105, gb_free=9.7, wall=22788
2024-11-08 17:31:20 - progress_bar.py[line:274] - INFO: epoch 006:    255 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.612, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.22, wps=476.6, ups=0.09, wpb=5119.9, bsz=1280, num_updates=1720, lr=3.75749e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=107, gb_free=9.6, wall=22895
2024-11-08 17:33:06 - progress_bar.py[line:274] - INFO: epoch 006:    265 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.588, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.03, wps=484.1, ups=0.09, wpb=5120, bsz=1280, num_updates=1730, lr=3.74841e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=106, gb_free=9.7, wall=23001
2024-11-08 17:34:48 - progress_bar.py[line:274] - INFO: epoch 006:    275 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.547, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.69, wps=502.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1740, lr=3.73934e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=102, gb_free=9.7, wall=23103
2024-11-08 17:36:29 - progress_bar.py[line:274] - INFO: epoch 006:    285 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.555, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.75, wps=504.9, ups=0.1, wpb=5120, bsz=1280, num_updates=1750, lr=3.73026e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=101, gb_free=9.7, wall=23204
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069slice_id 6 seek offset 60205

slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
2024-11-08 17:37:46 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-08 17:48:40 - progress_bar.py[line:282] - INFO: epoch 006 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.536 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.6 | score 0.0596 | wps 492.2 | wpb 639.6 | bsz 159.9 | num_updates 1758 | best_score 0.0596
2024-11-08 17:48:40 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 1758 updates
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

2024-11-08 17:48:40 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-08 17:49:42 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 17:50:57 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 6 @ 1758 updates, score 0.0596) (writing took 137.57769548200304 seconds)
2024-11-08 17:50:58 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 6 @ 1758 updates
2024-11-08 17:50:58 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 17:52:28 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 17:52:28 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 6 @ 1758 updates, score 0) (writing took 89.83996329602087 seconds)
2024-11-08 17:52:28 - train.py[line:336] - INFO: end of epoch 6 (average epoch stats below)
2024-11-08 17:52:28 - progress_bar.py[line:282] - INFO: epoch 006 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.567 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.85 | wps 383.1 | ups 0.07 | wpb 5111.8 | bsz 1278 | num_updates 1758 | lr 3.723e-05 | gnorm 0.004 | clip 0 | loss_scale 1024 | train_wall 2387 | gb_free 9.7 | wall 24163
2024-11-08 17:52:28 - trainer.py[line:639] - INFO: loading train data for epoch 7
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 17:52:31 - trainer.py[line:703] - INFO: begin training epoch 7
2024-11-08 17:52:31 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 17:52:56 - progress_bar.py[line:274] - INFO: epoch 007:      2 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.543, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=11.65, wps=50, ups=0.01, wpb=4928, bsz=1232, num_updates=1760, lr=3.72118e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=84, gb_free=9.6, wall=24191
2024-11-08 17:54:37 - progress_bar.py[line:274] - INFO: epoch 007:     12 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.52, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.47, wps=503.2, ups=0.1, wpb=5120, bsz=1280, num_updates=1770, lr=3.71211e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24292
2024-11-08 17:56:19 - progress_bar.py[line:274] - INFO: epoch 007:     22 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.518, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.46, wps=505.4, ups=0.1, wpb=5120, bsz=1280, num_updates=1780, lr=3.70303e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24394
2024-11-08 17:58:00 - progress_bar.py[line:274] - INFO: epoch 007:     32 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.548, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.7, wps=506, ups=0.1, wpb=5120, bsz=1280, num_updates=1790, lr=3.69396e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24495
2024-11-08 17:59:42 - progress_bar.py[line:274] - INFO: epoch 007:     42 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.598, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.11, wps=503, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1800, lr=3.68488e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24597
2024-11-08 18:01:24 - progress_bar.py[line:274] - INFO: epoch 007:     52 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.648, ntokens=5119.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.53, wps=501, ups=0.1, wpb=5119.7, bsz=1280, num_updates=1810, lr=3.6758e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24699
2024-11-08 18:03:05 - progress_bar.py[line:274] - INFO: epoch 007:     62 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.668, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.71, wps=506.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1820, lr=3.66673e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24800
2024-11-08 18:04:46 - progress_bar.py[line:274] - INFO: epoch 007:     72 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.68, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.82, wps=507.1, ups=0.1, wpb=5120, bsz=1280, num_updates=1830, lr=3.65765e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=24901
2024-11-08 18:06:31 - progress_bar.py[line:274] - INFO: epoch 007:     82 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.646, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.52, wps=489, ups=0.1, wpb=5120, bsz=1280, num_updates=1840, lr=3.64858e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=25006
2024-11-08 18:08:16 - progress_bar.py[line:274] - INFO: epoch 007:     92 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.655, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.59, wps=484.1, ups=0.09, wpb=5120, bsz=1280, num_updates=1850, lr=3.6395e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.6, wall=25111
2024-11-08 18:10:02 - progress_bar.py[line:274] - INFO: epoch 007:    102 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=485.8, ups=0.09, wpb=5120, bsz=1280, num_updates=1860, lr=3.63042e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=25217
2024-11-08 18:11:47 - progress_bar.py[line:274] - INFO: epoch 007:    112 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.655, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.6, wps=488.6, ups=0.1, wpb=5120, bsz=1280, num_updates=1870, lr=3.62135e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.6, wall=25322
2024-11-08 18:13:28 - progress_bar.py[line:274] - INFO: epoch 007:    122 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.656, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.61, wps=505.5, ups=0.1, wpb=5119.8, bsz=1280, num_updates=1880, lr=3.61227e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=25423
2024-11-08 18:15:09 - progress_bar.py[line:274] - INFO: epoch 007:    132 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.632, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.4, wps=508.2, ups=0.1, wpb=5120, bsz=1280, num_updates=1890, lr=3.60319e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=25524
2024-11-08 18:16:51 - progress_bar.py[line:274] - INFO: epoch 007:    142 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=502.7, ups=0.1, wpb=5120, bsz=1280, num_updates=1900, lr=3.59412e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=38, gb_free=9.7, wall=25626
2024-11-08 18:18:31 - progress_bar.py[line:274] - INFO: epoch 007:    152 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.693, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.94, wps=508.3, ups=0.1, wpb=5120, bsz=1280, num_updates=1910, lr=3.58504e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=45, gb_free=9.7, wall=25726
2024-11-08 18:20:13 - progress_bar.py[line:274] - INFO: epoch 007:    162 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.693, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.94, wps=504.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=1920, lr=3.57597e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=46, gb_free=9.6, wall=25828
2024-11-08 18:21:53 - progress_bar.py[line:274] - INFO: epoch 007:    172 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.706, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.05, wps=508.5, ups=0.1, wpb=5120, bsz=1280, num_updates=1930, lr=3.56689e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=47, gb_free=9.7, wall=25928
2024-11-08 18:23:38 - progress_bar.py[line:274] - INFO: epoch 007:    182 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.678, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.8, wps=491.5, ups=0.1, wpb=5120, bsz=1280, num_updates=1940, lr=3.55781e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=54, gb_free=9.7, wall=26033
2024-11-08 18:25:25 - progress_bar.py[line:274] - INFO: epoch 007:    192 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.45, wps=477.8, ups=0.09, wpb=5120, bsz=1280, num_updates=1950, lr=3.54874e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=64, gb_free=9.7, wall=26140
2024-11-08 18:27:11 - progress_bar.py[line:274] - INFO: epoch 007:    202 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.652, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=479.8, ups=0.09, wpb=5120, bsz=1280, num_updates=1960, lr=3.53966e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=81, gb_free=9.7, wall=26246
2024-11-08 18:29:00 - progress_bar.py[line:274] - INFO: epoch 007:    212 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.682, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.84, wps=469.7, ups=0.09, wpb=5120, bsz=1280, num_updates=1970, lr=3.53059e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=106, gb_free=9.7, wall=26355
2024-11-08 18:30:43 - progress_bar.py[line:274] - INFO: epoch 007:    222 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.679, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.81, wps=498.2, ups=0.1, wpb=5120, bsz=1280, num_updates=1980, lr=3.52151e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=103, gb_free=9.7, wall=26458
2024-11-08 18:32:29 - progress_bar.py[line:274] - INFO: epoch 007:    232 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.674, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.77, wps=482.9, ups=0.09, wpb=5120, bsz=1280, num_updates=1990, lr=3.51243e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=106, gb_free=9.7, wall=26564
2024-11-08 18:34:16 - progress_bar.py[line:274] - INFO: epoch 007:    242 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=5072.7, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=12.69, wps=473, ups=0.09, wpb=5072.7, bsz=1268.2, num_updates=2000, lr=3.50336e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=107, gb_free=9.7, wall=26672
slice_id 3 seek offset 30103
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 2 seek offset 20069
slice_id 4 seek offset 40137
slice_id 1 seek offset 10035
2024-11-08 18:34:16 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
2024-11-08 18:45:23 - progress_bar.py[line:282] - INFO: epoch 007 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.664 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.68 | score 0.0892 | wps 483.2 | wpb 639.6 | bsz 159.9 | num_updates 2000 | best_score 0.0892
2024-11-08 18:45:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2000 updates
2024-11-08 18:45:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_7_2000.pt
2024-11-08 18:45:33 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_7_2000.pt
2024-11-08 18:48:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_7_2000.pt (epoch 7 @ 2000 updates, score 0.0892) (writing took 179.69753725995542 seconds)
2024-11-08 18:49:56 - progress_bar.py[line:274] - INFO: epoch 007:    252 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.627, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.35, wps=54.5, ups=0.01, wpb=5120, bsz=1280, num_updates=2010, lr=3.49428e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=27611
2024-11-08 18:51:38 - progress_bar.py[line:274] - INFO: epoch 007:    262 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.663, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.67, wps=504.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2020, lr=3.48521e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=27713
2024-11-08 18:53:23 - progress_bar.py[line:274] - INFO: epoch 007:    272 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=489, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2030, lr=3.47613e-05, gnorm=0.004, clip=0, loss_scale=1024, train_wall=35, gb_free=9.6, wall=27818
2024-11-08 18:55:04 - progress_bar.py[line:274] - INFO: epoch 007:    282 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.577, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.93, wps=504.4, ups=0.1, wpb=5120, bsz=1280, num_updates=2040, lr=3.46705e-05, gnorm=0.005, clip=0, loss_scale=1024, train_wall=35, gb_free=9.7, wall=27919
2024-11-08 18:56:45 - progress_bar.py[line:274] - INFO: epoch 007:    292 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=506.1, ups=0.1, wpb=5120, bsz=1280, num_updates=2050, lr=3.45798e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=28020
slice_id 6 seek offset 60205slice_id 2 seek offset 20069

slice_id 5 seek offset 50171
slice_id 3 seek offset 30103
2024-11-08 18:56:50 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
2024-11-08 19:07:52 - progress_bar.py[line:282] - INFO: epoch 007 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.569 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.87 | score 0.0923 | wps 486.7 | wpb 639.6 | bsz 159.9 | num_updates 2051 | best_score 0.0923
2024-11-08 19:07:52 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2051 updates
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
2024-11-08 19:07:52 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
slice_id 6 seek offset 280832
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
2024-11-08 19:08:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 19:10:07 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 7 @ 2051 updates, score 0.0923) (writing took 135.64124097296735 seconds)
2024-11-08 19:10:08 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 7 @ 2051 updates
2024-11-08 19:10:08 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 19:11:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 19:11:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 7 @ 2051 updates, score 0) (writing took 90.37095670599956 seconds)
2024-11-08 19:11:39 - train.py[line:336] - INFO: end of epoch 7 (average epoch stats below)
2024-11-08 19:11:39 - progress_bar.py[line:282] - INFO: epoch 007 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.64 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.46 | wps 315.3 | ups 0.06 | wpb 5111.8 | bsz 1278 | num_updates 2051 | lr 3.45707e-05 | gnorm 0.005 | clip 0 | loss_scale 2048 | train_wall 1434 | gb_free 9.7 | wall 28914
2024-11-08 19:11:39 - trainer.py[line:639] - INFO: loading train data for epoch 8
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 19:11:41 - trainer.py[line:703] - INFO: begin training epoch 8
2024-11-08 19:11:41 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 19:13:19 - progress_bar.py[line:274] - INFO: epoch 008:      9 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.616, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=12.26, wps=49.6, ups=0.01, wpb=4928, bsz=1232, num_updates=2060, lr=3.4489e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=34, gb_free=9.7, wall=29014
2024-11-08 19:14:59 - progress_bar.py[line:274] - INFO: epoch 008:     19 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.579, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=11.95, wps=510.7, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=2070, lr=3.43983e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=34, gb_free=9.7, wall=29114
2024-11-08 19:16:38 - progress_bar.py[line:274] - INFO: epoch 008:     29 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.61, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.21, wps=513.5, ups=0.1, wpb=5120, bsz=1280, num_updates=2080, lr=3.43075e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=35, gb_free=9.6, wall=29213
2024-11-08 19:18:18 - progress_bar.py[line:274] - INFO: epoch 008:     39 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.658, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.62, wps=515.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2090, lr=3.42167e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=29313
2024-11-08 19:19:57 - progress_bar.py[line:274] - INFO: epoch 008:     49 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.678, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.8, wps=515.4, ups=0.1, wpb=5119.8, bsz=1280, num_updates=2100, lr=3.4126e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=35, gb_free=9.6, wall=29412
2024-11-08 19:21:38 - progress_bar.py[line:274] - INFO: epoch 008:     59 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.661, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.65, wps=506.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2110, lr=3.40352e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=52, gb_free=9.7, wall=29513
2024-11-08 19:23:20 - progress_bar.py[line:274] - INFO: epoch 008:     69 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.622, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.31, wps=502.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2120, lr=3.39445e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=75, gb_free=9.7, wall=29615
2024-11-08 19:25:02 - progress_bar.py[line:274] - INFO: epoch 008:     79 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.619, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=503.5, ups=0.1, wpb=5120, bsz=1280, num_updates=2130, lr=3.38537e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=100, gb_free=9.7, wall=29717
2024-11-08 19:26:43 - progress_bar.py[line:274] - INFO: epoch 008:     89 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=503.7, ups=0.1, wpb=5120, bsz=1280, num_updates=2140, lr=3.37629e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=29818
2024-11-08 19:28:25 - progress_bar.py[line:274] - INFO: epoch 008:     99 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.687, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.88, wps=502.4, ups=0.1, wpb=5120, bsz=1280, num_updates=2150, lr=3.36722e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=102, gb_free=9.6, wall=29920
2024-11-08 19:30:07 - progress_bar.py[line:274] - INFO: epoch 008:    109 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.654, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.59, wps=504.3, ups=0.1, wpb=5120, bsz=1280, num_updates=2160, lr=3.35814e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=101, gb_free=9.7, wall=30022
2024-11-08 19:31:49 - progress_bar.py[line:274] - INFO: epoch 008:    119 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.625, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.34, wps=499.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2170, lr=3.34907e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30124
2024-11-08 19:33:31 - progress_bar.py[line:274] - INFO: epoch 008:    129 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.631, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.39, wps=502.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2180, lr=3.33999e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30226
2024-11-08 19:35:13 - progress_bar.py[line:274] - INFO: epoch 008:    139 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.641, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=501.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2190, lr=3.33091e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=102, gb_free=9.6, wall=30328
2024-11-08 19:36:55 - progress_bar.py[line:274] - INFO: epoch 008:    149 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.616, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.26, wps=500.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2200, lr=3.32184e-05, gnorm=0.005, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30431
2024-11-08 19:38:38 - progress_bar.py[line:274] - INFO: epoch 008:    159 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.628, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.36, wps=497.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2210, lr=3.31276e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30533
2024-11-08 19:40:23 - progress_bar.py[line:274] - INFO: epoch 008:    169 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.591, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.05, wps=490.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2220, lr=3.30368e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=104, gb_free=9.7, wall=30638
2024-11-08 19:42:06 - progress_bar.py[line:274] - INFO: epoch 008:    179 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.602, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=496.3, ups=0.1, wpb=5120, bsz=1280, num_updates=2230, lr=3.29461e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=103, gb_free=9.7, wall=30741
2024-11-08 19:43:48 - progress_bar.py[line:274] - INFO: epoch 008:    189 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.562, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.81, wps=499.5, ups=0.1, wpb=5120, bsz=1280, num_updates=2240, lr=3.28553e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30843
2024-11-08 19:45:30 - progress_bar.py[line:274] - INFO: epoch 008:    199 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.565, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.84, wps=504, ups=0.1, wpb=5120, bsz=1280, num_updates=2250, lr=3.27646e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=30945
2024-11-08 19:47:11 - progress_bar.py[line:274] - INFO: epoch 008:    209 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.586, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.01, wps=505.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2260, lr=3.26738e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=101, gb_free=9.7, wall=31046
2024-11-08 19:48:53 - progress_bar.py[line:274] - INFO: epoch 008:    219 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.574, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.91, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2270, lr=3.2583e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=31148
2024-11-08 19:50:35 - progress_bar.py[line:274] - INFO: epoch 008:    229 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.574, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.91, wps=503.4, ups=0.1, wpb=5120, bsz=1280, num_updates=2280, lr=3.24923e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=102, gb_free=9.6, wall=31250
2024-11-08 19:52:16 - progress_bar.py[line:274] - INFO: epoch 008:    239 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=503.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2290, lr=3.24015e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=31351
2024-11-08 19:53:58 - progress_bar.py[line:274] - INFO: epoch 008:    249 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.613, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.23, wps=505, ups=0.1, wpb=5120, bsz=1280, num_updates=2300, lr=3.23108e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=101, gb_free=9.7, wall=31453
2024-11-08 19:55:41 - progress_bar.py[line:274] - INFO: epoch 008:    259 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.576, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.92, wps=496.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2310, lr=3.222e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=103, gb_free=9.6, wall=31556
2024-11-08 19:57:22 - progress_bar.py[line:274] - INFO: epoch 008:    269 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.589, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.03, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2320, lr=3.21292e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=102, gb_free=9.7, wall=31658
2024-11-08 19:59:04 - progress_bar.py[line:274] - INFO: epoch 008:    279 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.63, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.38, wps=504.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2330, lr=3.20385e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=101, gb_free=9.7, wall=31759
2024-11-08 20:00:45 - progress_bar.py[line:274] - INFO: epoch 008:    289 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.557, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.77, wps=506.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2340, lr=3.19477e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=101, gb_free=9.7, wall=31860
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
2024-11-08 20:01:20 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 7 seek offset 70239
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-08 20:12:03 - progress_bar.py[line:282] - INFO: epoch 008 | valid on 'valid' subset | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.557 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 11.77 | score 0.2056 | wps 500.5 | wpb 639.6 | bsz 159.9 | num_updates 2344 | best_score 0.2056
2024-11-08 20:12:03 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2344 updates
2024-11-08 20:12:03 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappingfile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442


file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
2024-11-08 20:13:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 20:14:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 8 @ 2344 updates, score 0.2056) (writing took 138.1865677749738 seconds)
2024-11-08 20:14:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 8 @ 2344 updates
2024-11-08 20:14:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 20:15:51 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 20:15:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 8 @ 2344 updates, score 0) (writing took 89.20270830596564 seconds)
2024-11-08 20:15:51 - train.py[line:336] - INFO: end of epoch 8 (average epoch stats below)
2024-11-08 20:15:51 - progress_bar.py[line:282] - INFO: epoch 008 | loss 0.003 | loss_v1 0 | loss_v2 0 | nll_loss 3.613 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.23 | wps 388.7 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 2344 | lr 3.19114e-05 | gnorm 0.006 | clip 0 | loss_scale 2048 | train_wall 2574 | gb_free 9.7 | wall 32767
2024-11-08 20:15:51 - trainer.py[line:639] - INFO: loading train data for epoch 9
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 20:15:54 - trainer.py[line:703] - INFO: begin training epoch 9
2024-11-08 20:15:54 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 20:17:02 - progress_bar.py[line:274] - INFO: epoch 009:      6 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.601, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=12.13, wps=50.4, ups=0.01, wpb=4928, bsz=1232, num_updates=2350, lr=3.1857e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=56, gb_free=9.6, wall=32837
2024-11-08 20:18:45 - progress_bar.py[line:274] - INFO: epoch 009:     16 / 293 loss=0.003, loss_v1=0, loss_v2=0, nll_loss=3.636, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.43, wps=497.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2360, lr=3.17662e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=32940
2024-11-08 20:20:30 - progress_bar.py[line:274] - INFO: epoch 009:     26 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.623, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.32, wps=488.4, ups=0.1, wpb=5120, bsz=1280, num_updates=2370, lr=3.16754e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=33045
2024-11-08 20:22:15 - progress_bar.py[line:274] - INFO: epoch 009:     36 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.676, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=488, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2380, lr=3.15847e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=35, gb_free=9.8, wall=33150
2024-11-08 20:23:59 - progress_bar.py[line:274] - INFO: epoch 009:     46 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.658, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.63, wps=491, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2390, lr=3.14939e-05, gnorm=0.006, clip=0, loss_scale=2048, train_wall=35, gb_free=9.7, wall=33254
2024-11-08 20:25:43 - progress_bar.py[line:274] - INFO: epoch 009:     56 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.622, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.31, wps=489.1, ups=0.1, wpb=5119.8, bsz=1280, num_updates=2400, lr=3.14032e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=36, gb_free=9.7, wall=33358
2024-11-08 20:27:30 - progress_bar.py[line:274] - INFO: epoch 009:     66 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.66, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=480.2, ups=0.09, wpb=5120, bsz=1280, num_updates=2410, lr=3.13124e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=51, gb_free=9.7, wall=33465
2024-11-08 20:29:16 - progress_bar.py[line:274] - INFO: epoch 009:     76 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.618, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.28, wps=484, ups=0.09, wpb=5120, bsz=1280, num_updates=2420, lr=3.12216e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=64, gb_free=9.7, wall=33571
2024-11-08 20:31:02 - progress_bar.py[line:274] - INFO: epoch 009:     86 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.633, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.41, wps=480.6, ups=0.09, wpb=5120, bsz=1280, num_updates=2430, lr=3.11309e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=81, gb_free=9.7, wall=33677
2024-11-08 20:32:50 - progress_bar.py[line:274] - INFO: epoch 009:     96 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.654, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.58, wps=477.9, ups=0.09, wpb=5120, bsz=1280, num_updates=2440, lr=3.10401e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=106, gb_free=9.7, wall=33785
2024-11-08 20:34:36 - progress_bar.py[line:274] - INFO: epoch 009:    106 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=481.5, ups=0.09, wpb=5120, bsz=1280, num_updates=2450, lr=3.09494e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=106, gb_free=9.7, wall=33891
2024-11-08 20:36:23 - progress_bar.py[line:274] - INFO: epoch 009:    116 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.62, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.29, wps=476.2, ups=0.09, wpb=5120, bsz=1280, num_updates=2460, lr=3.08586e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=107, gb_free=9.6, wall=33998
2024-11-08 20:38:10 - progress_bar.py[line:274] - INFO: epoch 009:    126 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.668, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.71, wps=478.7, ups=0.09, wpb=5119.8, bsz=1280, num_updates=2470, lr=3.07678e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=107, gb_free=9.6, wall=34105
2024-11-08 20:39:57 - progress_bar.py[line:274] - INFO: epoch 009:    136 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.654, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.59, wps=478.9, ups=0.09, wpb=5120, bsz=1280, num_updates=2480, lr=3.06771e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=107, gb_free=9.7, wall=34212
2024-11-08 20:41:44 - progress_bar.py[line:274] - INFO: epoch 009:    146 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.643, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.49, wps=479.8, ups=0.09, wpb=5120, bsz=1280, num_updates=2490, lr=3.05863e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=107, gb_free=9.6, wall=34319
2024-11-08 20:43:31 - progress_bar.py[line:274] - INFO: epoch 009:    156 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.635, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.42, wps=479.6, ups=0.09, wpb=5119.9, bsz=1280, num_updates=2500, lr=3.04956e-05, gnorm=0.009, clip=0, loss_scale=2048, train_wall=107, gb_free=9.7, wall=34426
2024-11-08 20:45:17 - progress_bar.py[line:274] - INFO: epoch 009:    166 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.677, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.79, wps=482.5, ups=0.09, wpb=5120, bsz=1280, num_updates=2510, lr=3.04048e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=106, gb_free=9.6, wall=34532
2024-11-08 20:47:03 - progress_bar.py[line:274] - INFO: epoch 009:    176 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.707, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.06, wps=480.3, ups=0.09, wpb=5120, bsz=1280, num_updates=2520, lr=3.0314e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=107, gb_free=9.7, wall=34638
2024-11-08 20:48:51 - progress_bar.py[line:274] - INFO: epoch 009:    186 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.669, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.72, wps=475.6, ups=0.09, wpb=5120, bsz=1280, num_updates=2530, lr=3.02233e-05, gnorm=0.007, clip=0, loss_scale=2048, train_wall=108, gb_free=9.6, wall=34746
2024-11-08 20:50:38 - progress_bar.py[line:274] - INFO: epoch 009:    196 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.581, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.97, wps=480.5, ups=0.09, wpb=5120, bsz=1280, num_updates=2540, lr=3.01325e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=106, gb_free=9.7, wall=34853
2024-11-08 20:52:24 - progress_bar.py[line:274] - INFO: epoch 009:    206 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.624, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.33, wps=479.9, ups=0.09, wpb=5120, bsz=1280, num_updates=2550, lr=3.00417e-05, gnorm=0.008, clip=0, loss_scale=2048, train_wall=107, gb_free=9.7, wall=34959
2024-11-08 20:54:11 - progress_bar.py[line:274] - INFO: epoch 009:    216 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.587, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.02, wps=479, ups=0.09, wpb=5120, bsz=1280, num_updates=2560, lr=2.9951e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=107, gb_free=9.7, wall=35066
2024-11-08 20:55:55 - progress_bar.py[line:274] - INFO: epoch 009:    226 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.604, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=12.16, wps=487.1, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=2570, lr=2.98602e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=104, gb_free=9.7, wall=35170
2024-11-08 20:57:40 - progress_bar.py[line:274] - INFO: epoch 009:    236 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.658, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.62, wps=488.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2580, lr=2.97695e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=35275
2024-11-08 20:59:25 - progress_bar.py[line:274] - INFO: epoch 009:    246 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.721, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.19, wps=487.1, ups=0.1, wpb=5120, bsz=1280, num_updates=2590, lr=2.96787e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=105, gb_free=9.7, wall=35380
2024-11-08 21:01:12 - progress_bar.py[line:274] - INFO: epoch 009:    256 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.715, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.13, wps=479.1, ups=0.09, wpb=5119.9, bsz=1280, num_updates=2600, lr=2.95879e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=107, gb_free=9.7, wall=35487
2024-11-08 21:02:56 - progress_bar.py[line:274] - INFO: epoch 009:    266 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.735, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.31, wps=494.5, ups=0.1, wpb=5120, bsz=1280, num_updates=2610, lr=2.94972e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=103, gb_free=9.6, wall=35591
2024-11-08 21:04:40 - progress_bar.py[line:274] - INFO: epoch 009:    276 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.69, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.91, wps=489.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2620, lr=2.94064e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=105, gb_free=9.6, wall=35695
2024-11-08 21:06:25 - progress_bar.py[line:274] - INFO: epoch 009:    286 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.624, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.33, wps=488.4, ups=0.1, wpb=5120, bsz=1280, num_updates=2630, lr=2.93157e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=105, gb_free=9.6, wall=35800
slice_id 3 seek offset 30103
slice_id 1 seek offset 10035slice_id 6 seek offset 60205slice_id 2 seek offset 20069slice_id 5 seek offset 50171


slice_id 4 seek offset 40137

2024-11-08 21:07:33 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035
slice_id 6 seek offset 60205
slice_id 7 seek offset 70239
slice_id 5 seek offset 50171
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-08 21:18:17 - progress_bar.py[line:282] - INFO: epoch 009 | valid on 'valid' subset | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.678 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.8 | score 0.3325 | wps 499.3 | wpb 639.6 | bsz 159.9 | num_updates 2637 | best_score 0.3325
2024-11-08 21:18:17 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 2637 updates
2024-11-08 21:18:17 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-08 21:19:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 21:20:33 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 9 @ 2637 updates, score 0.3325) (writing took 135.963896723988 seconds)
2024-11-08 21:20:34 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 9 @ 2637 updates
2024-11-08 21:20:34 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 21:21:59 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 21:22:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 9 @ 2637 updates, score 0) (writing took 85.71011492499383 seconds)
2024-11-08 21:22:00 - train.py[line:336] - INFO: end of epoch 9 (average epoch stats below)
2024-11-08 21:22:00 - progress_bar.py[line:282] - INFO: epoch 009 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.65 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.55 | wps 377.5 | ups 0.07 | wpb 5111.8 | bsz 1278 | num_updates 2637 | lr 2.92521e-05 | gnorm 0.007 | clip 0 | loss_scale 4096 | train_wall 2580 | gb_free 9.7 | wall 36735
2024-11-08 21:22:00 - trainer.py[line:639] - INFO: loading train data for epoch 10
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 21:22:02 - trainer.py[line:703] - INFO: begin training epoch 10
2024-11-08 21:22:02 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 21:22:35 - progress_bar.py[line:274] - INFO: epoch 010:      3 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.676, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=50.8, ups=0.01, wpb=4928, bsz=1232, num_updates=2640, lr=2.92249e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=78, gb_free=9.6, wall=36770
2024-11-08 21:24:16 - progress_bar.py[line:274] - INFO: epoch 010:     13 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=508.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2650, lr=2.91341e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=36871
2024-11-08 21:25:56 - progress_bar.py[line:274] - INFO: epoch 010:     23 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.666, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.69, wps=509.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2660, lr=2.90434e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=36971
2024-11-08 21:27:37 - progress_bar.py[line:274] - INFO: epoch 010:     33 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.66, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=510, ups=0.1, wpb=5120, bsz=1280, num_updates=2670, lr=2.89526e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37072
2024-11-08 21:29:17 - progress_bar.py[line:274] - INFO: epoch 010:     43 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.678, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.8, wps=509.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2680, lr=2.88619e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37172
2024-11-08 21:30:58 - progress_bar.py[line:274] - INFO: epoch 010:     53 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.641, ntokens=5119.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=507.5, ups=0.1, wpb=5119.7, bsz=1280, num_updates=2690, lr=2.87711e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37273
2024-11-08 21:32:40 - progress_bar.py[line:274] - INFO: epoch 010:     63 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.63, wps=504.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2700, lr=2.86803e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37375
2024-11-08 21:34:20 - progress_bar.py[line:274] - INFO: epoch 010:     73 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.705, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.04, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=2710, lr=2.85896e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37475
2024-11-08 21:36:01 - progress_bar.py[line:274] - INFO: epoch 010:     83 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.711, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.09, wps=506.7, ups=0.1, wpb=5120, bsz=1280, num_updates=2720, lr=2.84988e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37576
2024-11-08 21:37:43 - progress_bar.py[line:274] - INFO: epoch 010:     93 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.693, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.93, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=2730, lr=2.84081e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37678
2024-11-08 21:39:24 - progress_bar.py[line:274] - INFO: epoch 010:    103 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.661, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.65, wps=507.3, ups=0.1, wpb=5120, bsz=1280, num_updates=2740, lr=2.83173e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37779
2024-11-08 21:41:05 - progress_bar.py[line:274] - INFO: epoch 010:    113 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=2750, lr=2.82265e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37880
2024-11-08 21:42:45 - progress_bar.py[line:274] - INFO: epoch 010:    123 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.617, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.27, wps=509.9, ups=0.1, wpb=5119.8, bsz=1280, num_updates=2760, lr=2.81358e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=37980
2024-11-08 21:44:25 - progress_bar.py[line:274] - INFO: epoch 010:    133 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.642, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.48, wps=510.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2770, lr=2.8045e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38080
2024-11-08 21:46:06 - progress_bar.py[line:274] - INFO: epoch 010:    143 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.646, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.52, wps=507.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2780, lr=2.79543e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38181
2024-11-08 21:47:46 - progress_bar.py[line:274] - INFO: epoch 010:    153 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.668, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.71, wps=512.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2790, lr=2.78635e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38281
2024-11-08 21:49:27 - progress_bar.py[line:274] - INFO: epoch 010:    163 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.647, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.53, wps=504.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2800, lr=2.77727e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38382
2024-11-08 21:51:09 - progress_bar.py[line:274] - INFO: epoch 010:    173 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.661, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.65, wps=505.6, ups=0.1, wpb=5120, bsz=1280, num_updates=2810, lr=2.7682e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=38484
2024-11-08 21:52:50 - progress_bar.py[line:274] - INFO: epoch 010:    183 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.651, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=506, ups=0.1, wpb=5120, bsz=1280, num_updates=2820, lr=2.75912e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=42, gb_free=9.7, wall=38585
2024-11-08 21:54:31 - progress_bar.py[line:274] - INFO: epoch 010:    193 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.659, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.64, wps=505.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2830, lr=2.75005e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=43, gb_free=9.7, wall=38686
2024-11-08 21:56:13 - progress_bar.py[line:274] - INFO: epoch 010:    203 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.605, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.17, wps=500.3, ups=0.1, wpb=5120, bsz=1280, num_updates=2840, lr=2.74097e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=55, gb_free=9.7, wall=38789
2024-11-08 21:57:56 - progress_bar.py[line:274] - INFO: epoch 010:    213 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.598, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.11, wps=498.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2850, lr=2.73189e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=70, gb_free=9.7, wall=38891
2024-11-08 21:59:37 - progress_bar.py[line:274] - INFO: epoch 010:    223 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.63, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.38, wps=507.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2860, lr=2.72282e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=85, gb_free=9.7, wall=38992
2024-11-08 22:01:19 - progress_bar.py[line:274] - INFO: epoch 010:    233 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.611, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.22, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=2870, lr=2.71374e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=93, gb_free=9.7, wall=39094
2024-11-08 22:03:01 - progress_bar.py[line:274] - INFO: epoch 010:    243 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.637, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.44, wps=502.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2880, lr=2.70467e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=39196
2024-11-08 22:04:42 - progress_bar.py[line:274] - INFO: epoch 010:    253 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.622, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.31, wps=505.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2890, lr=2.69559e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=101, gb_free=9.6, wall=39297
2024-11-08 22:06:24 - progress_bar.py[line:274] - INFO: epoch 010:    263 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.651, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.56, wps=503.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2900, lr=2.68651e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=39399
2024-11-08 22:08:05 - progress_bar.py[line:274] - INFO: epoch 010:    273 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.626, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.35, wps=503.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2910, lr=2.67744e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=102, gb_free=9.7, wall=39500
2024-11-08 22:09:47 - progress_bar.py[line:274] - INFO: epoch 010:    283 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.596, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=503.2, ups=0.1, wpb=5120, bsz=1280, num_updates=2920, lr=2.66836e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=102, gb_free=9.8, wall=39602
2024-11-08 22:11:21 - progress_bar.py[line:274] - INFO: epoch 010:    293 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.598, ntokens=4880.8, nsentences=1220.2, sample_size=1220.2, sample_size_v1=0, sample_size_v2=0, ppl=12.11, wps=519, ups=0.11, wpb=4880.8, bsz=1220.2, num_updates=2930, lr=2.65928e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=94, gb_free=9.7, wall=39696
slice_id 2 seek offset 20069slice_id 6 seek offset 60205
slice_id 1 seek offset 10035

slice_id 3 seek offset 30103
slice_id 5 seek offset 50171
slice_id 4 seek offset 40137
2024-11-08 22:11:21 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 7 seek offset 70239slice_id 0 seek offset 0

slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-08 22:22:06 - progress_bar.py[line:282] - INFO: epoch 010 | valid on 'valid' subset | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.606 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.18 | score 0.4294 | wps 499.1 | wpb 639.6 | bsz 159.9 | num_updates 2930 | best_score 0.4294
2024-11-08 22:22:06 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 2930 updates
2024-11-08 22:22:06 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
2024-11-08 22:23:07 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 22:24:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 10 @ 2930 updates, score 0.4294) (writing took 135.85975153598702 seconds)
2024-11-08 22:24:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 10 @ 2930 updates
2024-11-08 22:24:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 22:25:50 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 22:25:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 10 @ 2930 updates, score 0) (writing took 87.23465608200058 seconds)
2024-11-08 22:25:50 - train.py[line:336] - INFO: end of epoch 10 (average epoch stats below)
2024-11-08 22:25:50 - progress_bar.py[line:282] - INFO: epoch 010 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.649 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.54 | wps 391 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 2930 | lr 2.65928e-05 | gnorm 0.008 | clip 0 | loss_scale 4096 | train_wall 1590 | gb_free 9.7 | wall 40565
2024-11-08 22:25:50 - trainer.py[line:639] - INFO: loading train data for epoch 11
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 22:25:52 - trainer.py[line:703] - INFO: begin training epoch 11
2024-11-08 22:25:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 22:27:35 - progress_bar.py[line:274] - INFO: epoch 011:     10 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.624, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.33, wps=52.5, ups=0.01, wpb=5120, bsz=1280, num_updates=2940, lr=2.65021e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=40670
2024-11-08 22:29:16 - progress_bar.py[line:274] - INFO: epoch 011:     20 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.592, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.06, wps=507.9, ups=0.1, wpb=5120, bsz=1280, num_updates=2950, lr=2.64113e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=40771
2024-11-08 22:30:57 - progress_bar.py[line:274] - INFO: epoch 011:     30 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.594, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.07, wps=506.5, ups=0.1, wpb=5120, bsz=1280, num_updates=2960, lr=2.63206e-05, gnorm=0.007, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=40872
2024-11-08 22:32:38 - progress_bar.py[line:274] - INFO: epoch 011:     40 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.595, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=510.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2970, lr=2.62298e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=40973
2024-11-08 22:34:19 - progress_bar.py[line:274] - INFO: epoch 011:     50 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.593, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.07, wps=507.5, ups=0.1, wpb=5119.8, bsz=1280, num_updates=2980, lr=2.6139e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=41074
2024-11-08 22:36:00 - progress_bar.py[line:274] - INFO: epoch 011:     60 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.622, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.31, wps=505.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=2990, lr=2.60483e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=41175
2024-11-08 22:37:40 - progress_bar.py[line:274] - INFO: epoch 011:     70 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.639, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.46, wps=510.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3000, lr=2.59575e-05, gnorm=0.011, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=41275
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
2024-11-08 22:37:40 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 0 seek offset 0
2024-11-08 22:48:31 - progress_bar.py[line:282] - INFO: epoch 011 | valid on 'valid' subset | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.714 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.12 | score 0.4229 | wps 494.6 | wpb 639.6 | bsz 159.9 | num_updates 3000 | best_score 0.4294
2024-11-08 22:48:31 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 3000 updates
2024-11-08 22:48:31 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_11_3000.pt
2024-11-08 22:48:42 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_11_3000.pt
2024-11-08 22:49:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_11_3000.pt (epoch 11 @ 3000 updates, score 0.4229) (writing took 79.77499774500029 seconds)
2024-11-08 22:51:21 - progress_bar.py[line:274] - INFO: epoch 011:     80 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.651, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.57, wps=62.4, ups=0.01, wpb=5120, bsz=1280, num_updates=3010, lr=2.58668e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=42096
2024-11-08 22:53:02 - progress_bar.py[line:274] - INFO: epoch 011:     90 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.604, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.16, wps=503.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3020, lr=2.5776e-05, gnorm=0.01, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=42197
2024-11-08 22:54:44 - progress_bar.py[line:274] - INFO: epoch 011:    100 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.603, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.15, wps=501.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3030, lr=2.56852e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=42299
2024-11-08 22:56:25 - progress_bar.py[line:274] - INFO: epoch 011:    110 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.58, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.96, wps=510.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3040, lr=2.55945e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=42400
2024-11-08 22:58:05 - progress_bar.py[line:274] - INFO: epoch 011:    120 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.56, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=11.79, wps=511.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3050, lr=2.55037e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.7, wall=42500
2024-11-08 22:59:45 - progress_bar.py[line:274] - INFO: epoch 011:    130 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.596, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.09, wps=509.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3060, lr=2.5413e-05, gnorm=0.009, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=42600
2024-11-08 23:01:26 - progress_bar.py[line:274] - INFO: epoch 011:    140 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.662, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.66, wps=510.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3070, lr=2.53222e-05, gnorm=0.008, clip=0, loss_scale=4096, train_wall=35, gb_free=9.6, wall=42701
2024-11-08 23:03:06 - progress_bar.py[line:274] - INFO: epoch 011:    150 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.658, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.62, wps=511.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3080, lr=2.52314e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=35, gb_free=9.5, wall=42801
2024-11-08 23:04:46 - progress_bar.py[line:274] - INFO: epoch 011:    160 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.669, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.72, wps=508.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3090, lr=2.51407e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=42901
2024-11-08 23:06:28 - progress_bar.py[line:274] - INFO: epoch 011:    170 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.674, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.76, wps=505.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3100, lr=2.50499e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=35, gb_free=9.6, wall=43003
2024-11-08 23:08:09 - progress_bar.py[line:274] - INFO: epoch 011:    180 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.653, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.58, wps=504, ups=0.1, wpb=5120, bsz=1280, num_updates=3110, lr=2.49592e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=42, gb_free=9.6, wall=43104
2024-11-08 23:09:51 - progress_bar.py[line:274] - INFO: epoch 011:    190 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.668, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.71, wps=502, ups=0.1, wpb=5120, bsz=1280, num_updates=3120, lr=2.48684e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=49, gb_free=9.7, wall=43206
2024-11-08 23:11:33 - progress_bar.py[line:274] - INFO: epoch 011:    200 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.648, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.54, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3130, lr=2.47776e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=62, gb_free=9.7, wall=43308
2024-11-08 23:13:14 - progress_bar.py[line:274] - INFO: epoch 011:    210 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.682, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.83, wps=503.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3140, lr=2.46869e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=73, gb_free=9.7, wall=43409
2024-11-08 23:14:55 - progress_bar.py[line:274] - INFO: epoch 011:    220 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.742, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.38, wps=508.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3150, lr=2.45961e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=78, gb_free=9.7, wall=43510
2024-11-08 23:16:36 - progress_bar.py[line:274] - INFO: epoch 011:    230 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.71, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.09, wps=506, ups=0.1, wpb=5120, bsz=1280, num_updates=3160, lr=2.45054e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=84, gb_free=9.7, wall=43611
2024-11-08 23:18:18 - progress_bar.py[line:274] - INFO: epoch 011:    240 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.757, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.52, wps=505.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3170, lr=2.44146e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=91, gb_free=9.7, wall=43713
2024-11-08 23:19:59 - progress_bar.py[line:274] - INFO: epoch 011:    250 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=507.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3180, lr=2.43238e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=93, gb_free=9.7, wall=43814
2024-11-08 23:21:39 - progress_bar.py[line:274] - INFO: epoch 011:    260 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.717, ntokens=5072.7, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.15, wps=507.8, ups=0.1, wpb=5072.7, bsz=1268.2, num_updates=3190, lr=2.42331e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=95, gb_free=9.7, wall=43914
2024-11-08 23:23:20 - progress_bar.py[line:274] - INFO: epoch 011:    270 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.703, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.02, wps=506.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3200, lr=2.41423e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=44015
2024-11-08 23:25:01 - progress_bar.py[line:274] - INFO: epoch 011:    280 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.712, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.1, wps=506.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3210, lr=2.40516e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=44116
2024-11-08 23:26:42 - progress_bar.py[line:274] - INFO: epoch 011:    290 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.674, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.77, wps=506.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3220, lr=2.39608e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=44217
slice_id 6 seek offset 60205slice_id 2 seek offset 20069slice_id 3 seek offset 30103


slice_id 1 seek offset 10035
slice_id 4 seek offset 40137
2024-11-08 23:27:07 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 7 seek offset 70239
slice_id 5 seek offset 50171
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-08 23:37:46 - progress_bar.py[line:282] - INFO: epoch 011 | valid on 'valid' subset | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.734 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.31 | score 0.4956 | wps 503.3 | wpb 639.6 | bsz 159.9 | num_updates 3223 | best_score 0.4956
2024-11-08 23:37:46 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 3223 updates
2024-11-08 23:37:46 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
2024-11-08 23:38:47 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-08 23:40:04 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 11 @ 3223 updates, score 0.4956) (writing took 137.5874072209699 seconds)
2024-11-08 23:40:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 11 @ 3223 updates
2024-11-08 23:40:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 23:41:30 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-08 23:41:31 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 11 @ 3223 updates, score 0) (writing took 85.88708943297388 seconds)
2024-11-08 23:41:31 - train.py[line:336] - INFO: end of epoch 11 (average epoch stats below)
2024-11-08 23:41:31 - progress_bar.py[line:282] - INFO: epoch 011 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.653 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.58 | wps 329.9 | ups 0.06 | wpb 5111.8 | bsz 1278 | num_updates 3223 | lr 2.39336e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 1587 | gb_free 9.7 | wall 45106
2024-11-08 23:41:31 - trainer.py[line:639] - INFO: loading train data for epoch 12
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-08 23:41:33 - trainer.py[line:703] - INFO: begin training epoch 12
2024-11-08 23:41:33 - train.py[line:297] - INFO: Start iterating over samples
2024-11-08 23:42:45 - progress_bar.py[line:274] - INFO: epoch 012:      7 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=51.1, ups=0.01, wpb=4928, bsz=1232, num_updates=3230, lr=2.387e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=49, gb_free=9.6, wall=45181
2024-11-08 23:44:24 - progress_bar.py[line:274] - INFO: epoch 012:     17 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.41, wps=518.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3240, lr=2.37793e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=45279
2024-11-08 23:46:03 - progress_bar.py[line:274] - INFO: epoch 012:     27 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.741, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=520.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3250, lr=2.36885e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=45378
2024-11-08 23:47:42 - progress_bar.py[line:274] - INFO: epoch 012:     37 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.752, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=518.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3260, lr=2.35977e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=45477
2024-11-08 23:49:20 - progress_bar.py[line:274] - INFO: epoch 012:     47 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.719, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=520.5, ups=0.1, wpb=5119.8, bsz=1280, num_updates=3270, lr=2.3507e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=45575
2024-11-08 23:51:01 - progress_bar.py[line:274] - INFO: epoch 012:     57 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.757, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.52, wps=507.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3280, lr=2.34162e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=53, gb_free=9.7, wall=45676
2024-11-08 23:52:42 - progress_bar.py[line:274] - INFO: epoch 012:     67 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.772, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.66, wps=507.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3290, lr=2.33255e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=76, gb_free=9.7, wall=45777
2024-11-08 23:54:23 - progress_bar.py[line:274] - INFO: epoch 012:     77 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.741, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=3300, lr=2.32347e-05, gnorm=0.007, clip=0, loss_scale=8192, train_wall=95, gb_free=9.7, wall=45878
2024-11-08 23:56:03 - progress_bar.py[line:274] - INFO: epoch 012:     87 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=509.7, ups=0.1, wpb=5120, bsz=1280, num_updates=3310, lr=2.31439e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=100, gb_free=9.7, wall=45978
2024-11-08 23:57:44 - progress_bar.py[line:274] - INFO: epoch 012:     97 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=506.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3320, lr=2.30532e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46079
2024-11-08 23:59:26 - progress_bar.py[line:274] - INFO: epoch 012:    107 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.748, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.44, wps=505.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3330, lr=2.29624e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46181
2024-11-09 00:01:07 - progress_bar.py[line:274] - INFO: epoch 012:    117 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.75, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=505.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3340, lr=2.28717e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46282
2024-11-09 00:02:48 - progress_bar.py[line:274] - INFO: epoch 012:    127 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=508, ups=0.1, wpb=5119.8, bsz=1280, num_updates=3350, lr=2.27809e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46383
2024-11-09 00:04:29 - progress_bar.py[line:274] - INFO: epoch 012:    137 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.741, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=506.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3360, lr=2.26901e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46484
2024-11-09 00:06:09 - progress_bar.py[line:274] - INFO: epoch 012:    147 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.721, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.18, wps=508.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3370, lr=2.25994e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46584
2024-11-09 00:07:50 - progress_bar.py[line:274] - INFO: epoch 012:    157 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.702, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.02, wps=506.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3380, lr=2.25086e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=46685
2024-11-09 00:09:31 - progress_bar.py[line:274] - INFO: epoch 012:    167 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.695, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.95, wps=507.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3390, lr=2.24179e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=46786
2024-11-09 00:11:13 - progress_bar.py[line:274] - INFO: epoch 012:    177 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.737, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.33, wps=505.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3400, lr=2.23271e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=46888
2024-11-09 00:12:53 - progress_bar.py[line:274] - INFO: epoch 012:    187 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.695, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=12.95, wps=505.8, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=3410, lr=2.22363e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=100, gb_free=9.6, wall=46988
2024-11-09 00:14:34 - progress_bar.py[line:274] - INFO: epoch 012:    197 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.699, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.99, wps=508.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3420, lr=2.21456e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=47089
2024-11-09 00:16:15 - progress_bar.py[line:274] - INFO: epoch 012:    207 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.725, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.22, wps=505.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3430, lr=2.20548e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=101, gb_free=9.7, wall=47190
2024-11-09 00:17:56 - progress_bar.py[line:274] - INFO: epoch 012:    217 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.723, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.21, wps=506.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3440, lr=2.19641e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=47291
2024-11-09 00:19:37 - progress_bar.py[line:274] - INFO: epoch 012:    227 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.717, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.15, wps=505.3, ups=0.1, wpb=5120, bsz=1280, num_updates=3450, lr=2.18733e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=101, gb_free=9.6, wall=47392
2024-11-09 00:21:19 - progress_bar.py[line:274] - INFO: epoch 012:    237 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.741, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=500.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3460, lr=2.17825e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=47494
2024-11-09 00:23:02 - progress_bar.py[line:274] - INFO: epoch 012:    247 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.735, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.31, wps=498.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3470, lr=2.16918e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=103, gb_free=9.7, wall=47597
2024-11-09 00:24:44 - progress_bar.py[line:274] - INFO: epoch 012:    257 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=500.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3480, lr=2.1601e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=47699
2024-11-09 00:26:26 - progress_bar.py[line:274] - INFO: epoch 012:    267 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=501.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3490, lr=2.15103e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=47801
2024-11-09 00:28:08 - progress_bar.py[line:274] - INFO: epoch 012:    277 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.718, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.16, wps=503, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3500, lr=2.14195e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=47903
2024-11-09 00:29:50 - progress_bar.py[line:274] - INFO: epoch 012:    287 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=502.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3510, lr=2.13287e-05, gnorm=0.011, clip=0, loss_scale=8192, train_wall=102, gb_free=9.7, wall=48005
slice_id 6 seek offset 60205slice_id 2 seek offset 20069

slice_id 5 seek offset 50171
slice_id 4 seek offset 40137
slice_id 1 seek offset 10035
slice_id 3 seek offset 30103
slice_id 7 seek offset 70239
2024-11-09 00:30:46 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-09 00:41:28 - progress_bar.py[line:282] - INFO: epoch 012 | valid on 'valid' subset | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.759 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.54 | score 0.5421 | wps 501.3 | wpb 639.6 | bsz 159.9 | num_updates 3516 | best_score 0.5421
2024-11-09 00:41:28 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 3516 updates
2024-11-09 00:41:28 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
slice_id 7 seek offset 327637
slice_id 3 seek offset 140417
slice_id 6 seek offset 280832
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 2 seek offset 93612
slice_id 4 seek offset 187222
2024-11-09 00:42:29 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 00:43:45 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 12 @ 3516 updates, score 0.5421) (writing took 136.96534658194287 seconds)
2024-11-09 00:43:46 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 12 @ 3516 updates
2024-11-09 00:43:46 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 00:45:12 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 00:45:12 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 12 @ 3516 updates, score 0) (writing took 86.35640741797397 seconds)
2024-11-09 00:45:12 - train.py[line:336] - INFO: end of epoch 12 (average epoch stats below)
2024-11-09 00:45:12 - progress_bar.py[line:282] - INFO: epoch 012 | loss 0.002 | loss_v1 0 | loss_v2 0 | nll_loss 3.729 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.26 | wps 391.9 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 3516 | lr 2.12743e-05 | gnorm 0.009 | clip 0 | loss_scale 8192 | train_wall 2568 | gb_free 9.7 | wall 48927
2024-11-09 00:45:12 - trainer.py[line:639] - INFO: loading train data for epoch 13
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 00:45:15 - trainer.py[line:703] - INFO: begin training epoch 13
2024-11-09 00:45:15 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 00:45:57 - progress_bar.py[line:274] - INFO: epoch 013:      4 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=50.9, ups=0.01, wpb=4928, bsz=1232, num_updates=3520, lr=2.1238e-05, gnorm=0.01, clip=0, loss_scale=8192, train_wall=70, gb_free=9.7, wall=48973
2024-11-09 00:47:38 - progress_bar.py[line:274] - INFO: epoch 013:     14 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.734, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=507.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3530, lr=2.11472e-05, gnorm=0.013, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=49073
2024-11-09 00:49:19 - progress_bar.py[line:274] - INFO: epoch 013:     24 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.686, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.87, wps=508.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3540, lr=2.10565e-05, gnorm=0.012, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=49174
2024-11-09 00:50:59 - progress_bar.py[line:274] - INFO: epoch 013:     34 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.663, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.66, wps=510.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3550, lr=2.09657e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=49274
2024-11-09 00:52:40 - progress_bar.py[line:274] - INFO: epoch 013:     44 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.644, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.51, wps=509.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3560, lr=2.08749e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.6, wall=49375
2024-11-09 00:54:20 - progress_bar.py[line:274] - INFO: epoch 013:     54 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.675, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.78, wps=509.4, ups=0.1, wpb=5119.8, bsz=1280, num_updates=3570, lr=2.07842e-05, gnorm=0.009, clip=0, loss_scale=8192, train_wall=35, gb_free=9.7, wall=49475
2024-11-09 00:56:01 - progress_bar.py[line:274] - INFO: epoch 013:     64 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.688, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.89, wps=508.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3580, lr=2.06934e-05, gnorm=0.008, clip=0, loss_scale=8192, train_wall=35, gb_free=9.6, wall=49576
2024-11-09 00:57:42 - progress_bar.py[line:274] - INFO: epoch 013:     74 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.11, wps=507.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3590, lr=2.06027e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=49677
2024-11-09 00:59:23 - progress_bar.py[line:274] - INFO: epoch 013:     84 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.716, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.14, wps=506.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3600, lr=2.05119e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=49778
2024-11-09 01:01:03 - progress_bar.py[line:274] - INFO: epoch 013:     94 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.665, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=511, ups=0.1, wpb=5120, bsz=1280, num_updates=3610, lr=2.04211e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=49878
2024-11-09 01:02:44 - progress_bar.py[line:274] - INFO: epoch 013:    104 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.686, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.87, wps=508, ups=0.1, wpb=5120, bsz=1280, num_updates=3620, lr=2.03304e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=49979
2024-11-09 01:04:25 - progress_bar.py[line:274] - INFO: epoch 013:    114 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.72, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.18, wps=506.1, ups=0.1, wpb=5120, bsz=1280, num_updates=3630, lr=2.02396e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=50080
2024-11-09 01:06:08 - progress_bar.py[line:274] - INFO: epoch 013:    124 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.723, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.21, wps=495.6, ups=0.1, wpb=5119.8, bsz=1280, num_updates=3640, lr=2.01488e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=51, gb_free=9.7, wall=50183
2024-11-09 01:07:50 - progress_bar.py[line:274] - INFO: epoch 013:    134 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.745, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=503.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3650, lr=2.00581e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=76, gb_free=9.7, wall=50285
2024-11-09 01:09:31 - progress_bar.py[line:274] - INFO: epoch 013:    144 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.732, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.29, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=3660, lr=1.99673e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=85, gb_free=9.7, wall=50386
2024-11-09 01:11:12 - progress_bar.py[line:274] - INFO: epoch 013:    154 / 293 loss=0.002, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.41, wps=506.3, ups=0.1, wpb=5120, bsz=1280, num_updates=3670, lr=1.98766e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=90, gb_free=9.6, wall=50487
2024-11-09 01:12:53 - progress_bar.py[line:274] - INFO: epoch 013:    164 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=507.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3680, lr=1.97858e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=88, gb_free=9.7, wall=50588
2024-11-09 01:14:34 - progress_bar.py[line:274] - INFO: epoch 013:    174 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.62, wps=506.3, ups=0.1, wpb=5120, bsz=1280, num_updates=3690, lr=1.9695e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=93, gb_free=9.7, wall=50689
2024-11-09 01:16:16 - progress_bar.py[line:274] - INFO: epoch 013:    184 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.777, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.71, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3700, lr=1.96043e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=93, gb_free=9.7, wall=50791
2024-11-09 01:17:56 - progress_bar.py[line:274] - INFO: epoch 013:    194 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=509.9, ups=0.1, wpb=5120, bsz=1280, num_updates=3710, lr=1.95135e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=85, gb_free=9.6, wall=50891
2024-11-09 01:19:35 - progress_bar.py[line:274] - INFO: epoch 013:    204 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.726, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.23, wps=513.4, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=3720, lr=1.94228e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=74, gb_free=9.6, wall=50990
2024-11-09 01:21:16 - progress_bar.py[line:274] - INFO: epoch 013:    214 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.734, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=505.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3730, lr=1.9332e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=76, gb_free=9.7, wall=51091
2024-11-09 01:22:57 - progress_bar.py[line:274] - INFO: epoch 013:    224 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.776, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.7, wps=507.4, ups=0.1, wpb=5120, bsz=1280, num_updates=3740, lr=1.92412e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=85, gb_free=9.7, wall=51192
2024-11-09 01:24:38 - progress_bar.py[line:274] - INFO: epoch 013:    234 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.801, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.94, wps=505, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3750, lr=1.91505e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=89, gb_free=9.6, wall=51293
2024-11-09 01:26:19 - progress_bar.py[line:274] - INFO: epoch 013:    244 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.791, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.85, wps=510.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3760, lr=1.90597e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=89, gb_free=9.7, wall=51394
2024-11-09 01:28:00 - progress_bar.py[line:274] - INFO: epoch 013:    254 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.77, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.64, wps=506.7, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3770, lr=1.8969e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=92, gb_free=9.7, wall=51495
2024-11-09 01:29:41 - progress_bar.py[line:274] - INFO: epoch 013:    264 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.785, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.78, wps=504.3, ups=0.1, wpb=5120, bsz=1280, num_updates=3780, lr=1.88782e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=98, gb_free=9.7, wall=51596
2024-11-09 01:31:22 - progress_bar.py[line:274] - INFO: epoch 013:    274 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.796, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.89, wps=507.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3790, lr=1.87874e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=100, gb_free=9.7, wall=51697
2024-11-09 01:33:04 - progress_bar.py[line:274] - INFO: epoch 013:    284 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.779, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.73, wps=502.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3800, lr=1.86967e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=51799
slice_id 6 seek offset 60205slice_id 2 seek offset 20069slice_id 3 seek offset 30103


slice_id 5 seek offset 50171
slice_id 1 seek offset 10035slice_id 4 seek offset 40137

slice_id 7 seek offset 70239
2024-11-09 01:34:29 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 7 seek offset 70239
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-09 01:45:09 - progress_bar.py[line:282] - INFO: epoch 013 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.82 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 14.12 | score 0.5865 | wps 503 | wpb 639.6 | bsz 159.9 | num_updates 3809 | best_score 0.5865
2024-11-09 01:45:09 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 3809 updates
2024-11-09 01:45:09 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
slice_id 7 seek offset 327637
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 5 seek offset 234027
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 4 seek offset 187222
2024-11-09 01:46:10 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 01:47:26 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 13 @ 3809 updates, score 0.5865) (writing took 136.57224213000154 seconds)
2024-11-09 01:47:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 13 @ 3809 updates
2024-11-09 01:47:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 01:48:53 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 01:48:53 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 13 @ 3809 updates, score 0) (writing took 86.75892514595762 seconds)
2024-11-09 01:48:53 - train.py[line:336] - INFO: end of epoch 13 (average epoch stats below)
2024-11-09 01:48:53 - progress_bar.py[line:282] - INFO: epoch 013 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.735 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.32 | wps 392 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 3809 | lr 1.8615e-05 | gnorm 0.009 | clip 0 | loss_scale 16384 | train_wall 1947 | gb_free 9.7 | wall 52748
2024-11-09 01:48:53 - trainer.py[line:639] - INFO: loading train data for epoch 14
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 01:48:56 - trainer.py[line:703] - INFO: begin training epoch 14
2024-11-09 01:48:56 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 01:49:09 - progress_bar.py[line:274] - INFO: epoch 014:      1 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.806, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.99, wps=51.1, ups=0.01, wpb=4928, bsz=1232, num_updates=3810, lr=1.86059e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=89, gb_free=9.7, wall=52764
2024-11-09 01:50:47 - progress_bar.py[line:274] - INFO: epoch 014:     11 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.823, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=14.15, wps=520.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3820, lr=1.85152e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=52862
2024-11-09 01:52:26 - progress_bar.py[line:274] - INFO: epoch 014:     21 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.805, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.98, wps=518.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3830, lr=1.84244e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=52961
2024-11-09 01:54:05 - progress_bar.py[line:274] - INFO: epoch 014:     31 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.763, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.57, wps=515.5, ups=0.1, wpb=5120, bsz=1280, num_updates=3840, lr=1.83336e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=53060
2024-11-09 01:55:46 - progress_bar.py[line:274] - INFO: epoch 014:     41 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5072.7, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=503.2, ups=0.1, wpb=5072.7, bsz=1268.2, num_updates=3850, lr=1.82429e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=52, gb_free=9.5, wall=53161
2024-11-09 01:57:26 - progress_bar.py[line:274] - INFO: epoch 014:     51 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.763, ntokens=5119.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.58, wps=512.1, ups=0.1, wpb=5119.7, bsz=1280, num_updates=3860, lr=1.81521e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=74, gb_free=9.7, wall=53261
2024-11-09 01:59:06 - progress_bar.py[line:274] - INFO: epoch 014:     61 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.781, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.74, wps=508.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3870, lr=1.80614e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=90, gb_free=9.7, wall=53361
2024-11-09 02:00:47 - progress_bar.py[line:274] - INFO: epoch 014:     71 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.768, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.63, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=3880, lr=1.79706e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=100, gb_free=9.6, wall=53462
2024-11-09 02:02:28 - progress_bar.py[line:274] - INFO: epoch 014:     81 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.76, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.55, wps=508.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3890, lr=1.78798e-05, gnorm=0.012, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=53563
2024-11-09 02:04:09 - progress_bar.py[line:274] - INFO: epoch 014:     91 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.762, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.57, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3900, lr=1.77891e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=53664
2024-11-09 02:05:51 - progress_bar.py[line:274] - INFO: epoch 014:    101 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.734, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=503.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3910, lr=1.76983e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=53766
2024-11-09 02:07:32 - progress_bar.py[line:274] - INFO: epoch 014:    111 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.738, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.34, wps=507.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3920, lr=1.76076e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=53867
2024-11-09 02:09:14 - progress_bar.py[line:274] - INFO: epoch 014:    121 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.732, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=503.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3930, lr=1.75168e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=53969
2024-11-09 02:10:55 - progress_bar.py[line:274] - INFO: epoch 014:    131 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.723, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.2, wps=506.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3940, lr=1.7426e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=54070
2024-11-09 02:12:35 - progress_bar.py[line:274] - INFO: epoch 014:    141 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.781, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.74, wps=510.2, ups=0.1, wpb=5120, bsz=1280, num_updates=3950, lr=1.73353e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=100, gb_free=9.7, wall=54170
2024-11-09 02:14:16 - progress_bar.py[line:274] - INFO: epoch 014:    151 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.781, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.75, wps=507.6, ups=0.1, wpb=5120, bsz=1280, num_updates=3960, lr=1.72445e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=101, gb_free=9.6, wall=54271
2024-11-09 02:15:57 - progress_bar.py[line:274] - INFO: epoch 014:    161 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.749, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.45, wps=504.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=3970, lr=1.71537e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=54372
2024-11-09 02:17:38 - progress_bar.py[line:274] - INFO: epoch 014:    171 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.753, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.48, wps=507.3, ups=0.1, wpb=5120, bsz=1280, num_updates=3980, lr=1.7063e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=54473
2024-11-09 02:19:20 - progress_bar.py[line:274] - INFO: epoch 014:    181 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.764, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.59, wps=502.8, ups=0.1, wpb=5120, bsz=1280, num_updates=3990, lr=1.69722e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=54575
2024-11-09 02:21:01 - progress_bar.py[line:274] - INFO: epoch 014:    191 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.715, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.13, wps=506.8, ups=0.1, wpb=5120, bsz=1280, num_updates=4000, lr=1.68815e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=54676
slice_id 2 seek offset 20069slice_id 3 seek offset 30103

slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
2024-11-09 02:21:01 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
2024-11-09 02:31:44 - progress_bar.py[line:282] - INFO: epoch 014 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.698 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 12.97 | score 0.5955 | wps 501 | wpb 639.6 | bsz 159.9 | num_updates 4000 | best_score 0.5955
2024-11-09 02:31:44 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 4000 updates
2024-11-09 02:31:44 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_14_4000.pt
2024-11-09 02:31:54 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_14_4000.pt
2024-11-09 02:34:46 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_14_4000.pt (epoch 14 @ 4000 updates, score 0.5955) (writing took 182.45436351501849 seconds)
2024-11-09 02:36:15 - progress_bar.py[line:274] - INFO: epoch 014:    201 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.731, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.28, wps=56, ups=0.01, wpb=5120, bsz=1280, num_updates=4010, lr=1.67907e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=35, gb_free=9.6, wall=55590
2024-11-09 02:37:54 - progress_bar.py[line:274] - INFO: epoch 014:    211 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.759, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.54, wps=517.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4020, lr=1.66999e-05, gnorm=0.008, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=55689
2024-11-09 02:39:33 - progress_bar.py[line:274] - INFO: epoch 014:    221 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.754, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.49, wps=517.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4030, lr=1.66092e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=35, gb_free=9.7, wall=55788
2024-11-09 02:41:15 - progress_bar.py[line:274] - INFO: epoch 014:    231 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.723, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.2, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4040, lr=1.65184e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=56, gb_free=9.7, wall=55890
2024-11-09 02:42:56 - progress_bar.py[line:274] - INFO: epoch 014:    241 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=506, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4050, lr=1.64277e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=80, gb_free=9.7, wall=55991
2024-11-09 02:44:36 - progress_bar.py[line:274] - INFO: epoch 014:    251 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=508.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4060, lr=1.63369e-05, gnorm=0.013, clip=0, loss_scale=16384, train_wall=94, gb_free=9.7, wall=56091
2024-11-09 02:46:18 - progress_bar.py[line:274] - INFO: epoch 014:    261 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.708, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.07, wps=502.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4070, lr=1.62461e-05, gnorm=0.01, clip=0, loss_scale=16384, train_wall=101, gb_free=9.7, wall=56193
2024-11-09 02:48:00 - progress_bar.py[line:274] - INFO: epoch 014:    271 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.703, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.03, wps=502.4, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4080, lr=1.61554e-05, gnorm=0.011, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=56295
2024-11-09 02:49:42 - progress_bar.py[line:274] - INFO: epoch 014:    281 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.692, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.93, wps=503.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4090, lr=1.60646e-05, gnorm=0.009, clip=0, loss_scale=16384, train_wall=102, gb_free=9.7, wall=56397
2024-11-09 02:51:23 - progress_bar.py[line:274] - INFO: epoch 014:    291 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.702, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.02, wps=505.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4100, lr=1.59739e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=56498
slice_id 3 seek offset 30103
slice_id 6 seek offset 60205
slice_id 2 seek offset 20069
slice_id 4 seek offset 40137slice_id 5 seek offset 50171slice_id 7 seek offset 70239


2024-11-09 02:51:38 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 1 seek offset 10035
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-09 03:02:22 - progress_bar.py[line:282] - INFO: epoch 014 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.731 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.27 | score 0.6147 | wps 500.1 | wpb 639.6 | bsz 159.9 | num_updates 4102 | best_score 0.6147
2024-11-09 03:02:22 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 4102 updates
2024-11-09 03:02:22 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
slice_id 3 seek offset 140417
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 6 seek offset 280832
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
2024-11-09 03:03:23 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 03:04:39 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 14 @ 4102 updates, score 0.6147) (writing took 137.04350214201258 seconds)
2024-11-09 03:04:40 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 14 @ 4102 updates
2024-11-09 03:04:40 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 03:06:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 03:06:06 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 14 @ 4102 updates, score 0) (writing took 86.3260996430181 seconds)
2024-11-09 03:06:06 - train.py[line:336] - INFO: end of epoch 14 (average epoch stats below)
2024-11-09 03:06:06 - progress_bar.py[line:282] - INFO: epoch 014 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.747 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.43 | wps 323.3 | ups 0.06 | wpb 5111.8 | bsz 1278 | num_updates 4102 | lr 1.59557e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 2393 | gb_free 9.7 | wall 57381
2024-11-09 03:06:06 - trainer.py[line:639] - INFO: loading train data for epoch 15
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 03:06:09 - trainer.py[line:703] - INFO: begin training epoch 15
2024-11-09 03:06:09 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 03:07:31 - progress_bar.py[line:274] - INFO: epoch 015:      8 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=50.9, ups=0.01, wpb=4928, bsz=1232, num_updates=4110, lr=1.58831e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=43, gb_free=9.7, wall=57466
2024-11-09 03:09:09 - progress_bar.py[line:274] - INFO: epoch 015:     18 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.706, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.05, wps=521.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4120, lr=1.57923e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=57564
2024-11-09 03:10:48 - progress_bar.py[line:274] - INFO: epoch 015:     28 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=517, ups=0.1, wpb=5120, bsz=1280, num_updates=4130, lr=1.57016e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=57663
2024-11-09 03:12:27 - progress_bar.py[line:274] - INFO: epoch 015:     38 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.705, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.04, wps=517.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4140, lr=1.56108e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=9.6, wall=57762
2024-11-09 03:14:09 - progress_bar.py[line:274] - INFO: epoch 015:     48 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.694, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.95, wps=503.3, ups=0.1, wpb=5119.8, bsz=1280, num_updates=4150, lr=1.55201e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=55, gb_free=9.7, wall=57864
2024-11-09 03:15:49 - progress_bar.py[line:274] - INFO: epoch 015:     58 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.712, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.1, wps=507.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4160, lr=1.54293e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=87, gb_free=9.6, wall=57965
2024-11-09 03:17:31 - progress_bar.py[line:274] - INFO: epoch 015:     68 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.722, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.19, wps=506.8, ups=0.1, wpb=5120, bsz=1280, num_updates=4170, lr=1.53385e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=58066
2024-11-09 03:19:11 - progress_bar.py[line:274] - INFO: epoch 015:     78 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=506.5, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=4180, lr=1.52478e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=100, gb_free=9.7, wall=58166
2024-11-09 03:20:52 - progress_bar.py[line:274] - INFO: epoch 015:     88 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=503.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4190, lr=1.5157e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=58267
2024-11-09 03:22:34 - progress_bar.py[line:274] - INFO: epoch 015:     98 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=503.1, ups=0.1, wpb=5120, bsz=1280, num_updates=4200, lr=1.50663e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=58369
2024-11-09 03:24:15 - progress_bar.py[line:274] - INFO: epoch 015:    108 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.688, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.89, wps=506.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4210, lr=1.49755e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=58470
2024-11-09 03:25:56 - progress_bar.py[line:274] - INFO: epoch 015:    118 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.708, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.07, wps=506.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4220, lr=1.48847e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=58571
2024-11-09 03:27:38 - progress_bar.py[line:274] - INFO: epoch 015:    128 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.664, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.68, wps=505.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4230, lr=1.4794e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=58673
2024-11-09 03:29:19 - progress_bar.py[line:274] - INFO: epoch 015:    138 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.693, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.93, wps=503.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4240, lr=1.47032e-05, gnorm=0.012, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=58774
2024-11-09 03:31:01 - progress_bar.py[line:274] - INFO: epoch 015:    148 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.736, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.33, wps=505.9, ups=0.1, wpb=5120, bsz=1280, num_updates=4250, lr=1.46125e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=58876
2024-11-09 03:32:42 - progress_bar.py[line:274] - INFO: epoch 015:    158 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.743, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.39, wps=505.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4260, lr=1.45217e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=58977
2024-11-09 03:34:23 - progress_bar.py[line:274] - INFO: epoch 015:    168 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.737, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.33, wps=506.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4270, lr=1.44309e-05, gnorm=0.013, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59078
2024-11-09 03:36:04 - progress_bar.py[line:274] - INFO: epoch 015:    178 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.722, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.2, wps=504.8, ups=0.1, wpb=5120, bsz=1280, num_updates=4280, lr=1.43402e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59179
2024-11-09 03:37:45 - progress_bar.py[line:274] - INFO: epoch 015:    188 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=507.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4290, lr=1.42494e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59280
2024-11-09 03:39:27 - progress_bar.py[line:274] - INFO: epoch 015:    198 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.72, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4300, lr=1.41586e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59382
2024-11-09 03:41:08 - progress_bar.py[line:274] - INFO: epoch 015:    208 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.749, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.45, wps=507.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4310, lr=1.40679e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59483
2024-11-09 03:42:48 - progress_bar.py[line:274] - INFO: epoch 015:    218 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.724, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.21, wps=508.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4320, lr=1.39771e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59583
2024-11-09 03:44:30 - progress_bar.py[line:274] - INFO: epoch 015:    228 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.689, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.9, wps=501, ups=0.1, wpb=5120, bsz=1280, num_updates=4330, lr=1.38864e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.6, wall=59686
2024-11-09 03:46:12 - progress_bar.py[line:274] - INFO: epoch 015:    238 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.696, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.96, wps=505, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4340, lr=1.37956e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59787
2024-11-09 03:47:53 - progress_bar.py[line:274] - INFO: epoch 015:    248 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.737, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.34, wps=504.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4350, lr=1.37048e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59888
2024-11-09 03:49:35 - progress_bar.py[line:274] - INFO: epoch 015:    258 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=505.8, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4360, lr=1.36141e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=59990
2024-11-09 03:51:15 - progress_bar.py[line:274] - INFO: epoch 015:    268 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=507.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4370, lr=1.35233e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=60090
2024-11-09 03:52:57 - progress_bar.py[line:274] - INFO: epoch 015:    278 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.765, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.59, wps=504.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4380, lr=1.34326e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=60192
2024-11-09 03:54:39 - progress_bar.py[line:274] - INFO: epoch 015:    288 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.752, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=503, ups=0.1, wpb=5120, bsz=1280, num_updates=4390, lr=1.33418e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=60294
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171slice_id 1 seek offset 10035

slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
2024-11-09 03:55:24 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-09 04:06:05 - progress_bar.py[line:282] - INFO: epoch 015 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.775 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.69 | score 0.6346 | wps 501.7 | wpb 639.6 | bsz 159.9 | num_updates 4395 | best_score 0.6346
2024-11-09 04:06:05 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 4395 updates
2024-11-09 04:06:05 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 6 seek offset 280832
slice_id 1 seek offset 46806
slice_id 7 seek offset 327637
2024-11-09 04:07:06 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 04:08:22 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 15 @ 4395 updates, score 0.6346) (writing took 137.09696046699537 seconds)
2024-11-09 04:08:23 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 15 @ 4395 updates
2024-11-09 04:08:23 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 04:09:49 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 04:09:50 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 15 @ 4395 updates, score 0) (writing took 86.4488493159879 seconds)
2024-11-09 04:09:50 - train.py[line:336] - INFO: end of epoch 15 (average epoch stats below)
2024-11-09 04:09:50 - progress_bar.py[line:282] - INFO: epoch 015 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.719 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.17 | wps 391.7 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 4395 | lr 1.32964e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 2647 | gb_free 9.7 | wall 61205
2024-11-09 04:09:50 - trainer.py[line:639] - INFO: loading train data for epoch 16
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 04:09:52 - trainer.py[line:703] - INFO: begin training epoch 16
2024-11-09 04:09:52 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 04:10:45 - progress_bar.py[line:274] - INFO: epoch 016:      5 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.75, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.45, wps=51, ups=0.01, wpb=4928, bsz=1232, num_updates=4400, lr=1.3251e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=62, gb_free=9.7, wall=61260
2024-11-09 04:12:23 - progress_bar.py[line:274] - INFO: epoch 016:     15 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.733, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=521, ups=0.1, wpb=5120, bsz=1280, num_updates=4410, lr=1.31603e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=61358
2024-11-09 04:14:02 - progress_bar.py[line:274] - INFO: epoch 016:     25 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.734, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=517.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4420, lr=1.30695e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=61457
2024-11-09 04:15:41 - progress_bar.py[line:274] - INFO: epoch 016:     35 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=516.6, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4430, lr=1.29788e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=61556
2024-11-09 04:17:20 - progress_bar.py[line:274] - INFO: epoch 016:     45 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=519, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4440, lr=1.2888e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=61655
2024-11-09 04:19:01 - progress_bar.py[line:274] - INFO: epoch 016:     55 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.754, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.49, wps=507.2, ups=0.1, wpb=5119.8, bsz=1280, num_updates=4450, lr=1.27972e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=47, gb_free=9.7, wall=61756
2024-11-09 04:20:42 - progress_bar.py[line:274] - INFO: epoch 016:     65 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=507, ups=0.1, wpb=5120, bsz=1280, num_updates=4460, lr=1.27065e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=70, gb_free=9.7, wall=61857
2024-11-09 04:22:23 - progress_bar.py[line:274] - INFO: epoch 016:     75 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=505, ups=0.1, wpb=5120, bsz=1280, num_updates=4470, lr=1.26157e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=92, gb_free=9.7, wall=61958
2024-11-09 04:24:05 - progress_bar.py[line:274] - INFO: epoch 016:     85 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=504.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4480, lr=1.2525e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=62060
2024-11-09 04:25:46 - progress_bar.py[line:274] - INFO: epoch 016:     95 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=507, ups=0.1, wpb=5120, bsz=1280, num_updates=4490, lr=1.24342e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62161
2024-11-09 04:27:26 - progress_bar.py[line:274] - INFO: epoch 016:    105 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.24, wps=508.3, ups=0.1, wpb=5120, bsz=1280, num_updates=4500, lr=1.23434e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62261
2024-11-09 04:29:07 - progress_bar.py[line:274] - INFO: epoch 016:    115 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=507.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4510, lr=1.22527e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=62362
2024-11-09 04:30:48 - progress_bar.py[line:274] - INFO: epoch 016:    125 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.727, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=506.3, ups=0.1, wpb=5119.8, bsz=1280, num_updates=4520, lr=1.21619e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62463
2024-11-09 04:32:29 - progress_bar.py[line:274] - INFO: epoch 016:    135 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=507, ups=0.1, wpb=5120, bsz=1280, num_updates=4530, lr=1.20712e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62564
2024-11-09 04:34:10 - progress_bar.py[line:274] - INFO: epoch 016:    145 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.75, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=507.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4540, lr=1.19804e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62665
2024-11-09 04:35:52 - progress_bar.py[line:274] - INFO: epoch 016:    155 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.734, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.31, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4550, lr=1.18896e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=62767
2024-11-09 04:37:32 - progress_bar.py[line:274] - INFO: epoch 016:    165 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.74, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.36, wps=508.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4560, lr=1.17989e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62867
2024-11-09 04:39:14 - progress_bar.py[line:274] - INFO: epoch 016:    175 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.741, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.37, wps=506.3, ups=0.1, wpb=5120, bsz=1280, num_updates=4570, lr=1.17081e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=62969
2024-11-09 04:40:54 - progress_bar.py[line:274] - INFO: epoch 016:    185 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.706, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.05, wps=508.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4580, lr=1.16174e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.4, wall=63069
2024-11-09 04:42:35 - progress_bar.py[line:274] - INFO: epoch 016:    195 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.695, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=12.95, wps=509.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4590, lr=1.15266e-05, gnorm=0.014, clip=0, loss_scale=32768, train_wall=100, gb_free=9.7, wall=63170
2024-11-09 04:44:15 - progress_bar.py[line:274] - INFO: epoch 016:    205 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.714, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.13, wps=508.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4600, lr=1.14358e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=63270
2024-11-09 04:45:46 - trainer.py[line:922] - INFO: NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32768.0
2024-11-09 04:46:07 - progress_bar.py[line:274] - INFO: epoch 016:    216 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.711, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.09, wps=460.8, ups=0.09, wpb=5120, bsz=1280, num_updates=4610, lr=1.13451e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=111, gb_free=9.7, wall=63382
2024-11-09 04:47:47 - progress_bar.py[line:274] - INFO: epoch 016:    226 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.702, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.01, wps=503.5, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=4620, lr=1.12543e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=63482
2024-11-09 04:49:29 - progress_bar.py[line:274] - INFO: epoch 016:    236 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.719, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.17, wps=501.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4630, lr=1.11636e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=63584
2024-11-09 04:51:11 - progress_bar.py[line:274] - INFO: epoch 016:    246 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.76, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.55, wps=502.9, ups=0.1, wpb=5120, bsz=1280, num_updates=4640, lr=1.10728e-05, gnorm=0.011, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=63686
2024-11-09 04:52:53 - progress_bar.py[line:274] - INFO: epoch 016:    256 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=502.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4650, lr=1.0982e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=63788
2024-11-09 04:54:34 - progress_bar.py[line:274] - INFO: epoch 016:    266 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.762, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.57, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4660, lr=1.08913e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=63889
2024-11-09 04:56:15 - progress_bar.py[line:274] - INFO: epoch 016:    276 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.77, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.65, wps=505.5, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4670, lr=1.08005e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=63990
2024-11-09 04:57:57 - progress_bar.py[line:274] - INFO: epoch 016:    286 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=505.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4680, lr=1.07097e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=64092
slice_id 2 seek offset 20069slice_id 3 seek offset 30103slice_id 6 seek offset 60205


slice_id 1 seek offset 10035
slice_id 5 seek offset 50171
slice_id 4 seek offset 40137slice_id 7 seek offset 70239

2024-11-09 04:59:02 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 7 seek offset 70239
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 0 seek offset 0
slice_id 4 seek offset 40137
2024-11-09 05:09:43 - progress_bar.py[line:282] - INFO: epoch 016 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.766 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.61 | score 0.6551 | wps 502.3 | wpb 639.6 | bsz 159.9 | num_updates 4687 | best_score 0.6551
2024-11-09 05:09:43 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 4687 updates
2024-11-09 05:09:43 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
slice_id 5 seek offset 234027
slice_id 2 seek offset 93612
slice_id 7 seek offset 327637
slice_id 6 seek offset 280832
slice_id 3 seek offset 140417
slice_id 4 seek offset 187222
slice_id 1 seek offset 46806
2024-11-09 05:10:44 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 05:12:00 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 16 @ 4687 updates, score 0.6551) (writing took 137.52736072102562 seconds)
2024-11-09 05:12:01 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 16 @ 4687 updates
2024-11-09 05:12:01 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 05:13:26 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 05:13:27 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 16 @ 4687 updates, score 0) (writing took 85.90416534600081 seconds)
2024-11-09 05:13:27 - train.py[line:336] - INFO: end of epoch 16 (average epoch stats below)
2024-11-09 05:13:27 - progress_bar.py[line:282] - INFO: epoch 016 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.736 | ntokens 5111.77 | nsentences 1277.95 | sample_size 1277.95 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.32 | wps 391 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 4687 | lr 1.06462e-05 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 2562 | gb_free 9.7 | wall 65022
2024-11-09 05:13:27 - trainer.py[line:639] - INFO: loading train data for epoch 17
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 05:13:29 - trainer.py[line:703] - INFO: begin training epoch 17
2024-11-09 05:13:29 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 05:14:02 - progress_bar.py[line:274] - INFO: epoch 017:      3 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.743, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.38, wps=51, ups=0.01, wpb=4928, bsz=1232, num_updates=4690, lr=1.0619e-05, gnorm=0.008, clip=0, loss_scale=32768, train_wall=75, gb_free=9.6, wall=65057
2024-11-09 05:15:41 - progress_bar.py[line:274] - INFO: epoch 017:     13 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.765, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.6, wps=516.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4700, lr=1.05282e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.6, wall=65157
2024-11-09 05:17:20 - progress_bar.py[line:274] - INFO: epoch 017:     23 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.762, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.57, wps=518.9, ups=0.1, wpb=5120, bsz=1280, num_updates=4710, lr=1.04375e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=65255
2024-11-09 05:18:59 - progress_bar.py[line:274] - INFO: epoch 017:     33 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.777, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.71, wps=517.2, ups=0.1, wpb=5120, bsz=1280, num_updates=4720, lr=1.03467e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=65354
2024-11-09 05:20:39 - progress_bar.py[line:274] - INFO: epoch 017:     43 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.767, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.61, wps=512.1, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4730, lr=1.02559e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=65454
2024-11-09 05:22:21 - progress_bar.py[line:274] - INFO: epoch 017:     53 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.742, ntokens=5119.7, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.38, wps=501.3, ups=0.1, wpb=5119.7, bsz=1280, num_updates=4740, lr=1.01652e-05, gnorm=0.01, clip=0, loss_scale=32768, train_wall=62, gb_free=9.7, wall=65556
2024-11-09 05:24:02 - progress_bar.py[line:274] - INFO: epoch 017:     63 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.76, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.54, wps=506.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4750, lr=1.00744e-05, gnorm=0.009, clip=0, loss_scale=32768, train_wall=93, gb_free=9.7, wall=65657
2024-11-09 05:25:44 - progress_bar.py[line:274] - INFO: epoch 017:     73 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.766, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.61, wps=504, ups=0.1, wpb=5120, bsz=1280, num_updates=4760, lr=9.98366e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=65759
2024-11-09 05:27:25 - progress_bar.py[line:274] - INFO: epoch 017:     83 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=505.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4770, lr=9.8929e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=65860
2024-11-09 05:29:06 - progress_bar.py[line:274] - INFO: epoch 017:     93 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.746, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.42, wps=505.3, ups=0.1, wpb=5120, bsz=1280, num_updates=4780, lr=9.80214e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=65962
2024-11-09 05:30:47 - progress_bar.py[line:274] - INFO: epoch 017:    103 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.724, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.22, wps=507.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4790, lr=9.71138e-06, gnorm=0.012, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66062
2024-11-09 05:32:28 - progress_bar.py[line:274] - INFO: epoch 017:    113 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.732, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.29, wps=506.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4800, lr=9.62062e-06, gnorm=0.013, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66163
2024-11-09 05:34:10 - progress_bar.py[line:274] - INFO: epoch 017:    123 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.728, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=504, ups=0.1, wpb=5119.8, bsz=1280, num_updates=4810, lr=9.52986e-06, gnorm=0.012, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66265
2024-11-09 05:35:51 - progress_bar.py[line:274] - INFO: epoch 017:    133 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.733, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=506.3, ups=0.1, wpb=5120, bsz=1280, num_updates=4820, lr=9.4391e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66366
2024-11-09 05:37:32 - progress_bar.py[line:274] - INFO: epoch 017:    143 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.753, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.48, wps=508.4, ups=0.1, wpb=5120, bsz=1280, num_updates=4830, lr=9.34834e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66467
2024-11-09 05:39:14 - progress_bar.py[line:274] - INFO: epoch 017:    153 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.758, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.53, wps=503, ups=0.1, wpb=5120, bsz=1280, num_updates=4840, lr=9.25758e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=66569
2024-11-09 05:40:56 - progress_bar.py[line:274] - INFO: epoch 017:    163 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=501, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4850, lr=9.16682e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=66671
2024-11-09 05:42:37 - progress_bar.py[line:274] - INFO: epoch 017:    173 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.756, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.51, wps=507.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4860, lr=9.07606e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66772
2024-11-09 05:44:18 - progress_bar.py[line:274] - INFO: epoch 017:    183 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.73, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=505.5, ups=0.1, wpb=5120, bsz=1280, num_updates=4870, lr=8.9853e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66873
2024-11-09 05:45:59 - progress_bar.py[line:274] - INFO: epoch 017:    193 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.709, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.08, wps=504.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4880, lr=8.89454e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=66974
2024-11-09 05:47:41 - progress_bar.py[line:274] - INFO: epoch 017:    203 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.728, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.25, wps=506.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4890, lr=8.80378e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=67076
2024-11-09 05:49:22 - progress_bar.py[line:274] - INFO: epoch 017:    213 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.753, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.48, wps=504.8, ups=0.1, wpb=5120, bsz=1280, num_updates=4900, lr=8.71302e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=67177
2024-11-09 05:51:03 - progress_bar.py[line:274] - INFO: epoch 017:    223 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.724, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.22, wps=504.3, ups=0.1, wpb=5120, bsz=1280, num_updates=4910, lr=8.62225e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=67279
2024-11-09 05:52:45 - progress_bar.py[line:274] - INFO: epoch 017:    233 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.713, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.12, wps=502.6, ups=0.1, wpb=5120, bsz=1280, num_updates=4920, lr=8.53149e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=67380
2024-11-09 05:54:27 - progress_bar.py[line:274] - INFO: epoch 017:    243 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.729, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.26, wps=503.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4930, lr=8.44073e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=67482
2024-11-09 05:56:10 - progress_bar.py[line:274] - INFO: epoch 017:    253 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.736, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.32, wps=498.7, ups=0.1, wpb=5120, bsz=1280, num_updates=4940, lr=8.34997e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=103, gb_free=9.6, wall=67585
2024-11-09 05:57:51 - progress_bar.py[line:274] - INFO: epoch 017:    263 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.752, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=503.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4950, lr=8.25921e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=67686
2024-11-09 05:59:34 - progress_bar.py[line:274] - INFO: epoch 017:    273 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.766, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.6, wps=501.2, ups=0.1, wpb=5119.9, bsz=1280, num_updates=4960, lr=8.16845e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=102, gb_free=9.7, wall=67789
2024-11-09 06:01:15 - progress_bar.py[line:274] - INFO: epoch 017:    283 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.747, ntokens=5072.8, nsentences=1268.2, sample_size=1268.2, sample_size_v1=0, sample_size_v2=0, ppl=13.43, wps=502, ups=0.1, wpb=5072.8, bsz=1268.2, num_updates=4970, lr=8.07769e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=101, gb_free=9.8, wall=67890
2024-11-09 06:02:51 - progress_bar.py[line:274] - INFO: epoch 017:    293 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.732, ntokens=4928, nsentences=1232, sample_size=1232, sample_size_v1=0, sample_size_v2=0, ppl=13.29, wps=512.4, ups=0.1, wpb=4928, bsz=1232, num_updates=4980, lr=7.98693e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=96, gb_free=9.7, wall=67986
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 1 seek offset 10035slice_id 6 seek offset 60205

slice_id 5 seek offset 50171
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
2024-11-09 06:02:51 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 5 seek offset 50171
slice_id 6 seek offset 60205
slice_id 1 seek offset 10035
slice_id 7 seek offset 70239
slice_id 4 seek offset 40137
slice_id 0 seek offset 0
2024-11-09 06:13:34 - progress_bar.py[line:282] - INFO: epoch 017 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.759 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.54 | score 0.6713 | wps 500.3 | wpb 639.6 | bsz 159.9 | num_updates 4980 | best_score 0.6713
2024-11-09 06:13:34 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 4980 updates
2024-11-09 06:13:34 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 begin to initialize row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 begin to initialize row_count and line_idx-to-offset mapping


local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 4 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 finished initializing row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 1 row count 46806 total row count 374442
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 7 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 3 row count 46805 total row count 374442
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 finished initializing row_count and line_idx-to-offset mappinglocal datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 finished initializing row_count and line_idx-to-offset mapping

file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 5 row count 46805 total row count 374442file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 2 row count 46805 total row count 374442

local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 6 row count 46805 total row count 374442
slice_id 4 seek offset 187222
slice_id 7 seek offset 327637
slice_id 5 seek offset 234027
slice_id 1 seek offset 46806
slice_id 6 seek offset 280832
slice_id 2 seek offset 93612
slice_id 3 seek offset 140417
2024-11-09 06:14:35 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt
2024-11-09 06:15:51 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_best.pt (epoch 17 @ 4980 updates, score 0.6713) (writing took 136.99239933898207 seconds)
2024-11-09 06:15:52 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 17 @ 4980 updates
2024-11-09 06:15:52 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 06:17:18 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt
2024-11-09 06:17:18 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_last.pt (epoch 17 @ 4980 updates, score 0) (writing took 86.12607405200833 seconds)
2024-11-09 06:17:18 - train.py[line:336] - INFO: end of epoch 17 (average epoch stats below)
2024-11-09 06:17:18 - progress_bar.py[line:282] - INFO: epoch 017 | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.744 | ntokens 5111.8 | nsentences 1277.96 | sample_size 1277.96 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.4 | wps 390.9 | ups 0.08 | wpb 5111.8 | bsz 1278 | num_updates 4980 | lr 7.98693e-06 | gnorm 0.01 | clip 0 | loss_scale 32768 | train_wall 2631 | gb_free 9.7 | wall 68853
2024-11-09 06:17:18 - trainer.py[line:639] - INFO: loading train data for epoch 18
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 begin to initialize row_count and line_idx-to-offset mapping
local datafile ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 finished initializing row_count and line_idx-to-offset mapping
file ../../datasets/pretrain/train_aihub_indoor_80.tsv slice_id 0 row count 46806 total row count 374442
slice_id 0 seek offset 0
2024-11-09 06:17:21 - trainer.py[line:703] - INFO: begin training epoch 18
2024-11-09 06:17:21 - train.py[line:297] - INFO: Start iterating over samples
2024-11-09 06:19:05 - progress_bar.py[line:274] - INFO: epoch 018:     10 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.751, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.46, wps=52.6, ups=0.01, wpb=5120, bsz=1280, num_updates=4990, lr=7.89617e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=68960
2024-11-09 06:20:44 - progress_bar.py[line:274] - INFO: epoch 018:     20 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.756, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.51, wps=513.2, ups=0.1, wpb=5120, bsz=1280, num_updates=5000, lr=7.80541e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=69059
slice_id 4 seek offset 40137
slice_id 6 seek offset 60205
slice_id 2 seek offset 20069
slice_id 3 seek offset 30103
slice_id 7 seek offset 70239
2024-11-09 06:20:44 - train.py[line:449] - INFO: begin validation on "valid" subset
slice_id 0 seek offset 0
slice_id 5 seek offset 50171
slice_id 1 seek offset 10035
slice_id 3 seek offset 30103
slice_id 2 seek offset 20069
slice_id 6 seek offset 60205
slice_id 5 seek offset 50171
slice_id 4 seek offset 40137
slice_id 7 seek offset 70239
slice_id 1 seek offset 10035
slice_id 0 seek offset 0
2024-11-09 06:31:27 - progress_bar.py[line:282] - INFO: epoch 018 | valid on 'valid' subset | loss 0.001 | loss_v1 0 | loss_v2 0 | nll_loss 3.768 | ntokens 639.625 | nsentences 159.906 | sample_size 159.906 | sample_size_v1 0 | sample_size_v2 0 | ppl 13.62 | score 0.6738 | wps 500.6 | wpb 639.6 | bsz 159.9 | num_updates 5000 | best_score 0.6738
2024-11-09 06:31:27 - checkpoint_utils.py[line:64] - INFO: Preparing to save checkpoint for epoch 18 @ 5000 updates
2024-11-09 06:31:27 - trainer.py[line:431] - INFO: Saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_18_5000.pt
2024-11-09 06:31:38 - trainer.py[line:441] - INFO: Finished saving checkpoint to ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_18_5000.pt
2024-11-09 06:34:29 - checkpoint_utils.py[line:135] - INFO: Saved checkpoint ./polyformer_b_pretrain_aihub_indoor_80_uniq_checkpoints/20_5e-5_512/checkpoint_18_5000.pt (epoch 18 @ 5000 updates, score 0.6738) (writing took 181.655623928993 seconds)
loss_reg: 0.024749755859375 loss_cls: 0.0
loss_reg: 0.0194091796875 loss_cls: 0.0
loss_reg: 0.0213775634765625 loss_cls: 0.0
loss_reg: 0.0232086181640625 loss_cls: 0.0
loss_reg: 0.025054931640625 loss_cls: 0.0
loss_reg: 0.027923583984375 loss_cls: 0.0
loss_reg: 0.024444580078125 loss_cls: 0.0
loss_reg: 0.0280609130859375 loss_cls: 0.0
loss_reg: 0.01543426513671875 loss_cls: 0.0
loss_reg: 0.02459716796875 loss_cls: 0.0
loss_reg: 0.01910400390625 loss_cls: 0.0
loss_reg: 0.01959228515625 loss_cls: 0.0
loss_reg: 0.0183868408203125 loss_cls: 0.0
loss_reg: 0.03912353515625 loss_cls: 0.0
loss_reg: 0.014190673828125 loss_cls: 0.0
loss_reg: 0.019500732421875 loss_cls: 0.0
loss_reg: 0.032196044921875 loss_cls: 0.0
loss_reg: 0.0190582275390625 loss_cls: 0.0loss_reg: 0.01396942138671875 loss_cls: 0.0

loss_reg: 0.0296630859375 loss_cls: 0.0
loss_reg: 0.021392822265625 loss_cls: 0.0
loss_reg: 0.0172271728515625 loss_cls: 0.0
loss_reg: 0.0233154296875 loss_cls: 0.0
loss_reg: 0.031219482421875 loss_cls: 0.0
loss_reg: 0.0151824951171875 loss_cls: 0.0
loss_reg: 0.01537322998046875 loss_cls: 0.0
loss_reg: 0.020782470703125 loss_cls: 0.0
loss_reg: 0.0239410400390625 loss_cls: 0.0
loss_reg: 0.0269927978515625 loss_cls: 0.0
loss_reg: 0.0253448486328125 loss_cls: 0.0
loss_reg: 0.0249786376953125 loss_cls: 0.0
loss_reg: 0.0313720703125 loss_cls: 0.0
loss_reg: 0.0269317626953125 loss_cls: 0.0
loss_reg: 0.0279693603515625 loss_cls: 0.0
loss_reg: 0.03662109375 loss_cls: 0.0
loss_reg: 0.021453857421875 loss_cls: 0.0
loss_reg: 0.016571044921875 loss_cls: 0.0
loss_reg: 0.0202789306640625 loss_cls: 0.0
loss_reg: 0.01486968994140625 loss_cls: 0.0
loss_reg: 0.01458740234375 loss_cls: 0.0
loss_reg: 0.02947998046875 loss_cls: 0.0
loss_reg: 0.025421142578125 loss_cls: 0.0
loss_reg: 0.023101806640625 loss_cls: 0.0
loss_reg: 0.025146484375 loss_cls: 0.0
loss_reg: 0.037872314453125 loss_cls: 0.0
loss_reg: 0.035797119140625 loss_cls: 0.0
loss_reg: 0.0243988037109375 loss_cls: 0.0
loss_reg: 0.03851318359375 loss_cls: 0.0
loss_reg: 0.024169921875 loss_cls: 0.0
loss_reg: 0.01143646240234375 loss_cls: 0.0
loss_reg: 0.0230865478515625 loss_cls: 0.0
loss_reg: 0.0181121826171875 loss_cls: 0.0
loss_reg: 0.046661376953125 loss_cls: 0.0
loss_reg: 0.024993896484375 loss_cls: 0.0
loss_reg: 0.0201568603515625 loss_cls: 0.0
loss_reg: 0.0169677734375 loss_cls: 0.0
loss_reg: 0.0306396484375 loss_cls: 0.0
loss_reg: 0.0270538330078125 loss_cls: 0.0
loss_reg: 0.014556884765625 loss_cls: 0.0
loss_reg: 0.0312042236328125 loss_cls: 0.0
loss_reg: 0.01849365234375 loss_cls: 0.0
loss_reg: 0.019012451171875 loss_cls: 0.0
loss_reg: 0.02569580078125 loss_cls: 0.0
loss_reg: 0.0225677490234375 loss_cls: 0.0
2024-11-09 06:35:59 - progress_bar.py[line:274] - INFO: epoch 018:     30 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.757, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.52, wps=56, ups=0.01, wpb=5120, bsz=1280, num_updates=5010, lr=7.71465e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=69974
2024-11-09 06:37:38 - progress_bar.py[line:274] - INFO: epoch 018:     40 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.744, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.4, wps=514.9, ups=0.1, wpb=5119.9, bsz=1280, num_updates=5020, lr=7.62389e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=70073
2024-11-09 06:39:17 - progress_bar.py[line:274] - INFO: epoch 018:     50 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.748, ntokens=5119.8, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.43, wps=518.4, ups=0.1, wpb=5119.8, bsz=1280, num_updates=5030, lr=7.53313e-06, gnorm=0.012, clip=0, loss_scale=32768, train_wall=35, gb_free=9.7, wall=70172
2024-11-09 06:40:57 - progress_bar.py[line:274] - INFO: epoch 018:     60 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.742, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.38, wps=509.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=5040, lr=7.44237e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=47, gb_free=9.7, wall=70272
2024-11-09 06:42:38 - progress_bar.py[line:274] - INFO: epoch 018:     70 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.749, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.44, wps=506.8, ups=0.1, wpb=5120, bsz=1280, num_updates=5050, lr=7.35161e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=65, gb_free=9.7, wall=70373
2024-11-09 06:44:20 - progress_bar.py[line:274] - INFO: epoch 018:     80 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.752, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.47, wps=505.1, ups=0.1, wpb=5120, bsz=1280, num_updates=5060, lr=7.26085e-06, gnorm=0.011, clip=0, loss_scale=32768, train_wall=87, gb_free=9.7, wall=70475
2024-11-09 06:46:01 - progress_bar.py[line:274] - INFO: epoch 018:     90 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.73, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.27, wps=506.6, ups=0.1, wpb=5120, bsz=1280, num_updates=5070, lr=7.17009e-06, gnorm=0.01, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=70576
2024-11-09 06:47:42 - progress_bar.py[line:274] - INFO: epoch 018:    100 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.72, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.18, wps=504.4, ups=0.1, wpb=5120, bsz=1280, num_updates=5080, lr=7.07932e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=70677
2024-11-09 06:49:23 - progress_bar.py[line:274] - INFO: epoch 018:    110 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.711, ntokens=5120, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.1, wps=506.5, ups=0.1, wpb=5120, bsz=1280, num_updates=5090, lr=6.98856e-06, gnorm=0.008, clip=0, loss_scale=32768, train_wall=101, gb_free=9.6, wall=70778
2024-11-09 06:51:05 - progress_bar.py[line:274] - INFO: epoch 018:    120 / 293 loss=0.001, loss_v1=0, loss_v2=0, nll_loss=3.733, ntokens=5119.9, nsentences=1280, sample_size=1280, sample_size_v1=0, sample_size_v2=0, ppl=13.3, wps=505.3, ups=0.1, wpb=5119.9, bsz=1280, num_updates=5100, lr=6.8978e-06, gnorm=0.009, clip=0, loss_scale=32768, train_wall=101, gb_free=9.7, wall=70880
WARNING:torch.distributed.elastic.agent.server.api:Received 2 death signal, shutting down workers
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979261 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979262 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979263 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979264 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979265 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979266 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979267 closing signal SIGINT
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979268 closing signal SIGINT
Traceback (most recent call last):
  File "../../train.py", line 543, in <module>
    cli_main()
  File "../../train.py", line 536, in cli_main
    distributed_utils.call_main(cfg, main)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 374, in call_main
    distributed_main(cfg.distributed_training.device_id, main, cfg, kwargs)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/distributed/utils.py", line 348, in distributed_main
    main(cfg, **kwargs)
  File "../../train.py", line 190, in main
    valid_losses, should_stop = train(cfg, trainer, task, epoch_itr)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "../../train.py", line 302, in train
    log_output = trainer.train_step(samples)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/contextlib.py", line 74, in inner
    return func(*args, **kwds)
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/trainer.py", line 780, in train_step
    **extra_kwargs,
  File "/home/ubuntu/workspaces/AIHub-polygon-transformer/tasks/base_task.py", line 279, in train_step
    optimizer.backward(loss)
  File "/home/ubuntu/src/fairseq/fairseq/fairseq/optim/fp16_optimizer.py", line 105, in backward
    loss.backward()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/autograd/__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979261 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979262 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979263 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979264 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979265 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979266 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979267 closing signal SIGTERM
WARNING:torch.distributed.elastic.multiprocessing.api:Sending process 1979268 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 709, in run
    result = self._invoke_run(role)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 850, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 1979172 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 716, in run
    self._shutdown(e.sigval)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 1979172 got signal: 2

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 195, in <module>
    main()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 191, in main
    launch(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launch.py", line 176, in launch
    run(args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/run.py", line 756, in run
    )(*cmd_args)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 132, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/launcher/api.py", line 237, in launch_agent
    result = agent.run()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/metrics/api.py", line 129, in wrapper
    result = f(*args, **kwargs)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/api.py", line 721, in run
    self._shutdown()
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/agent/server/local_elastic_agent.py", line 289, in _shutdown
    self._pcontext.close(death_sig)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 332, in close
    self._close(death_sig=death_sig, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 709, in _close
    handler.proc.wait(time_to_wait)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1019, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/subprocess.py", line 1647, in _wait
    time.sleep(delay)
  File "/home/ubuntu/anaconda3/envs/polyformer/lib/python3.7/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 62, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 1979172 got signal: 2
